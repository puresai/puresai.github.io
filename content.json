{"meta":{"title":"13sai blog","subtitle":"13sai blog","description":"13sai blogï¼Œåˆ†äº«æŠ€æœ¯çŸ¥è¯†ï¼Œä¸é™äºPHPã€goã€MySQLã€Redisã€linuxã€MQã€micro serviceã€‚","author":"13sai","url":"https://github.13sai.com","root":"/"},"pages":[{"title":"13sai","date":"2022-02-10T14:19:41.000Z","updated":"2022-06-29T09:48:46.371Z","comments":false,"path":"about/index.html","permalink":"https://github.13sai.com/about/index.html","excerpt":"","text":"2015å¹´ï¼Œææ–™ä¸“ä¸šæœ¬ç§‘æ¯•ä¸šï¼Œç»æ ¡æ‹›ï¼Œå…¥å›½ä¼ã€‚æ•°æœˆåï¼Œå¸Œæœ›é‡è§æ›´å¤šå¯èƒ½æ€§ï¼Œè¾èŒå‰å¾€å—äº¬ï¼Œè½¬è¡Œäº’è”ç½‘ï¼Œä»äº‹ç½‘ç«™ç±»å¼€å‘å·¥ä½œï¼Œä¸»è¦æ¶‰åŠPHPã€MySQLã€HTMLç­‰ã€‚ 2017å¹´ï¼Œå‰å¾€å¿ƒå¿ƒå¿µå¿µçš„æ­å·ï¼Œåç«¯å¼€å‘å²—ä½ã€‚å†ç»å‡ å®¶å…¬å¸ï¼Œè¡Œä¸šæ¶‰åŠç”µå•†ã€æ•™è‚²ã€æ¸¸æˆç­‰ï¼Œæ¥è§¦å¹¶æ·±å…¥å­¦ä¹ æ›´å¤šç¼–ç¨‹çŸ¥è¯†ï¼Œæ¶‰åŠGitã€Redisã€MQã€vueã€Dockerã€goç­‰ã€‚ 2021å¹´ï¼Œå›åˆ°å—äº¬ï¼Œgolangå·¥ç¨‹å¸ˆå²—ä½ï¼Œç›´æ’­æœåŠ¡è¡Œä¸šï¼Œä¸»è¦å·¥ä½œæ¶‰åŠIMã€Micro Serviceã€Kubernetesã€CI/CDã€é«˜å¯ç”¨æœåŠ¡ç­‰ã€‚"},{"title":"åˆ†ç±»","date":"2022-03-19T14:35:21.967Z","updated":"2022-03-19T14:35:21.967Z","comments":false,"path":"categories/index.html","permalink":"https://github.13sai.com/categories/index.html","excerpt":"","text":""},{"title":"category","date":"2022-03-19T14:35:21.969Z","updated":"2022-03-19T14:35:21.969Z","comments":false,"path":"category/index.html","permalink":"https://github.13sai.com/category/index.html","excerpt":"","text":""},{"title":"13sai çš„é˜…è¯»å•","date":"2022-07-05T09:02:56.000Z","updated":"2022-07-05T09:03:34.361Z","comments":false,"path":"collect/index.html","permalink":"https://github.13sai.com/collect/index.html","excerpt":"","text":"goLinux"},{"title":"æ ‡ç­¾","date":"2022-06-23T06:40:10.477Z","updated":"2022-06-23T06:40:10.477Z","comments":false,"path":"tags/index.html","permalink":"https://github.13sai.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"æ·±å…¥å‰–æKubernetesä¹‹Pod","slug":"æ·±å…¥å‰–æKubernetesä¹‹Pod","date":"2022-07-05T02:43:11.000Z","updated":"2022-07-05T08:46:59.983Z","comments":true,"path":"2022/07/05/409/","link":"","permalink":"https://github.13sai.com/2022/07/05/409/","excerpt":"","text":"Podï¼Œæ˜¯ Kubernetes é¡¹ç›®ä¸­çš„æœ€å°ç¼–æ’å•ä½ï¼Œå®é™…ä¸Šæ˜¯åœ¨æ‰®æ¼”ä¼ ç»ŸåŸºç¡€è®¾æ–½é‡Œâ€œè™šæ‹Ÿæœºâ€çš„è§’è‰²ï¼›è€Œå®¹å™¨ï¼Œåˆ™æ˜¯è¿™ä¸ªè™šæ‹Ÿæœºé‡Œè¿è¡Œçš„ç”¨æˆ·ç¨‹åºã€‚ å‡¡æ˜¯è°ƒåº¦ã€ç½‘ç»œã€å­˜å‚¨ï¼Œä»¥åŠå®‰å…¨ç›¸å…³çš„å±æ€§ï¼ŒåŸºæœ¬ä¸Šæ˜¯ Pod çº§åˆ«çš„ã€‚ ğŸŒ° apiVersion: v1 kind: Pod metadata: name: lifecycle-demo spec: containers: - name: lifecycle-demo-container image: nginx lifecycle: postStart: exec: command: [&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;echo Hello from the postStart handler &gt; /usr/share/message&quot;] preStop: exec: command: [&quot;/usr/sbin/nginx&quot;,&quot;-s&quot;,&quot;quit&quot;] ç”Ÿå‘½å‘¨æœŸPod ç”Ÿå‘½å‘¨æœŸï¼š(ä¸»è¦ä½“ç°åœ¨ Pod API å¯¹è±¡çš„Status éƒ¨åˆ†) Pendingã€‚è¿™ä¸ªçŠ¶æ€æ„å‘³ç€ï¼ŒPod çš„ YAML æ–‡ä»¶å·²ç»æäº¤ç»™äº† Kubernetesï¼ŒAPI å¯¹è±¡å·²ç»è¢«åˆ›å»ºå¹¶ä¿å­˜åœ¨ Etcd å½“ä¸­ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ª Pod é‡Œæœ‰äº›å®¹å™¨å› ä¸ºæŸç§åŸå› è€Œä¸èƒ½è¢«é¡ºåˆ©åˆ›å»ºã€‚æ¯”å¦‚ï¼Œè°ƒåº¦ä¸æˆåŠŸã€‚ Runningã€‚è¿™ä¸ªçŠ¶æ€ä¸‹ï¼ŒPod å·²ç»è°ƒåº¦æˆåŠŸï¼Œè·Ÿä¸€ä¸ªå…·ä½“çš„èŠ‚ç‚¹ç»‘å®šã€‚å®ƒåŒ…å«çš„å®¹å™¨éƒ½å·²ç»åˆ›å»ºæˆåŠŸï¼Œå¹¶ä¸”è‡³å°‘æœ‰ä¸€ä¸ªæ­£åœ¨è¿è¡Œä¸­ã€‚ Succeededã€‚è¿™ä¸ªçŠ¶æ€æ„å‘³ç€ï¼ŒPod é‡Œçš„æ‰€æœ‰å®¹å™¨éƒ½æ­£å¸¸è¿è¡Œå®Œæ¯•ï¼Œå¹¶ä¸”å·²ç»é€€å‡ºäº†ã€‚è¿™ç§æƒ…å†µåœ¨è¿è¡Œä¸€æ¬¡æ€§ä»»åŠ¡æ—¶æœ€ä¸ºå¸¸è§ã€‚ Failedã€‚è¿™ä¸ªçŠ¶æ€ä¸‹ï¼ŒPod é‡Œè‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨ä»¥ä¸æ­£å¸¸çš„çŠ¶æ€ï¼ˆé 0 çš„è¿”å›ç ï¼‰é€€å‡ºã€‚è¿™ä¸ªçŠ¶æ€çš„å‡ºç°ï¼Œæ„å‘³ç€ä½ å¾—æƒ³åŠæ³• Debug è¿™ä¸ªå®¹å™¨çš„åº”ç”¨ï¼Œæ¯”å¦‚æŸ¥çœ‹ Pod çš„ Events å’Œæ—¥å¿—ã€‚ Unknownã€‚è¿™æ˜¯ä¸€ä¸ªå¼‚å¸¸çŠ¶æ€ï¼Œæ„å‘³ç€ Pod çš„çŠ¶æ€ä¸èƒ½æŒç»­åœ°è¢« kubelet æ±‡æŠ¥ç»™ kube-apiserverï¼Œè¿™å¾ˆæœ‰å¯èƒ½æ˜¯ä¸»ä»èŠ‚ç‚¹ï¼ˆMaster å’Œ Kubeletï¼‰é—´çš„é€šä¿¡å‡ºç°äº†é—®é¢˜ã€‚ æ›´è¿›ä¸€æ­¥åœ°ï¼ŒPod å¯¹è±¡çš„ Status å­—æ®µï¼Œè¿˜å¯ä»¥å†ç»†åˆ†å‡ºä¸€ç»„ Conditionsã€‚è¿™äº›ç»†åˆ†çŠ¶æ€çš„å€¼åŒ…æ‹¬ï¼šPodScheduledã€Readyã€Initializedï¼Œä»¥åŠ Unschedulableã€‚å®ƒä»¬ä¸»è¦ç”¨äºæè¿°é€ æˆå½“å‰ Status çš„å…·ä½“åŸå› æ˜¯ä»€ä¹ˆã€‚ æ¯”å¦‚ï¼ŒPod å½“å‰çš„ Status æ˜¯ Pendingï¼Œå¯¹åº”çš„ Condition æ˜¯ Unschedulableï¼Œè¿™å°±æ„å‘³ç€å®ƒçš„è°ƒåº¦å‡ºç°äº†é—®é¢˜ã€‚ Projected VolumeKubernetes æ”¯æŒçš„ Projected Volume ä¸€å…±æœ‰å››ç§ï¼š Secret ConfigMap Downward API ServiceAccountToken SecretSecret æœ€å…¸å‹çš„ä½¿ç”¨åœºæ™¯ï¼Œè«è¿‡äºå­˜æ”¾æ•°æ®åº“çš„ Credential ä¿¡æ¯ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š apiVersion: v1 kind: Pod metadata: name: test-projected-volume spec: containers: - name: test-secret-volume image: busybox args: - sleep - &quot;86400&quot; volumeMounts: - name: mysql-cred mountPath: &quot;/projected-volume&quot; readOnly: true volumes: - name: mysql-cred projected: sources: - secret: name: user - secret: name: pass è¿™é‡Œç”¨åˆ°çš„æ•°æ®åº“çš„ç”¨æˆ·åã€å¯†ç ï¼Œæ­£æ˜¯ä»¥ Secret å¯¹è±¡çš„æ–¹å¼äº¤ç»™ Kubernetes ä¿å­˜çš„ã€‚å®Œæˆè¿™ä¸ªæ“ä½œçš„æŒ‡ä»¤ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š cat ./username.txt sai cat ./password.txt 123456 kubectl create secret generic user --from-file=./username.txt kubectl create secret generic pass --from-file=./password.txt å…¶ä¸­ï¼Œusername.txt å’Œ password.txt æ–‡ä»¶é‡Œï¼Œå­˜æ”¾çš„å°±æ˜¯ç”¨æˆ·åå’Œå¯†ç ï¼›è€Œ user å’Œ passï¼Œåˆ™æ˜¯æˆ‘ä¸º Secret å¯¹è±¡æŒ‡å®šçš„åå­—ã€‚è€Œæˆ‘æƒ³è¦æŸ¥çœ‹è¿™äº› Secret å¯¹è±¡çš„è¯ï¼Œåªè¦æ‰§è¡Œä¸€æ¡ kubectl get å‘½ä»¤å°±å¯ä»¥äº†ï¼š kubectl get secrets NAME TYPE DATA AGE user Opaque 1 51s pass Opaque 1 51s éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSecret å¯¹è±¡è¦æ±‚è¿™äº›æ•°æ®å¿…é¡»æ˜¯ç»è¿‡ Base64 è½¬ç çš„ï¼Œä»¥å…å‡ºç°æ˜æ–‡å¯†ç çš„å®‰å…¨éšæ‚£ã€‚ ConfigMapä¸ Secret çš„åŒºåˆ«åœ¨äºï¼ŒConfigMap ä¿å­˜çš„æ˜¯ä¸éœ€è¦åŠ å¯†çš„ã€åº”ç”¨æ‰€éœ€çš„é…ç½®ä¿¡æ¯ã€‚è€Œ ConfigMap çš„ç”¨æ³•å‡ ä¹ä¸ Secret å®Œå…¨ç›¸åŒï¼šä½ å¯ä»¥ä½¿ç”¨ kubectl create configmap ä»æ–‡ä»¶æˆ–è€…ç›®å½•åˆ›å»º ConfigMapï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç¼–å†™ ConfigMap å¯¹è±¡çš„ YAML æ–‡ä»¶ã€‚ Downward APIå®ƒçš„ä½œç”¨æ˜¯ï¼šè®© Pod é‡Œçš„å®¹å™¨èƒ½å¤Ÿç›´æ¥è·å–åˆ°è¿™ä¸ª Pod API å¯¹è±¡æœ¬èº«çš„ä¿¡æ¯ã€‚ apiVersion: v1 kind: Pod metadata: name: test-downwardapi-volume labels: zone: us-est-coast cluster: test-cluster1 rack: rack-22 spec: containers: - name: client-container image: k8s.gcr.io/busybox command: [&quot;sh&quot;, &quot;-c&quot;] args: - while true; do if [[ -e /etc/podinfo/labels ]]; then echo -en &#x27;\\n\\n&#x27;; cat /etc/podinfo/labels; fi; sleep 5; done; volumeMounts: - name: podinfo mountPath: /etc/podinfo readOnly: false volumes: - name: podinfo projected: sources: - downwardAPI: items: - path: &quot;labels&quot; fieldRef: fieldPath: metadata.labels åœ¨è¿™ä¸ª Pod çš„ YAML æ–‡ä»¶ä¸­ï¼Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„å®¹å™¨ï¼Œå£°æ˜äº†ä¸€ä¸ª projected ç±»å‹çš„ Volumeã€‚åªä¸è¿‡è¿™æ¬¡ Volume çš„æ•°æ®æ¥æºï¼Œå˜æˆäº† Downward APIã€‚è€Œè¿™ä¸ª Downward API Volumeï¼Œåˆ™å£°æ˜äº†è¦æš´éœ² Pod çš„ metadata.labels ä¿¡æ¯ç»™å®¹å™¨ã€‚ é€šè¿‡è¿™æ ·çš„å£°æ˜æ–¹å¼ï¼Œå½“å‰ Pod çš„ Labels å­—æ®µçš„å€¼ï¼Œå°±ä¼šè¢« Kubernetes è‡ªåŠ¨æŒ‚è½½æˆä¸ºå®¹å™¨é‡Œçš„ /etc/podinfo/labels æ–‡ä»¶ã€‚ PS:éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒDownward API èƒ½å¤Ÿè·å–åˆ°çš„ä¿¡æ¯ï¼Œä¸€å®šæ˜¯ Pod é‡Œçš„å®¹å™¨è¿›ç¨‹å¯åŠ¨ä¹‹å‰å°±èƒ½å¤Ÿç¡®å®šä¸‹æ¥çš„ä¿¡æ¯ã€‚è€Œå¦‚æœä½ æƒ³è¦è·å– Pod å®¹å™¨è¿è¡Œåæ‰ä¼šå‡ºç°çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼Œå®¹å™¨è¿›ç¨‹çš„ PIDï¼Œé‚£å°±è‚¯å®šä¸èƒ½ä½¿ç”¨ Downward API äº†ï¼Œè€Œåº”è¯¥è€ƒè™‘åœ¨ Pod é‡Œå®šä¹‰ä¸€ä¸ª sidecar å®¹å™¨ã€‚ ServiceAccountTokenä¸€ç§ç‰¹æ®Šçš„ Secret ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼ŒKubernetes å·²ç»ä¸ºä½ æä¾›äº†ä¸€ä¸ªçš„é»˜è®¤â€œæœåŠ¡è´¦æˆ·â€ï¼ˆdefault Service Accountï¼‰ã€‚å¹¶ä¸”ï¼Œä»»ä½•ä¸€ä¸ªè¿è¡Œåœ¨ Kubernetes é‡Œçš„ Podï¼Œéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé»˜è®¤çš„ Service Accountï¼Œè€Œæ— éœ€æ˜¾ç¤ºåœ°å£°æ˜æŒ‚è½½å®ƒã€‚ å®¹å™¨å¥åº·æ£€æŸ¥å’Œæ¢å¤æœºåˆ¶apiVersion: v1 kind: Pod metadata: labels: test: liveness name: test-liveness-exec spec: containers: - name: liveness image: busybox args: - /bin/sh - -c - touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600 livenessProbe: exec: command: - cat - /tmp/healthy initialDelaySeconds: 5 periodSeconds: 5 åœ¨è¿™ä¸ª Pod ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæœ‰è¶£çš„å®¹å™¨ã€‚å®ƒåœ¨å¯åŠ¨ä¹‹ååšçš„ç¬¬ä¸€ä»¶äº‹ï¼Œå°±æ˜¯åœ¨ /tmp ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ª healthy æ–‡ä»¶ï¼Œä»¥æ­¤ä½œä¸ºè‡ªå·±å·²ç»æ­£å¸¸è¿è¡Œçš„æ ‡å¿—ã€‚è€Œ 30 s è¿‡åï¼Œå®ƒä¼šæŠŠè¿™ä¸ªæ–‡ä»¶åˆ é™¤æ‰ã€‚ ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªè¿™æ ·çš„ livenessProbeï¼ˆå¥åº·æ£€æŸ¥ï¼‰ã€‚å®ƒçš„ç±»å‹æ˜¯ execï¼Œè¿™æ„å‘³ç€ï¼Œå®ƒä¼šåœ¨å®¹å™¨å¯åŠ¨åï¼Œåœ¨å®¹å™¨é‡Œé¢æ‰§è¡Œä¸€å¥æˆ‘ä»¬æŒ‡å®šçš„å‘½ä»¤ï¼Œæ¯”å¦‚ï¼šâ€œcat /tmp/healthyâ€ã€‚è¿™æ—¶ï¼Œå¦‚æœè¿™ä¸ªæ–‡ä»¶å­˜åœ¨ï¼Œè¿™æ¡å‘½ä»¤çš„è¿”å›å€¼å°±æ˜¯ 0ï¼ŒPod å°±ä¼šè®¤ä¸ºè¿™ä¸ªå®¹å™¨ä¸ä»…å·²ç»å¯åŠ¨ï¼Œè€Œä¸”æ˜¯å¥åº·çš„ã€‚è¿™ä¸ªå¥åº·æ£€æŸ¥ï¼Œåœ¨å®¹å™¨å¯åŠ¨ 5 s åå¼€å§‹æ‰§è¡Œï¼ˆinitialDelaySeconds: 5ï¼‰ï¼Œæ¯ 5 s æ‰§è¡Œä¸€æ¬¡ï¼ˆperiodSeconds: 5ï¼‰ã€‚ ä½ ä¸å¦¨å°è¯•ä¸€ä¸‹è¿è¡Œè¿™ä¸ªpodï¼Œæš´éœ²ä¸€ä¸ªå¥åº·å‡äº§ url å’Œ ç›‘å¬ç«¯å£æ˜¯éå¸¸å¸¸è§çš„ã€‚ å¯¹äº Web æœåŠ¡åº”ç”¨ï¼Œ PSï¼šKubernetes ä¸­å¹¶æ²¡æœ‰ Docker çš„ Stop è¯­ä¹‰ã€‚æ‰€ä»¥è™½ç„¶æ˜¯ Restartï¼ˆé‡å¯ï¼‰ï¼Œä½†å®é™…å´æ˜¯é‡æ–°åˆ›å»ºäº†å®¹å™¨ã€‚ restartPolicyï¼Œæ”¹å˜ Pod çš„æ¢å¤ç­–ç•¥ Alwaysï¼šåœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œåªè¦å®¹å™¨ä¸åœ¨è¿è¡ŒçŠ¶æ€ï¼Œå°±è‡ªåŠ¨é‡å¯å®¹å™¨ï¼› OnFailure: åªåœ¨å®¹å™¨ å¼‚å¸¸æ—¶æ‰è‡ªåŠ¨é‡å¯å®¹å™¨ï¼› Never: ä»æ¥ä¸é‡å¯å®¹å™¨ã€‚ è®°ä½å¦‚ä¸‹ä¸¤ä¸ªåŸºæœ¬çš„è®¾è®¡åŸç†å³å¯ï¼š åªè¦ Pod çš„ restartPolicy æŒ‡å®šçš„ç­–ç•¥å…è®¸é‡å¯å¼‚å¸¸çš„å®¹å™¨ï¼ˆæ¯”å¦‚ï¼šAlwaysï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ª Pod å°±ä¼šä¿æŒ Running çŠ¶æ€ï¼Œå¹¶è¿›è¡Œå®¹å™¨é‡å¯ã€‚å¦åˆ™ï¼ŒPod å°±ä¼šè¿›å…¥ Failed çŠ¶æ€ ã€‚ å¯¹äºåŒ…å«å¤šä¸ªå®¹å™¨çš„ Podï¼Œåªæœ‰å®ƒé‡Œé¢æ‰€æœ‰çš„å®¹å™¨éƒ½è¿›å…¥å¼‚å¸¸çŠ¶æ€åï¼ŒPod æ‰ä¼šè¿›å…¥ Failed çŠ¶æ€ã€‚ æ›´è¯¦ç»†æ¨èçœ‹çœ‹ï¼š Pod çš„ç”Ÿå‘½å‘¨æœŸ kubernetesä¹‹å®¹å™¨æ¢é’ˆ(liveness and readiness probe) PodPresetå¼€å‘äººå‘˜åªéœ€è¦æäº¤ä¸€ä¸ªåŸºæœ¬çš„ã€éå¸¸ç®€å•çš„ Pod YAMLï¼ŒKubernetes å°±å¯ä»¥è‡ªåŠ¨ç»™å¯¹åº”çš„ Pod å¯¹è±¡åŠ ä¸Šå…¶ä»–å¿…è¦çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ labelsï¼Œannotationsï¼Œvolumes ç­‰ç­‰ã€‚è€Œè¿™äº›ä¿¡æ¯ï¼Œå¯ä»¥æ˜¯è¿ç»´äººå‘˜äº‹å…ˆå®šä¹‰å¥½çš„ã€‚ ğŸŒ° apiVersion: settings.k8s.io/v1alpha1 kind: PodPreset metadata: name: allow-database spec: selector: matchLabels: role: frontend # è¿™é‡Œå¾ˆé‡è¦ env: - name: DB_PORT value: &quot;6379&quot; volumeMounts: - mountPath: /cache name: cache-volume volumes: - name: cache-volume emptyDir: &#123;&#125; --- apiVersion: v1 kind: Pod metadata: name: sai labels: app: sai role: frontend # è¿™é‡Œå¾ˆé‡è¦ spec: containers: - name: website image: nginx ports: - containerPort: 80 kubectl get pod sai -o yaml apiVersion: v1 kind: Pod metadata: name: sai labels: app: sai role: frontend annotations: podpreset.admission.kubernetes.io/podpreset-allow-database: &quot;resource version&quot; spec: containers: - name: website image: nginx volumeMounts: - mountPath: /cache name: cache-volume ports: - containerPort: 80 env: - name: DB_PORT value: &quot;6379&quot; volumes: - name: cache-volume emptyDir: &#123;&#125; è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œè¿™ä¸ª Pod é‡Œå¤šäº†æ–°æ·»åŠ çš„ labelsã€envã€volumes å’Œ volumeMount çš„å®šä¹‰ï¼Œå®ƒä»¬çš„é…ç½®è·Ÿ PodPreset çš„å†…å®¹ä¸€æ ·ã€‚æ­¤å¤–ï¼Œè¿™ä¸ª Pod è¿˜è¢«è‡ªåŠ¨åŠ ä¸Šäº†ä¸€ä¸ª annotation è¡¨ç¤ºè¿™ä¸ª Pod å¯¹è±¡è¢« PodPreset æ”¹åŠ¨è¿‡ã€‚ éœ€è¦è¯´æ˜çš„æ˜¯ï¼ŒPodPreset é‡Œå®šä¹‰çš„å†…å®¹ï¼Œåªä¼šåœ¨ Pod API å¯¹è±¡è¢«åˆ›å»ºä¹‹å‰è¿½åŠ åœ¨è¿™ä¸ªå¯¹è±¡æœ¬èº«ä¸Šï¼Œè€Œä¸ä¼šå½±å“ä»»ä½• Pod çš„æ§åˆ¶å™¨çš„å®šä¹‰ã€‚","categories":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/categories/k8s/"}],"tags":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/tags/k8s/"}]},{"title":"æ·±å…¥å‰–æKubernetesä¹‹å®¹å™¨åŸºç¡€ç¯‡","slug":"æ·±å…¥å‰–æKubernetesä¹‹å®¹å™¨åŸºç¡€ç¯‡","date":"2022-07-01T07:05:12.000Z","updated":"2022-07-05T08:47:03.821Z","comments":true,"path":"2022/07/01/406/","link":"","permalink":"https://github.13sai.com/2022/07/01/406/","excerpt":"","text":"å®¹å™¨æœ¬èº«æ²¡æœ‰ä»·å€¼ï¼Œæœ‰ä»·å€¼çš„æ˜¯â€œå®¹å™¨ç¼–æ’â€ã€‚ è¿›ç¨‹int pid = clone(main_function, stack_size, SIGCHLD, NULL); int pid = clone(main_function, stack_size, CLONE_NEWPID | SIGCHLD, NULL); éš”ç¦»ç”¨æˆ·è¿è¡Œåœ¨å®¹å™¨é‡Œçš„åº”ç”¨è¿›ç¨‹ï¼Œè·Ÿå®¿ä¸»æœºä¸Šçš„å…¶ä»–è¿›ç¨‹ä¸€æ ·ï¼Œéƒ½ç”±å®¿ä¸»æœºæ“ä½œç³»ç»Ÿç»Ÿä¸€ç®¡ç†ï¼Œåªä¸è¿‡è¿™äº›è¢«éš”ç¦»çš„è¿›ç¨‹æ‹¥æœ‰é¢å¤–è®¾ç½®è¿‡çš„ Namespace å‚æ•°ã€‚è€Œ Docker é¡¹ç›®åœ¨è¿™é‡Œæ‰®æ¼”çš„è§’è‰²ï¼Œæ›´å¤šçš„æ˜¯æ—è·¯å¼çš„è¾…åŠ©å’Œç®¡ç†å·¥ä½œã€‚ åŸºäº Linux Namespace çš„éš”ç¦»æœºåˆ¶ç›¸æ¯”äºè™šæ‹ŸåŒ–æŠ€æœ¯ä¹Ÿæœ‰å¾ˆå¤šä¸è¶³ä¹‹å¤„ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯ï¼šéš”ç¦»å¾—ä¸å½»åº•ã€‚ é¦–å…ˆï¼Œæ—¢ç„¶å®¹å™¨åªæ˜¯è¿è¡Œåœ¨å®¿ä¸»æœºä¸Šçš„ä¸€ç§ç‰¹æ®Šçš„è¿›ç¨‹ï¼Œé‚£ä¹ˆå¤šä¸ªå®¹å™¨ä¹‹é—´ä½¿ç”¨çš„å°±è¿˜æ˜¯åŒä¸€ä¸ªå®¿ä¸»æœºçš„æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚ å…¶æ¬¡ï¼Œåœ¨ Linux å†…æ ¸ä¸­ï¼Œæœ‰å¾ˆå¤šèµ„æºå’Œå¯¹è±¡æ˜¯ä¸èƒ½è¢« Namespace åŒ–çš„ï¼Œæœ€å…¸å‹çš„ä¾‹å­å°±æ˜¯ï¼šæ—¶é—´ã€‚ Linux Control GroupLinux Cgroups æœ€ä¸»è¦çš„ä½œç”¨ï¼Œå°±æ˜¯é™åˆ¶ä¸€ä¸ªè¿›ç¨‹ç»„èƒ½å¤Ÿä½¿ç”¨çš„èµ„æºä¸Šé™ï¼ŒåŒ…æ‹¬ CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œå¸¦å®½ç­‰ç­‰ã€‚ mount -t cgroup cgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd) cgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices) cgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset) cgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpuacct,cpu) cgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio) cgroup on /sys/fs/cgroup/pids type cgroup (rw,nosuid,nodev,noexec,relatime,pids) cgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory) cgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event) cgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb) cgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer) cgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_prio,net_cls) è¿›å…¥ /sys/fs/cgroup/cpu ç›®å½•ä¸‹ï¼š root@ubuntu:/sys/fs/cgroup/cpu$ mkdir container root@ubuntu:/sys/fs/cgroup/cpu$ ls container/ cgroup.clone_children cpu.cfs_period_us cpu.rt_period_us cpu.shares notify_on_release cgroup.procs cpu.cfs_quota_us cpu.rt_runtime_us cpu.stat tasks è¿™ä¸ªç›®å½•å°±ç§°ä¸ºä¸€ä¸ªâ€œæ§åˆ¶ç»„â€ã€‚ä½ ä¼šå‘ç°ï¼Œæ“ä½œç³»ç»Ÿä¼šåœ¨ä½ æ–°åˆ›å»ºçš„ container ç›®å½•ä¸‹ï¼Œè‡ªåŠ¨ç”Ÿæˆè¯¥å­ç³»ç»Ÿå¯¹åº”çš„èµ„æºé™åˆ¶æ–‡ä»¶ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨åå°æ‰§è¡Œè¿™æ ·ä¸€æ¡è„šæœ¬ï¼š while : ; do : ; done &amp; [1] 226 æ˜¾ç„¶ï¼Œå®ƒæ‰§è¡Œäº†ä¸€ä¸ªæ­»å¾ªç¯ï¼Œå¯ä»¥æŠŠè®¡ç®—æœºçš„ CPU åƒåˆ° 100%ï¼Œæ ¹æ®å®ƒçš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªè„šæœ¬åœ¨åå°è¿è¡Œçš„è¿›ç¨‹å·ï¼ˆPIDï¼‰æ˜¯ 226ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ top æŒ‡ä»¤æ¥ç¡®è®¤ä¸€ä¸‹ CPU æœ‰æ²¡æœ‰è¢«æ‰“æ»¡ï¼š $ top %Cpu0 :100.0 us, 0.0 sy, 0.0 ni, 0.0 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 st åœ¨è¾“å‡ºé‡Œå¯ä»¥çœ‹åˆ°ï¼ŒCPU çš„ä½¿ç”¨ç‡å·²ç» 100% äº†ï¼ˆ%Cpu0 :100.0 usï¼‰ã€‚ è€Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹ container ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œçœ‹åˆ° container æ§åˆ¶ç»„é‡Œçš„ CPU quota è¿˜æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼ˆå³ï¼š-1ï¼‰ï¼ŒCPU period åˆ™æ˜¯é»˜è®¤çš„ 100 msï¼ˆ100000 usï¼‰ï¼š cat /sys/fs/cgroup/cpu/container/cpu.cfs_quota_us -1 cat /sys/fs/cgroup/cpu/container/cpu.cfs_period_us 100000 æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹è¿™äº›æ–‡ä»¶çš„å†…å®¹æ¥è®¾ç½®é™åˆ¶ã€‚ æ¯”å¦‚ï¼Œå‘ container ç»„é‡Œçš„ cfs_quota æ–‡ä»¶å†™å…¥ 20 msï¼ˆ20000 usï¼‰ï¼š echo 20000 &gt; /sys/fs/cgroup/cpu/container/cpu.cfs_quota_us ç»“åˆå‰é¢çš„ä»‹ç»ï¼Œä½ åº”è¯¥èƒ½æ˜ç™½è¿™ä¸ªæ“ä½œçš„å«ä¹‰ï¼Œå®ƒæ„å‘³ç€åœ¨æ¯ 100 ms çš„æ—¶é—´é‡Œï¼Œè¢«è¯¥æ§åˆ¶ç»„é™åˆ¶çš„è¿›ç¨‹åªèƒ½ä½¿ç”¨ 20 ms çš„ CPU æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¿›ç¨‹åªèƒ½ä½¿ç”¨åˆ° 20% çš„ CPU å¸¦å®½ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠè¢«é™åˆ¶çš„è¿›ç¨‹çš„ PID å†™å…¥ container ç»„é‡Œçš„ tasks æ–‡ä»¶ï¼Œä¸Šé¢çš„è®¾ç½®å°±ä¼šå¯¹è¯¥è¿›ç¨‹ç”Ÿæ•ˆäº†ï¼š echo 226 &gt; /sys/fs/cgroup/cpu/container/tasks æˆ‘ä»¬å¯ä»¥ç”¨ top æŒ‡ä»¤æŸ¥çœ‹ä¸€ä¸‹ï¼š $ top %Cpu0 : 20.3 us, 0.0 sy, 0.0 ni, 79.7 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 st å¯ä»¥çœ‹åˆ°ï¼Œè®¡ç®—æœºçš„ CPU ä½¿ç”¨ç‡ç«‹åˆ»é™åˆ°äº† 20%ï¼ˆ%Cpu0 : 20.3 usï¼‰ã€‚ é™¤ CPU å­ç³»ç»Ÿå¤–ï¼ŒCgroups çš„æ¯ä¸€é¡¹å­ç³»ç»Ÿéƒ½æœ‰å…¶ç‹¬æœ‰çš„èµ„æºé™åˆ¶èƒ½åŠ›ï¼Œæ¯”å¦‚ï¼š blkioï¼Œä¸ºâ€‹â€‹â€‹å—â€‹â€‹â€‹è®¾â€‹â€‹â€‹å¤‡â€‹â€‹â€‹è®¾â€‹â€‹â€‹å®šâ€‹â€‹â€‹I/O é™â€‹â€‹â€‹åˆ¶ï¼Œä¸€èˆ¬ç”¨äºç£ç›˜ç­‰è®¾å¤‡ï¼› cpusetï¼Œä¸ºè¿›ç¨‹åˆ†é…å•ç‹¬çš„ CPU æ ¸å’Œå¯¹åº”çš„å†…å­˜èŠ‚ç‚¹ï¼› memoryï¼Œä¸ºè¿›ç¨‹è®¾å®šå†…å­˜ä½¿ç”¨çš„é™åˆ¶ã€‚ Linux Cgroups çš„è®¾è®¡è¿˜æ˜¯æ¯”è¾ƒæ˜“ç”¨çš„ï¼Œç®€å•ç²—æš´åœ°ç†è§£å‘¢ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå­ç³»ç»Ÿç›®å½•åŠ ä¸Šä¸€ç»„èµ„æºé™åˆ¶æ–‡ä»¶çš„ç»„åˆã€‚è€Œå¯¹äº Docker ç­‰ Linux å®¹å™¨é¡¹ç›®æ¥è¯´ï¼Œå®ƒä»¬åªéœ€è¦åœ¨æ¯ä¸ªå­ç³»ç»Ÿä¸‹é¢ï¼Œä¸ºæ¯ä¸ªå®¹å™¨åˆ›å»ºä¸€ä¸ªæ§åˆ¶ç»„ï¼ˆå³åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼‰ï¼Œç„¶ååœ¨å¯åŠ¨å®¹å™¨è¿›ç¨‹ä¹‹åï¼ŒæŠŠè¿™ä¸ªè¿›ç¨‹çš„ PID å¡«å†™åˆ°å¯¹åº”æ§åˆ¶ç»„çš„ tasks æ–‡ä»¶ä¸­å°±å¯ä»¥äº†ã€‚ docker run -it --cpu-period=100000 --cpu-quota=20000 ubuntu /bin/bash èµ„æºç›®å½•ä¸­ï¼š cat /sys/fs/cgroup/cpu/docker/5d5c9f67d/cpu.cfs_period_us 100000 cat /sys/fs/cgroup/cpu/docker/5d5c9f67d/cpu.cfs_quota_us 20000 Cgroups å¯¹èµ„æºçš„é™åˆ¶èƒ½åŠ›ä¹Ÿæœ‰å¾ˆå¤šä¸å®Œå–„çš„åœ°æ–¹ï¼Œè¢«æåŠæœ€å¤šçš„è‡ªç„¶æ˜¯ /proc æ–‡ä»¶ç³»ç»Ÿçš„é—®é¢˜ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼ŒLinux ä¸‹çš„ /proc ç›®å½•å­˜å‚¨çš„æ˜¯è®°å½•å½“å‰å†…æ ¸è¿è¡ŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç‰¹æ®Šæ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è®¿é—®è¿™äº›æ–‡ä»¶ï¼ŒæŸ¥çœ‹ç³»ç»Ÿä»¥åŠå½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ CPU ä½¿ç”¨æƒ…å†µã€å†…å­˜å ç”¨ç‡ç­‰ï¼Œè¿™äº›æ–‡ä»¶ä¹Ÿæ˜¯ top æŒ‡ä»¤æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯çš„ä¸»è¦æ•°æ®æ¥æºã€‚ ä½†æ˜¯ï¼Œä½ å¦‚æœåœ¨å®¹å™¨é‡Œæ‰§è¡Œ top æŒ‡ä»¤ï¼Œå°±ä¼šå‘ç°ï¼Œå®ƒæ˜¾ç¤ºçš„ä¿¡æ¯å±…ç„¶æ˜¯å®¿ä¸»æœºçš„ CPU å’Œå†…å­˜æ•°æ®ï¼Œè€Œä¸æ˜¯å½“å‰å®¹å™¨çš„æ•°æ®ã€‚ é€ æˆè¿™ä¸ªé—®é¢˜çš„åŸå› å°±æ˜¯ï¼Œ/proc æ–‡ä»¶ç³»ç»Ÿå¹¶ä¸çŸ¥é“ç”¨æˆ·é€šè¿‡ Cgroups ç»™è¿™ä¸ªå®¹å™¨åšäº†ä»€ä¹ˆæ ·çš„èµ„æºé™åˆ¶ï¼Œå³ï¼š/proc æ–‡ä»¶ç³»ç»Ÿä¸äº†è§£ Cgroups é™åˆ¶çš„å­˜åœ¨ã€‚ åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¿™ä¸ªé—®é¢˜å¿…é¡»è¿›è¡Œä¿®æ­£ï¼Œå¦åˆ™åº”ç”¨ç¨‹åºåœ¨å®¹å™¨é‡Œè¯»å–åˆ°çš„ CPU æ ¸æ•°ã€å¯ç”¨å†…å­˜ç­‰ä¿¡æ¯éƒ½æ˜¯å®¿ä¸»æœºä¸Šçš„æ•°æ®ï¼Œè¿™ä¼šç»™åº”ç”¨çš„è¿è¡Œå¸¦æ¥éå¸¸å¤§çš„å›°æƒ‘å’Œé£é™©ã€‚è¿™ä¹Ÿæ˜¯åœ¨ä¼ä¸šä¸­ï¼Œå®¹å™¨åŒ–åº”ç”¨ç¢°åˆ°çš„ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼Œä¹Ÿæ˜¯å®¹å™¨ç›¸è¾ƒäºè™šæ‹Ÿæœºå¦ä¸€ä¸ªä¸å°½å¦‚äººæ„çš„åœ°æ–¹ã€‚ [DOCKERåŸºç¡€æŠ€æœ¯ï¼šLINUX NAMESPACEï¼ˆä¸Šï¼‰]https://coolshell.cn/articles/17010.html) å¯¹ Docker é¡¹ç›®æ¥è¯´ï¼Œå®ƒæœ€æ ¸å¿ƒçš„åŸç†å®é™…ä¸Šå°±æ˜¯ä¸ºå¾…åˆ›å»ºçš„ç”¨æˆ·è¿›ç¨‹ï¼š å¯ç”¨ Linux Namespace é…ç½®ï¼› è®¾ç½®æŒ‡å®šçš„ Cgroups å‚æ•°ï¼› åˆ‡æ¢è¿›ç¨‹çš„æ ¹ç›®å½•ï¼ˆChange Rootï¼‰ã€‚ å¦å¤–ï¼Œéœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œrootfs åªæ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ‰€åŒ…å«çš„æ–‡ä»¶ã€é…ç½®å’Œç›®å½•ï¼Œå¹¶ä¸åŒ…æ‹¬æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚åœ¨ Linux æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿™ä¸¤éƒ¨åˆ†æ˜¯åˆ†å¼€å­˜æ”¾çš„ï¼Œæ“ä½œç³»ç»Ÿåªæœ‰åœ¨å¼€æœºå¯åŠ¨æ—¶æ‰ä¼šåŠ è½½æŒ‡å®šç‰ˆæœ¬çš„å†…æ ¸é•œåƒã€‚ æ‰€ä»¥è¯´ï¼Œrootfs åªåŒ…æ‹¬äº†æ“ä½œç³»ç»Ÿçš„â€œèº¯å£³â€ï¼Œå¹¶æ²¡æœ‰åŒ…æ‹¬æ“ä½œç³»ç»Ÿçš„â€œçµé­‚â€ã€‚ Docker å…¬å¸åœ¨å®ç° Docker é•œåƒæ—¶å¹¶æ²¡æœ‰æ²¿ç”¨ä»¥å‰åˆ¶ä½œ rootfs çš„æ ‡å‡†æµç¨‹ï¼Œè€Œæ˜¯åšäº†ä¸€ä¸ªå°å°çš„åˆ›æ–°ï¼š Docker åœ¨é•œåƒçš„è®¾è®¡ä¸­ï¼Œå¼•å…¥äº†å±‚ï¼ˆlayerï¼‰çš„æ¦‚å¿µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·åˆ¶ä½œé•œåƒçš„æ¯ä¸€æ­¥æ“ä½œï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªå±‚ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå¢é‡ rootfsã€‚ å½“ç„¶ï¼Œè¿™ä¸ªæƒ³æ³•ä¸æ˜¯å‡­ç©ºè‡†é€ å‡ºæ¥çš„ï¼Œè€Œæ˜¯ç”¨åˆ°äº†ä¸€ç§å«ä½œè”åˆæ–‡ä»¶ç³»ç»Ÿï¼ˆUnion File Systemï¼‰çš„èƒ½åŠ›ã€‚","categories":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/categories/k8s/"}],"tags":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/tags/k8s/"}]},{"title":"æ·±å…¥å‰–æKubernetesä¹‹Dockerç¯‡","slug":"æ·±å…¥å‰–æKubernetesä¹‹Dockerç¯‡","date":"2022-07-01T05:43:41.000Z","updated":"2022-07-05T08:48:08.850Z","comments":true,"path":"2022/07/01/405/","link":"","permalink":"https://github.13sai.com/2022/07/01/405/","excerpt":"","text":"åˆå‡ºèŒ…åºPaaS ä¹‹æ‰€ä»¥èƒ½å¤Ÿå¸®åŠ©ç”¨æˆ·å¤§è§„æ¨¡éƒ¨ç½²åº”ç”¨åˆ°é›†ç¾¤é‡Œï¼Œæ˜¯å› ä¸ºå®ƒæä¾›äº†ä¸€å¥—åº”ç”¨æ‰“åŒ…çš„åŠŸèƒ½ã€‚ç„¶è€Œä¸€æ—¦ç”¨ä¸Šäº† PaaSï¼Œç”¨æˆ·å°±å¿…é¡»ä¸ºæ¯ç§è¯­è¨€ã€æ¯ç§æ¡†æ¶ï¼Œç”šè‡³æ¯ä¸ªç‰ˆæœ¬çš„åº”ç”¨ç»´æŠ¤ä¸€ä¸ªæ‰“å¥½çš„åŒ…ã€‚è¿™ä¸ªæ‰“åŒ…è¿‡ç¨‹ï¼Œæ²¡æœ‰ä»»ä½•ç« æ³•å¯å¾ªï¼Œæ›´éº»çƒ¦çš„æ˜¯ï¼Œæ˜æ˜åœ¨æœ¬åœ°è¿è¡Œå¾—å¥½å¥½çš„åº”ç”¨ï¼Œå´éœ€è¦åšå¾ˆå¤šä¿®æ”¹å’Œé…ç½®å·¥ä½œæ‰èƒ½åœ¨ PaaS é‡Œè¿è¡Œèµ·æ¥ã€‚è€Œè¿™äº›ä¿®æ”¹å’Œé…ç½®ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç»éªŒå¯ä»¥å€Ÿé‰´ï¼ŒåŸºæœ¬ä¸Šå¾—é ä¸æ–­è¯•é”™ï¼Œç›´åˆ°ä½ æ‘¸æ¸…æ¥šäº†æœ¬åœ°åº”ç”¨å’Œè¿œç«¯ PaaS åŒ¹é…çš„â€œè„¾æ°”â€æ‰èƒ½å¤Ÿæå®šã€‚ æœ€åç»“å±€æ˜¯ï¼Œç¡®å®æ˜¯èƒ½ä¸€é”®éƒ¨ç½²äº†ï¼Œä½†æ˜¯ä¸ºäº†å®ç°è¿™ä¸ªä¸€é”®éƒ¨ç½²ï¼Œç”¨æˆ·ä¸ºæ¯ä¸ªåº”ç”¨æ‰“åŒ…çš„å·¥ä½œå¯è°“ä¸€æ³¢ä¸‰æŠ˜ï¼Œè´¹å°½å¿ƒæœºã€‚ Docker çš„å‡ºç°æ”¹å˜äº†è¿™ä¸€ç°çŠ¶ï¼ŒDocker é•œåƒè§£å†³äº†æ‰“åŒ…æ•´ä¸ªæ ¹æœ¬æ€§çš„é—®é¢˜ã€‚è¿™ä¹Ÿæˆä¸ºäº† Docker é¡¹ç›®æˆåŠŸçš„å…³é”®ã€‚ æ‰€è°“ Docker é•œåƒï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ã€‚å¤§å¤šæ•° Docker é•œåƒæ˜¯ç›´æ¥ç”±ä¸€ä¸ªå®Œæ•´æ“ä½œç³»ç»Ÿçš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•æ„æˆçš„ï¼Œæ‰€ä»¥è¿™ä¸ªå‹ç¼©åŒ…é‡Œçš„å†…å®¹è·Ÿä½ æœ¬åœ°å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒç”¨çš„æ“ä½œç³»ç»Ÿæ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ Docker é•œåƒæœ€å‰å®³çš„åœ°æ–¹åœ¨äºï¼Œåªè¦æœ‰è¿™ä¸ªå‹ç¼©åŒ…åœ¨æ‰‹ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨æŸç§æŠ€æœ¯åˆ›å»ºä¸€ä¸ªâ€œæ²™ç›’â€ï¼Œåœ¨â€œæ²™ç›’â€ä¸­è§£å‹è¿™ä¸ªå‹ç¼©åŒ…ï¼Œç„¶åå°±å¯ä»¥è¿è¡Œä½ çš„ç¨‹åºäº†ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ä¸ªå‹ç¼©åŒ…åŒ…å«äº†å®Œæ•´çš„æ“ä½œç³»ç»Ÿæ–‡ä»¶å’Œç›®å½•ï¼Œä¹Ÿå°±æ˜¯åŒ…å«äº†è¿™ä¸ªåº”ç”¨è¿è¡Œæ‰€éœ€è¦çš„æ‰€æœ‰ä¾èµ–ï¼Œæ‰€ä»¥ä½ å¯ä»¥å…ˆç”¨è¿™ä¸ªå‹ç¼©åŒ…åœ¨æœ¬åœ°è¿›è¡Œå¼€å‘å’Œæµ‹è¯•ï¼Œå®Œæˆä¹‹åï¼Œå†æŠŠè¿™ä¸ªå‹ç¼©åŒ…ä¸Šä¼ åˆ°äº‘ç«¯è¿è¡Œã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ å®Œå…¨ä¸éœ€è¦è¿›è¡Œä»»ä½•é…ç½®æˆ–è€…ä¿®æ”¹ï¼Œå› ä¸ºè¿™ä¸ªå‹ç¼©åŒ…èµ‹äºˆäº†ä½ ä¸€ç§æå…¶å®è´µçš„èƒ½åŠ›ï¼šæœ¬åœ°ç¯å¢ƒå’Œäº‘ç«¯ç¯å¢ƒçš„é«˜åº¦ä¸€è‡´ï¼ é‚£ä¹ˆåªéœ€è¦ï¼š docker build &quot;æŸä¸ªé•œåƒ&quot; docker run &quot;æ•´ä¸ªé•œåƒ&quot; Docker é¡¹ç›®ç»™ PaaS ä¸–ç•Œå¸¦æ¥çš„â€œé™ç»´æ‰“å‡»â€ï¼Œå…¶å®æ˜¯æä¾›äº†ä¸€ç§éå¸¸ä¾¿åˆ©çš„æ‰“åŒ…æœºåˆ¶ã€‚è¿™ç§æœºåˆ¶ç›´æ¥æ‰“åŒ…äº†åº”ç”¨è¿è¡Œæ‰€éœ€è¦çš„æ•´ä¸ªæ“ä½œç³»ç»Ÿï¼Œä»è€Œä¿è¯äº†æœ¬åœ°ç¯å¢ƒå’Œäº‘ç«¯ç¯å¢ƒçš„é«˜åº¦ä¸€è‡´ï¼Œé¿å…äº†ç”¨æˆ·é€šè¿‡â€œè¯•é”™â€æ¥åŒ¹é…ä¸¤ç§ä¸åŒè¿è¡Œç¯å¢ƒä¹‹é—´å·®å¼‚çš„ç—›è‹¦è¿‡ç¨‹ã€‚ å´­éœ²å¤´è§’Docker é¡¹ç›®ä¹‹æ‰€ä»¥èƒ½å–å¾—å¦‚æ­¤é«˜çš„å…³æ³¨ï¼Œä¸€æ–¹é¢æ˜¯å®ƒè§£å†³äº†åº”ç”¨æ‰“åŒ…å’Œå‘å¸ƒè¿™ä¸€å›°æ‰°è¿ç»´äººå‘˜å¤šå¹´çš„æŠ€æœ¯éš¾é¢˜ï¼›è€Œå¦ä¸€æ–¹é¢ï¼Œå°±æ˜¯å› ä¸ºå®ƒç¬¬ä¸€æ¬¡æŠŠä¸€ä¸ªçº¯åç«¯çš„æŠ€æœ¯æ¦‚å¿µï¼Œé€šè¿‡éå¸¸å‹å¥½çš„è®¾è®¡å’Œå°è£…ï¼Œäº¤åˆ°äº†æœ€å¹¿å¤§çš„å¼€å‘è€…ç¾¤ä½“æ‰‹é‡Œã€‚ è§£å†³äº†åº”ç”¨æ‰“åŒ…è¿™ä¸ªæ ¹æœ¬æ€§çš„é—®é¢˜ï¼ŒåŒå¼€å‘è€…ä¸ç”Ÿä¿±æ¥çš„çš„äº²å¯†å…³ç³»ï¼Œå†åŠ ä¸Š PaaS æ¦‚å¿µå·²ç»æ·±å…¥äººå¿ƒçš„å®Œç¾å¥‘æœºï¼Œæˆä¸º Docker è¿™ä¸ªæŠ€æœ¯ä¸Šçœ‹ä¼¼å¹³æ·¡æ— å¥‡çš„é¡¹ç›®ä¸€ä¸¾èµ°çº¢çš„é‡è¦åŸå› ã€‚ Docker é¡¹ç›®ä»å‘å¸ƒä¹‹åˆå°±å…¨é¢å‘åŠ›ï¼Œä»æŠ€æœ¯ã€ç¤¾åŒºã€å•†ä¸šã€å¸‚åœºå…¨æ–¹ä½äº‰å–åˆ°çš„å¼€å‘è€…ç¾¤ä½“ï¼Œå®é™…ä¸Šæ˜¯ä¸ºæ­¤åå¸å¼•æ•´ä¸ªç”Ÿæ€åˆ°è‡ªå®¶â€œPaaSâ€ä¸Šçš„ä¸€ä¸ªé“ºå«ã€‚åªä¸è¿‡è¿™æ—¶ï¼Œâ€œPaaSâ€çš„å®šä¹‰å·²ç»å…¨ç„¶ä¸æ˜¯ Cloud Foundry æè¿°çš„é‚£ä¸ªæ ·å­ï¼Œè€Œæ˜¯å˜æˆäº†ä¸€å¥—ä»¥ Docker å®¹å™¨ä¸ºæŠ€æœ¯æ ¸å¿ƒï¼Œä»¥ Docker é•œåƒä¸ºæ‰“åŒ…æ ‡å‡†çš„ã€å…¨æ–°çš„â€œå®¹å™¨åŒ–â€æ€è·¯ã€‚ ç¾¤é›„å¹¶èµ·Docker å…¬å¸åœ¨ 2014 å¹´å°±å·²ç»å®šå¥½äº†å¹³å°åŒ–çš„å‘å±•æ–¹å‘ï¼Œå¹¶ä¸”ç»å¯¹ä¸ä¼šè·Ÿ CoreOS åœ¨å¹³å°å±‚é¢å¼€å±•ä»»ä½•åˆä½œï¼Œåœ¨ 2014 å¹´ 12 æœˆçš„ DockerCon ä¸Šå‘å¸ƒäº† Swarm ã€‚ # å•æœº Docker é¡¹ç›®ï¼š docker run &quot;æˆ‘çš„å®¹å™¨&quot; # å¤šæœº Docker é¡¹ç›®ï¼š docker run -H &quot;æˆ‘çš„ Swarm é›†ç¾¤ API åœ°å€&quot; &quot;æˆ‘çš„å®¹å™¨&quot; Fig é¡¹ç›®ç¬¬ä¸€æ¬¡æå‡ºäº†â€œå®¹å™¨ç¼–æ’â€ï¼ˆContainer Orchestrationï¼‰çš„æ¦‚å¿µï¼Œè¢«æ”¶è´­åæ”¹åä¸º Composeï¼Œå®ƒæˆäº† Docker å…¬å¸åˆ°ç›®å‰ä¸ºæ­¢ç¬¬äºŒå¤§å—æ¬¢è¿çš„é¡¹ç›®ï¼Œä¸€ç›´åˆ°ä»Šå¤©ä¹Ÿä¾ç„¶è¢«å¾ˆå¤šäººä½¿ç”¨ã€‚ ç”±æ­¤ï¼ŒDocker å…¬å¸ Docker Composeã€Swarm å’Œ Machineâ€œä¸‰ä»¶å¥—â€ï¼Œåœ¨é‡æ–°å®šä¹‰ PaaS çš„æ–¹å‘ä¸Šèµ°å‡ºäº†æœ€å…³é”®çš„ä¸€æ­¥ã€‚ è€Œ Mesos ç¤¾åŒºå‡­å€Ÿè¶…å¤§è§„æ¨¡é›†ç¾¤çš„ç®¡ç†ç»éªŒå’Œé€šè¿‡ Marathon å®ç°äº†è¯¸å¦‚åº”ç”¨æ‰˜ç®¡å’Œè´Ÿè½½å‡è¡¡çš„ PaaS åŠŸèƒ½ä¹‹åï¼Œè¿›åŒ–æˆäº†ä¸€ä¸ªé«˜åº¦æˆç†Ÿçš„ PaaS é¡¹ç›®ç»„åˆ Mesos+Marathonï¼Œä»è€Œå æ®äº†å®¹å™¨åŒ–æµªæ½®ä¸­çš„ä¸€å¸­ä¹‹åœ°ã€‚ CoreOSã€RedHat å®Œå…¨åœ¨è¿™ä¸€æ—¶æœŸè¢« Docker å…¬å¸å‹åˆ¶äº†ã€‚ å°˜åŸƒè½å®š2014 å¹´ 6 æœˆï¼ŒGoogle å…¬å¸è¯ç”Ÿ Kubernetes é¡¹ç›®ã€‚è€Œè¿™ä¸ªé¡¹ç›®ï¼Œä¸ä»…æŒ½æ•‘äº†å½“æ—¶çš„ CoreOS å’Œ RedHatï¼Œè¿˜å¦‚åŒå½“å¹´ Docker é¡¹ç›®çš„æ¨ªç©ºå‡ºä¸–ä¸€æ ·ï¼Œå†ä¸€æ¬¡æ”¹å˜äº†æ•´ä¸ªå®¹å™¨å¸‚åœºçš„æ ¼å±€ã€‚ Docker æ€¥é€Ÿæ‰©å¼ çš„åŒæ—¶ï¼Œç¤¾åŒºä¹Ÿå‡ºç°å¯¹ Docker å…¬å¸å•†ä¸šåŒ–æˆ˜ç•¥çš„ç§ç§é¡¾è™‘çš„å£°éŸ³ã€‚Docker å…¬å¸åœ¨ Docker å¼€æºé¡¹ç›®çš„å‘å±•ä¸Šï¼Œå§‹ç»ˆä¿æŒç€ç»å¯¹çš„æƒå¨å’Œå‘è¨€æƒï¼Œå¹¶åœ¨å¤šä¸ªåœºåˆç”¨å®é™…è¡ŒåŠ¨æŒ‘æˆ˜åˆ°äº†å…¶ä»–ç©å®¶ï¼ˆæ¯”å¦‚ï¼ŒCoreOSã€RedHatï¼Œç”šè‡³è°·æ­Œå’Œå¾®è½¯ï¼‰çš„åˆ‡èº«åˆ©ç›Šã€‚ 2015 å¹´ 6 æœˆ 22 æ—¥ï¼Œç”± Docker å…¬å¸ç‰µå¤´ï¼ŒCoreOSã€Googleã€RedHat ç­‰å…¬å¸å…±åŒå®£å¸ƒï¼ŒDocker å…¬å¸å°† Libcontainer æå‡ºï¼Œå¹¶æ”¹åä¸º RunC é¡¹ç›®ï¼Œäº¤ç”±ä¸€ä¸ªå®Œå…¨ä¸­ç«‹çš„åŸºé‡‘ä¼šç®¡ç†ï¼Œç„¶åä»¥ RunC ä¸ºä¾æ®ï¼Œå¤§å®¶å…±åŒåˆ¶å®šä¸€å¥—å®¹å™¨å’Œé•œåƒçš„æ ‡å‡†å’Œè§„èŒƒ OCIï¼ˆ Open Container Initiative ï¼‰ã€‚OCI çš„æå‡ºï¼Œæ„åœ¨å°†å®¹å™¨è¿è¡Œæ—¶å’Œé•œåƒçš„å®ç°ä» Docker é¡¹ç›®ä¸­å®Œå…¨å‰¥ç¦»å‡ºæ¥ã€‚è¿™æ ·åšï¼Œä¸€æ–¹é¢å¯ä»¥æ”¹å–„ Docker å…¬å¸åœ¨å®¹å™¨æŠ€æœ¯ä¸Šä¸€å®¶ç‹¬å¤§çš„ç°çŠ¶ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¸ºå…¶ä»–ç©å®¶ä¸ä¾èµ–äº Docker é¡¹ç›®æ„å»ºå„è‡ªçš„å¹³å°å±‚èƒ½åŠ›æä¾›äº†å¯èƒ½ã€‚ OCI å¹¶æ²¡æœ‰æ”¹å˜ Docker ä¸€å®¶ç‹¬å¤§çš„ç°çŠ¶ï¼Œä½† Googleã€RedHat ç­‰å¼€æºåŸºç¡€è®¾æ–½é¢†åŸŸç©å®¶ä»¬ï¼Œå…±åŒç‰µå¤´å‘èµ·äº†ä¸€ä¸ªåä¸º CNCFï¼ˆCloud Native Computing Foundationï¼‰çš„åŸºé‡‘ä¼šæ”¹å˜äº†ç¤¾åŒºçš„æ ¼å±€ã€‚ CNCF åŸºé‡‘ä¼šçš„ç›®çš„å…¶å®å¾ˆå®¹æ˜“ç†è§£ï¼šå®ƒå¸Œæœ›ï¼Œä»¥ Kubernetes é¡¹ç›®ä¸ºåŸºç¡€ï¼Œå»ºç«‹ä¸€ä¸ªç”±å¼€æºåŸºç¡€è®¾æ–½é¢†åŸŸå‚å•†ä¸»å¯¼çš„ã€æŒ‰ç…§ç‹¬ç«‹åŸºé‡‘ä¼šæ–¹å¼è¿è¥çš„å¹³å°çº§ç¤¾åŒºï¼Œæ¥å¯¹æŠ—ä»¥ Docker å…¬å¸ä¸ºæ ¸å¿ƒçš„å®¹å™¨å•†ä¸šç”Ÿæ€ã€‚ è€Œä¸ºäº†æ‰“é€ å‡ºè¿™æ ·ä¸€ä¸ªå›´ç»• Kubernetes é¡¹ç›®çš„â€œæŠ¤åŸæ²³â€ï¼ŒCNCF ç¤¾åŒºå°±éœ€è¦è‡³å°‘ç¡®ä¿ä¸¤ä»¶äº‹æƒ…ï¼š Kubernetes é¡¹ç›®å¿…é¡»èƒ½å¤Ÿåœ¨å®¹å™¨ç¼–æ’é¢†åŸŸå–å¾—è¶³å¤Ÿå¤§çš„ç«äº‰ä¼˜åŠ¿ CNCF ç¤¾åŒºå¿…é¡»ä»¥ Kubernetes é¡¹ç›®ä¸ºæ ¸å¿ƒï¼Œè¦†ç›–è¶³å¤Ÿå¤šçš„åœºæ™¯ åœ¨å®¹å™¨ç¼–æ’é¢†åŸŸï¼ŒKubernetes é¡¹ç›®éœ€è¦é¢å¯¹æ¥è‡ª Docker å…¬å¸å’Œ Mesos ç¤¾åŒºä¸¤ä¸ªæ–¹å‘çš„å‹åŠ›ã€‚ä¸éš¾çœ‹å‡ºï¼ŒSwarm å’Œ Mesos å®é™…ä¸Šåˆ†åˆ«ä»ä¸¤ä¸ªä¸åŒçš„æ–¹å‘è®²å‡ºäº†è‡ªå·±æœ€æ“…é•¿çš„æ•…äº‹ï¼šSwarm æ“…é•¿çš„æ˜¯è·Ÿ Docker ç”Ÿæ€çš„æ— ç¼é›†æˆï¼Œè€Œ Mesos æ“…é•¿çš„åˆ™æ˜¯å¤§è§„æ¨¡é›†ç¾¤çš„è°ƒåº¦ä¸ç®¡ç†ã€‚ è¿™ä¸¤ä¸ªæ–¹å‘ï¼Œä¹Ÿæ˜¯å¤§å¤šæ•°äººåšå®¹å™¨é›†ç¾¤ç®¡ç†é¡¹ç›®æ—¶æœ€å®¹æ˜“æƒ³åˆ°çš„ä¸¤ä¸ªå‡ºå‘ç‚¹ã€‚ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼ŒKubernetes é¡¹ç›®å¦‚æœç»§ç»­åœ¨è¿™ä¸¤ä¸ªæ–¹å‘ä¸Šåšæ–‡ç« ææ€•å°±ä¸å¤ªæ˜æ™ºäº†ã€‚ æ‰€ä»¥è¿™ä¸€æ¬¡ï¼ŒKubernetes é€‰æ‹©çš„åº”å¯¹æ–¹å¼æ˜¯ï¼šBorgã€‚ å¦‚æœä½ çœ‹è¿‡ Kubernetes é¡¹ç›®æ—©æœŸçš„ GitHub Issue å’Œ Feature çš„è¯ï¼Œå°±ä¼šå‘ç°å®ƒä»¬å¤§å¤šæ¥è‡ªäº Borg å’Œ Omega ç³»ç»Ÿçš„å†…éƒ¨ç‰¹æ€§ï¼Œè¿™äº›ç‰¹æ€§è½åˆ° Kubernetes é¡¹ç›®ä¸Šï¼Œå°±æ˜¯ Podã€Sidecar ç­‰åŠŸèƒ½å’Œè®¾è®¡æ¨¡å¼ã€‚ è¿™å°±è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆ Kubernetes å‘å¸ƒåï¼Œå¾ˆå¤šäººâ€œæŠ±æ€¨â€å…¶è®¾è®¡æ€æƒ³è¿‡äºâ€œè¶…å‰â€çš„åŸå› ï¼šKubernetes é¡¹ç›®çš„åŸºç¡€ç‰¹æ€§ï¼Œå¹¶ä¸æ˜¯å‡ ä¸ªå·¥ç¨‹å¸ˆçªç„¶â€œæ‹è„‘è¢‹â€æƒ³å‡ºæ¥çš„ä¸œè¥¿ï¼Œè€Œæ˜¯ Google å…¬å¸åœ¨å®¹å™¨åŒ–åŸºç¡€è®¾æ–½é¢†åŸŸå¤šå¹´æ¥å®è·µç»éªŒçš„æ²‰æ·€ä¸å‡åã€‚è¿™ï¼Œæ­£æ˜¯ Kubernetes é¡¹ç›®èƒ½å¤Ÿä»ä¸€å¼€å§‹å°±é¿å…åŒ Swarm å’Œ Mesos ç¤¾åŒºåŒè´¨åŒ–çš„é‡è¦æ‰‹æ®µã€‚ CNCF å®ç°äº†ç›®æ ‡ä¸€ä¹‹åçš„ä»»åŠ¡å°±æ˜¯ï¼Œå¦‚ä½•æŠŠè¿™äº›å…ˆè¿›çš„æ€æƒ³é€šè¿‡æŠ€æœ¯æ‰‹æ®µåœ¨å¼€æºç¤¾åŒºè½åœ°ï¼Œå¹¶åŸ¹è‚²å‡ºä¸€ä¸ªè®¤åŒè¿™äº›ç†å¿µçš„ç”Ÿæ€ï¼Ÿè¿™æ—¶ï¼ŒRedHat å°±å‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚ å½“æ—¶ï¼ŒKubernetes å›¢é˜Ÿè§„æ¨¡å¾ˆå°ï¼Œèƒ½å¤ŸæŠ•å…¥çš„å·¥ç¨‹èƒ½åŠ›ä¹Ÿååˆ†ç´§å¼ ï¼Œè€Œè¿™æ°æ°æ˜¯ RedHat çš„é•¿å¤„ã€‚æ›´éš¾å¾—çš„æ˜¯ï¼ŒRedHat æ˜¯ä¸–ç•Œä¸Šä¸ºæ•°ä¸å¤šçš„ã€èƒ½çœŸæ­£ç†è§£å¼€æºç¤¾åŒºè¿ä½œå’Œé¡¹ç›®ç ”å‘çœŸè°›çš„åˆä½œä¼™ä¼´ã€‚ æ‰€ä»¥ï¼ŒRedHat ä¸ Google è”ç›Ÿçš„æˆç«‹ï¼Œä¸ä»…ä¿è¯äº† RedHat åœ¨ Kubernetes é¡¹ç›®ä¸Šçš„å½±å“åŠ›ï¼Œä¹Ÿæ­£å¼å¼€å¯äº†å®¹å™¨ç¼–æ’é¢†åŸŸâ€œä¸‰å›½é¼ç«‹â€çš„å±€é¢ã€‚ ä» 2017 å¹´å¼€å§‹ï¼ŒDocker å…¬å¸å…ˆæ˜¯å°† Docker é¡¹ç›®çš„å®¹å™¨è¿è¡Œæ—¶éƒ¨åˆ† Containerd æèµ ç»™ CNCF ç¤¾åŒºï¼Œæ ‡å¿—ç€ Docker é¡¹ç›®å·²ç»å…¨é¢å‡çº§æˆä¸ºä¸€ä¸ª PaaS å¹³å°ï¼›ç´§æ¥ç€ï¼ŒDocker å…¬å¸å®£å¸ƒå°† Docker é¡¹ç›®æ”¹åä¸º Mobyï¼Œç„¶åäº¤ç»™ç¤¾åŒºè‡ªè¡Œç»´æŠ¤ï¼Œè€Œ Docker å…¬å¸çš„å•†ä¸šäº§å“å°†å æœ‰ Docker è¿™ä¸ªæ³¨å†Œå•†æ ‡ã€‚ Docker å…¬å¸è¿™äº›ä¸¾æªèƒŒåçš„å«ä¹‰éå¸¸æ˜ç¡®ï¼šå®ƒå°†å…¨é¢æ”¾å¼ƒåœ¨å¼€æºç¤¾åŒºåŒ Kubernetes ç”Ÿæ€çš„ç«äº‰ï¼Œè½¬è€Œä¸“æ³¨äºè‡ªå·±çš„å•†ä¸šä¸šåŠ¡ï¼Œå¹¶ä¸”é€šè¿‡å°† Docker é¡¹ç›®æ”¹åä¸º Moby çš„ä¸¾åŠ¨ï¼Œå°†åŸæœ¬å±äº Docker ç¤¾åŒºçš„ç”¨æˆ·è½¬åŒ–æˆäº†è‡ªå·±çš„å®¢æˆ·ã€‚ 2017 å¹´ 10 æœˆï¼ŒDocker å…¬å¸å‡ºäººæ„æ–™åœ°å®£å¸ƒï¼Œå°†åœ¨è‡ªå·±çš„ä¸»æ‰“äº§å“ Docker ä¼ä¸šç‰ˆä¸­å†…ç½® Kubernetes é¡¹ç›®ï¼Œè¿™æ ‡å¿—ç€æŒç»­äº†è¿‘ä¸¤å¹´ä¹‹ä¹…çš„â€œç¼–æ’ä¹‹äº‰â€è‡³æ­¤è½ä¸‹å¸·å¹•ã€‚ 2018 å¹´ 1 æœˆ 30 æ—¥ï¼ŒRedHat å®£å¸ƒæ–¥èµ„ 2.5 äº¿ç¾å…ƒæ”¶è´­ CoreOSã€‚ 2018 å¹´ 3 æœˆ 28 æ—¥ï¼Œè¿™ä¸€åˆ‡çº·äº‰çš„å§‹ä½œä¿‘è€…ï¼ŒDocker å…¬å¸çš„ CTO Solomon Hykes å®£å¸ƒè¾èŒï¼Œæ›¾ç»çº·çº·æ‰°æ‰°çš„å®¹å™¨æŠ€æœ¯åœˆå­ï¼Œåˆ°æ­¤å°˜åŸƒè½å®šã€‚","categories":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/categories/k8s/"}],"tags":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/tags/k8s/"}]},{"title":"gitåˆ é™¤æ•æ„Ÿæ–‡ä»¶çš„æäº¤å†å²","slug":"gitåˆ é™¤æ•æ„Ÿæ–‡ä»¶çš„æäº¤å†å²","date":"2022-06-23T06:49:39.000Z","updated":"2022-06-23T06:56:11.290Z","comments":true,"path":"2022/06/23/403/","link":"","permalink":"https://github.13sai.com/2022/06/23/403/","excerpt":"","text":"ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‡ºç°è¿‡ git è¯¯æäº¤æ•æ„Ÿä¿¡æ¯çš„æƒ…å†µï¼Œå¦‚æœæ˜¯ç§æœ‰åº“è¿˜å¥½ï¼ŒåŠ å…¥æ˜¯å…¬æœ‰åº“å°±éå¸¸å±é™©äº†ï¼Œæˆ‘ä¹‹å‰çš„åº”å¯¹æªæ–½æ˜¯â€”â€“æ•´ä¸ªåº“åˆ é™¤ï¼Œé‡æ–°å»ºä¸ªä»“åº“æäº¤ã€‚ä½†å®é™…æ²¡å¿…è¦è¿™æ ·ï¼Œæ¯”è¾ƒ git history ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ã€‚ # config.yaml ä¸ºæ•æ„Ÿæ–‡ä»¶ git filter-branch --force --index-filter &#x27;git rm --cached --ignore-unmatch config.yaml&#x27; --prune-empty --tag-name-filter cat -- --all # éšä¾¿ä¿®æ”¹ä¸ªæ–‡ä»¶ï¼Œåšç‚¹æ— å…³ç—›ç—’çš„ä¿®æ”¹å•¥çš„ git commit -am &quot;13sai&quot; # å¼ºåˆ¶ push git push origin --force --all Thatâ€™s all!","categories":[{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"}],"tags":[{"name":"git","slug":"git","permalink":"https://github.13sai.com/tags/git/"}]},{"title":"gormè¯»å†™åˆ†ç¦»","slug":"gormè¯»å†™åˆ†ç¦»","date":"2022-06-05T03:47:54.000Z","updated":"2022-07-05T08:49:46.838Z","comments":true,"path":"2022/06/05/402/","link":"","permalink":"https://github.13sai.com/2022/06/05/402/","excerpt":"","text":"ä¹‹å‰åŒäº‹åé¦ˆ MySQL ä¸»åº“å‹åŠ›è¶Šæ¥è¶Šå¤§ï¼Œè™½ç„¶ä¸»ä»åŒæ­¥æ—©å°±å·²ç»æœ‰äº†ï¼Œä½†å‡çº§ gorm ä¹‹åä¸€ç›´æ²¡æœ‰å¼•å…¥è¯»å†™åˆ†ç¦»ï¼Œä¾¿å•†é‡ç€åŠ å…¥è¯»å†™åˆ†ç¦»å‡è½»ä¸»åº“å‹åŠ›ã€‚å¦‚ä»Šå·²ä¸Šçº¿ä¸¤æœˆæœ‰ä½™äº†ï¼Œæ¯”è¾ƒç¨³å®šï¼Œä»Šå¤©æ¥åˆ†äº«ä¸€ä¸‹åˆ©ç”¨ gorm å®ç°è¯»å†™åˆ†ç¦»ã€‚ gorm çš„è¯»å†™åˆ†ç¦»æ˜¯å·²æ‰©å±•æ’ä»¶çš„å½¢å¼å®ç°çš„ï¼Œå³ dbresolver é…ç½®æ–‡ä»¶db: separation: true # é…ç½®æ˜¯å¦ä½¿ç”¨è¯»å†™åˆ†ç¦»ï¼Œæ–¹ä¾¿æ”¹é…ç½®åˆ‡æ¢ master: &quot;root:123456@tcp(127.0.0.1:3306)/a0001_chat?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot; slave: - &quot;root:123456@tcp(127.0.0.1:3307)/a0001_chat?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot; - &quot;root:123456@tcp(127.0.0.1:3308)/a0001_chat?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot; ä¸»è¦ä»£ç package main import ( &quot;fmt&quot; &quot;time&quot; &quot;github.com/pkg/errors&quot; &quot;github.com/sirupsen/logrus&quot; &quot;github.com/spf13/viper&quot; &quot;gorm.io/driver/mysql&quot; &quot;gorm.io/gorm&quot; &quot;gorm.io/plugin/dbresolver&quot; ) var ( MainDB *gorm.DB ) func main() &#123; viper.SetConfigName(&quot;config&quot;) viper.SetConfigType(&quot;yaml&quot;) viper.AddConfigPath(&quot;.&quot;) err := viper.ReadInConfig() if err != nil &#123; panic(fmt.Errorf(&quot;Fatal error config file: %w \\n&quot;, err)) &#125; MainDB, err = ConnectDB() if err != nil &#123; panic(fmt.Errorf(&quot;Fatal MainDB config file: %w \\n&quot;, err)) &#125; err = MainDB.Raw(&quot;select version()&quot;).Error if err != nil &#123; logrus.Infof(&quot;err=%+v&quot;, err) return &#125; logrus.Info(&quot;13sai&quot;) &#125; func ConnectDB() (d *gorm.DB, err error) &#123; if viper.GetBool(&quot;db.separation&quot;) &#123; return ConnectRWDB() &#125; dsn := viper.GetString(&quot;db.master&quot;) d, err = gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;) if err != nil &#123; return nil, errors.Wrap(err, &quot;æ•°æ®åº“è¿æ¥å¤±è´¥&quot;) &#125; db, err := d.DB() if err != nil &#123; return nil, errors.Wrap(err, &quot;è·å–æ•°æ®åº“å®ä¾‹å¤±è´¥&quot;) &#125; db.SetMaxIdleConns(10) db.SetConnMaxLifetime(time.Hour) return d, nil &#125; func ConnectRWDB() (d *gorm.DB, err error) &#123; logrus.Info(&quot;ä½¿ç”¨è¯»å†™åˆ†ç¦»&quot;) dsn := viper.GetString(&quot;db.master&quot;) d, err = gorm.Open(mysql.New(mysql.Config&#123; DSN: dsn, &#125;)) if err != nil &#123; return nil, err &#125; replicas := []gorm.Dialector&#123;&#125; for i, s := range viper.GetStringSlice(&quot;db.slave&quot;) &#123; cfg := mysql.Config&#123; DSN: s, &#125; logrus.Infof(&quot;è¯»å†™åˆ†ç¦»-%d-%s&quot;, i, s) replicas = append(replicas, mysql.New(cfg)) &#125; d.Use( dbresolver.Register(dbresolver.Config&#123; Sources: []gorm.Dialector&#123;mysql.New(mysql.Config&#123; DSN: dsn, &#125;)&#125;, Replicas: replicas, Policy: dbresolver.RandomPolicy&#123;&#125;, &#125;). SetMaxIdleConns(10). SetConnMaxLifetime(time.Hour). SetMaxOpenConns(200), ) return d, nil &#125; ä¸»è¦ä»£ç å°±æ˜¯: d.Use( dbresolver.Register(dbresolver.Config&#123; Sources: []gorm.Dialector&#123;mysql.New(mysql.Config&#123; DSN: dsn, &#125;)&#125;, Replicas: replicas, Policy: dbresolver.RandomPolicy&#123;&#125;, &#125;), ) moreè¿™é‡Œåªæ˜¯åšä¸ªdemoï¼Œçœç•¥äº†ä¸šåŠ¡ä»£ç ï¼Œæ‰€ä»¥æé†’ä¸€ä¸‹ åŠ¡å¿…æµ‹è¯•ä¸‹å…·ä½“ä¸šåŠ¡ æ³¨æ„å†™åç«‹å³è¯»çš„é—®é¢˜ æ³¨æ„dbä¸ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ è¿æ¥æ± å’Œè¶…æ—¶è®¾ç½®æ ¹æ®ä¸šåŠ¡å®šä¹‰ å‚è€ƒ gorm DBResolver","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"gorm","slug":"gorm","permalink":"https://github.13sai.com/tags/gorm/"}]},{"title":"MySQLç´¢å¼•æç¤º-å¼ºåˆ¶ç´¢å¼•å’Œå¿½ç•¥ç´¢å¼•","slug":"MySQLç´¢å¼•æç¤º-å¼ºåˆ¶ç´¢å¼•å’Œå¿½ç•¥ç´¢å¼•","date":"2022-06-02T02:51:03.000Z","updated":"2022-06-05T03:30:06.698Z","comments":true,"path":"2022/06/02/401/","link":"","permalink":"https://github.13sai.com/2022/06/02/401/","excerpt":"","text":"èƒŒæ™¯æ˜¨å¤©åœ¨è¿­ä»£æ–°åŠŸèƒ½æ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œåˆ†äº«ä¸€ä¸‹ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤§è¡¨ï¼Œåƒä¸‡çº§æ•°æ®ï¼Œå¤§æ¦‚ç»“æ„å¦‚ä¸‹ï¼š CREATE TABLE `msg` ( `id` int(11) NOT NULL AUTO_INCREMENT, `uid` bigint(20) NOT NULL COMMENT &#x27;ç”¨æˆ·id&#x27;, `nickname` varchar(128) CHARACTER SET utf8mb4 NOT NULL DEFAULT &#x27;&#x27; COMMENT &#x27;ç”¨æˆ·æ˜µç§°&#x27;, `room_id` int(11) NOT NULL DEFAULT &#x27;0&#x27; COMMENT &#x27;æˆ¿é—´id&#x27;, `msg` varchar(256) CHARACTER SET utf8mb4 DEFAULT NULL, `add_time` int(11) NOT NULL DEFAULT &#x27;0&#x27; COMMENT &#x27;æ·»åŠ æ—¶é—´&#x27;, `del_flag` tinyint(2) NOT NULL DEFAULT &#x27;0&#x27; COMMENT &#x27;åˆ é™¤æ ‡è®°&#x27;, `check_status` tinyint(2) NOT NULL DEFAULT &#x27;0&#x27; COMMENT &#x27;å®¡æ ¸çŠ¶æ€&#x27;, PRIMARY KEY (`id`), KEY `idx` (`room_id`,`add_time`,`check_status`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8; æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š SELECT * FROM `msg` WHERE room_id = 225928 AND (add_time &gt;= 1653926400 and add_time &lt; 1654012800) AND uid not in (1111111,2222222) ORDER BY id desc LIMIT 10; Explain æ‰§è¡Œä¹‹åå‘ç° key æ˜¯ PRIMARYï¼Œ possible_keys æ˜¯ idxã€‚å½“ç„¶ï¼ŒExplain çš„æ˜¾ç¤ºä¿¡æ¯å¹¶ä¸ä¸€å®šæ­£ç¡®ï¼Œå®é™…æŸ¥è¯¢ä¸€ä¸‹è¯•è¯•çœ‹ï¼ˆå»ºè®®åœ¨mysqlè´Ÿè½½ä¸é«˜æ—¶è¯•éªŒï¼Œå¾ˆæ…¢çš„å“¦ï¼‰ æ…¢å‡ºå¤©é™…äº†ï¼ï¼ï¼ è§£é‡Šä¸è§£å†³è¯´æ˜å¯èƒ½å¦‚ Explain æ˜¾ç¤ºï¼Œæ²¡èµ°idxè¿™ä¸ªç´¢å¼•ï¼Œè€Œæ‰«æäº†å…¨è¡¨ã€‚MySQL çš„æŸ¥è¯¢ä¼˜åŒ–å¹¶ä¸å®Œå…¨å¯é ï¼Œå®ƒè®¤ä¸ºå…¨è¡¨æ‰«æä»£ä»·æ›´å°æ—¶ï¼Œä¼šæŒ‰å…¨è¡¨æ‰«æèµ°é€æ¸ç´¢å¼•ã€‚ é‚£ä¹ˆæ€ä¹ˆåŠå‘¢ï¼Ÿ Index Hints ç´¢å¼•æç¤ºMySQL æœ‰ä¸‰ç§ç´¢å¼•æç¤ºï¼š USE ç”¨æŒ‡å®šçš„æŸä¸ªç´¢å¼•å»åšæŸ¥è¯¢ï¼Œä¸å†è€ƒè™‘å…¶ä»–å¯ç”¨çš„ç´¢å¼•ï¼ˆå¯ä»¥æŒ‡å®šå¤šä¸ªç´¢å¼•ï¼Œä½†æ˜¯MySQLä¹Ÿå¯èƒ½ä¸ä¼šç”¨æŒ‡å®šçš„è¿™äº›ç´¢å¼•ï¼‰ FORCE å¼ºåˆ¶MySQLä½¿ç”¨ä¸€ä¸ªç‰¹å®šçš„ç´¢å¼•æŸ¥è¯¢ IGNORE ä¸è¦ä½¿ç”¨æŸäº›ç´¢å¼•æŸ¥è¯¢ ä¸Šé¢é‡åˆ°çš„æƒ…å†µæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Force SELECT * FROM `msg` FORCE INDEX(index_team_id_add_time) WHERE room_id = 225928 AND (add_time &gt;= 1653926400 and add_time &lt; 1654012800) AND uid not in (1111111,2222222) ORDER BY id desc LIMIT 10; æˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹çœ‹çœ‹ï¼šå¤šæµ‹è¯•å‡ æ¬¡ï¼Œå‘ç°ç¡®å®å¿«äº†å¾ˆå¤šï¼Œè¾¾æˆé¢„æœŸæ•ˆæœã€‚ more ç´¢å¼•æç¤ºå»ºè®®é…åˆ explain ä½¿ç”¨ æµ‹è¯•çš„æ—¶å€™åŠ¡å¿…åœ¨æµé‡è°·åº•ï¼Œä»¥å…å½±å“ç”Ÿäº§ å‚è€ƒï¼š Index Hints MySQLç´¢å¼•æç¤º","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"sql","slug":"sql","permalink":"https://github.13sai.com/tags/sql/"}]},{"title":"protoæ–‡ä»¶ç”Ÿæˆgoä»£ç ","slug":"protoæ–‡ä»¶ç”Ÿæˆgoä»£ç ","date":"2022-05-25T15:55:13.000Z","updated":"2022-07-06T02:52:55.110Z","comments":true,"path":"2022/05/25/400/","link":"","permalink":"https://github.13sai.com/2022/05/25/400/","excerpt":"","text":"æœ€è¿‘ä¿®æ”¹å†å²é¡¹ç›®çš„æ—¶å€™ï¼Œæœ‰ä½¿ç”¨åˆ° protoæ–‡ä»¶ç”Ÿæˆgoä»£ç ï¼Œæœ‰è¸©ä¸€ä¸‹å‘ï¼Œåˆ†äº«ä¸€ä¸‹ã€‚ å¼€å§‹å‰å¦‚æœä¸ç†Ÿæ‚‰Protobufè¯­æ³•å¯ä»¥å…ˆçœ‹è¿™ç¯‡-Protobufè¯­æ³•ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ç”Ÿäº§å·¥å…·è¯·å…ˆæ‰§è¡Œï¼š go get -u github.com/golang/protobuf/proto go get -u github.com/golang/protobuf/protoc-gen-go go get -u github.com/micro/micro/v2/cmd/protoc-gen-micro å°è¯•ç¼–å†™ proto æ–‡ä»¶æˆ‘ä»¬å…ˆæ–°å»ºcommon.protoï¼š syntax = &quot;proto3&quot;; //è¯­æ³•å£°æ˜ enum TypeHello &#123; Unuse = 0; Morning = 1; Afernoon = 2; Evening = 3; &#125; protoc ç”Ÿæˆ .pb.goprotoc --proto_path=./ --micro_out=. --go_out=. *.proto é”™è¯¯åˆ†æèƒ½çœ‹åˆ°é”™è¯¯å…¶å®æ˜¯protoc-gen-goæŠ¥å‡ºçš„ï¼Œè§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼š ä½¿ç”¨ go_package å‚æ•° å‘½ä»¤è¡Œä½¿ç”¨â€“go_opt=M æˆ‘æ¯”è¾ƒå»ºè®®ä½¿ç”¨ go_packageï¼Œå½“å¤šä¸ªprotoæ–‡ä»¶æœ‰ä¾èµ–æ—¶ï¼Œä½¿ç”¨ go_package æ¯”è¾ƒæ¸…æ™°ï¼Œä½¿ç”¨ â€“go_opt=M å¯èƒ½è¦éº»çƒ¦å¾—å¤šï¼Œç”šè‡³å‡ºé”™ã€‚è¯¸å¦‚ä»¥ä¸‹ï¼š // common.proto syntax = &quot;proto3&quot;; //è¯­æ³•å£°æ˜ package common; //åŒ…å // go_package ä½¿ç”¨ go mod éœ€è¦çš„è·¯å¾„å³å¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ç§æœ‰ gitlab package option go_package = &quot;github.com/13sai/go-learing/micro/hello/common&quot;; enum TypeHello &#123; Unuse = 0; Morning = 1; Afernoon = 2; Evening = 3; &#125; ç”Ÿæˆæ—¶åŠ¡å¿…åŠ ä¸Š â€“go_out=paths=source_relativeï¼Œå…·ä½“è¯´æ˜å¯è§æ–‡æœ«è¯´æ˜ã€‚ protoc --proto_path=. --go_out=paths=source_relative:. -I=../common *.proto è¿™é‡Œæˆ‘ä»¬ç¨å¾®å¼„å¤æ‚ä¸€ç‚¹ï¼Œhello.proto ä¾èµ– common.proto: syntax = &quot;proto3&quot;; //è¯­æ³•å£°æ˜ import &quot;common.proto&quot;; // ä¾èµ– package hello; option go_package=&quot;github.com/13sai/go-learing/micro/hello/hello&quot;; // å®šä¹‰æœåŠ¡ service Demo &#123; rpc SayHello (HelloRequest) returns (HelloReply) &#123;&#125; &#125; // è¯·æ±‚æ•°æ®æ ¼å¼ message HelloRequest &#123; string name = 1; &#125; // å“åº”æ•°æ®æ ¼å¼ message HelloReply &#123; common.TypeHello hello = 2; string message = 1; &#125; æ³¨æ„è¿™é‡Œå¤šäº†ä¸ª micro_outï¼Œè¿™æ—¶éœ€è¦ protoc-gen-microçš„ï¼Œä¼šå¤šç”Ÿæˆä¸€ä¸ª.pb.micro.goæ–‡ä»¶ã€‚ protoc --proto_path=. --go_out=paths=source_relative:. --micro_out=paths=source_relative:. -I=../common *.proto æ–‡ä»¶ç”Ÿæˆäº†ï¼Œä½¿ç”¨go-microï¼ˆV2ï¼‰å†™ä¸€ä¸ªç®€å•çš„demoã€‚ package main import ( &quot;context&quot; &quot;fmt&quot; &quot;log&quot; &quot;os&quot; &quot;os/signal&quot; &quot;syscall&quot; &quot;time&quot; &quot;github.com/13sai/go-learing/micro/hello/common&quot; &quot;github.com/13sai/go-learing/micro/hello/hello&quot; &quot;github.com/micro/go-micro/v2&quot; _ &quot;github.com/micro/go-plugins/registry/kubernetes/v2&quot; &quot;github.com/sirupsen/logrus&quot; ) const ( ServiceName = &quot;hello-server&quot; ) type HelloServer struct&#123;&#125; func (s *HelloServer) SayHello(ctx context.Context, req *hello.HelloRequest, res *hello.HelloReply) error &#123; res.Message = &quot;hello &quot; + req.Name res.Hello = common.TypeHello_Afernoon return nil &#125; func main() &#123; service := micro.NewService( // Set service name micro.Name(ServiceName), micro.AfterStart(func() error &#123; fmt.Println(&quot;starting...&quot;) return nil &#125;), micro.Address(&quot;:8089&quot;), ) service.Init() hello.RegisterDemoHandler(service.Server(), &amp;HelloServer&#123;&#125;) go func() &#123; if err := service.Run(); err != nil &#123; log.Fatal(err) &#125; &#125;() stop := make(chan os.Signal) signal.Notify(stop, syscall.SIGTERM, syscall.SIGINT, os.Interrupt) go func() &#123; tick := time.NewTicker(3 * time.Second) for &#123; select &#123; case &lt;-stop: tick.Stop() default: &lt;-tick.C client() &#125; &#125; &#125;() select &#123; case &lt;-stop: logrus.Infof(&quot;got exit signal, shutdown&quot;) &#125; &#125; func client() &#123; service := micro.NewService(micro.Name(ServiceName + &quot;client&quot;)) c := hello.NewDemoService(ServiceName, service.Client()) // å‘èµ·RPCè°ƒç”¨ rsp, err := c.SayHello(context.TODO(), &amp;hello.HelloRequest&#123;Name: &quot;13sai&quot;&#125;) if err != nil &#123; fmt.Println(err) &#125; // æ‰“å°è¿”å›å€¼ fmt.Println(rsp.Message) &#125; å¯ä»¥çœ‹åˆ°æˆ‘ä»¬é€šè¿‡protocç”Ÿæˆçš„ä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ morepathsç”Ÿæˆçš„æ–‡ä»¶åœ¨è¾“å‡ºç›®å½•ä¸­çš„.pb.goä½ç½®å–å†³äºâ€“go_out æ ‡è¯†ç¬¦ã€‚æœ‰ä»¥ä¸‹æ¨¡å¼ï¼š paths=import: è¾“å‡ºæ–‡ä»¶å°†æ”¾ç½®åœ¨ä»¥ Go åŒ…çš„å¯¼å…¥è·¯å¾„å‘½åçš„ç›®å½•ä¸­ã€‚ä¾‹å¦‚ï¼Œprotos/buzz.proto å…·æœ‰ Go å¯¼å…¥è·¯å¾„çš„è¾“å…¥æ–‡ä»¶ä¼šexample.com/project/protos/fizz å¯¼è‡´è¾“å‡ºæ–‡ä»¶ä½äºexample.com/project/protos/fizz/buzz.pb.go. paths module=$PREFIX: è¾“å‡ºæ–‡ä»¶å°†æ”¾ç½®åœ¨ä»¥ Go åŒ…çš„å¯¼å…¥è·¯å¾„å‘½åçš„ç›®å½•ä¸­ï¼Œä½†ä»è¾“å‡ºæ–‡ä»¶åä¸­åˆ é™¤æŒ‡å®šçš„ç›®å½•å‰ç¼€ã€‚ä¾‹å¦‚ï¼Œprotos/buzz.proto å…·æœ‰ Go å¯¼å…¥è·¯å¾„example.com/project/protos/fizzå¹¶ example.com/projectæŒ‡å®šä¸ºmoduleå‰ç¼€çš„è¾“å…¥æ–‡ä»¶ä¼šç”Ÿæˆä½äºprotos/fizz/buzz.pb.go. åœ¨æ¨¡å—è·¯å¾„ä¹‹å¤–ç”Ÿæˆä»»ä½• Go åŒ…éƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚æ­¤æ¨¡å¼å¯¹äºå°†ç”Ÿæˆçš„æ–‡ä»¶ç›´æ¥è¾“å‡ºåˆ° Go æ¨¡å—å¾ˆæœ‰ç”¨ã€‚ paths=source_relative: è¾“å‡ºæ–‡ä»¶ä¸è¾“å…¥æ–‡ä»¶æ”¾åœ¨ç›¸åŒçš„ç›¸å¯¹ç›®å½•ä¸­ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥æ–‡ä»¶protos/buzz.proto å¯¼è‡´è¾“å‡ºæ–‡ä»¶ä½äºprotos/buzz.pb.go.é»˜è®¤æ˜¯ç¬¬ä¸€ç§ `paths=import å…¶å®å†™æ–‡ç« çš„æ—¶å€™æˆ‘ä¹Ÿå°è¯•äº†ä¸‹ä½¿ç”¨Mï¼Œæ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š // è¿™é‡Œå†™æ³•æœ‰ç‚¹ç‰¹æ®Šå“¦ï¼Œæ³¨æ„ï¼Œå› ä¸ºæˆ‘æ˜¯åœ¨æ–‡ä»¶åŒä¸€ç›®å½•è¿è¡Œï¼Œæ‰€ä»¥ common.proto=../commonï¼Œè¿™æ ·ç”Ÿæˆçš„packageæ‰ä¼šæ˜¯commonï¼Œè‹¥æ˜¯ common.proto=./ç”Ÿæˆå°±æ˜¯ä¸‹åˆ’çº¿äº† protoc --proto_path=./ --micro_out=. --go_out=. --go_opt=Mcommon.proto=../common *.proto è™½ç„¶è¿™æ ·ä¹Ÿèƒ½ç”Ÿæˆï¼Œä½†ç”Ÿæˆä»£ç å¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼ˆimportéƒ¨åˆ†åªæ˜¯ä¸ªç›¸å¯¹è·¯å¾„ï¼Œæˆ–è®¸æ¢æˆç±»ä¼¼example.com/project/protos/fizzä¹Ÿèƒ½ç”Ÿæˆï¼‰ã€‚å¦‚æœæ„Ÿå…´è¶£ï¼Œæˆ‘æ›´å»ºè®®å¯ä»¥é˜…è¯»å‚è€ƒæ–‡ç« ï¼Œè‡ªè‡ªå·±ï¼Œæˆ‘ç”¨é”™äº†ä¹Ÿæœªå°ä¸å¯èƒ½å‘¢ï¼Ÿ å‚è€ƒ: Go Generated Code How to: use a shared protobuf schema (in golang)","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"Protobuf","slug":"Protobuf","permalink":"https://github.13sai.com/tags/Protobuf/"}]},{"title":"influxdbæ•°æ®è¿ç§»","slug":"influxdbæ•°æ®è¿ç§»","date":"2022-03-07T12:54:12.000Z","updated":"2022-07-05T08:50:48.820Z","comments":true,"path":"2022/03/07/391/","link":"","permalink":"https://github.13sai.com/2022/03/07/391/","excerpt":"","text":"ä¹‹å‰å…¬å¸ç”¨çš„influxdbæ˜¯ç›´æ¥ä¹°çš„influxdbå®ä¾‹ï¼Œæœ€è¿‘å‚å•†äº§å“ä¸‹çº¿ï¼Œä¸å¾—ä¸è¿ç§»åˆ°è‡ªå·±çš„æœºå™¨ï¼Œä»¥ä¸‹æ˜¯è¿ç§»è¿‡ç¨‹ã€‚ è€ƒè™‘ç”Ÿäº§æœ‰ç°æˆçš„k8sé›†ç¾¤ï¼Œinfluxdbå®˜ç½‘æ–‡æ¡£ä¹Ÿæœ‰k8séƒ¨ç½²è¯´æ˜ï¼Œä¾¿ç›´æ¥å°†influxdbéƒ¨ç½²åˆ°k8sä¸­ã€‚ï¼ˆç‰ˆæœ¬1.8.x) éƒ¨ç½²æ–°çš„influxdbéƒ¨ç½²çš„yamlæ–‡ä»¶å¦‚ä¸‹ï¼š # å•ç‹¬å¼„ä¸ªns influxdb apiVersion: v1 kind: Namespace metadata: name: influxdb --- # é…ç½®æ–‡ä»¶å¼„ä¸ªConfigMapï¼Œä¾¿äºä¿®æ”¹ apiVersion: v1 kind: ConfigMap metadata: name: influxdb-config namespace: influxdb data: influxdb.conf: &gt;- [meta] dir = &quot;/var/lib/influxdb/meta&quot; [coordinator] log-queries-after = &quot;60s&quot; max-select-series = 10000 write-timeout = &quot;30s&quot; [data] dir = &quot;/var/lib/influxdb/data&quot; engine = &quot;tsm1&quot; wal-dir = &quot;/var/lib/influxdb/wal&quot; cache-max-memory-size = &quot;0&quot; cache-snapshot-memory-size = &quot;256m&quot; index-version = &quot;tsi1&quot; max-index-log-file-size = &quot;64k&quot; max-series-per-database = 3000000 max-values-per-tag = 100000 --- ## æŒ‚ä¸ªPersistentVolumeClaim apiVersion: v1 kind: PersistentVolumeClaim metadata: name: influxdb-data namespace: influxdb spec: accessModes: - ReadWriteOnce storageClassName: csi-xxx # è‡ªè¡Œé…ç½® resources: requests: storage: 8Gi # æŒ‰éœ€é…ç½®ï¼Œå­˜å‚¨æ•°æ®è¾ƒå¤šå¯é€‚å½“æ”¾å¤§ --- apiVersion: apps/v1 kind: StatefulSet metadata: labels: app: influxdb name: influxdb namespace: influxdb spec: replicas: 1 selector: matchLabels: app: influxdb serviceName: influxdb template: metadata: labels: app: influxdb spec: containers: - image: uhub.service.ucloud.cn/tv1234pub/influxdb:1.8.10 name: influxdb ports: - containerPort: 8086 name: influxdb volumeMounts: - mountPath: /var/lib/influxdb name: data - name: influxdb-config mountPath: /etc/influxdb/influxdb.conf readOnly: true subPath: influxdb.conf volumes: - name: data persistentVolumeClaim: claimName: influxdb-data - name: timezone-config hostPath: path: /usr/share/zoneinfo/Asia/Shanghai - name: influxdb-config configMap: defaultMode: 0600 name: influxdb-config --- apiVersion: v1 kind: Service metadata: name: influxdb namespace: influxdb spec: ports: - name: influxdb port: 8086 targetPort: 8086 selector: app: influxdb type: ClusterIP dump å†å²æ•°æ®dump éœ€è¦å¼€å¯ 8088 ç«¯å£ influxd backup -portable -host 172.16.xx.xxx:8088 sai-snapshot æ¢å¤æ•°æ®ä¸Šä¼  kubectl cp -r sai-snapshot influxdb/influxdb-0:/root/ influxd restore -portable ./sai-snapshot éªŒè¯influxå®¢æˆ·ç«¯æŸ¥éªŒæ•°æ®å³å¯ã€‚","categories":[{"name":"sql","slug":"sql","permalink":"https://github.13sai.com/categories/sql/"}],"tags":[{"name":"influxdb","slug":"influxdb","permalink":"https://github.13sai.com/tags/influxdb/"}]},{"title":"vimå¿«æ·æ“ä½œåˆ é™¤,ç§»åŠ¨","slug":"vimå¿«æ·æ“ä½œåˆ é™¤","date":"2022-02-24T07:29:32.000Z","updated":"2022-03-19T14:35:21.818Z","comments":true,"path":"2022/02/24/390/","link":"","permalink":"https://github.13sai.com/2022/02/24/390/","excerpt":"","text":"æ¨¡å¼ å‘½ä»¤æ¨¡å¼(è¿›å…¥å³æ­¤æ¨¡å¼) è¾“å…¥æ¨¡å¼(è¾“å…¥iåˆ‡æ¢åˆ°æ­¤æ¨¡å¼) åº•çº¿å‘½ä»¤æ¨¡å¼(ESCç„¶å:) å¸¸ç”¨ï¼ˆä¸ç‰¹æ®Šè¯´æ˜éƒ½åœ¨å‘½ä»¤æ¨¡å¼ï¼Œå¸¦:çš„åº•çº¿å‘½ä»¤æ¨¡å¼ï¼‰ç©ºæ ¼é”® å‘å³ç§»åŠ¨ä¸€æ ¼ x åˆ é™¤åé¢çš„å­—ç¬¦,åˆ é™¤3ä¸ªå­—ç¬¦å°±æ˜¯3x X åˆ é™¤å‰ä¸€ä¸ªå­—ç¬¦ dd åˆ é™¤ä¸€è¡Œ D åˆ é™¤åˆ°è¡Œå°¾ caw æ”¹å†™å•è¯ J åˆ é™¤æ¢è¡Œç¬¦ï¼Œä½¿ä¸‹ä¸€è¡Œå¹¶ä¸Šæ¥,nJ:è¿æ¥åé¢çš„nè¡Œ u æ’¤é”€ä¸Šä¸€æ¬¡æ“ä½œ U æ’¤é”€å½“å‰è¡Œçš„æ‰€æœ‰ä¿®æ”¹ i åœ¨å…‰æ ‡å‰æ’å…¥ I åœ¨è¡Œé¦–æ’å…¥ a åœ¨å…‰æ ‡åæ’å…¥ A åœ¨è¡Œæœ«æ’å…¥ o åœ¨å½“å‰è¡Œçš„ä¸‹é¢å¦èµ·ä¸€è¡Œï¼Œå¹¶å˜ä¸ºæ’å…¥æ¨¡å¼ O åœ¨å½“å‰è¡Œä¸Šé¢å¦èµ·ä¸€è¡Œï¼Œå˜ä¸ºæ’å…¥æ¨¡å¼ bã€3bã€wã€3w å‘å‰\\åç§»åŠ¨å‡ ä¸ªå•è¯ï¼Œæ ‡ç‚¹ä¹Ÿç®—ä¸€ä¸ªå•è¯ã€‚ç›¸åº”çš„å¤§å†™çŠ¶æ€ä¸ºä¸å«æ ‡ç‚¹ï¼Œå³åªæŠŠç©ºæ ¼å’Œæ¢è¡Œç¬¦ä½œä¸ºå•è¯é—´éš”ç¬¦ã€‚ $ ç§»åŠ¨åˆ°è¡Œå°¾ï¼Œ3$ç§»åŠ¨åˆ°3è¡Œåçš„è¡Œå°¾ ^ ç§»åŠ¨åˆ°è¡Œé¦–ï¼Œ0ä¹Ÿæ˜¯ + ç§»åˆ°ä¸‹ä¸€è¡Œçš„è¡Œé¦– - ç§»åˆ°ä¸Šä¸€è¡Œçš„è¡Œé¦– f æœç´¢å‘½ä»¤ï¼Œå°å†™æ—¶å‘åæœç´¢ï¼ˆç”¨æ¥å®šä½ï¼‰å¦‚ fxï¼šå®šä½åˆ°ä¸‹ä¸€ä¸ªxä¸Š Fx å®šä½åˆ°ä¸Šä¸€ä¸ªxä¸Šï¼Œé‡å¤æ—¶ï¼Œå¯ç”¨;æˆ–, ä¸è¿‡ , è¡¨ç¤ºåæ–¹å‘ % è·³åˆ°ç›¸å¯¹åº”çš„æ‹¬å·ä¸Šï¼Œç¼–ç¨‹æ—¶å¸¸ç”¨ 33G è·³è½¬åˆ°33è¡Œ æ­¤æ—¶æŒ‰``å¯ä»¥è¿”å›åˆ°åŸæ¥è¡Œ gg æ–‡ä»¶å¤´ G æ–‡ä»¶å°¾ 30% è·³è½¬åˆ°æ–‡ä»¶çš„30%å¤„ Hä¸ºHome Mä¸ºMiddle Lä¸ºLastå½“å‰å±å¹•çš„ä¸Šä¸­ä¸‹ä½ç½®ï¼Œå¤§å°å†™çš†å¯ Ctrl+G:æ˜¾ç¤ºå½“å‰ä½ç½® set number:è®¾ç½®æ˜¾ç¤ºè¡Œå·ï¼Œset nonumber:å…³é—­æ˜¾ç¤º ctrl+u\\d å‘ä¸Š\\ä¸‹æ»šåŠ¨åŠå± ctrl+e\\y å‘ä¸Š\\ä¸‹æ»šåŠ¨ä¸€è¡Œ ctrl+b\\f å‘ä¸Š\\ä¸‹æ»šåŠ¨ä¸€å± è¿™ä¸ªæ¯”è¾ƒå®ç”¨ï¼Œè®°ä½ã€‚ zz å°†å½“å‰è¡Œæ»šåŠ¨äºå±å¹•ä¸­é—´ï¼Œæ–¹ä¾¿æŸ¥çœ‹ä¸Šä¸‹æ–‡ zt ç½®é¡¶ zb ç½®å°¾ /string æŸ¥æ‰¾stringï¼Œå›è½¦åï¼ŒæŒ‰né”®å¯ä»¥è·³åˆ°ä¸‹ä¸€ä¸ªï¼ŒNä¸Šä¸€ä¸ªï¼Œå¦å¤–æŒ‰/é”®åï¼ŒæŒ‰ä¸Šä¸‹é”®å¯ä»¥æ‰¾åˆ°ä»¥å‰æŸ¥æ‰¾çš„è®°å½•ï¼ŒåŒæ ·çš„ ï¼šä¹Ÿæœ‰è®°å½• ?/string åŒä¸Šï¼Œé»˜è®¤å‘ä¸ŠæŸ¥æ‰¾ % åŒ¹é…åˆ°ç›¸åº”æ‹¬å·å¤„ &gt;&gt; å‘å³ç§»åŠ¨æœ¬è¡Œä¸€æ®µè·ç¦» &lt;&lt; å‘å·¦ç§»åŠ¨æœ¬è¡Œä¸€æ®µè·ç¦» 3&lt;&lt; æŠŠä¸‹é¢3è¡Œï¼ˆåŒ…æ‹¬æœ¬è¡Œï¼‰ï¼Œå‘å·¦ç§»åŠ¨ä¸€æ®µè·ç¦» :20,30&gt;&gt; æŠŠ20è¡Œåˆ°30è¡Œå‘å³ç§»åŠ¨ä¸€æ®µè·ç¦» :set ignorecase å¤§å°å†™æ— å…³ :set noignorecase å¤§å°å†™æ•æ„Ÿ * æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå…‰æ ‡æ‰€åœ¨å•è¯ # æŸ¥æ‰¾ä¸Šä¸€ä¸ª :set hlsearch é«˜äº®æ˜¾ç¤ºæŸ¥æ‰¾ç»“æœ :set nohlsearch å–æ¶ˆé«˜äº® :nohlsearch å»æ‰å½“å‰æ˜¾ç¤ºçš„é«˜å®Œï¼ˆä¸€æ¬¡æ€§ï¼‰ :set paste æ ¼å¼åŒ–ç²˜è´´ :set ruler è®¾ç½®åœ¨çª—å£å³ä¸‹è§’æ˜¾ç¤ºè¡Œå·ï¼Œä¸ä¸Šé¢çš„å¥½å¤„æ˜¯ï¼ŒèŠ‚çœç©ºé—´ :wq ä¿å­˜é€€å‡º :q! ä¸¢å¼ƒä¿®æ”¹é€€å‡º :q æ­£å¸¸é€€å‡º","categories":[{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"}],"tags":[{"name":"vim","slug":"vim","permalink":"https://github.13sai.com/tags/vim/"}]},{"title":"goæ€§èƒ½å·¥å…·pprof","slug":"goæ€§èƒ½å·¥å…·pprof","date":"2022-01-29T13:07:38.000Z","updated":"2022-03-19T14:35:21.703Z","comments":true,"path":"2022/01/29/385/","link":"","permalink":"https://github.13sai.com/2022/01/29/385/","excerpt":"","text":"Go è¯­è¨€è‡ªå¸¦çš„ pprof åº“å°±å¯ä»¥åˆ†æç¨‹åºçš„è¿è¡Œæƒ…å†µï¼Œå¹¶ä¸”æä¾›å¯è§†åŒ–çš„åŠŸèƒ½ã€‚å®ƒåŒ…å«ä¸¤ä¸ªç›¸å…³çš„åº“ï¼š runtime/pprofå¯¹äºåªè·‘ä¸€æ¬¡çš„ç¨‹åºï¼Œä¾‹å¦‚æ¯å¤©åªè·‘ä¸€æ¬¡çš„ç¦»çº¿é¢„å¤„ç†ç¨‹åºï¼Œè°ƒç”¨ pprof åŒ…æä¾›çš„å‡½æ•°ï¼Œæ‰‹åŠ¨å¼€å¯æ€§èƒ½æ•°æ®é‡‡é›†ã€‚ net/http/pprofå¯¹äºåœ¨çº¿æœåŠ¡ï¼Œå¯¹äºä¸€ä¸ª HTTP Serverï¼Œè®¿é—® pprof æä¾›çš„ HTTP æ¥å£ï¼Œè·å¾—æ€§èƒ½æ•°æ®ã€‚å½“ç„¶ï¼Œå®é™…ä¸Šè¿™é‡Œåº•å±‚ä¹Ÿæ˜¯è°ƒç”¨çš„ runtime/pprof æä¾›çš„å‡½æ•°ï¼Œå°è£…æˆæ¥å£å¯¹å¤–æä¾›ç½‘ç»œè®¿é—®ã€‚ å› ä¸ºè‡ªå·±ç”¨ginæ¯”è¾ƒå¤šï¼Œæ‰€ä»¥ä½¿ç”¨github.com/gin-contrib/pprofï¼Œå…¶å®å†…éƒ¨ä¹Ÿå°±æ˜¯ä¸Šé¢ä¸¤ä¸ªåº“ã€‚ä½¿ç”¨éå¸¸ç®€å•ã€‚ var debugHttp *http.Server func runPPROF() &#123; g := gin.New() g.Use(gin.Recovery()) g.Use(gin.Logger()) pprof.Register(g) // ä½¿ç”¨9000ç«¯å£å¼€å¯httpæœåŠ¡ debugHttp = &amp;http.Server&#123; Addr: &quot;:9000&quot;, Handler: g, &#125; debugHttp.ListenAndServe() &#125; å¼€å¯ä¹‹åå¯ä»¥webè®¿é—® http://127.0.0.1:9000/debug/pprof/å¯ä»¥æŸ¥çœ‹å®æ—¶æ•°æ®ï¼Œ å½“ç„¶ä¹Ÿå¯ä»¥æŸ¥çœ‹æŸä¸ªæ—¶é—´æ®µçš„æ€§èƒ½æƒ…å†µï¼š // ç›‘å¬60sæ€§èƒ½æƒ…å†µï¼Œé»˜è®¤è¿›å…¥å‘½ä»¤è¡Œ go tool pprof http://127.0.0.1:9000/debug/pprof/profile\\?seconds\\=60 // æœ¬åœ°å¯åŠ¨httpæœåŠ¡æŸ¥çœ‹ï¼Œéœ€è¦è£…graphvizæ’ä»¶ go tool pprof -http=:8080 ~/pprof/pprof.go.samples.cpu.032.pb.gz å¯ä»¥åˆ‡æ¢çœ‹å ç”¨æœ€é«˜çš„ï¼Œè¿˜æœ‰ç«ç„°å›¾ç­‰ç­‰ï¼Œç›¸å½“å¥½ç”¨ï¼Œä¸€èˆ¬æ€§èƒ½ç“¶é¢ˆå°±åœ¨å ç”¨æ¯”è¾ƒå¤šçš„ã€‚ PS: æœ‰æ—¶å€™çº¿ä¸Šå¯èƒ½æ²¡æœ‰å¼€å¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨perfå»debugæŸ¥çœ‹å ç”¨èµ„æºæ¯”è¾ƒå¤šçš„ã€‚ // 19323 ç«¯å£å· perf record -p 19323 perf report å‚è€ƒï¼š æ·±åº¦è§£å¯†Goè¯­è¨€ä¹‹ pprof","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"supervisord","slug":"supervisord","date":"2022-01-29T12:37:04.000Z","updated":"2022-03-19T14:35:21.805Z","comments":true,"path":"2022/01/29/384/","link":"","permalink":"https://github.13sai.com/2022/01/29/384/","excerpt":"","text":"ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½ç”¨è¿‡ python ç‰ˆæœ¬çš„ supervisor ï¼Œé‚£ä¹ˆä½ çŸ¥é“ go ç‰ˆæœ¬çš„ supervisor å—ï¼Ÿ ochinchina/supervisordochinchina/supervisordæºç  ä¸‹è½½åœ°å€ æºç å®‰è£…ï¼š git clone https://github.com/ochinchina/supervisord.git // åˆ‡æ¢åˆ°éœ€è¦çš„ç‰ˆæœ¬åˆ†æ”¯ git checkout v0.7.3 // linux ç¼–è¯‘å®‰è£… // 64ä½ç‰ˆæœ¬ env GOOS=linux GOARCH=amd64 go build -o supervisord_linux_amd64 é…ç½®æ–‡ä»¶demo // å†…ç½‘åœ°å€ [inet_http_server] port = :9001 // UIåœ°å€ [supervisorctl] serverurl=http://127.0.0.1:9001 // è¿›ç¨‹é…ç½® [program:hello] directory = Work/golang/ command = stdout_logfile = stderr_logfile = autostart = true user= // depends_on=B, C å¯åŠ¨å‘½ä»¤ supervisord -c supervisor.conf -d ctl å‘½ä»¤ // ä¸æ˜¯9001ç«¯å£ï¼ŒåŠ¡å¿…æŒ‡å®š-så‚æ•° supervisord ctl -s=http://localhost:9010 status supervisord ctl -s=http://localhost:9010 status program-1 program-2... supervisord ctl -s=http://localhost:9010 status group:* supervisord ctl stop program-1 program-2... supervisord ctl stop group:* supervisord ctl stop all supervisord ctl -s=http://localhost:9010 start program-1 program-2... supervisord ctl start group:* supervisord ctl start all supervisord ctl shutdown supervisord ctl reload supervisord ctl signal &lt;signal_name&gt; &lt;process_name&gt; &lt;process_name&gt; ... supervisord ctl signal all supervisord ctl pid &lt;process_name&gt; supervisord ctl fg &lt;process_name&gt;","categories":[{"name":"supervisord","slug":"supervisord","permalink":"https://github.13sai.com/categories/supervisord/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"goå®ç°LRU","slug":"goå®ç°LRU","date":"2022-01-16T02:25:25.000Z","updated":"2022-07-05T08:48:45.113Z","comments":true,"path":"2022/01/16/383/","link":"","permalink":"https://github.13sai.com/2022/01/16/383/","excerpt":"","text":"å‰ä¸€æ®µæ—¶é—´é‡æ„èŠå¤©æœåŠ¡çš„æ—¶å€™ï¼Œéœ€è¦å®šæœŸå»æ£€æµ‹Cç«¯é•¿è¿æ¥çš„æ´»è·ƒæƒ…å†µï¼Œå½“æ£€æµ‹åˆ°é•¿é“¾æ¥å¤±å»å¿ƒè·³60såï¼Œä¸»åŠ¨é‡Šæ”¾æ‰ä»¥èŠ‚çœå†…å­˜å¼€é”€ã€‚éœ€è¦æ£€æµ‹æ‰€æœ‰çš„é•¿è¿æ¥æ˜¾ç„¶æ˜¯ä¸å¤ªæ˜æ™ºçš„åšæ³•ï¼Œå› è€Œæƒ³åˆ°äº†ä½¿ç”¨LRUç®—æ³•ï¼Œä»æœ€ä¸æ´»è·ƒçš„è¿æ¥æ£€æµ‹ï¼Œå½“æ£€æµ‹åˆ°æŸä¸ªè¿æ¥çš„æ´»è·ƒæ—¶é—´å¤§äºæœ€è¿‘ä¸€åˆ†é’Ÿï¼Œåç»­çš„è¿æ¥å°±æ— éœ€æ£€æµ‹äº†ã€‚ LRUï¼ˆLeast Recently Usedï¼‰ç®—æ³•æ˜¯ä¸€ç§å¸¸ç”¨çš„ç¼“å­˜æ·˜æ±°ç­–ç•¥ç®—æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯â€œå¦‚æœæ•°æ®æœ€è¿‘è¢«è®¿é—®è¿‡ï¼Œé‚£ä¹ˆå°†æ¥è¢«è®¿é—®çš„å‡ ç‡ä¹Ÿæ›´é«˜â€ã€‚ package lru import ( &quot;container/list&quot; ) type Link struct &#123; ID int ActiveTime int &#125; type Lru struct &#123; maxSize int // æœ€å¤§å®¹é‡ list *list.List // é“¾è¡¨ cache map[*Link]*list.Element // map &#125; func newLru(max int) *Lru &#123; return &amp;Lru&#123; maxSize: max, cache: map[*Link]*list.Element&#123;&#125;, list: list.New(), &#125; &#125; func (l *Lru) Push(key *Link) &#123; // å·²å­˜åœ¨ï¼Œè°ƒæ•´é“¾è¡¨é¡ºåº if e, ok := l.cache[key]; ok &#123; l.list.MoveToFront(e) &#125; else &#123; row := l.list.PushFront(key) l.cache[key] = row &#125; // æˆ‘è¿™é‡Œæ— éœ€æ£€æµ‹é•¿åº¦ for l.maxSize &gt; 0 &amp;&amp; l.list.Len() &gt; l.maxSize &#123; l.removePassive() &#125; &#125; func (l *Lru) CheckPassive() (*Link, bool) &#123; e := l.list.Back() if e == nil &#123; return nil, false &#125; link := e.Value.(*Link) return link, true &#125; func (l *Lru) Remove(key *Link) &#123; if e, ok := l.cache[key]; ok &#123; l.list.Remove(e) delete(l.cache, key) &#125; &#125; func (l *Lru) Len() int &#123; return l.list.Len() &#125; func (l *Lru) removePassive() &#123; e := l.list.Back() l.list.Remove(e) delete(l.cache, e.Value.(*Link)) &#125; æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ï¼š package lru import &quot;testing&quot; func TestLRU(t *testing.T) &#123; lru := newLru(10) for i := 0; i &lt; 20; i++ &#123; link1 := &amp;Link&#123;i, i + 1642262400&#125; lru.Push(link1) &#125; old, _ := lru.CheckPassive() t.Logf(&quot;CheckPassive:%+v&quot;, old) t.Log(&quot;len=&quot;, lru.Len()) for true &#123; item, ok := lru.CheckPassive() if !ok &#123; break &#125; t.Logf(&quot;Remove:%+v&quot;, item) lru.Remove(item) &#125; old, _ = lru.CheckPassive() t.Logf(&quot;CheckPassive:%+v&quot;, old) t.Log(&quot;len=&quot;, lru.Len()) &#125; æˆ‘ä»¬çœ‹ä¸€ä¸‹è¾“å‡ºï¼š çœ‹æ•ˆæœæ˜¯okçš„ã€‚åˆ«ç€æ€¥åº”ç”¨åˆ°é¡¹ç›®ä¸­ï¼Œè®°å¾—å‹æµ‹å¯¹æ¯”ä¸‹å†å®æ–½å“¦ï¼ å‚è€ƒï¼š golang å®ç° LRU","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"goæœ‰ç¼“å†²channelå’Œæ— ç¼“å†²channel","slug":"goæœ‰ç¼“å†²channelå’Œæ— ç¼“å†²channel","date":"2022-01-11T09:50:27.000Z","updated":"2022-07-05T08:49:10.960Z","comments":true,"path":"2022/01/11/382/","link":"","permalink":"https://github.13sai.com/2022/01/11/382/","excerpt":"","text":"æˆ‘ä»¬éƒ½çŸ¥é“é€šé“ï¼ˆchannelï¼‰åˆ†ä¸¤ç§ï¼š ç¼“å†²é€šé“ éç¼“å†²é€šé“// ç¼“å†²é€šé“ ch1 := make(chan int, 10) ch2 := make(chan bool, 2) // éç¼“å†²é€šé“ ch3 := make(chan int) ch4 := make(chan bool, 0) å‘é€é€šé“æ•°æ®// åˆ›å»ºä¸€ä¸ªç©ºæ¥å£é€šé“ï¼Œæ³¨æ„å®šä¹‰çš„é€šé“ç±»å‹æœ‰ ch := make(chan interface&#123;&#125;) // å°†0æ”¾å…¥é€šé“ä¸­ ch &lt;- 0 // å°†helloå­—ç¬¦ä¸²æ”¾å…¥é€šé“ä¸­ ch &lt;- &quot;hello&quot; æ¥æ”¶é€šé“æ•°æ® é˜»å¡æ¥æ”¶æ•°æ® data := &lt;-ch æ‰§è¡Œè¯¥è¯­å¥æ—¶å°†ä¼šé˜»å¡ï¼Œç›´åˆ°æ¥æ”¶åˆ°æ•°æ®å¹¶èµ‹å€¼ç»™ data å˜é‡ã€‚ éé˜»å¡æ¥æ”¶æ•°æ® // dataï¼šè¡¨ç¤ºæ¥æ”¶åˆ°çš„æ•°æ®ã€‚æœªæ¥æ”¶åˆ°æ•°æ®æ—¶ï¼Œdata ä¸ºé€šé“ç±»å‹çš„é›¶å€¼ // okï¼šè¡¨ç¤ºæ˜¯å¦æ¥æ”¶åˆ°æ•°æ®ã€‚ data, ok := &lt;-ch éé˜»å¡çš„é€šé“æ¥æ”¶æ–¹æ³•å¯èƒ½é€ æˆé«˜çš„ CPU å ç”¨ï¼Œå› æ­¤ä½¿ç”¨éå¸¸å°‘ã€‚å¦‚æœéœ€è¦å®ç°æ¥æ”¶è¶…æ—¶æ£€æµ‹ï¼Œå¯ä»¥é…åˆ select å’Œè®¡æ—¶å™¨ channel è¿›è¡Œï¼Œå¯ä»¥å‚è§åé¢çš„å†…å®¹ã€‚ æ¥æ”¶ä»»æ„æ•°æ®ï¼Œå¿½ç•¥æ¥æ”¶çš„æ•°æ® &lt;-ch å¾ªç¯æ¥æ”¶ package main import ( &quot;fmt&quot; &quot;time&quot; ) func main() &#123; ch := make(chan int) // å¼€å¯ä¸€ä¸ªå¹¶å‘åŒ¿åå‡½æ•° go func() &#123; for i := 3; i &gt;= 0; i-- &#123; ch &lt;- i time.Sleep(time.Second) &#125; &#125;() // éå†æ¥æ”¶é€šé“æ•°æ® for data := range ch &#123; fmt.Println(data) if data == 0 &#123; break &#125; &#125; &#125; å…³é—­é€šé“ch := make(chan string) ... close(ch) é€šé“ç‰¹æ€§: åŒä¸€ä¸ªé€šé“ï¼Œå‘é€æ“ä½œä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œæ¥æ”¶æ“ä½œä¹‹é—´ä¹Ÿæ˜¯äº’æ–¥çš„ï¼ˆå¹¶å‘å®‰å…¨ï¼‰ å‘é€æ“ä½œå’Œæ¥æ”¶æ“ä½œä¸­å¯¹å…ƒç´ å€¼çš„å¤„ç†éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„ã€‚ å‘é€æ“ä½œåœ¨å®Œå…¨å®Œæˆä¹‹å‰ä¼šè¢«é˜»å¡ï¼Œæ¥æ”¶æ“ä½œä¹Ÿæ˜¯ä¸€æ ·ã€‚ å¯¹äºç¼“å†²é€šé“ï¼šå¦‚æœé€šé“å·²æ»¡ï¼Œé‚£ä¹ˆå¯¹å®ƒçš„æ‰€æœ‰å‘é€æ“ä½œéƒ½ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é€šé“ä¸­æœ‰å…ƒç´ å€¼è¢«æ¥æ”¶èµ°ï¼›å¦‚æœé€šé“å·²ç©ºï¼Œé‚£ä¹ˆå¯¹å®ƒçš„æ‰€æœ‰æ¥æ”¶æ“ä½œéƒ½ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é€šé“ä¸­æœ‰æ–°çš„å…ƒç´ å€¼å‡ºç°ã€‚å¯¹äºéç¼“å†²é€šé“ï¼šæ— è®ºæ˜¯å‘é€æ“ä½œè¿˜æ˜¯æ¥æ”¶æ“ä½œï¼Œä¸€å¼€å§‹æ‰§è¡Œå°±ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é…å¯¹çš„æ“ä½œä¹Ÿå¼€å§‹æ‰§è¡Œï¼Œæ‰ä¼šç»§ç»­ä¼ é€’ã€‚ æ³¨æ„ç‚¹ï¼šå…³é—­é€šé“è¦åœ¨å‘é€æ–¹å…³é—­ï¼Œå…³é—­åå¦‚æœchannelå†…è¿˜æœ‰å…ƒç´ ï¼Œå¹¶ä¸ä¼šå¯¹æ¥ä¸‹æ¥çš„æ¥æ”¶äº§ç”Ÿå½±å“å•å‘é€šé“æœ€ä¸»è¦çš„ç”¨é€”å°±æ˜¯çº¦æŸå…¶ä»–ä»£ç çš„è¡Œä¸ºé€šè¿‡å‡½æ•°çš„å‚æ•°ç±»å‹æˆ–è€…è¿”å›å€¼ç±»å‹æ¥é™åˆ¶ï¼ˆGoçš„è¯­æ³•ç³–ï¼‰ã€‚ func(ch chan&lt;- int) //ä¼ å…¥åŒå‘é€šé“ï¼Œåœ¨å‡½æ•°é‡Œé¢è°ƒç”¨chåªèƒ½å‘é€ func() (ch &lt;-chan int) //è¿”å›åŒå‘é€šé“ï¼Œåœ¨å‡½æ•°å¤–é¢é‡Œé¢è°ƒç”¨chåªèƒ½æ¥æ”¶ é‚£ä¹ˆéç¼“å†²é€šé“æ˜¯ä¸æ˜¯å°±æ˜¯ç¼“å†²sizeä¸º1çš„ç¼“å†²é€šé“å‘¢ï¼Ÿæˆ‘ä»¬æ¥æµ‹è¯•ä¸‹ï¼š func TestChan(t *testing.T) &#123; ch := make(chan int) ch &lt;- 1 go func() &#123; &lt;-ch &#125;() ch &lt;- 2 &#125; func TestChan2(t *testing.T) &#123; ch := make(chan int, 1) ch &lt;- 1 go func() &#123; &lt;-ch &#125;() ch &lt;- 2 &#125; go test è¿è¡Œä¸€ä¸‹ï¼Œä¼šå‘ç°TestChané˜»å¡ä½äº†ï¼Œch &lt;- 1 ä¸èƒ½å†™åœ¨go func å‰é¢ï¼Œé‚£ä¹ˆéç¼“å†²é€šé“æ˜¾ç„¶ä¸æ˜¯å°±æ˜¯ç¼“å†²sizeä¸º1çš„ç¼“å†²é€šé“ã€‚éç¼“å†²é€šé“åƒæ˜¯ä»¥å‰çš„å¿«é€’å‘˜ï¼Œå¿…é¡»æœ‰æ”¶è´§äººå½“é¢æ¥æ”¶æˆåŠŸï¼Œå¦åˆ™ä»–ä¼šç­‰ç€ä½ é€è´§ï¼Œæœ‰ç¼“å†²é€šé“æ›´åƒæ˜¯ç°åœ¨çš„å¿«é€’å‘˜ï¼Œç›´æ¥æ”¾åœ¨é©¿ç«™æˆ–è€…å¿«é€’æŸœï¼Œé™¤éé©¿ç«™å¿«é€’æŸœæ»¡äº†ï¼Œå¦åˆ™ä»–å°±èƒ¡å¡ï¼Œä¸ç®¡ä½ åœ¨ä¸åœ¨å®¶ï¼Œæœ‰æ²¡æœ‰æ¥æ”¶æˆåŠŸã€‚","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"kubebuilderå®æˆ˜ä¹‹äºŒ","slug":"kubebuilderå®æˆ˜ä¹‹äºŒ","date":"2021-11-30T11:59:29.000Z","updated":"2022-03-19T14:35:21.758Z","comments":true,"path":"2021/11/30/382/","link":"","permalink":"https://github.13sai.com/2021/11/30/382/","excerpt":"","text":"æ–°å»ºé¡¹ç›® go mod init elastic-web kubebuilder init â€“domain com.13sai kubebuilder create api --group sai --version v1 --kind ElasticWeb /* Copyright 2021. Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. */ package v1 import ( &quot;fmt&quot; &quot;github.com/spf13/cast&quot; metav1 &quot;k8s.io/apimachinery/pkg/apis/meta/v1&quot; ) type ElasticWebSpec struct &#123; // é•œåƒ Image string `json:&quot;image&quot;` // ç«¯å£ Port *int `json:&quot;port&quot;` // å•ä¸ª pod çš„ qps SingleQPS *int `json:&quot;singleQPS&quot;` // æ€» qps TotalQPS *int `json:&quot;totalQPS&quot;` &#125; // ElasticWebStatus defines the observed state of ElasticWeb type ElasticWebStatus struct &#123; // å®é™… qps RealQPS *int `json:&quot;realQPS&quot;` &#125; type ElasticWeb struct &#123; metav1.TypeMeta `json:&quot;,inline&quot;` metav1.ObjectMeta `json:&quot;metadata,omitempty&quot;` Spec ElasticWebSpec `json:&quot;spec,omitempty&quot;` Status ElasticWebStatus `json:&quot;status,omitempty&quot;` &#125; func (web *ElasticWeb) String() string &#123; realQPS := &quot;&quot; if web.Status.RealQPS == nil &#123; realQPS = &quot;nil&quot; &#125; else &#123; realQPS = cast.ToString(*web.Status.RealQPS) &#125; return fmt.Sprintf(&quot;Image [%s], Port [%d], SingleQPS [%d], TotalQPS [%d], RealQPS [%s]&quot;, web.Spec.Image, *web.Spec.Port, *web.Spec.SingleQPS, *web.Spec.TotalQPS, realQPS) &#125; // ElasticWebList contains a list of ElasticWeb type ElasticWebList struct &#123; metav1.TypeMeta `json:&quot;,inline&quot;` metav1.ListMeta `json:&quot;metadata,omitempty&quot;` Items []ElasticWeb `json:&quot;items&quot;` &#125; func init() &#123; SchemeBuilder.Register(&amp;ElasticWeb&#123;&#125;, &amp;ElasticWebList&#123;&#125;) &#125; è®¾ç½®RBACæƒé™ï¼š elasticweb_controller.go: //+kubebuilder:rbac:groups=k8s.com.13sai,resources=elasticwebs,verbs=get;list;watch;create;update;patch;delete //+kubebuilder:rbac:groups=k8s.com.13sai,resources=elasticwebs/status,verbs=get;update;patch //+kubebuilder:rbac:groups=k8s.com.13sai,resources=elasticwebs/finalizers,verbs=update // RBAC æ–°å¢ //+kubebuilder:rbac:groups=apps,resources=deployments,verbs=get;list;watch;create;update;patch;delete //+kubebuilder:rbac:groups=core,resources=services,verbs=get;list;watch;create;update;patch;delete ä»£ç æ¯”è¾ƒæ¯ç‡¥ï¼Œä¸»è¦æ–¹æ³•éƒ½åœ¨controllerï¼Œ getExpectReplicas createServiceIfNotExists createDeployment Reconcile(é»˜è®¤) å¯å‚è€ƒï¼šhttps://github.com/13sai/kubebuilder-demo/tree/master/elasticWeb ç¼–ç å®Œæˆåï¼š make install kubectl api-versions|grep â€œk8s.comâ€ æœ€åå¯ä»¥æ‰§è¡Œ make run apiVersion: v1 kind: Namespace metadata: name: sai-test labels: name: test --- apiVersion: k8s.com.13sai/v1 kind: ElasticWeb metadata: namespace: sai-test name: elasticweb-sample spec: # Add fields here image: nginx:1.20.2-alpine port: 80 singleQPS: 1000 totalQPS: 8800 kubectl apply -f config/samples/k8s_v1_elasticweb.yaml å‚è€ƒï¼š kubebuilderå®æˆ˜ä¹‹äº”ï¼šoperatorç¼–ç ","categories":[{"name":"Kubernetes","slug":"Kubernetes","permalink":"https://github.13sai.com/categories/Kubernetes/"}],"tags":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/tags/k8s/"}]},{"title":"kubebuilderå®æˆ˜ä¹‹ä¸€","slug":"kubebuilderå®æˆ˜ä¹‹ä¸€","date":"2021-11-21T13:26:42.000Z","updated":"2022-07-05T08:52:49.153Z","comments":true,"path":"2021/11/21/381/","link":"","permalink":"https://github.13sai.com/2021/11/21/381/","excerpt":"","text":"å®‰è£…å‡†å¤‡ï¼šdockerã€kubectlã€golang å®‰è£… kustomizecd $GOPATH/bin GOBIN=$(pwd)/ GO111MODULE=on go get sigs.k8s.io/kustomize/kustomize/v3 å®‰è£… kubebuilderæ ¹æ®ä½ ç”µè„‘çš„ GOOS å’Œ GOARCH å»ä¸‹è½½ å¯¹åº”çš„ç‰ˆæœ¬ï¼Œç„¶åæŠŠæ–‡ä»¶æŒªåˆ° /usr/local/bin/kubebuilderï¼Œæ‰§è¡Œ kubebuilder version mkdir -p $GOPATH/src/sai cd $GOPATH/src/sai # åŠ¡å¿…åœ¨gopathç›®å½•æ‰§è¡Œï¼Œå¦åˆ™æŠ¥é”™ kubebuilder init --domain com.sai # å¯æœ‰å¯æ— çš„ä¸€æ­¥ go mod tidy # make make âœ sai tree â”œâ”€â”€ Dockerfile â”œâ”€â”€ Makefile â”œâ”€â”€ PROJECT â”œâ”€â”€ bin â”‚ â”œâ”€â”€ controller-gen â”‚ â””â”€â”€ manager â”œâ”€â”€ config â”‚ â”œâ”€â”€ default â”‚ â”‚ â”œâ”€â”€ kustomization.yaml â”‚ â”‚ â”œâ”€â”€ manager_auth_proxy_patch.yaml â”‚ â”‚ â””â”€â”€ manager_config_patch.yaml â”‚ â”œâ”€â”€ manager â”‚ â”‚ â”œâ”€â”€ controller_manager_config.yaml â”‚ â”‚ â”œâ”€â”€ kustomization.yaml â”‚ â”‚ â””â”€â”€ manager.yaml â”‚ â”œâ”€â”€ prometheus â”‚ â”‚ â”œâ”€â”€ kustomization.yaml â”‚ â”‚ â””â”€â”€ monitor.yaml â”‚ â””â”€â”€ rbac â”‚ â”œâ”€â”€ auth_proxy_client_clusterrole.yaml â”‚ â”œâ”€â”€ auth_proxy_role.yaml â”‚ â”œâ”€â”€ auth_proxy_role_binding.yaml â”‚ â”œâ”€â”€ auth_proxy_service.yaml â”‚ â”œâ”€â”€ kustomization.yaml â”‚ â”œâ”€â”€ leader_election_role.yaml â”‚ â”œâ”€â”€ leader_election_role_binding.yaml â”‚ â”œâ”€â”€ role_binding.yaml â”‚ â””â”€â”€ service_account.yaml â”œâ”€â”€ go.mod â”œâ”€â”€ go.sum â”œâ”€â”€ hack â”‚ â””â”€â”€ boilerplate.go.txt â””â”€â”€ main.go 7 directories, 26 files åˆ›å»ºAPI(CRDå’ŒController)kubebuilder create api --version v1beta1 --kind Sai --group sai âœ sai tree . â”œâ”€â”€ Dockerfile â”œâ”€â”€ Makefile â”œâ”€â”€ PROJECT â”œâ”€â”€ api â”‚ â””â”€â”€ v1beta1 â”‚ â”œâ”€â”€ groupversion_info.go â”‚ â”œâ”€â”€ sai_types.go â”‚ â””â”€â”€ zz_generated.deepcopy.go â”œâ”€â”€ bin â”‚ â”œâ”€â”€ controller-gen â”‚ â””â”€â”€ manager â”œâ”€â”€ config â”‚ â”œâ”€â”€ crd â”‚ â”‚ â”œâ”€â”€ kustomization.yaml â”‚ â”‚ â”œâ”€â”€ kustomizeconfig.yaml â”‚ â”‚ â””â”€â”€ patches â”‚ â”‚ â”œâ”€â”€ cainjection_in_sais.yaml â”‚ â”‚ â””â”€â”€ webhook_in_sais.yaml â”‚ â”œâ”€â”€ default â”‚ â”‚ â”œâ”€â”€ kustomization.yaml â”‚ â”‚ â”œâ”€â”€ manager_auth_proxy_patch.yaml â”‚ â”‚ â””â”€â”€ manager_config_patch.yaml â”‚ â”œâ”€â”€ manager â”‚ â”‚ â”œâ”€â”€ controller_manager_config.yaml â”‚ â”‚ â”œâ”€â”€ kustomization.yaml â”‚ â”‚ â””â”€â”€ manager.yaml â”‚ â”œâ”€â”€ prometheus â”‚ â”‚ â”œâ”€â”€ kustomization.yaml â”‚ â”‚ â””â”€â”€ monitor.yaml â”‚ â”œâ”€â”€ rbac â”‚ â”‚ â”œâ”€â”€ auth_proxy_client_clusterrole.yaml â”‚ â”‚ â”œâ”€â”€ auth_proxy_role.yaml â”‚ â”‚ â”œâ”€â”€ auth_proxy_role_binding.yaml â”‚ â”‚ â”œâ”€â”€ auth_proxy_service.yaml â”‚ â”‚ â”œâ”€â”€ kustomization.yaml â”‚ â”‚ â”œâ”€â”€ leader_election_role.yaml â”‚ â”‚ â”œâ”€â”€ leader_election_role_binding.yaml â”‚ â”‚ â”œâ”€â”€ role_binding.yaml â”‚ â”‚ â”œâ”€â”€ sai_editor_role.yaml â”‚ â”‚ â”œâ”€â”€ sai_viewer_role.yaml â”‚ â”‚ â””â”€â”€ service_account.yaml â”‚ â””â”€â”€ samples â”‚ â””â”€â”€ sai_v1beta1_sai.yaml â”œâ”€â”€ controllers â”‚ â”œâ”€â”€ sai_controller.go â”‚ â””â”€â”€ suite_test.go â”œâ”€â”€ go.mod â”œâ”€â”€ go.sum â”œâ”€â”€ hack â”‚ â””â”€â”€ boilerplate.go.txt â””â”€â”€ main.go 13 directories, 38 files æ„å»ºå’Œéƒ¨ç½²CRD make install outputï¼š Unable to connect to the server: dial tcp: lookup kubernetes.docker.internal on 192.168.0.1:53: no such host make: *** [install] Error 1 æŠŠ127.0.0.1 kubernetes.docker.internal åŠ å…¥æœ¬åœ°hostsé‡æ–°æ‰§è¡Œmake install å³å¯ã€‚ /Users/sai/go/src/sai/bin/controller-gen rbac:roleName=manager-role crd webhook paths=&quot;./...&quot; output:crd:artifacts:config=config/crd/bases /Users/sai/go/src/sai/bin/kustomize build config/crd | kubectl apply -f -customresourcedefinition.apiextensions.k8s.io/sais.sai.com.sai created ç¼–è¯‘å’Œè¿è¡Œcontroller æ‰“å¼€ /Users/sai/go/src/sai/controllers/sai_controller.go , è‡ªè¡Œå¢åŠ é€»è¾‘ã€‚ Demo: func (r *SaiReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) &#123; _ = log.FromContext(ctx) // TODO(user): your logic here fmt.Println(&quot;------sai builder used by 13sai-----&quot;) return ctrl.Result&#123;&#125;, nil &#125; # sai.yaml apiVersion: sai.com.sai/v1beta1 kind: Sai metadata: name: sai-demo kubectl apply -f sai.yaml âœ kubectl get Sai NAME AGE sai-demo 79s åˆ¶ä½œdockeré•œåƒä¿®æ”¹ä¸‹dockerfile # Build the manager binary FROM golang:1.16 as builder WORKDIR /workspace # Copy the Go Modules manifests COPY go.mod go.mod COPY go.sum go.sum # cache deps before building and copying source so that we don&#x27;t need to re-download as much # and so that source changes don&#x27;t invalidate our downloaded layer # æ”¹æ”¹æ”¹è¿™é‡Œ------ RUN go env -w GOPROXY=https://goproxy.cn,direct RUN go mod download # Copy the go source COPY main.go main.go COPY api/ api/ COPY controllers/ controllers/ # Build RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -a -o manager main.go # Use distroless as minimal base image to package the manager binary # Refer to https://github.com/GoogleContainerTools/distroless for more details # æ”¹æ”¹æ”¹è¿™é‡Œ------ FROM katanomi/distroless-static:nonroot WORKDIR / COPY --from=builder /workspace/manager . USER 65532:65532 ENTRYPOINT [&quot;/manager&quot;] make docker-build docker-push IMG=13sai/kubebuilder-demo æ“ä½œæˆåŠŸå³å¯ï¼ å‚è€ƒï¼š kubebuilderå®æˆ˜ä¹‹ä¸€ï¼šå‡†å¤‡å·¥ä½œkubebuilderå®æˆ˜ä¹‹ä¸€ï¼šå‡†å¤‡å·¥ä½œ","categories":[{"name":"Kubernetes","slug":"Kubernetes","permalink":"https://github.13sai.com/categories/Kubernetes/"}],"tags":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/tags/k8s/"}]},{"title":"ElasticSearchçš„ILMé”™è¯¯é—®é¢˜æ’æŸ¥","slug":"ElasticSearchçš„ILMé”™è¯¯é—®é¢˜æ’æŸ¥","date":"2021-11-15T14:24:30.000Z","updated":"2022-03-19T14:35:21.578Z","comments":true,"path":"2021/11/15/380/","link":"","permalink":"https://github.13sai.com/2021/11/15/380/","excerpt":"","text":"ä»Šå¤©çœ‹åˆ°ç”Ÿäº§çš„esé›†ç¾¤æœ‰æŠ¥é”™ï¼š &#123;&quot;type&quot;: &quot;server&quot;, &quot;timestamp&quot;: &quot;2021-11-15T14:19:15,189Z&quot;, &quot;level&quot;: &quot;ERROR&quot;, &quot;component&quot;: &quot;o.e.x.i.IndexLifecycleRunner&quot;, &quot;cluster.name&quot;: &quot;elasticsearch&quot;, &quot;node.name&quot;: &quot;elasticsearch-master-2&quot;, &quot;message&quot;: &quot;policy [sai-log] for index [sai-detail-2021-11-02] failed on step [&#123;\\&quot;phase\\&quot;:\\&quot;hot\\&quot;,\\&quot;action\\&quot;:\\&quot;rollover\\&quot;,\\&quot;name\\&quot;:\\&quot;check-rollover-ready\\&quot;&#125;]. Moving to ERROR step&quot;, &quot;cluster.uuid&quot;: &quot;dscxSgouRw--mhyuj5Y2fw&quot;, &quot;node.id&quot;: &quot;9yklgtqpTNuQU25hIOWkxQ&quot; , &quot;stacktrace&quot;: [&quot;java.lang.IllegalArgumentException: setting [index.lifecycle.rollover_alias] for index [sai-detail-2021-11-02] is empty or not defined&quot;, &quot;at org.elasticsearch.xpack.core.ilm.WaitForRolloverReadyStep.evaluateCondition(WaitForRolloverReadyStep.java:65) [x-pack-core-7.10.1.jar:7.10.1]&quot;, &quot;at org.elasticsearch.xpack.ilm.IndexLifecycleRunner.runPeriodicStep(IndexLifecycleRunner.java:174) [x-pack-ilm-7.10.1.jar:7.10.1]&quot;, &quot;at org.elasticsearch.xpack.ilm.IndexLifecycleService.triggerPolicies(IndexLifecycleService.java:327) [x-pack-ilm-7.10.1.jar:7.10.1]&quot;, &quot;at org.elasticsearch.xpack.ilm.IndexLifecycleService.triggered(IndexLifecycleService.java:265) [x-pack-ilm-7.10.1.jar:7.10.1]&quot;, &quot;at org.elasticsearch.xpack.core.scheduler.SchedulerEngine.notifyListeners(SchedulerEngine.java:183) [x-pack-core-7.10.1.jar:7.10.1]&quot;, &quot;at org.elasticsearch.xpack.core.scheduler.SchedulerEngine$ActiveSchedule.run(SchedulerEngine.java:216) [x-pack-core-7.10.1.jar:7.10.1]&quot;, &quot;at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) [?:?]&quot;, &quot;at java.util.concurrent.FutureTask.run(FutureTask.java:264) [?:?]&quot;, &quot;at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) [?:?]&quot;, &quot;at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130) [?:?]&quot;, &quot;at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630) [?:?]&quot;, &quot;at java.lang.Thread.run(Thread.java:832) [?:?]&quot;] &#125; è·ŸåŒäº‹ä¸€èµ·æŸ¥çœ‹äº†ä¸‹ï¼Œå‘ç°kibanaçš„Index Managementç•Œé¢ï¼Œæœ‰é”™è¯¯æç¤ºï¼š åé¢åŒäº‹ä¿®æ”¹äº†ILMï¼Œé”™è¯¯æ¶ˆå¤±ã€‚ ä¸‹ç­å›å®¶ï¼Œå»æŸ¥äº†æ—¥å¿—ï¼Œå‘ç°é”™è¯¯ä»åœ¨ï¼Œçœ‹æ¥ç¾èª‰è§£å†³é—®é¢˜ï¼Œ GET /sai-log-2021-11-13/_ilm/explain outputï¼š &#123; &quot;indices&quot; : &#123; &quot;sai-log-2021-11-13&quot; : &#123; &quot;index&quot; : &quot;sai-log-2021-11-13&quot;, &quot;managed&quot; : false &#125; &#125; &#125; POST /sai-log-2021-11-13/_ilm/retry output: &#123; &quot;error&quot; : &#123; &quot;root_cause&quot; : [ &#123; &quot;type&quot; : &quot;illegal_argument_exception&quot;, &quot;reason&quot; : &quot;cannot retry an action for an index [sai-log-2021-11-13] that has not encountered an error when running a Lifecycle Policy&quot; &#125; ], &quot;type&quot; : &quot;illegal_argument_exception&quot;, &quot;reason&quot; : &quot;cannot retry an action for an index [sai-log-2021-11-13] that has not encountered an error when running a Lifecycle Policy&quot; &#125;, &quot;status&quot; : 400 &#125; å‰å¾€kibanaçš„ILMç•Œé¢ï¼Œç»‘å®šILMç­–ç•¥åˆ°index template GET /sai-log-2021-11-13/_ilm/explain output: &#123; &quot;indices&quot; : &#123; &quot;sai-log-2021-11-13&quot; : &#123; &quot;index&quot; : &quot;sai-log-2021-11-13&quot;, &quot;managed&quot; : true, &quot;policy&quot; : &quot;sai-log&quot;, &quot;lifecycle_date_millis&quot; : 1636732801982, &quot;age&quot; : &quot;2.94d&quot;, &quot;phase&quot; : &quot;hot&quot;, &quot;phase_time_millis&quot; : 1636986555834, &quot;action&quot; : &quot;rollover&quot;, &quot;action_time_millis&quot; : 1636733356166, &quot;step&quot; : &quot;check-rollover-ready&quot;, &quot;step_time_millis&quot; : 1636986555834, &quot;is_auto_retryable_error&quot; : true, &quot;failed_step_retry_count&quot; : 211, &quot;phase_execution&quot; : &#123; &quot;policy&quot; : &quot;sai-log&quot;, &quot;phase_definition&quot; : &#123; &quot;min_age&quot; : &quot;0ms&quot;, &quot;actions&quot; : &#123; &quot;rollover&quot; : &#123; &quot;max_size&quot; : &quot;30gb&quot;, &quot;max_age&quot; : &quot;60d&quot; &#125; &#125; &#125;, &quot;version&quot; : 3, &quot;modified_date_in_millis&quot; : 1636960453087 &#125; &#125; &#125; &#125; è§£å†³äº†ï¼Ÿ å‰å¾€kibanaçš„Index Managementç•Œé¢ï¼Œä¾æ—§å­˜åœ¨ 42 indices have lifecycle errorsã€‚ æ‰‹åŠ¨æ¥ä¸€ä¸‹ï¼š POST /sai-log-2021-11-13/_ilm/retry output: &#123; &quot;acknowledged&quot; : true &#125; é‡å¤explainï¼Œå‘ç°è¾“å‡ºä¸€è‡´ï¼Œå†å»kibanaçš„Index Managementç•Œé¢ç…ç…ï¼š è¿˜æœ‰ä¸€ä¸ªï¼Œretryå‘½ä»¤å¤„ç†ä¸‹å³å¯ã€‚ åŸºæœ¬ç®—æ˜¯è§£å†³äº†ã€‚ å‚è€ƒï¼š Troubleshooting index lifecycle management errorse","categories":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://github.13sai.com/categories/ElasticSearch/"}],"tags":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://github.13sai.com/tags/ElasticSearch/"}]},{"title":"MACé‡ç½®ç³»ç»Ÿåå„ç§è½¯ä»¶å®‰è£…","slug":"MACé‡ç½®ç³»ç»Ÿåå„ç§è½¯ä»¶å®‰è£…","date":"2021-10-30T06:22:19.000Z","updated":"2022-03-19T14:35:21.611Z","comments":true,"path":"2021/10/30/376/","link":"","permalink":"https://github.13sai.com/2021/10/30/376/","excerpt":"","text":"å‰ä¸€é˜µMBPçš„ç”µæ± å‡ºç°é—®é¢˜ï¼Œé‡ç½®äº†ç³»ç»Ÿï¼Œäºæ˜¯æœ‰äº†ä¸‹é¢è¿™äº›ã€‚ åŸºç¡€ç±»gitæ‰“å¼€gitä¸‹è½½åœ°å€ ä¸‹è½½gitåå®‰è£…å³å¯ï¼Œä½œä¸ºå¼€å‘è€…ï¼Œgitåº”è¯¥æ˜¯åŸºç¡€ï¼Œbrewå¯¹gitä¹Ÿæœ‰ä¾èµ–ï¼Œæˆ‘ä¸€å¼€å§‹å°±è£…ä¸Šã€‚ å®‰è£…brewbrew å®Œå…¨æ˜¯ä¸ºäº†å®‰è£…å„ç§è½¯ä»¶æ–¹ä¾¿ã€‚ /bin/zsh -c &quot;$(curl -fsSL https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh)&quot; å®‰è£…oh my zshç¾åŒ–ä¸€ä¸‹å‘½ä»¤è¡Œï¼Œçœ‹ç€å¿ƒæƒ…æ„‰æ‚¦ã€‚ sh -c &quot;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)&quot; è®¾ç½®è¯­æ³•é«˜äº® â€“ zsh-syntax-highlighting git clone https://github.com/zsh-users/zsh-syntax-highlighting.git echo â€œsource ${(q-)PWD}/zsh-syntax-highlighting/zsh-syntax-highlighting.zshâ€ &gt;&gt; ${ZDOTDIR:-$HOME}/.zshrc source ./zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ç¾åŒ–ä¹‹åèˆ’æœå¤šäº†ã€‚ å‘½ä»¤è¡Œè¡¥å…¨https://mimosa-pudica.net/zsh-incremental.html cd ~/.oh-my-zsh/plugins/ mkdir -p incr cd incr å°†ä¸Šé¢é“¾æ¥ä¸‹è½½çš„æ–‡ä»¶ç§»åŠ¨åˆ°incræ–‡ä»¶å¤¹ä¸­ echo &quot;source ~/.oh-my-zsh/plugins/incr/incr*.zsh&quot; &gt;&gt; ~/.zshrc source ~/.zshrc å®‰è£…å„ç§è½¯ä»¶brew å‚»ç“œå¼å®‰è£…æœ‰äº†brew ä»¥åå®‰è£…ååˆ†ç®€å• brew install node brew install yarn brew install mysql@5.7 ....... yarnå’Œnpmå»ºè®®æ›¿æ¢å›½å†…æºï¼ˆå¼€VPNå°±ä¸éœ€è¦äº†ï¼‰ï¼š // yarn ğŸŒ° yarn config set registry https://registry.npm.taobao.org yarn config set sass_binary_site &quot;https://npm.taobao.org/mirrors/node-sass/&quot; yarn config set phantomjs_cdnurl &quot;http://cnpmjs.org/downloads&quot; yarn config set electron_mirror &quot;https://npm.taobao.org/mirrors/electron/&quot; yarn config set sqlite3_binary_host_mirror &quot;https://foxgis.oss-cn-shanghai.aliyuncs.com/&quot; yarn config set profiler_binary_host_mirror &quot;https://npm.taobao.org/mirrors/node-inspector/&quot; yarn config set chromedriver_cdnurl &quot;https://cdn.npm.taobao.org/dist/chromedriver&quot; å®˜ç½‘å®‰è£…è€Œåƒredis è¿™ç±»ï¼Œç»å¸¸éœ€è¦æ”¹é…ç½®ç”šè‡³æ˜¯å®éªŒå¸ƒç½®é›†ç¾¤çš„ï¼Œæˆ‘è¿˜æ˜¯ä¹ æƒ¯å®˜ç½‘ä¸‹è½½å®‰è£…ï¼Œä¾¿äºæ“ä½œé…ç½®ã€å„ç§æ£é¼“ã€‚ http://download.redis.io/releases/redis-6.0.6.tar.gz æ­¤å¤–ï¼Œdockerã€vscodeã€go è¿™ç±»éƒ½å¯ä»¥å‰å¾€å®˜ç½‘ä¸‹è½½ï¼Œä¸‹é¢ä»¥ go ä¸ºä¾‹ã€‚ å¯¹äºvscodeã€è°·æ­Œæµè§ˆå™¨ç­‰æä¾›äº†è´¦å·åŒæ­¥çš„ï¼Œå»ºè®®é‡ç½®ç³»ç»Ÿå‰è®¾ç½®åŒæ­¥ï¼Œåç»­é‡æ–°å®‰è£…ç™»å½•åŒæ­¥ä¹¦ç­¾ã€é…ç½®ã€æ’ä»¶ç­‰ï¼Œç®€ç›´æ˜¯å¤ªçˆ½äº†ã€‚ å®‰è£… gohttps://golang.google.cn/dl/ ä¸‹è½½éœ€è¦çš„ç‰ˆæœ¬å³å¯ã€‚ ç®€å•é…ç½®ï¼š // ä½¿ç”¨ goproxy.cn ä»£ç†åŠ é€Ÿ go env -w GOPROXY=https://goproxy.cn // ç§æœ‰ä»“åº“ go env -w GOPRIVATE=git.13sai.cn git config --global url.&quot;git@git.13sai.cn:&quot;.insteadOf https://git.13sai.cn å…¶ä»–å…¶ä»–è½¯ä»¶å¯æŒ‰éœ€å‰å¾€appstoreæˆ–è½¯ä»¶å®˜ç½‘å³å¯ï¼Œå»ºè®®å®˜ç½‘ä¸‹è½½æ›´å¿«ã€‚","categories":[{"name":"mac","slug":"mac","permalink":"https://github.13sai.com/categories/mac/"}],"tags":[{"name":"mac","slug":"mac","permalink":"https://github.13sai.com/tags/mac/"}]},{"title":"goä½¿ç”¨ç§æœ‰module","slug":"goä½¿ç”¨ç§æœ‰module","date":"2021-10-30T06:08:34.000Z","updated":"2022-03-19T14:35:21.698Z","comments":true,"path":"2021/10/30/375/","link":"","permalink":"https://github.13sai.com/2021/10/30/375/","excerpt":"","text":"å‡å¦‚è‡ªå»ºgitï¼Œä½†åˆéœ€è¦ä½¿ç”¨é‡Œé¢çš„åº“ï¼Œå°±éœ€è¦é…ç½®ç§æœ‰ä»“åº“å¯ç”¨ã€‚ å¦‚æœæ²¡æœ‰é…ç½®git ssh keyï¼Œå¯å‚ç…§gitè§£å†³æ€»è¦è¾“å…¥å¯†ç çš„é—®é¢˜ è‡ªè¡Œé…ç½®ã€‚ ç„¶åï¼Œåªéœ€è¦æ‰§è¡Œï¼š // ç§æœ‰åº“ go env -w GOPRIVATE=git.13sai.cn // é…ç½® git.13sai.cn åº“ä½¿ç”¨ git@git.13sai.cn æ‹‰å–ï¼Œä¸»è¦åé¢çš„ : ä¸å¯ä»¥ä¸¢äº† git config --global url.&quot;git@git.13sai.cn:&quot;.insteadOf https://git.13sai.cn è¿™æ ·å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œå¦‚æœæ²¡é…ç½®git çš„ ssh keyï¼Œå°±ä¸èƒ½ä½¿ç”¨&#103;&#x69;&#x74;&#64;&#103;&#x69;&#116;&#x2e;&#49;&#51;&#x73;&#x61;&#105;&#x2e;&#x63;&#x6e;ï¼Œå¯ä»¥æŠŠurl æ¢æˆhttps + ç”¨æˆ·åå¯†ç çš„æ ¼å¼ï¼š https://13sai:123456@git.13sai.cn","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"goå±€éƒ¨å˜é‡:=è¦æ³¨æ„ä½œç”¨åŸŸ","slug":"goå±€éƒ¨å˜é‡-æ³¨æ„","date":"2021-09-15T07:24:48.000Z","updated":"2022-03-19T14:35:21.701Z","comments":true,"path":"2021/09/15/372/","link":"","permalink":"https://github.13sai.com/2021/09/15/372/","excerpt":"","text":"ç°è±¡ä»Šå¤©å†™æ¥å£å†™äº†è¿™ä¹ˆä¸ªä»£ç ï¼š // ä¼ªä»£ç  func abc(id int64) ([]*model, error) &#123; key := &quot;abc&quot; cache, err := redis.Get(key).Bytes() var res []*model if err != nil &#123; res, err := service.GetFromDB(id) if err != nil &#123; return res, err &#125; redis.Set(key, gostring.JsonEncode(res), 2*time.Minute) &#125; else &#123; json.Unmarshal(cache, &amp;res) &#125; return res, nil &#125; ç„¶åæœ¬åœ°æµ‹è¯•æ¥å£ï¼Œå‘ç°æ²¡æœ‰å‘½ä¸­redisæ—¶ï¼Œres æ€»æ˜¯ nullï¼Œååˆ†å¥‡æ€ªã€‚ Testä»”ç»†çœ‹çœ‹ï¼Œä½ èƒ½çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› å—ï¼Ÿ çœ‹åˆ°æ–‡ç« æ ‡é¢˜ï¼Œåº”è¯¥èƒ½çŒœåˆ°å§ï¼ æˆ‘ä»¬å†™ä¸ªtest package tests import ( &quot;errors&quot; &quot;testing&quot; ) func TestVar(t *testing.T) &#123; var a int64 btn := true if btn &#123; a, err := 2, errors.New(&quot;11&quot;) t.Log(&quot;btn&quot;, a, err) &#125; t.Log(a) &#125; è¿è¡Œä¸€ä¸‹ï¼Œ whyï¼Ÿç»“æœçœ‹å‡ºæ¥äº†å—ï¼Ÿå°±æ˜¯å› ä¸ºä½¿ç”¨äº† ##:=## çš„ç¼˜æ•…ï¼Œå˜é‡åœ¨ if å†…éƒ¨æ‰æœ‰æ•ˆï¼Œä¸å½±å“ if å¤–éƒ¨å˜é‡ï¼Œä¿®æ”¹ä¹Ÿå°±ç®€å•äº†ï¼š ... res, err = service.GetFromDB(id) ... å»æ‰:å³å¯ã€‚ è¿™æ˜¯ä½¿ç”¨goçš„:=éœ€è¦æ³¨æ„çš„ç‚¹ï¼Œå˜é‡ä½œç”¨åŸŸéœ€è¦æ³¨æ„å“¦ï¼","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"curlçš„ç”¨æ³•æŒ‡å—","slug":"curlçš„ç”¨æ³•æŒ‡å—","date":"2021-09-11T06:30:30.000Z","updated":"2022-03-19T14:35:21.681Z","comments":true,"path":"2021/09/11/371/","link":"","permalink":"https://github.13sai.com/2021/09/11/371/","excerpt":"","text":"From: é˜®ä¸€å³°-curl çš„ç”¨æ³•æŒ‡å— ç®€ä»‹curl æ˜¯å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨æ¥è¯·æ±‚ Web æœåŠ¡å™¨ã€‚å®ƒçš„åå­—å°±æ˜¯å®¢æˆ·ç«¯ï¼ˆclientï¼‰çš„ URL å·¥å…·çš„æ„æ€ã€‚ å®ƒçš„åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå‘½ä»¤è¡Œå‚æ•°å¤šè¾¾å‡ åç§ã€‚å¦‚æœç†Ÿç»ƒçš„è¯ï¼Œå®Œå…¨å¯ä»¥å–ä»£ Postman è¿™ä¸€ç±»çš„å›¾å½¢ç•Œé¢å·¥å…·ã€‚ æœ¬æ–‡ä»‹ç»å®ƒçš„ä¸»è¦å‘½ä»¤è¡Œå‚æ•°ï¼Œä½œä¸ºæ—¥å¸¸çš„å‚è€ƒï¼Œæ–¹ä¾¿æŸ¥é˜…ã€‚å†…å®¹ä¸»è¦ç¿»è¯‘è‡ªã€Šcurl cookbookã€‹ã€‚ä¸ºäº†èŠ‚çº¦ç¯‡å¹…ï¼Œä¸‹é¢çš„ä¾‹å­ä¸åŒ…æ‹¬è¿è¡Œæ—¶çš„è¾“å‡ºï¼Œåˆå­¦è€…å¯ä»¥å…ˆçœ‹æˆ‘ä»¥å‰å†™çš„ã€Šcurl åˆå­¦è€…æ•™ç¨‹ã€‹ã€‚ ä¸å¸¦æœ‰ä»»ä½•å‚æ•°æ—¶ï¼Œcurl å°±æ˜¯å‘å‡º GET è¯·æ±‚ã€‚ $ curl https://www.example.com ä¸Šé¢å‘½ä»¤å‘www.example.comå‘å‡º GET è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›çš„å†…å®¹ä¼šåœ¨å‘½ä»¤è¡Œè¾“å‡ºã€‚ -A-Aå‚æ•°æŒ‡å®šå®¢æˆ·ç«¯çš„ç”¨æˆ·ä»£ç†æ ‡å¤´ï¼Œå³User-Agentã€‚curl çš„é»˜è®¤ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²æ˜¯curl/[version]ã€‚ $ curl -A &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&#x27; https://google.com ä¸Šé¢å‘½ä»¤å°†User-Agentæ”¹æˆ Chrome æµè§ˆå™¨ã€‚ $ curl -A &#x27;&#x27; https://google.com ä¸Šé¢å‘½ä»¤ä¼šç§»é™¤User-Agentæ ‡å¤´ã€‚ ä¹Ÿå¯ä»¥é€šè¿‡-Hå‚æ•°ç›´æ¥æŒ‡å®šæ ‡å¤´ï¼Œæ›´æ”¹User-Agentã€‚ $ curl -H &#x27;User-Agent: php/1.0&#x27; https://google.com -b-bå‚æ•°ç”¨æ¥å‘æœåŠ¡å™¨å‘é€ Cookieã€‚ $ curl -b &#x27;foo=bar&#x27; https://google.com ä¸Šé¢å‘½ä»¤ä¼šç”Ÿæˆä¸€ä¸ªæ ‡å¤´Cookie: foo=barï¼Œå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªåä¸ºfooã€å€¼ä¸ºbarçš„ Cookieã€‚ $ curl -b &#x27;foo1=bar;foo2=bar2&#x27; https://google.com ä¸Šé¢å‘½ä»¤å‘é€ä¸¤ä¸ª Cookieã€‚ $ curl -b cookies.txt https://www.google.com ä¸Šé¢å‘½ä»¤è¯»å–æœ¬åœ°æ–‡ä»¶cookies.txtï¼Œé‡Œé¢æ˜¯æœåŠ¡å™¨è®¾ç½®çš„ Cookieï¼ˆå‚è§-cå‚æ•°ï¼‰ï¼Œå°†å…¶å‘é€åˆ°æœåŠ¡å™¨ã€‚ -c-cå‚æ•°å°†æœåŠ¡å™¨è®¾ç½®çš„ Cookie å†™å…¥ä¸€ä¸ªæ–‡ä»¶ã€‚ $ curl -c cookies.txt https://www.google.com ä¸Šé¢å‘½ä»¤å°†æœåŠ¡å™¨çš„ HTTP å›åº”æ‰€è®¾ç½® Cookie å†™å…¥æ–‡æœ¬æ–‡ä»¶cookies.txtã€‚ -d-då‚æ•°ç”¨äºå‘é€ POST è¯·æ±‚çš„æ•°æ®ä½“ã€‚ $ curl -d&#x27;login=emmaï¼†password=123&#x27;-X POST https://google.com/login # æˆ–è€… $ curl -d &#x27;login=emma&#x27; -d &#x27;password=123&#x27; -X POST https://google.com/login ä½¿ç”¨-då‚æ•°ä»¥åï¼ŒHTTP è¯·æ±‚ä¼šè‡ªåŠ¨åŠ ä¸Šæ ‡å¤´Content-Type : application/x-www-form-urlencodedã€‚å¹¶ä¸”ä¼šè‡ªåŠ¨å°†è¯·æ±‚è½¬ä¸º POST æ–¹æ³•ï¼Œå› æ­¤å¯ä»¥çœç•¥-X POSTã€‚ -då‚æ•°å¯ä»¥è¯»å–æœ¬åœ°æ–‡æœ¬æ–‡ä»¶çš„æ•°æ®ï¼Œå‘æœåŠ¡å™¨å‘é€ã€‚ $ curl -d &#x27;@data.txt&#x27; https://google.com/login ä¸Šé¢å‘½ä»¤è¯»å–data.txtæ–‡ä»¶çš„å†…å®¹ï¼Œä½œä¸ºæ•°æ®ä½“å‘æœåŠ¡å™¨å‘é€ã€‚ â€“data-urlencode--data-urlencodeå‚æ•°ç­‰åŒäº-dï¼Œå‘é€ POST è¯·æ±‚çš„æ•°æ®ä½“ï¼ŒåŒºåˆ«åœ¨äºä¼šè‡ªåŠ¨å°†å‘é€çš„æ•°æ®è¿›è¡Œ URL ç¼–ç ã€‚ $ curl --data-urlencode &#x27;comment=hello world&#x27; https://google.com/login ä¸Šé¢ä»£ç ä¸­ï¼Œå‘é€çš„æ•°æ®hello worldä¹‹é—´æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œéœ€è¦è¿›è¡Œ URL ç¼–ç ã€‚ -e-eå‚æ•°ç”¨æ¥è®¾ç½® HTTP çš„æ ‡å¤´Refererï¼Œè¡¨ç¤ºè¯·æ±‚çš„æ¥æºã€‚ curl -e &#x27;https://google.com?q=example&#x27; https://www.example.com ä¸Šé¢å‘½ä»¤å°†Refereræ ‡å¤´è®¾ä¸ºhttps://google.com?q=exampleã€‚ -Hå‚æ•°å¯ä»¥é€šè¿‡ç›´æ¥æ·»åŠ æ ‡å¤´Refererï¼Œè¾¾åˆ°åŒæ ·æ•ˆæœã€‚ curl -H &#x27;Referer: https://google.com?q=example&#x27; https://www.example.com -F-Få‚æ•°ç”¨æ¥å‘æœåŠ¡å™¨ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ $ curl -F &#x27;file=@photo.png&#x27; https://google.com/profile ä¸Šé¢å‘½ä»¤ä¼šç»™ HTTP è¯·æ±‚åŠ ä¸Šæ ‡å¤´Content-Type: multipart/form-dataï¼Œç„¶åå°†æ–‡ä»¶photo.pngä½œä¸ºfileå­—æ®µä¸Šä¼ ã€‚ -Få‚æ•°å¯ä»¥æŒ‡å®š MIME ç±»å‹ã€‚ $ curl -F &#x27;file=@photo.png;type=image/png&#x27; https://google.com/profile ä¸Šé¢å‘½ä»¤æŒ‡å®š MIME ç±»å‹ä¸ºimage/pngï¼Œå¦åˆ™ curl ä¼šæŠŠ MIME ç±»å‹è®¾ä¸ºapplication/octet-streamã€‚ -Få‚æ•°ä¹Ÿå¯ä»¥æŒ‡å®šæ–‡ä»¶åã€‚ $ curl -F &#x27;file=@photo.png;filename=me.png&#x27; https://google.com/profile ä¸Šé¢å‘½ä»¤ä¸­ï¼ŒåŸå§‹æ–‡ä»¶åä¸ºphoto.pngï¼Œä½†æ˜¯æœåŠ¡å™¨æ¥æ”¶åˆ°çš„æ–‡ä»¶åä¸ºme.pngã€‚ -G-Gå‚æ•°ç”¨æ¥æ„é€  URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚ $ curl -G -d &#x27;q=kitties&#x27; -d &#x27;count=20&#x27; https://google.com/search ä¸Šé¢å‘½ä»¤ä¼šå‘å‡ºä¸€ä¸ª GET è¯·æ±‚ï¼Œå®é™…è¯·æ±‚çš„ URL ä¸ºhttps://google.com/search?q=kitties&amp;count=20ã€‚å¦‚æœçœç•¥--Gï¼Œä¼šå‘å‡ºä¸€ä¸ª POST è¯·æ±‚ã€‚ å¦‚æœæ•°æ®éœ€è¦ URL ç¼–ç ï¼Œå¯ä»¥ç»“åˆ--data--urlencodeå‚æ•°ã€‚ $ curl -G --data-urlencode &#x27;comment=hello world&#x27; https://www.example.com -H-Hå‚æ•°æ·»åŠ  HTTP è¯·æ±‚çš„æ ‡å¤´ã€‚ $ curl -H &#x27;Accept-Language: en-US&#x27; https://google.com ä¸Šé¢å‘½ä»¤æ·»åŠ  HTTP æ ‡å¤´Accept-Language: en-USã€‚ $ curl -H &#x27;Accept-Language: en-US&#x27; -H &#x27;Secret-Message: xyzzy&#x27; https://google.com ä¸Šé¢å‘½ä»¤æ·»åŠ ä¸¤ä¸ª HTTP æ ‡å¤´ã€‚ $ curl -d &#x27;&#123;&quot;login&quot;: &quot;emma&quot;, &quot;pass&quot;: &quot;123&quot;&#125;&#x27; -H &#x27;Content-Type: application/json&#x27; https://google.com/login ä¸Šé¢å‘½ä»¤æ·»åŠ  HTTP è¯·æ±‚çš„æ ‡å¤´æ˜¯Content-Type: application/jsonï¼Œç„¶åç”¨-då‚æ•°å‘é€ JSON æ•°æ®ã€‚ -i-iå‚æ•°æ‰“å°å‡ºæœåŠ¡å™¨å›åº”çš„ HTTP æ ‡å¤´ã€‚ $ curl -i https://www.example.com ä¸Šé¢å‘½ä»¤æ”¶åˆ°æœåŠ¡å™¨å›åº”åï¼Œå…ˆè¾“å‡ºæœåŠ¡å™¨å›åº”çš„æ ‡å¤´ï¼Œç„¶åç©ºä¸€è¡Œï¼Œå†è¾“å‡ºç½‘é¡µçš„æºç ã€‚ -I-Iå‚æ•°å‘æœåŠ¡å™¨å‘å‡º HEAD è¯·æ±‚ï¼Œç„¶ä¼šå°†æœåŠ¡å™¨è¿”å›çš„ HTTP æ ‡å¤´æ‰“å°å‡ºæ¥ã€‚ $ curl -I https://www.example.com ä¸Šé¢å‘½ä»¤è¾“å‡ºæœåŠ¡å™¨å¯¹ HEAD è¯·æ±‚çš„å›åº”ã€‚ --headå‚æ•°ç­‰åŒäº-Iã€‚ $ curl --head https://www.example.com -k-kå‚æ•°æŒ‡å®šè·³è¿‡ SSL æ£€æµ‹ã€‚ $ curl -k https://www.example.com ä¸Šé¢å‘½ä»¤ä¸ä¼šæ£€æŸ¥æœåŠ¡å™¨çš„ SSL è¯ä¹¦æ˜¯å¦æ­£ç¡®ã€‚ -L-Lå‚æ•°ä¼šè®© HTTP è¯·æ±‚è·ŸéšæœåŠ¡å™¨çš„é‡å®šå‘ã€‚curl é»˜è®¤ä¸è·Ÿéšé‡å®šå‘ã€‚ $ curl -L -d &#x27;tweet=hi&#x27; https://api.twitter.com/tweet â€“limit-rate--limit-rateç”¨æ¥é™åˆ¶ HTTP è¯·æ±‚å’Œå›åº”çš„å¸¦å®½ï¼Œæ¨¡æ‹Ÿæ…¢ç½‘é€Ÿçš„ç¯å¢ƒã€‚ $ curl --limit-rate 200k https://google.com ä¸Šé¢å‘½ä»¤å°†å¸¦å®½é™åˆ¶åœ¨æ¯ç§’ 200K å­—èŠ‚ã€‚ -o-oå‚æ•°å°†æœåŠ¡å™¨çš„å›åº”ä¿å­˜æˆæ–‡ä»¶ï¼Œç­‰åŒäºwgetå‘½ä»¤ã€‚ $ curl -o example.html https://www.example.com ä¸Šé¢å‘½ä»¤å°†www.example.comä¿å­˜æˆexample.htmlã€‚ -O-Oå‚æ•°å°†æœåŠ¡å™¨å›åº”ä¿å­˜æˆæ–‡ä»¶ï¼Œå¹¶å°† URL çš„æœ€åéƒ¨åˆ†å½“ä½œæ–‡ä»¶åã€‚ $ curl -O https://www.example.com/foo/bar.html ä¸Šé¢å‘½ä»¤å°†æœåŠ¡å™¨å›åº”ä¿å­˜æˆæ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºbar.htmlã€‚ -s-så‚æ•°å°†ä¸è¾“å‡ºé”™è¯¯å’Œè¿›åº¦ä¿¡æ¯ã€‚ $ curl -s https://www.example.com ä¸Šé¢å‘½ä»¤ä¸€æ—¦å‘ç”Ÿé”™è¯¯ï¼Œä¸ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚ä¸å‘ç”Ÿé”™è¯¯çš„è¯ï¼Œä¼šæ­£å¸¸æ˜¾ç¤ºè¿è¡Œç»“æœã€‚ å¦‚æœæƒ³è®© curl ä¸äº§ç”Ÿä»»ä½•è¾“å‡ºï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚ $ curl -s -o /dev/null https://google.com -S-Så‚æ•°æŒ‡å®šåªè¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œé€šå¸¸ä¸-sä¸€èµ·ä½¿ç”¨ã€‚ $ curl -s -o /dev/null https://google.com ä¸Šé¢å‘½ä»¤æ²¡æœ‰ä»»ä½•è¾“å‡ºï¼Œé™¤éå‘ç”Ÿé”™è¯¯ã€‚ -u-uå‚æ•°ç”¨æ¥è®¾ç½®æœåŠ¡å™¨è®¤è¯çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ $ curl -u &#x27;bob:12345&#x27; https://google.com/login ä¸Šé¢å‘½ä»¤è®¾ç½®ç”¨æˆ·åä¸ºbobï¼Œå¯†ç ä¸º12345ï¼Œç„¶åå°†å…¶è½¬ä¸º HTTP æ ‡å¤´Authorization: Basic Ym9iOjEyMzQ1ã€‚ curl èƒ½å¤Ÿè¯†åˆ« URL é‡Œé¢çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ $ curl https://bob:12345@google.com/login ä¸Šé¢å‘½ä»¤èƒ½å¤Ÿè¯†åˆ« URL é‡Œé¢çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå°†å…¶è½¬ä¸ºä¸Šä¸ªä¾‹å­é‡Œé¢çš„ HTTP æ ‡å¤´ã€‚ $ curl -u &#x27;bob&#x27; https://google.com/login ä¸Šé¢å‘½ä»¤åªè®¾ç½®äº†ç”¨æˆ·åï¼Œæ‰§è¡Œåï¼Œcurl ä¼šæç¤ºç”¨æˆ·è¾“å…¥å¯†ç ã€‚ -v-vå‚æ•°è¾“å‡ºé€šä¿¡çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œç”¨äºè°ƒè¯•ã€‚ $ curl -v https://www.example.com --traceå‚æ•°ä¹Ÿå¯ä»¥ç”¨äºè°ƒè¯•ï¼Œè¿˜ä¼šè¾“å‡ºåŸå§‹çš„äºŒè¿›åˆ¶æ•°æ®ã€‚ $ curl --trace - https://www.example.com -x-xå‚æ•°æŒ‡å®š HTTP è¯·æ±‚çš„ä»£ç†ã€‚ $ curl -x socks5://james:cats@myproxy.com:8080 https://www.example.com ä¸Šé¢å‘½ä»¤æŒ‡å®š HTTP è¯·æ±‚é€šè¿‡myproxy.com:8080çš„ socks5 ä»£ç†å‘å‡ºã€‚ å¦‚æœæ²¡æœ‰æŒ‡å®šä»£ç†åè®®ï¼Œé»˜è®¤ä¸º HTTPã€‚ $ curl -x james:cats@myproxy.com:8080 https://www.example.com ä¸Šé¢å‘½ä»¤ä¸­ï¼Œè¯·æ±‚çš„ä»£ç†ä½¿ç”¨ HTTP åè®®ã€‚ -X-Xå‚æ•°æŒ‡å®š HTTP è¯·æ±‚çš„æ–¹æ³•ã€‚ $ curl -X POST https://www.example.com ä¸Šé¢å‘½ä»¤å¯¹https://www.example.comå‘å‡º POST è¯·æ±‚ã€‚ å‚è€ƒé“¾æ¥ Curl Cookbook","categories":[{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/categories/Linux/"}],"tags":[{"name":"curl","slug":"curl","permalink":"https://github.13sai.com/tags/curl/"}]},{"title":"docker-composeæ­å»ºELK","slug":"docker-composeæ­å»ºELK","date":"2021-09-10T08:20:26.000Z","updated":"2022-03-19T14:35:21.682Z","comments":true,"path":"2021/09/10/370/","link":"","permalink":"https://github.13sai.com/2021/09/10/370/","excerpt":"","text":"githubå·²ç»æœ‰äººå¼„å¥½äº†ï¼Œç›´æ¥cloneä¸€ä¸‹ï¼Œ git clone https://github.com/deviantony/docker-elk.git è¿›å…¥kibanaç›®å½•kibana.ymlä¿®æ”¹å¯†ç ï¼Œæ³¨æ„å­—ç¬¦ä¸²åŠ å¼•å·ã€‚ å†è¿›å…¥docker-compose.ymlä¿®æ”¹eså¯†ç ï¼Œæ³¨æ„å­—ç¬¦ä¸²åŠ å¼•å·ã€‚ # å¯åŠ¨ docker compose up -d tips: æ‹‰å–docker.elastic.coçš„é•œåƒè´¼æ…¢ï¼Œå»ºè®®æ¢æˆé˜¿é‡Œäº‘æˆ–å…¶ä»–å›½å†…é•œåƒã€‚ esæ’ä»¶å¯ä»¥ä¸‹è½½åˆ°elasticsearch/pluginsï¼Œç„¶åæŒ‚è½½ä¸€ä¸‹ï¼Œæˆ–è€…æ„å»ºé•œåƒè¿‡ç¨‹ä¸­copyè¿›å»ã€‚ ä¸‹é¢æ˜¯æˆ‘ä¿®æ”¹çš„docker-compose.ymlï¼Œå¯ä¾›å‚è€ƒã€‚ version: &#x27;3.2&#x27; services: elasticsearch: build: context: elasticsearch/ args: ELK_VERSION: $ELK_VERSION volumes: - type: bind source: ./elasticsearch/config/elasticsearch.yml target: /usr/share/elasticsearch/config/elasticsearch.yml read_only: true - type: volume source: elasticsearch target: /usr/share/elasticsearch/data # å¢åŠ  es æ’ä»¶ - type: bind source: ./elasticsearch/plugins target: /usr/share/elasticsearch/plugins ports: - &quot;9200:9200&quot; - &quot;9300:9300&quot; environment: ES_JAVA_OPTS: &quot;-Xmx256m -Xms256m&quot; ELASTIC_PASSWORD: &quot;123456&quot; discovery.type: single-node networks: - elk logstash: build: context: logstash/ args: ELK_VERSION: $ELK_VERSION volumes: - type: bind source: ./logstash/config/logstash.yml target: /usr/share/logstash/config/logstash.yml read_only: true - type: bind source: ./logstash/pipeline target: /usr/share/logstash/pipeline read_only: true ports: - &quot;5044:5044&quot; - &quot;5000:5000/tcp&quot; - &quot;5000:5000/udp&quot; - &quot;9600:9600&quot; environment: LS_JAVA_OPTS: &quot;-Xmx256m -Xms256m&quot; networks: - elk depends_on: - elasticsearch kibana: build: context: kibana/ args: ELK_VERSION: $ELK_VERSION volumes: - type: bind source: ./kibana/config/kibana.yml target: /usr/share/kibana/config/kibana.yml read_only: true ports: - &quot;5601:5601&quot; networks: - elk depends_on: - elasticsearch networks: elk: driver: bridge volumes: elasticsearch: å¯åŠ¨æˆåŠŸå°±å¯ä»¥è¿›kibanaç©è€äº†ï¼Œes æ¯”è¾ƒåƒæœºå™¨å†…å­˜ï¼Œä½†ç›¸æ¯” gitlab æ„Ÿè§‰å¥½ä¸€ä¸¢ä¸¢ã€‚","categories":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://github.13sai.com/categories/ElasticSearch/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://github.13sai.com/tags/Docker/"},{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://github.13sai.com/tags/ElasticSearch/"}]},{"title":"GithubProfile","slug":"GithubProfile","date":"2021-08-15T09:48:57.000Z","updated":"2022-03-19T14:35:21.585Z","comments":true,"path":"2021/08/15/362/","link":"","permalink":"https://github.13sai.com/2021/08/15/362/","excerpt":"","text":"å‡ ä¸ªæœˆå‰å‘ç°github çš„ public profile å¼€æ”¾äº†æ–°åŠŸèƒ½ï¼Œåº”è¯¥å¼€æ”¾æ—¶é—´è›®ä¹…çš„ï¼Œä½†å¯èƒ½å¹¶æ²¡æœ‰å¤ªå¤šäººå…³æ³¨ï¼Œä»Šå¤©æ¥è¯´è¯´æ€ä¹ˆä½¿ç”¨ï¼ŒçœŸæ˜¯ç®€å•ã€‚ æ–°å»ºåŒåä»“åº“13saiæ¯”å¦‚æˆ‘ï¼Œæ–°å»ºä»“åº“ï¼šhttps://github.com/13sai/13sai ç„¶åä¼šæœ‰é¡¹ç›®å³ä¾§ä¼šæç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ä»“åº“ï¼Œæ­¤ä»“åº“çš„ readme ä¼šæ˜¾ç¤ºåœ¨ public profile ã€‚ ç¼–è¾‘readmeä½ å¯ä»¥è‡ªè¡Œåˆ›æ„ï¼Œmakedownè¯­æ³•ï¼Œä¹Ÿå¯ä»¥å‚è€ƒ https://github.com/anuraghazra/github-readme-stats åšä¸€äº›é…·ç‚«ä¸€ç‚¹çš„æ•ˆæœã€‚ æ¯”å¦‚æˆ‘çš„ï¼š ### ğŸ‘‹ Hi there , [I&#x27;m 13sai!](https://github.13sai.com) ![13sai](https://visitor-badge.glitch.me/badge?page_id=13sai.13sai) - ğŸ”­ Iâ€™m currently working in NanJing, China. - ğŸŒ± Iâ€™m currently learning kubernetes, go, micro service... - ğŸ“« How to reach me: sai0556@qq.com - ğŸ’¬ Ask me about anything [here](https://github.com/13sai/13sai/issues) - &lt;a href=&quot;/images/qiniu/wechat.png&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://cdn.buymeacoffee.com/buttons/v2/default-red.png&quot; alt=&quot;Buy Me A Coffee&quot; width=&quot;150&quot; &gt;&lt;/a&gt; ![Anurag&#x27;s GitHub stats](https://github-readme-stats.vercel.app/api?username=13sai&amp;show_icons=true&amp;theme=tokyonight) ![Top Langs](https://github-readme-stats.vercel.app/api/top-langs/?username=13sai&amp;&amp;hide=javascript,html,css,blade&amp;layout=compact&amp;theme=material-palenight) ä¿å­˜å‘å¸ƒå³å¯ã€‚ çœ‹çœ‹æ•ˆæœå§ï¼ ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œçœ‹åˆ°åˆ«äºº profile å¥½çš„æ•ˆæœä¹Ÿå¯ä»¥å»çœ‹ä¸‹æºç è´´åˆ°è‡ªå·±çš„ä»“åº“ä½¿ç”¨å“ˆï¼","categories":[{"name":"github","slug":"github","permalink":"https://github.13sai.com/categories/github/"}],"tags":[{"name":"github","slug":"github","permalink":"https://github.13sai.com/tags/github/"}]},{"title":"boltdbçš„ä½¿ç”¨","slug":"boltdbçš„ä½¿ç”¨","date":"2021-08-08T10:43:46.000Z","updated":"2022-03-19T14:35:21.661Z","comments":true,"path":"2021/08/08/361/","link":"","permalink":"https://github.13sai.com/2021/08/08/361/","excerpt":"","text":"Bolt is a pure Go key/value store inspired by Howard Chuâ€™s LMDB project. The goal of the project is to provide a simple, fast, and reliable database for projects that donâ€™t require a full database server such as Postgres or MySQL. bolt æ˜¯ä¸€ä¸ªç®€å•çš„kvæ•°æ®åº“ï¼Œä½¿ç”¨åŠå…¶ç®€å•ï¼Œç›®å‰githubé¡¹ç›®å¤„äºåªè¯»çŠ¶æ€ã€‚ æ•°æ®åº“è¿æ¥package main import ( &quot;log&quot; &quot;github.com/boltdb/bolt&quot; ) func main() &#123; // æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¼šæ–°å»ºæ–‡ä»¶ db, err := bolt.Open(&quot;sai.db&quot;, 0600, nil) if err != nil &#123; log.Fatal(err) &#125; defer db.Close() ... &#125; äº‹åŠ¡// è¯»å†™ err := db.Update(func(tx *bolt.Tx) error &#123; ... return nil &#125;) // åªè¯»ï¼Œé‡Œé¢åªèƒ½è¿›è¡Œè¯»å–æ“ä½œ err := db.View(func(tx *bolt.Tx) error &#123; ... return nil &#125;) å¸¸ç”¨æ“ä½œ// åˆ›å»ºä¸€ä¸ªbucketï¼Œå¯ä»¥ç†è§£æˆä¸€ä¸ªtable b, _ := tx.CreateBucketIfNotExists([]byte(&quot;sai0556&quot;)) // æ–°å¢ b.Put([]byte(&quot;a&quot;), []byte(&quot;11&quot;)) b.Put([]byte(&quot;b&quot;), []byte(&quot;22&quot;)) // å– v := b.Get([]byte(&quot;a&quot;)) fmt.Printf(&quot;The a is: %s\\n&quot;, v) // åˆ é™¤ b.Delete([]byte(&quot;a&quot;)) // æ¸¸æ ‡éå† /* First() Move to the first key. Last() Move to the last key. Seek() Move to a specific key. Next() Move to the next key. Prev() Move to the previous key */ c := b.Cursor() for k, v := c.First(); k != nil; k, v = c.Next() &#123; fmt.Printf(&quot;key=%s, value=%s\\n&quot;, k, v) &#125; // ForEach éå† b.ForEach(func(k, v []byte) error &#123; fmt.Printf(&quot;key=%s, value=%s\\n&quot;, k, v) return nil &#125;) // åˆ é™¤bucket tx.DeleteBucket([]byte(&quot;sai0556&quot;)) ä½¿ç”¨å¾ˆç®€å•ï¼Œä½†éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š åªè¯»Viewä¸­ï¼Œä¸èƒ½ä½¿ç”¨ç¼–è¾‘ã€åˆ é™¤ã€æ–°å¢ç­‰å†™æ“ä½œï¼Œä¼šäº§ç”Ÿé”™è¯¯ å› ä¸ºåº•å±‚ä½¿ç”¨äº†è¯»å†™é”ï¼Œè¿›è¡Œå†™æ“ä½œï¼Œè¦å°½å¯èƒ½å¿«ï¼Œæ›´ä¸è¦å¼€å¯é•¿äº‹åŠ¡ï¼Œä¼šé€ æˆé˜»å¡ï¼Œå½±å“æ€§èƒ½ æ›´å¤šè¯´æ˜å¯å‚è€ƒï¼š https://pkg.go.dev/github.com/boltdb/bolt@v1.3.1 https://github.com/boltdb/bolt","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"boltdb","slug":"boltdb","permalink":"https://github.13sai.com/tags/boltdb/"}]},{"title":"nsqåŸºç¡€çŸ¥è¯†ä¸ç®€å•demo","slug":"nsqå°è¯•ç‰›åˆ€","date":"2021-07-31T12:57:54.000Z","updated":"2022-03-19T14:35:21.773Z","comments":true,"path":"2021/07/31/360/","link":"","permalink":"https://github.13sai.com/2021/07/31/360/","excerpt":"","text":"NSQ A realtime distributed messaging platform ä¼˜åŠ¿ åŸºäºgolang åˆ†å¸ƒå¼ æ°´å¹³æ‰©å±• è‡ªå¸¦UIï¼Œæ“ä½œå‹å¥½ å¤šè¯­è¨€client ç»„ä»¶ ç»„ä»¶ åŠŸèƒ½ nsqd æ¥æ”¶ã€æ’é˜Ÿå’Œå‘å®¢æˆ·ç«¯ä¼ é€’æ¶ˆæ¯çš„å®ˆæŠ¤è¿›ç¨‹ nsqlookupd ç®¡ç†æ‹“æ‰‘ä¿¡æ¯çš„å®ˆæŠ¤è¿›ç¨‹ nsqadmin Web UIï¼Œç”¨äºå®æ—¶æŸ¥çœ‹èšåˆçš„é›†ç¾¤ç»Ÿè®¡ä¿¡æ¯å¹¶æ‰§è¡Œå„ç§ç®¡ç†ä»»åŠ¡ utilities å¸¸è§åŸºç¡€åŠŸèƒ½ã€æ•°æ®æµå¤„ç†å·¥å…·ï¼Œå¦‚nsq_statã€nsq_tailã€nsq_to_fileã€nsq_to_httpã€nsq_to_nsqã€to_nsq nsqdå®ƒå¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œä½†é€šå¸¸ä¸nsqlookupd å®ä¾‹ä¸€èµ·é…ç½®åœ¨é›†ç¾¤ä¸­ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†å®£å¸ƒä¸»é¢˜å’Œé¢‘é“ä»¥ä¾›å‘ç°ï¼‰ã€‚ å®ƒä¾¦å¬ä¸¤ä¸ª TCP ç«¯å£ï¼Œä¸€ä¸ªç”¨äºå®¢æˆ·ç«¯ï¼Œå¦ä¸€ä¸ªç”¨äº HTTP APIã€‚å®ƒå¯ä»¥é€‰æ‹©åœ¨ç¬¬ä¸‰ä¸ªç«¯å£ä¸Šä¾¦å¬ HTTPSã€‚ nsqlookupdæœ‰ä¸¤ä¸ªæ¥å£ï¼šnsqdç”¨äºå¹¿æ’­çš„TCP æ¥å£å’Œç”¨äºå®¢æˆ·ç«¯æ‰§è¡Œå‘ç°å’Œç®¡ç†æ“ä½œçš„ HTTP æ¥å£ã€‚ MACå®‰è£… brew install nsqnsqlookupdnsqd â€“lookupd-tcp-address=127.0.0.1:4160 â€“broadcast-address=127.0.0.1nsqadmin â€“lookupd-http-address=127.0.0.1:4161 go-nsq// producer package nsq import ( &quot;context&quot; &quot;fmt&quot; &quot;time&quot; &quot;github.com/nsqio/go-nsq&quot; &quot;github.com/spf13/cast&quot; ) // ä¸»å‡½æ•° func Send(ctx context.Context, cancel context.CancelFunc, topic string) &#123; defer cancel() str := &quot;127.0.0.1:4150&quot; fmt.Println(&quot;address: &quot;, str) producer, err := nsq.NewProducer(str, nsq.NewConfig()) if err != nil &#123; panic(err) &#125; producer.SetLogger(nil, 0) for i := 0; i &lt; 5; i++ &#123; msg := &quot;13sai, &quot; + cast.ToString(i) fmt.Println(&quot;publish&quot;, msg, producer.Publish(topic, []byte(msg))) time.Sleep(time.Second * 1) &#125; &lt;-ctx.Done() producer.Stop() fmt.Println(&quot;producer exit&quot;) &#125; // consumer package nsq import ( &quot;context&quot; &quot;fmt&quot; &quot;time&quot; &quot;github.com/nsqio/go-nsq&quot; ) // æ¶ˆè´¹è€… type Consumer struct&#123;&#125; // ä¸»å‡½æ•° func Receive(ctx context.Context, cancel context.CancelFunc, topic string) &#123; defer cancel() // address := &quot;127.0.0.1:4161&quot; channel := topic + &quot;-channel&quot; cfg := nsq.NewConfig() cfg.LookupdPollInterval = time.Second * 2 c, err := nsq.NewConsumer(topic, channel, cfg) if err != nil &#123; panic(err) &#125; c.SetLogger(nil, 0) //å±è”½ç³»ç»Ÿæ—¥å¿— c.AddConcurrentHandlers(&amp;Consumer&#123;&#125;, 3) //å»ºç«‹NSQLookupdè¿æ¥ // if err := c.ConnectToNSQLookupd(address); err != nil &#123; // panic(err) // &#125; //å»ºç«‹å¤šä¸ªnsqdè¿æ¥ if err := c.ConnectToNSQDs([]string&#123;&quot;127.0.0.1:4150&quot;&#125;); err != nil &#123; panic(err) &#125; &lt;-ctx.Done() c.Stop() fmt.Println(&quot;consumer exit&quot;) &#125; // å¤„ç†æ¶ˆæ¯ func (*Consumer) HandleMessage(msg *nsq.Message) error &#123; fmt.Println(&quot;receive&quot;, msg.NSQDAddress, &quot;message:&quot;, string(msg.Body)) return nil &#125; // nsq_test package nsq import ( &quot;context&quot; &quot;os&quot; &quot;os/signal&quot; &quot;syscall&quot; &quot;testing&quot; &quot;time&quot; ) func TestReceive(t *testing.T) &#123; topic := &quot;sai0556&quot; ctx, cancel := context.WithCancel(context.Background()) defer cancel() go Send(ctx, cancel, topic) go Receive(ctx, cancel, topic) sig := make(chan os.Signal) signal.Notify(sig, syscall.SIGTERM, syscall.SIGINT) t.Log(&quot;å¼€å§‹ç›‘å¬&quot;) select &#123; case &lt;-ctx.Done(): t.Log(&quot;ctx done&quot;) return case &lt;-sig: t.Log(&quot;signal exit...&quot;) cancel() time.Sleep(2 * time.Second) return &#125; // send(topic) &#125; æµ‹è¯•èµ°ä¸€æ³¢ï¼Œ å¯¹äºNSQï¼Œè‡ªå·±ä¹Ÿæ˜¯åˆšåˆšä½¿ç”¨ï¼Œç»™æˆ‘çš„æ„Ÿè§‰æ˜¯ç›¸å½“å¥½ä¸Šæ‰‹ï¼Œä¹‹å‰æœ‰ç”¨è¿‡RabbitMQï¼Œnsqç›¸æ¯”æ¥è¯´æ›´ç®€å•ï¼Œå¯èƒ½æ˜¯go-clientç›¸å¯¹å¥½ç”¨ä¸€äº›å§ã€‚åç»­æœ‰å…¶ä»–å€¼å¾—åˆ†äº«çš„ç‚¹å†ç»§ç»­è¡¥å……ã€‚å¦‚æœ‰éœ€è¦äº¤æµï¼Œå¯è”ç³»æˆ‘email/qqã€‚ å‚è€ƒ nsq","categories":[{"name":"MQ","slug":"MQ","permalink":"https://github.13sai.com/categories/MQ/"}],"tags":[{"name":"nsq","slug":"nsq","permalink":"https://github.13sai.com/tags/nsq/"}]},{"title":"VSCodeè°ƒè¯•goç¨‹åº","slug":"VSCodeè°ƒè¯•goç¨‹åº","date":"2021-07-07T13:27:35.000Z","updated":"2022-03-19T14:35:21.656Z","comments":true,"path":"2021/07/07/355/","link":"","permalink":"https://github.13sai.com/2021/07/07/355/","excerpt":"","text":"åœ¨é¡¹ç›®ç›®å½•æ–°å»ºï¼Œ.vscode/launch.json &#123; &quot;version&quot;: &quot;0.2.0&quot;, // ç‰ˆæœ¬å¥½ &quot;configurations&quot;: [ &#123; &quot;name&quot;: &quot;app&quot;, // åç§° &quot;type&quot;: &quot;go&quot;, &quot;request&quot;: &quot;launch&quot;, &quot;mode&quot;: &quot;auto&quot;, &quot;program&quot;: &quot;$&#123;cwd&#125;&quot;, &quot;env&quot;: &#123;&quot;DebugEnv&quot;:&quot;1&quot;&#125;, // ç¯å¢ƒå˜é‡ &quot;args&quot;: [&quot;--config&quot;,&quot;./config-local.yaml&quot;, &quot;--listen&quot;, &quot;:8087&quot;] // å¯åŠ¨å‚æ•° &#125; ] &#125; å¯¹äºprogram: $&#123;workspaceRoot&#125; VSCodeå½“å‰æ‰“å¼€çš„æ–‡ä»¶å¤¹ $&#123;file&#125; å½“å‰æ‰“å¼€çš„æ–‡ä»¶ $&#123;relativeFile&#125; ç›¸å¯¹äºworkspaceRootçš„ç›¸å¯¹è·¯å¾„ $&#123;fileBasename&#125; å½“å‰æ‰“å¼€æ–‡ä»¶çš„æ–‡ä»¶å $&#123;fileDirname&#125; æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œæ˜¯ç»å¯¹è·¯å¾„ $&#123;fileExtname&#125; å½“å‰æ‰“å¼€æ–‡ä»¶çš„æ‹“å±•åï¼Œå¦‚.json $&#123;cwd&#125; å¯åŠ¨æ—¶ä»»åŠ¡è¿è¡Œç¨‹åºçš„å½“å‰å·¥ä½œç›®å½• ç„¶åè¿è¡Œ-ã€‹å¯åŠ¨è°ƒè¯•ï¼Œå°±èƒ½è·‘èµ·æ¥äº†ï¼Œå¯ä»¥æ‰“æ–­ç‚¹è°ƒè¯•äº†ã€‚ æ–­ç‚¹ç‚¹å‡»ä»£ç è¡Œå·¦ä¾§å³å¯ï¼Œè¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚","categories":[{"name":"debug","slug":"debug","permalink":"https://github.13sai.com/categories/debug/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"ä½¿ç”¨ConfigMapä½œä¸ºå®¹å™¨çš„é…ç½®æ–‡ä»¶","slug":"ä½¿ç”¨ConfigMapä½œä¸ºå®¹å™¨çš„é…ç½®æ–‡ä»¶","date":"2021-06-26T03:48:54.000Z","updated":"2022-05-06T08:45:34.821Z","comments":true,"path":"2021/06/26/350/","link":"","permalink":"https://github.13sai.com/2021/06/26/350/","excerpt":"","text":"æ„å»ºdemoé•œåƒè‡ªå·±åˆ¶ä½œä¸ªé•œåƒæ–¹ä¾¿æµ‹è¯•ã€‚ go mod init k8s-configmap-demo main.go package main import ( &quot;fmt&quot; &quot;net/http&quot; &quot;github.com/gin-gonic/gin&quot; &quot;github.com/spf13/pflag&quot; &quot;github.com/spf13/viper&quot; ) var ( conf = pflag.StringP(&quot;config&quot;, &quot;c&quot;, &quot;&quot;, &quot;config filepath&quot;) ) type Config struct &#123; Name string &#125; // å¯¹å¤–çš„åˆå§‹åŒ–é…ç½®æ–¹æ³• func configRun(cfg string) error &#123; c := Config&#123; Name: cfg, &#125; if err := c.init(); err != nil &#123; return err &#125; return nil &#125; func (c *Config) init() error &#123; if c.Name != &quot;&quot; &#123; viper.SetConfigFile(c.Name) &#125; else &#123; // é»˜è®¤é…ç½®æ–‡ä»¶æ˜¯./config.yaml viper.AddConfigPath(&quot;.&quot;) viper.SetConfigName(&quot;config&quot;) &#125; viper.SetConfigType(&quot;yaml&quot;) // viperè§£æé…ç½®æ–‡ä»¶ err := viper.ReadInConfig() if err != nil &#123; panic(fmt.Errorf(&quot;Fatal error config file: %s \\n&quot;, err)) &#125; return nil &#125; func main() &#123; pflag.Parse() // åˆå§‹åŒ–é…ç½® if err := configRun(*conf); err != nil &#123; panic(err) &#125; gin.SetMode(viper.GetString(&quot;mode&quot;)) g := gin.New() g = LoadRoute(g) g.Run(viper.GetString(&quot;addr&quot;)) &#125; func LoadRoute(g *gin.Engine) *gin.Engine &#123; g.Use(gin.Recovery()) // 404 g.NoRoute(func (c *gin.Context) &#123; c.String(http.StatusNotFound, &quot;404 not found&quot;); &#125;) g.GET(&quot;/&quot;, Index) return g &#125; // è¿”å› type Response struct &#123; Code int `json:&quot;code&quot;` Message string `json:&quot;message&quot;` Data interface&#123;&#125; `json:&quot;data&quot;` &#125; // apiè¿”å›ç»“æ„ func ApiResponse(c *gin.Context, code int, message string, data interface&#123;&#125;) &#123; c.JSON(http.StatusOK, Response&#123; Code: code, Message: message, Data: data, &#125;) &#125; func Index(c *gin.Context) &#123; ApiResponse(c, 0, &quot;success&quot;, viper.GetString(&quot;hi&quot;)) &#125; ä»£ç æ¯”è¾ƒç®€å•ï¼Œè¯»å–config,è¿è¡Œä¸€ä¸ªgin httpæœåŠ¡ï¼Œè¿”å›é…ç½®é¡¹[hi]çš„å­—ç¬¦ä¸²ã€‚ config.yaml name: demo2 mode: debug addr: :8080 hi: w~o~w Dockerfile FROM golang:alpine AS builder ENV CGO_ENABLED 0 ENV GOPROXY https://goproxy.cn,direct WORKDIR /app ADD go.mod . ADD go.sum . RUN go mod download COPY main.go . RUN go build -o 13sai main.go FROM alpine WORKDIR /app COPY --from=builder /app/13sai /app/13sai ADD config.yaml . CMD [&quot;./13sai&quot;] æ„å»ºï¼š docker build -t k8s-configmap-demo:0.2 . docker tag k8s-configmap-demo:0.2 13sai/k8s-configmap-demo:0.2 æäº¤é•œåƒåˆ°hubdocker login docker push 13sai/k8s-configmap-demo:0.2 k8sçš„é…ç½®æˆ‘ä½¿ç”¨çš„æ˜¯Kuboardï¼Œä¸‹é¢çš„æ“ä½œéƒ½æ˜¯åœ¨Kuboardæ‰§è¡Œ ConfigMapé…ç½®åˆ›å»ºConfigMap:è¿›å…¥defaultç©ºé—´ &gt; èµ„æº &gt; é…ç½®å­—å…¸ï¼š åç§° sai é…ç½®æ•°æ®åç§° config.yaml é…ç½®å†…å®¹ config.yamlé‡Œçš„å†…å®¹ åˆ›å»ºè´Ÿè½½é…ç½®å¯å‚ç…§ä¸‹é¢æˆªå›¾ï¼Œæ³¨æ„å‡ å¤„ï¼š æ•°æ®å· Volumeï¼Œé€‰æ‹©configMap è¿è¡Œå®¹å™¨ç»„podçš„Commandå’ŒæŒ‚è½½ç‚¹ ä¿å­˜åå³å¯ã€‚ æœ€åè´´å‡ºç”Ÿæˆçš„yamlæ–‡ä»¶ apiVersion: v1 kind: ConfigMap metadata: # å…ƒæ•°æ®ï¼Œå®šä¹‰åŸºæœ¬å±æ€§å’Œä¿¡æ¯ name: sai-config # åç§° data: config.yaml: |- name: sai0556 mode: debug addr: :8080 hi: w~o~w --- apiVersion: v1 kind: Service metadata: name: sai labels: # æ ‡ç­¾ app: sai spec: # æè¿° ports: - protocol: TCP port: 80 targetPort: 8080 selector: app: sai --- apiVersion: apps/v1 kind: Deployment metadata: name: sai spec: replicas: 3 # åˆ›å»ºåº”ç”¨ç¨‹åºå®ä¾‹ä¸ªæ•° selector: # æ ‡ç­¾é€‰æ‹©å™¨ matchLabels: # é€‰æ‹©åŒ…å«æ ‡ç­¾app:saiçš„èµ„æº app: sai template: # æ¨¡æ¿ metadata: labels: app: sai spec: containers: - name: sai image: 13sai/k8s-configmap-demo:0.2 imagePullPolicy: IfNotPresent command: - &#x27;/app/13sai&#x27; volumeMounts: - name: config mountPath: /app/config.yaml readOnly: true subPath: config.yaml volumes: - name: config configMap: defaultMode: 0600 name: sai-config","categories":[{"name":"kubernetes","slug":"kubernetes","permalink":"https://github.13sai.com/categories/kubernetes/"}],"tags":[{"name":"kubernetes","slug":"kubernetes","permalink":"https://github.13sai.com/tags/kubernetes/"}]},{"title":"é¢†åŸŸé©±åŠ¨è®¾è®¡","slug":"é¢†åŸŸé©±åŠ¨è®¾è®¡","date":"2021-06-10T05:06:19.000Z","updated":"2022-03-19T14:35:21.959Z","comments":true,"path":"2021/06/10/345/","link":"","permalink":"https://github.13sai.com/2021/06/10/345/","excerpt":"","text":"é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDomain Driven Designï¼‰çš„æ¦‚å¿µå‡ºç°äº 2003 å¹´ï¼Œä¸æ•æ·ç›¸æ¯”ï¼ŒDDD åœ¨æå‡ºä¹‹åçš„å¾ˆå¤šå¹´éƒ½æ²¡æœ‰ç§°å¾—ä¸Šâ€œæµè¡Œâ€ï¼Œç”šè‡³è¯´ä»æœªçœŸæ­£æµè¡Œè¿‡ã€‚ä¸€éƒ¨åˆ†æ˜¯å› ä¸º DDD æ¶‰åŠäº†ä¸€äº›æ–°çš„åè¯å’Œæ¦‚å¿µï¼ˆæ¯”å¦‚èšåˆã€é™ç•Œä¸Šä¸‹æ–‡å’Œé¢†åŸŸç­‰ï¼‰ï¼Œåœ¨ç¼ºä¹å…·ä½“å®è·µæ¡ˆä¾‹çš„åœºæ™¯ä¸‹ï¼Œè¾ƒéš¾ç†è§£è¿™äº›æŠ½è±¡æ¦‚å¿µï¼Œè¿™å¯¼è‡´äº†å­¦ä¹ å’Œåº”ç”¨ DDD çš„åˆæœŸé˜¶æ®µå°±å˜å¾—ä¸å¤ªé¡ºç•…ï¼Œå¼€å‘äººå‘˜å¯èƒ½å¹¶ä¸èƒ½é¢†ä¼šåˆ°å…¶ä¸­çš„è®¾è®¡æ€æƒ³åŠå…¶å¸¦æ¥çš„ä»·å€¼ã€‚ä½†æ˜¯åœ¨å°èŒƒå›´ç¾¤ä½“å†…ï¼Œé€æ¸æœ‰ä¸€æ‰¹å·¥ç¨‹å¸ˆå¼€å§‹èƒ½å¤ŸæŒæ§è¿™ç§å»ºæ¨¡æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨ DDD æ¥è®¾è®¡å‡ºå…·æœ‰è¾ƒé«˜ä¸šåŠ¡å¤æ‚æ€§çš„è½¯ä»¶åº”ç”¨ã€‚ 2013å¹´åï¼Œåˆ†å¸ƒå¼çš„åŸºç¡€è®¾æ–½é€æ¸æˆç†Ÿã€‚Martin Fowler äº 2014 å¹´å‘è¡¨äº†ç³»ç»Ÿé˜è¿°å¾®æœåŠ¡çš„æ–‡ç« ï¼Œå¾®æœåŠ¡æ¶æ„å¼€å§‹å…´èµ·ã€‚è½¯ä»¶å·¥ç¨‹å¸ˆä»¬å‘ç°å°†å•ä½“åº”ç”¨é‡‡ç”¨å¾®æœåŠ¡æ¶æ„è¿›è¡Œåˆ’åˆ†éœ€è¦å¤§é‡çš„å®è·µç»éªŒå’Œç†è®ºåŸºç¡€ä½œæŒ‡å¯¼ï¼Œå¦åˆ™ä¸èƒ½å®Œå…¨ä½“ç°å¾®æœåŠ¡æ¶æ„æ‰€å¸¦æ¥çš„ä¼˜åŠ¿ã€‚ä¸è¿‡æ—©æœŸç†Ÿæ‚‰ DDD æ€æƒ³çš„å¼€å‘è€…å‘ç°ï¼ŒDDD å¯ä»¥æœ‰æ•ˆåœ°æ ¹æ®ä¸šåŠ¡å¯¹å¤æ‚è½¯ä»¶ç³»ç»Ÿè¿›è¡Œæ‹†è§£ï¼Œå¾®æœåŠ¡æ¶æ„ä¸ DDD ç›¸å¾—ç›Šå½°ã€‚æŒ‰ç…§è½¯ä»¶å·¥ç¨‹çš„æ€æƒ³ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºå¾®æœåŠ¡æ—¶ï¼Œéœ€è¦æ»¡è¶³é«˜å†…èšã€ä½è€¦åˆçš„è¦æ±‚ã€‚è€Œæ ¹æ® DDD çš„æ€æƒ³ï¼Œå¯ä»¥å°†é™ç•Œä¸Šä¸‹æ–‡ä¸å¾®æœåŠ¡è¿›ç¨‹å¯¹åº”èµ·æ¥ã€‚DDD ä¸­é™ç•Œä¸Šä¸‹æ–‡çš„æ¦‚å¿µå¾ˆå¥‘åˆåŒ¹é…å¾®æœåŠ¡è¦æ±‚ï¼Œè¿™ä¸¤è€…éƒ½å¼ºè°ƒä»ä¸šåŠ¡è§’åº¦è¿›è¡Œåˆ’åˆ†ï¼Œä»¥åº”å¯¹æ—¥ç›Šå¤æ‚çš„è½¯ä»¶ç³»ç»Ÿã€‚ç”±æ­¤ï¼ŒDDD è¿æ¥äº†å®ƒçš„é«˜é€Ÿå‘å±•å’Œæ¨å¹¿æ—¶æœŸã€‚ DDD ä¸æ˜¯è¯­è¨€ï¼Œä¸æ˜¯æ¡†æ¶ï¼Œä¸æ˜¯æ¶æ„ï¼Œè€Œæ˜¯ä¸€ç§æ€æƒ³ï¼Œä¸€ç§æ–¹æ³•è®ºï¼Œå®ƒå¯ä»¥åˆ†ç¦»ä¸šåŠ¡å¤æ‚åº¦å’ŒæŠ€æœ¯å¤æ‚åº¦ï¼›DDD ä¹Ÿå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„äº‹ç‰©ï¼Œå®ƒæ˜¯é¢å‘å¯¹è±¡çš„æå‡ï¼Œæœ€ç»ˆç›®æ ‡è¿˜æ˜¯é«˜å†…èšã€ä½è€¦åˆã€‚ Eric Evansåœ¨ã€Šé¢†åŸŸé©±åŠ¨è®¾è®¡ã€‹ä¸€ä¹¦ä¸­ï¼Œæå‡ºäº†ç»å…¸çš„å››å±‚æ¶æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç”¨æˆ·ç•Œé¢User Interfaceè´Ÿè´£ç»™ç”¨æˆ·å±•ç¤ºä¿¡æ¯ï¼Œå¹¶è§£é‡Šç”¨æˆ·å‘½ä»¤ã€‚ åº”ç”¨å±‚Applicationè´Ÿè´£åè°ƒåº”ç”¨ç¨‹åºçš„æ´»åŠ¨ã€‚ä¸åŒ…æ‹¬ä»»ä½•ä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¿å­˜ä¸šåŠ¡å¯¹è±¡çš„çŠ¶æ€ï¼Œä½†èƒ½ä¿å­˜åº”ç”¨ç¨‹åºä»»åŠ¡è¿‡ç¨‹çš„çŠ¶æ€ã€‚ é¢†åŸŸå±‚Domainè´Ÿè´£ä¸šåŠ¡é¢†åŸŸçš„ä¿¡æ¯å’ŒçŠ¶æ€çš„ä¿å­˜å’Œç»´æŠ¤ã€‚ä¸šåŠ¡å¯¹è±¡çš„æŒä¹…åŒ–å’Œå®ƒä»¬çš„çŠ¶æ€å¯èƒ½ä¼šå§”æ‰˜ç»™åŸºç¡€è®¾æ–½å±‚ã€‚ åŸºç¡€è®¾æ–½å±‚Infrastructureè´Ÿè´£æ”¯æŒå…¶ä»–å±‚æ¬¡ï¼Œæä¾›åŸºç¡€çš„æ¶ˆæ¯ä¼ é€’ã€æ•°æ®æŒä¹…åŒ–ç­‰åŠŸèƒ½ã€‚å®ƒæä¾›å±‚ä¹‹é—´çš„ä¿¡æ¯ä¼ é€’ï¼Œå®ç°ä¸šåŠ¡å¯¹è±¡çš„æŒä¹…åŒ–ï¼ŒåŒ…å«å¯¹ç”¨æˆ·ç•Œé¢å±‚çš„æ”¯æŒæ€§åº“ç­‰ã€‚ æˆ‘ä»¬ä»¥è´­ç‰©è½¦ä¸‹è®¢å•åŠŸèƒ½ä¸ºä¾‹æ¥è§£é‡Šè¿™å„ä¸ªå±‚é¢çš„ä½œç”¨ï¼š ç”¨æˆ·ç•Œé¢å±‚æä¾›ä¸‹å•çš„æ¥å£ åº”ç”¨å±‚è´Ÿè´£é€»è¾‘çš„æ•´åˆï¼Œå¦‚è´­ç‰©è½¦æ¸…ç©ºã€æ£€æŸ¥åº“å­˜ç­‰ é¢†åŸŸå±‚å°†è´­ç‰©è½¦ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘å°è£…åˆ°ä¸€ä¸ª ShoppingCar å¯¹è±¡ä¸­ï¼Œè°ƒç”¨ shoppingCar.orderä¸‹è®¢å•ï¼Œä¸šåŠ¡æœåŠ¡çš„é‡å¿ƒä»ç”Ÿæˆè®¢å•è¡¨ä¸­çš„è®°å½•è½¬ç§»åˆ°è´­ç‰©è½¦å¯¹è±¡æœ¬èº« åº•å±‚æ•°æ®åº“ä¸­å¦‚ä½•ç”Ÿæˆè¿™æ¡è®°å½•å¹¶ä¸å±äºæˆ‘ä»¬çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œè¿™å¯¹åº” DDD ä¸­çš„åŸºç¡€è®¾æ–½å±‚ï¼Œç”± Repository æˆ–è€… Dao ç­‰æ•°æ®äº¤äº’å¯¹è±¡è´Ÿè´£å»æŒä¹…åŒ–æˆ‘ä»¬å¯¹é¢†åŸŸæ¨¡å‹ä¸‹è¾¾çš„æŒ‡ä»¤æ‰€äº§ç”Ÿçš„æ•°æ®åº“å˜åŒ–ã€‚","categories":[{"name":"design","slug":"design","permalink":"https://github.13sai.com/categories/design/"}],"tags":[{"name":"DDD","slug":"DDD","permalink":"https://github.13sai.com/tags/DDD/"}]},{"title":"Protobufè¯­æ³•","slug":"Protobufè¯­æ³•","date":"2021-05-27T09:39:07.000Z","updated":"2022-03-19T14:35:21.636Z","comments":true,"path":"2021/05/27/340/","link":"","permalink":"https://github.13sai.com/2021/05/27/340/","excerpt":"","text":"Protobufæ˜¯Protocol Bufferçš„ç®€ç§°ï¼Œå®ƒæ˜¯Googleå…¬å¸å¼€å‘çš„ä¸€ç§æ•°æ®æè¿°è¯­è¨€ï¼Œç”¨äºæè¿°ä¸€ç§è½»ä¾¿é«˜æ•ˆçš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œæ˜¯ä¸€ç§é«˜æ•ˆçš„æ•°æ®æ ¼å¼ï¼Œå¹³å°æ— å…³ã€è¯­è¨€æ— å…³ã€å¯æ‰©å±•ï¼Œå¸¸ç”¨äºRPCç³»ç»Ÿå’ŒæŒç»­æ•°æ®å­˜å‚¨ç³»ç»Ÿã€‚ å­—æ®µè§„åˆ™å­—æ®µæ ¼å¼ é™å®šä¿®é¥°ç¬¦ | æ•°æ®ç±»å‹ | å­—æ®µåç§° | = | å­—æ®µç¼–ç å€¼ | [å­—æ®µé»˜è®¤å€¼] é™å®šä¿®é¥°ç¬¦ requiredã€optionalã€repeated Requiredï¼šè¡¨ç¤ºæ˜¯ä¸€ä¸ªå¿…é¡»å­—æ®µ Optionalï¼šè¡¨ç¤ºä¸€ä¸ªå¯é€‰å­—æ®µã€‚å¯¹äºæ¥æ”¶æ–¹ï¼Œå¦‚æœèƒ½å¤Ÿè¯†åˆ«å¯é€‰å­—æ®µå°±è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œå¦‚æœæ— æ³•è¯†åˆ«ï¼Œåˆ™å¿½ç•¥è¯¥å­—æ®µ Repeatedï¼šè¡¨ç¤ºè¯¥å­—æ®µå¯ä»¥åŒ…å«0-Nä¸ªå…ƒç´ ã€‚å…¶ä¸­ç‰¹æ€§å’Œoptionalä¸€æ ·ï¼Œä½†æ˜¯æ¯ä¸€æ¬¡å¯ä»¥åŒ…å«å¤šä¸ªå€¼ã€‚å¯ä»¥çœ‹åšæ˜¯åœ¨ä¼ é€’ä¸€ä¸ªæ•°ç»„çš„å€¼ æ•°æ®ç±»å‹Protobufå®šä¹‰äº†ä¸€å¥—åŸºæœ¬æ•°æ®ç±»å‹ï¼š .proto ç±»å‹ Notes C++ Type Java Type Python Type Go Type Ruby Type C# Type PHP Type Dart Type double double double float float64 Float double float double float float float float float32 Float float float double int32 ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚ç¼–ç è´Ÿæ•°çš„æ•ˆç‡ä½ - å¦‚æœæ‚¨çš„å­—æ®µå¯èƒ½æœ‰è´Ÿå€¼ï¼Œè¯·æ”¹ç”¨sint32ã€‚ int32 int int int32 Fixnum or Bignum (as required) int integer int int64 ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚ç¼–ç è´Ÿæ•°çš„æ•ˆç‡ä½ - å¦‚æœæ‚¨çš„å­—æ®µå¯èƒ½æœ‰è´Ÿå€¼ï¼Œè¯·æ”¹ç”¨sint64ã€‚ int64 long int/long[] int64 Bignum long integer/string[] Int64 uint32 ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç  uint32 int int/long uint32 Fixnum or Bignum (as required) uint integer int uint64 ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç . uint64 long int/long uint64 Bignum ulong integer/string[] Int64 sint32 ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚ç­¾åçš„intå€¼ã€‚è¿™äº›æ¯”å¸¸è§„int32æ›´æœ‰æ•ˆåœ°ç¼–ç è´Ÿæ•°ã€‚ int32 int int int32 Fixnum or Bignum (as required) int integer int sint64 ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ã€‚ç­¾åçš„intå€¼ã€‚è¿™äº›æ¯”å¸¸è§„int64æ›´æœ‰æ•ˆåœ°ç¼–ç è´Ÿæ•°ã€‚ int64 long int/long int64 Bignum long integer/string[] Int64 fixed32 æ€»æ˜¯å››ä¸ªå­—èŠ‚ã€‚å¦‚æœå€¼é€šå¸¸å¤§äº228ï¼Œåˆ™æ¯”uint32æ›´æœ‰æ•ˆã€‚ uint32 int int/long uint32 Fixnum or Bignum (as required) uint integer int fixed64 æ€»æ˜¯å…«ä¸ªå­—èŠ‚ã€‚å¦‚æœå€¼é€šå¸¸å¤§äº256ï¼Œåˆ™æ¯”uint64æ›´æœ‰æ•ˆ uint64 long int/long[] uint64 Bignum ulong integer/string[] Int64 sfixed32 æ€»æ˜¯å››ä¸ªå­—èŠ‚ int32 int int int32 Fixnum or Bignum (as required) int integer int sfixed64 æ€»æ˜¯å…«ä¸ªå­—èŠ‚ int64 long int/long int64 Bignum long integer/string[] Int64 bool bool boolean bool bool TrueClass/FalseClass bool boolean bool string å­—ç¬¦ä¸²å¿…é¡»å§‹ç»ˆåŒ…å«UTF-8ç¼–ç æˆ–7ä½ASCIIæ–‡æœ¬ï¼Œä¸”ä¸èƒ½è¶…è¿‡232ã€‚ string String str/unicode string String (UTF-8) string string String bytes å¯ä»¥åŒ…å«ä¸è¶…è¿‡232çš„ä»»æ„å­—èŠ‚åºåˆ—ã€‚ string ByteString str []byte String (ASCII-8BIT) ByteString string List å­—æ®µåç§°å­—æ®µåç§°çš„å‘½åä¸Cã€Javaç­‰è¯­è¨€çš„å˜é‡å‘½åæ–¹å¼å‡ ä¹æ˜¯ç›¸åŒçš„protobuf å»ºè®®å­—æ®µçš„å‘½åé‡‡ç”¨ä»¥ä¸‹åˆ’çº¿åˆ†éš”çš„é©¼å³°å¼ å­—æ®µç¼–ç å€¼æœ‰äº†è¯¥å€¼ï¼Œé€šä¿¡åŒæ–¹æ‰èƒ½äº’ç›¸è¯†åˆ«å¯¹æ–¹çš„å­—æ®µï¼Œç›¸åŒçš„ç¼–ç å€¼ï¼Œå…¶é™å®šä¿®é¥°ç¬¦å’Œæ•°æ®ç±»å‹å¿…é¡»ç›¸åŒï¼Œç¼–ç å€¼çš„å–å€¼èŒƒå›´ä¸ºï¼š1 ~ 2^32 (4294967296)å…¶ä¸­ 1 ~ 15çš„ç¼–ç æ—¶é—´å’Œç©ºé—´æ•ˆç‡éƒ½æ˜¯æœ€é«˜çš„ï¼Œç¼–ç å€¼è¶Šå¤§ï¼Œå…¶ç¼–ç çš„æ—¶é—´å’Œç©ºé—´æ•ˆç‡å°±è¶Šä½1900 ~ 2000 ç¼–ç å€¼ä¸º Google protobuf ç³»ç»Ÿå†…éƒ¨ä¿ç•™å€¼ï¼Œå»ºè®®ä¸è¦åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ å­—æ®µé»˜è®¤å€¼å½“åœ¨ä¼ é€’æ•°æ®æ—¶ï¼Œå¯¹äºrequiredæ•°æ®ç±»å‹ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è®¾ç½®å€¼ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ä¼ é€’åˆ°å¯¹ç«¯ å®šä¹‰service å¦‚æœæƒ³è¦å°†æ¶ˆæ¯ç±»å‹ç”¨åœ¨ RPC ç³»ç»Ÿä¸­ï¼Œå¯ä»¥åœ¨ .protoæ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ª RPC æœåŠ¡æ¥å£ï¼Œprotocol buffer ç¼–è¯‘å™¨ä¼šæ ¹æ®æ‰€é€‰æ‹©çš„ä¸åŒè¯­è¨€ç”ŸæˆæœåŠ¡æ¥å£ä»£ç  ç”Ÿæˆçš„æ¥å£ä»£ç ä½œä¸ºå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„çº¦å®šï¼ŒæœåŠ¡ç«¯å¿…é¡»å®ç°å®šä¹‰çš„æ‰€æœ‰æ¥å£æ–¹æ³•ï¼Œå®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨åŒåæ–¹æ³•å‘æœåŠ¡ç«¯å‘èµ·è¯·æ±‚ï¼ˆå³ä¾¿ä¸šåŠ¡ä¸Šä¸éœ€è¦å‚æ•°ä¹Ÿå¿…é¡»æŒ‡å®šä¸€ä¸ªè¯·æ±‚æ¶ˆæ¯ï¼Œä¸€èˆ¬ä¼šå®šä¹‰ä¸€ä¸ªç©ºmessageï¼‰ æ¯”å¦‚ï¼Œæƒ³è¦å®šä¹‰ä¸€ä¸ª RPC æœåŠ¡å¹¶å…·æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥æ”¶ SearchRequest å¹¶è¿”å›ä¸€ä¸ª SearchResponseï¼Œæ­¤æ—¶å¯ä»¥åœ¨.protoæ–‡ä»¶ä¸­è¿›è¡Œå¦‚ä¸‹å®šä¹‰ï¼š service SearchService &#123; rpc Search(SearchRequest) returns (SearchResponse) &#123;&#125; &#125; å®šä¹‰Message ä¸€ä¸ª message ç±»å‹å®šä¹‰æè¿°äº†ä¸€ä¸ªè¯·æ±‚æˆ–å“åº”çš„æ¶ˆæ¯æ ¼å¼ï¼Œå¯ä»¥åŒ…å«å¤šç§ç±»å‹å­—æ®µ å­—æ®µåç”¨å°å†™ï¼Œè½¬ä¸º go æ–‡ä»¶åè‡ªåŠ¨å˜ä¸ºå¤§å†™ï¼Œmessage å°±ç›¸å½“äºç»“æ„ä½“ æ·»åŠ æ›´å¤š Message ç±»å‹ä¸€ä¸ª .proto æ–‡ä»¶ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªæ¶ˆæ¯ç±»å‹ï¼Œä¸€èˆ¬ç”¨äºåŒæ—¶å®šä¹‰å¤šä¸ªç›¸å…³çš„æ¶ˆæ¯ï¼Œä¾‹å¦‚åœ¨åŒä¸€ä¸ª .proto æ–‡ä»¶ä¸­åŒæ—¶å®šä¹‰æœç´¢è¯·æ±‚å’Œå“åº”æ¶ˆæ¯ï¼š // å£°æ˜ä½¿ç”¨çš„ protobuf ç‰ˆæœ¬ syntax = &quot;proto3&quot; message SearchRequest &#123; string query = 1; int32 page_number = 2; int32 result_per_page = ; &#125; message SearchResponse &#123; &#125; ä½¿ç”¨å…¶ä»– Messagemessage æ”¯æŒåµŒå¥—ä½¿ç”¨ï¼Œä½œä¸ºå¦ä¸€ä¸ª message ä¸­çš„å­—æ®µç±»å‹ message SearchResponse &#123; repeated Result results = 1; &#125; message Result &#123; string url = 1; string title = 2; repeated string snippets = ; &#125; Message åµŒå¥—çš„ä½¿ç”¨æ”¯æŒåµŒå¥—æ¶ˆæ¯ï¼Œæ¶ˆæ¯å¯ä»¥åŒ…å«å¦ä¸€ä¸ªæ¶ˆæ¯ä½œä¸ºå­—æ®µã€‚ä¹Ÿå¯ä»¥åœ¨æ¶ˆæ¯å†…å®šä¹‰ä¸€ä¸ªæ–°çš„æ¶ˆæ¯ã€‚ å†…éƒ¨å£°æ˜çš„ message ç±»å‹åç§°åªå¯åœ¨å†…éƒ¨ç›´æ¥ä½¿ç”¨ï¼š message SearchResponse &#123; message Result &#123; string url = 1; string title = 2; repeated string snippets = ; &#125; repeated Result results = 1; &#125; å¤šå±‚åµŒå¥—ï¼š message Outer &#123; message A &#123; message Inner &#123; int64 ival = 1; bool booly = 2; &#125; &#125; message B &#123; message Inner &#123; int64 ival = 1; bool booly = 2; &#125; &#125; &#125; æ˜ å°„å­—æ®µæ¯ä¸ªæ˜ å°„å­—æ®µä¼šåœ¨Goçš„ç»“æ„ä½“ä¸­ç”Ÿæˆä¸€ä¸ªmap[TKey]TValueç±»å‹çš„å­—æ®µï¼Œå…¶ä¸­TKeyæ˜¯å­—æ®µçš„é”®ç±»å‹TValueæ˜¯å­—æ®µçš„å€¼ç±»å‹ã€‚å¯¹äºä¸‹é¢è¿™ä¸ªæ¶ˆæ¯å®šä¹‰ï¼š message Bar &#123;&#125; message Baz &#123; map&lt;string, Bar&gt; foo = 1; &#125; ç¼–è¯‘å™¨ç”ŸæˆGoç»“æ„ä½“ type Baz struct &#123; Foo map[string]*Bar &#125; æšä¸¾ç»™å‡ºå¦‚ä¸‹æšä¸¾ message SearchRequest &#123; enum Corpus &#123; UNIVERSAL = 0; WEB = 1; IMAGES = 2; LOCAL = 3; NEWS = 4; PRODUCTS = 5; VIDEO = 6; &#125; Corpus corpus = 1; ... &#125; ç¼–è¯‘å™¨å°†ä¼šç”Ÿæˆä¸€ä¸ªæšä¸¾ç±»å‹å’Œä¸€ç³»åˆ—è¯¥ç±»å‹çš„å¸¸é‡ã€‚ .proto æ–‡ä»¶ç¼–è¯‘ä»£ç  é€šè¿‡å®šä¹‰å¥½çš„ .proto æ–‡ä»¶ç”Ÿæˆ Goã€PHPã€Javaã€Pythonç­‰ä»£ç ï¼Œéœ€è¦å®‰è£…ç¼–è¯‘å™¨ protocã€‚ ä½¿ç”¨ protobuf ç¼–è¯‘å™¨ä¸åŒçš„è¯­è¨€ç”Ÿæˆçš„ä»£ç æ ¼å¼ä¸åŒï¼Œæ¯”å¦‚Goï¼šç”Ÿæˆä¸€ä¸ª .pb.go æ–‡ä»¶ï¼Œæ¯ä¸ªæ¶ˆæ¯ç±»å‹å¯¹åº”ä¸€ä¸ªç»“æ„ä½“ã€‚ å…·ä½“protocå®‰è£…å’Œä»£ç ç”Ÿæˆå¯è§ï¼šgRPCåˆä½“éªŒ ä¹Ÿæœ‰çœ‹åˆ°éƒ¨åˆ†é¡¹ç›®ä½¿ç”¨protobufå»æ›¿ä»£jsonå»è¿›è¡Œå‰åç«¯æ•°æ®äº¤æ¢ã€‚ å‚è€ƒï¼š Protobuf è¯­æ³• Protobufè¯­è¨€æŒ‡å— Protobufç”ŸæˆGoä»£ç æŒ‡å—","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"Protobuf","slug":"Protobuf","permalink":"https://github.13sai.com/tags/Protobuf/"}]},{"title":"golangçš„å•å¼•å·åŒå¼•å·åå¼•å·","slug":"golangçš„å•å¼•å·åŒå¼•å·åå¼•å·","date":"2021-04-29T14:59:55.000Z","updated":"2022-07-05T08:49:29.108Z","comments":true,"path":"2021/04/29/335/","link":"","permalink":"https://github.13sai.com/2021/04/29/335/","excerpt":"","text":"å•å¼•å·Single quoteï¼Œè¡¨ç¤ºbyteç±»å‹æˆ–runeç±»å‹ï¼Œå¯¹åº” uint8å’Œint32ç±»å‹ï¼Œé»˜è®¤æ˜¯ rune ç±»å‹ã€‚byteç”¨æ¥å¼ºè°ƒæ•°æ®æ˜¯raw dataï¼Œè€Œä¸æ˜¯æ•°å­—ï¼›è€Œruneç”¨æ¥è¡¨ç¤ºUnicodeçš„code pointã€‚ åŒå¼•å·Double quoteï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œå®é™…ä¸Šæ˜¯å­—ç¬¦æ•°ç»„ã€‚å¯ä»¥ç”¨ç´¢å¼•å·è®¿é—®æŸå­—èŠ‚ï¼Œä¹Ÿå¯ä»¥ç”¨len()å‡½æ•°æ¥è·å–å­—ç¬¦ä¸²æ‰€å çš„å­—èŠ‚é•¿åº¦ã€‚ åå¼•å·Back quoteï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²å­—é¢é‡ï¼Œä¸åŒå¼•å·ä¸åŒï¼Œå®ƒä¸æ”¯æŒä»»ä½•è½¬ä¹‰åºåˆ—ï¼Œä½†æ”¯æŒæ¢è¡Œä¹¦å†™ã€‚å­—é¢é‡ raw literal string çš„æ„æ€æ˜¯ï¼Œä½ å®šä¹‰æ—¶å†™çš„å•¥æ ·ï¼Œå®ƒå°±å•¥æ ·ï¼Œä½ æœ‰æ¢è¡Œï¼Œå®ƒå°±æ¢è¡Œã€‚ä½ å†™è½¬ä¹‰å­—ç¬¦ï¼Œå®ƒä¹Ÿå°±å±•ç¤ºè½¬ä¹‰å­—ç¬¦ã€‚ a := &#x27;a&#x27; b := &quot;b\\naa&quot; c := `c 3ww` var d byte = &#x27;d&#x27; fmt.Println(b) fmt.Println(c) fmt.Printf(&quot;Single quote type:%T\\n&quot;, a) fmt.Printf(&quot;Double quote type:%T\\n&quot;, b) fmt.Printf(&quot;Back quote type:%T\\n&quot;, c) fmt.Printf(&quot;Single quote type:%T\\n&quot;, d) output: ------ b aa c 3ww Single quote type:int32 Double quote type:string Back quote type:string Single quote type:uint8","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"MACå®‰è£…rabbitmqæ‰©å±•","slug":"MACå®‰è£…rabbitmqæ‰©å±•","date":"2021-04-29T03:36:56.000Z","updated":"2022-03-19T14:35:21.610Z","comments":true,"path":"2021/04/29/333/","link":"","permalink":"https://github.13sai.com/2021/04/29/333/","excerpt":"","text":"PHPç»“åˆrabbitMQéœ€è¦å®‰è£…amqpæ‰©å±•ï¼Œä¹‹å‰åˆåœ¨windowså®‰è£…ï¼Œä»Šå¤©å°è¯•macå®‰è£…ä¸€ä¸‹ã€‚ ä¸‹è½½ å‰å»amqpï¼Œä¸‹è½½éœ€è¦çš„ç‰ˆæœ¬ã€‚ å®‰è£… phpize // --with-php-config è·¯å¾„è‡ªå·±ä¿®æ”¹ ./configure --with-php-config=xxx/php-config make &amp;&amp; make install å¦‚æœæ²¡è£…rabbitmq-cï¼Œåº”è¯¥ä¼šæŠ¥é”™ã€‚ configure: error: Please reinstall the librabbitmq distribution itself or (re)install librabbitmq development package if it available in your system ä¸‹è½½rabbitmq-c cd rabbitmq-c-0.8.0 ./configure --prefix=/usr/local/rabbitmq-c make &amp;&amp; make install é‡æ–°ç¼–è¯‘amqp ./configure --with-php-config=xxx/php-config --with-amqp --with-librabbitmq-dir=/usr/local/rabbitmq-c/ make &amp;&amp; make install makeæ—¶æç¤ºç¼ºå°‘amqp_ssl_socket.hfatal error: â€˜amqp_ssl_socket.hâ€™ file not found#include &lt;amqp_ssl_socket.h&gt; è¿™é‡Œå¯ä»¥çœ‹ä¸€ä¸‹ https://github.com/alanxz/rabbitmq-c/issues/463 ç„¶åå¯ä»¥æŠŠrabbitmq-cçš„librabbitmqä¸‹amqp_ssl_socket.hæ–‡ä»¶copyåˆ°amqpæ‰©å±•ç›®å½•ï¼Œé‡æ–°ç¼–è¯‘å³å¯ã€‚ å®‰è£…æˆåŠŸè®°å¾—åœ¨iniåŠ å…¥extension=â€amqp.soâ€ï¼Œæœ€åå¯ä»¥ä½¿ç”¨php -m","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"Rediså¯¹è±¡åº•å±‚æ•°æ®ç»“æ„","slug":"Rediså¯¹è±¡åº•å±‚æ•°æ®ç»“æ„","date":"2021-03-23T13:46:51.000Z","updated":"2022-03-30T11:26:50.730Z","comments":true,"path":"2021/03/23/source/","link":"","permalink":"https://github.13sai.com/2021/03/23/source/","excerpt":"","text":"Rediså¯¹è±¡åº•å±‚æ•°æ®ç»“æ„ ç¼–ç å¸¸é‡ ç¼–ç æ‰€å¯¹åº”çš„åº•å±‚æ•°æ®ç»“æ„ REDIS_ENCODING_INT long ç±»å‹çš„æ•´æ•° REDIS_ENCODING_EMBSTR embstr ç¼–ç çš„ç®€å•åŠ¨æ€å­—ç¬¦ä¸² REDIS_ENCODING_RAW ç®€å•åŠ¨æ€å­—ç¬¦ä¸² REDIS_ENCODING_HT å­—å…¸ REDIS_ENCODING_LINKEDLIST åŒç«¯é“¾è¡¨ REDIS_ENCODING_ZIPLIST å‹ç¼©åˆ—è¡¨ REDIS_ENCODING_INTSET æ•´æ•°é›†åˆ REDIS_ENCODING_SKIPLIST è·³è·ƒè¡¨ redis stringç±»å‹è½¬æ¢ æˆ‘ä»¬å¯èƒ½ä»¥ä¸ºredisåœ¨å†…éƒ¨å­˜å‚¨stringéƒ½æ˜¯ç”¨sdsçš„æ•°æ®ç»“æ„å®ç°çš„ï¼Œå…¶å®åœ¨æ•´ä¸ªredisçš„æ•°æ®å­˜å‚¨è¿‡ç¨‹ä¸­ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå†…éƒ¨åšäº†å¾ˆå¤šä¼˜åŒ–ã€‚æ•´ä½“é€‰æ‹©é¡ºåºåº”è¯¥æ˜¯ï¼š æ•´æ•°ï¼Œå­˜å‚¨å­—ç¬¦ä¸²é•¿åº¦å°äº21ä¸”èƒ½å¤Ÿè½¬åŒ–ä¸ºæ•´æ•°çš„å­—ç¬¦ä¸²ã€‚ EmbeddedStringï¼Œå­˜å‚¨å­—ç¬¦ä¸²é•¿åº¦å°äº39çš„å­—ç¬¦ä¸²ï¼ˆREDIS_ENCODING_EMBSTR_SIZE_LIMITï¼‰ã€‚ SDSï¼Œå‰©ä½™æƒ…å†µä½¿ç”¨sdsè¿›è¡Œå­˜å‚¨ã€‚ embstrå’Œsdsçš„åŒºåˆ«åœ¨äºå†…å­˜çš„ç”³è¯·å’Œå›æ”¶ embstrçš„åˆ›å»ºåªéœ€åˆ†é…ä¸€æ¬¡å†…å­˜ï¼Œè€Œrawä¸ºä¸¤æ¬¡ï¼ˆä¸€æ¬¡ä¸ºsdsåˆ†é…å¯¹è±¡ï¼Œå¦ä¸€æ¬¡ä¸ºredisObjectåˆ†é…å¯¹è±¡ï¼Œembstrçœå»äº†ç¬¬ä¸€æ¬¡ï¼‰ã€‚ç›¸å¯¹åœ°ï¼Œé‡Šæ”¾å†…å­˜çš„æ¬¡æ•°ä¹Ÿç”±ä¸¤æ¬¡å˜ä¸ºä¸€æ¬¡ã€‚ embstrçš„redisObjectå’Œsdsæ”¾åœ¨ä¸€èµ·ï¼Œæ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜å¸¦æ¥çš„ä¼˜åŠ¿ ç¼ºç‚¹ï¼šrediså¹¶æœªæä¾›ä»»ä½•ä¿®æ”¹embstrçš„æ–¹å¼ï¼Œå³embstræ˜¯åªè¯»çš„å½¢å¼ã€‚å¯¹embstrçš„ä¿®æ”¹å®é™…ä¸Šæ˜¯å…ˆè½¬æ¢ä¸ºrawå†è¿›è¡Œä¿®æ”¹ã€‚ redis listæ•°æ®ç»“æ„ redis listæ•°æ®ç»“æ„åº•å±‚é‡‡ç”¨å‹ç¼©åˆ—è¡¨ziplistæˆ–linkedlistä¸¤ç§æ•°æ®ç»“æ„è¿›è¡Œå­˜å‚¨ï¼Œé¦–å…ˆä»¥ziplistè¿›è¡Œå­˜å‚¨ï¼Œåœ¨ä¸æ»¡è¶³ziplistçš„å­˜å‚¨è¦æ±‚åè½¬æ¢ä¸ºlinkedliståˆ—è¡¨ã€‚ å½“åˆ—è¡¨å¯¹è±¡åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œåˆ—è¡¨å¯¹è±¡ä½¿ç”¨ziplistè¿›è¡Œå­˜å‚¨ï¼Œå¦åˆ™ç”¨linkedlistå­˜å‚¨ã€‚ åˆ—è¡¨å¯¹è±¡ä¿å­˜çš„æ‰€æœ‰å­—ç¬¦ä¸²å…ƒç´ çš„é•¿åº¦å°äº64å­—èŠ‚ åˆ—è¡¨å¯¹è±¡ä¿å­˜çš„å…ƒç´ æ•°é‡å°äº512ä¸ªã€‚ redis hashåº•å±‚å­˜å‚¨ç»“æ„redisçš„å“ˆå¸Œå¯¹è±¡çš„åº•å±‚å­˜å‚¨å¯ä»¥ä½¿ç”¨ziplistï¼ˆå‹ç¼©åˆ—è¡¨ï¼‰å’Œhashtableã€‚å½“hashå¯¹è±¡å¯ä»¥åŒæ—¶æ»¡è¶³ä¸€ä¸‹ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œå“ˆå¸Œå¯¹è±¡ä½¿ç”¨ziplistç¼–ç ã€‚ å“ˆå¸Œå¯¹è±¡ä¿å­˜çš„æ‰€æœ‰é”®å€¼å¯¹çš„é”®å’Œå€¼çš„å­—ç¬¦ä¸²é•¿åº¦éƒ½å°äº64å­—èŠ‚ å“ˆå¸Œå¯¹è±¡ä¿å­˜çš„é”®å€¼å¯¹æ•°é‡å°äº512ä¸ª redisçš„hashæ¶æ„å°±æ˜¯æ ‡å‡†çš„hashtabçš„ç»“æ„ï¼Œé€šè¿‡æŒ‚é“¾è§£å†³å†²çªé—®é¢˜ã€‚ redis setåº•å±‚å­˜å‚¨redisçš„é›†åˆå¯¹è±¡setçš„åº•å±‚å­˜å‚¨ç»“æ„ç‰¹åˆ«ç¥å¥‡ï¼Œåº•å±‚ä½¿ç”¨äº†intsetå’Œhashtableä¸¤ç§æ•°æ®ç»“æ„å­˜å‚¨çš„ï¼Œintsetæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºæ•°ç»„ï¼Œhashtableå°±æ˜¯æ™®é€šçš„å“ˆå¸Œè¡¨ï¼ˆkeyä¸ºsetçš„å€¼ï¼Œvalueä¸ºnullï¼‰ã€‚æ˜¯ä¸æ˜¯è§‰å¾—ç”¨hashtableå­˜å‚¨setæ˜¯ä¸€ä»¶å¾ˆç¥å¥‡çš„äº‹æƒ…ã€‚ setçš„åº•å±‚å­˜å‚¨intsetå’Œhashtableæ˜¯å­˜åœ¨ç¼–ç è½¬æ¢çš„ï¼Œä½¿ç”¨intsetå­˜å‚¨å¿…é¡»æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ï¼Œå¦åˆ™ä½¿ç”¨hashtableï¼Œæ¡ä»¶å¦‚ä¸‹ï¼š ç»“åˆå¯¹è±¡ä¿å­˜çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯æ•´æ•°å€¼ é›†åˆå¯¹è±¡ä¿å­˜çš„å…ƒç´ æ•°é‡ä¸è¶…è¿‡512ä¸ª zsetåº•å±‚å­˜å‚¨ç»“æ„ zsetåº•å±‚çš„å­˜å‚¨ç»“æ„åŒ…æ‹¬ziplistæˆ–skiplistï¼Œåœ¨åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶çš„æ—¶å€™ä½¿ç”¨ziplistï¼Œå…¶ä»–æ—¶å€™ä½¿ç”¨skiplistï¼Œä¸¤ä¸ªæ¡ä»¶å¦‚ä¸‹ï¼š æœ‰åºé›†åˆä¿å­˜çš„å…ƒç´ æ•°é‡å°äº128ä¸ª æœ‰åºé›†åˆä¿å­˜çš„æ‰€æœ‰å…ƒç´ çš„é•¿åº¦å°äº64å­—èŠ‚ å½“ziplistä½œä¸ºzsetçš„åº•å±‚å­˜å‚¨ç»“æ„æ—¶å€™ï¼Œæ¯ä¸ªé›†åˆå…ƒç´ ä½¿ç”¨ä¸¤ä¸ªç´§æŒ¨åœ¨ä¸€èµ·çš„å‹ç¼©åˆ—è¡¨èŠ‚ç‚¹æ¥ä¿å­˜ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¿å­˜å…ƒç´ çš„æˆå‘˜ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¿å­˜å…ƒç´ çš„åˆ†å€¼ã€‚ å½“skiplistä½œä¸ºzsetçš„åº•å±‚å­˜å‚¨ç»“æ„çš„æ—¶å€™ï¼Œä½¿ç”¨skiplistæŒ‰åºä¿å­˜å…ƒç´ åŠåˆ†å€¼ï¼Œä½¿ç”¨dictæ¥ä¿å­˜å…ƒç´ å’Œåˆ†å€¼çš„æ˜ å°„å…³ç³»ã€‚ redis stringåº•å±‚æ•°æ®ç»“æ„ redis liståº•å±‚æ•°æ®ç»“æ„ redis hashåº•å±‚æ•°æ®ç»“æ„ redis setåº•å±‚æ•°æ®ç»“æ„ redis zsetåº•å±‚æ•°æ®ç»“æ„ Redisä¸ºä½•è¦å®šä¹‰å­—ç¬¦ä¸²ä¸ºSDSRedisæ˜¯åº•å±‚ä½¿ç”¨çš„æ˜¯Cè¯­è¨€ï¼Œåœ¨Cè¯­è¨€ä¸­æ²¡æœ‰å­—ç¬¦ä¸²è¿™ç§æ•°æ®ç±»å‹ï¼Œå­—ç¬¦ä¸²å¤§éƒ½æ˜¯é€šè¿‡å­—ç¬¦æ•°ç»„å®ç°çš„ï¼Œä½†æ˜¯ä½¿ç”¨å­—ç¬¦æ•°ç»„æœ‰ä»¥ä¸‹ä¸è¶³ï¼š å­—ç¬¦æ•°ç»„çš„é•¿åº¦éƒ½æ˜¯å›ºå®šï¼Œå®¹æ˜“å‘ç”Ÿç©ºæŒ‡é’ˆå¼‚å¸¸ è·å–å­—ç¬¦æ•°ç»„çš„é•¿åº¦çš„æ—¶å€™éœ€è¦éå†æ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦é«˜ å­—ç¬¦æ•°ç»„é•¿åº¦å‘ç”Ÿæ”¹å˜ä¹‹åéœ€è¦é‡æ–°åˆ†é…å†…å­˜ ä½¿ç”¨\\0è¡¨ç¤ºç»“å°¾ï¼Œåœ¨å­˜å‚¨äºŒè¿›åˆ¶ä¼šå‡ºç°é—®é¢˜ã€‚ //åŠ¨æ€å­—ç¬¦ä¸²ï¼Œæ•°ç»„çš„é•¿åº¦æ˜¯å¯å˜çš„ã€‚ struct sdshdr &#123; unsigned int len;//è®°å½•å½“å‰ä¸²çš„é•¿åº¦ã€‚ unsigned int free;//è®°å½•å‰©ä½™çš„æœ‰æ•ˆé•¿åº¦ã€‚ char buf[];//çœŸæ­£çš„å­—ç¬¦ä¸²ä½ç½®ã€‚ &#125;; Rediså°±è‡ªå·±å®ç°äº†SDSæ¥è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼ŒSDSç›¸å¯¹Cå­—ç¬¦ä¸²æ•°ç»„çš„ä¼˜ç‚¹ï¼š é•¿åº¦è¾¾åˆ°ä¸€å®šæ ‡å‡†ä¼šæœ‰ç›¸åº”çš„æ‰©å®¹ï¼ˆå°äº1Mï¼Œfreeå¢åŠ lenï¼Œå¤§äº1Mï¼Œæ¯æ¬¡å¢åŠ 1Mï¼‰ï¼Œä»è€Œè§£å†³å†…å­˜æº¢å‡ºçš„é—®é¢˜ã€‚ åœ¨SDSçš„å†…éƒ¨å®šä¹‰äº†å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä½¿ç”¨æ—¶å¯ä»¥ç›´æ¥è·å–ï¼Œå¤æ‚åº¦O(1)ï¼Œè§£å†³è·å–é•¿åº¦æ—¶é—´å¤æ‚åº¦é«˜çš„é—®é¢˜ã€‚ SDSæ˜¯ç©ºé—´é¢„åˆ†é…ï¼Œæƒ°æ€§é‡Šæ”¾å†…å­˜çš„ï¼Œä»è€Œå‡å°‘åˆ†é…å†…å­˜çš„æ¬¡æ•° SDSæ ¹æ®é•¿åº¦åˆ¤æ–­ç»“æŸçš„ä½ç½®ï¼Œä»è€Œè§£å†³äºŒè¿›åˆ¶ä¸å®‰å…¨çš„é—®é¢˜ã€‚","categories":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/categories/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/tags/Redis/"}]},{"title":"goroutine","slug":"goroutine","date":"2021-03-19T12:12:19.000Z","updated":"2022-07-05T08:49:54.816Z","comments":true,"path":"2021/03/19/323/","link":"","permalink":"https://github.13sai.com/2021/03/19/323/","excerpt":"","text":"From: å¼„æ‡‚goroutineè°ƒåº¦åŸç† çº¿ç¨‹å®ç°æ¨¡å‹ goroutineç®€ä»‹ golangè¯­è¨€ä½œè€…Rob Pikeè¯´ï¼Œâ€œGoroutineæ˜¯ä¸€ä¸ªä¸å…¶ä»–goroutines å¹¶å‘è¿è¡Œåœ¨åŒä¸€åœ°å€ç©ºé—´çš„Goå‡½æ•°æˆ–æ–¹æ³•ã€‚ä¸€ä¸ªè¿è¡Œçš„ç¨‹åºç”±ä¸€ä¸ªæˆ–æ›´å¤šä¸ªgoroutineç»„æˆã€‚å®ƒä¸çº¿ç¨‹ã€åç¨‹ã€è¿›ç¨‹ç­‰ä¸åŒã€‚å®ƒæ˜¯ä¸€ä¸ªgoroutineâ€œã€‚ goroutineé€šè¿‡é€šé“æ¥é€šä¿¡ï¼Œè€Œåç¨‹é€šè¿‡è®©å‡ºå’Œæ¢å¤æ“ä½œæ¥é€šä¿¡ï¼› goroutine é€šè¿‡Golang çš„è°ƒåº¦å™¨è¿›è¡Œè°ƒåº¦ï¼Œè€Œåç¨‹é€šè¿‡ç¨‹åºæœ¬èº«è°ƒåº¦ï¼› ç®€å•çš„è¯´å°±æ˜¯Golangè‡ªå·±å®ç°äº†åç¨‹å¹¶å«åšgoruntineï¼ˆæœ¬æ–‡ç§°Goåç¨‹ï¼‰ï¼Œä¸”æ¯”åç¨‹æ›´å¼ºå¤§ã€‚ goroutineè°ƒåº¦åŸç†ä¸Šé¢è¯´åˆ°Goåç¨‹æ˜¯é€šè¿‡Golangçš„è°ƒåº¦å™¨è¿›è¡Œè°ƒåº¦çš„ï¼Œå…¶ä¸­è°ƒåº¦å™¨çš„çº¿ç¨‹æ¨¡å‹ä¸ºä¸¤çº§çº¿ç¨‹æ¨¡å‹ã€‚ æœ‰å…³ä¸¤çº§çº¿ç¨‹æ¨¡å‹çš„ä»‹ç»ï¼Œå¯ä»¥çœ‹æ–‡ç« æœ€åã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹Golangå®ç°çš„ä¸¤çº§çº¿ç¨‹æ¨¡å‹æ˜¯æ€æ ·çš„ã€‚é¦–å…ˆè¦çŸ¥é“è¿™ä¸‰ä¸ªå­—æ¯ä»£è¡¨çš„å«ä¹‰ Mï¼šä»£è¡¨å†…æ ¸çº§çš„çº¿ç¨‹ Pï¼šå…¨ç¨‹Processorï¼Œä»£è¡¨è¿è¡ŒGoåç¨‹æ‰€éœ€è¦çš„èµ„æºï¼ˆä¸Šä¸‹æ–‡ç¯å¢ƒï¼‰ Gï¼šä»£è¡¨Goåç¨‹æˆ‘ä»¬å…ˆçœ‹ä¸‹ä¸ºå®ç°è°ƒåº¦Golangå®šä¹‰äº†è¿™äº›æ•°æ®ç»“æ„å­˜Mï¼ŒPï¼ŒG åç§° ä½œç”¨èŒƒå›´ æè¿° å…¨å±€Måˆ—è¡¨ Goçš„è¿è¡Œæ—¶ å­˜æ”¾æ‰€æœ‰Mçš„å•å‘é“¾è¡¨ å…¨å±€Påˆ—è¡¨ Goçš„è¿è¡Œæ—¶ å­˜æ”¾æ‰€æœ‰Pçš„æ•°ç»„ å…¨å±€Gåˆ—è¡¨ Goçš„è¿è¡Œæ—¶ å­˜æ”¾æ‰€æœ‰Gçš„åˆ‡ç‰‡ è°ƒåº¦å™¨çš„ç©ºé—²Måˆ—è¡¨ è°ƒåº¦å™¨ å­˜æ”¾ç©ºé—²Mçš„å•å‘é“¾è¡¨ è°ƒåº¦å™¨çš„ç©ºé—²Påˆ—è¡¨ è°ƒåº¦å™¨ å­˜æ”¾ç©ºé—²Pçš„å•å‘é“¾è¡¨ è°ƒåº¦å™¨çš„è‡ªç”±Gåˆ—è¡¨ è°ƒåº¦å™¨ å­˜æ”¾è‡ªç”±Gçš„å•å‘é“¾è¡¨ï¼ˆæœ‰ä¸¤ä¸ªï¼‰ è°ƒåº¦å™¨çš„å¯è¿è¡ŒGé˜Ÿåˆ— è°ƒåº¦å™¨ å­˜æ”¾å¯è¿è¡ŒGçš„é˜Ÿåˆ— Pçš„è‡ªç”±Gåˆ—è¡¨ æœ¬åœ°P å­˜æ”¾å½“å‰Pä¸­è‡ªç”±Gçš„å•å‘é“¾è¡¨ Pçš„å¯è¿è¡ŒGé˜Ÿåˆ— æœ¬åœ°P å­˜æ”¾å½“å‰Pä¸­å¯è¿è¡ŒGçš„é˜Ÿåˆ— ç„¶åä»ä¸Šå¾€ä¸‹è§£æGoçš„ä¸¤çº§çº¿ç¨‹æ¨¡å‹å›¾ Må’Œå†…æ ¸çº¿ç¨‹ä¹‹é—´æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œä¸€ä¸ªMåœ¨å…¶ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œåªä¼šå’Œä¸€ä¸ªå†…æ ¸çº¿ç¨‹å…³è”ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°å¯¹å†…æ ¸çº¿ç¨‹çš„é¢‘ç¹åˆ‡æ¢ï¼› Golangçš„è¿è¡Œæ—¶æ‰§è¡Œç³»ç»Ÿç›‘æ§å’Œåƒåœ¾å›æ”¶ç­‰ä»»åŠ¡æ—¶å€™ä¼šå¯¼è‡´åˆ›å»ºMï¼ŒMç©ºé—²æ—¶ä¸ä¼šè¢«é”€æ¯ï¼Œè€Œæ˜¯æ”¾åˆ°ä¸€ä¸ªè°ƒåº¦å™¨çš„ç©ºé—²Måˆ—è¡¨ä¸­ï¼Œç­‰å¾…ä¸På…³è”ï¼ŒMé»˜è®¤æ•°é‡ä¸º10000 På’ŒMä¹‹é—´æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ï¼ŒPå’ŒGä¹‹é—´æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œä»–ä»¬çš„å…³è”æ˜¯æ˜“å˜çš„ï¼Œç”±Golangçš„è°ƒåº¦å™¨å®Œæˆè°ƒåº¦ï¼› Golangçš„è¿è¡Œæ—¶æŒ‰è§„åˆ™è°ƒåº¦ï¼Œè®©På’Œä¸åŒçš„Må»ºç«‹æˆ–æ–­å¼€å…³è”ï¼Œä½¿å¾—Pä¸­çš„Gèƒ½å¤ŸåŠæ—¶è·å¾—è¿è¡Œæ—¶æœº Pçš„æ•°é‡é»˜è®¤ä¸ºCPUæ€»æ ¸å¿ƒæ•°ï¼Œæœ€å¤§ä¸º256ï¼Œå½“Pæ²¡æœ‰å¯è¿è¡Œçš„Gæ—¶å€™ï¼ˆPçš„å¯è¿è¡ŒGé˜Ÿåˆ—ä¸ºç©ºï¼‰ï¼ŒPä¼šè¢«æ”¾åˆ°è°ƒåº¦å™¨çš„ç©ºé—²Påˆ—è¡¨ä¸­ï¼Œç­‰å¾…Mä¸å®ƒå…³è”ï¼› Pæœ‰å¯èƒ½ä¼šè¢«é”€æ¯ï¼Œå¦‚è¿è¡Œæ—¶ç”¨runtime.GOMAXPROCSæŠŠPçš„æ•°é‡ä»32é™åˆ°16æ—¶ï¼Œå‰©ä½™16ä¸ªä¼šè¢«é”€æ¯ï¼Œå®ƒä»¬åŸæ¥çš„Gä¼šå…ˆè½¬åˆ°è°ƒåº¦å™¨å¯è¿è¡Œçš„Gé˜Ÿåˆ—å’Œè‡ªç”±Gåˆ—è¡¨ æ¯ä¸ªPä¸­æœ‰å¯è¿è¡Œçš„Gé˜Ÿåˆ—ï¼ˆå¦‚å›¾ä¸­æœ€ä¸‹é¢çš„é‚£è¡ŒGï¼‰å’Œè‡ªç”±Gåˆ—è¡¨ï¼ˆå›¾ä¸­æœªç”»å‡ºæ¥ï¼‰ï¼Œå½“Gçš„ä»£ç æ‰§è¡Œå®Œåï¼Œè¯¥Gä¸ä¼šè¢«é”€æ¯ï¼Œè€Œæ˜¯è¢«æ”¾åˆ°Pçš„è‡ªç”±Gåˆ—è¡¨æˆ–è°ƒåº¦å™¨çš„è‡ªç”±Gåˆ—è¡¨ã€‚å¦‚æœç¨‹åºæ–°å»ºäº†Goåç¨‹ï¼Œè°ƒåº¦å™¨ä¼šåœ¨è‡ªç”±Gåˆ—è¡¨ä¸­å–ä¸€ä¸ªGï¼Œç„¶åæŠŠGoåç¨‹çš„å‡½æ•°èµ‹å€¼åˆ°Gä¸­ï¼ˆå¦‚æœè‡ªç”±Gåˆ—è¡¨ä¸ºç©ºï¼Œå°±åˆ›å»ºä¸€ä¸ªGï¼‰ï¼› å¯è§Golangè°ƒåº¦å™¨åœ¨è°ƒåº¦æ—¶å¾ˆå¤§ç¨‹åº¦å¤ç”¨äº†Mï¼ŒPï¼ŒG åœ¨Goç¨‹åºåˆå§‹åŒ–åï¼Œè°ƒåº¦å™¨é¦–å…ˆè¿›è¡Œä¸€è½®è°ƒåº¦ï¼Œæ­¤æ—¶ç”¨Må»æœç´¢å¯è¿è¡Œçš„Gã€‚å…¶ä¸­æˆ‘ä»¬çš„mainå‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªGï¼Œæ‰¾åˆ°å¯è¿è¡Œçš„Gåå°±æ‰§è¡Œå®ƒï¼› è‡³äºæ€ä¹ˆæ‰¾å¯è¿è¡Œçš„Gå‘¢ï¼Ÿç­”æ¡ˆæ˜¯åˆ°å¤„æ‰¾ï¼Œæƒ³å°½åŠæ³•æ‰¾ï¼ˆè¿™é‡Œåªåˆ—å‡ºä¸€éƒ¨åˆ†åœ°æ–¹ï¼‰ã€‚ ä»æœ¬åœ°Pçš„å¯è¿è¡Œçš„Gé˜Ÿåˆ—æ‰¾ ä»è°ƒåº¦å™¨çš„å¯è¿è¡Œçš„Gé˜Ÿåˆ—æ‰¾ ä»å…¶ä»–Pçš„å¯è¿è¡Œçš„Gé˜Ÿåˆ—æ‰¾ Pçš„å¯è¿è¡ŒGé˜Ÿåˆ—æœ€å¤§åªèƒ½å­˜æ”¾é•¿åº¦ä¸º256çš„Gï¼Œå½“é˜Ÿåˆ—æ»¡åï¼Œè°ƒåº¦å™¨ä¼šæŠŠä¸€åŠçš„Gè½¬åˆ°è°ƒåº¦å™¨çš„å¯è¿è¡ŒGé˜Ÿåˆ—ã€‚ ç³»ç»Ÿç›‘æ§ä¸Šé¢å¤§æ¦‚æè¿°äº†å…³äºgoroutineè°ƒåº¦çš„æµç¨‹ã€‚ç°åœ¨è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯å½“Goåç¨‹å¾ˆå¤šï¼ˆå¹¶å‘é‡å¤§ï¼‰æ—¶å€™ï¼Œæ˜¾ç„¶Gæ˜¯ä¸èƒ½ä¸€ç›´æ‰§è¡Œä¸‹å»çš„ï¼Œå› ä¸ºä¹Ÿéœ€è¦æŠŠæ‰§è¡Œæœºä¼šç•™ç»™å…¶ä»–çš„Gã€‚æ­¤æ—¶Golangè¿è¡Œæ—¶çš„ç³»ç»Ÿç›‘æ§å°±èµ·ä½œç”¨äº†ã€‚ä¸€èˆ¬æƒ…å†µï¼Œå½“Gè¿è¡Œæ—¶é—´è¶…è¿‡10msåï¼Œè¯¥Gå°±ä¼šè¢«ç³»ç»Ÿå‘ŠçŸ¥éœ€è¦åœæ­¢äº†ï¼Œè®©å…¶ä»–Gè¿è¡Œã€‚ï¼ˆè¿™é‡Œæƒ…å†µæ¯”è¾ƒå¤æ‚ï¼Œå¹¶ä¸èƒ½ç¡®ä¿æ¯ä¸ªGéƒ½èƒ½è¢«å…¬å¹³æ‰§è¡Œï¼‰ ä»¥ä¸‹ç‰¹æ®Šæƒ…å†µè¯¥Gä¸éœ€è¦åœæ­¢ Pçš„å¯è¿è¡ŒGé˜Ÿåˆ—ä¸ºç©ºï¼ˆæ²¡æœ‰å…¶ä»–Gå¯è¿è¡Œï¼‰ æœ‰ç©ºé—²çš„Måœ¨å¯»æ‰¾å¯è¿è¡Œçš„Gï¼ˆæ²¡æœ‰å…¶ä»–Gå¯è¿è¡Œï¼‰ ç©ºé—²çš„Pï¼ˆè¿˜æœ‰Pé—²ç€ï¼‰ æ€»ç»“Golangä»¥ä¸¤çº§çº¿ç¨‹å®ç°æ¨¡å‹ï¼Œè‡ªå·±å®ç°goruntineå’Œè°ƒåº¦å™¨ï¼Œä¼˜åŠ¿åœ¨äºå¹¶è¡Œå’Œéå¸¸ä½çš„èµ„æºä½¿ç”¨ã€‚ ä¸»è¦ä½“ç° å†…å­˜æ¶ˆè€—æ–¹é¢ï¼ˆæ¯ä¸ªGoåç¨‹å çš„å†…å­˜è¿œå°äºçº¿ç¨‹å çš„å†…å­˜ï¼‰ åˆ‡æ¢(è°ƒåº¦)å¼€é”€æ–¹é¢ çº¿ç¨‹åˆ‡æ¢æ¶‰åŠæ¨¡å¼åˆ‡æ¢(ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€) æ­¤å¤–ï¼ŒGoåç¨‹æ‰§è¡Œä»»åŠ¡å®Œæˆçš„é¡ºåºå¹¶ä¸éƒ½æ˜¯æŒ‰æˆ‘ä»¬é¢„æœŸçš„é‚£æ ·ï¼ˆç¨‹åºä¸åŠ ä»¥æ§åˆ¶çš„æƒ…å†µä¸‹ï¼‰ï¼Œç‰¹åˆ«åœ¨ä¸€äº›è€—æ—¶è¾ƒé•¿çš„ä»»åŠ¡ä¸­ã€‚ä¸”æ¯ä¸ªGoåç¨‹æ‰§è¡Œçš„æ—¶é—´ä¹Ÿä¸æ˜¯ç»å¯¹å…¬å¹³çš„ã€‚ çº¿ç¨‹å®ç°æ¨¡å‹çº¿ç¨‹å®ç°æ¨¡å‹ä¸»è¦åˆ†ä¸ºï¼šç”¨æˆ·çº§çº¿ç¨‹æ¨¡å‹ï¼Œå†…æ ¸çº§çº¿ç¨‹æ¨¡å‹å’Œä¸¤çº§çº¿ç¨‹æ¨¡å‹ã€‚ä»–ä»¬çš„åŒºåˆ«åœ¨äºçº¿ç¨‹ä¸å†…æ ¸çº¿ç¨‹ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚ ä»¥ä¸‹æˆ‘ä»¬å°†åˆ†æè¿™ä¸‰ç§çº¿ç¨‹å®ç°æ¨¡å‹çš„ç‰¹ç‚¹ï¼š ç”¨æˆ·çº§çº¿ç¨‹æ¨¡å‹ å¤šå¯¹ä¸€å…³ç³»ç”¨æˆ·çº§çº¿ç¨‹æ¨¡å‹ä¸ºå¤šå¯¹ä¸€å…³ç³»ã€‚å³ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­çš„æ‰€æœ‰çº¿ç¨‹å¯¹åº”ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ï¼› å¤„ç†é€Ÿåº¦å¿«ã€ç§»æ¤æ€§å¼ºï¼›çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦ã€åŒæ­¥ç­‰æ“ä½œç”±åº”ç”¨ç¨‹åºæ¥å¤„ç†ï¼Œä¸éœ€è¦è®©CPUä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ã€‚æ‰€ä»¥ç”¨æˆ·çº§çº¿ç¨‹æ¨¡å‹åœ¨é€Ÿåº¦å¿«ï¼Œä¸”ç§»æ¤æ€§å¼ºï¼› å¹¶éçœŸæ­£çš„å¹¶å‘è¿è¡Œå¦‚æœçº¿ç¨‹IOæ“ä½œè¿‡ç¨‹ä¸­è¢«é˜»å¡ï¼Œé‚£ä¹ˆç”¨æˆ·ç©ºé—´çš„å…¶ä»–çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ï¼Œå› ä¸ºè¿™äº›çº¿ç¨‹æ— æ³•è¢«å†…æ ¸è°ƒåº¦ã€‚ å†…æ ¸çº§çº¿ç¨‹æ¨¡å‹ï¼ˆ1ï¼‰ä¸€å¯¹ä¸€å…³ç³»å†…æ ¸çº§çº¿ç¨‹æ¨¡å‹ä¸ºä¸€å¯¹ä¸€å…³ç³»ï¼Œä¸€ä¸ªç”¨æˆ·çº¿ç¨‹å¯¹åº”ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ï¼›ï¼ˆ2ï¼‰èµ„æºæ¶ˆè€—è¾ƒå¤§ï¼Œé€Ÿåº¦è¾ƒæ…¢è¿›ç¨‹å¯¹çº¿ç¨‹çš„åˆ›å»ºã€ç»ˆæ­¢ã€åˆ‡æ¢å’ŒåŒæ­¥éƒ½å¿…é¡»é€šè¿‡å†…æ ¸æä¾›çš„ç³»ç»Ÿè°ƒç”¨æ¥å®Œæˆï¼Œå¯¹å†…æ ¸çš„è°ƒåº¦çš„è°ƒåº¦å™¨é€ æˆå¾ˆå¤§çš„è´Ÿæ‹…ï¼›ï¼ˆ3ï¼‰æ˜¯çœŸæ­£çš„å¹¶å‘è¿è¡Œç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œçº¿ç¨‹ç”±å†…æ ¸æ¥ç®¡ç†å’Œè°ƒåº¦ã€‚å½“æŸä¸€çº¿ç¨‹é˜»å¡æ—¶å€™ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çº¿ç¨‹ã€‚ ä¸¤çº§çº¿ç¨‹æ¨¡å‹ å¤šå¯¹å¤šçš„å…³ç³»ä¸¤çº§çº¿ç¨‹æ¨¡å‹æ˜¯é›†å‰é¢ä¸¤ç§æ¨¡å‹çš„ä¼˜ç‚¹è€Œè®¾è®¡çš„ï¼Œæ˜¯å¤šå¯¹å¤šçš„å…³ç³»ï¼› èµ„æºæ¶ˆè€—è¾ƒå°ï¼Œé€Ÿåº¦è¾ƒå¿«ï¼Œæ˜¯çœŸæ­£çš„å¹¶å‘è¿è¡Œä¸¤çº§çº¿ç¨‹æ¨¡å‹ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹å¯¹åº”å¤šä¸ªå†…æ ¸çº¿ç¨‹ï¼Œè¿›ç¨‹ä¸­çš„çº¿ç¨‹ç”±ç¨‹åºç®¡ç†å’Œè°ƒåº¦å¹¶é€šè¿‡æ˜ å°„å…³ç³»æ˜ å°„åˆ°å†…æ ¸çº¿ç¨‹ä¸Šã€‚è¿™æ ·å³ä¾¿æœ‰çº¿ç¨‹é˜»å¡åï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°å…¶ä»–çº¿ç¨‹ï¼› å®ç°çš„å¤æ‚åº¦å¤§ç”¨æˆ·çº¿ç¨‹ä¸å†…æ ¸çº¿ç¨‹çš„æ˜ å°„å…³ç³»éœ€è¦ç¨‹åºæ¥å®ç°ï¼Œå®ç°çš„å¤æ‚åº¦å¤§ã€‚å¹¸è¿çš„æ˜¯ï¼ŒGolangä¸ºæˆ‘ä»¬å®ç°äº†ä¸¤çº§çº¿ç¨‹æ¨¡å‹ï¼Œè¿™ä½¿å¾—å®ƒåœ¨å¤„ç†å¹¶å‘é—®é¢˜ä¸Šæ›´æœ‰ä¼˜åŠ¿ã€‚","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"Redisçš„è¿‡æœŸç­–ç•¥ä»¥åŠå†…å­˜æ·˜æ±°æœºåˆ¶","slug":"Redisçš„è¿‡æœŸç­–ç•¥ä»¥åŠå†…å­˜æ·˜æ±°æœºåˆ¶","date":"2021-03-14T13:46:51.000Z","updated":"2022-03-30T11:27:37.038Z","comments":true,"path":"2021/03/14/volatile/","link":"","permalink":"https://github.13sai.com/2021/03/14/volatile/","excerpt":"","text":"redisé‡‡ç”¨çš„æ˜¯å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤ç­–ç•¥ã€‚ ä¸ºä»€ä¹ˆä¸ç”¨å®šæ—¶åˆ é™¤ç­–ç•¥? å®šæ—¶åˆ é™¤,ç”¨ä¸€ä¸ªå®šæ—¶å™¨æ¥è´Ÿè´£ç›‘è§†key,è¿‡æœŸåˆ™è‡ªåŠ¨åˆ é™¤ã€‚è™½ç„¶å†…å­˜åŠæ—¶é‡Šæ”¾ï¼Œä½†æ˜¯ååˆ†æ¶ˆè€—CPUèµ„æºã€‚åœ¨å¤§å¹¶å‘è¯·æ±‚ä¸‹ï¼ŒCPUè¦å°†æ—¶é—´åº”ç”¨åœ¨å¤„ç†è¯·æ±‚ï¼Œè€Œä¸æ˜¯åˆ é™¤keyï¼Œå› æ­¤æ²¡æœ‰é‡‡ç”¨è¿™ä¸€ç­–ç•¥. å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢? å®šæœŸåˆ é™¤ï¼Œredisé»˜è®¤æ¯ä¸ª100msæ£€æŸ¥ï¼Œæ˜¯å¦æœ‰è¿‡æœŸçš„keyï¼Œæœ‰è¿‡æœŸkeyåˆ™åˆ é™¤ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œredisä¸æ˜¯æ¯ä¸ª100mså°†æ‰€æœ‰çš„keyæ£€æŸ¥ä¸€æ¬¡ï¼Œè€Œæ˜¯éšæœºæŠ½å–è¿›è¡Œæ£€æŸ¥(å¦‚æœæ¯éš”100ms,å…¨éƒ¨keyè¿›è¡Œæ£€æŸ¥ï¼Œrediså²‚ä¸æ˜¯å¡æ­»)ã€‚å› æ­¤ï¼Œå¦‚æœåªé‡‡ç”¨å®šæœŸåˆ é™¤ç­–ç•¥ï¼Œä¼šå¯¼è‡´å¾ˆå¤škeyåˆ°æ—¶é—´æ²¡æœ‰åˆ é™¤ã€‚ äºæ˜¯ï¼Œæƒ°æ€§åˆ é™¤æ´¾ä¸Šç”¨åœºã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ä½ è·å–æŸä¸ªkeyçš„æ—¶å€™ï¼Œredisä¼šæ£€æŸ¥ä¸€ä¸‹ï¼Œè¿™ä¸ªkeyå¦‚æœè®¾ç½®äº†è¿‡æœŸæ—¶é—´é‚£ä¹ˆæ˜¯å¦è¿‡æœŸäº†ï¼Ÿå¦‚æœè¿‡æœŸäº†æ­¤æ—¶å°±ä¼šåˆ é™¤ã€‚ é‡‡ç”¨å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤å°±æ²¡å…¶ä»–é—®é¢˜äº†ä¹ˆ? ä¸æ˜¯çš„ï¼Œå¦‚æœå®šæœŸåˆ é™¤æ²¡åˆ é™¤keyã€‚ç„¶åä½ ä¹Ÿæ²¡å³æ—¶å»è¯·æ±‚keyï¼Œä¹Ÿå°±æ˜¯è¯´æƒ°æ€§åˆ é™¤ä¹Ÿæ²¡ç”Ÿæ•ˆã€‚è¿™æ ·ï¼Œredisçš„å†…å­˜ä¼šè¶Šæ¥è¶Šé«˜ã€‚é‚£ä¹ˆå°±åº”è¯¥é‡‡ç”¨å†…å­˜æ·˜æ±°æœºåˆ¶ã€‚ åœ¨redis.confä¸­æœ‰ä¸€è¡Œé…ç½® maxmemory-policy volatile-lru è¯¥é…ç½®å°±æ˜¯é…å†…å­˜æ·˜æ±°ç­–ç•¥çš„ noevictionï¼šå½“å†…å­˜ä½¿ç”¨è¶…è¿‡é…ç½®çš„æ—¶å€™ä¼šè¿”å›é”™è¯¯ï¼Œä¸ä¼šé©±é€ä»»ä½•é”® allkeys-lruï¼šåŠ å…¥é”®çš„æ—¶å€™ï¼Œå¦‚æœè¿‡é™ï¼Œé¦–å…ˆé€šè¿‡LRUç®—æ³•é©±é€æœ€ä¹…æ²¡æœ‰ä½¿ç”¨çš„é”® volatile-lruï¼šåŠ å…¥é”®çš„æ—¶å€™å¦‚æœè¿‡é™ï¼Œé¦–å…ˆä»è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®é›†åˆä¸­é©±é€æœ€ä¹…æ²¡æœ‰ä½¿ç”¨çš„é”® allkeys-randomï¼šåŠ å…¥é”®çš„æ—¶å€™å¦‚æœè¿‡é™ï¼Œä»æ‰€æœ‰keyéšæœºåˆ é™¤ volatile-randomï¼šåŠ å…¥é”®çš„æ—¶å€™å¦‚æœè¿‡é™ï¼Œä»è¿‡æœŸé”®çš„é›†åˆä¸­éšæœºé©±é€ volatile-ttlï¼šä»é…ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ä¸­é©±é€é©¬ä¸Šå°±è¦è¿‡æœŸçš„é”® volatile-lfuï¼šä»æ‰€æœ‰é…ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ä¸­é©±é€ä½¿ç”¨é¢‘ç‡æœ€å°‘çš„é”® allkeys-lfuï¼šä»æ‰€æœ‰é”®ä¸­é©±é€ä½¿ç”¨é¢‘ç‡æœ€å°‘çš„é”® ä¸€èˆ¬çš„ç»éªŒè§„åˆ™: ä½¿ç”¨allkeys-lruç­–ç•¥ï¼šå½“é¢„æœŸè¯·æ±‚ç¬¦åˆä¸€ä¸ªå¹‚æ¬¡åˆ†å¸ƒ(äºŒå…«æ³•åˆ™ç­‰)ï¼Œæ¯”å¦‚ä¸€éƒ¨åˆ†çš„å­é›†å…ƒç´ æ¯”å…¶å®ƒå…¶å®ƒå…ƒç´ è¢«è®¿é—®çš„æ›´å¤šæ—¶ï¼Œå¯ä»¥é€‰æ‹©è¿™ä¸ªç­–ç•¥ã€‚ ä½¿ç”¨allkeys-randomï¼šå¾ªç¯è¿ç»­çš„è®¿é—®æ‰€æœ‰çš„é”®æ—¶ï¼Œæˆ–è€…é¢„æœŸè¯·æ±‚åˆ†å¸ƒå¹³å‡ï¼ˆæ‰€æœ‰å…ƒç´ è¢«è®¿é—®çš„æ¦‚ç‡éƒ½å·®ä¸å¤šï¼‰ ä½¿ç”¨volatile-ttlï¼šè¦é‡‡å–è¿™ä¸ªç­–ç•¥ï¼Œç¼“å­˜å¯¹è±¡çš„TTLå€¼æœ€å¥½æœ‰å·®å¼‚ volatile-lru å’Œ volatile-randomç­–ç•¥ï¼Œå½“ä½ æƒ³è¦ä½¿ç”¨å•ä¸€çš„Rediså®ä¾‹æ¥åŒæ—¶å®ç°ç¼“å­˜æ·˜æ±°å’ŒæŒä¹…åŒ–ä¸€äº›ç»å¸¸ä½¿ç”¨çš„é”®é›†åˆæ—¶å¾ˆæœ‰ç”¨ã€‚æœªè®¾ç½®è¿‡æœŸæ—¶é—´çš„é”®è¿›è¡ŒæŒä¹…åŒ–ä¿å­˜ï¼Œè®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®å‚ä¸ç¼“å­˜æ·˜æ±°ã€‚ä¸è¿‡ä¸€èˆ¬è¿è¡Œä¸¤ä¸ªå®ä¾‹æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„æ›´å¥½æ–¹æ³•ã€‚ ä¸ºé”®è®¾ç½®è¿‡æœŸæ—¶é—´ä¹Ÿæ˜¯éœ€è¦æ¶ˆè€—å†…å­˜çš„ï¼Œæ‰€ä»¥ä½¿ç”¨allkeys-lruè¿™ç§ç­–ç•¥æ›´åŠ èŠ‚çœç©ºé—´ï¼Œå› ä¸ºè¿™ç§ç­–ç•¥ä¸‹å¯ä»¥ä¸ä¸ºé”®è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚ LRURedisé…ç½®ä¸­å’ŒLRUæœ‰å…³çš„æœ‰ä¸‰ä¸ªï¼š maxmemory: é…ç½®Rediså­˜å‚¨æ•°æ®æ—¶æŒ‡å®šé™åˆ¶çš„å†…å­˜å¤§å°ï¼Œæ¯”å¦‚100mã€‚å½“ç¼“å­˜æ¶ˆè€—çš„å†…å­˜è¶…è¿‡è¿™ä¸ªæ•°å€¼æ—¶, å°†è§¦å‘æ•°æ®æ·˜æ±°ã€‚è¯¥æ•°æ®é…ç½®ä¸º0æ—¶ï¼Œè¡¨ç¤ºç¼“å­˜çš„æ•°æ®é‡æ²¡æœ‰é™åˆ¶, å³LRUåŠŸèƒ½ä¸ç”Ÿæ•ˆã€‚64ä½çš„ç³»ç»Ÿé»˜è®¤å€¼ä¸º0ï¼Œ32ä½çš„ç³»ç»Ÿé»˜è®¤å†…å­˜é™åˆ¶ä¸º3GB maxmemory_policy: è§¦å‘æ•°æ®æ·˜æ±°åçš„æ·˜æ±°ç­–ç•¥ maxmemory_samples: éšæœºé‡‡æ ·çš„ç²¾åº¦ï¼Œä¹Ÿå°±æ˜¯éšå³å–å‡ºkeyçš„æ•°ç›®ã€‚è¯¥æ•°å€¼é…ç½®è¶Šå¤§, è¶Šæ¥è¿‘äºçœŸå®çš„LRUç®—æ³•ï¼Œä½†æ˜¯æ•°å€¼è¶Šå¤§ï¼Œç›¸åº”æ¶ˆè€—ä¹Ÿå˜é«˜ï¼Œå¯¹æ€§èƒ½æœ‰ä¸€å®šå½±å“ï¼Œæ ·æœ¬å€¼é»˜è®¤ä¸º5ã€‚ æˆ‘ä»¬çŸ¥é“ï¼ŒLRUç®—æ³•éœ€è¦ä¸€ä¸ªåŒå‘é“¾è¡¨æ¥è®°å½•æ•°æ®çš„æœ€è¿‘è¢«è®¿é—®é¡ºåºï¼Œä½†æ˜¯å‡ºäºèŠ‚çœå†…å­˜çš„è€ƒè™‘ï¼ŒRedisçš„LRUç®—æ³•å¹¶éå®Œæ•´çš„å®ç°ã€‚Rediså¹¶ä¸ä¼šé€‰æ‹©æœ€ä¹…æœªè¢«è®¿é—®çš„é”®è¿›è¡Œå›æ”¶ï¼Œç›¸åå®ƒä¼šå°è¯•è¿è¡Œä¸€ä¸ªè¿‘ä¼¼LRUçš„ç®—æ³•ï¼Œé€šè¿‡å¯¹å°‘é‡é”®è¿›è¡Œå–æ ·ï¼Œç„¶åå›æ”¶å…¶ä¸­çš„æœ€ä¹…æœªè¢«è®¿é—®çš„é”®ã€‚é€šè¿‡è°ƒæ•´æ¯æ¬¡å›æ”¶æ—¶çš„é‡‡æ ·æ•°é‡maxmemory-samplesï¼Œå¯ä»¥å®ç°è°ƒæ•´ç®—æ³•çš„ç²¾åº¦ã€‚ æ ¹æ®Redisä½œè€…çš„è¯´æ³•ï¼Œæ¯ä¸ªRedis Objectå¯ä»¥æŒ¤å‡º24 bitsçš„ç©ºé—´ï¼Œä½†24 bitsæ˜¯ä¸å¤Ÿå­˜å‚¨ä¸¤ä¸ªæŒ‡é’ˆçš„ï¼Œè€Œå­˜å‚¨ä¸€ä¸ªä½ä½æ—¶é—´æˆ³æ˜¯è¶³å¤Ÿçš„ï¼ŒRedis Objectä»¥ç§’ä¸ºå•ä½å­˜å‚¨äº†å¯¹è±¡æ–°å»ºæˆ–è€…æ›´æ–°æ—¶çš„unix timeï¼Œä¹Ÿå°±æ˜¯LRU clockï¼Œ24 bitsæ•°æ®è¦æº¢å‡ºçš„è¯éœ€è¦194å¤©ï¼Œè€Œç¼“å­˜çš„æ•°æ®æ›´æ–°éå¸¸é¢‘ç¹ï¼Œå·²ç»è¶³å¤Ÿäº†ã€‚ Redisçš„é”®ç©ºé—´æ˜¯æ”¾åœ¨ä¸€ä¸ªå“ˆå¸Œè¡¨ä¸­çš„ï¼Œè¦ä»æ‰€æœ‰çš„é”®ä¸­é€‰å‡ºä¸€ä¸ªæœ€ä¹…æœªè¢«è®¿é—®çš„é”®ï¼Œéœ€è¦å¦å¤–ä¸€ä¸ªæ•°æ®ç»“æ„å­˜å‚¨è¿™äº›æºä¿¡æ¯ï¼Œè¿™æ˜¾ç„¶ä¸åˆ’ç®—ã€‚æœ€åˆï¼ŒRedisåªæ˜¯éšæœºçš„é€‰3ä¸ªkeyï¼Œç„¶åä»ä¸­æ·˜æ±°ï¼Œåæ¥ç®—æ³•æ”¹è¿›åˆ°äº†Nä¸ªkeyçš„ç­–ç•¥ï¼Œé»˜è®¤æ˜¯5ä¸ªã€‚ Redis3.0ä¹‹ååˆæ”¹å–„äº†ç®—æ³•çš„æ€§èƒ½ï¼Œä¼šæä¾›ä¸€ä¸ªå¾…æ·˜æ±°å€™é€‰keyçš„poolï¼Œé‡Œé¢é»˜è®¤æœ‰16ä¸ªkeyï¼ŒæŒ‰ç…§ç©ºé—²æ—¶é—´æ’å¥½åºã€‚æ›´æ–°æ—¶ä»Redisé”®ç©ºé—´éšæœºé€‰æ‹©Nä¸ªkeyï¼Œåˆ†åˆ«è®¡ç®—å®ƒä»¬çš„ç©ºé—²æ—¶é—´idleï¼Œkeyåªä¼šåœ¨poolä¸æ»¡æˆ–è€…ç©ºé—²æ—¶é—´å¤§äºpoolé‡Œæœ€å°çš„æ—¶ï¼Œæ‰ä¼šè¿›å…¥poolï¼Œç„¶åä»poolä¸­é€‰æ‹©ç©ºé—²æ—¶é—´æœ€å¤§çš„keyæ·˜æ±°æ‰ã€‚ çœŸå®LRUç®—æ³•ä¸è¿‘ä¼¼LRUçš„ç®—æ³•å¯ä»¥é€šè¿‡ä¸‹é¢çš„å›¾åƒå¯¹æ¯”ï¼š æµ…ç°è‰²å¸¦æ˜¯å·²ç»è¢«æ·˜æ±°çš„å¯¹è±¡ï¼Œç°è‰²å¸¦æ˜¯æ²¡æœ‰è¢«æ·˜æ±°çš„å¯¹è±¡ï¼Œç»¿è‰²å¸¦æ˜¯æ–°æ·»åŠ çš„å¯¹è±¡ã€‚å¯ä»¥çœ‹å‡ºï¼Œmaxmemory-sampleså€¼ä¸º5æ—¶Redis 3.0æ•ˆæœæ¯”Redis 2.8è¦å¥½ã€‚ä½¿ç”¨10ä¸ªé‡‡æ ·å¤§å°çš„Redis 3.0çš„è¿‘ä¼¼LRUç®—æ³•å·²ç»éå¸¸æ¥è¿‘ç†è®ºçš„æ€§èƒ½äº†ã€‚ æ•°æ®è®¿é—®æ¨¡å¼éå¸¸æ¥è¿‘å¹‚æ¬¡åˆ†å¸ƒæ—¶ï¼Œä¹Ÿå°±æ˜¯å¤§éƒ¨åˆ†çš„è®¿é—®é›†ä¸­äºéƒ¨åˆ†é”®æ—¶ï¼ŒLRUè¿‘ä¼¼ç®—æ³•ä¼šå¤„ç†å¾—å¾ˆå¥½ã€‚ Redisä¸ºä»€ä¹ˆä¸ä½¿ç”¨åŸç”ŸLRUç®—æ³•ï¼Ÿ åŸç”ŸLRUç®—æ³•éœ€è¦ åŒå‘é“¾è¡¨ æ¥ç®¡ç†æ•°æ®ï¼Œéœ€è¦é¢å¤–å†…å­˜ æ•°æ®è®¿é—®æ—¶æ¶‰åŠæ•°æ®ç§»åŠ¨ï¼Œæœ‰æ€§èƒ½æŸè€— Redisç°æœ‰æ•°æ®ç»“æ„éœ€è¦æ”¹é€  LFUåœ¨LFUç®—æ³•ä¸­ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªkeyç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ã€‚æ¯æ¬¡keyè¢«è®¿é—®çš„æ—¶å€™ï¼Œè®¡æ•°å™¨å¢å¤§ã€‚è®¡æ•°å™¨è¶Šå¤§ï¼Œå¯ä»¥çº¦ç­‰äºè®¿é—®è¶Šé¢‘ç¹ã€‚ ä¸Šè¿°ç®€å•ç®—æ³•å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š åœ¨LRUç®—æ³•ä¸­å¯ä»¥ç»´æŠ¤ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œç„¶åç®€å•çš„æŠŠè¢«è®¿é—®çš„èŠ‚ç‚¹ç§»è‡³é“¾è¡¨å¼€å¤´ï¼Œä½†åœ¨LFUä¸­æ˜¯ä¸å¯è¡Œçš„ï¼ŒèŠ‚ç‚¹è¦ä¸¥æ ¼æŒ‰ç…§è®¡æ•°å™¨è¿›è¡Œæ’åºï¼Œæ–°å¢èŠ‚ç‚¹æˆ–è€…æ›´æ–°èŠ‚ç‚¹ä½ç½®æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦å¯èƒ½è¾¾åˆ°O(N)ã€‚ åªæ˜¯ç®€å•çš„å¢åŠ è®¡æ•°å™¨çš„æ–¹æ³•å¹¶ä¸å®Œç¾ã€‚è®¿é—®æ¨¡å¼æ˜¯ä¼šé¢‘ç¹å˜åŒ–çš„ï¼Œä¸€æ®µæ—¶é—´å†…é¢‘ç¹è®¿é—®çš„keyä¸€æ®µæ—¶é—´ä¹‹åå¯èƒ½ä¼šå¾ˆå°‘è¢«è®¿é—®åˆ°ï¼Œåªå¢åŠ è®¡æ•°å™¨å¹¶ä¸èƒ½ä½“ç°è¿™ç§è¶‹åŠ¿ã€‚ ç¬¬ä¸€ä¸ªé—®é¢˜å¾ˆå¥½è§£å†³ï¼Œå¯ä»¥å€Ÿé‰´LRUå®ç°çš„ç»éªŒï¼Œç»´æŠ¤ä¸€ä¸ªå¾…æ·˜æ±°keyçš„poolã€‚ç¬¬äºŒä¸ªé—®é¢˜çš„è§£å†³åŠæ³•æ˜¯ï¼Œè®°å½•keyæœ€åä¸€ä¸ªè¢«è®¿é—®çš„æ—¶é—´ï¼Œç„¶åéšç€æ—¶é—´æ¨ç§»ï¼Œé™ä½è®¡æ•°å™¨ã€‚ Rediså¯¹è±¡çš„ç»“æ„å¦‚ä¸‹ï¼š typedef struct redisObject &#123; unsigned type:4; unsigned encoding:4; unsigned lru:LRU_BITS; /* LRU time (relative to global lru_clock) or * LFU data (least significant 8 bits frequency * and most significant 16 bits access time). */ int refcount; void *ptr; &#125; robj; åœ¨LRUç®—æ³•ä¸­ï¼Œ24 bitsçš„lruæ˜¯ç”¨æ¥è®°å½•LRU timeçš„ï¼Œåœ¨LFUä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªå­—æ®µï¼Œä¸è¿‡æ˜¯åˆ†æˆ16 bitsä¸8 bitsä½¿ç”¨ï¼š 16 bits 8 bits +----------------+--------+ + Last decr time | LOG_C | +----------------+--------+ é«˜16 bitsç”¨æ¥è®°å½•æœ€è¿‘ä¸€æ¬¡è®¡æ•°å™¨é™ä½çš„æ—¶é—´ldtï¼Œå•ä½æ˜¯åˆ†é’Ÿï¼Œä½8 bitsè®°å½•è®¡æ•°å™¨æ•°å€¼counterã€‚ LFUé…ç½®Redis4.0ä¹‹åä¸ºmaxmemory_policyæ·˜æ±°ç­–ç•¥æ·»åŠ äº†ä¸¤ä¸ªLFUæ¨¡å¼ï¼š volatile-lfuï¼šå¯¹æœ‰è¿‡æœŸæ—¶é—´çš„keyé‡‡ç”¨LFUæ·˜æ±°ç®—æ³• allkeys-lfuï¼šå¯¹å…¨éƒ¨keyé‡‡ç”¨LFUæ·˜æ±°ç®—æ³• è¿˜æœ‰2ä¸ªé…ç½®å¯ä»¥è°ƒæ•´LFUç®—æ³•ï¼š lfu-log-factor 10 lfu-decay-time 1 lfu-log-factorå¯ä»¥è°ƒæ•´è®¡æ•°å™¨counterçš„å¢é•¿é€Ÿåº¦ï¼Œlfu-log-factorè¶Šå¤§ï¼Œcounterå¢é•¿çš„è¶Šæ…¢ã€‚ lfu-decay-timeæ˜¯ä¸€ä¸ªä»¥åˆ†é’Ÿä¸ºå•ä½çš„æ•°å€¼ï¼Œå¯ä»¥è°ƒæ•´counterçš„å‡å°‘é€Ÿåº¦ å‚è€ƒï¼š Redisä¸­çš„LRUæ·˜æ±°ç­–ç•¥åˆ†æ Redisä¸­çš„LFUç®—æ³• ç©è½¬Redis-8ç§æ•°æ®æ·˜æ±°ç­–ç•¥åŠè¿‘ä¼¼LRUã€LFUåŸç†","categories":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/categories/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/tags/Redis/"}]},{"title":"k8sçš„å®‰è£…ï¼ˆMacï¼‰","slug":"k8sçš„å®‰è£…ï¼ˆMacï¼‰","date":"2021-03-13T07:37:06.000Z","updated":"2022-07-05T08:52:39.973Z","comments":true,"path":"2021/03/13/320/","link":"","permalink":"https://github.13sai.com/2021/03/13/320/","excerpt":"","text":"å°è±¡ä¸­ä¹‹å‰macè£…k8sæŒºéº»çƒ¦ï¼Œä¹‹å‰è£…çš„ç‰ˆæœ¬è¾ƒä½v1.14.7ã€‚æœ€è¿‘æ€»æç¤ºæˆ‘æ›´æ–°ï¼Œåˆšå¥½æ›´æ–°ä¸€ä¸‹ï¼Œé¡ºä¾¿è®°å½•ä¸‹è¿‡ç¨‹ã€‚ ä¸‹è½½ ä¸‹è½½å®‰è£…[docker-desktop]https://www.docker.com/products/docker-desktop ä¿®æ”¹Docker Engineé…ç½®ï¼Œä¿®æ”¹é•œåƒæº&#123; &quot;registry-mirrors&quot;: [ &quot;https://docker.mirrors.ustc.edu.cn&quot;, &quot;https://hub-mirror.c.163.com&quot;, &quot;http://f1361db2.m.daocloud.io&quot; ], &quot;experimental&quot;: false, &quot;features&quot;: &#123; &quot;buildkit&quot;: true &#125; &#125; å®‰è£…k8s.gcr.ioç­‰ç»„ä»¶git clone https://github.com/AliyunContainerService/k8s-for-docker-desktop.git //åˆ‡æ¢åˆ°ä½ çš„k8sç‰ˆæœ¬ï¼Œæˆ‘çš„æ˜¯v1.19.7 git checkout v1.19.7 æ‰§è¡Œ ./load_images.sh å®‰è£…k8sä¾èµ–ã€‚4. Enable Kubernetesï¼Œé‡å¯ï¼ŒKuberneteså¯åŠ¨æ¯”Dockeræ…¢å¤šäº†ï¼Œç¨å¾®ç­‰ä¸€ä¼šå°±å¥½ã€‚ å®‰è£…kubernetes/dashboardé¡¹ç›®åœ°å€ï¼šhttps://github.com/kubernetes/dashboard kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.2.0/aio/deploy/recommended.yaml å¦‚æœæ‰§è¡Œè¶…æ—¶ï¼Œå¯ä»¥æŠŠyamlæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°è¿è¡Œã€‚ kubectl get pod --namespace=kubernetes-dashboard output: NAME READY STATUS RESTARTS AGE dashboard-metrics-scraper-79c5968bdc-xvrzd 1/1 Running 0 4m13s kubernetes-dashboard-9f9799597-9kmbk 1/1 Running 0 4m13s å¯ä»¥çœ‹åˆ°æˆåŠŸå®‰è£…ubernetes-dashboardã€‚ å¯åŠ¨kubectl proxy ç™»å½•æ‰“å¼€æµè§ˆå™¨ï¼šhttp://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/login é€‰æ‹©Tokenç™»å½•ï¼Œç”¨ä¸‹æ–¹å‘½ä»¤è·å–tokenï¼Œç™»å½•æˆåŠŸï¼Œå¯ä»¥çœ‹åˆ°ç•Œé¢ã€‚ è·å–tokenkubectl -n kube-system describe $(kubectl -n kube-system get secret -n kube-system -o name | grep namespace) | grep token","categories":[{"name":"devops","slug":"devops","permalink":"https://github.13sai.com/categories/devops/"}],"tags":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/tags/k8s/"}]},{"title":"RedisåŸºç¡€ç±»å‹ã€å¸¸ç”¨çŸ¥è¯†","slug":"base","date":"2021-03-08T13:46:51.000Z","updated":"2022-03-30T11:25:54.009Z","comments":true,"path":"2021/03/08/base/","link":"","permalink":"https://github.13sai.com/2021/03/08/base/","excerpt":"","text":"ä¸»è¦ç±»å‹ å­—ç¬¦ä¸²ï¼ˆstringsï¼Œbitmapsï¼‰ æ•£åˆ—ï¼ˆhashesï¼‰ åˆ—è¡¨ï¼ˆlistsï¼‰ é›†åˆï¼ˆsetsï¼‰ æœ‰åºé›†åˆï¼ˆsorted setsï¼‰ hyperloglogs å‘å¸ƒè®¢é˜…ï¼ˆpub/subï¼‰ åœ°ç†ç©ºé—´ï¼ˆgeospatialï¼‰ Streamï¼ˆ5.0ç‰ˆæœ¬æ–°å¢ï¼‰ å…³äºå‘½ä»¤æˆ‘æ¨èçœ‹è¿™ä¸¤ä¸ªï¼š http://doc.redisfans.com/ http://www.redis.cn/commands.html åº”ç”¨åœºæ™¯strings ç¼“å­˜ åˆ†å¸ƒå¼é”ï¼ˆsetnxï¼‰ ç­¾åˆ°ç»Ÿè®¡ï¼ˆsetbitï¼‰ è®¡æ•°ï¼ˆincrï¼‰ hashes ç¼“å­˜ ç”¨æˆ·æ ‡ç­¾ lists é˜Ÿåˆ— sets äº¤é›†å¹¶é›† æ•°æ®å»é‡ zset æ’è¡Œæ¦œ å»¶æ—¶ä»»åŠ¡ é™æµ hyperloglogs uvç»Ÿè®¡ï¼ˆipç»Ÿè®¡ï¼‰ pub/sub å‘å¸ƒè®¢é˜…ï¼ˆä¸æ˜¯ç‰¹åˆ«å¯é ï¼‰ geospatial é™„è¿‘çš„äºº Stream é˜Ÿåˆ— å‘å¸ƒè®¢é˜… å…¶ä»–åˆ©ç”¨äº‹åŠ¡å®ç°ç§’æ€ä»¥phpä»£ç ä¸ºä¾‹ï¼š WATCHå‘½ä»¤å¯ä»¥ç›‘æ§ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œä¸€æ—¦å…¶ä¸­æœ‰ä¸€ä¸ªé”®è¢«ä¿®æ”¹ï¼ˆæˆ–åˆ é™¤ï¼‰ï¼Œä¹‹åçš„äº‹åŠ¡å°±ä¸ä¼šæ‰§è¡Œã€‚ç›‘æ§ä¸€ç›´æŒç»­åˆ°EXECå‘½ä»¤ï¼ˆäº‹åŠ¡ä¸­çš„å‘½ä»¤æ˜¯åœ¨EXECä¹‹åæ‰æ‰§è¡Œçš„ï¼Œæ‰€ä»¥åœ¨MULTIå‘½ä»¤åå¯ä»¥ä¿®æ”¹WATCHç›‘æ§çš„é”®å€¼ï¼‰ // åº“å­˜ä¸º5 //å®ä¾‹åŒ–redis $redis = new Redis(); //è¿æ¥ $redis-&gt;connect(&#x27;127.0.0.1&#x27;, 6379); $key = &#x27;sale&#x27;; $redis-&gt;setnx($key, 0); // æ­¤é¡¹ä¸é¢„å®šä¹‰äº¦å¯ï¼Œä¿è¯keyå”¯ä¸€å°±è¡Œ $redis-&gt;watch($key); //ç›‘è§†ä¸€ä¸ª(æˆ–å¤šä¸ª) key ï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¿™ä¸ª(æˆ–è¿™äº›) key è¢«å…¶ä»–å‘½ä»¤æ‰€æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«æ‰“æ–­ã€‚ $sale_num = $redis-&gt;get($key); if ($sale_num &gt; 4) &#123; exit(); &#125; $redis-&gt;multi(); //æ ‡è®°äº‹åŠ¡ $redis-&gt;incr($key); //é”€é‡+1 sleep(1); //æ¨¡æ‹ŸçœŸå®ç¯å¢ƒ $ret = $redis-&gt;exec(); // äº‹åŠ¡å—å†…æ‰€æœ‰å‘½ä»¤çš„è¿”å›å€¼ï¼ŒæŒ‰å‘½ä»¤æ‰§è¡Œçš„å…ˆåé¡ºåºæ’åˆ—ã€‚ if ($ret) &#123; // è‡ªå®šä¹‰çš„ä¸€ä¸ªåŸºäºmedooçš„dbclass include &#x27;db.php&#x27;; $db = new db([ &#x27;database_type&#x27; =&gt; &#x27;mysql&#x27;, &#x27;database_name&#x27; =&gt; &#x27;test&#x27;, &#x27;server&#x27; =&gt; &#x27;13sai&#x27;, &#x27;username&#x27; =&gt; &#x27;13sai&#x27;, &#x27;password&#x27; =&gt; &#x27;*&#x27;, &#x27;charset&#x27; =&gt; &#x27;utf8&#x27; ]); $db-&gt;update(&#x27;goods&#x27;, [&quot;stock_num[-]&quot; =&gt; 1], [&#x27;id&#x27; =&gt; 1]); &#125; å¸ƒéš†è¿‡æ»¤å™¨ å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰æ˜¯1970å¹´ç”±å¸ƒéš†æå‡ºçš„ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡å’Œä¸€ç³»åˆ—éšæœºæ˜ å°„å‡½æ•°ã€‚å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚ phpå®ç°æ¨èçœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š https://github.13sai.com/2019/05/21/188/ å½“ç„¶ï¼ŒRedisè‡ªå·±ä¹Ÿæœ‰ç¬¬ä¸‰æ–¹æ¨¡å—ï¼š https://github.com/RedisBloom/RedisBloom git clone https://github.com/RedisBloom/RedisBloom.git cd redisbloom make /path/to/redis-server --loadmodule ./redisbloom.so Bloomï¼šå‘è¿‡æ»¤å™¨æ·»åŠ æ–°é¡¹,å¦‚æœå°šä¸å­˜åœ¨ï¼Œåˆ™ä¼šä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªæ–°çš„è¿‡æ»¤å™¨ 127.0.0.1:6379&gt; BF.ADD newFilter foo (integer) 1 Bloomï¼šæ£€æŸ¥è¿‡æ»¤å™¨ä¸­æ˜¯å¦å­˜åœ¨é¡¹ 127.0.0.1:6379&gt; BF.EXISTS newFilter foo (integer) 1 127.0.0.1:6379&gt; BF.EXISTS newFilter notpresent (integer) 0 é™æµRedis-cell// æå‰å®‰è£…rustå“Ÿ git clone https://github.com/brandur/redis-cell.git cd redis-cell cargo build --release cp target/release/libredis_cell.dylib /path/to/modules/ redis-server --loadmodule /path/to/modules/libredis_cell.so è¯¥æ¨¡å—åªæœ‰1æ¡æŒ‡ä»¤cl.throttleï¼Œå®ƒçš„å‚æ•°å’Œè¿”å›å€¼éƒ½ç•¥æ˜¾å¤æ‚ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæŒ‡ä»¤å…·ä½“è¯¥å¦‚ä½•ä½¿ç”¨ã€‚ &gt; cl.throttle limitThrot 15 30 60 1 â–² â–² â–² â–² â–² | | | | â””â”€â”€â”€â”€â”€ need 1 quota (å¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼ä¹Ÿæ˜¯1) | | â””â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€ 30 operations / 60 seconds è¿™æ˜¯æ¼æ°´é€Ÿç‡ | â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 15 capacity è¿™æ˜¯æ¼æ–—å®¹é‡ &gt; â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ key ä¸Šé¢è¿™ä¸ªæŒ‡ä»¤çš„æ„æ€æ˜¯å…è®¸é¢‘ç‡ä¸ºæ¯ 60s æœ€å¤š 30 æ¬¡(æ¼æ°´é€Ÿç‡)ï¼Œæ¼æ–—çš„åˆå§‹å®¹é‡ä¸º 15ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€å¼€å§‹å¯ä»¥å– 15 ä¸ªï¼Œç„¶åæ‰å¼€å§‹å—æ¼æ°´é€Ÿç‡çš„å½±å“ã€‚æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªæŒ‡ä»¤ä¸­æ¼æ°´é€Ÿç‡å˜æˆäº† 2 ä¸ªå‚æ•°ï¼Œæ›¿ä»£äº†ä¹‹å‰çš„å•ä¸ªæµ®ç‚¹æ•°ã€‚ç”¨ä¸¤ä¸ªå‚æ•°ç›¸é™¤çš„ç»“æœæ¥è¡¨è¾¾æ¼æ°´é€Ÿç‡ç›¸å¯¹å•ä¸ªæµ®ç‚¹æ•°è¦æ›´åŠ ç›´è§‚ä¸€äº›ã€‚ &gt; cl.throttle limitThrot 15 30 60 1 1) (integer) 0 # 0 è¡¨ç¤ºå…è®¸ï¼Œ1è¡¨ç¤ºæ‹’ç» 2) (integer) 15 # æ¼æ–—å®¹é‡capacity 3) (integer) 14 # æ¼æ–—å‰©ä½™ç©ºé—´left_quota 4) (integer) -1 # å¦‚æœæ‹’ç»äº†ï¼Œéœ€è¦å¤šé•¿æ—¶é—´åå†è¯•(æ¼æ–—æœ‰ç©ºé—´äº†ï¼Œå•ä½ç§’) 5) (integer) 2 # å¤šé•¿æ—¶é—´åï¼Œæ¼æ–—å®Œå…¨ç©ºå‡ºæ¥(left_quota==capacityï¼Œå•ä½ç§’)","categories":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/categories/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/tags/Redis/"}]},{"title":"Redisä½¿ç”¨å•çº¿ç¨‹ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«","slug":"Redisä½¿ç”¨å•çº¿ç¨‹ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«","date":"2021-02-28T13:46:51.000Z","updated":"2022-03-30T11:28:29.308Z","comments":true,"path":"2021/02/28/quick/","link":"","permalink":"https://github.13sai.com/2021/02/28/quick/","excerpt":"","text":"Redis6.0å¼•å…¥äº†å¤šçº¿ç¨‹ã€‚å®é™…ä¸Šå¤šçº¿ç¨‹åªæ˜¯ç”¨æ¥å¤„ç†ç½‘ç»œæ•°æ®çš„è¯»å†™å’Œåè®®è§£æï¼Œæ‰§è¡Œå‘½ä»¤ä»ç„¶æ˜¯å•ä¸€å·¥ä½œçº¿ç¨‹ã€‚ Redis é‡‡ç”¨çš„æ˜¯åŸºäºå†…å­˜çš„é‡‡ç”¨çš„æ˜¯å•è¿›ç¨‹å•çº¿ç¨‹æ¨¡å‹çš„ KV æ•°æ®åº“ï¼Œç”± C è¯­è¨€ç¼–å†™ã€‚å®˜æ–¹æä¾›çš„æ•°æ®æ˜¯å¯ä»¥è¾¾åˆ°100k+çš„qpsã€‚è¿™ä¸ªæ•°æ®ä¸æ¯”é‡‡ç”¨å•è¿›ç¨‹å¤šçº¿ç¨‹çš„åŒæ ·åŸºäºå†…å­˜çš„ KV æ•°æ®åº“ Memcached å·®ã€‚ Redis å¿«çš„ä¸»è¦åŸå› æœ‰ï¼š å®Œå…¨åŸºäºå†…å­˜ æ•°æ®ç»“æ„ç®€å•ï¼Œå¯¹æ•°æ®æ“ä½œä¹Ÿç®€å• ä½¿ç”¨å¤šè·¯ I/O å¤ç”¨æ¨¡å‹,éé˜»å¡IO é‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶ï¼Œä¹Ÿä¸å­˜åœ¨å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹å¯¼è‡´çš„åˆ‡æ¢è€Œæ¶ˆè€—CPUï¼Œä¸ç”¨å»è€ƒè™‘å„ç§é”çš„é—®é¢˜ï¼Œä¸å­˜åœ¨åŠ é”é‡Šæ”¾é”æ“ä½œï¼Œæ²¡æœ‰å› ä¸ºå¯èƒ½å‡ºç°æ­»é”è€Œå¯¼è‡´çš„æ€§èƒ½æ¶ˆè€— ä½¿ç”¨åº•å±‚æ¨¡å‹ä¸åŒï¼Œå®ƒä»¬ä¹‹é—´åº•å±‚å®ç°æ–¹å¼ä»¥åŠä¸å®¢æˆ·ç«¯ä¹‹é—´é€šä¿¡çš„åº”ç”¨åè®®ä¸ä¸€æ ·ï¼ŒRedisç›´æ¥è‡ªå·±æ„å»ºäº†VMæœºåˆ¶ï¼Œå› ä¸ºä¸€èˆ¬çš„ç³»ç»Ÿè°ƒç”¨ç³»ç»Ÿå‡½æ•°çš„è¯ï¼Œä¼šæµªè´¹ä¸€å®šçš„æ—¶é—´å»ç§»åŠ¨å’Œè¯·æ±‚ å¤šè·¯ I/O å¤ç”¨æ¨¡å‹å¤šè·¯ I/O å¤ç”¨æ¨¡å‹æ˜¯åˆ©ç”¨ selectã€pollã€epoll å¯ä»¥åŒæ—¶ç›‘å¯Ÿå¤šä¸ªæµçš„ I/O äº‹ä»¶çš„èƒ½åŠ›ï¼Œåœ¨ç©ºé—²çš„æ—¶å€™ï¼Œä¼šæŠŠå½“å‰çº¿ç¨‹é˜»å¡æ‰ï¼Œå½“æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæµæœ‰ I/O äº‹ä»¶æ—¶ï¼Œå°±ä»é˜»å¡æ€ä¸­å”¤é†’ï¼Œäºæ˜¯ç¨‹åºå°±ä¼šè½®è¯¢ä¸€éæ‰€æœ‰çš„æµï¼ˆepoll æ˜¯åªè½®è¯¢é‚£äº›çœŸæ­£å‘å‡ºäº†äº‹ä»¶çš„æµï¼‰ï¼Œå¹¶ä¸”åªä¾æ¬¡é¡ºåºçš„å¤„ç†å°±ç»ªçš„æµï¼Œè¿™ç§åšæ³•å°±é¿å…äº†å¤§é‡çš„æ— ç”¨æ“ä½œã€‚è¿™é‡Œâ€œå¤šè·¯â€æŒ‡çš„æ˜¯å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œâ€œå¤ç”¨â€æŒ‡çš„æ˜¯å¤ç”¨åŒä¸€ä¸ªçº¿ç¨‹ã€‚é‡‡ç”¨å¤šè·¯ I/O å¤ç”¨æŠ€æœ¯å¯ä»¥è®©å•ä¸ªçº¿ç¨‹é«˜æ•ˆçš„å¤„ç†å¤šä¸ªè¿æ¥è¯·æ±‚ï¼ˆå°½é‡å‡å°‘ç½‘ç»œ IO çš„æ—¶é—´æ¶ˆè€—ï¼‰ï¼Œä¸” Redis åœ¨å†…å­˜ä¸­æ“ä½œæ•°æ®çš„é€Ÿåº¦éå¸¸å¿«ï¼ˆå†…å­˜å†…çš„æ“ä½œä¸ä¼šæˆä¸ºè¿™é‡Œçš„æ€§èƒ½ç“¶é¢ˆï¼‰ï¼Œä¸»è¦ä»¥ä¸Šä¸¤ç‚¹é€ å°±äº† Redis å…·æœ‰å¾ˆé«˜çš„ååé‡ã€‚ å’Œ Memcached ä¸åŒï¼ŒRedis å¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨ Libeventï¼Œè€Œæ˜¯è‡ªå·±å®Œæˆäº†ä¸€ä¸ªéå¸¸è½»é‡çº§çš„å¯¹ selectã€epollã€evportã€kqueue è¿™äº›é€šç”¨çš„æ¥å£çš„å®ç°ã€‚åœ¨ä¸åŒçš„ç³»ç»Ÿè°ƒç”¨é€‰ç”¨é€‚åˆçš„æ¥å£ï¼Œlinux ä¸‹é»˜è®¤æ˜¯ epollã€‚å› ä¸º Libevent æ¯”è¾ƒé‡ï¼Œæ›´é€šç”¨ï¼Œä»£ç é‡ä¹Ÿå°±å¾ˆåºå¤§ï¼Œæ‹¥æœ‰å¾ˆå¤š Redis ç”¨ä¸ä¸Šçš„åŠŸèƒ½ï¼ŒRedis ä¸ºäº†è¿½æ±‚â€œè½»å·§â€å¹¶ä¸”å»é™¤ä¾èµ–ï¼Œå°±é€‰æ‹©è‡ªå·±å»å°è£…äº†ä¸€å¥—ã€‚ å•è¿›ç¨‹å•çº¿ç¨‹å¥½å¤„ ä»£ç æ›´æ¸…æ™°ï¼Œå¤„ç†é€»è¾‘æ›´ç®€å• ä¸ç”¨å»è€ƒè™‘å„ç§é”çš„é—®é¢˜ï¼Œä¸å­˜åœ¨åŠ é”é‡Šæ”¾é”æ“ä½œï¼Œæ²¡æœ‰å› ä¸ºå¯èƒ½å‡ºç°æ­»é”è€Œå¯¼è‡´çš„æ€§èƒ½æ¶ˆè€— ä¸å­˜åœ¨å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹å¯¼è‡´çš„åˆ‡æ¢è€Œæ¶ˆè€— CPU","categories":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/categories/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/tags/Redis/"}]},{"title":"goçš„GCæœºåˆ¶","slug":"goçš„GCæœºåˆ¶","date":"2021-02-27T13:03:12.000Z","updated":"2022-07-05T08:48:28.103Z","comments":true,"path":"2021/02/27/319/","link":"","permalink":"https://github.13sai.com/2021/02/27/319/","excerpt":"","text":"Golangçš„æ ‡è®°æ¸…é™¤å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€šè¿‡gcmarkBitsä½å›¾æ ‡è®°spançš„å—æ˜¯å¦è¢«å¼•ç”¨ã€‚å¯¹åº”å†…å­˜åˆ†é…ä¸­çš„bitmapåŒºã€‚ ä¸‰è‰²æ ‡è®° ç™½è‰²ï¼šå¯¹è±¡æœªè¢«æ ‡è®°ï¼ŒgcmarkBitså¯¹åº”çš„ä½ä¸º0ï¼ˆè¯¥å¯¹è±¡å°†ä¼šåœ¨æœ¬æ¬¡GCä¸­è¢«æ¸…ç†ï¼‰ ç°è‰²ï¼šå¯¹è±¡å·²è¢«æ ‡è®°ï¼Œä½†è¿™ä¸ªå¯¹è±¡åŒ…å«çš„å­å¯¹è±¡æœªæ ‡è®° é»‘è‰²ï¼šå¯¹è±¡å·²è¢«æ ‡è®°ï¼Œä¸”è¿™ä¸ªå¯¹è±¡åŒ…å«çš„å­å¯¹è±¡ä¹Ÿå·²æ ‡è®°ï¼ŒgcmarkBitså¯¹åº”çš„ä½ä¸º1ï¼ˆè¯¥å¯¹è±¡ä¸ä¼šåœ¨æœ¬æ¬¡GCä¸­è¢«æ¸…ç†ï¼‰ ä¾‹å¦‚ï¼Œå½“å‰å†…å­˜ä¸­æœ‰A~Fä¸€å…±6ä¸ªå¯¹è±¡ï¼Œæ ¹å¯¹è±¡a,bæœ¬èº«ä¸ºæ ˆä¸Šåˆ†é…çš„å±€éƒ¨å˜é‡ï¼Œæ ¹å¯¹è±¡aã€båˆ†åˆ«å¼•ç”¨äº†å¯¹è±¡Aã€B, è€ŒBå¯¹è±¡åˆå¼•ç”¨äº†å¯¹è±¡Dï¼Œåˆ™GCå¼€å§‹å‰å„å¯¹è±¡çš„çŠ¶æ€å¦‚ä¸‹å›¾æ‰€ç¤º: åˆå§‹çŠ¶æ€ä¸‹æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ç™½è‰²çš„ã€‚ æ¥ç€å¼€å§‹æ‰«ææ ¹å¯¹è±¡aã€b; ç”±äºæ ¹å¯¹è±¡å¼•ç”¨äº†å¯¹è±¡Aã€B,é‚£ä¹ˆAã€Bå˜ä¸ºç°è‰²å¯¹è±¡ï¼Œæ¥ä¸‹æ¥å°±å¼€å§‹åˆ†æç°è‰²å¯¹è±¡ï¼Œåˆ†æAæ—¶ï¼ŒAæ²¡æœ‰å¼•ç”¨å…¶ä»–å¯¹è±¡å¾ˆå¿«å°±è½¬å…¥é»‘è‰²ï¼ŒBå¼•ç”¨äº†Dï¼Œåˆ™Bè½¬å…¥é»‘è‰²çš„åŒæ—¶è¿˜éœ€è¦å°†Dè½¬ä¸ºç°è‰²ï¼Œè¿›è¡Œæ¥ä¸‹æ¥çš„åˆ†æã€‚ ç°è‰²å¯¹è±¡åªæœ‰Dï¼Œç”±äºDæ²¡æœ‰å¼•ç”¨å…¶ä»–å¯¹è±¡ï¼Œæ‰€ä»¥Dè½¬å…¥é»‘è‰²ã€‚æ ‡è®°è¿‡ç¨‹ç»“æŸ æœ€ç»ˆï¼Œé»‘è‰²çš„å¯¹è±¡ä¼šè¢«ä¿ç•™ä¸‹æ¥ï¼Œç™½è‰²å¯¹è±¡ä¼šè¢«å›æ”¶æ‰ã€‚ GCçš„è§¦å‘ é˜ˆå€¼ï¼šé»˜è®¤å†…å­˜æ‰©å¤§ä¸€å€ï¼Œå¯åŠ¨gc å®šæœŸï¼šé»˜è®¤2minè§¦å‘ä¸€æ¬¡gcï¼Œsrc/runtime/proc.go:forcegcperiod æ‰‹åŠ¨ï¼šruntime.gc() STWstop the worldæ˜¯gcçš„æœ€å¤§æ€§èƒ½é—®é¢˜ï¼Œå¯¹äºgcè€Œè¨€ï¼Œéœ€è¦åœæ­¢æ‰€æœ‰çš„å†…å­˜å˜åŒ–ï¼Œå³åœæ­¢æ‰€æœ‰çš„goroutineï¼Œç­‰å¾…gcç»“æŸä¹‹åæ‰æ¢å¤ã€‚ æ ‡è®°-æ¸…é™¤(mark and sweep)ç®—æ³•çš„STW(stop the world)æ“ä½œï¼Œå°±æ˜¯runtimeæŠŠæ‰€æœ‰çš„çº¿ç¨‹å…¨éƒ¨å†»ç»“æ‰ï¼Œæ‰€æœ‰çš„çº¿ç¨‹å…¨éƒ¨å†»ç»“æ„å‘³ç€ç”¨æˆ·é€»è¾‘æ˜¯æš‚åœçš„ã€‚è¿™æ ·æ‰€æœ‰çš„å¯¹è±¡éƒ½ä¸ä¼šè¢«ä¿®æ”¹äº†ï¼Œè¿™æ—¶å€™å»æ‰«ææ˜¯ç»å¯¹å®‰å…¨çš„ã€‚ Goå¦‚ä½•å‡çŸ­è¿™ä¸ªè¿‡ç¨‹å‘¢ï¼Ÿæ ‡è®°-æ¸…é™¤(mark and sweep)ç®—æ³•åŒ…å«ä¸¤éƒ¨åˆ†é€»è¾‘ï¼šæ ‡è®°å’Œæ¸…é™¤ã€‚ æˆ‘ä»¬çŸ¥é“Golangä¸‰è‰²æ ‡è®°æ³•ä¸­æœ€ååªå‰©ä¸‹çš„é»‘ç™½ä¸¤ç§å¯¹è±¡ï¼Œé»‘è‰²å¯¹è±¡æ˜¯ç¨‹åºæ¢å¤åæ¥ç€ä½¿ç”¨çš„å¯¹è±¡ï¼Œå¦‚æœä¸ç¢°è§¦é»‘è‰²å¯¹è±¡ï¼Œåªæ¸…é™¤ç™½è‰²çš„å¯¹è±¡ï¼Œè‚¯å®šä¸ä¼šå½±å“ç¨‹åºé€»è¾‘ã€‚æ‰€ä»¥ï¼š æ¸…é™¤æ“ä½œå’Œç”¨æˆ·é€»è¾‘å¯ä»¥å¹¶å‘ã€‚ æ ‡è®°æ“ä½œå’Œç”¨æˆ·é€»è¾‘ä¹Ÿæ˜¯å¹¶å‘çš„ï¼Œç”¨æˆ·é€»è¾‘ä¼šæ—¶å¸¸ç”Ÿæˆå¯¹è±¡æˆ–è€…æ”¹å˜å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆæ ‡è®°å’Œç”¨æˆ·é€»è¾‘å¦‚ä½•å¹¶å‘å‘¢ï¼Ÿè¿™é‡Œå°±è®©è¯´åˆ°golangçš„å†™å±éšœäº†ã€‚ GCæµç¨‹ Sweep Termination: å¯¹æœªæ¸…æ‰«çš„spanè¿›è¡Œæ¸…æ‰«, åªæœ‰ä¸Šä¸€è½®çš„GCçš„æ¸…æ‰«å·¥ä½œå®Œæˆæ‰å¯ä»¥å¼€å§‹æ–°ä¸€è½®çš„GC Mark: æ‰«ææ‰€æœ‰æ ¹å¯¹è±¡, å’Œæ ¹å¯¹è±¡å¯ä»¥åˆ°è¾¾çš„æ‰€æœ‰å¯¹è±¡, æ ‡è®°å®ƒä»¬ä¸è¢«å›æ”¶ Mark Termination: å®Œæˆæ ‡è®°å·¥ä½œ, é‡æ–°æ‰«æéƒ¨åˆ†æ ¹å¯¹è±¡(è¦æ±‚STW) Sweep: æŒ‰æ ‡è®°ç»“æœæ¸…æ‰«span ç›®å‰æ•´ä¸ªGCæµç¨‹ä¼šè¿›è¡Œä¸¤æ¬¡STW(Stop The World), ç¬¬ä¸€æ¬¡æ˜¯Marké˜¶æ®µçš„å¼€å§‹, ç¬¬äºŒæ¬¡æ˜¯Mark Terminationé˜¶æ®µ. ç¬¬ä¸€æ¬¡STWä¼šå‡†å¤‡æ ¹å¯¹è±¡çš„æ‰«æ, å¯åŠ¨å†™å±éšœ(Write Barrier)å’Œè¾…åŠ©GC(mutator assist). ç¬¬äºŒæ¬¡STWä¼šé‡æ–°æ‰«æéƒ¨åˆ†æ ¹å¯¹è±¡, ç¦ç”¨å†™å±éšœ(Write Barrier)å’Œè¾…åŠ©GC(mutator assist). éœ€è¦æ³¨æ„çš„æ˜¯, ä¸æ˜¯æ‰€æœ‰æ ¹å¯¹è±¡çš„æ‰«æéƒ½éœ€è¦STW, ä¾‹å¦‚æ‰«ææ ˆä¸Šçš„å¯¹è±¡åªéœ€è¦åœæ­¢æ‹¥æœ‰è¯¥æ ˆçš„G.ä»go 1.9å¼€å§‹, å†™å±éšœçš„å®ç°ä½¿ç”¨äº†Hybrid Write Barrier, å¤§å¹…å‡å°‘äº†ç¬¬äºŒæ¬¡STWçš„æ—¶é—´. å†™å±éšœå› ä¸ºgoæ”¯æŒå¹¶è¡ŒGCï¼Œ GCçš„æ‰«æå’Œgoä»£ç å¯ä»¥åŒæ—¶è¿è¡Œï¼Œè¿™æ ·å¸¦æ¥çš„é—®é¢˜æ˜¯GCæ‰«æçš„è¿‡ç¨‹ä¸­goä»£ç æœ‰å¯èƒ½æ”¹å˜äº†å¯¹è±¡çš„ä¾èµ–æ ‘ã€‚ ä¾‹å¦‚å¼€å§‹æ‰«ææ—¶å‘ç°æ ¹å¯¹è±¡Aå’ŒBï¼ŒBæ‹¥æœ‰Cçš„æŒ‡é’ˆã€‚ GCå…ˆæ‰«æAï¼ŒAæ”¾å…¥é»‘è‰² BæŠŠCçš„æŒ‡é’ˆäº¤ç»™A GCå†æ‰«æBï¼ŒBæ”¾å…¥é»‘è‰² Cåœ¨ç™½è‰²ï¼Œä¼šå›æ”¶ï¼›ä½†æ˜¯Aå…¶å®å¼•ç”¨äº†Cã€‚ ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜, goåœ¨GCçš„æ ‡è®°é˜¶æ®µä¼šå¯ç”¨å†™å±éšœ(Write Barrier). å¯ç”¨äº†å†™å±éšœ(Write Barrier)åï¼Œ GCå…ˆæ‰«æAï¼ŒAæ”¾å…¥é»‘è‰² BæŠŠCçš„æŒ‡é’ˆäº¤ç»™A ç”±äºAåœ¨é»‘è‰²ï¼Œæ‰€ä»¥Cæ”¾å…¥ç°è‰² Cæ²¡æœ‰å­å¯¹è±¡ï¼Œæ”¾å…¥é»‘è‰² æ‰«æBï¼ŒBæ²¡æœ‰å­å¯¹è±¡ï¼Œæ”¾å…¥é»‘è‰² å³ä½¿Aå¯èƒ½ä¼šåœ¨ç¨åä¸¢æ‰C, é‚£ä¹ˆCå°±åœ¨ä¸‹ä¸€è½®å›æ”¶ã€‚ å¼€å¯å†™å±éšœä¹‹åï¼Œå½“æŒ‡é’ˆå‘ç”Ÿæ”¹å˜, GCä¼šè®¤ä¸ºåœ¨è¿™ä¸€è½®çš„æ‰«æä¸­è¿™ä¸ªæŒ‡é’ˆæ˜¯å­˜æ´»çš„, æ‰€ä»¥æ”¾å…¥ç°è‰²ã€‚ å…¶ä»–å¸¸è§gcæœºåˆ¶ å¼•ç”¨è®¡æ•° å¤åˆ¶æ”¶é›† åˆ†ä»£æ”¶é›† GC çš„è§¦å‘æ—¶æœºçš„ä¸¤ç§å½¢å¼ ä¸»åŠ¨è§¦å‘ï¼Œé€šè¿‡è°ƒç”¨ runtime.GC æ¥è§¦å‘ GCï¼Œæ­¤è°ƒç”¨é˜»å¡å¼åœ°ç­‰å¾…å½“å‰ GC è¿è¡Œå®Œæ¯•ã€‚ è¢«åŠ¨è§¦å‘ï¼Œåˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼š ä½¿ç”¨ç³»ç»Ÿç›‘æ§ï¼Œå½“è¶…è¿‡ä¸¤åˆ†é’Ÿæ²¡æœ‰äº§ç”Ÿä»»ä½• GC æ—¶ï¼Œå¼ºåˆ¶è§¦å‘ GCã€‚ ä½¿ç”¨æ­¥è°ƒï¼ˆPacingï¼‰ç®—æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯æ§åˆ¶å†…å­˜å¢é•¿çš„æ¯”ä¾‹ã€‚ å‚è€ƒï¼š Golang GC(åƒåœ¾å›æ”¶æœºåˆ¶) [11. è§¦å‘ GC çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ](https://www.bookstack.cn/read/qcrao-Go-Questions/spilt.11.GC-GC.md#11. è§¦å‘ GC çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ)","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"OSIä¸ƒå±‚åè®®","slug":"OSIä¸ƒå±‚åè®®","date":"2021-02-20T02:29:06.000Z","updated":"2022-03-19T14:35:21.615Z","comments":true,"path":"2021/02/20/314/","link":"","permalink":"https://github.13sai.com/2021/02/20/314/","excerpt":"","text":"From:ç½‘ç»œçŸ¥è¯†æ¢³ç†â€“OSIä¸ƒå±‚ç½‘ç»œä¸TCP/IPäº”å±‚ç½‘ç»œæ¶æ„åŠäºŒå±‚/ä¸‰å±‚ç½‘ç»œ OSIä¸ƒå±‚ç½‘ç»œåè®®OSIæ˜¯Open System Interconnectçš„ç¼©å†™ï¼Œæ„ä¸ºå¼€æ”¾å¼ç³»ç»Ÿäº’è”ã€‚ OSIå‚è€ƒæ¨¡å‹å„ä¸ªå±‚æ¬¡çš„åˆ’åˆ†éµå¾ªä¸‹åˆ—åŸåˆ™ï¼š æ ¹æ®ä¸åŒå±‚æ¬¡çš„æŠ½è±¡åˆ†å±‚ æ¯å±‚åº”å½“æœ‰ä¸€ä¸ªå®šä¹‰æ˜ç¡®çš„åŠŸèƒ½ æ¯å±‚åŠŸèƒ½çš„é€‰æ‹©åº”è¯¥æœ‰åŠ©äºåˆ¶å®šç½‘ç»œåè®®çš„å›½é™…æ ‡å‡†ã€‚ å„å±‚è¾¹ç•Œçš„é€‰æ‹©åº”å°½é‡èŠ‚çœè·¨è¿‡æ¥å£çš„é€šä¿¡é‡ã€‚ å±‚æ•°åº”è¶³å¤Ÿå¤šï¼Œä»¥é¿å…ä¸åŒçš„åŠŸèƒ½æ··æ‚åœ¨åŒä¸€å±‚ä¸­ï¼Œä½†ä¹Ÿä¸èƒ½å¤ªå¤šï¼Œå¦åˆ™ä½“ç³»ç»“æ„ä¼šè¿‡äºåºå¤§ åŒä¸€å±‚ä¸­çš„å„ç½‘ç»œèŠ‚ç‚¹éƒ½æœ‰ç›¸åŒçš„å±‚æ¬¡ç»“æ„ï¼Œå…·æœ‰åŒæ ·çš„åŠŸèƒ½ã€‚ åŒä¸€èŠ‚ç‚¹å†…ç›¸é‚»å±‚ä¹‹é—´é€šè¿‡æ¥å£(å¯ä»¥æ˜¯é€»è¾‘æ¥å£)è¿›è¡Œé€šä¿¡ã€‚ ä¸ƒå±‚ç»“æ„ä¸­çš„æ¯ä¸€å±‚ä½¿ç”¨ä¸‹ä¸€å±‚æä¾›çš„æœåŠ¡ï¼Œå¹¶ä¸”å‘å…¶ä¸Šå±‚æä¾›æœåŠ¡ã€‚ ä¸åŒèŠ‚ç‚¹çš„åŒç­‰å±‚æŒ‰ç…§åè®®å®ç°å¯¹ç­‰å±‚ä¹‹é—´çš„é€šä¿¡ã€‚ æ ¹æ®ä»¥ä¸Šæ ‡å‡†ï¼ŒOSIå‚è€ƒæ¨¡å‹åˆ†ä¸º(ä»ä¸Šåˆ°ä¸‹): ç‰©ç†å±‚-&gt;æ•°æ®é“¾è·¯å±‚-&gt;ç½‘ç»œå±‚-&gt;ä¼ è¾“å±‚-&gt;ä¼šè¯å±‚-&gt;è¡¨ç¤ºå±‚-&gt;åº”ç”¨å±‚ã€‚ 1)ç‰©ç†å±‚æ¶‰åŠåœ¨ä¿¡é“ä¸Šä¼ è¾“çš„åŸå§‹æ¯”ç‰¹æµã€‚2)æ•°æ®é“¾è·¯å±‚çš„ä¸»è¦ä»»åŠ¡æ˜¯åŠ å¼ºç‰©ç†å±‚ä¼ è¾“åŸå§‹æ¯”ç‰¹æµçš„åŠŸèƒ½ï¼Œä½¿ä¹‹å¯¹åº”çš„ç½‘ç»œå±‚æ˜¾ç°ä¸ºä¸€æ¡æ— é”™çº¿è·¯ã€‚å‘é€åŒ…æŠŠè¾“å…¥æ•°æ®å°è£…åœ¨æ•°æ®å¸§ï¼ŒæŒ‰é¡ºåºä¼ é€å‡ºå»å¹¶å¤„ç†æ¥æ”¶æ–¹å›é€çš„ç¡®è®¤å¸§ã€‚3)ç½‘ç»œå±‚å…³ç³»åˆ°å­ç½‘çš„è¿è¡Œæ§åˆ¶ï¼Œå…¶ä¸­ä¸€ä¸ªå…³é”®é—®é¢˜æ˜¯ç¡®è®¤ä»æºç«¯åˆ°ç›®çš„ç«¯å¦‚ä½•é€‰æ‹©è·¯ç”±ã€‚4)ä¼ è¾“å±‚çš„åŸºæœ¬åŠŸèƒ½æ˜¯ä»ä¼šè¯å±‚æ¥æ”¶æ•°æ®è€Œä¸”æŠŠå…¶åˆ†æˆè¾ƒå°çš„å•å…ƒä¼ é€’ç»™ç½‘ç»œå±‚ã€‚5)ä¼šè¯å±‚å…è®¸ä¸åŒæœºå™¨ä¸Šçš„ç”¨æˆ·å»ºç«‹ä¼šè¯å…³ç³»ã€‚6)è¡¨ç¤ºå±‚ç”¨æ¥å®ŒæˆæŸäº›ç‰¹å®šçš„åŠŸèƒ½ã€‚7)åº”ç”¨å±‚åŒ…å«ç€å¤§é‡äººä»¬æ™®ééœ€è¦çš„åè®®ã€‚ å„å±‚åŠŸèƒ½è§ä¸‹è¡¨ï¼š ä¸ƒå±‚æ¨¡å‹çš„æ¯ä¸€å±‚éƒ½å…·æœ‰æ¸…æ™°çš„ç‰¹å¾ã€‚åŸºæœ¬æ¥è¯´:1)ç¬¬ä¸ƒè‡³ç¬¬å››å±‚(åº”ç”¨å±‚-&gt;è¡¨ç¤ºå±‚-&gt;ä¼šè¯å±‚-&gt;ä¼ è¾“å±‚)å¤„ç†æ•°æ®æºå’Œæ•°æ®ç›®çš„åœ°ä¹‹é—´çš„ç«¯åˆ°ç«¯é€šä¿¡ï¼Œ2)ç¬¬ä¸‰è‡³ç¬¬ä¸€å±‚ï¼ˆç½‘ç»œå±‚-&gt;æ•°æ®é“¾è·¯å±‚-&gt;ç‰©ç†å±‚ï¼‰å¤„ç†ç½‘ç»œè®¾å¤‡é—´çš„é€šä¿¡ã€‚ å¦å¤–ï¼šOSIæ¨¡å‹çš„ä¸ƒå±‚ä¹Ÿå¯ä»¥åˆ’åˆ†ä¸ºä¸¤ç»„ï¼š1ï¼‰ä¸Šå±‚ï¼ˆå±‚7ã€å±‚6å’Œå±‚5ï¼Œå³åº”ç”¨å±‚-&gt;è¡¨ç¤ºå±‚-&gt;ä¼šè¯å±‚ï¼‰ã€‚ä¸Šå±‚å¤„ç†åº”ç”¨ç¨‹åºé—®é¢˜ï¼Œå¹¶ä¸”é€šå¸¸åªåº”ç”¨åœ¨è½¯ä»¶ä¸Šã€‚æœ€é«˜å±‚ï¼Œå³åº”ç”¨å±‚æ˜¯ä¸ç»ˆç«¯ç”¨æˆ·æœ€æ¥è¿‘çš„ã€‚2ï¼‰ä¸‹å±‚ï¼ˆå±‚4ã€å±‚3ã€å±‚2å’Œå±‚1ï¼Œå³ä¼ è¾“å±‚-&gt;ç½‘ç»œå±‚-&gt;æ•°æ®é“¾è·¯å±‚-&gt;ç‰©ç†å±‚ï¼‰ã€‚ä¸‹å±‚æ˜¯å¤„ç†æ•°æ®ä¼ è¾“çš„ã€‚ç‰©ç†å±‚å’Œæ•°æ®é“¾è·¯å±‚åº”ç”¨åœ¨ç¡¬ä»¶å’Œè½¯ä»¶ä¸Šã€‚æœ€åº•å±‚ï¼Œå³ç‰©ç†å±‚æ˜¯ä¸ç‰©ç†ç½‘ç»œåª’ä»‹ï¼ˆæ¯”å¦‚è¯´ï¼Œç”µçº¿ï¼‰æœ€æ¥è¿‘çš„ï¼Œå¹¶ä¸”è´Ÿè´£åœ¨åª’ä»‹ä¸Šå‘é€ ç¬¬7å±‚-åº”ç”¨å±‚å®šä¹‰äº†ç”¨äºåœ¨ç½‘ç»œä¸­è¿›è¡Œé€šä¿¡å’Œæ•°æ®ä¼ è¾“çš„æ¥å£ - ç”¨æˆ·ç¨‹å¼ï¼›æä¾›æ ‡å‡†æœåŠ¡ï¼Œæ¯”å¦‚è™šæ‹Ÿç»ˆç«¯ã€æ–‡ä»¶ä»¥åŠä»»åŠ¡çš„ä¼ è¾“å’Œå¤„ ç†ï¼›åº”ç”¨å±‚ä¸ºæ“ä½œç³»ç»Ÿæˆ–ç½‘ç»œåº”ç”¨ç¨‹åºæä¾›è®¿é—®ç½‘ç»œæœåŠ¡çš„æ¥å£ã€‚åº”ç”¨å±‚åè®®çš„ä»£è¡¨åŒ…æ‹¬ï¼šTelnetã€FTPã€HTTPã€SNMPç­‰ã€‚ ç¬¬6å±‚-è¡¨ç¤ºå±‚æ©ç›–ä¸åŒç³»ç»Ÿé—´çš„æ•°æ®æ ¼å¼çš„ä¸åŒæ€§ï¼›æŒ‡å®šç‹¬ç«‹ç»“æ„çš„æ•°æ®ä¼ è¾“æ ¼å¼ï¼›æ•°æ®çš„ç¼–ç å’Œè§£ç ï¼›åŠ å¯†å’Œè§£å¯†ï¼› å‹ç¼©å’Œè§£å‹ç¼©è¿™ä¸€å±‚ä¸»è¦è§£å†³ç”¨æˆ·ä¿¡æ¯çš„è¯­æ³•è¡¨ç¤ºé—®é¢˜ã€‚å®ƒå°†é¢„äº¤æ¢çš„æ•°æ®ä»é€‚åˆäºæŸä¸€ç”¨æˆ·çš„æŠ½è±¡è¯­æ³•ï¼Œè½¬æ¢ä¸ºé€‚åˆäºOSIç³»ç»Ÿå†…éƒ¨ä½¿ç”¨çš„ä¼ é€è¯­æ³•ã€‚å³æä¾›æ ¼å¼åŒ–çš„è¡¨ç¤ºå’Œè½¬æ¢æ•°æ®æœåŠ¡ã€‚æ•°æ®çš„å‹ç¼©å’Œè§£å‹ç¼©ï¼Œ åŠ å¯†å’Œè§£å¯†ç­‰å·¥ä½œéƒ½ç”±è¡¨ç¤ºå±‚è´Ÿè´£ã€‚ ç¬¬5å±‚-ä¼šè¯å±‚ç®¡ç†ç”¨æˆ·ä¼šè¯å’Œå¯¹è¯ï¼›æ§åˆ¶ç”¨æˆ·é—´é€»è¾‘è¿æ¥çš„å»ºç«‹å’ŒæŒ‚æ–­ï¼›æŠ¥å‘Šä¸Šä¸€å±‚å‘ç”Ÿçš„é”™è¯¯è¿™ä¸€å±‚ä¹Ÿå¯ä»¥ç§°ä¸ºä¼šæ™¤å±‚æˆ–å¯¹è¯å±‚ï¼Œåœ¨ä¼šè¯å±‚åŠä»¥ä¸Šçš„é«˜å±‚æ¬¡ä¸­ï¼Œæ•°æ®ä¼ é€çš„å•ä½ä¸å†å¦å¤–å‘½åï¼Œè€Œæ˜¯ç»Ÿç§°ä¸ºæŠ¥æ–‡ã€‚ä¼šè¯å±‚ä¸å‚ä¸å…·ä½“çš„ä¼ è¾“ï¼Œå®ƒæä¾›åŒ…æ‹¬è®¿é—®éªŒè¯å’Œä¼šè¯ç®¡ç†åœ¨å†…çš„å»ºç«‹å’Œç»´æŠ¤åº”ç”¨ä¹‹é—´é€šä¿¡çš„æœºåˆ¶ã€‚å¦‚æœåŠ¡å™¨éªŒè¯ç”¨æˆ·ç™»å½•ä¾¿æ˜¯ç”±ä¼šè¯å±‚å®Œæˆçš„ã€‚ ç¬¬4å±‚-å¤„ç†ä¿¡æ¯çš„ä¼ è¾“å±‚ç®¡ç†ç½‘ç»œä¸­ç«¯åˆ°ç«¯çš„ä¿¡æ¯ä¼ é€ï¼›é€šè¿‡é”™è¯¯çº æ­£å’Œæµæ§åˆ¶æœºåˆ¶æä¾›å¯é ä¸”æœ‰åºçš„æ•°æ®åŒ…ä¼ é€ï¼›æä¾›é¢å‘æ— è¿ æ¥çš„æ•°æ®åŒ…çš„ä¼ é€ï¼›ç¬¬4å±‚çš„æ•°æ®å•å…ƒä¹Ÿç§°ä½œæ•°æ®åŒ…(packets)ã€‚ä½†æ˜¯ï¼Œå½“ä½ è°ˆè®ºTCPç­‰å…·ä½“çš„åè®®æ—¶åˆæœ‰ç‰¹æ®Šçš„å«æ³•ï¼ŒTCPçš„æ•°æ®å•å…ƒç§°ä¸ºæ®µ (segments)è€ŒUDPåè®®çš„æ•°æ®å•å…ƒç§°ä¸ºâ€œæ•°æ®æŠ¥(datagrams)â€ã€‚è¿™ä¸ªå±‚è´Ÿè´£è·å–å…¨éƒ¨ä¿¡æ¯ï¼Œå› æ­¤ï¼Œå®ƒå¿…é¡»è·Ÿè¸ªæ•°æ®å•å…ƒç¢ç‰‡ã€ä¹±åºåˆ°è¾¾çš„ æ•°æ®åŒ…å’Œå…¶å®ƒåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿçš„å±é™©ã€‚ç¬¬4å±‚ä¸ºä¸Šå±‚æä¾›ç«¯åˆ°ç«¯(æœ€ç»ˆç”¨æˆ·åˆ°æœ€ç»ˆç”¨æˆ·)çš„é€æ˜çš„ã€å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚æ‰€ä¸ºé€æ˜çš„ä¼ è¾“æ˜¯æŒ‡åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ ä¼ è¾“å±‚å¯¹ä¸Šå±‚å±è”½äº†é€šä¿¡ä¼ è¾“ç³»ç»Ÿçš„å…·ä½“ç»†èŠ‚ã€‚ä¼ è¾“å±‚åè®®çš„ä»£è¡¨åŒ…æ‹¬ï¼šTCPã€UDPã€SPXç­‰ã€‚ ç¬¬3å±‚-ç½‘ç»œå±‚å®šä¹‰ç½‘ç»œè®¾å¤‡é—´å¦‚ä½•ä¼ è¾“æ•°æ®ï¼›æ ¹æ®å”¯ä¸€çš„ç½‘ç»œè®¾å¤‡åœ°å€è·¯ç”±æ•°æ®åŒ…ï¼›æä¾›æµå’Œæ‹¥å¡æ§åˆ¶ä»¥é˜²æ­¢ç½‘ç»œèµ„æº çš„æŸè€—åœ¨ è®¡ç®—æœºç½‘ç»œä¸­è¿›è¡Œé€šä¿¡çš„ä¸¤ä¸ªè®¡ç®—æœºä¹‹é—´å¯èƒ½ä¼šç»è¿‡å¾ˆå¤šä¸ªæ•°æ®é“¾è·¯ï¼Œä¹Ÿå¯èƒ½è¿˜è¦ç»è¿‡å¾ˆå¤šé€šä¿¡å­ç½‘ã€‚ç½‘ç»œå±‚çš„ä»»åŠ¡å°±æ˜¯é€‰æ‹©åˆé€‚çš„ç½‘é—´è·¯ç”±å’Œäº¤æ¢ç»“ç‚¹ï¼Œ ç¡®ä¿æ•°æ®åŠæ—¶ä¼ é€ã€‚ç½‘ç»œå±‚å°†æ•°æ®é“¾è·¯å±‚æä¾›çš„å¸§ç»„æˆæ•°æ®åŒ…ï¼ŒåŒ…ä¸­å°è£…æœ‰ç½‘ç»œå±‚åŒ…å¤´ï¼Œå…¶ä¸­å«æœ‰é€»è¾‘åœ°å€ä¿¡æ¯- -æºç«™ç‚¹å’Œç›®çš„ç«™ç‚¹åœ°å€çš„ç½‘ç»œåœ°å€ã€‚å¦‚ æœä½ åœ¨è°ˆè®ºä¸€ä¸ªIPåœ°å€ï¼Œé‚£ä¹ˆä½ æ˜¯åœ¨å¤„ç†ç¬¬3å±‚çš„é—®é¢˜ï¼Œè¿™æ˜¯â€œæ•°æ®åŒ…â€é—®é¢˜ï¼Œè€Œä¸æ˜¯ç¬¬2å±‚çš„â€œå¸§â€ã€‚IPæ˜¯ç¬¬3å±‚é—®é¢˜çš„ä¸€éƒ¨åˆ†ï¼Œæ­¤å¤–è¿˜æœ‰ä¸€äº›è·¯ç”±åè®®å’Œåœ° å€è§£æåè®®(ARP)ã€‚æœ‰å…³è·¯ç”±çš„ä¸€åˆ‡äº‹æƒ…éƒ½åœ¨è¿™ç¬¬3å±‚å¤„ç†ã€‚åœ°å€è§£æå’Œè·¯ç”±æ˜¯3å±‚çš„é‡è¦ç›®çš„ã€‚ç½‘ç»œå±‚è¿˜å¯ä»¥å®ç°æ‹¥å¡æ§åˆ¶ã€ç½‘é™…äº’è¿ç­‰åŠŸèƒ½ã€‚åœ¨è¿™ä¸€å±‚ï¼Œæ•°æ®çš„å•ä½ç§°ä¸ºæ•°æ®åŒ…(packet)ã€‚ç½‘ç»œå±‚åè®®çš„ä»£è¡¨åŒ…æ‹¬ï¼šIPã€IPXã€RIPã€OSPFç­‰ã€‚ ç¬¬2å±‚-æ•°æ®é“¾è·¯å±‚(DataLinkLayer)å®šä¹‰æ“ä½œé€šä¿¡è¿æ¥çš„ç¨‹åºï¼›å°è£…æ•°æ®åŒ…ä¸ºæ•°æ®å¸§ï¼›ç›‘æµ‹å’Œçº æ­£æ•°æ®åŒ…ä¼ è¾“é”™è¯¯åœ¨ç‰©ç†å±‚æä¾›æ¯”ç‰¹æµæœåŠ¡çš„åŸºç¡€ä¸Šï¼Œå»ºç«‹ç›¸é‚»ç»“ç‚¹ä¹‹é—´çš„æ•°æ®é“¾è·¯ï¼Œé€šè¿‡å·®é”™æ§åˆ¶æä¾›æ•°æ®å¸§(Frame)åœ¨ä¿¡é“ä¸Šæ— å·®é”™çš„ä¼ è¾“ï¼Œå¹¶è¿›è¡Œå„ç”µè·¯ä¸Šçš„åŠ¨ä½œç³»åˆ—ã€‚æ•°æ®é“¾è·¯å±‚åœ¨ä¸å¯é çš„ç‰©ç†ä»‹è´¨ä¸Šæä¾›å¯é çš„ä¼ è¾“ã€‚è¯¥å±‚çš„ä½œç”¨åŒ…æ‹¬ï¼šç‰©ç†åœ°å€å¯»å€ã€æ•°æ®çš„æˆå¸§ã€æµé‡æ§åˆ¶ã€æ•°æ®çš„æ£€é”™ã€é‡å‘ç­‰ã€‚åœ¨è¿™ä¸€å±‚ï¼Œæ•°æ®çš„å•ä½ç§°ä¸ºå¸§(frame)ã€‚æ•°æ®é“¾è·¯å±‚åè®®çš„ä»£è¡¨åŒ…æ‹¬ï¼šSDLCã€HDLCã€PPPã€STPã€å¸§ä¸­ç»§ç­‰ã€‚ ç¬¬1å±‚-ç‰©ç†å±‚(PhysicalLayer)å®šä¹‰é€šè¿‡ç½‘ç»œè®¾å¤‡å‘é€æ•°æ®çš„ç‰©ç†æ–¹å¼ï¼›ä½œä¸ºç½‘ç»œåª’ä»‹å’Œè®¾å¤‡é—´çš„æ¥å£ï¼›å®šä¹‰å…‰å­¦ã€ç”µæ°”ä»¥åŠæœºæ¢°ç‰¹æ€§ã€‚è§„å®šé€šä¿¡è®¾å¤‡çš„æœºæ¢°çš„ã€ç”µæ°”çš„ã€åŠŸèƒ½çš„å’Œè¿‡ç¨‹çš„ç‰¹æ€§ï¼Œç”¨ä»¥å»ºç«‹ã€ç»´æŠ¤å’Œæ‹†é™¤ç‰©ç†é“¾è·¯è¿æ¥ã€‚å…·ä½“åœ°è®²ï¼Œæœºæ¢° ç‰¹æ€§è§„å®šäº†ç½‘ç»œè¿æ¥æ—¶æ‰€éœ€æ¥æ’ä»¶çš„è§„æ ¼å°ºå¯¸ã€å¼•è„šæ•°é‡å’Œæ’åˆ—æƒ…å†µç­‰;ç”µæ°”ç‰¹æ€§è§„å®šäº†åœ¨ç‰©ç†è¿æ¥ä¸Šä¼ è¾“bitæµæ—¶çº¿è·¯ä¸Šä¿¡å·ç”µå¹³çš„å¤§å°ã€é˜»æŠ—åŒ¹é…ã€ä¼ è¾“é€Ÿç‡ è·ç¦»é™åˆ¶ç­‰;åŠŸèƒ½ç‰¹æ€§æ˜¯æŒ‡å¯¹å„ä¸ªä¿¡å·å…ˆåˆ†é…ç¡®åˆ‡çš„ä¿¡å·å«ä¹‰ï¼Œå³å®šä¹‰äº†DTEå’ŒDCEä¹‹é—´å„ä¸ªçº¿è·¯çš„åŠŸèƒ½;è§„ç¨‹ç‰¹æ€§å®šä¹‰äº†åˆ©ç”¨ä¿¡å·çº¿è¿›è¡Œbitæµä¼ è¾“çš„ä¸€ç»„ æ“ä½œè§„ç¨‹ï¼Œæ˜¯æŒ‡åœ¨ç‰©ç†è¿æ¥çš„å»ºç«‹ã€ç»´æŠ¤ã€äº¤æ¢ä¿¡æ¯æ˜¯ï¼ŒDTEå’ŒDCEåŒæ”¾åœ¨å„ç”µè·¯ä¸Šçš„åŠ¨ä½œç³»åˆ—ã€‚åœ¨è¿™ä¸€å±‚ï¼Œæ•°æ®çš„å•ä½ç§°ä¸ºæ¯”ç‰¹(bit)ã€‚å±äºç‰©ç†å±‚å®šä¹‰çš„å…¸å‹è§„èŒƒä»£è¡¨åŒ…æ‹¬ï¼šEIA/TIA RS-232ã€EIA/TIA RS-449ã€V.35ã€RJ-45ç­‰ã€‚","categories":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://github.13sai.com/categories/%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://github.13sai.com/tags/%E7%BD%91%E7%BB%9C/"}]},{"title":"æˆä¸ºä¼šå¸¦å›¢é˜Ÿçš„æŠ€æœ¯äºº","slug":"æˆä¸ºä¼šå¸¦å›¢é˜Ÿçš„æŠ€æœ¯äºº","date":"2021-02-14T06:05:16.000Z","updated":"2022-05-31T09:34:13.073Z","comments":true,"path":"2021/02/14/318/","link":"","permalink":"https://github.13sai.com/2021/02/14/318/","excerpt":"","text":"æœ¬æ–‡æ˜¯æ‹‰å‹¾ä¸“æ ã€Šæˆä¸ºä¼šå¸¦å›¢é˜Ÿçš„æŠ€æœ¯äººã€‹çš„ç¬”è®°ï¼Œå›¾åŸºæœ¬ä¹Ÿæ¥æºäºä¸“æ ï¼Œè‡ªå·±ä»¥å‰ä¹Ÿæœ‰å¸¦å›¢é˜Ÿç»éªŒï¼Œä½†è‡ªæˆ‘æ„Ÿè§‰åšå¾—ä¸å¤Ÿå¥½ï¼Œè¿™ä¸ªä¸“æ ç»™æˆ‘å¾ˆå¤šå¯å‘ã€‚ æŠ€æœ¯äººä¸‰è¦ç´  æŠ€æœ¯äººä¸‰è¦ç´ ï¼šç¨³å®šæ€§ã€å€ºåŠ¡ã€æ¶æ„ ç¨³å®šæ€§æ€ä¹ˆè¡¡é‡ç³»ç»Ÿç¨³å®šæ€§ï¼Ÿä¸€èˆ¬æ¥è®²ï¼Œé€šè¿‡ç»Ÿè®¡ç³»ç»Ÿä¸å¯ç”¨çš„æ—¶é•¿æˆ–æ¬¡æ•°å°±å¯ä»¥å¯¹ç¨³å®šæ€§è¿›è¡Œé‡åŒ–ï¼Œæ¯”å¦‚ä¸šå†…å¸¸è¯´ 4 ä¸ª 9 çš„å¯ç”¨æ€§ï¼ˆå³ 1 å¹´å†… 99.99% çš„æ—¶é—´ç³»ç»Ÿæ˜¯å¯ç”¨çš„ï¼Œä¸å¯ç”¨æ—¶é•¿ä»…ä¸º 52.6 åˆ†é’Ÿï¼‰ã€‚ é’ˆå¯¹ç¨³å®šæ€§çš„æé«˜ä¹Ÿå¯ä»¥çœ‹ä½œå›´ç»•äº‹æ•…çš„æ²»ç†ï¼Œå¯ä»¥ä»äº‹æ•…å‘ç”Ÿçš„å‰ã€ä¸­ã€ååˆ†é˜¶æ®µæ¥çœ‹å¯¹åº”çš„å…³é”®ç‚¹ã€‚ äº‹æ•…çš„ç±»å‹ï¼šå¯ç”¨æ€§äº‹æ•…ã€èµ„æŸç±»äº‹æ•…ã€‚ äº‹æ•…å‰é¢„é˜²ï¼šä¸»åŠ¨æ²»ç†å‡å°‘ç³»ç»Ÿçš„é£é™©éšæ‚£ï¼Œé‡ç‚¹åœ¨å˜æ›´ç®¡æ§ã€å¯ç”¨æ€§è®¾è®¡ã€åº”æ€¥é¢„æ¡ˆä¸æ¼”ç»ƒã€‚ äº‹æ•…ä¸­åº”æ€¥ï¼šâ€œæ­¢è¡€ã€æ¢å¤â€ã€‚ äº‹æ•…åå¤ç›˜ï¼šç›®çš„ä¸æ˜¯è¿½è´£ï¼Œä¸æ˜¯ç”©é”…ï¼Œè€Œæ˜¯æŸ¥æ ¹å› ã€æ”¹è¿›æ¶æ„ã€å®Œå–„åº”æ€¥ã€æ€»ç»“ç»éªŒã€‚ äº‹æ•…çš„ç±»å‹ä»äº‹æ•…ç‰¹æ€§ä¸Šçœ‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ä¸ºå¯ç”¨æ€§äº‹æ•…å’Œèµ„æŸç±»äº‹æ•…ã€‚ å¯ç”¨æ€§äº‹æ•…ï¼šæŠ€æœ¯åŸå› å¯¼è‡´ç³»ç»Ÿéƒ¨åˆ†æˆ–è€…å…¨éƒ¨åŠŸèƒ½ä¸å¯ç”¨ï¼Œä¸šåŠ¡æ²¡åŠæ³•æ­£å¸¸å®Œæˆå¯¹åº”æµç¨‹æˆ–è€…æä¾›å¯¹åº”æœåŠ¡ã€‚æ¯”å¦‚å› ä¸ºç½‘ç»œã€æ¥å£ Bug ç­‰åŸå› ï¼Œç”¨æˆ·æ²¡åŠæ³•ç™»å½•ã€å•†å“åˆ—è¡¨ä¸æ˜¾ç¤ºç­‰ã€‚ èµ„æŸç±»äº‹æ•…ï¼šç³»ç»Ÿçš„åŠŸèƒ½éƒ½èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œä½†å› ä¸ºé€»è¾‘ã€è®¡ç®—ç­‰åŸå› è®©ä¸šåŠ¡çš„æŸä¸€æ–¹äº§ç”Ÿäº†èµ„é‡‘æŸå¤±ã€‚æ¯”å¦‚æŸç”µå•†éƒ¨é—¨é”™å‘æ— é—¨æ§›ä¼˜æƒ åˆ¸ã€æŸå…¬å¸å•†æˆ·æ¸…ç»“ç®—å°‘æ‰“æ¬¾ç»™å•†æˆ·ç­‰ç­‰ã€‚ æ•…éšœå¤„ç†çš„ç”Ÿå‘½å‘¨æœŸ æ•…éšœå¤„ç†çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥åˆ†ä¸º 4 ä¸ªé˜¶æ®µï¼šå‘ç°å¼‚å¸¸ã€æ’æŸ¥é—®é¢˜ã€åˆ¤æ–­å†³ç­–ã€æ¢å¤å¤„ç†ã€‚è¿™ 4 ä¸ªé˜¶æ®µå¯¹åº”çš„è¡ŒåŠ¨å¹¶ä¸æ˜¯å®Œå…¨ä¸²è¡Œçš„ï¼Œè™½ç„¶æœ‰ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œä½†åœ¨å®é™…çš„å¤„ç†è¿‡ç¨‹ä¸­åº”è¯¥å¹¶è¡Œå±•å¼€ã€‚ç±»ä¼¼ fork/join çš„æ¨¡å¼ï¼Œä¸æ–­å®Œæˆå°ä»»åŠ¡ã€ä¸æ–­æ±‡æ€»ä¿¡æ¯ï¼Œä¸æ–­åšå‡ºåˆ¤æ–­ä¸å†³ç­–ï¼Œå½¢æˆå¾ªç¯ç›´åˆ°æ•…éšœæ¢å¤ã€‚ æ•…éšœå‘ç° æ€»çš„æ¥è¯´ï¼Œäººå·¥çš„è¢«åŠ¨åé¦ˆåœ¨æ—¶é—´å’Œé€Ÿåº¦ä¸Šæœ‰è¾ƒå¼ºçš„ä¸ç¡®å®šæ€§ï¼Œå¾ˆå®¹æ˜“å‡ºç°â€œå°æ•…éšœ * é•¿æ—¶é—´ = å¤§äº‹æ•…â€çš„æƒ…å½¢ã€‚è€Œçº¯ç²¹çš„æŠ€æœ¯æŒ‡æ ‡ç›‘æ§åˆä¼šå¿½ç•¥æ‰æ¥å£æ­£å¸¸å“åº”ï¼Œä½†æ˜¯ä¸šåŠ¡å¼‚å¸¸çš„åœºæ™¯ï¼Œåªæœ‰ä¸¤è€…ç»“åˆï¼Œé€šè¿‡ç›‘æ§å‘Šè­¦ï¼Œæœ€å¤§ç¨‹åº¦ä¸Šç¼©çŸ­æ•…éšœæ„ŸçŸ¥çš„æ—¶é—´ï¼Œæ‰èƒ½æ—©å‘ç°æ—©è§£å†³ï¼Œå‡å°‘ä¸šåŠ¡å½±å“ã€‚ æ•…éšœæ’æŸ¥ ç›´æ¥é”å®šï¼šæœ€è¿‘çš„ä»£ç æ›´æ–°ä¸å¼‚å¸¸ç°è±¡é—´æœ‰ç›´æ¥çš„é€»è¾‘å…³è”ï¼Œè¿›è€Œå¯ä»¥ç›´æ¥é”å®šåˆ°æ•…éšœç‚¹ã€‚æ¯”å¦‚ï¼Œåˆšå¯¹ä¸‹å•æ¥å£è¿›è¡Œäº†å‘å¸ƒå˜æ›´ï¼Œå®¢æˆ·åé¦ˆå¤§é‡å¤±è´¥ï¼Œå¯ä»¥åŸºæœ¬æ–­å®šæ˜¯åˆšæ‰çš„å‘å¸ƒå¯¼è‡´ã€‚ æ’é™¤æ³•ï¼šå½“å¹²æ‰°å› ç´ è¿‡å¤šï¼ˆç”¨æˆ·ã€è®¢å•ç­‰å‡ ä¸ªç³»ç»ŸåŒæ—¶å‘ç”Ÿå˜æ›´ï¼Œå¼•èµ·è®¢å•å¼‚å¸¸ï¼‰ï¼Œå¾ˆéš¾ç›´æ¥é”å®šåˆ°æ•…éšœç‚¹ï¼Œå°±è¦ç»“åˆä¸šåŠ¡åœºæ™¯ï¼Œåœ¨æ•´æ¡ä¸‹å•é“¾è·¯ä¸ŠåŠå…³è”ä»£ç è¿›è¡Œè‡ªæŸ¥è‡ªè¯ï¼Œé€šè¿‡æ’é™¤æ³•é”å®šæ•…éšœã€‚ æ•…éšœå†³ç­– ä¸šåŠ¡å†³ç­–éå¸¸å¤æ‚ï¼Œèƒ½å¦ç¬¬ä¸€æ—¶é—´æ­¢æŸå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæŠ€æœ¯ Leader çš„ç°åœºååº”å’Œæ“ä½œï¼Œ è¦æ³¨æ„æ•…éšœå†³ç­–çš„ä¸¤ä¸ªå…³é”®ç‚¹ ï¼š ä¸€å®šè¦æœ‰æ˜ç¡®çš„å†³ç­–äººã€ä¸»å¯¼è€…å’Œæœ‰æ•ˆçš„æ²Ÿé€šæ–¹å¼ï¼ˆé’‰é’‰ç¾¤ã€å¤šäººç”µè¯ä¼šè®®ç­‰ï¼‰ï¼Œè®©ä¿¡æ¯å¯ä»¥é€šç•…åœ°äº¤æµå‡ºæ¥ï¼Œå¹¶ä¸”å†³ç­–äººå¯ä»¥æ ¹æ®æƒ…å†µåšåˆ¤æ–­ä¸å–èˆï¼Œå½¢æˆæ‰€æœ‰äººæ˜ç¡®çš„å¤„ç†ç»“è®ºï¼Œæœ€å¥½è¿˜èƒ½è½æˆæ–‡æ¡£ï¼Œå¯è¿½æº¯ã€‚ æ¯”å¦‚ï¼Œç¬¬ä¸€æ—¶é—´åœæ­¢é”™è¯¯çº¢åŒ…çš„å‘æ”¾ï¼Œç¡®ä¿æ•…éšœæ²¡æœ‰å¢é‡ï¼Œå¹¶æŠŠå†³ç­–ç¬¬ä¸€æ—¶é—´åŒæ­¥ç»™å›¢é˜Ÿæˆå‘˜ï¼Œå¹¶åŒæ­¥ç›¸å…³è´Ÿè´£äººåç»­çš„åŠ¨ä½œï¼Œå¯¹å·²å‘æ”¾çš„çº¢åŒ…ï¼Œæ˜ç¡®è¦æ±‚è´Ÿè´£äººæ±‡æ€»å„ç±»å…³é”®ä¿¡æ¯ï¼ˆçº¢åŒ…æ•°é‡ã€æ¶‰åŠé‡‘é¢ã€æ¶‰åŠç”¨æˆ·æ•°ã€æœ‰æ•ˆæ—¶é•¿ã€å¯èƒ½èµ„æŸç­‰ï¼‰ã€‚ æ‰€æœ‰çš„ä¿¡æ¯ä¸€å®šè¦æ•°æ®åŒ–ï¼Œä¸åŒçš„æ•°æ®é‡çº§ä¼šå¯¼è‡´å†³ç­–ä¸åŒï¼Œæ¯”å¦‚çº¢åŒ…é”™å‘ 5W å¯èƒ½åªæ˜¯æš‚åœå‘æ”¾ï¼Œä½†æ˜¯å­˜é‡çº¢åŒ…ä¾ç„¶å¯ä»¥æ ¸é”€ï¼ŒæŸå¤±å…¬å¸å¯ä»¥æ‰¿æ‹…ã€‚ä½†æ˜¯å¦‚æœé”™å‘ 5000Wï¼Œå¤§æ¦‚å°±è¦æ¶‰åŠä¸€ç³»åˆ—çš„è°ƒæ•´ï¼Œè¿™æ˜¯éå¸¸å½±å“å†³ç­–çš„ã€‚ æ•…éšœæ¢å¤ åº”æ€¥â€œä¸‰æ¿æ–§â€ï¼šå›æ»šã€é‡å¯å¤§æ³•ã€é™çº§é™æµã€‚ å¦‚ä½•æœ‰ä»·å€¼åœ°åšäº‹åå¤ç›˜ï¼Ÿä½ å¯ä»¥ä»æ—¶é•¿ã€ç°è±¡ã€å¤„ç†æ—¶é—´è½´ã€æ ¹å› ã€æ”¹è¿›è®¡åˆ’è¿™å‡ ä¸ªç»´åº¦è¿›è¡Œå¤ç›˜ï¼Œ åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œæ·±ç©¶ï¼š äº‹æ•…æ—¶é•¿ï¼š1-5-10(å³ 1 åˆ†é’Ÿå‘ç°ã€5 åˆ†é’Ÿå“åº”ã€10 åˆ†é’Ÿæ¢å¤) æ˜¯å¦è¾¾æˆï¼Œå¦‚æœæ²¡æœ‰æ˜¯ä¸ºä»€ä¹ˆï¼Ÿå“ªä¸ªç¯èŠ‚ç”¨æ—¶æœ€å¤šï¼Œå¦‚ä½•æé«˜å’Œæ”¹å–„ï¼Ÿ äº‹æ•…æ ¹å› ï¼šæ ¹å› ä¸ç­‰äºç›´æ¥åŸå› ï¼Œä¸€ä¸ªäº‹æ•…çš„ç›´æ¥åŸå› å¾€å¾€å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯æ ¹å› å¯èƒ½æ˜¯å¤šä¸ªç»´åº¦çš„ç¼ºå¤±ï¼Œéœ€è¦åƒå‰¥æ´‹è‘±ä¸€æ ·ä¸€å±‚å±‚æ‰¾ä¸‹å»ã€‚æ‹¿åº“å­˜æ¥å£å˜æ›´è¿™ä¸ªCaseæ¥è¯´ï¼Œç›´æ¥åŸå› å°±æ˜¯æŸæ®µä»£ç é€»è¾‘å˜æ›´å¯¼è‡´ï¼Œä½†æ˜¯åº”è¯¥åœ¨æµ‹è¯•ã€å‘å¸ƒã€ç›‘æ§ã€åº”æ€¥å½±å“ã€é¢„æ¡ˆè®¾è®¡ç­‰å¤šä¸ªç¯èŠ‚å±•å¼€å»çœ‹ï¼Œæ ¹å› çš„æŒ–æ˜å¹¶ä¸å¿Œè®³â€œå¹æ¯›æ±‚ç–µâ€ã€‚ äº‹æ•…æ”¹è¿›æªæ–½ï¼šç”±ç‚¹æ¨åˆ°é¢ã€æ˜ç¡®åˆ°äººã€æ˜ç¡®æ—¶é—´ã€‚ä¸æ ¹å› ç±»ä¼¼ï¼Œè¦ç»“åˆå¤šä¸ªç»´åº¦å½¢æˆç»„åˆæ‹³çš„æ”¹è¿›ç‚¹ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ¨ä½œï¼Œè¦å°†é‡ç‚¹æ”¾åœ¨å¯¹æœªæ¥ã€å¯¹åŒç±»é—®é¢˜çš„é¢„é˜²ä¸Šã€‚æ ¸å¿ƒå°±æ˜¯å¦‚æœå†ä¸€æ¬¡å‘ç”Ÿç±»ä¼¼çš„é—®é¢˜ï¼Œè¿™äº›æ”¹è¿›æªæ–½æ˜¯ä¸æ˜¯èƒ½èµ·åˆ°ä½œç”¨ã€‚ å…³äºäº‹åå¤ç›˜ï¼Œæˆ‘ä»¬å°±æ˜¯è¦æ·±æŒ–äº‹æ•…å¦‚ä½•å‘ç”Ÿçš„ã€å¦‚ä½•å¤„ç†çš„ã€æœªæ¥æ€ä¹ˆé¢„é˜²ã€‚ä½†è¦é¿å…æƒ…ç»ªåŒ–ï¼Œåœ¨å¤ç›˜ä¼šä¸Šçš„åæ€ã€æ„Ÿæ‚Ÿã€æ‡Šæ¼æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå¦‚ä½•å¸¦é¢†å›¢é˜ŸæŠŠç²¾åŠ›æ”¾åœ¨æ”¹è¿›æªæ–½çš„è½å®ä»¥åŠäº‹æ•…å‰çš„æ²»ç†ä¸Šæ›´æœ‰ä»·å€¼ã€‚å¦å¤–ï¼Œä½ éœ€è¦ç•™å‡ºæ—¶é—´è®©å›¢é˜Ÿä¼™ä¼´è¿›è¡Œå†…éƒ¨ Reviewï¼Œé¿å…ä¸ºäº†å¼€ä¼šè€Œå¤ç›˜ã€‚ æ²¡æœ‰è´¨é‡çš„äº¤ä»˜ï¼Œå†å¤šå†å¿«éƒ½æ¯«æ— æ„ä¹‰ã€‚ å˜æ›´ä¼šå¼•èµ·90%ä»¥ä¸Šçš„æ•…éšœ å˜æ›´éœ€è¦ç›‘æ§ æœ‰æ•ˆçš„ç›‘æ§è¦å›ç­”ä¸‰ä¸ªé—®é¢˜ï¼š æ˜¯å¦æœ‰é—®é¢˜å‘ç”Ÿï¼Ÿ å“ªé‡Œå‘ç”Ÿäº†é—®é¢˜ï¼Ÿ å‘ç”Ÿäº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ æœ‰æ•ˆç°åº¦å¿…é¡»æœ‰è€å¿ƒ ç°åº¦ä»æ¥ä¸æ˜¯ä¸ºäº†æµ‹è¯•ï¼Œä¹Ÿä¸ç­‰äº A/B Testã€‚å®ƒæœ¬èº«æ˜¯ä¸ºäº†å¯¹æŠ—â€œæœªçŸ¥çš„ä¸ç¡®å®šæ€§â€ã€‚ è¦æƒ³å®ç°ç°åº¦çš„æœ‰æ•ˆæ€§ï¼Œå…³é”®ç‚¹åœ¨äºæ—¶é—´å’Œæµé‡ã€‚ æ—¶é—´ï¼šæ¯ä¸ªç°åº¦é˜¶æ®µè‡³å°‘æœ‰ 5 ~ 10 min çš„è§‚å¯Ÿï¼Œåœ¨ç›‘æ§ã€æ—¥å¿—å’Œå„æ–¹åé¦ˆæ²¡æœ‰å¼‚å¸¸åå†æ‰©å¤§ç°åº¦èŒƒå›´ï¼Œç¡®ä¿ä¸€äº›è¿è¡Œæ—¶å¼‚å¸¸æˆ–é‡å˜ç§¯ç´¯è´¨å˜çš„é—®é¢˜å¯ä»¥æš´éœ²å‡ºæ¥ã€‚ æµé‡ï¼šæœ‰æ—¶ä¸€äº›ä¸šåŠ¡åœºæ™¯éœ€è¦ç‰¹å®šçš„è§¦å‘æ¡ä»¶ï¼Œæ¯”å¦‚æ»¡è¶³æŸäº›æ¡ä»¶çš„ç”¨æˆ·æˆ–æ»¡è¶³æŸäº›æ¡ä»¶çš„è®¢å•ï¼Œé‚£ä¹ˆåœ¨ç°åº¦æ—¶å°±ä¸èƒ½ä»…é€šè¿‡å•ä½æ—¶é—´å†…æœ‰æ²¡æœ‰å¼‚å¸¸æ¥åˆ¤æ–­ï¼Œè¿˜è¦ç¡®ä¿æœ‰è¶³å¤Ÿçš„æœ‰æ•ˆæµé‡ã€‚ å›æ»šå°±æ˜¯å˜æ›´çš„â€œåæ‚”è¯â€ è¦çŸ¥é“ï¼Œç³»ç»Ÿå¹¶ä¸æ˜¯å¤©ç„¶å¯ä»¥æ— ç¼å›æ»šçš„ï¼Œæƒ³è¦ç³»ç»Ÿå…·å¤‡å›æ»šçš„èƒ½åŠ›ï¼Œåœ¨è®¾è®¡ä¸å®ç°é˜¶æ®µéœ€è¦ä»˜å‡ºé¢å¤–çš„ç²¾åŠ›ã€‚å¯å›æ»šçš„æœ¬è´¨æ˜¯ç³»ç»Ÿçš„å…¼å®¹æ€§è®¾è®¡ä¸å®ç°ï¼Œæ¯”å¦‚å¸¸è§çš„â€œåªå¢ä¸æ”¹â€ï¼Œä¸€ä¸ª API å†…è¦è°ƒæ•´å¾ˆå¤šå®ç°é€»è¾‘æ‰èƒ½æ»¡è¶³æ–°ä¸šåŠ¡çš„éœ€æ±‚ï¼Œæ­¤æ—¶ä¸å¦¨ç›´æ¥æ–°å¢ä¸€ä¸ª API ï¼Œä¸¤ä¸ª API ä¿æŒå‚æ•°ä¸€è‡´ï¼Œé‚£ä¹ˆä¸€æ—¦æ–° API æœ‰å¼‚å¸¸ç›´æ¥åˆ‡æ¢å›æ—§çš„ API å³å¯ã€‚ æ‰€ä»¥ï¼Œä¸è®ºæ˜¯ç°åº¦è®¡åˆ’è¿˜æ˜¯å›æ»šç­–ç•¥éƒ½åº”è¯¥åœ¨æ¶æ„è®¾è®¡é˜¶æ®µå°±å»è€ƒè™‘ï¼Œç»“åˆæ’æœŸã€é£é™©ç¨‹åº¦ã€æˆæœ¬æŠ•å…¥è¿™äº›æ–¹é¢ï¼Œè¦åšå¥½è¯„ä¼°ä¸å¹³è¡¡ã€‚ åšå®ˆ Design For Failure çš„æ¶æ„ç†å¿µâ€œDesign for failure and nothing will failâ€ï¼Œæœ€æ—©æ˜¯ AWS çš„ä¸€æ¡æœ€ä½³å®è·µï¼Œå³é¢å‘å¤±è´¥è¿›è¡Œç³»ç»Ÿè®¾è®¡ã€‚å¯ä»¥ç†è§£ä¸ºï¼šè€ƒè™‘ç³»ç»Ÿæ‰€æœ‰å¯èƒ½å‘ç”Ÿæ•…éšœæˆ–ä¸å¯ç”¨çš„æƒ…å½¢ï¼Œå¹¶å‡è®¾è¿™äº›å¯èƒ½éƒ½ä¼šå‘ç”Ÿï¼Œå€’é€¼è‡ªå·±è®¾è®¡è¶³å¤Ÿå¥å£®çš„ç³»ç»Ÿã€‚ å°†ç»éªŒæ•™è®­æ²‰æ·€ä¸‹æ¥ å†å²æ˜¯æœ€å¥½çš„è€å¸ˆï¼Œæˆ‘å»ºè®®ä½ æ€»ç»“å¹¶åˆ†æè¿‡å»å‘ç”Ÿè¿‡çš„äº‹æ•…ï¼Œå¹¶ç»“åˆå¸¸è§„åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¯ç”¨æ€§é£é™©ï¼Œä»¥æ­¤æ¢³ç†å‡ºä¸€ä¸ªå›´ç»•äº‹æ•…éšæ‚£çš„é£é™©ç‚¹ Checklistï¼Œåœ¨éœ€æ±‚è¿­ä»£æˆ–è€…æ¶æ„è®¾è®¡æ—¶ï¼Œé€šè¿‡å®ƒé«˜æ•ˆåœ°æ‰¾åˆ°ç³»ç»Ÿå®ç°çš„è–„å¼±ç¯èŠ‚ã€‚ é™¤äº†å®Œå–„ Checklistï¼Œåœ¨å›¢é˜Ÿæ™®åŠè¿™ç§è®¾è®¡ç†å¿µä¹‹å¤–ï¼Œæ›´å…³é”®çš„æ˜¯å°†è¿™äº›è§£å†³æ–¹æ¡ˆæ²‰æ·€æˆè®¾è®¡åŸåˆ™ï¼Œè®©ç ”å‘äººå‘˜å¯ä»¥åœ¨å®é™…ä¸­è½åœ°ã€‚ é€šè¿‡æ¼”ç»ƒéªŒè¯é¢„æ¡ˆè®¾è®¡ è®¾è®¡å¹¶å®ç°äº†è‡ªå·±çš„æ•…éšœæ¼”ç»ƒç³»ç»Ÿï¼Œæ—¥å¸¸ä¸»åŠ¨åˆ¶é€ äº‹æ•…ä¸Šä¸‹æ–‡æ¥éªŒè¯æˆ‘ä»¬çš„è®¾è®¡ä¸ç³»ç»Ÿæ˜¯å¦å¯é ã€‚ æŠŠç¨³å®šæ€§å½“ä½œæœºåˆ¶ä¸æ–‡åŒ–å»å»ºè®¾ç³»ç»Ÿç¨³å®šæ€§ç»“æœå¥½åå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæŠ€æœ¯ Leader çš„é‡è§†ç¨‹åº¦ï¼Œå¦‚æœä¸€ä¸ªå›¢é˜Ÿçš„ç®¡ç†è€…éƒ½ä¸èƒ½èº«ä½“åŠ›è¡Œçš„å»é‡è§†å®ƒï¼Œè€Œä»…ä»…åªæ˜¯å–Šå–Šå£å·ï¼Œé‚£å°±ä¸è¦æŒ‡æœ›å›¢é˜Ÿæˆå‘˜èƒ½è®¤çœŸåœ°å¯¹å¾…è¿™ä»¶äº‹ã€‚ æ–°äºº Landing ä»ç¨³å®šæ€§å­¦ä¹ å¼€å§‹ æ¯äººä¸ä½äº 35% çš„ç¨³å®šæ€§ KPI å¥½çš„åçš„éƒ½è¦åœ¨é˜³å…‰ä¹‹ä¸‹æ™’ä¸€æ™’ å»ºç«‹èµ„æŸæ¦‚å¿µçš„å®è§‚è®¤çŸ¥ä»å¹¿ä¹‰ä¸Šæ¥çœ‹ï¼Œå­˜åœ¨ç†è®ºæŸå¤±ä¹Ÿåº”è¯¥ç®—èµ„æŸï¼Œ æ¯”å¦‚å› ä¸ºæœç´¢æ¨èç³»ç»Ÿå‡ºé—®é¢˜ï¼ˆä¸è®ºä»€ä¹ˆåŸå› ï¼‰å¯¼è‡´è¿™ä¸€é˜¶æ®µå¹¿å‘Šçš„æ”¶å…¥å‡å°‘ï¼Œæˆ–è€…å› ç³»ç»Ÿ Bug å¯¼è‡´ç”¨æˆ·å–æ¶ˆè®¢å•çš„ç”³è¯·è¢«é»˜è®¤åŒæ„ï¼ˆè™½ç„¶åŸæœ¬å•†æˆ·å¯èƒ½ä¹Ÿä¼šåšåŒæ„å¤„ç†ï¼Œä½†æ˜¯ç”³è¯‰çš„è¯å¹³å°ä¾ç„¶è¦èµ”ä»˜ï¼‰ï¼Œç±»ä¼¼é¢„è®¡æ”¶ç›Šå‡å°‘æˆ–è€…å› ç³»ç»Ÿé—®é¢˜äº§ç”Ÿèµ”ä»˜çš„åœºæ™¯éƒ½åº”ç®—ä¸ºèµ„æŸã€‚ èµ„æŸé˜²æ§çš„ä¸‰ä¸ªå…³é”® é˜²ï¼šèµ„é‡‘è§†è§’åšé£é™©ç‚¹è¯†åˆ« ç›‘ï¼šä¸€è‡´æ€§ä¸æ­£ç¡®æ€§åŒæ ¸å¯¹ é’ˆå¯¹èµ„æŸæ„ŸçŸ¥çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåŸºäºçº¿ä¸Šä¸šåŠ¡ç»“æœæ”¶æ‹¢è¿›è¡Œç›‘æ§ï¼ŒåŸºäºçº¿ä¸‹ä¸šåŠ¡åœºæ™¯æ‰©æ•£è¿›è¡Œæ ¸å¯¹ã€‚ ä¸å¯ç”¨æ€§ç›‘æ§å›´ç»•æ¥å£çš„æŠ€æœ¯æŒ‡æ ‡ä¸åŒï¼Œèµ„æŸæ›´å…³æ³¨çš„æ˜¯æ•°æ®æ ¸å¯¹ï¼Œç›‘æ§çš„å¹¶ä¸æ˜¯è¿è¡ŒçŠ¶æ€è€Œæ˜¯è¿è¡Œç»“æœï¼Œå¹¶ä¸”èµ„æŸç›‘æ§çš„ç²’åº¦è¦æ±‚éå¸¸é«˜ï¼Œç²¾ç»†åˆ°æ¯ä¸€ç¬”äº¤æ˜“ã€æ¯ä¸€æ¬¡é‡‘é¢è®¡ç®—ã€æ¯ä¸€ä¸ªçº¢åŒ…å‘æ”¾ã€‚æ‰€ä»¥èµ„æŸç›‘æ§çš„æœ‰æ•ˆæ€§å¾ˆä¾èµ–äºåœºæ™¯çš„è¦†ç›–ç‡ï¼Œä»…è¦†ç›–å‡ ä¸ªå…³é”®åœºæ™¯æ˜¯ä¸è¶³ä»¥è§„é¿èµ„æŸé£é™©çš„ï¼Œé™¤äº†è¦å®šæœŸæ¢³ç†å¤–ï¼Œæ¯æ¬¡ç³»ç»Ÿæœ‰å˜æ›´æˆ–è€…æ–°åŠŸèƒ½æ—¶ï¼Œéƒ½éœ€æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„æ ¸å¯¹ç‚¹ï¼Œä»¥åŠæ—§æœ‰æ ¸å¯¹å…¬å¼æ˜¯å¦éœ€è¦è°ƒæ•´ã€‚ æ§ï¼šèµ„é‡‘æ‹¦æˆª + èµ„äº§æ§åˆ¶ é™¤äº†é˜²å’Œç›‘ï¼Œèµ„æŸé˜²æ§çš„å…³é”®ä¸»è¦åœ¨â€œæ§â€å­—ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨é—®é¢˜å‘ç”Ÿåç¬¬ä¸€æ—¶é—´æ­¢æŸï¼Œè¿™å°±éœ€è¦æŠ€æœ¯åœ¨ç³»ç»Ÿå±‚é¢å¯¹èµ„é‡‘å’Œèµ„äº§æœ‰å¾ˆå¼ºçš„æ§åˆ¶èƒ½åŠ›ã€‚è¿™ç§èƒ½åŠ›çš„è¡¨ç°å°±æ˜¯ï¼š ä¸ä»…å¯ä»¥é€šè¿‡é¢„æ¡ˆå°†æŸäº›åœºæ™¯ä¸é“¾è·¯é™çº§ï¼Œè¿˜å¯ä»¥æ‹¦æˆªèµ„é‡‘çš„æµå‡ºå’Œèµ„äº§çš„ä½¿ç”¨ï¼ŒåŒæ—¶å…·å¤‡å¿«é€Ÿè®¢æ­£é”™è¯¯æ•°æ®çš„èƒ½åŠ›ã€‚ åœ¨æˆ‘ä»¬å¼€å§‹å¤„ç†èµ„æŸäº‹æ•…æ—¶ï¼Œä¼šæœ‰ä¸‰ä¸ªå…±æ€§çš„éœ€æ±‚ã€‚ é—®é¢˜æ­¢è¡€ä¸æ–°å¢ï¼šæ ¸å¿ƒæ˜¯å…³é—­é—®é¢˜äº§ç”Ÿæºå¤´ï¼Œå¾€å¾€é€šè¿‡ä¸šåŠ¡åœºæ™¯é™çº§æ¥å®ç°ï¼Œæ¯”å¦‚å¯¹é”™è¯¯çº¢åŒ…æˆ–è€…æ»¡å‡æ´»åŠ¨è¿›è¡Œä¸‹çº¿ã€‚ æ§åˆ¶èµ„é‡‘æµå‡ºï¼šæ ¸å¿ƒæ˜¯å¯¹èµ„é‡‘å’Œèµ„äº§è¿›è¡Œæ‹¦æˆªä¸å†»ç»“ï¼Œé¿å…å¤–æµåæŸå¤±æ— æ³•ä¿®æ­£ï¼Œæ¯”å¦‚ç¦æ­¢ç”¨æˆ·ä¸‹å•æ—¶å‹¾é€‰ä½¿ç”¨æœ‰é—®é¢˜çš„çº¢åŒ…ã€‚ å­˜é‡æ•°æ®è®¢æ­£ï¼šæ ¸å¿ƒæ˜¯æå–é—®é¢˜æ•°æ®åå¯ä»¥å¿«é€Ÿåœ°æ‰¹é‡å¤„ç†ï¼Œæ¯”å¦‚æ‰¹é‡æ›´æ”¹çº¢åŒ…çš„é‡‘é¢ã€ç”šè‡³ç›´æ¥å°†çº¢åŒ…æ— æ•ˆã€‚ è™½ç„¶å…¶ä¸­ä¸€äº›æ“ä½œå¯¹ç”¨æˆ·ä½“éªŒæ˜¯æœ‰æŸçš„ï¼Œä½†æœ‰è€Œä¸ç”¨æ˜¯ä¸€å›äº‹å„¿ï¼Œæ— èƒ½ä¸ºåŠ›åˆ™æ˜¯å¦å¤–ä¸€å›äº‹å„¿ï¼Œå…¶ä¸­ï¼š èµ„é‡‘æ‹¦æˆªçš„èƒ½åŠ›ä¸»è¦ä»èµ„é‡‘çš„æµå…¥å’Œæµå‡ºè¿™ä¸¤ç«¯è¿›è¡ŒæŠŠæ§ã€‚ä»¥çº¢åŒ…è€Œè¨€å°±æ˜¯ç®¡æ§å…¶åˆ›å»ºä¸æ ¸é”€ã€‚åœ¨çº¢åŒ…åˆ›å»ºæ—¶ï¼Œæœ‰é¢„ç®—ç³»ç»Ÿè¿›è¡Œç®¡æ§ï¼Œé¿å…æ— é™åˆ¶åœ°ç”Ÿæˆçº¢åŒ…è¿›è€Œè¶…å‘ã€‚åœ¨çº¢åŒ…æ ¸é”€æ—¶ï¼Œç”±äº¤æ˜“å’Œè¥é”€ç³»ç»Ÿè¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿è®¢å•ä¸Šä¸‹æ–‡ä»¥åŠçº¢åŒ…åˆæ³•ï¼Œé¿å…é—®é¢˜çº¢åŒ…è¢«æ ¸é”€è¿›è€Œé€ æˆæ— æ³•æŒ½å›çš„èµ„æŸã€‚ èµ„äº§ç®¡æ§çš„èƒ½åŠ›åˆ™æ˜¯èµ„äº§çš„å¿«é€Ÿé”å®šå’Œæ•°æ®è®¢æ­£å±•å¼€ï¼Œä»¥çº¢åŒ…è€Œè¨€ï¼Œå¦‚æœä¸åŒæ¨¡ç‰ˆä¸åŒæ´»åŠ¨çš„çº¢åŒ…éƒ½æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ‰¹æ¬¡å·ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ ‡è®°å¿«é€Ÿæå–æŸä¸€æ‰¹æœ‰é—®é¢˜çš„æ•°æ®ã€‚åŒæ—¶å¦‚æœæå‰å‡†å¤‡æ‰¹é‡è®¢æ­£çš„è„šæœ¬ï¼Œæˆ–è€…æœ‰è®¢æ­£æ•°æ®çš„å¹³å°ï¼Œå°±å¯ä»¥å¿«é€Ÿä¿®æ”¹çº¢åŒ…é‡‘é¢ã€ä½¿ç”¨æ—¶é—´ã€ä½¿ç”¨é—¨æ§›ç­‰å…³é”®ä¿¡æ¯ï¼Œç”šè‡³æ‰¹é‡æ— æ•ˆæ‰€æœ‰é—®é¢˜çº¢åŒ…ã€‚ ä½ éœ€è¦æ³¨æ„ï¼Œè¿™äº›èƒ½åŠ›çš„å®ç°æ›´å¤šä¾èµ–äºæŠ€æœ¯ Leader åœ¨æ—¥å¸¸éœ€æ±‚è¿­ä»£å’Œæ¶æ„è®¾è®¡æ—¶ï¼Œæ˜¯å¦æœ‰æ„è¯†å¼•å¯¼å›¢é˜ŸåŠ å¼ºè¿™æ–¹é¢çš„å»ºè®¾ã€‚å¤§éƒ¨åˆ†çš„é¢„æ¡ˆæ€è·¯æ¥æºäºè¿‡å»å·²ç»å‘ç”Ÿçš„é—®é¢˜ï¼Œæˆ–è€…å¯¹æœªæ¥å¯èƒ½å‘ç”Ÿé—®é¢˜çš„å‡è®¾ï¼Œå°†é¢„æ¡ˆå¸¸æ€åŒ–æ˜¯ä½ é‡ç‚¹å…³æ³¨å¹¶æ¨è¿›è½åœ°çš„ã€‚ é™¤äº†å»ºè®¾é¢„æ¡ˆï¼Œè¿˜è¦æœ‰é¢„æ¡ˆæ¼”ç»ƒï¼Œä»¥æ­¤ä¿è¯é¢„æ¡ˆçš„æœ‰æ•ˆæ€§ã€‚æŠ€æœ¯ Leader æ›´åº”è¯¥é¼“åŠ±æµ‹è¯•å’Œå¼€å‘çš„åŒå­¦ä¸»åŠ¨åšæ”»é˜²æ¼”ç»ƒï¼Œå¯»æ‰¾æ¼æ´ã€éªŒè¯æ­¢æŸæ–¹æ¡ˆã€åŠæ—¶å‘ç°å¹¶ä¿®å¤é—®é¢˜ã€‚ æŠ€æœ¯å€ºåŠ¡æŠ€æœ¯å€ºåŠ¡åœ¨ç ”å‘é¢†åŸŸç±»ä¼¼äºâ€œé‡‘èå€ºåŠ¡â€çš„æ¦‚å¿µï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯è¯´å› ä¸ºäººä¸ºå¦¥åï¼Œç³»ç»Ÿçš„è®¾è®¡å’Œå®ç°æ²¡æœ‰éµå¾ªæœ€ä½³å®è·µï¼Œæ‰€ä»¥è™½ç„¶çŸ­æœŸåšåˆ°äº†å¿«é€Ÿäº¤ä»˜ï¼Œä½†ä¹Ÿåˆ¶çº¦äº†ç³»ç»Ÿæœªæ¥çš„å¯æ‰©å±•æ€§ï¼Œå¹¶ä¸”åŸ‹ä¸‹äº†ç¨³å®šæ€§çš„é£é™©éšæ‚£ã€‚ é‡è§†æŠ€æœ¯å€ºåŠ¡çš„åŸå›  å½±å“ç³»ç»Ÿæ‰©å±•å’Œéœ€æ±‚äº¤ä»˜ æ¶æ€§å¾ªç¯å¯¼è‡´äººå‘˜æµå¤± æŠ€æœ¯å€ºåŠ¡çš„æ¶æ€§å¾ªç¯ä¼šå½±å“å¼€å‘å›¢é˜Ÿçš„ç”Ÿäº§åŠ›ï¼Œå¹¶é™ä½å›¢é˜Ÿçš„å£«æ°”å’Œæˆå‘˜çš„é©±åŠ¨åŠ›ï¼Œè€Œä½ç”Ÿäº§ç‡å¯¼è‡´å›¢é˜Ÿåªèƒ½ä¼˜å…ˆäº¤ä»˜åŠŸèƒ½ï¼Œè¿™å°±æ¨è¿Ÿäº†æŠ€æœ¯å€ºåŠ¡çš„è§£å†³ï¼Œä»è€Œè¿›ä¸€æ­¥å¢åŠ æŠ€æœ¯å€ºåŠ¡ã€‚ å¦‚ä½•ä»å¾ªç¯çš„å€ºåŠ¡å›°å¢ƒä¸­çªå›´è€Œå‡ºï¼Ÿ1.å€ºåŠ¡çš„ Owner æ˜¯æŠ€æœ¯ Leader è¦æƒ³è§£å†³æŠ€æœ¯å€ºåŠ¡ï¼Œä½ éœ€è¦æ‰¾åˆ°æŠ€æœ¯ä¸ä¸šåŠ¡çš„å¹³è¡¡ç‚¹ï¼Œæˆ‘çš„ç»éªŒæ˜¯â€œå†…å¤–åŒä¿®â€ï¼š å†…ï¼šåŠ å¼ºå›¢é˜Ÿçš„æˆ˜æ–—åŠ›ï¼Œå‡å°‘å€ºåŠ¡äº§ç”Ÿçš„æœºä¼šï¼Œå¢å¼ºå€ºåŠ¡å¤„ç†çš„èƒ½åŠ›ã€‚ å¤–ï¼šæ·±åˆ»åœ°ç†è§£ä¸šåŠ¡ï¼Œå¹¶ä¸”åšå¥½ä¸å…¶ä»–åä½œæ–¹ï¼ˆå°¤å…¶æ˜¯äº§å“ã€ä¸šåŠ¡ï¼‰çš„æ²Ÿé€šã€‚è¿™æ ·ä½ æ‰èƒ½ç†è§£åä½œæ–¹æƒ³è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œä»–ä»¬ä»¥ä¸ºè¦ä¹ˆAã€è¦ä¹ˆBæ‰èƒ½è§£å†³çš„é—®é¢˜ï¼Œæ—¢æ‡‚æŠ€æœ¯åˆæ‡‚ä¸šåŠ¡çš„ä½ èƒ½å¦æ‰¾åˆ°æ–¹æ¡ˆCï¼Ÿ å»ºè®®ï¼šé¢å¯¹é€‰æ‹©é¢˜æ—¶ä¸è¦åªçœ‹åˆ°å¯é€‰é¡¹ï¼Œè¦æ°¸è¿œå¯»æ‰¾ç¬¬ä¸‰æ¡è·¯ã€‚å¦‚æœå®åœ¨æ²¡æœ‰å…¶ä»–é€‰æ‹©ï¼Œåœ¨æŠ€æœ¯å¦¥åçš„åŒæ—¶ï¼Œåšå¥½æ²Ÿé€šï¼Œè®©åä½œæ–¹æ˜ç™½æ–¹æ¡ˆçš„ä¸´æ—¶æ€§ä»¥åŠå¯¹æœªæ¥çš„å½±å“ï¼Œäº‰å–åˆ°æ‰¿è¯ºåœ¨æœªæ¥ç»™ä½ è¶³å¤Ÿæ—¶é—´è§£å†³è¿™äº›é—®é¢˜ã€‚ é€šè¿‡ CheckList è¯†åˆ«å€ºåŠ¡ å»ºç«‹ä¸€ä¸ªå€ºåŠ¡ Review çš„ CheckList ï¼Œå¹¶ä¸”ä¸æ–­å®Œå–„ã€‚æŠ€æœ¯å€ºåŠ¡ä»è¡¨è±¡ä¸Šå¯ä»¥åšä¸€äº›ç»†åˆ†ï¼š é€šè¿‡ç°è±¡æˆ‘ä»¬å°±å¯ä»¥åæ¨å‡ºä¸€äº›å¯¼è‡´ç°è±¡çš„åŸå› ï¼Œå°†è¿™äº›åŸå› ç»“åˆç³»ç»Ÿçš„æ¶æ„è¿›è¡Œåˆ†ç±»ï¼Œå°±ä¼šå½¢æˆä¸€ä¸ªä¸ªå…·ä½“çš„å…³æ³¨ç‚¹ã€‚è¿™äº›å…³æ³¨ç‚¹å¾€å¾€æ˜¯ç»“åˆæˆ‘ä»¬ä¹‹å‰è¸©è¿‡çš„å‘ã€å‘ç”Ÿè¿‡çš„é—®é¢˜ï¼Œä»¥åŠç¼–ç ã€æ¶æ„ä¸Šå¹¿ä¸ºéµå®ˆçš„ä¸€äº›æœ€ä½³å®è·µæ‰€å½¢æˆçš„ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åˆ¶å®šå‡ºä¸€ä¸ªè¾ƒä¸ºè¯¦ç»†çš„ CheckList ç”¨ä»¥å…·ä½“çš„å€ºåŠ¡è¯†åˆ«ï¼ˆä¸‹å›¾ä¾›å‚è€ƒï¼‰ã€‚ æœ‰è®¡åˆ’åœ°åˆ†çº§å¿å€º å…³é”®é“¾è·¯ä¼˜å…ˆï¼š å¹¶éæ‰€æœ‰ç³Ÿç³•çš„è®¾è®¡ä¸å®ç°éƒ½èƒ½äº§ç”Ÿä¸¥é‡åæœï¼Œå³ä½¿èƒ½ï¼Œå®ƒä»¬å‘ç”Ÿçš„æ¦‚ç‡ä¹Ÿä¸ä¸€æ ·ï¼Œè€Œå…³é”®é“¾è·¯æ„å‘³ç€ä¸šåŠ¡å½±å“æœ€å¤§ï¼ŒåŒæ—¶æ—¥å¸¸çš„æ”¹åŠ¨é¢‘ç‡å’Œäº‹æ•…é£é™©ä¹Ÿè¾ƒé«˜ï¼Œä¼˜å…ˆè§£å†³å®ƒçš„æ”¶ç›Šæ˜¯æœ€å¤§çš„ã€‚ å†å²äº‹æ•…å‘½ä¸­ä¼˜å…ˆï¼š ä¸€äº›è®¾è®¡ä¸å®ç°åœ¨è¿‡å¾€å¯¼è‡´è¿‡çº¿ä¸ŠçœŸå®é—®é¢˜çš„å‘ç”Ÿï¼Œä¸ç®¡æ˜¯å¦å‘ç”Ÿåœ¨æœ¬ç³»ç»Ÿè¿˜æ˜¯å½“å‰å›¢é˜Ÿï¼Œéƒ½ç›¸å½“äºå·²ç»è¢«è¯å®è¿‡çš„è¿™ç±»å€ºåŠ¡çš„ä¸¥é‡æ€§ï¼Œæ‰€ä»¥åº”è¯¥å°½æ—©ä¿®å¤å®ƒä»¬ï¼Œé¿å…ç±»ä¼¼é—®é¢˜åå¤å‘ç”Ÿã€‚ å¯æ‰©å±•æ€§ä¼˜å…ˆï¼š åœ¨ CheckList ä»¥åŠå€ºåŠ¡ç°è±¡ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæœ‰äº›é—®é¢˜å½±å“äº†ç³»ç»Ÿæœªæ¥çš„æ¼”è¿›ï¼Œå¢åŠ äº†è¿­ä»£æˆæœ¬ï¼Œæœ‰äº›é—®é¢˜å½±å“ç³»ç»Ÿçš„ç»´æŠ¤ï¼Œæ¯”å¦‚ä»£ç é£æ ¼æ²¡æœ‰ç»Ÿä¸€ã€ç¼ºå°‘æ–‡æ¡£ï¼Œåœ¨å¤„ç†æ—¶åº”è¯¥ä¼˜å…ˆå¤„ç†å½±å“å¯æ‰©å±•æ€§çš„é—®é¢˜ï¼Œåç»­é€æ­¥å¤„ç†å½±å“å¯ç»´æŠ¤æ€§çš„é—®é¢˜ã€‚ æƒè´£æ¸…æ™°ä¼˜å…ˆï¼š ä¸€äº›é—®é¢˜åœ¨å¤„ç†æ—¶å—åˆ°å†å²æ¶æ„ã€ç»„ç»‡åˆ†å·¥ï¼ˆåº·å¨å®šå¾‹ï¼‰çš„å½±å“ï¼Œä¼šå¯¼è‡´ç³»ç»Ÿçš„æƒè´£ä¸æ¸…æ™°ï¼Œè¿™ç±»ç³»ç»Ÿçš„æ¨è¿›å’Œæ”¹é€ å¾€å¾€éœ€è¦èŠ±è´¹æ›´å¤šçš„æ—¶é—´ç²¾åŠ›ï¼Œå¹¶ä¸”ä»é¡¶å±‚è®¾è®¡å‡ºå‘å»é‡æ–°è€ƒé‡ï¼Œæ‰€ä»¥æƒè´£æ¸…æ™°çš„éƒ¨åˆ†å¯ä»¥ä¼˜å…ˆå¤„ç†ã€‚ æ€»çš„æ¥è¯´ï¼Œé€šè¿‡å¯¹æŠ€æœ¯å€ºåŠ¡è¿›è¡Œåˆ†çº§ï¼Œå®è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜åˆ†æ²»çš„è¿‡ç¨‹ï¼Œå°†å¤§é—®é¢˜åˆ‡åˆ†æˆä¸€ä¸ªä¸ªå°é—®é¢˜ï¼Œè¿™æ ·å°±å¯ä»¥å°†å®ƒä»¬åŠ å…¥æ—¥å¸¸çš„è¿­ä»£ä¸­ï¼Œå½¢æˆä¸€ä¸ªåˆ†æœŸå¿è¿˜æŠ€æœ¯å€ºåŠ¡çš„è®¡åˆ’ï¼Œé€æ­¥å‡å°‘æŠ€æœ¯å€ºåŠ¡ï¼Œå‡è½»è´Ÿæ‹…è®©å›¢é˜Ÿä¸ç³»ç»Ÿå¯ä»¥è½»è£…ä¸Šé˜µã€‚ æ­£è§†å€ºåŠ¡åšå¥½é¢„é˜² é™¤æ­¤ä¹‹å¤–ï¼Œé¢„é˜²æ°¸è¿œèƒœäºæ²»ç–—ï¼ŒæŠ€æœ¯å€ºåŠ¡æ±‡æ€»é¢„é˜²çš„å…³é”®ç‚¹åœ¨äºé‚£äº›â€œåŸæœ¬æœªçŸ¥â€çš„æŠ€æœ¯å€ºåŠ¡è¦é€æ¸å‡å°‘ï¼Œå¤§å®¶å¯¹äºå®ç°è´¨é‡çš„è¿½æ±‚ä¸èƒ½æ­¢æ­¥äºâ€œæµ‹è¯•æ²¡æœ‰æ˜æ˜¾ Bugâ€ï¼Œå†™å‡ºèƒ½è¿è¡Œçš„ä»£ç æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜è¦æ˜“ç»´æŠ¤æ˜“æ‰©å±•ã€‚ å¯ä»¥ä»å‡ ä¸ªæ–¹é¢ç€æ‰‹ï¼š æå‡å›¢é˜Ÿè®¤è¯†ï¼Œé€šè¿‡é¡¹ç›®å¤ç›˜ã€ç³»ç»Ÿé‡æ„ã€äº‹æ•… Review ç­‰å„ç§æœºä¼šï¼Œé€šè¿‡å®é™…çš„æ¡ˆä¾‹è®©ç ”å‘åŒå­¦æ¸…æ¥šæŠ€æœ¯å€ºåŠ¡å¯¹å›¢é˜Ÿäº§ç”Ÿçš„è´Ÿæ‹…ï¼Œä»¥åŠå¯¹ä¸ªäººèƒ½åŠ›æå‡çš„å½±å“ã€‚ å»ºç«‹æœºåˆ¶æµç¨‹ï¼Œæ¯”å¦‚åœ¨æ–¹æ¡ˆè®¾è®¡é˜¶æ®µå‘ä¸‹æ·±æŒ–ä¸€ä¸‹å®ç°çš„è¦ç‚¹ï¼Œæ›´å¤šèµ„æ·±çš„å¼€å‘å‚ä¸åˆ°æ¶æ„è¯„å®¡ï¼Œæˆ–è€…ä¿ƒè¿›å›¢é˜Ÿå½¢æˆ code review çš„ä¹ æƒ¯å¹¶ä¸”è¾¾æˆä¸€ä¸ªå…±è¯†æ ‡å‡†ä»¥æå‡ç³»ç»Ÿè´¨é‡ã€‚ ç¡®ä¿èµ„æºæŠ•å…¥ï¼Œåœ¨é€šè¿‡å€ºåŠ¡è¯†åˆ«å’Œåˆ†çº§åï¼Œå°†è¿˜å€ºçš„æŠ•å…¥æå‰è®¡ç®—åˆ°æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç¡®ä¿æœ‰ä¸€å®šçš„èµ„æºæŠ•å…¥å…¶ä¸­ã€‚ ä¸€äº›å¸¸è§çš„è¯¯åŒº é€šè¿‡ CheckList åšå€ºåŠ¡è¯†åˆ«ï¼Œç„¶åå®šæœŸè¯Šæ–­ã€æ°´å¹³æ‰«æã€å€ºåŠ¡å®šçº§ã€åˆ†æœŸå¿è¿˜æ¥åšæŠ€æœ¯å€ºåŠ¡çš„å¤„ç†ï¼Œæœ€ç»ˆåœ¨å›¢é˜Ÿè®¤è¯†ã€æœºåˆ¶æ°›å›´ã€èµ„æºä¿éšœä¸Šä¸‹åŠŸå¤«åšé¢„é˜²ï¼Œè¿™å°±æ˜¯æŠ€æœ¯å€ºåŠ¡ç®¡ç†çš„æ ¸å¿ƒæ€è·¯ã€‚ è€Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€äº›é—®é¢˜æ˜¯æ—¥å¸¸ä½ å¾ˆå®¹æ˜“èµ°å…¥è¯¯åŒºçš„ï¼Œæˆ‘ç®€å•æ€»ç»“äº†ä¸€ä¸‹å‡ ä¸ªæ³¨æ„ç‚¹ï¼š å­˜åœ¨å³åˆç†ï¼ŒåŠ¨æ€å˜åŒ–æ‰æ˜¯ç‹é“ã€‚ ä¸è¦æ€»æƒ³ç€æ¯•å…¶åŠŸäºä¸€å½¹ï¼Œä¹Ÿå‡ ä¹ä¸å¤ªå¯èƒ½æœ‰å®Œç¾çš„å®ç°æˆ–ç³»ç»Ÿï¼Œæ¥å—æŠ€æœ¯å€ºåŠ¡ä¸€å®šä¼šå­˜åœ¨çš„äº‹å®ï¼Œé‡ç‚¹åœ¨äºæ§åˆ¶å€ºåŠ¡ç§¯å‹çš„ç¨‹åº¦ï¼Œæ¬ å€ºæœ¬èº«ä¸å¯æ€•ï¼Œæ¬ å€ºä¸çŸ¥ä¸”ä¸è¿˜æ‰å¯æ€•ã€‚ ä¸ç§¯è·¬æ­¥æ— ä»¥è‡³åƒé‡Œã€‚æˆ‘ä»¬å¾€å¾€è¿‡åº¦è½»è§†æ—¥å¸¸ç§¯ç´¯ï¼Œåˆè¿‡åº¦é‡è§†â€œå¤§äº‹ä»¶â€äº§ç”Ÿçš„å½±å“ã€‚æ—¥å¸¸è¿™é‡Œå‡‘åˆä¸€ä¸‹ï¼Œé‚£é‡Œå¦¥åä¸€ç‚¹ï¼Œæ²¡äººå…³æ³¨å°é—®é¢˜å‘ç”Ÿçš„åŸå› ã€‚è€Œä¸€æ—¦å‘ç”Ÿé‡å¤§çš„å½±å“ï¼Œåˆ™æ¨ä¸å¾—æŠŠä¹‹å‰çš„ç³»ç»Ÿå…¨ç›˜æ¨ç¿»é‡åšä¸€éã€‚ æœºåˆ¶æµç¨‹å¤–è¿˜è¦è®²ç­–ç•¥å’Œæ–¹æ³•ã€‚å¾ˆå¤šæŠ€æœ¯ Leader è§‰å¾—è¿™ä»¶äº‹å¾ˆé‡è¦ï¼Œè®²çš„åŒæ—¶è®¾è®¡äº†å¾ˆå¤šæµç¨‹å’Œæœºåˆ¶ï¼Œä¸éµå®ˆå°±è¦æ‰¿æ‹…æ€æ ·æ€æ ·çš„åæœï¼Œè¿™æ ·å¾€å¾€äº‹åŠåŠŸå€ã€‚æœºåˆ¶æµç¨‹ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œä¹Ÿä¸èƒ½å…‰æœ‰æƒ©ç½šè€Œæ²¡æœ‰æ¿€åŠ±ï¼ŒåŒæ—¶æœ€é‡è¦çš„æ˜¯ä½ ä¸èƒ½åªè¿½æ€è¦ç»“æœï¼Œè¦ç»™å¸®åŠ©ã€ç»™æ–¹æ³•ã€ç»™æ”¯æŒã€‚ å¤§é¡¹ç›®ï¼šæŠŠæ¡å…³é”®ç‚¹ï¼Œè°‹å®šè€ŒååŠ¨è®¤æ¸…å¼‚åŒï¼Œåšåˆ°å¿ƒä¸­æœ‰æ•° åœ¨è¿™ä¸ªå¸¸è§„æµç¨‹ä¸­ï¼ŒæŠ€æœ¯å›¢é˜Ÿçš„é‡å¿ƒæ˜¯æŠŠæ‰§è¡Œåšåˆ°ä½ï¼Œä½ è¦æ›´å…³æ³¨è¿‡ç¨‹ç®¡æ§ï¼Œç¡®ä¿ç³»ç»Ÿäº¤ä»˜ã€‚ å¤§é¡¹ç›®ä¸å¸¸è§„é¡¹ç›®çš„æ ¸å¿ƒå·®å¼‚ç‚¹ï¼Œæˆ‘è®¤ä¸ºä¸»è¦åœ¨äºè¿™ä¸ªâ€œå¤§â€å­—ä¸Šï¼Œä½ å¯ä»¥ä»ä¸‰ä¸ªæ–¹é¢å»ç†è§£ã€‚ å‡ºå‘ç‚¹ä¸åŒï¼Œä¸šåŠ¡æœŸæœ›æ›´å¤§ è§„æ¨¡ä¸åŒï¼Œå¤æ‚åº¦æ›´é«˜ ç»“æœè¯„åˆ¤æ ‡å‡†ä¸åŒï¼Œå½±å“æ›´å¤§ æŠŠæ¡å…³é”®ç‚¹ï¼Œè°‹å®šè€ŒååŠ¨ å…³æ³¨æ•ˆæœæ›´é‡äºå…³æ³¨äº¤ä»˜ï¼Œè¿™æ˜¯å¤§é¡¹ç›®çš„æ ¸å¿ƒç‰¹å¾ã€‚ ä¸è¦ä¸ºäº†é‡æ„è€Œé‡æ„ï¼Œè¦çŸ¥é“ä½ è¦çš„ç»“æœæ˜¯ä»€ä¹ˆã€‚ å¤§é¡¹ç›®çš„å¤±è´¥å­˜åœ¨ä¸€ä¸ªå…±æ€§çš„é—®é¢˜ï¼šå›´ç»•ä¸šåŠ¡ç»“æœçš„æ€è€ƒã€è®¡åˆ’ä¸è¶³ï¼Œç›®æ ‡çš„å®šä¹‰ä¸æ¸…æ™°æˆ–æ²¡æœ‰å……åˆ†åŒæ­¥ç»™æ‰€æœ‰ç›¸å…³äººï¼Œé¡¹ç›®åŒå­¦çŸ¥å…¶ç„¶è€Œä¸çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚è¿ç›®æ ‡éƒ½æ²¡æœ‰å…±è¯†ï¼Œä½•è°ˆæ‰§è¡Œåˆ°ä½ï¼Œé¡¹ç›®æˆåŠŸï¼Ÿ æ‰€ä»¥æˆ‘è®¤ä¸ºè¶Šæ˜¯é‡å¤§çš„é¡¹ç›®ï¼Œåœ¨è®¡åˆ’ã€è®¾è®¡ã€å‡†å¤‡ä¸ŠæŠ•å…¥çš„ç²¾åŠ›å°±åº”è¯¥è¶Šå¤šï¼Œè°‹å®šè€ŒååŠ¨ã€‚ WHYï¼ˆé¡¹ç›®ä¸ºä»€ä¹ˆåšï¼‰ WHATï¼ˆé¡¹ç›®åšæˆä»€ä¹ˆæ ·ï¼‰ WHOï¼ˆå“ªäº›äººæ¥ä¸€èµ·åšé¡¹ç›®ï¼‰ HOWï¼ˆå¯åŠ¨é¡¹ç›®åå¦‚ä½•åšï¼‰ åˆç†æ‹†åˆ†ä»»åŠ¡ï¼ˆæ¨¡å—ï¼‰æ˜¯é¡¹ç›®æˆåŠŸçš„ä¸€åŠ ä¿æŒé£é™©æ„è¯†ï¼Œæ•¬ç•å¢¨è²å®šå¾‹ åšå¥½å……åˆ†çš„å‡†å¤‡ä¹‹åï¼Œå¯ä»¥å¬å¼€ç«‹é¡¹ä¼šï¼Œå°† WHYã€WHATã€WHOã€HOW çš„ä¿¡æ¯ä¸æ€è€ƒåŒæ­¥ç»™é¡¹ç›®ç›¸å…³äººå‘˜ã€‚é€šè¿‡ Kick Off ä¼šè®®ç¡®å®šé¡¹ç›®çš„åŸºè°ƒã€åŒæ­¥å¿…è¦ä¿¡æ¯ï¼Œä¸ºé¡¹ç›®æ¨è¿›æ‰«æ¸…éšœç¢ã€‚ å¦‚ä½•å¤„ç†æ£˜æ‰‹é—®é¢˜é—®é¢˜ä¸€ï¼šç¼ºå…µå°‘å°†æ€ä¹ˆåŠï¼Ÿé¡¹ç›®ç»„äººæ—¶ä½ è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ã€‚ å½“é¡¹ç›®å¼€å§‹æ—¶ï¼Œä»æ›´å¤§çš„èŒƒå›´å†…å¯»æ‰¾åˆé€‚çš„åŒå­¦ï¼Œè€Œä¸æ˜¯çœ‹ä½ å›¢é˜Ÿæœ‰å“ªäº›äººã€‚ å°†å‚ä¸é¡¹ç›®çš„åŒå­¦åœ¨ä¸€å®šæ—¶é—´å†…çš„æ±‡æŠ¥å…³ç³»å’Œç»©æ•ˆè€ƒæ ¸æ±‡æ€»åˆ°é¡¹ç›®ç»„ä¸­ï¼Œç”±é¡¹ç›®è´Ÿè´£äººæ ¹æ®å®é™…æƒ…å†µé‡æ–°å®‰æ’æ¯ä¸ªäººçš„æƒè´£ï¼Œå¹¶ç¡®å®šç»©æ•ˆçš„ç»‘å®šå…³ç³»ä¸æ¯”ä¾‹ã€‚ é¡¹ç›®äº¤ä»˜å¹¶ä¸ç­‰äºç»“æŸï¼Œæ‰€æœ‰äººçš„ç»©æ•ˆç»“æœéƒ½åº”å’Œé¡¹ç›®ç›®æ ‡çš„è¾¾æˆæƒ…å†µç´§å¯†ä¸”é•¿æœŸå…³è”ã€‚ æœ€åï¼Œæœ‰æ—¶ä¸ä»…è¦è§£å†³â€œç¼ºå…µâ€çš„é—®é¢˜ï¼Œè¿˜è¦è®¤çœŸè€ƒè™‘æ˜¯å¦â€œå°‘å°†â€ï¼Ÿè¦å……åˆ†è€ƒè™‘å½“å‰çš„äººå‘˜æ˜¯å¦é€‚åˆåšé¡¹ç›®çš„ Ownerï¼Œä»¥æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œé¡¹ç›® Owner å‡ ä¹å†³å®šäº†é¡¹ç›®æˆè´¥çš„ 80%ï¼Œå¦‚æœ Owner èƒ½åŠ›ä¸è¶³ï¼Œä½ è¦ç»™äºˆå¸®åŠ©å’Œæ”¯æŒï¼Œæˆ–è€…å¦æ‰¾ä»–äººï¼Œä¹ƒè‡³ä¸Šçº§çš„å¸®åŠ©ï¼Œä¸è¦åœ¨ Owner çš„äººé€‰ä¸Šå¦¥åï¼Œæ¯•ç«Ÿé¡¹ç›®æˆè´¥æ‰æ˜¯å…³é”®ã€‚ é—®é¢˜äºŒï¼šæ¨ä¸åŠ¨çš„åˆ°åº•æ˜¯äººè¿˜æ˜¯äº‹ï¼Ÿ ææ˜ç™½å†²çªç°è±¡ä¸‹çš„åˆ©ç›Šè¯‰æ±‚ï¼š ä¸åŒå…³è”æ–¹äº§ç”Ÿè§‚ç‚¹å†²çªçš„ç°è±¡èƒŒåå…¶å®æ˜¯åˆ©ç›Šå†²çªï¼Œä½ è¦ææ¸…æ¥šå½¼æ­¤çš„é¡¾è™‘ã€‚æ¯”å¦‚æˆ‘ä¸æ„¿æƒ³è®©æŸä¸ªç³»ç»Ÿå­—æ®µè½åˆ°è®¢å•ä¸­ï¼Œä¸»è¦æ˜¯è€ƒè™‘åˆ°è®¢å•ç³»ç»Ÿçš„å¯ç»´æŠ¤ä»¥åŠç¨³å®šæ€§ï¼Œå¦‚æœä½ èƒ½è§£å†³æˆ‘çš„é¡¾è™‘ï¼Œä¼šå®¹æ˜“è¯´æœæˆ‘ã€‚ ä¸ºé¡¹ç›®ç»“æœé€‚å½“å¦¥åï¼š åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•åšå‡ºå®Œç¾çš„æ–¹æ¡ˆï¼Œå¯èƒ½å°±æ˜¯è¦åœ¨ç³»ç»Ÿå†…é€šè¿‡å¾ˆç³Ÿç³•çš„å®ç°å»å®ç°éœ€æ±‚ã€‚é¡¹ç›®æ²¡æœ‰ 100% å®Œç¾ï¼ŒæŠ“ä½æ ¸å¿ƒåŸåˆ™ä¸æ”¾å¼ƒï¼Œå¯æ§éƒ¨åˆ†é€‚å½“å¦¥åæ¢å–é¡¹ç›®å‰è¿›æ˜¯å¾ˆå¥½çš„ç­–ç•¥ã€‚ é€šè¿‡é¡¹ç›®åœ°ä½å’Œå†³ç­–æœºåˆ¶æ¨åŠ¨é¡¹ç›®ï¼š å¤§é¡¹ç›®å¾€å¾€æ˜¯å…¬å¸é‡å¤§æˆ˜ç•¥ä¸‹çš„äº§ç‰©ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ä¼šæœ‰äººå»åå¯¹å…¬å¸çš„æŸé¡¹æ—¢å®šæˆ˜ç•¥ï¼Œè€Œä½ å¯ä»¥é€šè¿‡å¤§é¡¹ç›®çš„é‡è¦æ€§åœ¨ä½“ç³»å†…äº‰å–æ›´å¤šçš„èµ„æºå’Œå¸®åŠ©ã€‚å¦‚æœä½ é¢ä¸´ä¸€äº›å†²çªï¼Œè¦å­¦ä¼šåˆ©ç”¨å†³ç­–æœºåˆ¶ï¼Œé€šè¿‡æ›´é«˜çº§åˆ«æˆå‘˜çš„æ²Ÿé€šå†³ç­–æ‹¿åˆ°è§£å†³æ–¹æ¡ˆã€‚ é—®é¢˜ä¸‰ï¼šä¸€å®šä¼šæœ‰é¡¹ç›®å˜æ›´å—ï¼Ÿå¸¸è§çš„å˜åŒ–å¾€å¾€æœ‰ä¸¤ç§ï¼š é¡¹ç›®æ¼”è¿›è¿‡ç¨‹ä¸­è¯†åˆ«å‡ºä¹‹å‰æœªèƒ½è¯†åˆ«æˆ–è€ƒè™‘ç¼ºå¤±çš„ç‚¹ï¼Œå¯¼è‡´æ–¹æ¡ˆéœ€è¦è°ƒæ•´ã€‚ å‡ºè‡ªè€æ¿çš„éœ€æ±‚å˜æ›´ï¼Œå¾ˆå¤šæƒ…å†µä¸‹éƒ½æ˜¯è¦æ–°å¢å†…å®¹ã€‚ 3ä¸ªé‡ç‚¹ é©¾é©­å¤§é¡¹ç›®æ˜¯ä½ çš„è¯•é‡‘çŸ³å’Œåˆ†æ°´å²­ï¼Œå¯¹è‡ªå·±èŒä¸šè§„åˆ’æœ‰ä¸€å®šè¦æ±‚çš„åŒå­¦ä¸€å®šä¸è¦æ”¾è¿‡æ‰“ç£¨ä¿®ç‚¼çš„æœºä¼šã€‚ åœ¨å¤§é¡¹ç›®ä¸­ï¼Œå¾€å¾€äººçš„é—®é¢˜ä¼šæ¯”æŠ€æœ¯ä¸ç³»ç»Ÿçš„é—®é¢˜éš¾è§£å†³ï¼Œå› ä¸ºä¸äººç›¸å…³çš„é—®é¢˜æœªå¿…å®Œå…¨ç†æ€§å’Œé€»è¾‘ï¼Œé‚£ä¹ˆæ­¤æ—¶ä½ ä¹Ÿä¸å¦¨çœ‹çœ‹æ„Ÿæ€§çš„æ²Ÿé€šä¸äº¤æµæ˜¯ä¸æ˜¯æœ‰æ›´å¥½çš„æ•ˆæœã€‚ æ—¶åˆ»ç‰¢è®°ä½ å°†é¡¹ç›®æŒ‰æ—¶ä¸Šçº¿æ²¡æœ‰æ•…éšœåªæ˜¯åšåˆ°äº†60åˆ†ï¼Œæ›´å…³é”®çš„æ˜¯ä¸šåŠ¡æ•ˆæœï¼Œæ‰€ä»¥é™¤äº†ç›¯ç´§å¼€å‘è¿‡ç¨‹å¤–ï¼Œè¿˜è¦åœ¨æœ€å¼€å§‹çš„ä¸šåŠ¡ä¸äº§å“è®¾è®¡é˜¶æ®µå°±æŠ•èº«å…¶ä¸­ã€‚ ä¸šåŠ¡ç†è§£ï¼šæ·±å…¥ä¸šåŠ¡æ˜¯åšå¥½æ¶æ„çš„å‰æä¸ºä»€ä¹ˆæŠ€æœ¯è¦ç†è§£ä¸šåŠ¡ï¼Ÿäº§å“éœ€æ±‚ä¸ç­‰äºä¸šåŠ¡è¯‰æ±‚åŒæ ·çš„ï¼ŒæŠ€æœ¯ Leader å¯èƒ½ä¼šèŠ±æ—¶é—´å‚åŠ å„ç§ä¼šè®®ï¼Œå°¤å…¶æ˜¯äº§å“éœ€æ±‚çš„ä¼šï¼Œåœ¨ä¼šä¸Šå¦‚æœä»…ä»…æ˜¯å¬â€œè‡ªå·±å›¢é˜Ÿåº”è¯¥åšä»€ä¹ˆâ€ï¼Œè€Œæ²¡æœ‰æ€è€ƒå’Œæ¢ç©¶ä¸šåŠ¡çš„æ ¹æœ¬è¯‰æ±‚ï¼Œé‚£ä¹ˆå°±æˆ‘çš„ç»éªŒæ¥è¯´ï¼ŒæŠ€æœ¯å›¢é˜Ÿä¸å¯é¿å…çš„ä¼šæˆä¸ºå·¥å…·äººã€‚Leader ç¼ºä¹ç‹¬ç«‹æ€è€ƒï¼Œäººäº‘äº¦äº‘ï¼Œæœ€åæ•´ä¸ªå›¢é˜Ÿéƒ½ä¼šè¢«æ‹–ç´¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¤§å¤šæ•°ç ”å‘å›¢é˜Ÿè¢«äº§å“ä»¥åŠä¸šåŠ¡æŒ‰åœ¨åœ°ä¸Šæ‘©æ“¦çš„åŸå› ï¼ é¢†åŸŸå»ºæ¨¡çš„å‰ææ˜¯ç†è§£ä¸šåŠ¡æ­£å› ä¸ºæ²¡æœ‰ä»”ç»†çœ‹ä¸šåŠ¡çš„ç°çŠ¶ã€æ¨æµ‹ä¸šåŠ¡çš„å‘å±•ã€å»æ€è€ƒä¸šåŠ¡ä¸Šå¯¹äº¤æ˜“çš„è¯‰æ±‚ï¼Œæˆ‘ä»¬è®¤è¯†çš„åªæ˜¯ä¸€ä¸ªä¸ªéœ€æ±‚ï¼Œè€Œéæ•´ä½“çš„ä»ä¸šåŠ¡ç»´åº¦æ€è€ƒç³»ç»Ÿçš„è®¾è®¡ï¼Œå¯¼è‡´ç³»ç»Ÿå¤æ‚åº¦è¶Šæ¥è¶Šé«˜ã€‚æ‰€ä»¥è¦æƒ³è®¾è®¡å¯é ã€ç®€å•ã€çœŸæ­£å¯æŒç»­è¿­ä»£çš„ç³»ç»Ÿï¼Œæ·±åº¦ç†è§£ä¸šåŠ¡å°±æ˜¯å‰æï¼Œä½ å¯¹ä¸šåŠ¡çš„ç†è§£ç¨‹åº¦å½±å“äº†ä½ å¯¹ç³»ç»Ÿæœªæ¥å‘å±•çš„é¢„åˆ¤ç¨‹åº¦ã€‚ æå‡æŠ€æœ¯å›¢é˜Ÿçš„ä½¿å‘½æ„Ÿä½ å†™çš„æ¯ä¸€è¡Œä»£ç ï¼Œçº¿ä¸Šçš„æ¯ä¸€æ¬¡å‘å¸ƒï¼Œéƒ½ä¼šæ”¹å˜ç”¨æˆ·çš„ä½“éªŒï¼Œè§£å†³å®é™…çš„é—®é¢˜ï¼Œä½ å°±ä¼šå‘ç°è¿™ä»½å·¥ä½œçš„æ„ä¹‰ã€‚ å¦‚ä½•ç†è§£ä¸šåŠ¡ï¼Ÿ ä¸è¦ç›²ä¿¡äº§å“ï¼ˆä¸è¦ç›²ä¿¡äº§å“ä¸ PRDï¼Œåœ¨è®¨è®º PRD å’Œæ‰§è¡Œå¼€å‘ä»»åŠ¡ä¹‹å‰å­¦ä¼šç‹¬ç«‹æ€è€ƒï¼Œæ·±å…¥ç†è§£ä¸šåŠ¡æƒ³è¦è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œéœ€è¦ä»€ä¹ˆæ•ˆæœæˆ–ä½œç”¨ï¼Œä¸¥æ ¼æŠŠæ§é‚£äº›ä¼ªéœ€æ±‚å’Œæ— ä»·å€¼éœ€æ±‚ï¼Œé˜²æ­¢å®ƒä»¬ä¾µå å›¢é˜Ÿçš„æŠ€æœ¯èµ„æºã€‚ï¼‰ å»ºç«‹èµ°è¿›ä¸šåŠ¡çš„æœºåˆ¶ ä¸šåŠ¡ä¸Šå¤šå‚ä¼šå¤šç”»å›¾ï¼ˆå‚åŠ è¯„å®¡ä¼šï¼Œæ¢³ç†æµç¨‹å›¾ç­‰ç­‰ï¼‰ æ¶æ„è®¾è®¡ï¼šæ²»ç†å¥½ç³»ç»Ÿå¤æ‚åº¦æ‰æœ€åŠ¡å®æ²»ç†å¥½ç³»ç»Ÿå¤æ‚åº¦æ‰æœ€åŠ¡å®C.A.R. Hoareæ›¾è¯´è¿‡ï¼šâ€œè½¯ä»¶è®¾è®¡æœ‰ä¸¤ç§é£æ ¼ï¼Œä¸€ç§æ˜¯å°†è½¯ä»¶è®¾è®¡å¾—å¾ˆå¤æ‚ï¼Œä»¥ä½¿å…¶ç¼ºé™·æ²¡é‚£ä¹ˆæ˜æ˜¾ï¼›ä¸€ç§æ˜¯æŠŠè½¯ä»¶è®¾è®¡å¾—å¾ˆç®€å•ï¼Œä»¥ä½¿å…¶æ²¡æœ‰æ˜æ˜¾çš„ç¼ºé™·â€ã€‚ ç³»ç»Ÿçš„ç»“æ„æ¸…æ™°ã€å³ä½¿æ•´ä½“ç¹æ‚ä½†æ˜¯æ¯ä¸ªå±€éƒ¨éƒ½ç›¸å¯¹ç®€å•ã€é“¾è·¯å¹²è„†ç›´æ¥ï¼Œæ²¡æœ‰ä¸å¿…è¦çš„å†—ä½™ã€‚ è¡¡é‡å¤æ‚åº¦ ç†è§£æˆæœ¬é«˜ï¼šéœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½ç†è§£ç³»ç»Ÿæ¨¡å—çš„ç»„æˆåŠè¿ä½œï¼Œæ¯”å¦‚æ–°åŒå­¦åŠ å…¥æˆ–ç³»ç»Ÿäº¤æ¥æ—¶ï¼Œè€åŒå­¦å¾ˆéš¾è®²å®Œæ•´ã€æ–°åŒå­¦ä¸å®¹æ˜“å¬æ˜ç™½ï¼Œè¦å‡ å‘¨ç”šè‡³1~2ä¸ªæœˆæ‰èƒ½å®Œå…¨äº†è§£ç³»ç»Ÿçš„å®ç°å’Œè¿ä½œæœºç†ã€‚ å˜æ›´ç‰µè¿å¤šï¼šå“ªæ€•æ˜¯å®ç°ä¸€ä¸ªå°çš„éœ€æ±‚éƒ½è¦æ”¹é€ ç³»ç»Ÿçš„å¤šä¸ªéƒ¨åˆ†ã€ç”šè‡³å¤šä¸ªç³»ç»Ÿï¼ˆä¸Šä¸‹æ¸¸ç­‰ï¼‰ï¼Œæœ‰çš„è¿˜éœ€è¦åè°ƒå…¶ä»–å›¢é˜Ÿæˆ–éƒ¨é—¨ï¼Œç»“æœå¯¼è‡´è¿­ä»£æˆæœ¬é«˜ï¼Œå¹¶å¯èƒ½å¼•å…¥æ›´é«˜çš„é£é™©ã€‚ ä¸€å¼ å›¾è£…ä¸ä¸‹ï¼šå³ä½ æ— æ³•åœ¨ä¸€å—ç™½æ¿ä¸Šæ¸…æ™°ä¸”å®Œæ•´åœ°ç”»å‡ºç³»ç»Ÿä¸»è¦åŠŸèƒ½åœºæ™¯çš„æ¶æ„å›¾ï¼Œå¯èƒ½æ˜¯ç‰µè¿çš„ç³»ç»Ÿã€æœåŠ¡ã€ç»„ä»¶è¿‡å¤šæˆ–è€…é“¾è·¯è®¾è®¡ä¸åˆç†å¯¼è‡´çš„ã€‚ åŠ äººæ— æ³•è§£å†³é—®é¢˜ï¼šå³ä¾¿ä½ å¢åŠ äººå‘˜ä¹Ÿéš¾æé«˜ç³»ç»Ÿçš„äº¤ä»˜é€Ÿåº¦å’Œäº§å‡ºè´¨é‡ï¼Œæ¯”å¦‚åŸæœ¬3ä¸ªäººè´Ÿè´£ç³»ç»Ÿï¼Œå¢åŠ åˆ° 6 ä¸ªäººçš„äº¤ä»˜äº§å‡ºå¯èƒ½å’Œ 3 ä¸ªäººæ—¶æ‰€å·®æ— å‡ ï¼ŒåŸå› åœ¨äºå¤æ‚åº¦è¿‡é«˜å¹¶ä¸”ç³»ç»Ÿç»“æ„æ¨¡ç³Šï¼Œå¾ˆéš¾é€šè¿‡æ¸…æ™°çš„åˆ†å·¥è®©ç”Ÿäº§åŠ›æœ€å¤§åŒ–ã€‚ è€Œä½ å¯ä»¥ç»“åˆè¿™ 4 ç‚¹è¡¨ç°ç‰¹å¾ä»¥åŠè‡ªå·±çš„ä¸»è§‚æ„Ÿå—è¿›ä¸€æ­¥åˆ¤æ–­ç³»ç»Ÿçš„å¤æ‚åº¦æ˜¯å¦è¿‡é«˜ï¼Œå¦‚æœç³»ç»Ÿå¤æ‚åº¦è¿‡é«˜ï¼Œå¯èƒ½å¸¦æ¥ä¸€ç³»åˆ—é—®é¢˜ï¼šè¿­ä»£å‹åŠ›å¤§ã€ç»å¸¸å»¶æœŸã€ç¨³å®šæ€§é—®é¢˜é¢‘å‘ç­‰ã€‚è¿™æ—¶ï¼Œä½ è¦ç€æ‰‹æ²»ç†å¤æ‚åº¦ï¼Œå°½åŠ›ä¸è®©é—®é¢˜æ‰©å¤§åˆ°éš¾ä»¥è§£å†³åªèƒ½é‡åšç³»ç»Ÿçš„ç¨‹åº¦ã€‚ å¤æ‚åº¦æ²»ç†çš„æ€è·¯â€œé«˜å†…èšã€ä½è€¦åˆâ€ï¼Œç³»ç»Ÿç®€åŒ–å’Œåˆ†æ²»ã€‚ ç®€åŒ–å°±æ˜¯å»æ‰ä¸å¿…è¦çš„å¤æ‚ï¼Œè®©è®¾è®¡ä¸å®ç°ä¿æŒç®€å•ã€‚ åˆ†æ²»åˆ™æ˜¯å°†åŸæœ¬éš¾è§£å†³çš„é—®é¢˜ï¼Œæ‹†åˆ†åˆ°å¯è§£å†³çš„ç²’åº¦ï¼Œç„¶åå†é€ä¸€å‡»ç ´ã€‚ å¸¸è§çš„æ‹†åˆ†æ–¹å¼æ˜¯å‚ç›´æ‹†åˆ†å’Œæ°´å¹³åˆ†å±‚ï¼š å‚ç›´æ‹†åˆ†æŠŠå·®å¼‚æ˜ç¡®å¯ä»¥ç‹¬ç«‹è¿­ä»£çš„ä¸šåŠ¡æ‹†åˆ†å¼€ï¼›æ°´å¹³åˆ†å±‚æŠŠå…±æ€§çš„èƒ½åŠ›ä¸‹æ²‰éš”ç¦»ã€‚æ¯”å¦‚ç”µå•†åœºæ™¯ä¸­ï¼Œè´­ç‰©è½¦å’Œè®¢å•å¯ä»¥åˆ†æˆä¸¤ä¸ªæœåŠ¡ï¼Œå®ƒä»¬è™½ç„¶åœ¨ä¸šåŠ¡æµç¨‹ä¸Šå‰åå…³è”ï¼Œä½†æ˜¯å„è‡ªå…·å¤‡ç‹¬ç«‹å®Œæ•´çš„ä¸šåŠ¡åœºæ™¯å’Œç”Ÿå‘½å‘¨æœŸï¼Œå•†å“åŠ å…¥è´­ç‰©è½¦æœªå¿…ä¼šäº¤æ˜“ç”Ÿæˆè®¢å•ï¼Œå¯ä»¥å„è‡ªç‹¬ç«‹å­˜åœ¨ï¼›è€Œåº“å­˜å’Œå•†å“åˆ™æ˜¯å¼ºä¾èµ–çš„å…³ç³»ï¼Œåº“å­˜æ— æ³•ç‹¬ç«‹äºå•†å“å­˜åœ¨ã€‚ æ‹†åˆ†ä¸åˆå¹¶ä¸ç»å¯¹ï¼Œè¿‡åº¦åœ°æ‹†åˆ†ä¼šå¯¼è‡´ç³»ç»Ÿæ— æ³•é«˜å†…èšï¼Œé›¶æ•£åˆ†ç¦»çš„ç³»ç»Ÿï¼Œä¼šå¢åŠ ç¨³å®šæ€§é£é™©å’Œæ²»ç†ä¸è¿­ä»£çš„ä»£ä»·ï¼Œå¹¶ä¸”é€ æˆå¤§é‡çš„åä½œæˆæœ¬ã€‚Linusä¹Ÿæ›¾è¯´è¿‡ï¼šæŠŠå¤æ‚ç³»ç»Ÿæ‹†åˆ†æˆæ¨¡å—ï¼Œä¼¼ä¹æ²¡æœ‰é™ä½æ•´ä¸ªç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œå®ƒé™ä½çš„åªæ˜¯å­ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚è€Œæ•´ä¸ªç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œåè€Œä¼šç”±äºæ‹†åˆ†åçš„æ¨¡å—ä¹‹é—´ï¼Œä¸å¾—ä¸è¿›è¡Œäº¤äº’ï¼Œå˜å¾—æ›´åŠ å¤æ‚ã€‚ å¤æ‚åº¦æ²»ç†å®è·µ ç›¸æ¯” coding æ›´é‡è§†è®¾è®¡ æ°¸è¿œåš 2 å¥—ä»¥ä¸Šçš„æ–¹æ¡ˆ ä» MVP çš„è§†è§’è€ƒè™‘è®¾è®¡ï¼šä» MVP ï¼ˆæœ€å°å®Œæ•´ä¸šåŠ¡çš„è§’åº¦ï¼‰å»è€ƒè™‘ç³»ç»Ÿè¦å¦‚ä½•è®¾è®¡ä¸å®ç°ï¼Œå…ˆåšå‡æ³•å†åšåŠ æ³• å…³æ³¨ä¸Šä¸‹æ¸¸çš„å®ç° åšæŒâ€œæ—¥æ‹±ä¸€å’ æ²¡å¿…è¦ä¸€å®šæŠŠç³»ç»Ÿåšæˆä¸­å°æ²¡å¿…è¦ä¸€å®šæŠŠç³»ç»Ÿåšæˆä¸­å°ï¼Œä¸åšä¸­å°å°±ä¼šè½åæ›´æ˜¯æ— ç¨½ä¹‹è°ˆï¼Œä¸è¿‡ï¼Œä½ å¯ä»¥å€Ÿé‰´ä¸­å°çš„æ€è·¯ä½œä¸ºç³»ç»Ÿè®¾è®¡ä¸æ¼”è¿›ä¸Šçš„å½¢æ€å‚è€ƒã€‚ ç®¡ç†ä¸‰æ¿æ–§ï¼šæ‹¿ç»“æœã€å»ºå›¢é˜Ÿã€æ‹›è˜ä¸è§£è˜ å®šç›®æ ‡ï¼šè®©ä½ çš„æ–¹å‘ä¸å…¬å¸çš„æ–¹å‘ä¿æŒä¸€è‡´æ€ä¹ˆè§£è¯»ç›®æ ‡ï¼Ÿè§£è¯»ç›®æ ‡å°±æ˜¯è¦ç¡®ä¿è‡ªå·±åšçš„äº‹å„¿å’Œå…¬å¸çš„æ–¹å‘ä¸€è‡´ï¼Œé¡ºåŠ¿è€Œä¸ºï¼Œæ²¡æœ‰èµ°åï¼ˆè¿™é‡Œçš„â€œåŠ¿â€å°±æ˜¯å…¬å¸çš„æˆ˜ç•¥å’Œç›®æ ‡ï¼‰ï¼Œæ­£å› ä¸ºæœ‰äº†ç›®æ ‡æ‰æœ‰æ ¹æ®ç›®æ ‡åˆ¶å®šçš„ KPIï¼Œæ‰ä¼šæœ‰å›´ç»•ç›®æ ‡çš„æ‰§è¡ŒåŠ¨ä½œå’Œæœ€ç»ˆå–å¾—çš„ç»“æœã€‚ ç›®æ ‡ä¸æ˜¯ä¸€å¥å£å·ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸ªå±‚å±‚æ‹†è§£ã€é€’è¿›çš„è¿‡ç¨‹ã€‚è¯´ç™½äº†ï¼Œè§£è¯»ç›®æ ‡æ˜¯æŠŠå…¬å¸çš„æ–¹å‘å˜æˆä½ çš„æ–¹å‘ï¼ŒæŠŠä¸Šä¸€å±‚çš„é—®é¢˜è½¬å˜æˆä½ å¯ä»¥æ”¹å˜çš„é—®é¢˜ã€‚ ç¡®ä¿ç›®æ ‡è§£è¯»æ­£ç¡®æœ‰å¾ˆå¤šæŠ€å·§å’Œæ–¹æ³•ã€‚æ ¹æ®ç›®æ ‡é€å±‚åˆ†è§£çš„ç‰¹æ€§ï¼Œå¯ä»¥è€ƒè™‘å››ä¸ªæ–¹é¢ã€‚ ä½ çš„ä¸»ç®¡ï¼Œç¡®å®šä½ è€æ¿çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼› ä½ è‡ªèº«æ‰€åœ¨çš„å›¢é˜Ÿã€å›¢é˜Ÿçš„æˆå‘˜ä»¬ï¼Œæ ¹æ®å›¢é˜Ÿæƒ…å†µç¡®å®šç°çŠ¶ï¼› ä¸ä½ ç´§å¯†åˆä½œçš„ä¸Šä¸‹æ¸¸ï¼ˆç ”å‘ï¼‰ï¼Œæ¯”å¦‚ä½ æ˜¯åšè®¢å•ç³»ç»Ÿçš„ï¼Œé‚£ä¹ˆæ”¯æŒå±æ€§å¾ˆé‡ï¼Œå•†æˆ·ã€å¯¼è´­ã€ç”¨æˆ·å¾ˆå¤šç ”å‘å›¢é˜Ÿéƒ½æ˜¯ä½ çš„ä¸Šä¸‹æ¸¸å…³è”æ–¹ï¼› ç›´æ¥å¯¹å£çš„ä¸šåŠ¡ä¸äº§å“ï¼Œè¿™æ˜¯ä¸šåŠ¡ç›®æ ‡æ‹†è§£ã€ä¸šåŠ¡ç—›ç‚¹ã€å®¢æˆ·è¯‰æ±‚çš„ç›´æ¥æ¥æºæ–¹ã€‚ æ€ä¹ˆåˆ¶å®šç›®æ ‡ï¼Ÿç»“åˆ 4 ä¸ªå…³é”®ç‚¹æ¥è€ƒè™‘ï¼š â€œçŸ­é•¿â€ç»“åˆï¼šäº‹æƒ…åˆ†è½»é‡ç¼“æ€¥ï¼Œä½ ä¸€ç›´ç›¯ç€â€œæ€¥â€å’Œâ€œé‡â€ï¼Œâ€œè½»â€å’Œâ€œç¼“â€çš„äº‹æƒ…å°±ä¼šè½¬å˜æˆâ€œé‡â€å’Œâ€œæ€¥â€ï¼Œè¿›å…¥æ­»å¾ªç¯ã€‚ è¦è¶³å¤Ÿèšç„¦ï¼šå»ºè®®å…³é”®ç›®æ ‡ä¸è¦è¶…è¿‡ 3 ä¸ªï¼Œæœ€å¤šæ§åˆ¶åœ¨ 5 ä¸ªä»¥å†…ï¼Œè¦æ‰¾æœ€æœ‰å®¢æˆ·ä»·å€¼ã€å¯¹å…¬å¸æˆ˜ç•¥æœ€æœ‰å¸®åŠ©çš„ç‚¹ï¼Œç›®æ ‡è¶Šå°‘ã€æ–¹å‘è¶Šæ¸…æ™°ï¼Œå½“é—®é¢˜å‘ç”Ÿæˆ–è€…éœ€è¦åˆ¤æ–­æ—¶è¶Šå®¹æ˜“åšå†³ç­–ï¼Œåœ¨æœ‰é™çš„æ—¶é—´å†…åšå‡ºæ›´å¥½çš„ç»“æœã€‚ è¦æœ‰è¶³å¤Ÿçš„æŒ‘æˆ˜ï¼šç³»ç»Ÿå¯ç”¨æ€§å‡å¦‚å»å¹´æ˜¯ 3 ä¸ª 9ï¼Œä»Šå¹´è€ƒè™‘ä¸šåŠ¡ä¼šå‘å±•ä¿å®ˆèµ·è§è¿˜æ˜¯åŠ›ä¿ 3 ä¸ª 9ï¼Œè¿™æ ·çš„ç›®æ ‡æŒ‘æˆ˜æ€§å°±ä¸è¶³ï¼Œä¹Ÿæ— æ³•ä½“ç°æŠ€æœ¯çš„ä»·å€¼ã€‚è¿™ä¸ªåº¦é‡æ˜¯å¾ˆè€ƒéªŒä½ çš„ã€‚ è¦è®©ç»„ç»‡æœ‰æ²‰æ·€ã€ä¸ªäººæœ‰æˆé•¿ï¼šé€šè¿‡ä¸€ä¸ªä¸ªç›®æ ‡çš„å®Œæˆï¼Œè®©å‚ä¸çš„åŒå­¦å¾—åˆ°ä¸ªäººèƒ½åŠ›çš„æå‡ï¼Œæœªæ¥å¯ä»¥æ‰¿æ‹…æ›´å¤§çš„èŒè´£ï¼Œç»„ç»‡ä¹Ÿåœ¨è¿™ä¸ªè¿‡ç¨‹åšèƒ½åŠ›çš„ç§¯ç´¯ä¸æ²‰æ·€ã€‚ ç»“åˆä»¥ä¸Šå››ç‚¹ï¼Œå›´ç»•ç›®æ ‡å’Œå›¢é˜Ÿä¸€èµ·è®¨è®ºç­–ç•¥ä¸æ‰“æ³•ï¼Œå°†ç›®æ ‡æ‹†è§£æˆå‡ ä¸ªå…³é”®ä»»åŠ¡ï¼Œæ˜ç¡®åˆ°è´£ä»»äººï¼Œæ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼šå®šç­–ç•¥ã€æ‹†ä»»åŠ¡ã€ç»†åˆ°äººã€‚ æ€ä¹ˆä¼ é€’ç›®æ ‡ï¼Ÿå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä½ ä¼šå‘ç°ä¿¡æ¯ä¸å¯¹ç­‰ã€ä¼ é€’è¿‡ç¨‹ä¸­çš„æŸå¤±ã€ä¸ªäººç†è§£çš„å·®å¼‚ï¼Œç›´æ¥å¯¼è‡´ä¸æ˜¯æ‰€æœ‰äººéƒ½æ¸…æ¥šâ€œæˆ‘ä»¬è¦å¾€å“ªå»â€ã€‚ æœ€åï¼Œç›®æ ‡çš„ä¼ é€’æ˜¯ä¸€ä¸ªè¿è´¯çš„åŠ¨ä½œï¼Œè¦è½åˆ°æ—¥å¸¸çš„ç®¡ç†åŠ¨ä½œã€é‡ç‚¹é¡¹ç›®ä¸ä»»åŠ¡ã€KPI çš„è¿‡ç¨‹ç®¡ç†è¿™äº›å¹³æ—¥çš„ç‚¹æ»´ä¸­ã€‚ç›®æ ‡è¦åå¤è®²ï¼Œè¦ç»å¸¸å¯¹ç„¦ï¼Œé‡è¦çš„äº‹å„¿ï¼Œ3 éæ˜¯ä¸å¤Ÿçš„ï¼Œè¦è¯´â€œ300 éï¼â€ã€‚ æ‰€è°“çš„æ–¹å‘ä¸ç›®æ ‡å°±æ˜¯ï¼šä½ è¦å¾€å“ªå»ï¼Œä½ è¦èµ°å¤šè¿œï¼Œä½ è¦èµ°åˆ°å“ªã€‚æ¸…æ™°çš„ç›®æ ‡å°±å¥½æ¯”æ²™æ¼ ä¸­çš„æŒ‡å—é’ˆï¼Œè®©ä½ èƒ½æ¯”å…¶ä»–äººæ›´å¿«æ‰¾åˆ°æ°´æºå¹¶ç”Ÿå­˜ä¸‹å»ï¼Œä»Šå¤©è¿™èŠ‚è¯¾ï¼Œæˆ‘æé†’ä½ æ³¨æ„è¿™æ ·å‡ ç‚¹ï¼š è§£è¯»ç›®æ ‡éå¸¸é‡è¦ï¼Œåˆ‡å‹¿é™·å…¥æç«¯ï¼Œè¦ä¹ˆä¸è§£è¯»ï¼Œè¦ä¹ˆé¢†å¯¼è¯´ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆã€‚ åˆ¶å®šç›®æ ‡ä¸€å®šè¦å¤Ÿèšç„¦ï¼Œä½†åˆ‡å‹¿åªè€ƒè™‘çœ¼å‰ï¼Œæ³¨æ„â€œé•¿çŸ­ç»“åˆâ€ã€‚ æ³¨æ„ç›®æ ‡ä¼ é€’ï¼Œè¦å……åˆ†è€ƒè™‘å›¢é˜Ÿæˆå‘˜çš„æ„Ÿå—ï¼Œé€‰å–åˆé€‚çš„æ–¹å¼ã€‚ è¿½è¿‡ç¨‹ï¼šå¦‚ä½•ç”¨ PDCA åšè¿‡ç¨‹ç®¡ç†ï¼Ÿåªæœ‰æŒæ¡è¿‡ç¨‹ç®¡ç†çš„æ–¹æ³•ï¼Œæ‰ä¼šå°½å¯èƒ½å‡å°‘äº‹åŠ¡å¾€ä¸å¥½æ–¹å‘å‘å±•çš„æ³¢åŠ¨ï¼Œä»è€Œæ›´è½»æ¾ã€æ›´ä½é£é™©ã€æ›´ç¨³å¦¥åœ°å»æ‹¿åˆ°ç»“æœï¼Œè®©ä¸€åˆ‡å°½åœ¨æŒæ§ã€‚ ä»€ä¹ˆæ˜¯è¿‡ç¨‹ç®¡ç†ï¼Ÿç®¡ç†å°±æ˜¯è¿½æ±‚äº‹åŠ¡çš„å¯æŒç»­å‘å±•ï¼Œè€Œæƒ³è¦è¾¾æˆè¿™ä¸ªç›®æ ‡æœ‰ä¸¤ä¸ªåŸºæœ¬ç‚¹ï¼š ç®¡ç†åŠ¨ä½œè¦å½¢æˆå¯æŒç»­è¿­ä»£çš„é—­ç¯ï¼› ç®¡ç†åŠ¨ä½œè¶³å¤Ÿç®€å•åˆ°å¯ä»¥å¤åˆ¶å’Œä¸ªæ€§åŒ–å‡çº§ã€‚ è¿‡ç¨‹ç®¡ç†æ˜¯ä¸ºäº†è®©ä½ çš„æƒ³æ³•ã€çµæ„Ÿã€ä¸ç¨³å®šçš„å‘æŒ¥é€æ¸è§„å¾‹åŒ–ï¼Œå¯ä»¥æŒç»­è¿­ä»£è¢«ä½ åº”ç”¨ï¼Œå®ƒçš„æœ¬è´¨å°±æ˜¯å¸Œæœ›ç»“æœè¶Šæ¥è¶Šå¥½ï¼Œè®©ä½ åŸæœ¬é è¿æ°”æˆ–è€…æ¨¡ç³Šç»éªŒå¾—æ¥çš„æˆåŠŸå¯ä»¥è¢«å¤åˆ¶ï¼Œè®©ä½ åœ¨é¡¹ç›®ä¸­çµå…‰ä¸€é—ªçš„ Idea å˜æˆä½ çš„å¸¸è§„èƒ½åŠ›ã€‚ PDCA æ¨¡å‹ Planï¼ˆå®šè®¡åˆ’ï¼‰ï¼šå›´ç»•ç€ç›®æ ‡æ˜ç¡®é‡Œç¨‹ç¢‘ï¼Œç¡®å®šå…³é”®èŠ‚ç‚¹ï¼Œä¸æ‰§è¡Œçš„å‘˜å·¥è¾¾æˆå…±è¯†ã€‚ Doï¼ˆåšæ‰§è¡Œï¼‰ï¼šå¤šç»™å‘˜å·¥ç©ºé—´ã€å¤šèµ°åŠ¨ã€å¤šè§‚å¯Ÿã€å°‘å¹²é¢„ï¼Œæ”¾æ‰‹è€Œéæ”¾ä»»ï¼Œä½ ä¹Ÿä¸èƒ½ç½®èº«äº‹å¤–ã€‚ Checkï¼ˆå‹¤æ£€æŸ¥ï¼‰ï¼šç‹ æŠ“å…³é”®èŠ‚ç‚¹åšæ£€æŸ¥ã€é—®è¿›å±•ã€é—®å›°éš¾ã€ç»™å»ºè®®ã€åšè¾…å¯¼ã€åè°ƒèµ„æºã€‚ Actionï¼ˆå¤ç›˜è°ƒä¼˜ï¼‰ï¼šå°äº‹å°½å¿«å¤ç›˜ã€å¤§äº‹åˆ†é˜¶æ®µå¤ç›˜ã€äº‹åå…¨é¢å¤ç›˜ï¼ŒæŠ“ä½æ¯ä¸€æ¬¡æå‡å’Œä¼˜åŒ–çš„æœºä¼šã€‚ å¦‚ä½•ç”¨ PDCA åšè¿‡ç¨‹ç®¡ç†ï¼Ÿå¾ˆå¤šèƒ½åŠ›å’Œç»éªŒæ˜¯å†ç»ƒå‡ºæ¥çš„ï¼Œåªè¦è¿‡ç¨‹å¯æ§ï¼Œè¿‡ç¨‹ä¸­èµ°ä¸€äº›å¼¯è·¯ä¹Ÿæœªå¿…æ˜¯åäº‹ï¼Œè¦å…è®¸çŠ¯é”™ã€‚ä½†æ˜¯ä½ è¦æ³¨æ„ï¼Œæ”¾æ‰‹ä¸ç­‰äºæ”¾ä»»ï¼Œæ›´ä¸ç­‰äºä¸é—»ä¸é—®ï¼Œä½ ä¾ç„¶è¦å¯¹æœ€ç»ˆçš„ç»“æœè´Ÿè´£ã€‚ å¤ç›˜å‰ï¼šå¤ç›˜å‰çš„æ ¸å¿ƒåœ¨äºæ€è€ƒå¤ç›˜çš„ç›®çš„å’Œäº§å‡ºæ˜¯ä»€ä¹ˆã€‚å€Ÿæ­¤ï¼Œä½ æ‰å¯ä»¥æ˜ç¡®å¤ç›˜ä¼šè®®ä¸»è¦ä¼šèŠäº›ä»€ä¹ˆï¼Œå“ªäº›äººä¼šå‚åŠ ã€‚ å¤ç›˜ä¸­ï¼šè‡ªçœæ˜¯å¤ç›˜ä¼šçš„åŸºè°ƒï¼Œå¤ç›˜å°±ä¸€ä¸ªç›®çš„â€œæ‰¾åˆ°å›¢é˜Ÿçš„ä¸è¶³åŠ ä»¥æ”¹è¿›ï¼Œä»¥ä¾¿åœ¨æœªæ¥å–å¾—æ›´å¥½çš„ç»“æœâ€ã€‚æ‰€ä»¥æ¯ä¸ªäººæ²¡å¿…è¦ç”©é”…ï¼Œä¹Ÿæ²¡å¿…è¦å…¨ç›˜å¦å®šã€‚åœ¨å¤ç›˜çš„è¿‡ç¨‹ä¸­ï¼Œä¸€å®šè¦æŠŠé—®é¢˜æ‰¾å‡†ï¼Œå†…éƒ¨å¯¹é½ï¼Œè¾¾æˆæ‰€æœ‰äººçš„å…±è¯†ã€‚ å¤ç›˜åï¼šä¼šè®®æœ‰ç»“è®ºï¼Œç»“è®ºæœ‰è®¡åˆ’ï¼Œè®¡åˆ’æœ‰è´£ä»»äººï¼Œè´£ä»»äººæœ‰è¡ŒåŠ¨ï¼Œè¦å»ºç«‹æœºåˆ¶ä¿è¯åœ¨å¤ç›˜ä¼šä¸Šè®¨è®ºå‡ºçš„ç»“è®ºèƒ½å¤Ÿè½åœ°ã€‚ æ€»çš„æ¥è¯´ï¼Œå°äº‹å„¿å°½å¿«å¤ç›˜ï¼Œå€Ÿæ­¤å‘å›¢é˜Ÿæˆå‘˜ä¼ æˆè‡ªå·±çš„ç»éªŒï¼›å¤§äº‹å„¿åˆ†é˜¶æ®µå¤ç›˜ï¼ŒæŠ“ä½é‡ç‚¹çŸ›ç›¾ï¼Œæ¨åŠ¨äº‹æƒ…çš„é¡ºåˆ©å‘å±•è€Œéè¿½æ±‚å®Œç¾ï¼›äº‹åå…¨é¢å¤ç›˜ï¼Œä¸ç®¡å¯¹ä¸ªäººè¿˜æ˜¯å›¢é˜Ÿï¼Œæ‰¾è‡ªå·±çš„é—®é¢˜éƒ½æ˜¯ ROI æœ€é«˜çš„æ–¹å¼ï¼Œæ‰¾åˆ°é—®é¢˜çš„ä¸€æ–¹æ‰æœ‰æ”¹å–„æå‡çš„å¯èƒ½ã€‚ ä¸‰ä¸ªé‡ç‚¹ï¼š ç›®æ ‡ä¸ä¼šè‡ªå·±é•¿è…¿èµ°å‘ç»ˆç‚¹ï¼Œä½ ä¸€å®šè¦åšå¥½è¿‡ç¨‹ç®¡ç†ä»¥å–å¾—å¯é çš„ç»“æœã€‚ è¿½è¿‡ç¨‹ä¸æ„å‘³ç€äº‹æ— å·¨ç»†éƒ½è¦åšï¼Œè¿½å“ªäº›ã€ä»€ä¹ˆæ—¶å€™è¿½ã€è¿½åˆ°ä»€ä¹ˆç¨‹åº¦æ‰æ˜¯ä½ æ›´åº”è¯¥å…³å¿ƒçš„ã€‚ å¤ç›˜æ˜¯ PDCA ç®¡ç†åŠ¨ä½œä¸­çš„é—­ç¯ï¼Œå¦‚æœæ¯æ¬¡éƒ½èƒ½æé«˜ä¸€ç‚¹ç‚¹ï¼Œé•¿æœŸç§¯ç´¯çš„å˜åŒ–å°±å¾ˆå¤§äº†ã€‚ å¥–ä¼˜ç½šåŠ£ï¼šæ€æ ·ä¼ é€’æˆ‘ä»¬â€è¦ä»€ä¹ˆâ€ä¸â€œä¸è¦ä»€ä¹ˆâ€ï¼Ÿâ€œå¥–ä¼˜ç½šåŠ£â€ä¹‹æ‰€ä»¥é‡è¦ï¼Œæ˜¯å› ä¸ºå®ƒèƒ½è®©å›¢é˜Ÿå½¢æˆå¯æŒç»­å‘å±•çš„æ°›å›´ï¼Œæ˜¯æ‹¿ç»“æœçš„é—­ç¯ã€‚è€Œæˆ‘ä»¬åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­è¦æ³¨æ„çš„å°±æ˜¯ï¼šå¼•å¯¼äººæ€§è€Œéå¯¹æŠ—äººæ€§ã€‚ ä»€ä¹ˆæ˜¯å¥–ä¼˜ã€ç½šåŠ£å¥–ä¼˜æœ€ç»ˆä¼šè½åˆ°ç‰©è´¨å’Œç²¾ç¥ä¸Šï¼š ç‰©è´¨ä¸Šçš„å¥–ä¼˜ä½œç”¨å¤§ï¼Œä½†æ˜¯é¢‘æ¬¡è¾ƒä½ï¼Œæ¯”å¦‚ä»¥åŠå¹´/å¹´ä¸ºå•ä½çš„æ™‹å‡ã€è°ƒè–ªï¼Œå®ƒèƒ½å¤Ÿæ‰“å¼€æˆå‘˜çš„å¤©èŠ±æ¿ï¼Œæ¯”å¦‚æ‹¿äº†Aç»©æ•ˆçš„åŒå­¦ï¼Œç¬¬äºŒå¹´ä»–ä¾ç„¶å¸Œæœ›æ˜¯Aè€Œä¸æ˜¯Bï¼Œä»è€Œæé«˜å¯¹è‡ªå·±çš„è¦æ±‚ä¸æœŸæœ›ï¼Œæ›´å®¹æ˜“å–å¾—å¥½çš„æˆç»©ã€‚ ç²¾ç¥ä¸Šçš„å¥–ä¼˜ä½“ç°åœ¨æ—¥å¸¸è¡Œä¸ºä¸Šï¼Œé¢‘æ¬¡è¾ƒé«˜ï¼Œæ¯”å¦‚ä½ å…³æ³¨å’Œè‚¯å®šæŸä½æˆå‘˜çš„è¡Œä¸ºï¼Œåœ¨å›¢é˜Ÿå†…é€šè¿‡é‚®ä»¶ã€é’‰é’‰ç­‰æ–¹å¼ç®€å•é¼“åŠ±æ¨å¹¿ä»–çš„è¡Œä¸ºã€‚ ç½šåŠ£ä¹Ÿä¼šè½åˆ°ç‰©è´¨å’Œç²¾ç¥ä¸Šï¼Œä½†å®ƒæ˜¯åŠ¨ä½œè€Œéç›®çš„ï¼Œä½ è¦é€šè¿‡ç½šåŠ£æ¥ä¼ é€’å›¢é˜Ÿä¸èƒ½å®¹å¿ä»€ä¹ˆæ ·çš„è¡Œä¸ºï¼Œä»¥æ­¤æé†’ã€é­ç­–å¤§å®¶ã€‚å¥–ä¼˜å’Œç½šåŠ£æ˜¯ç›¸äº’ä¾èµ–çš„ã€‚ â€œå¥–ä¼˜ç½šåŠ£â€çš„è¯¯åŒºï¼š æ²¡æœ‰æ„è¯†åˆ°å¥–ä¼˜ç½šåŠ£çš„ç¤ºèŒƒä½œç”¨ã€‚ ä½ è¦æŠŠâ€œå¥–ä¼˜ç½šåŠ£â€å½“ä½œå®£ä¼ åŠ¨ä½œï¼ŒæŠŠç»“æœè¾æ•£å‡ºå»ï¼Œå¼•å¯¼å›¢é˜Ÿé£å‘ã€‚ æ³¨é‡ç½šåŠ£ï¼Œå¿½ç•¥å¥–ä¼˜ã€‚ å¥–æƒ©åŠ¨ä½œè¿‡äºå„¿æˆï¼Œå®¹æ˜“è¢«æ»¥ç”¨ï¼šâ€œå¥–æƒ©åŠ¨ä½œâ€è¦å»ºç«‹åœ¨å°Šé‡çš„åŸºç¡€ä¸Šï¼Œè®©æˆå‘˜æœ‰æ”¶è·å’Œåæ€ã€‚ å¥–ä¼˜ç½šåŠ£çš„å…³é”®åŠ¨ä½œç»©æ•ˆè€ƒæ ¸æˆ‘ä»¬è¦ä»ä¸€å¼€å§‹è¢«ä¸»è§‚å› ç´ å½±å“ï¼Œé€æ¸è®¤è¯†åˆ°å®¢è§‚çš„ç¯å¢ƒä¸ç°å®ï¼Œæœ€ç»ˆåœ¨ç†æ€§ä¸äººæ€§ä¸­å¯»æ‰¾ä¸€ä¸ªå¹³è¡¡ï¼Œè®©å¤§å®¶çœ‹åˆ°ä»˜å‡ºå’Œèƒ½åšå‡ºå¥½æˆç»©çš„åŒå­¦ï¼Œå›æŠ¥æ˜¯è¿œè¿œé«˜äºå…¶ä»–äººçš„ï¼Œå¯¹äºæ‹–æ•´ä½“åé€€ã€æŒç»­ä¸èƒ½æ”¹å–„çš„åŒå­¦ï¼Œå›¢é˜Ÿæ˜¯ä¸æ¬¢è¿çš„ã€‚ ç»©æ•ˆé¢è°ˆç»©æ•ˆé¢è°ˆçš„æ ¸å¿ƒå‡ºå‘ç‚¹æ˜¯é€šè¿‡è¿™æ¬¡ç»©æ•ˆçš„ç»“æœæ”¹å˜æŸäº›è¡Œä¸ºä¸è®¤è¯†ï¼Œè®©å›¢é˜Ÿåœ¨æœªæ¥å–å¾—æ›´å¥½çš„æˆç»©ï¼Œå¹¶ä¸æ˜¯å•çº¯åœ°é€šçŸ¥ç»“æœã€‚ é¢è°ˆæµç¨‹ï¼š å¼€åœºå®šåŸºè°ƒ å‘˜å·¥è‡ªè¯„ ä¸»ç®¡è¯„ä»· å¯¹ç„¦å…±è¯† é¢è°ˆæ€»ç»“ åç»­è·Ÿè¿› è–ªé…¬æ¿€åŠ±ä¸‰ä¸ªåŸºæœ¬åŸåˆ™ï¼š é—®è‡ªå·±æ˜¯å¦æ•¢å°†èµ„æºåˆ†é…çš„é€»è¾‘ä¸è§„åˆ™åœ¨é˜³å…‰ä¹‹ä¸‹è®²å‡ºæ¥ã€‚ ä¸è¦æ’’èƒ¡æ¤’é¢ï¼Œä¹Ÿåˆ«åšå¤§é”…é¥­ï¼Œè®©å¥½çš„ç»“æœè¶…å‡ºé¢„æœŸã€‚ é¢å‘æœªæ¥è€Œéç°åœ¨å»åšè€ƒè™‘ ç‰¢è®°èµ„æºæ€»æ˜¯æœ‰é™çš„ï¼Œèµ„æºåˆ†é…æœ¬èº«æ˜¯åšå¼ˆï¼Œæœ‰äººå¤šå°±è¦æœ‰äººå°‘ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¹³å‡åˆ†é…çš„ç»“æœä¸æ˜¯æ™®å¤©åŒåº†ï¼Œè€Œæ˜¯æ‰€æœ‰äººéƒ½ä¸æ»¡æ„ï¼Œæ¯ä¸ªäººéƒ½è§‰å¾—å°‘ã€‚ä¸å…¶å¦‚æ­¤ï¼Œä¸å¦‚æŠŠèµ„æºå€¾æ–œåˆ°é‚£äº›ä½ å›¢é˜Ÿæœ€ä¼˜ç§€ã€ç»©æ•ˆæœ€å¥½çš„åŒå­¦èº«ä¸Šï¼Œè®©ä»–ä»¬å¾—åˆ°é¢„æœŸçš„æ”¶ç›Šç”šè‡³è¶…å‡ºé¢„æœŸã€‚ å‹¤æ²Ÿé€šï¼šåœ¨ä¿¡ä»»çš„åŸºç¡€ä¸Šï¼Œè®©æ²Ÿé€šç®€å•ä¸”çº¯ç²¹è¦çŸ¥é“ï¼Œæ²Ÿé€šæ˜¯æœ‰ç›®çš„çš„ï¼Œæ—¢ç„¶æ²Ÿé€šçš„å¯¹è±¡æ˜¯äººï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›é€šè¿‡æ²Ÿé€šå»è¾¾åˆ°ä¸€å®šçš„ç»“æœï¼ˆæ•ˆæœï¼‰ï¼Œé‚£ä¹ˆå°±è¦æ‡‚å¾—ä¸€å®šçš„é“ç†ä¸æŠ€å·§ã€‚ æ²Ÿé€šçš„æ ¸å¿ƒåŸåˆ™æ²Ÿé€šæ˜¯å†…å¿ƒæƒ³æ³•å’Œæ€è€ƒé€»è¾‘çš„å¤–å»¶ï¼Œå¦‚æœä½ æœ‰è‰¯å¥½çš„æ²Ÿé€šèƒ½åŠ›ï¼Œå¯ä»¥åœ¨æ•´ä¸ªå›¢é˜Ÿä¸­è¥é€ å…¬å¼€é€æ˜çš„ä¿¡ä»»æ°›å›´ï¼Œè®©ä¿¡æ¯é€æ˜çš„åŒæ—¶ï¼Œä¹Ÿè®©å›¢é˜Ÿæˆå‘˜æ„¿æ„å‘å‡ºè‡ªå·±çš„å£°éŸ³ã€‚ æ²Ÿé€šæ ¸å¿ƒåŸåˆ™çš„å®šä¹‰æ˜¯ï¼šåœ¨ç›¸ä¿¡å¯¹æ–¹çš„åŸºç¡€ä¸Šï¼Œè®©æ²Ÿé€šæ°›å›´å˜å¾—â€œç®€å•ä¸”çº¯ç²¹â€ã€‚ ä¸åŒç»´åº¦çš„æ²Ÿé€šå‘ä¸Šæ²Ÿé€šæœ‰èƒ†é‡ã€å¹³è¡Œæ²Ÿé€šæœ‰è‚ºè…‘ã€å‘ä¸‹æ²Ÿé€šæœ‰å¿ƒè‚ã€‚ å‘ä¸Šæ²Ÿé€šè¦æœ‰æŠ€å·§ã€æœ‰åŸåˆ™ï¼Œè®¤æ¸…æ²Ÿé€šçš„ç›®æ ‡ä¸ç›®çš„ï¼Œä¸è½»æ˜“å¦¥åå¯¼è‡´æ›´ä¸¥é‡çš„åæœã€‚ å…³äºå¹³è¡Œæ²Ÿé€šæœ‰è‚ºè…‘æ˜¯æŒ‡ä½ è¦çœŸè¯šæ²Ÿé€šï¼Œä¸è¦æ²¹æ»‘å¥—è·¯ã€‚ å‘ä¸‹æ²Ÿé€šæœ‰å¿ƒè‚æ˜¯æŒ‡æœ‰åŒç†å¿ƒï¼Œæœ‰å°Šé‡çš„åŒæ—¶è¦æ„ŸåŒèº«å—ã€‚ ä¸¤ä¸ªå…·ä½“çš„æ²Ÿé€šåœºæ™¯One One æ²Ÿé€š æ¥åœ°æ°”ï¼Œè¯´äººè¯ è§†äººä¸ºäºº æ²Ÿé€šè¦â€œå‹¤â€ å›¢é˜Ÿæ²Ÿé€šä¸One Oneæ²Ÿé€šä¸åŒçš„æ˜¯ï¼Œå›¢é˜Ÿæ²Ÿé€šå—äººæ•°çš„é™åˆ¶ï¼Œæ˜¯ä¸€å¯¹å¤šçš„æ²Ÿé€šï¼Œæ‰€ä»¥é™¤äº†å‚è€ƒOneOneæ²Ÿé€šçš„æ ¸å¿ƒç‚¹å¤–ï¼Œä½ æœ€å…³é”®çš„åº”è¯¥æ˜¯æ­åœºå­ï¼Œå‘èµ·å›¢é˜Ÿæ²Ÿé€šã€‚ å›¢é˜Ÿæ²Ÿé€šç›®çš„æ€§æ›´å¼ºï¼Œé¢‘æ¬¡ä¸é«˜ï¼Œè€ƒéªŒä½ çš„æ§åœºèƒ½åŠ›ã€‚ å»ºæœºåˆ¶ï¼šè§„åˆ™æµç¨‹è¶Šå»ºè¶Šå¤šï¼Œä¸ºä½•æ•ˆæœå´è¶Šæ¥è¶Šå·®ï¼Ÿæœºåˆ¶å‘æŒ¥ä»€ä¹ˆä½œç”¨ï¼Ÿä¸¤ç±»æœºåˆ¶ï¼š ä¸ç®¡ç†ç›¸å…³ï¼š æ¯”å¦‚ä¸ºäº†ä¿¡æ¯äº’é€šï¼Œçº¦å®šæ¯å‘¨å›ºå®šæ—¶é—´é€šè¿‡é‚®ä»¶ã€ä¼šè®®ã€IM ç­‰æ–¹å¼ï¼Œå°†æå‰å®šä¹‰å¥½çš„ä¿¡æ¯åšä¸€ä¸ªæ±‡æ€»äº¤äº’ï¼ˆè¡¨ç°ä¸ºå‘¨æŠ¥ã€å‘¨ä¼šç­‰ï¼‰ï¼Œè¿™å°±æ˜¯æœºåˆ¶çš„ä¸€ç§å…·ç°ã€‚ ä¸æŠ€æœ¯ç›¸å…³ï¼š æ¯”å¦‚ä¸ºäº†å¤šäººååŒï¼Œåˆ¶å®šå¼€å‘æµç¨‹ã€Bug å¤„ç†ã€å‘å¸ƒä¸Šçº¿æµç¨‹ï¼Œç”šè‡³åœ¨æ—¥å¸¸å®é™…å¼€å‘çš„å·¥ä½œä¸­ï¼Œå¾€å¾€ä¹Ÿå…ˆå®šä¹‰ API å¥‘çº¦ï¼Œç„¶ååœ¨è”è°ƒæµ‹è¯•æ—¶å†çœŸæ­£å®ç°éªŒè¯ï¼Œè¿™äº›çº¦å®šã€å¥‘çº¦ã€æµç¨‹éƒ½æ˜¯å¯¹åº”æœºåˆ¶åœ¨è½åœ°æ—¶çš„å…·ä½“è¡¨ç°ã€‚ ç«™åœ¨å›¢é˜Ÿçš„è§’åº¦ï¼Œå»ºæœºåˆ¶å°¤ä¸ºé‡è¦ï¼Œä½ è¦é€šè¿‡æœºåˆ¶è®©å›¢é˜Ÿæœ‰ç»Ÿä¸€çš„è¡Œä¸ºä¸è§„åˆ™ï¼Œè®©ç»„ç»‡åƒäººä¸€æ ·ï¼Œè¨€è¡Œä¸¾æ­¢æœ‰è§„å¾‹å¯å¾ªã€‚ å¦‚ä½•è®¾è®¡ä¸€ä¸ªå¥½çš„æœºåˆ¶ï¼Ÿ è§„åˆ™ç»Ÿä¸€ï¼Œä¸è‡ªç›¸çŸ›ç›¾ ç®€å•æœ‰æ•ˆï¼Œä¾¿äºå¢åˆ  ç´§ç›¯æ•´ä½“ç»“æœï¼Œæœºåˆ¶çš„ ROI è¦è¶³å¤Ÿé«˜ æœºåˆ¶è¦æ€ä¹ˆè½åœ°ï¼Ÿ å…ˆè¯´ whyï¼š å³æœºåˆ¶çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿä½ åœ¨è®¾è®¡æœºåˆ¶æ—¶æ˜¯å¦‚ä½•æ€è€ƒçš„ï¼Ÿ å…±è¯†çš„è¦ä¸ä¸è¦ï¼š å’Œå¤§å®¶è®¨è®ºæˆ‘ä»¬è¦ä¸è¦è¿™æ ·åšï¼Ÿçœ‹çœ‹å¤§å®¶æ˜¯æ€ä¹ˆæƒ³çš„ï¼Œé€šè¿‡å¯¹è¯å’Œå¼•å¯¼å½¢æˆä¸€å®šçš„ç»“è®ºï¼Œæœ‰äº›å†…å®¹éœ€è¦ä¿ç•™ï¼Œæœ‰äº›ä¸åˆç†éœ€è¦å‰”é™¤ï¼Œä¿ƒæˆç»“è®ºæœ€ä¸ºé‡è¦ã€‚ æ‰¿è¯ºè¡Œä¸ºä¸¾æ­¢ï¼š ç¡®è®¤æœºåˆ¶ä¹‹åï¼Œéœ€è¦è®©ç»“è®ºå½¢æˆå¯¹å„è‡ªè¡Œä¸ºçš„çº¦æŸã€‚æ¯”å¦‚ä¸åŒçš„æˆå‘˜è®¤é¢†ä¸åŒçš„è§’è‰²å’Œä»»åŠ¡ï¼Œæˆ–è€…åœ¨ IM ä¸­ä¸€èµ·å…¬å‘Šè§„åˆ™ï¼Œæ€»ä¹‹æ¯ä¸ªæˆå‘˜è¦ä¸æœºåˆ¶çš„å‚ä¸æ„Ÿã€‚ å…ˆè€ƒè™‘ç›®çš„ï¼Œ CodeReview ä¸»è¦æ˜¯è§£å†³ä¸¤æ–¹é¢çš„é—®é¢˜ï¼šæé«˜ä»£ç è´¨é‡ï¼›å¸®åŠ©å¼€å‘åŒå­¦è®¤è¯†åˆ°å¦‚ä½•å†™å‡ºæ›´å¥½çš„ä»£ç ã€‚ ä¸åŒçš„ä¾§é‡ç‚¹è®¾è®¡å‡ºæ¥çš„æœºåˆ¶ä¹Ÿæœ‰æ‰€ä¸åŒï¼ŒæŒ‰ç…§æˆ‘çš„ç†è§£ï¼ŒCodeReview çš„ä¸»è¦ä½œç”¨è¿˜æ˜¯å¸®åŠ©å¤§å®¶æˆé•¿ï¼Œæ‰“é€ å›¢é˜Ÿå†…çš„æŠ€æœ¯æå‡æ°›å›´ï¼Œæ¬¡è¦æ‰æ˜¯ä¿ƒè¿›äº§å“è´¨é‡çš„æå‡ã€‚ ç¡®å®šäº†æ ¸å¿ƒæƒ³è¦è¾¾æˆçš„æ•ˆæœï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç€æ‰‹ç¡®å®šæœºåˆ¶çš„å†…å®¹ï¼Œè¿™é‡Œé¢è¦è€ƒè™‘å‡ ä¸ªæ–¹é¢çš„å†…å®¹ï¼šå¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ï¼ˆé˜»åŠ›ï¼‰ã€æœºåˆ¶å®æ–½çš„æˆæœ¬ã€æœºåˆ¶è¿è¡Œçš„æ—¶æœºå’Œå‘¨æœŸã€ç«™åœ¨ä¸€ä¸ªæœºåˆ¶å‚ä¸è€…çš„è§’åº¦è€ƒè™‘ä»–è¦åšä»€ä¹ˆã€‚ å…·ä½“ CodeReview çš„æœºåˆ¶æ–¹æ¡ˆå¯ä»¥å‚è€ƒä¸‹å›¾ï¼š çŸ¥äººå–„ç”¨ï¼šå€Ÿäº‹ä¿®äººï¼Œå€Ÿäººæˆäº‹çŸ¥äººå–„ç”¨çš„ä¸‰ä¸ªå…³é”®ç‚¹ æ‰¾å¯¹äºº åŸ¹å…»äºº å…»æˆäºº æ€ä¹ˆè½åœ°æ‰§è¡Œï¼Ÿ å›¢é˜Ÿç›˜ç‚¹ æ¿€å‘æ„æ„¿ æ”¹å–„è®¡åˆ’ tips ä¸æ€•æ²¡ç¼ºç‚¹ï¼Œå°±æ€•æ²¡ç‰¹ç‚¹ï¼š ä½ å€Ÿäººæˆäº‹ï¼Œä¸èƒ½ä¸€å‘³åœ°å…³æ³¨ä»–çš„ç¼ºç‚¹ï¼Œè€Œæ˜¯è¦å¯»æ‰¾å…¶ç‰¹ç‚¹ï¼Œå‘æŒ¥ä»–çš„æ“…é•¿ç‚¹ï¼Œæœ‰ç¼ºç‚¹ä¸å¯æ€•ï¼Œå°±æ€•æ²¡ç‰¹ç‚¹ã€‚ æ–°äººåšè€äº‹ï¼Œè€äººåšæ–°äº‹ï¼š å¦‚æœåœ¨å›¢é˜Ÿä¸­è€äººä¸€ç›´åšè€äº‹ï¼Œæ–°äººåšæ–°äº‹ï¼Œé‚£ä¹ˆä¼šå‡ºç°è€äººæ²¡æœ‰æ–°çš„æé«˜ï¼Œæ–°äººä¹Ÿè¦å…‹æœå¾ˆå¤šæœªçŸ¥çš„å›°éš¾ï¼›åä¹‹ï¼Œå¯ä»¥é‡æ–°æ¿€å‘è€äººçš„æ´»åŠ›ï¼Œä¹Ÿè®©æ–°äººæœ‰å€Ÿé‰´ä¹‹å¤„ã€‚ ä¸è¦è¶Šä¿ä»£åº–ï¼Œä»€ä¹ˆéƒ½è‡ªå·±ä¸Šï¼š ç”¨äººçš„è¿‡ç¨‹ä¸­ä¼šå‡ºç°â€œäº‹æƒ…åšé”™â€çš„æƒ…å†µï¼Œä¸€æ—¦ä½ å‘ç°è¿™æ ·çš„æƒ…å†µï¼Œåƒä¸‡ä¸è¦ç›´æ¥å»å¸®ä»–çº æ­£ï¼Œè¿™æ ·æ— æ³•å¸®åŠ©å›¢é˜Ÿæˆå‘˜æˆé•¿ï¼Œå›¢é˜Ÿæˆå‘˜åªä¼šå½“çŠ¯é”™è¯¯æ—¶ï¼Œç­‰ç€ä½ æ¥å¸®ä»–è§£å†³ã€‚å¥½çš„ Leaderä¸€å®šæ˜¯è¦åœ¨æ˜çŸ¥å‰æ–¹æœ‰å‘ï¼ˆè¿™ä¸ªå‘ä¸€å®šæ˜¯ä½ èƒ½æ§åˆ¶çš„ï¼‰çš„æƒ…å†µä¸‹ï¼Œä¹Ÿè¦è®©å›¢é˜Ÿæˆå‘˜å»è¸©ä¸€å›ï¼Œè®©å…¶æœ‰è¯•é”™çš„æœºä¼šï¼Œè®©æ¯ä¸ªé”™è¯¯éƒ½ç‰©æœ‰æ‰€å€¼ã€‚ ç»™æœºä¼šçš„åŒæ—¶ï¼Œç»™å‹åŠ›å’Œå¸®åŠ©ï¼š å¾ˆå¤šæ—¶å€™å‹åŠ›æ˜¯æˆé•¿çš„å‚¬åŒ–å‰‚ï¼Œæœ‰äº†å‹åŠ›ä¹Ÿå°±æœ‰äº† 120% çš„åŠ¨åŠ›ï¼Œæ‰€ä»¥æŠŠæŸä¸ªä»»åŠ¡æˆ–èŒè´£ç»™åˆ°ä¸€ä¸ªåŒå­¦çš„æ—¶å€™ï¼Œä¹Ÿè¦æŠŠé€‚å½“çš„å‹åŠ›ä¼ é€’è¿‡å»ï¼Œè®©ä»–æ„Ÿå—åˆ°äº‹æƒ…çš„é‡è¦æ€§ã€‚ä¸æ­¤åŒæ—¶ï¼Œæ—¶åˆ»å…³æ³¨ï¼Œè¯¥ç»™çš„å¸®åŠ©ä¸€å®šè¦ç»™åˆ°ï¼Œä¸èƒ½ä¸é—»ä¸é—®ã€‚ æ—¢æ•¢äºæ‰¿è®¤é”™è¯¯ï¼Œä¹Ÿå…è®¸åˆ«äººçŠ¯é”™ï¼š è®©ä¸€ä¸ªäººæˆé•¿ä¸å¯èƒ½å®Œå…¨ä¸è®©ä»–çŠ¯é”™ï¼Œæœ‰æ—¶ä¸€äº›å¯æ§çš„é”™è¯¯åè€Œå¯èƒ½æ˜¯äº‹åçœ‹æœ€å¤§çš„æ”¶è·ã€‚åŒæ—¶ï¼Œä¹Ÿä¸è¦è®¤å®šè‡ªå·±ä¹‹å‰çš„åšæ³•éƒ½æ˜¯å¯¹çš„ï¼Œè¦æ„è¯†åˆ°ï¼Œå“ªæ€•ä½ ä¹‹å‰åšæˆåŠŸè¿‡ï¼Œä¹Ÿä¸æ„å‘³ç€ä½ å°±ä¸€å®šæ˜¯100%æ­£ç¡®çš„ã€‚å¥½çš„ Leader åœ¨åŸ¹å…»å›¢é˜Ÿæˆå‘˜æ—¶ï¼Œæ—¢è¦è®©å›¢é˜Ÿä¸æ€•çŠ¯é”™ï¼ˆæ•¢å¹²äº‹ï¼‰ï¼Œä¹Ÿè¦æ•¢äºæ‰¿è®¤è‡ªå·±ä¸è¶³ï¼Œå»æ”¹å–„å»æé«˜ã€‚ æ‰¾åˆ°äººï¼šæ‹›è˜æ˜¯ Leader çš„è´£ä»»ï¼Œä¸æ˜¯ HR çš„æ‹›äººä¸ç­‰äºç›²ç›®åŠ äººæ˜ç¡®ä¸šåŠ¡ç›®æ ‡ï¼›ç›˜ç‚¹å›¢é˜Ÿéœ€æ±‚ï¼›åšå‡ºå²—ä½è®¾è®¡ï¼›æç‚¼å²—ä½è¦æ±‚ã€‚ é—»å‘³é“ã€é—®äº‹å®ã€çœ‹èƒ½åŠ›é¢è¯•å‰çœ‹ç®€å†ï¼Œé¢è¯•ä¸­æ›´å¤šå€¾å¬ï¼Œé¢è¯•åé€Ÿå†™è¯„ä»·ã€‚ é—®äº‹å®ï¼ˆSTARæ³•åˆ™ï¼Œçœ‹å€™é€‰äººæ‰€è¯´çš„å†…å®¹æ˜¯å¦çœŸæ­£åšè¿‡ï¼Œä»¥åŠæ€è€ƒè¿‡ç¨‹ï¼‰ çœ‹èƒ½åŠ› é—»å‘³é“ï¼ˆæ˜¯å¦å’Œå›¢é˜ŸåŒ¹é…ï¼‰ å®ç¼ºæ¯‹æ»¥ï¼Œå®ˆä½åº•çº¿å…³æ³¨æœªæ¥ ä»–æ˜¯å¦æœ‰èƒ½åŠ›çš„åŒæ—¶è¿˜æœ‰æ½œåŠ›ï¼Ÿæ¯”å¦‚å¾ˆå¼ºçš„å‘å±•æ¬²æœ›æˆ–å­¦ä¹ èƒ½åŠ›ï¼Ÿ ä»–èº«ä¸Šæ˜¯å¦æœ‰ç‰¹è´¨è¶³å¤Ÿå¸å¼•ä½ ï¼Ÿæ¯”å¦‚è®©ä½ è§‰å¾—å½“ä»–æœªæ¥ä¼šæ¯”ä½ æ›´ä¼˜ç§€ï¼Ÿ ä½ æ˜¯å¸Œæœ›ä¸ä»–è¿™æ ·çš„äººä¸€èµ·å…±äº‹çš„ï¼Ÿ å½“ä»–åŠ å…¥å›¢é˜Ÿåï¼Œèƒ½å¦å°†å›¢é˜Ÿæ°›å›´æ¿€æ´»ï¼Œå½¢æˆé²¶é±¼æ•ˆåº”ï¼Ÿ å®ç¼ºæ¯‹æ»¥ èƒ½åŠ›æ°´å¹³è¶…è¿‡å›¢é˜Ÿ 50% çš„äººä»¥ä¸Šï¼šç¡®ä¿å›¢é˜Ÿè¶Šæ¥è¶Šå¼ºï¼Œè€Œä¸æ˜¯è¶Šæ¥è¶Šå¼±ï¼Œæœ‰çš„ Leaderä¼šè§‰å¾—å€™é€‰äººæ¯”å›¢é˜Ÿæœ€å·®çš„ä¸¤ä¸ªäººå¥½å°±å¯ä»¥äº†ï¼Œä½†è¿™æ ·ä¸€æ¥ï¼Œéšç€æ—¶é—´æ‹‰é•¿ï¼Œä½ çš„å›¢é˜Ÿä¼šè¶Šæ¥è¶Šå·®ã€‚ å†…å¿ƒæ˜¯å¦éå¸¸çŠ¹è±«ï¼ŸçŠ¹è±«å¾€å¾€æ„å‘³ç€â€œä¸æƒ³è¦ &gt; æƒ³è¦â€ï¼Œå¦‚æœæ˜¯è¿«äºä¸šåŠ¡å‹åŠ›ä¸å¾—ä¸åŠ äººï¼Œæˆ‘å»ºè®®ä½ è¿˜æ˜¯ä¸è¦å‹‰å¼ºï¼Œå› ä¸ºæœ‰å¯èƒ½æœ¬æ¥è§£å†³ä¸šåŠ¡å‹åŠ›å°±å¯ä»¥çš„é—®é¢˜æ¼”å˜æˆè¿˜è¦é¢å¤–è§£å†³ä¸é€‚åˆçš„æ–°å‘˜å·¥çš„é—®é¢˜ã€‚ èƒ½è½åœ°ï¼š90 å¤©è¯•ç”¨æœŸï¼Œè½¬æ­£æ—¶æˆ‘ä»¬è¦è€ƒå¯Ÿä»€ä¹ˆï¼Ÿ æ˜ç¡®æ–°åŒå­¦è½åœ°çš„æ•´ä½“èŠ‚å¥ é‡ç‚¹æŠ“è¯•ç”¨æœŸè€ƒæ ¸ä»¥åŠå·¥ä½œä¹ æƒ¯çš„å…»æˆ è½¬æ­£ç»“æŸåä¾ç„¶ä¿æŒè·Ÿè¿› æ—¢è¦å¸®ï¼Œä¹Ÿè¦ä¸¥â€œæ—¢è¦å¸®ï¼Œä¹Ÿè¦ä¸¥â€æ˜¯æˆ‘å®šä¹‰çš„â€œèƒ½è½åœ°â€çš„æ ¸å¿ƒåŸåˆ™ï¼Œâ€œå¸®â€ä¸â€œä¸¥â€æ˜¯åŒå‘è¦æ±‚ï¼šå¸®æ˜¯æŒ‡å¸®åŠ©æ–°åŒå­¦èå…¥å›¢é˜Ÿï¼ˆé’ˆå¯¹çš„æ˜¯å¸ˆå…„å’Œ Leaderï¼‰ï¼›ä¸¥æ˜¯è¦è®©æ–°åŒå­¦åœ¨å›¢é˜Ÿä¸­æå‡è‡ªå·±ï¼Œéµå®ˆå›¢é˜Ÿçš„åšäº‹åŸåˆ™ï¼Œå‘æŒ¥è‡ªå·±çš„èƒ½åŠ›ä¸ä»·å€¼ï¼ˆé’ˆå¯¹æ–°åŒå­¦è‡ªå·±ï¼‰ã€‚ æ‹›è˜åªæ˜¯å¼€å§‹ï¼Œè®©æ–°åŒå­¦èƒ½è½åœ°ã€å‘æŒ¥ä»·å€¼æ‰æ˜¯æœ€ç»ˆç›®æ ‡ã€‚ æ˜ç¡®æ–°åŒå­¦è½åœ°çš„æ•´ä½“èŠ‚å¥ ç”¨è¿æ–°æ‰“ç ´å¤§å®¶åœ¨æƒ…æ„Ÿä¸Šçš„å£å’ï¼› ç»™æ–°åŒå­¦å®‰æ’â€œå¸ˆå…„â€ï¼› æ˜ç¡®æ–°åŒå­¦çš„ä½œä¸šä¸ç›®æ ‡ï¼ˆåšå‡ºä¸€äº›æˆç»©è¾¾åˆ°è½¬æ­£ï¼‰ï¼› æ˜ç¡®å‘ŠçŸ¥è½¬æ­£åº”è¯¥æ€ä¹ˆåšï¼ˆæŠŠè½¬æ­£åšé‡ã€åšå®ï¼‰ã€‚ è½¬æ­£è¿°èŒè¦è€ƒæ ¸ä»€ä¹ˆè½¬æ­£è¿°èŒæ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„æ‹›è˜ç»“æŸï¼ æŠŠæ§è½¬æ­£æ—¶é—´ï¼š æå‰åŠä¸ªæœˆè·Ÿ HR æˆ–è€…â€œå¸ˆå…„â€ç¡®å®šè½¬æ­£è¿°èŒæ—¶é—´ç‚¹ã€‚ å»ºç«‹è¯„å§”ä¼šï¼š ç”± Leader ä¸»å¯¼ï¼Œä¸å…¶åˆä½œçš„ä¼™ä¼´ï¼ˆæŠ€æœ¯åŒå­¦ã€äº§å“æˆ–è€…è¿è¥ï¼‰ç»„æˆå°çš„è¯„å§”ä¼šï¼ˆå¦‚æœå›¢é˜Ÿæˆå‘˜è¾ƒå°‘ï¼Œä¹Ÿå¯ä»¥åªæœ‰ Leader å’Œ HRï¼‰è¿™é‡Œè¦æ³¨æ„ï¼Œåˆä½œä¼™ä¼´çš„åé¦ˆä¹Ÿè®¸ä¼šæ¯”è¾ƒä¸»è§‚ï¼Œä½ åœ¨å‚è€ƒæ—¶è¦å°½é‡ä¿æŒå®¢è§‚ã€‚ æ˜ç¡®è€ƒæ ¸å†…å®¹ï¼š ç¡¬æ€§è¦æ±‚+è½¯æ€§è¦æ±‚ã€‚ æˆé•¿æœŸçš„è·Ÿè¿›æ…¢æ…¢å åŠ ã€ä¸»åŠ¨è·Ÿè¿›ã€æ ‘ç«‹ä¿¡å¿ƒ å‡çº§æ±°æ¢ï¼šâ€œå¿ƒè¦æ…ˆï¼Œåˆ€è¦å¿«â€å¼€é™¤äººâ€œå¿ƒè¦æ…ˆï¼Œåˆ€è¦å¿«â€ No Surpriseï¼š ä¸è¦çªç„¶Fireä¸€ä¸ªäººï¼ˆç¦»èŒä¸€å®šä¸æ˜¯ä¸€ä¸ªçªå‘è¡Œä¸ºï¼‰ï¼Œæ²¡æœ‰ä»»ä½•å¾å…†å‘Šè¯‰å‘˜å·¥ Aâ€œä½ è¢«å¼€é™¤äº†â€ï¼Œè¿™æ˜¯å…¸å‹çš„ç®¡ç†å¤±èŒã€‚å¦‚æœAå­˜åœ¨é—®é¢˜ï¼Œä½ åº”è¯¥å…ˆå‘ŠçŸ¥ï¼Œç„¶åä¸€è¾¹å’Œä»–ä¸€èµ·åˆ¶å®šæ”¹å–„è®¡åˆ’ï¼Œä¸€è¾¹ç£ä¿ƒå…¶æ”¹æ­£ã€‚ç¦»èŒå¾€å¾€æ˜¯ä¸€ä¸ªå¯é¢„æœŸçš„ç»“æœï¼Œæ— æ³•æ»¡è¶³å·¥ä½œéœ€è¦æˆ–è€…å¯¹å›¢é˜Ÿæœ‰å…¶ä»–ä¼¤å®³è€Œ A ä¾æ—§æ— æ³•æ”¹å˜æ—¶ï¼Œä¸ºäº†é¿å…å¯¹å›¢é˜Ÿäº§ç”ŸæŒä¹…ä¸åˆ©çš„å½±å“ï¼Œå°±éœ€è¦è®©ä»–ç¦»å¼€ã€‚ å¿ƒè¦æ…ˆã€åˆ€è¦å¿«ï¼š æ°å…‹Â·éŸ¦å°”å¥‡ï¼ˆJack Welchï¼‰æ›¾ç»è¯´è¿‡è¿™æ ·ä¸€å¥è¯â€œå¦‚æœä¸€ä¸ªäººåˆ°äº†ä¸­å¹´ä¹‹åï¼Œè¿˜æ²¡æœ‰è¢«å‘ŠçŸ¥è‡ªå·±çš„å¼±ç‚¹ï¼Œåè€Œåœ¨æŸä¸€å¤©å› ä¸ºèŠ‚çº¦æˆæœ¬çš„åŸå› è¢«è£æ‰äº†ï¼Œè¿™æ˜¯æœ€ä¸å…¬å¹³ã€æœ€ä¸åº”è¯¥å‘ç”Ÿçš„äº‹æƒ…ã€‚å°±æ˜¯å› ä¸ºè¿™ä¸ªå…¬å¸å¤ªä»æ…ˆäº†ï¼Œä»–è¿å‡ºå»æ‰¾å·¥ä½œã€æå‡è‡ªæˆ‘çš„å¯èƒ½æ€§å’Œæœºä¼šéƒ½æ²¡æœ‰ã€‚â€ä½ å¯èƒ½è§‰å¾—ï¼Œåœ¨æƒ…æ„Ÿä¸Šè§£è˜ä¸€ä¸ªäººéå¸¸ç³Ÿç³•ï¼Œä½†æ˜¯æ¢ä¸€ä¸ªè§’åº¦æƒ³ï¼Œå¦‚æœä½ å¯¹ä¸€ä¸ªäººå¾ˆä¸æ»¡æ„ï¼Œå´åˆä¸æ‰¾ä»–è°ˆè¯ï¼Œä¸è¦æ±‚ä»–æ”¹è¿›ï¼Œåˆä¸å¼€é™¤ä»–ï¼Œé‚£ä¹ˆä»æœ€ç»ˆç»“æœçœ‹ä¸ä»…å¯¹ä»–å¾ˆæ®‹é…·ï¼Œè¿™ç§â€œæ‹‰é”¯æˆ˜â€å¯¹å›¢é˜Ÿä¹Ÿæ˜¯ä¸è´Ÿè´£ä»»çš„ã€‚ Happy stayã€Happy goï¼š å¾ˆå¤šæ—¶å€™ï¼Œé€èµ°ä¸€ä¸ªåŒå­¦å¯¹å½¼æ­¤æ¥è¯´å¹¶ä¸æ˜¯ä¸€ä»¶ç³Ÿç³•çš„äº‹ï¼Œæ¢ä¸ªè§’åº¦çœ‹ï¼Œå¦‚æœä»–åœ¨å½“å‰ç¯å¢ƒä¸‹ä¸€ç›´æ— æ³•é€‚é…å›¢é˜Ÿï¼Œå¯¹ä»–æ¥è¯´ä¹Ÿæ˜¯å¾ˆéš¾å—çš„ï¼Œè¿™æ—¶åˆ†å¼€å¯¹ä»–å¯¹å›¢é˜Ÿéƒ½æ˜¯è§£è„±ã€‚å°¤å…¶æ˜¯å½“å…¬å¸å‡ºç°å˜åŒ–æ—¶ï¼Œå¦‚æœä¸€äº›åŒå­¦ä¸å†åˆé€‚ï¼Œæ¢ç¯å¢ƒæ¥è®²å¯¹ä»–æ˜¯æ–°çš„æœºä¼šï¼Œæ‰€ä»¥ä½ ä¸è¦å­˜åœ¨å¤ªå¤šçš„æƒ…ç»ªï¼Œè€Œæ˜¯è¦å¾€â€œå¥½èšå¥½æ•£â€çš„æ–¹å‘ä¸Šæ¨åŠ¨ã€‚ ä¸è¦ç»™â€œç™½å…”â€ç”Ÿå­˜æœºä¼š ç™½å…”çœ‹èµ·æ¥äººç•œæ— å®³ï¼Œç¹æ®–èƒ½åŠ›æå¼ºï¼Œå¤§å…¬å¸é‡Œæœ€å®¹æ˜“å­˜åœ¨çš„å°±æ˜¯â€œç™½å…”â€ï¼ˆä¸å¹²æ´»çš„å¥½äººï¼‰ã€‚ä»–ä»¬ç›®æ ‡å’Œä»·å€¼è§‚è®¤åŒåº¦è¾ƒé«˜ï¼Œä½†æ˜¯ä¸šç»©é•¿æœŸæ‹–åè…¿ã€‚æ¯ä¸€å®¶å…¬å¸éƒ½æœ‰è¿™æ ·çš„äººï¼Œçœ‹ç€å‹¤å‹¤æ³æ³ï¼Œä½†å´æ‹¿ä¸åˆ°ä»»ä½•ç»“æœï¼Œå¦‚æœä½ çºµå®¹ç™½å…”çš„å­˜åœ¨ï¼Œé‚£ä¹ˆé•¿ä¹…ä¸‹å»ï¼Œå¾ˆå®¹æ˜“æ»‹ç”Ÿä¸€ç¾¤ç™½å…”ç£¨æ´‹å·¥ï¼Œé’ˆå¯¹è¿™ç±»å‘˜å·¥ï¼Œä½ å‰æœŸå¯ä»¥ç»™äºˆæ”¹æ­£çš„æœºä¼šï¼Œå¦‚æœä¾æ—§æ²¡æœ‰æ”¹å–„ï¼Œåº”è¯¥æ¯«ä¸çŠ¹è±«å°†å…¶é€èµ°ã€‚ ç¦»èŒé¢è°ˆâ€œTRFâ€ Train himã€Remove himã€Fire him Train him æ˜¯æŒ‡å¦‚æœä»–èƒ½åŠ›è·Ÿä¸ä¸Šï¼Œä½ å¯ä»¥ç»™äºˆå…¶å¸®åŠ©ï¼›Remove him æ˜¯æŒ‡å¦‚æœä»–çš„èƒ½åŠ›å’Œå²—ä½åŒ¹é…æœ‰é—®é¢˜ï¼Œä½ è¦æ›´å¤šåœ°é‡‡ç”¨è½¬å²—çš„æ–¹å¼ï¼Œä¸ºä»–çš„å‘å±•æ‰“å¼€ç©ºé—´ï¼›å¦‚æœåœ¨ä½ ç»™äºˆä»–æœºä¼šä¹‹åï¼Œä»–è¿˜æ˜¯æ— æ³•æ”¹å–„ï¼Œé‚£ä½ å°±åº”è¯¥ Fire himã€‚ éœ€è¦é¿å…çš„ï¼š â€œè°ˆä¸äº†â€ï¼šè¾é€€çš„äº‹å®ä¾æ®ä¸å……åˆ†ï¼Œå¯¹ç¦»èŒåŸå› è®²ä¸æ¸…æ¥šã€‚ â€œæ— é‡ç‚¹â€ï¼šå¯¹æœ‰å…³é—®é¢˜é¿é‡å°±è½»ï¼Œåªè¯´æ— å…³ç—›ç—’çš„ç¥ç¦ã€‚ â€œæ²¡æŠ€å·§â€ï¼šå¯¹å‘˜å·¥å·¥ä½œæ¨ªåŠ æŒ‡è´£ï¼Œé¢è°ˆå®Œåè€ŒåŠ æ·±äº†çŸ›ç›¾ã€‚ â€œä»ä¸è°ˆâ€ï¼šæ˜¯å¯¹å‘˜å·¥å­˜åœ¨å¾ˆå¤§åè§ï¼Œä¸é¢è°ˆç›´æ¥ä¸€æ‹ä¸¤æ•£ã€‚ æŠ€æœ¯ç®¡ç†çš„å¸¸è§ç—›ç‚¹æ™‹å‡ï¼šæ˜¯ä¸æ˜¯æŠ€æœ¯åˆ°ä½ã€é¡¹ç›®åšå¥½å°±å¤Ÿäº†ï¼Ÿç»è¿‡å¤šå°‘â€œå…³â€æ‰èƒ½æ™‹å‡ï¼Ÿæ™‹å‡æ­¥éª¤ï¼š æ™‹å‡å¯åŠ¨â€”â€”ä¸»ç®¡æåâ€”â€”éƒ¨é—¨ææŠ¥â€”â€”è¿°èŒç­”è¾©â€”â€”ç»“æœè¡¨å†³â€”â€”å…¬å¸å¤å®¡â€”â€”ç»“æœå…¬å¸ƒ æåæ²Ÿé€šå¯ä»¥åœ¨è–ªèµ„ã€å¹´ç»ˆå¥–ç­‰æ¿€åŠ±ä¸Šä½“ç°è‡ªå·±å¯¹è‹¦åŠ³åŒå­¦çš„å…³æ³¨ï¼Œè€Œå¯¹äºæƒ³è¦æ™‹å‡çš„åŒå­¦ï¼Œåº”è¯¥æ›´å¤šç»™ä»–èƒ½åŠ›åŸ¹å…»çš„æœºä¼šï¼Œå› ä¸ºå¯¹æŠ€æœ¯åŒå­¦è€Œè¨€ï¼ŒæŠ€æœ¯æ˜¯æ™‹å‡çš„åŸºç¡€ï¼Œæˆ˜åŠŸä¸ä¸šç»©ä¹Ÿç¼ºä¸€ä¸å¯ï¼Œåè€…æ˜¯ä¸ºäº†è¯æ˜è‡ªå·±çš„èƒ½åŠ›å’Œæ‹…å½“è¶³ä»¥æ‰¿è½½æ›´å¤šèŒè´£ã€‚ å¤§éƒ¨åˆ†æƒ…å†µä¸‹è‹¦åŠ³ä¸ç­‰äºåŠŸåŠ³ï¼Œæ˜¯å¦å…·å¤‡ä¸‹ä¸€ä¸ªè§’è‰²æ‰€éœ€è¦çš„æ¡ä»¶æ‰æ˜¯æ™‹å‡è€ƒæ ¸çš„ä¾§é‡ç‚¹ã€‚ èµ„æ–™å‡†å¤‡4 ä¸ªå…³é”®è¯ï¼šèµ„æ–™ç´ ææ¥æºã€è¯æ˜å®åŠ›ã€PPTç¼–å†™ã€èµ›å‰æ¼”ç»ƒä¸å¿ƒç†è¾…å¯¼ ç´ ææ¥æºäºâ€œè¿‡å»è´¢å¹´æ€»ç»“ + æ–°è´¢å¹´çš„è§„åˆ’ + æ±‡æŠ¥ææ–™ + åˆ†äº«ææ–™ + é¡¹ç›®æ€»ç»“â€ï¼Œå› ä¸ºç»è¿‡æ²‰æ·€çš„èµ„æ–™æ‰æœ€æœ‰ä»·å€¼ã€‚æœ‰äº†ä¸€äº›ç´ æèµ„æ–™åï¼Œå°±è¦æŠŠæ§å‡†å¤‡é˜¶æ®µçš„æ ¸å¿ƒï¼šé€šè¿‡ç´ æå»è¯æ˜ä½ å…·å¤‡ä¸‹ä¸€èŒçº§æ‰€éœ€è¦çš„èƒ½åŠ›ã€‚ å›´ç»• 5 ä¸ªç»´åº¦ï¼ˆæ¶æ„èƒ½åŠ›ã€ç»†èŠ‚æŠŠæ§çš„èƒ½åŠ›ã€å·¥ç¨‹çš„èƒ½åŠ›ã€å›¢é˜Ÿçš„èƒ½åŠ›ã€æŠ€æœ¯è§†é‡ï¼‰å»æ¢³ç†å’Œæç‚¼å…³é”®ä¿¡æ¯ï¼Œå‡†å¤‡ç›¸å…³èµ„æ–™ã€‚ ç¼–å†™ PPT å°†è¯æ˜ä½ èƒ½åŠ›çš„æ¡†æ¶å¯è§†åŒ–ï¼Œçªå‡ºé‡ç‚¹ã€å†…å®¹ç¿”å®ã€æ•°æ®è¯´è¯ã€åŠŸåŠ³å¤§äºè‹¦åŠ³ã€çªå‡ºè‡ªæˆ‘ã€‚ åœ¨å›¢é˜Ÿå†…éƒ¨è®©æœ‰æåçš„åŒå­¦é¢„æ¼”ä¸€éè‡ªå·±å‡†å¤‡çš„å†…å®¹ï¼Œå…¶ä½™åŒå­¦ä»ä¸­æŒ‡å‡ºå­˜åœ¨çš„é—®é¢˜ï¼ˆæ˜¯å¦ç´§å¼ ã€æ˜¯å¦çªå‡ºäº®ç‚¹â€¦â€¦ï¼‰äº‰å–è®©ä»–è„±ç¨¿ï¼Œé€»è¾‘ä¸¥è°¨ï¼Œå‡å°‘ç´§å¼ æ„Ÿï¼›ä¸€äº›åŒå­¦ä¼šæ ¼å¤–åœ¨æ„æ™‹å‡è¿™ä»¶äº‹ï¼Œæ‚£å¾—æ‚£å¤±ï¼Œæ‰€ä»¥ Leader è¦å¸®ä»–å¹³ç¼“å¿ƒæ€ï¼Œå¸®åŠ©å…¶å»ºç«‹æ­£ç¡®çš„è®¤çŸ¥ï¼šæŠŠæ™‹å‡å½“ä½œä¸€æ¬¡åˆ†äº«å’Œæ€»ç»“ï¼Œå°±å½“æ˜¯å¯¹è¿‡å»ä¸€æ®µæ—¶é—´çš„å›é¡¾ï¼Œä¸ç®¡ç»“æœå¦‚ä½•ï¼Œæ€»æœ‰æ‰€æ”¶è·ã€‚ æ™‹å‡ç­”è¾© æ‹¿ç»“æœçš„èƒ½åŠ›ï¼š æ¸…æ™°çš„å®¢æˆ·ä»·å€¼äº§å‡ºï¼Œæœ‰æ€è€ƒæ²‰æ·€å’Œå¯å¤åˆ¶çš„æ–¹æ³•è®ºï¼› ä¸šåŠ¡ç†è§£èƒ½åŠ›ï¼š å®¢æˆ·è§†è§’ã€å‰ç»æ€§æ€è€ƒä¸åˆ¤æ–­ã€å¯ä»¥æŒç»­æå‡å®¢æˆ·ä»·å€¼ã€‚ ç»“æœå®‰æ’æ™‹å‡ç­”è¾©ä¹‹åï¼Œæ— å¤–ä¹ä¸¤ä¸ªç»“æœï¼šæ™‹å‡æˆåŠŸã€å¤±è´¥ã€‚ä½œä¸º Leaderï¼Œä½ éœ€è¦è®©å€™é€‰äººè®¤è¯†åˆ°è¿™ä¸¤ç§ç»“æœï¼Œå¹¶å‘ŠçŸ¥å°½æœ€å¤§çš„åŠªåŠ›ï¼Œè€ƒè™‘æœ€åçš„ç»“æœï¼Œé¿å…å½¢æˆè½å·®ï¼Œå€™é€‰äººç¦»èŒï¼›å¦‚æœå€™é€‰äººæ™‹å‡æˆåŠŸï¼Œç®€å•åº†ç¥è¿‡åï¼Œè¿˜éœ€è¦ä¸ºå…¶æ–°è§’è‰²æ˜ç¡®æ–°çš„è¦æ±‚å’ŒèŒè´£ï¼Œè®©ä»–æœ‰æ›´æ˜ç¡®çš„åŠªåŠ›æ–¹å‘ï¼Œåœ¨å›¢é˜Ÿå†…å‘æŒ¥æ›´å¤§çš„ä½œç”¨ï¼Œä¸è¦æŠŠæ™‹å‡å½“ä½œç»ˆç‚¹ï¼Œè€Œæ˜¯åé¢å·¥ä½œçš„èµ·ç‚¹ã€‚ æ™‹å‡ä¸æ˜¯å¥–åŠ±ï¼Œæ˜¯è´£ä»»ä¸æ‹…å½“ï¼Œæ˜¯ä¸ºæœªæ¥åšçš„äº‹ã€‚ è·¨å›¢é˜Ÿï¼šæ²¡æœ‰æ±‡æŠ¥çº¿çš„äººå’Œäº‹å°±æ˜¯æ¨ä¸åŠ¨ï¼Ÿè·¨å›¢é˜Ÿäº‹åŠ¡æ¨è¿›çš„éš¾ç‚¹ æ–¹æ¡ˆæ— æ³•è¾¾æˆä¸€è‡´ï¼š ä½ æå‡ºçš„ A æ–¹æ¡ˆä¸è¿è¥å›¢é˜Ÿæå‡ºçš„ B æ–¹æ¡ˆï¼Œåœ¨å®ç°æˆæœ¬ã€æ–¹å¼ã€èµ„æºç­‰æ–¹é¢å­˜åœ¨å¾ˆæ˜æ˜¾å·®å¼‚ï¼Œé™·å…¥åƒµå±€ã€‚ æ—¶é—´æ— æ³•è¾¾æˆä¸€è‡´ï¼š åä½œæ–¹èµåŒ A æ–¹æ¡ˆï¼Œä½†å¯¹â€œä¸€å‘¨ä¸Šçº¿é¡¹ç›®â€çš„æ—¶é—´èŠ‚ç‚¹æœ‰æ„è§ï¼Œè®¤ä¸ºè‡³å°‘éœ€è¦ 20 å¤©ï¼Œè¿™ä¼šä»â€œæ—¶é—´æ— æ³•è¾¾æˆä¸€è‡´â€å›æ»šåˆ°â€œæ–¹æ¡ˆæ— æ³•è¾¾æˆä¸€è‡´â€ï¼Œé™·å…¥æ–°ä¸€è½®åƒµå±€ã€‚ ä¼˜å…ˆçº§æ— æ³•è¾¾æˆä¸€è‡´ï¼š åä½œæ–¹èµåŒ A æ–¹æ¡ˆï¼Œå¯¹é¡¹ç›®ç”¨æ—¶ä¸€å‘¨ä¹Ÿæ— å¼‚è®®ï¼Œä½†è¯¥é¡¹ç›®ä¼˜å…ˆçº§åœ¨ä»–é‚£å„¿æ²¡æœ‰æåˆ°å¾ˆé«˜ï¼Œä¸€ç›´æœ‰ä¼˜å…ˆçº§æ›´é«˜çš„é¡¹ç›®æ’é˜Ÿï¼Œå¯¼è‡´äº¤ä»˜æ—¶é—´ä¸€å˜å†å˜ã€ä¸€æ‹–å†æ‹–ã€‚ é˜¶æ®µæ€§äº¤ä»˜ç»“æœä¸ä¸€è‡´ï¼š å› ä¸ºæŸäº›åŸå› ï¼ˆçº¿ä¸Šçªå‘çŠ¶å†µã€åŒå­¦è¯·å‡ã€äººå‘˜èƒ½åŠ›è¾ƒå·®â€¦â€¦ï¼‰ï¼Œä¸ä½ åä½œå›¢é˜Ÿåœ¨é…åˆæ—¶äº¤ä»˜ä½ çš„ç»“æœè´¨é‡æ— æ³•æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œæ¯”å¦‚è¿è¥ç»™çš„æ–¹æ¡ˆæœ‰å¾ˆå¤§æ¼æ´ã€æŠ€æœ¯ç»™çš„æ¥å£ Bug æ¯”åŠŸèƒ½ç‚¹è¿˜å¤šï¼Œä½ åˆæ— æ³•ç›´æ¥ç®¡ç†å¯¹æ–¹å›¢é˜Ÿçš„æˆå‘˜ï¼Œæœ€ç»ˆå³ä½¿æ›´æ­£äº†ä¹Ÿå¯èƒ½æµªè´¹äº†é¢å¤–çš„æ—¶é—´ã€‚ éš¾ç‚¹äº§ç”Ÿçš„åŸå› ï¼š åä½œæ–¹ä¸æ¸…æ¥šé¡¹ç›®åŸå› å’Œæ„ä¹‰ï¼Œä¼šä¼˜å…ˆè€ƒè™‘è‡ªèº«åˆ©ç›Šï¼Œæ ¹æ®åˆ©ç›Šé«˜ä½æ¨è¿›éš¾åº¦ç”±æ˜“åˆ°éš¾ åä½œæ–¹æœ‰è‡ªå·±å½“å‰çš„å·¥ä½œå†…å®¹å’Œä¼˜å…ˆçº§ï¼Œçªç„¶é…åˆè¿›è¡Œå…¶ä»–äº‹åŠ¡ï¼Œå¼•å…¥çš„é£é™©å¾€å¾€è¾ƒé«˜ å„éƒ¨é—¨å¯¹å½¼æ­¤ä¹‹é—´çš„å·¥ä½œæ–¹å¼ã€å›¢é˜Ÿç»éªŒä»¥åŠå½“å‰ç°çŠ¶å¾€å¾€ä¸äº†è§£ ä»»åŠ¡ç»†åŒ–ï¼Œè·¨å›¢é˜Ÿåˆä½œå—æ—¶é—´ã€ç©ºé—´ç­‰å› ç´ å½±å“æ²Ÿé€šæˆæœ¬è¾ƒé«˜ï¼Œæœ‰äº›é—®é¢˜ä¸çŸ¥é“è¯¥æ‰¾è° è·¨å›¢é˜Ÿäº‹åŠ¡æ¨è¿›çš„åŸºæœ¬æ€åº¦ ä¸è¦åšæƒ…ç»ªçš„å¥´éš¶ï¼Œå…ˆæ‰¾è‡ªå·±çš„é—®é¢˜ å¿«åˆ€æ–©ä¹±éº»ï¼Œé¿å…å› å¤æ‚çš„é—®é¢˜é™·å…¥æ²¼æ³½ æ…¢æ€è€ƒï¼Œå¿«æ‰§è¡Œ å€ŸåŠ›å‰è¡Œï¼Œæ‘†äº‹å®è®²é“ç†ï¼Œå‡­èŒçº§ï¼Œè¡Œè¿›åŠæ³•ï¼Œè¾¾æˆç›®æ ‡ã€‚ è·¨å›¢é˜Ÿäº‹åŠ¡æ¨è¿›çš„åŸåˆ™æ–¹æ³• åˆä½œå‰ï¼ˆæ˜ç¡®ç›®æ ‡ï¼Œç¡®ä¿ä¿¡æ¯å®Œæ•´ï¼‰ åˆä½œä¸­ï¼ˆå®šä½é—®é¢˜ï¼Œå€ŸåŠ¿è€Œä¸ºï¼‰ åˆä½œåï¼ˆæ‰¿æ‹…è´£ä»»ï¼Œå…¬å¼€è‚¯å®šï¼‰ æ¢ä½æ€è€ƒã€æ‘†äº‹å®ã€è®²é“ç†ã€å‡­èŒçº§ã€å€ŸåŠ¿è€Œè¡Œã€æƒ³å°½åŠæ³•è¾¾æˆç›®æ ‡ã€‚ åšè§„åˆ’ï¼šé™¤äº†äº¤ä»˜å’Œç¨³å®šæ€§ï¼Œè¿˜è¦è§„åˆ’ä»€ä¹ˆï¼Ÿå›¢é˜Ÿè§„åˆ’è§£å†³çš„æ ¸å¿ƒé—®é¢˜æ˜¯ï¼šè®©ä½ åœ¨æœ‰é™çš„æ—¶é—´å’Œèµ„æºå†…ï¼Œæ˜ç¡®æ€ä¹ˆå»åˆ›é€ æœ€å¤§çš„æŠ€æœ¯ä»·å€¼ï¼ˆROIï¼‰ã€‚è€Œä¸”åœ¨åšå›¢é˜Ÿè§„åˆ’çš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®æ˜¯ä¸€ä¸ªæ·±å…¥æ€è€ƒã€æ¢³ç†çš„è¿‡ç¨‹ï¼Œä½ å¯ä»¥å¤ç›˜è¿‡å»ã€æ¢³ç†å½“ä¸‹ã€å±•æœ›æœªæ¥ï¼Œå°‘èµ°å¼¯è·¯ã€‚ åšè§„åˆ’è¦è€ƒè™‘å›¢é˜Ÿç°çŠ¶ æ˜ç¡®å®šä½ä¸èŒè´£ äººå‘˜æƒ…å†µ ä¸šåŠ¡æƒ…å†µ ä¸€ä¸ªå¯ä»¥å‚è€ƒçš„æ€è·¯æ˜¯ï¼š ç›¯ç€ä¸šåŠ¡ç›®æ ‡å»å»¶å±•äººå‘˜å’Œä¸šåŠ¡ï¼Œä»è€Œåˆ¤æ–­å“ªäº›æ˜¯ä¾èµ–é¡¹ï¼Œå“ªäº›æ˜¯å‰ç½®é¡¹ï¼Ÿåœ¨å¤§éƒ¨åˆ†å…¬å¸ä¸­ï¼ŒæŠ€æœ¯å¾ˆéš¾ç›´æ¥åˆ›é€ å•†ä¸šä»·å€¼ï¼Œå¾€å¾€è¿˜æ˜¯è¦ä¾èµ–äºä¸šåŠ¡ï¼Œæ‰€ä»¥æŠŠä¸šåŠ¡ä½œä¸ºç¬¬ä¸€ç›®æ ‡ï¼Œä¸ºäº†è¾¾æˆæŸä¸ªä¸šåŠ¡ç»“æœï¼Œéœ€è¦è°ƒæ•´äººå‘˜ç»“æ„ï¼Œæ‹›è˜ä¸€äº›æ›´å‰å®³çš„äººæ±°æ¢ä¸€äº›ä¸è¡Œçš„äººï¼Œç ”ç©¶å¹¶å®ç°ä¸€äº›æ–°æŠ€æœ¯ï¼Œè¿™æ˜¯æ¯”è¾ƒè‡ªç„¶çš„ã€‚ ä½ çš„è§„åˆ’ä¸­åŒ…å«äº†ä»€ä¹ˆï¼Ÿä¸åŒçš„æŠ€æœ¯å›¢é˜Ÿï¼Œåœ¨è§„åˆ’æ—¶æ‰€æ‹Ÿå®šçš„å†…å®¹éƒ½æ˜¯ä¸åŒçš„ï¼Œä½†ä½ å…¶å®éƒ½å¯ä»¥æç‚¼æˆå…±æ€§çš„3 éƒ¨åˆ†ã€‚ ä¸šåŠ¡ç»“æœï¼š ç›´ç™½è¯´å°±æ˜¯ä¸šåŠ¡å±‚é¢çš„æˆ˜ç»©ï¼Œä½ å›¢é˜Ÿæ‰“é€ äº†ä¸€ä¸ªå…¬å¸ GMV å æ¯”è¶…è¿‡ 50%çš„å•†åŸï¼Œæˆ–è€…æ”¯æ’‘äº†æŸä¸ªå¿«é€Ÿå‘å±•ä¸šåŠ¡ï¼Œè¿™äº›éƒ½æ˜¯ä¸šåŠ¡ç»“æœï¼Œç”¨ä¸šåŠ¡æ•°å­—æ¥è¯´è¯ã€‚ æŠ€æœ¯åˆ›æ–°ï¼š ç”±æŠ€æœ¯äººå‘˜å‘èµ·æˆ–å®Œæˆçš„æ‰€æœ‰é™æœ¬ææ•ˆçš„åŠ¨ä½œï¼Œä½†æ˜¯åŒæ ·è¦çœ‹ä¼˜å…ˆçº§å’ŒæŠ•å…¥äº§å‡ºæ¯”ã€‚ å›¢é˜Ÿå»ºè®¾ï¼š è®©å›¢é˜Ÿå¯ä»¥é•¿æœŸå¥åº·å‘å±•ä¸‹å»ï¼Œè¦åœ¨ Backupã€äººå‘˜ç»„æˆã€æœºåˆ¶å»ºè®¾ç­‰å¤šä¸ªæ–¹é¢ä¸‹åŠŸå¤«ã€‚ è‡ªé—®ï¼š WHYï¼šä¸ºä»€ä¹ˆåšä¸šåŠ¡ç›®æ ‡/æŠ€æœ¯åˆ›æ–°/å›¢é˜Ÿå»ºè®¾çš„è§„åˆ’ï¼Ÿ WHATï¼šæ˜¯å¦èƒ½è¯´æ˜ä¸šåŠ¡ç›®æ ‡/æŠ€æœ¯åˆ›æ–°/å›¢é˜Ÿå»ºè®¾è§„åˆ’è§£å†³çš„é—®é¢˜ã€ä»·å€¼ä¸ä½œç”¨ï¼Ÿ WHOï¼šç”±è°æ‰¿æ‹…ï¼Ÿè´Ÿè´£äººçš„ä¼˜åŠ¿ä¸è·ŒåŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ WHENï¼šæ‰€åšçš„è§„åˆ’ç€çœ¼äºç°åœ¨è¿˜æ˜¯æœªæ¥ï¼Ÿèƒ½å¦ä¿è¯é•¿æœŸæœ‰ä»·å€¼ï¼Ÿ HOWï¼šé’ˆå¯¹ä¸åŒçš„éƒ¨åˆ†ï¼Œå…·ä½“çš„è½åœ°ç»†åˆ™å¦‚ä½•ï¼Ÿ HOW MUCHï¼šè§„åˆ’è¦åšåˆ°ä»€ä¹ˆç¨‹åº¦ï¼Ÿæ˜¯å¦å¯ä»¥å½¢æˆå¯è¡¡é‡çš„KPIï¼Ÿ ä¸šåŠ¡ç»“æœä½ è¦æ˜ç¡®ç°é˜¶æ®µä¸Šçº§é¢†å¯¼å…³æ³¨çš„é‡ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯è½¬åŒ–ã€æµé‡ã€ç•™å­˜ã€è¿˜æ˜¯äº§å“çš„ç”¨æˆ·ä½“éªŒï¼Ÿä½œä¸ºæŠ€æœ¯Leader ï¼Œä½ å’Œå›¢é˜Ÿæˆå‘˜çš„åˆ°è¾¾è·¯å¾„æ˜¯ä»€ä¹ˆï¼Ÿè¿™æ˜¯çº¿ç´¢æ¥æºä¹‹ä¸€ã€‚ æŠ€æœ¯åˆ›æ–°ç¨³å®šæ€§ã€æ•ˆèƒ½ä¼˜åŒ–ã€é©±åŠ¨ä¸šåŠ¡ã€è§†é‡å±•æœ› å›¢é˜Ÿå»ºè®¾å›¢é˜Ÿå»ºè®¾çš„å…³é”®ä¸åªæ˜¯çŸ¥äººå–„ç”¨ï¼Œè€Œæ˜¯ï¼š å›¢é˜Ÿæœªæ¥éœ€è¦ä»€ä¹ˆæ ·çš„äººï¼Ÿ ç›®å‰å›¢é˜Ÿæˆå‘˜éœ€è¦ä»€ä¹ˆæ ·çš„çŠ¶æ€å’Œèƒ½åŠ›ï¼Ÿ å›¢é˜Ÿæˆå‘˜éœ€è¦æ‰¿æ‹…ä»€ä¹ˆæ ·çš„è´£ä»»ï¼Ÿ æ€»çš„æ¥è¯´ï¼Œä½ å¸Œæœ›æœªæ¥è‡ªå·±çš„å›¢é˜Ÿæˆä¸ºæ€æ ·çš„å›¢é˜Ÿï¼Ÿä»¥æ­¤æ¨å¯¼ç¦»ç†æƒ³çŠ¶æ€å¤šè¿œï¼Ÿæ€ä¹ˆç¼©å°å·®è·ï¼Ÿ è§„åˆ’è½åœ°æ—¶çš„é—®é¢˜ä¸æ€è·¯å®¹æ˜“å‡ºç°çš„é—®é¢˜ï¼š è§„åˆ’ä¸ç­‰äºè®¡åˆ’ è§„åˆ’å†…å®¹æƒ³å¾—å¤ªå¤šï¼Œåšæˆçš„å°‘ ä¸šåŠ¡å‹åŠ›å¤§ï¼Œç›²ç›¯ç—›ç‚¹ï¼Œå¿½è§†ç›®æ ‡ è§„åˆ’æœ€ç»ˆæˆäº†æŠ€æœ¯Leaderçš„è§„åˆ’ åšå›¢é˜Ÿè§„åˆ’æ˜¯ä¸€ä»¶æ¯”è¾ƒç»¼åˆå®è§‚çš„äº‹æƒ…ï¼Œæœ‰æ—¶å“ªæ€•åªæ˜¯å‡ ä¸ªäººçš„å›¢é˜Ÿï¼Œæƒ³åšå¥½ä¸€ä»½è§„åˆ’è€Œéæ‰§è¡Œè®¡åˆ’ä¹Ÿå¾ˆè€ƒéªŒ Leader çš„æ€è€ƒæ·±åº¦ï¼ŒæŸç§ç¨‹åº¦æ¥è¯´ï¼Œè§„åˆ’æ˜¯ä½ å®šä¹‰ä¸€ç¾¤äººåœ¨æœªæ¥ä¸€æ®µæ—¶é—´å†…åšä»€ä¹ˆã€æ€ä¹ˆåšã€æœ€ç»ˆå˜æˆä»€ä¹ˆæ ·ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦è€ƒé‡çš„ç‚¹éå¸¸å¤šï¼Œè¿™äº›æ·±å…¥çš„æ€è€ƒä¹Ÿä¼šä¿ƒè¿›ä½ æ—¥å¸¸çš„ä¸€äº›è¡Œä¸ºå’Œç»“æœï¼Œå¯¹äºå›¢é˜Ÿçš„å­£åº¦ä¹ƒè‡³åŠå¹´è§„åˆ’æˆ‘æ˜¯éå¸¸æ¨èä½ è¦å®šæœŸæ¢³ç†å¹¶è½åœ°çš„ï¼Œæœ‰ç›®æ ‡å’Œæ²¡ç›®æ ‡çš„å›¢é˜Ÿï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤§çš„å·®åˆ«çš„ã€‚ æ¥æ‰‹æ–°å›¢é˜Ÿï¼šå£«æ°”ä½ã€äº¤ä»˜è¿Ÿã€äº‹æ•…å¤šå‘ï¼Œå¦‚ä½•ä¸‹æ‰‹è§£å†³ï¼Ÿè™½ç„¶æ¥æ‰‹ä¸€ä¸ªé—®é¢˜å›¢é˜Ÿå¾ˆéš¾ï¼Œè¦å¤„ç†å¾ˆå¤šé—®é¢˜å¹¶ä¸”éå¸¸è¾›è‹¦ï¼Œä½†æ˜¯å¯¹ä¸€ä¸ª Leader çš„é”»ç‚¼ä¹Ÿæ˜¯æ— ä¸ä¼¦æ¯”çš„ï¼Œæˆ‘è§è¿‡å‡ ä¹æ‰€æœ‰ä¼˜ç§€çš„æŠ€æœ¯ Leader éƒ½æ˜¯ä¸€æ¬¡æ¬¡è¿™æ ·ç£¨ç‚¼å‡ºæ¥çš„ã€‚æ¯•ç«ŸæŠ€æœ¯ç®¡ç†èƒ½åŠ›å¾ˆé‡è¦çš„ä¸€ä¸ªè½åœ°åœºæ™¯å°±æ˜¯è¿™ç§æƒ…å†µï¼Œä¹Ÿæ˜¯æœ€èƒ½å‘æŒ¥æŠ€æœ¯ Leader ç®¡ç†èƒ½åŠ›ä»·å€¼çš„åœºæ™¯ä¹‹ä¸€ã€‚","categories":[{"name":"reading","slug":"reading","permalink":"https://github.13sai.com/categories/reading/"}],"tags":[{"name":"reading","slug":"reading","permalink":"https://github.13sai.com/tags/reading/"}]},{"title":"gitçŸ¥è¯†æ±‡æ€»","slug":"gitçŸ¥è¯†æ±‡æ€»","date":"2021-02-13T06:49:23.000Z","updated":"2022-06-23T06:50:20.018Z","comments":true,"path":"2021/02/13/310/","link":"","permalink":"https://github.13sai.com/2021/02/13/310/","excerpt":"","text":"æ¦‚å¿µ4ä¸ªåŒºgitä¹‹æ‰€ä»¥ä»¤äººè´¹è§£ï¼Œä¸»è¦æ˜¯å®ƒç›¸æ¯”äºsvnç­‰ç­‰ä¼ ç»Ÿçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œå¤šå¼•å…¥äº†ä¸€ä¸ªæš‚å­˜åŒº(Stage)çš„æ¦‚å¿µï¼Œå°±å› ä¸ºå¤šäº†è¿™ä¸€ä¸ªæ¦‚å¿µï¼Œè€Œä½¿å¾ˆå¤šäººç–‘æƒ‘ã€‚å…¶å®ï¼Œåœ¨åˆå­¦è€…æ¥è¯´ï¼Œæ¯ä¸ªåŒºå…·ä½“æ€ä¹ˆå·¥ä½œçš„ï¼Œæˆ‘ä»¬å®Œå…¨ä¸éœ€è¦å…³å¿ƒï¼Œè€Œåªè¦çŸ¥é“æœ‰è¿™ä¹ˆ4ä¸ªåŒºå°±å¤Ÿäº†ï¼š å·¥ä½œåŒº(Working Area) æš‚å­˜åŒº(Stage) æœ¬åœ°ä»“åº“(Local Repository) è¿œç¨‹ä»“åº“(Remote Repository) 5ç§çŠ¶æ€ä»¥ä¸Š4ä¸ªåŒºï¼Œè¿›å…¥æ¯ä¸€ä¸ªåŒºæˆåŠŸä¹‹åä¼šäº§ç”Ÿä¸€ä¸ªçŠ¶æ€ï¼Œå†åŠ ä¸Šæœ€åˆå§‹çš„ä¸€ä¸ªçŠ¶æ€ï¼Œä¸€å…±æ˜¯5ç§çŠ¶æ€ã€‚ä»¥ä¸‹æˆ‘ä»¬æŠŠè¿™5ç§çŠ¶æ€åˆ†åˆ«å‘½åä¸ºï¼š æœªä¿®æ”¹(Origin) å·²ä¿®æ”¹(Modified) å·²æš‚å­˜(Staged) å·²æäº¤(Committed) å·²æ¨é€(Pushed) æ£€æŸ¥ä¿®æ”¹å·²ä¿®æ”¹ï¼Œæœªæš‚å­˜git diff å·²æš‚å­˜ï¼Œæœªæäº¤git diff --cached å·²æäº¤ï¼Œæœªæ¨é€git diff master origin/master æ’¤é”€ä¿®æ”¹äº†è§£æ¸…æ¥šå¦‚ä½•æ£€æŸ¥å„ç§ä¿®æ”¹ä¹‹åï¼Œæˆ‘ä»¬å¼€å§‹å°è¯•å„ç§æ’¤é”€æ“ä½œã€‚ æ¢å¤å·²ä¿®æ”¹ï¼Œæœªæš‚å­˜å¦‚æœæˆ‘ä»¬åªæ˜¯åœ¨ç¼–è¾‘å™¨é‡Œä¿®æ”¹äº†æ–‡ä»¶ï¼Œä½†è¿˜æ²¡æœ‰æ‰§è¡Œgit add .ï¼Œè¿™æ—¶å€™æˆ‘ä»¬çš„æ–‡ä»¶è¿˜åœ¨å·¥ä½œåŒºï¼Œå¹¶æ²¡æœ‰è¿›å…¥æš‚å­˜åŒºï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ’¤é”€æ“ä½œ git checkout . æˆ–è€… git reset --hard æ¢å¤å·²æš‚å­˜ï¼Œæœªæäº¤ä½ å·²ç»æ‰§è¡Œäº†git add .ï¼Œä½†è¿˜æ²¡æœ‰æ‰§è¡Œgit commit -m &quot;comment&quot;ã€‚è¿™æ—¶å€™ä½ æ„è¯†åˆ°äº†é”™è¯¯ï¼Œæƒ³è¦æ’¤é”€ï¼Œä½ å¯ä»¥æ‰§è¡Œï¼š git reset git checkout . æˆ–è€… git reset --hard git resetåªæ˜¯æŠŠä¿®æ”¹é€€å›åˆ°äº†git add .ä¹‹å‰çš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´æ–‡ä»¶æœ¬èº«è¿˜å¤„äºå·²ä¿®æ”¹æœªæš‚å­˜çŠ¶æ€ï¼Œä½ å¦‚æœæƒ³é€€å›æœªä¿®æ”¹çŠ¶æ€ï¼Œè¿˜éœ€è¦æ‰§è¡Œgit checkout .ã€‚ æˆ–è®¸ä½ å·²ç»æ³¨æ„åˆ°äº†ï¼Œä»¥ä¸Šä¸¤ä¸ªæ­¥éª¤éƒ½å¯ä»¥ç”¨åŒä¸€ä¸ªå‘½ä»¤git reset --hardæ¥å®Œæˆã€‚æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¸ªå¼ºå¤§çš„å‘½ä»¤ï¼Œå¯ä»¥ä¸€æ­¥åˆ°ä½åœ°æŠŠä½ çš„ä¿®æ”¹å®Œå…¨æ¢å¤åˆ°æœªä¿®æ”¹çš„çŠ¶æ€ã€‚ æ¢å¤å·²æäº¤ï¼Œæœªæ¨é€ä½ çš„æ‰‹å¤ªå¿«ï¼Œä½ æ—¢æ‰§è¡Œäº†git add .ï¼Œåˆæ‰§è¡Œäº†git commitï¼Œè¿™æ—¶å€™ä½ çš„ä»£ç å·²ç»è¿›å…¥äº†ä½ çš„æœ¬åœ°ä»“åº“ï¼Œç„¶è€Œä½ åæ‚”äº†ï¼Œæ€ä¹ˆåŠï¼Ÿä¸è¦ç€æ€¥ï¼Œè¿˜æœ‰åŠæ³•ã€‚ git reset --hard origin/master è¿˜æ˜¯è¿™ä¸ªgit reset --hardå‘½ä»¤ï¼Œåªä¸è¿‡è¿™æ¬¡å¤šäº†ä¸€ä¸ªå‚æ•°origin/masterï¼Œæ­£å¦‚æˆ‘ä»¬ä¸Šé¢è®²è¿‡çš„ï¼Œorigin/masterä»£è¡¨è¿œç¨‹ä»“åº“ï¼Œæ—¢ç„¶ä½ å·²ç»æ±¡æŸ“äº†ä½ çš„æœ¬åœ°ä»“åº“ï¼Œé‚£ä¹ˆå°±ä»è¿œç¨‹ä»“åº“æŠŠä»£ç å–å›æ¥å§ã€‚ å·²æ¨é€å¾ˆä¸å¹¸ï¼Œä½ çš„æ‰‹å®åœ¨æ˜¯å¤ªå¿«äº†ï¼Œä½ æ—¢git addäº†ï¼Œåˆgit commitäº†ï¼Œå¹¶ä¸”è¿˜git pushäº†ï¼Œè¿™æ—¶ä½ çš„ä»£ç å·²ç»è¿›å…¥è¿œç¨‹ä»“åº“ã€‚å¦‚æœä½ æƒ³æ¢å¤çš„è¯ï¼Œè¿˜å¥½ï¼Œç”±äºä½ çš„æœ¬åœ°ä»“åº“å’Œè¿œç¨‹ä»“åº“æ˜¯ç­‰ä»·çš„ï¼Œä½ åªéœ€è¦å…ˆæ¢å¤æœ¬åœ°ä»“åº“ï¼Œå†å¼ºåˆ¶pushåˆ°è¿œç¨‹ä»“åº“å°±å¥½äº†ï¼š git reset --hard HEAD^ git push -f éƒ¨åˆ†è¿œç¨‹ä»“åº“è®¾ç½®äº†ç¦æ­¢å¼ºåˆ¶pushï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ã€‚ revertgit revertç”¨äºåè½¬æäº¤ã€‚æ‰§è¡Œrevertå‘½ä»¤æ—¶è¦æ±‚å·¥ä½œæ ‘å¿…é¡»æ˜¯å¹²å‡€çš„ï¼Œgit revertç”¨ä¸€ä¸ªæ–°æäº¤æ¥æ¶ˆé™¤ä¸€ä¸ªå†å²æäº¤æ‰€åšçš„ä»»ä½•ä¿®æ”¹ã€‚revert ä¹‹åä½ çš„æœ¬åœ°ä»£ç ä¼šå›æ»šåˆ°æŒ‡å®šçš„å†å²ç‰ˆæœ¬ï¼Œè¿™æ—¶ä½ å† git push å°±å¯ä»¥æŠŠçº¿ä¸Šçš„ä»£ç æ›´æ–°ã€‚ å¸¸ç”¨å‘½ä»¤ å‘½ä»¤ è¯´æ˜ git clone å…‹éš† git branch (åˆ†æ”¯å) åˆ›å»ºåˆ†æ”¯ -Dåˆ é™¤åˆ†æ”¯ git checkout (åˆ†æ”¯å) åˆ‡æ¢åˆ†æ”¯ -båˆ›å»ºå¹¶åˆ‡æ¢ git checkout (æ–‡ä»¶å) æ’¤é”€æ­¤æ–‡ä»¶ä¿®æ”¹ git add å°†è¯¥æ–‡ä»¶æ·»åŠ åˆ°ç¼“å­˜ git status æŸ¥çœ‹åœ¨ä½ ä¸Šæ¬¡æäº¤ä¹‹åæ˜¯å¦æœ‰ä¿®æ”¹ git commit å°†ç¼“å­˜åŒºå†…å®¹æ·»åŠ åˆ°ä»“åº“ä¸­ git diff æ¥æŸ¥çœ‹æ‰§è¡Œ git status çš„ç»“æœçš„è¯¦ç»†ä¿¡æ¯ git reset HEAD å‘½ä»¤ç”¨äºå–æ¶ˆå·²ç¼“å­˜çš„å†…å®¹ git rm æ–‡ä»¶ åˆ é™¤æ–‡ä»¶-få¼ºåˆ¶åˆ é™¤ git mv ç§»åŠ¨æ–‡ä»¶ git merge åˆå¹¶åˆ†æ”¯ git fetch ä»è¿œç¨‹è·å–æœ€æ–°ç‰ˆæœ¬åˆ°æœ¬åœ° git push &lt;è¿œç¨‹ä¸»æœºå&gt; &lt;æœ¬åœ°åˆ†æ”¯å&gt;:&lt;è¿œç¨‹åˆ†æ”¯å&gt; å°†æœ¬åœ°åˆ†æ”¯çš„æ›´æ–°ï¼Œæ¨é€åˆ°è¿œç¨‹ä¸»æœº git push origin â€“delete test åˆ é™¤è¿œç¨‹åˆ†æ”¯test git pull &lt;è¿œç¨‹ä¸»æœºå&gt; &lt;è¿œç¨‹åˆ†æ”¯å&gt;:&lt;æœ¬åœ°åˆ†æ”¯å&gt; å°†è¿œç¨‹å­˜å‚¨åº“ä¸­çš„æ›´æ”¹åˆå¹¶åˆ°æœ¬åœ°åˆ†æ”¯ä¸­ git rebase å‘½ä»¤åœ¨å¦ä¸€ä¸ªåˆ†æ”¯åŸºç¡€ä¹‹ä¸Šé‡æ–°åº”ç”¨ï¼Œç”¨äºæŠŠä¸€ä¸ªåˆ†æ”¯çš„ä¿®æ”¹åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€‚ git log å‘½ä»¤ç”¨äºæ˜¾ç¤ºæäº¤æ—¥å¿—ä¿¡æ¯ã€‚ git reflog æ˜¾ç¤ºæ¯ä¸€æ¬¡å‘½ä»¤ git revert ç”Ÿæˆä¸€ä¸ªæ–°çš„æäº¤æ¥æ’¤é”€æŸæ¬¡æäº¤ï¼Œæ­¤æ¬¡æäº¤ä¹‹å‰çš„commitéƒ½ä¼šè¢«ä¿ç•™ git reset HEAD å¦‚æœå‘ç°é”™è¯¯çš„å°†ä¸æƒ³æš‚å­˜çš„æ–‡ä»¶è¢«git addè¿›å…¥ç´¢å¼•ä¹‹åï¼Œæƒ³å›é€€å–æ¶ˆï¼Œåˆ™å¯ä»¥ä½¿ç”¨ è®¾ç½®ç”¨æˆ·åé‚®ç®±ï¼š git config â€“global user.name â€œ13saiâ€ git config â€“global user.email â€œ957042781@qq.comâ€œ å‡ ä¸ªå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆfatal: No configured push destination. è§£å†³ï¼š $ git remote add -f -t master -m master origin git://example.com/git.git/ fatal: The current branch test has no upstream branch. è§£å†³ï¼š git push --set-upstream origin test æ¨¡ä»¿ git cloneï¼Œä½†åªè·Ÿè¸ªé€‰å®šçš„åˆ†æ”¯ $ mkdir project.git $ cd project.git $ git init $ git remote add -f -t master -m master origin git://example.com/git.git/ $ git merge origin fatalï¼šUnable to create &#x27;E:/project/scrm/.git/index.lock&#x27;: File exists. rm -f ./.git/index.lock git log -p æŸ¥çœ‹å·®å¼‚ -n(nä¸ºæ­£æ•´æ•°) æŸ¥çœ‹æœ€è¿‘næ¬¡çš„æäº¤ --pretty æŒ‰æŒ‡å®šæ ¼å¼æ˜¾ç¤ºæ—¥å¿—ä¿¡æ¯,å¯é€‰é¡¹æœ‰ï¼šoneline,short,medium,full,fuller,email,rawä»¥åŠformat:&lt;string&gt;,é»˜è®¤ä¸ºmediumï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æŒ‡å®šé»˜è®¤çš„ æ–¹å¼ã€‚ e.g. git log (--pretty=)oneline --stat åˆ—å‡ºæ–‡ä»¶çš„ä¿®æ”¹è¡Œæ•° --sortstat åªæ˜¾ç¤º--statä¸­æœ€åè¡Œæ•°ä¿®æ”¹æ·»åŠ ç§»é™¤çš„ç»Ÿè®¡ --graph ä»¥ç®€å•çš„å›¾å½¢æ–¹å¼åˆ—å‡ºæäº¤è®°å½• --abbrev-commit ä»…æ˜¾ç¤º SHA-1 çš„å‰å‡ ä¸ªå­—ç¬¦ï¼Œè€Œéæ‰€æœ‰çš„ 40 ä¸ªå­—ç¬¦ã€‚ --relative-date ä½¿ç”¨è¾ƒçŸ­çš„ç›¸å¯¹æ—¶é—´æ˜¾ç¤ºï¼ˆæ¯”å¦‚ï¼Œâ€œ2 weeks agoâ€ï¼‰ã€‚ --name-only ä»…åœ¨æäº¤ä¿¡æ¯åæ˜¾ç¤ºå·²ä¿®æ”¹çš„æ–‡ä»¶æ¸…å•ã€‚ --name-status æ˜¾ç¤ºæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤çš„æ–‡ä»¶æ¸…å•ã€‚ åˆ—å‡ºtag git tag # åœ¨æ§åˆ¶å°æ‰“å°å‡ºå½“å‰ä»“åº“çš„æ‰€æœ‰tag git tag -l â€˜v0.1.*â€™ # æœç´¢ç¬¦åˆæ¨¡å¼çš„Tag æ‰“tag git tagåˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šè½»é‡tagå’Œé™„æ³¨tagã€‚è½»é‡tagæ˜¯æŒ‡å‘æäº¤å¯¹è±¡çš„å¼•ç”¨ï¼Œé™„æ³¨Tagåˆ™æ˜¯ä»“åº“ä¸­çš„ä¸€ä¸ªç‹¬ç«‹å¯¹è±¡ã€‚å»ºè®®ä½¿ç”¨é™„æ³¨Tagã€‚ åˆ›å»ºè½»é‡Tag git tag v0.1.2-light åˆ›å»ºé™„æ³¨Tag git tag -a v0.1.2 -m â€œ0.1.2ç‰ˆæœ¬â€ åˆ›å»ºè½»é‡Tagä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œç›´æ¥æŒ‡å®šTagåç§°å³å¯ã€‚ åˆ›å»ºé™„æ³¨Tagæ—¶ï¼Œå‚æ•°aå³annotatedçš„ç¼©å†™ï¼ŒæŒ‡å®šTagç±»å‹ï¼Œåé™„Tagåã€‚å‚æ•°mæŒ‡å®šTagè¯´æ˜ï¼Œè¯´æ˜ä¿¡æ¯ä¼šä¿å­˜åœ¨Tagå¯¹è±¡ä¸­ã€‚ åˆ‡æ¢åˆ°Tagä¸åˆ‡æ¢åˆ†æ”¯å‘½ä»¤ç›¸åŒï¼Œç”¨ git checkout [tagname] æŸ¥çœ‹Tagä¿¡æ¯ç”¨git showå‘½ä»¤å¯ä»¥æŸ¥çœ‹Tagçš„ç‰ˆæœ¬ä¿¡æ¯ï¼š git show v0.1.2 åˆ é™¤Tagè¯¯æ‰“æˆ–éœ€è¦ä¿®æ”¹Tagæ—¶ï¼Œéœ€è¦å…ˆå°†Tagåˆ é™¤ï¼Œå†æ‰“æ–°Tagã€‚ git tag -d v0.1.2 # åˆ é™¤Tag å‚æ•°då³deleteçš„ç¼©å†™ï¼Œæ„ä¸ºåˆ é™¤å…¶åæŒ‡å®šçš„Tagã€‚ ç»™æŒ‡å®šçš„commitæ‰“Tag æ‰“Tagä¸å¿…è¦åœ¨headä¹‹ä¸Šï¼Œä¹Ÿå¯åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸Šæ‰“ï¼Œè¿™éœ€è¦ä½ çŸ¥é“æŸä¸ªæäº¤å¯¹è±¡çš„æ ¡éªŒå’Œï¼ˆé€šè¿‡git logè·å–ï¼‰ã€‚ è¡¥æ‰“Tag git tag -a v0.1.1 9fbc3d0 Tagæ¨é€åˆ°æœåŠ¡å™¨ é€šå¸¸çš„git pushä¸ä¼šå°†Tagå¯¹è±¡æäº¤åˆ°gitæœåŠ¡å™¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ˜¾å¼çš„æ“ä½œï¼š git push origin v0.1.2 # å°†v0.1.2 Tagæäº¤åˆ°gitæœåŠ¡å™¨ git push origin â€“-tags # å°†æœ¬åœ°æ‰€æœ‰Tagä¸€æ¬¡æ€§æäº¤åˆ°gitæœåŠ¡å™¨ æ³¨æ„ï¼šå¦‚æœæƒ³çœ‹ä¹‹å‰æŸä¸ªTagçŠ¶æ€ä¸‹çš„æ–‡ä»¶ï¼Œå¯ä»¥è¿™æ ·æ“ä½œ git tag æŸ¥çœ‹å½“å‰åˆ†æ”¯ä¸‹çš„Tag git checkout v0.21 æ­¤æ—¶ä¼šæŒ‡å‘æ‰“v0.21 Tagæ—¶çš„ä»£ç çŠ¶æ€ï¼Œï¼ˆä½†ç°åœ¨å¤„äºä¸€ä¸ªç©ºçš„åˆ†æ”¯ä¸Šï¼‰ åˆ é™¤è¿œç¨‹åˆ†æ”¯å’Œtagåœ¨Git v1.7.0 ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§è¯­æ³•åˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼š git push origin â€“delete åˆ é™¤tagè¿™ä¹ˆç”¨ï¼š git push origin â€“delete tag å¦åˆ™ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§è¯­æ³•ï¼Œæ¨é€ä¸€ä¸ªç©ºåˆ†æ”¯åˆ°è¿œç¨‹åˆ†æ”¯ï¼Œå…¶å®å°±ç›¸å½“äºåˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼š git push origin : è¿™æ˜¯åˆ é™¤tagçš„æ–¹æ³•ï¼Œæ¨é€ä¸€ä¸ªç©ºtagåˆ°è¿œç¨‹tagï¼š git tag -d git push origin :refs/tags/ é‡å‘½åè¿œç¨‹åˆ†æ”¯åˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼š git push â€“delete origin devel é‡å‘½åæœ¬åœ°åˆ†æ”¯ï¼š git branch -m devel develop æ¨é€æœ¬åœ°åˆ†æ”¯ï¼š git push origin develop æŠŠæœ¬åœ°tagæ¨é€åˆ°è¿œç¨‹ git push â€“tags # æ¨é€æ‰€æœ‰tag git push origin :tag # æ¨é€tag","categories":[{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"}],"tags":[{"name":"git","slug":"git","permalink":"https://github.13sai.com/tags/git/"}]},{"title":"atomic","slug":"atomic","date":"2021-02-13T04:48:20.000Z","updated":"2022-04-11T05:56:59.742Z","comments":true,"path":"2021/02/13/atomic/","link":"","permalink":"https://github.13sai.com/2021/02/13/atomic/","excerpt":"","text":"åœ¨ä¹‹å‰çš„æºç åˆ†æä¸­ï¼Œæˆ‘ä»¬æœ‰å¤šæ¬¡çœ‹åˆ°atomicçš„å‡ºç°ï¼Œä»Šå¤©ä¸å¦¨æˆ‘ä»¬çœ‹ä¸€ä¸‹atomicçš„æºç ã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹atomicçš„æºç æ–‡ä»¶ï¼š è¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼Œä»¥.sä¸ºåç¼€çš„æ˜¯æ±‡ç¼–è¯­è¨€æºä»£ç æ–‡ä»¶ï¼Œä½ å¯ä»¥å¹¶ä¸æ‡‚æ±‡ç¼–ï¼Œæ²¡æœ‰å…³ç³»ã€‚ ä¸»è¦çœ‹ä¸‹asm.sï¼Œçœ‹ä¸€çœ‹åˆ°é‡Œé¢æœ‰è°ƒç”¨runtime âˆ• internal âˆ• atomicï¼Œæˆ‘ä»¬å‰å»çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­æœ‰ä¸ªæ–‡ä»¶atomic_wasm.goã€‚ atomicæä¾›çš„æ˜¯åŸå­æ“ä½œï¼ŒatomicåŒ…ä¸­æ”¯æŒå…­ç§ç±»å‹ int32 uint32 int64 uint64 uintptr unsafe.Pointer å¯¹äºæ¯ä¸€ä¸ªç±»å‹ï¼Œæ”¯æŒ5ç§æ“ä½œï¼Œæˆ‘ä»¬ä»¥int32åˆ†åˆ«è¯´æ˜ä¸‹è¿™äº›æ“ä½œï¼š SwapX// åŸå­æ€§çš„å°†æ–°å€¼ä¿å­˜åˆ°*addrå¹¶è¿”å›æ—§å€¼ã€‚ func SwapInt32(addr *int32, new int32) (old int32) æºç ï¼š func Xchg(ptr *uint32, new uint32) uint32 &#123; old := *ptr *ptr = new return old &#125; CompareAndSwapX// åŸå­æ€§çš„æ¯”è¾ƒ*addrå’Œoldï¼Œå¦‚æœç›¸åŒåˆ™å°†newèµ‹å€¼ç»™*addrå¹¶è¿”å›çœŸã€‚ func CompareAndSwapInt32(addr *int32, old, new int32) (swapped bool) æºç ï¼š func Cas(ptr *uint32, old, new uint32) bool &#123; if *ptr == old &#123; *ptr = new return true &#125; return false &#125; AddX// åŸå­æ€§çš„å°†valçš„å€¼æ·»åŠ åˆ°*addrå¹¶è¿”å›æ–°å€¼ func AddInt64(addr *int64, delta int64) (new int64) æºç ï¼š func Xadd(ptr *uint32, delta int32) uint32 &#123; new := *ptr + uint32(delta) *ptr = new return new &#125; LoadX// åŸå­æ€§çš„è·å–*addrçš„å€¼ func LoadInt32(addr *int32) (val int32) æºç ï¼š func Load(ptr *uint32) uint32 &#123; return *ptr &#125; StoreX// åŸå­æ€§çš„å°†valçš„å€¼ä¿å­˜åˆ°*addr func StoreInt32(addr *int32, val int32) æºç ï¼š func Store(ptr *uint32, val uint32) &#123; *ptr = val &#125; æºç å…¶å®æ¯”è¾ƒç®€å•äº†ï¼Œæˆ‘å°±ä¸è¿‡å¤šè¯´æ˜äº†ã€‚ atomic.Valueå¦å¤–ï¼Œatomicå¯¹æ”¯æŒçš„ç±»å‹åšäº†æ‰©å±•ï¼Œatomic.Valueè¢«è®¾è®¡ç”¨æ¥å­˜å‚¨ä»»æ„ç±»å‹çš„æ•°æ®ã€‚ type Value struct &#123; v interface&#123;&#125; &#125; ä¸ºäº†æ–¹ä¾¿ï¼Œå®šä¹‰äº†ä¸€ä¸ªifaceWordsç±»å‹ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†interface&#123;&#125;ç±»å‹åˆ†è§£ï¼Œå¾—åˆ°å…¶ä¸­çš„ä¸¤ä¸ªå­—æ®µï¼Œä½œä¸ºinterfaceçš„å†…éƒ¨è¡¨ç¤ºæ ¼å¼ï¼Œtypä»£è¡¨åŸå§‹ç±»å‹ï¼Œdataä»£è¡¨çœŸæ­£çš„å€¼ã€‚ type ifaceWords struct &#123; typ unsafe.Pointer data unsafe.Pointer &#125; æä¾›äº†Storeå’ŒLoadä¸¤ä¸ªæ–¹æ³•ã€‚ Store func (v *Value) Store(x interface&#123;&#125;) &#123; // xä¸ºnilï¼Œç›´æ¥panic if x == nil &#123; panic(&quot;sync/atomic: store of nil value into Value&quot;) &#125; // å°†ç°æœ‰çš„å€¼å’Œè¦å†™å…¥çš„å€¼è½¬æ¢ä¸ºifaceWordsç±»å‹ï¼Œè¿™æ ·ä¸‹ä¸€æ­¥å°±èƒ½è·å–åˆ°å®ƒä»¬çš„åŸå§‹ç±»å‹å’ŒçœŸæ­£çš„å€¼ vp := (*ifaceWords)(unsafe.Pointer(v)) xp := (*ifaceWords)(unsafe.Pointer(&amp;x)) for &#123; // è·å–ç°æœ‰çš„å€¼çš„type typ := LoadPointer(&amp;vp.typ) // å¦‚æœtypä¸ºnilè¯´æ˜è¿™æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨Store if typ == nil &#123; // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œå°±å ä½å½“å‰çš„processorï¼Œä¸å…è®¸å…¶ä»–goroutineå†æŠ¢ï¼Œruntime_procPinæ–¹æ³•ä¼šå…ˆè·å–å½“å‰goroutine runtime_procPin() // ä½¿ç”¨CASæ“ä½œï¼Œå…ˆå°è¯•å°†typè®¾ç½®ä¸º^uintptr(0)è¿™ä¸ªä¸­é—´çŠ¶æ€ // å¦‚æœå¤±è´¥ï¼Œåˆ™è¯æ˜å·²ç»æœ‰åˆ«çš„goroutineæŠ¢å…ˆå®Œæˆäº†èµ‹å€¼æ“ä½œ // é‚£å®ƒå°±è§£é™¤æŠ¢å é”ï¼Œç»§ç»­å¾ªç¯ç­‰å¾… if !CompareAndSwapPointer(&amp;vp.typ, nil, unsafe.Pointer(^uintptr(0))) &#123; runtime_procUnpin() continue &#125; // å¦‚æœè®¾ç½®æˆåŠŸï¼Œå°±åŸå­æ€§çš„æ›´æ–°å¯¹åº”çš„æŒ‡é’ˆï¼Œæœ€åè§£é™¤æŠ¢å é” StorePointer(&amp;vp.data, xp.data) StorePointer(&amp;vp.typ, xp.typ) runtime_procUnpin() return &#125; // å¦‚æœtypä¸º^uintptr(0)è¯´æ˜ç¬¬ä¸€æ¬¡å†™å…¥è¿˜æ²¡æœ‰å®Œæˆï¼Œç»§ç»­å¾ªç¯ç­‰å¾… if uintptr(typ) == ^uintptr(0) &#123; continue &#125; // å¦‚æœè¦å†™å…¥çš„ç±»å‹å’Œç°æœ‰çš„ç±»å‹ä¸ä¸€è‡´ï¼Œåˆ™panic if typ != xp.typ &#123; panic(&quot;sync/atomic: store of inconsistently typed value into Value&quot;) &#125; // æ›´æ–°dataï¼Œè·³å‡ºå¾ªç¯ StorePointer(&amp;vp.data, xp.data) return &#125; &#125; Load func (v *Value) Load() (x interface&#123;&#125;) &#123; // å°†*ValueæŒ‡é’ˆç±»å‹è½¬æ¢ä¸º*ifaceWordsæŒ‡é’ˆç±»å‹ vp := (*ifaceWords)(unsafe.Pointer(v)) // åŸå­æ€§çš„è·å–åˆ°vçš„ç±»å‹typçš„æŒ‡é’ˆ typ := LoadPointer(&amp;vp.typ) // å¦‚æœæ²¡æœ‰å†™å…¥æˆ–è€…æ­£åœ¨å†™å…¥ï¼Œå…ˆè¿”å›ï¼Œ^uintptr(0)ä»£è¡¨è¿‡æ¸¡çŠ¶æ€ï¼Œè¿™å’ŒStoreæ˜¯å¯¹åº”çš„ if typ == nil || uintptr(typ) == ^uintptr(0) &#123; return nil &#125; // åŸå­æ€§çš„è·å–åˆ°vçš„çœŸæ­£çš„å€¼dataçš„æŒ‡é’ˆï¼Œç„¶åè¿”å› data := LoadPointer(&amp;vp.data) xp := (*ifaceWords)(unsafe.Pointer(&amp;x)) xp.typ = typ xp.data = data return &#125; PS:è§£è¯»çš„æºç ï¼Œå¦‚æ— ç‰¹åˆ«è¯´æ˜ï¼Œç‰ˆæœ¬ä¸º1.15.6 å‚è€ƒï¼š goæ ‡å‡†åº“ Go - atomicåŒ…ä½¿ç”¨åŠatomic.Valueæºç åˆ†æ","categories":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/categories/gosourcecode/"}],"tags":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/tags/gosourcecode/"}]},{"title":"æ­å»ºhttp server","slug":"goexample1","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:30:49.836Z","comments":true,"path":"2021/02/12/goexample1/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample1/","excerpt":"","text":"round oneï¼Œæˆ‘ä»¬æ¥ç‚¹ç®€å•çš„ï¼Œæ­å»ºä¸€ä¸ªç®€å•çš„http serverã€‚ ç›®æ ‡ï¼š è·¯ç”±helloæ¥æ”¶å‚æ•°å¹¶è·å–åˆ°è¾“å‡ºjsonæ•°æ® è‡ªå®šä¹‰404 å¤„ç†è¶…æ—¶é¡µé¢ ä½¿ç”¨åˆ°çš„åº“: net/http time encoding/json æˆ‘ä»¬å…ˆæ­å»ºèµ·æ¥serverï¼š package main import ( &quot;net/http&quot; ) func main() &#123; srv := http.Server&#123; Addr: &quot;:8080&quot;, Handler: http.HandlerFunc(defaultHttp), &#125; srv.ListenAndServe() &#125; // é»˜è®¤httpå¤„ç† func defaultHttp(w http.ResponseWriter, r *http.Request) &#123; w.Write([]byte(&quot;wow&quot;)) &#125; è¿è¡Œå°±å¯ä»¥è·‘èµ·æ¥äº†ã€‚ æˆ‘ä»¬å†æ¥å®šä¹‰ä¸‹jsonè¾“å‡ºæ ¼å¼ã€‚ // è‡ªå®šä¹‰è¿”å› type JsonRes struct &#123; Code int `json:&quot;code&quot;` Data interface&#123;&#125; `json:&quot;data&quot;` Msg string `json:&quot;msg&quot;` TimeStamp int64 `json:&quot;timestmap&quot;` &#125; func apiResult(w http.ResponseWriter, code int, data interface&#123;&#125;, msg string) &#123; body, _ := json.Marshal(JsonRes&#123; Code: code, Data: data, Msg: msg, // è·å–æ—¶é—´æˆ³ TimeStamp: time.Now().Unix(), &#125;) w.Write(body) &#125; å†æ¥çœ‹ä¸€ä¸‹æ¥æ”¶å‚æ•°ä¸è¾“å‡ºï¼š // å¤„ç†helloï¼Œå¹¶æ¥æ”¶å‚æ•°è¾“å‡ºjson func sayHello(w http.ResponseWriter, r *http.Request) &#123; query := r.URL.Query() // ç¬¬ä¸€ç§æ–¹å¼ï¼Œä½†æ˜¯æ²¡æœ‰nameå‚æ•°ä¼šæŠ¥é”™ // name := query[&quot;name&quot;][0] // ç¬¬äºŒç§æ–¹å¼ name := query.Get(&quot;name&quot;) apiResult(w, 0, name+&quot; say &quot;+r.PostFormValue(&quot;some&quot;), &quot;success&quot;) &#125; è¶…æ—¶å¤„ç†ï¼š Handler: http.TimeoutHandler(http.HandlerFunc(defaultHttp), 2*time.Second, &quot;Timeout!!!&quot;) 404: http.Error(w, &quot;you lost???&quot;, http.StatusNotFound) æœ€ååŠ å…¥è·¯ç”±å¤„ç†ï¼š func defaultHttp(w http.ResponseWriter, r *http.Request) &#123; path, httpMethod := r.URL.Path, r.Method if path == &quot;/&quot; &#123; w.Write([]byte(&quot;index&quot;)) return &#125; if path == &quot;/hello&quot; &amp;&amp; httpMethod == &quot;POST&quot; &#123; sayHello(w, r) return &#125; if path == &quot;/sleep&quot; &#123; // æ¨¡æ‹Ÿä¸€ä¸‹ä¸šåŠ¡å¤„ç†è¶…æ—¶ time.Sleep(4*time.Second) return &#125; if path == &quot;/path&quot; &#123; w.Write([]byte(&quot;path:&quot;+path+&quot;, method:&quot;+httpMethod)) return &#125; // è‡ªå®šä¹‰404 http.Error(w, &quot;you lost???&quot;, http.StatusNotFound) &#125; æˆ‘ä»¬è¿è¡Œèµ·æ¥çœ‹ä¸‹æ•ˆæœï¼š 404æ•ˆæœ hello é¦–é¡µ è¶…æ—¶ è¿™æ ·å°±å®Œæˆäº†ä¸€ä¸ªç®€å•çš„http serverï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Ÿ å®Œæ•´ä»£ç github","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"go+MongoDBå®ç°é™„è¿‘çš„äºº","slug":"goexample10","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:31:25.213Z","comments":true,"path":"2021/02/12/goexample10/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample10/","excerpt":"","text":"åœ¨O2Oä¸ç¤¾äº¤åœºæ™¯ä¸­ï¼Œæœç´¢é™„è¿‘çš„äººã€é™„è¿‘çš„å•†å®¶æ˜¯å¾ˆå¸¸è§çš„åœºæ™¯ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å®ç°å‘¢ï¼Ÿ æ¥è§¦çš„æ–¹æ³•æœ‰ï¼š åæ ‡+çƒä½“è·ç¦»è®¡ç®—å…¬å¼ åŸºäºRedisçš„geo åŸºäºMongoDBçš„geohash å‰é¢çš„demoå·²ç»æœ‰æ¥è§¦Redisï¼Œè¿™é‡Œæˆ‘ä»¬å°±ç”¨mongoDBæ¥å®ç°ä¸€ä¸‹ã€‚ æˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨å®˜æ–¹çš„å®ç°å¥½äº†ï¼š go.mongodb.org/mongo-driver/mongo è¿æ¥opt := options.Client().ApplyURI(&quot;mongodb://root:211111@localhost:27017&quot;) // Connect to MongoDB client, err := mongo.Connect(context.TODO(), opt) if err != nil &#123; log.Fatal(err) &#125; // Check the connection err = client.Ping(context.TODO(), nil) if err != nil &#123; log.Fatal(err) &#125; fmt.Println(&quot;Connected to MongoDB!&quot;) æˆ‘ä»¬å¯ä»¥è®¾ç½®æ›´å¤šï¼š opt.SetLocalThreshold(3 * time.Second) //åªä½¿ç”¨ä¸mongoæ“ä½œè€—æ—¶å°äº3ç§’çš„ opt.SetMaxConnIdleTime(5 * time.Second) //æŒ‡å®šè¿æ¥å¯ä»¥ä¿æŒç©ºé—²çš„æœ€å¤§æ¯«ç§’æ•° opt.SetMaxPoolSize(200) //ä½¿ç”¨æœ€å¤§çš„è¿æ¥æ•° opt.SetReadConcern(readconcern.Majority()) //æŒ‡å®šæŸ¥è¯¢åº”è¿”å›å®ä¾‹çš„æœ€æ–°æ•°æ®ç¡®è®¤ä¸ºï¼Œå·²å†™å…¥å‰¯æœ¬é›†ä¸­çš„å¤§å¤šæ•°æˆå‘˜ model// åæ ‡ type Location struct &#123; Type string `json:&quot;type&quot; bson:&quot;type&quot;` Coordinates []float64 `json:&quot;coordinates&quot; bson:&quot;coordinates&quot;` &#125; // æ¯ä¸ªç‚¹ type Point struct &#123; Name string `json:&quot;name&quot;` Age int `json:&quot;age&quot;` City string `json:&quot;city&quot;` Location Location `json:&quot;location&quot;` &#125; æ•°æ®å†™å…¥æˆ‘ä»¬å¯ä»¥å…ˆæ’å…¥æ•°æ® func(mgo *mgo) Start() &#123; collection := mgo.client.Database(DBName).Collection(CollectionName) // è®¾ç½®ç´¢å¼• 2dsphereï¼Œ å¾ˆé‡è¦ collection.Indexes().CreateOne(context.TODO(), mongo.IndexModel&#123; Keys: bson.M&#123;Key: &quot;2dsphere&quot;&#125;, &#125;) a := Point&#123;&quot;ç‹äºŒ&quot;, 18, &quot;æ­å·&quot;, Location&#123;&quot;Point&quot;, []float64&#123;120.185614,30.300738&#125;&#125;&#125; b := Point&#123;&quot;å¼ ä¸‰&quot;, 25, &quot;æ­å·&quot;, Location&#123;&quot;Point&quot;, []float64&#123;120.094778,30.310217&#125;&#125;&#125; c := Point&#123;&quot;å°æ™´&quot;, 35, &quot;ç»å…´&quot;, Location&#123;&quot;Point&quot;, []float64&#123;120.603847,30.054237&#125;&#125;&#125; d := Point&#123;&quot;æå››&quot;, 34, &quot;æ­å·&quot;, Location&#123;&quot;Point&quot;, []float64&#123;120.110893,30.207849&#125;&#125;&#125; e := Point&#123;&quot;å°æ˜&quot;, 24, &quot;åŒ—äº¬&quot;, Location&#123;&quot;Point&quot;, []float64&#123;116.435721,39.914031&#125;&#125;&#125; f := Point&#123;&quot;å´å…­&quot;, 25, &quot;æ­å·&quot;, Location&#123;&quot;Point&quot;, []float64&#123;120.126443,30.33084&#125;&#125;&#125; h := Point&#123;&quot;äºä¸€&quot;, 23, &quot;æ­å·&quot;, Location&#123;&quot;Point&quot;, []float64&#123;120.28132,30.184083&#125;&#125;&#125; j := Point&#123;&quot;å°ä¸ƒ&quot;, 14, &quot;æ­å·&quot;, Location&#123;&quot;Point&quot;, []float64&#123;119.73926,30.247639&#125;&#125;&#125; // å•æ¡æ’å…¥ insertResult, err := collection.InsertOne(context.TODO(), a) if err != nil &#123; log.Fatal(err) &#125; fmt.Println(&quot;Inserted a single document: &quot;, insertResult.InsertedID) ps := []interface&#123;&#125;&#123;b, c, d, e, f, h, j&#125; // æ‰¹é‡æ’å…¥ insertManyResult, err := collection.InsertMany(context.TODO(), ps) if err != nil &#123; log.Fatal(err) &#125; fmt.Println(&quot;Inserted multiple documents: &quot;, insertManyResult.InsertedIDs) &#125; æ³¨æ„ï¼Œè®¾ç½®ç´¢å¼• 2dsphereï¼Œ å¾ˆé‡è¦ï¼ï¼ï¼ å­˜å‚¨çš„æ•°æ®æ ¼å¼ æˆ‘ä»¬æŸ¥æ‰¾ï¼š func (mgo *mgo) Near() &#123; collection := mgo.client.Database(DBName).Collection(CollectionName) // æŸ¥æ‰¾120.110893,30.2078490åæ ‡é™„è¿‘15000ç±³çš„äºº cur, err := collection.Find(context.TODO(), bson.D&#123; &#123;Key, bson.D&#123; &#123;&quot;$near&quot;, bson.D&#123; &#123; &quot;$geometry&quot;, Location&#123; &quot;Point&quot;, []float64&#123;120.110893,30.2078490&#125;, &#125;, &#125;, &#123;&quot;$maxDistance&quot;, 15000&#125;, // å•ä½ç±³ &#125;&#125;, &#125;&#125;, &#125;) if err != nil &#123; fmt.Println(err) return &#125; var results []Point for cur.Next(context.TODO()) &#123; var elem Point err := cur.Decode(&amp;elem) fmt.Println(elem) fmt.Println(cur) if err != nil &#123; fmt.Println(&quot;Could not decode Point&quot;) return &#125; results = append(results, elem) &#125; fmt.Println(&quot;æŸ¥æ‰¾åˆ°&quot;, len(results)) &#125; æˆ‘ä»¬ä¸å¦¨è¿è¡Œä¸€ä¸‹ï¼š èƒ½æˆåŠŸæŸ¥æ‰¾å‡ºäº†é™„è¿‘çš„äººã€‚ é‚£ä¹ˆï¼Œå¦‚ä½•è®¡ç®—è·ç¦»å‘¢ï¼Ÿ å¯ä»¥ç»çº¬åº¦è®¡ç®—ï¼Œä¹Ÿå¯ä»¥ç›´æ¥mongoDBèšåˆæŸ¥è¯¢ï¼Œå¯ä»¥è‡ªè¡Œæ€ç´¢ï¼Œå‚è€ƒä»£ç ç‚¹å‡»è§githubã€‚","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"åˆ©ç”¨ginæ­å»ºä¸€ä¸ªapiæ¡†æ¶","slug":"goexample2","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:30:52.906Z","comments":true,"path":"2021/02/12/goexample2/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample2/","excerpt":"","text":"åœ¨demo1ä¸­ï¼Œæˆ‘ä»¬ç®€å•ä½¿ç”¨äº†net/httpæ­å»ºäº†ä¸€ä¸ªserverï¼Œå…¶å®åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæ¯”è¾ƒå°‘å»ä½¿ç”¨æ ‡å‡†åº“å»ç›´æ¥å†™apiï¼Œæ›´å¤šçš„æ˜¯ä½¿ç”¨å‰äººæ­å»ºå¥½çš„è½®å­ï¼ˆæˆ‘å‘¢ï¼Œæ˜¯ä¸ªä¸å¤ªå–œæ¬¢é‡å¤é€ è½®å­çš„å¼€å‘è€…ï¼Œæœ‰å¼€æºçš„é è°±çš„ï¼Œç›´æ¥ç”¨å°±å¥½ï¼Œè‡ªå·±è°ƒæ•´æˆè‡ªå·±éœ€è¦çš„å³å¯ï¼‰ï¼Œé‚£ä¹ˆè¯´çš„goçš„æ¡†æ¶ï¼Œä¸å¾—ä¸è¯´ginäº†ã€‚ å¯¹äºginçš„ä»‹ç»ï¼Œæ˜¯githubä¸Šstaræœ€å¤šçš„goæ¡†æ¶äº†ï¼Œå…¶ä»–ä¸å¤šè¯´ï¼Œæˆ‘ä»¬ä¸Šæ‰‹å†™èµ·æ¥å§ï¼ ç›®æ ‡ï¼š è‡ªå®šä¹‰é…ç½® æ•´åˆmysqlå’Œredis ç‹¬ç«‹è·¯ç”±ç®¡ç† æ—¥å¿— å¹³æ»‘é‡å¯ è„šæœ¬æ‰“åŒ… ä½¿ç”¨åˆ°çš„åº“ï¼š github.com/fsnotify/fsnotify github.com/gin-gonic/gin github.com/go-redis/redis github.com/jinzhu/gorm http://github.com/lestrrat-go/file-rotatelogs http://go.uber.org/zap github.com/spf13/pflag github.com/spf13/viper åˆå§‹åŒ–modulesçš„å¼•å…¥ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸å¿…ä½¿ç”¨gopathå»ç®¡ç†é¡¹ç›®ç›®å½•äº†ï¼Œå¯¹äºmodulesçš„åŸºæœ¬ä½¿ç”¨ï¼Œå»ºè®®çœ‹æ–‡ç« ï¼š gomodules æˆ‘ä»¬å¼€å§‹ï¼š go mod init sai0556/demo2-gin-frame å› ä¸ºæˆ‘ä»¬æš‚æ—¶æœ¬åœ°å¼€å‘ï¼š PSï¼šå½“æ—¶ç†è§£æœ‰è¯¯ï¼Œå…¶å®æ— éœ€åšlocal.comæ›¿æ¢ï¼Œimportç›´æ¥ä½¿ç”¨sai0556/demo2-gin-frameå³å¯ï¼Œè¿™é‡Œæœ‰ç‚¹å¤šä½™ // ä½¿ç”¨æœ¬åœ°module go mod edit -require=local.com/sai0556/demo2-gin-frame@v1.0.0 go mod edit -replace=local.com/sai0556/demo2-gin-frame@v1.0.0=$PWD å¯ä»¥çœ‹åˆ°go.modå·²ç”Ÿæˆï¼š module sai0556/demo2-gin-frame go 1.13 require local.com/sai0556/demo2-gin-frame v1.0.0 replace local.com/sai0556/demo2-gin-frame v1.0.0 =&gt; /Users/@/Work/golang/go-example/demo2-gin-frame /Users/@/Work/golang/go-example/demo2-gin-frame æ­¤ç›®å½•å°±æ˜¯é¡¹ç›®ç›®å½•ï¼Œè§†å…·ä½“æƒ…å†µä¸ä¸€ è‡ªå®šä¹‰é…ç½®ä¸è¯»å–ï¼šåœ¨æˆ‘ä»¬ä½¿ç”¨rediså’Œmysqlä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è¯»å–ä¸€ä¸‹é…ç½®ï¼Œé…ç½®å‘¢æˆ‘ä»¬ä½¿ç”¨å¸¸è§çš„yamlï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ï¼Œæ¯”å¦‚envç­‰ã€‚ æ–°å»ºconfigç›®å½•ï¼Œç”¨æ¥è¯»å–ä¸ç›‘å¬é…ç½®æ–‡ä»¶(config.yaml)ï¼š package config import ( &quot;fmt&quot; &quot;github.com/fsnotify/fsnotify&quot; &quot;github.com/spf13/viper&quot; ) type Config struct &#123; Name string &#125; // å¯¹å¤–çš„åˆå§‹åŒ–é…ç½®æ–¹æ³• func Run(cfg string) error &#123; c := Config&#123; Name: cfg, &#125; if err := c.init(); err != nil &#123; return err &#125; c.watchConfig() return nil &#125; func (c *Config) init() error &#123; if c.Name != &quot;&quot; &#123; viper.SetConfigFile(c.Name) &#125; else &#123; // é»˜è®¤é…ç½®æ–‡ä»¶æ˜¯./config.yaml viper.AddConfigPath(&quot;.&quot;) viper.SetConfigName(&quot;config&quot;) &#125; viper.SetConfigType(&quot;yaml&quot;) // viperè§£æé…ç½®æ–‡ä»¶ err := viper.ReadInConfig() if err != nil &#123; panic(fmt.Errorf(&quot;Fatal error config file: %s \\n&quot;, err)) &#125; // ç®€å•æ‰“å°ä¸‹é…ç½® fmt.Println(viper.GetString(&quot;name&quot;)) return nil &#125; func (c *Config) watchConfig() &#123; viper.WatchConfig() viper.OnConfigChange(func(e fsnotify.Event) &#123; fmt.Println(&quot;Config file changed:&quot;, e.Name) &#125;) &#125; main: package main import ( &quot;github.com/spf13/pflag&quot; &quot;local.com/sai0556/demo2-gin-frame/config&quot; ) var ( conf = pflag.StringP(&quot;config&quot;, &quot;c&quot;, &quot;&quot;, &quot;config filepath&quot;) ) func main() &#123; pflag.Parse() // åˆå§‹åŒ–é…ç½® if err := config.Run(*conf); err != nil &#123; panic(err) &#125; &#125; è¿™é‡Œæœ‰ç”¨åˆ°å¤§ç‰›spf13çš„ä¸¤ä¸ªåŒ…ï¼Œpflagå’Œviperï¼Œå‘½ä»¤è¡Œå‚æ•°è§£æåŒ…pflagå¯ä»¥çœ‹ä½œflagçš„è¿›é˜¶ç‰ˆæœ¬ï¼Œåœ¨æˆ‘ä»¬è¿™é‡Œå¯ä»¥ç”¨æ¥æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œviperæ˜¯è¯»å–é…ç½®æ–‡ä»¶çš„åŒ…ï¼Œé…åˆfsnotifyå¯ä»¥å®ç°é…ç½®çš„çƒ­æ›´æ–°ã€‚ï¼ˆspf13å¤§ç¥è¿˜æœ‰å…¶ä»–æœ‰ç”¨çš„åŒ…ï¼Œç›¸ä¿¡åœ¨ä½ çš„goç¼–ç ç”Ÿæ¶¯ä¼šç”¨åˆ°çš„ï¼‰ å†™å®Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸€ä¸‹ï¼š go run main.go -c ./config.yaml å¯ä»¥çœ‹åˆ°æœ‰æ‰“å°å‡ºæˆ‘ä»¬é…ç½®çš„nameã€‚ æ•´åˆmysqlä¸redismysqlåŒ…æˆ‘ä»¬å°±é€‰ç”¨gormï¼Œredisçš„ä½¿ç”¨æ¯”è¾ƒå¤šçš„æ˜¯redigoå’Œgo-redisï¼Œredigoæ›¾åœ¨æˆ‘ä½¿ç”¨ä¸­å‡ºç°è¿‡é—®é¢˜ï¼Œå› è€Œæˆ‘ä»¬é€‰æ‹©åè€…ï¼Œåè€…ä¹Ÿæ”¯æŒè¿æ¥æ± ã€‚ mysqlï¼š package db import ( &quot;fmt&quot; &quot;sync&quot; &quot;errors&quot; orm &quot;github.com/jinzhu/gorm&quot; _ &quot;github.com/jinzhu/gorm/dialects/mysql&quot; &quot;github.com/spf13/viper&quot; ) type MySqlPool struct &#123;&#125; var instance *MySqlPool var once sync.Once var db *orm.DB var err error // å•ä¾‹æ¨¡å¼ func GetInstance() *MySqlPool &#123; once.Do(func() &#123; instance = &amp;MySqlPool&#123;&#125; &#125;) return instance &#125; func (pool *MySqlPool) InitPool() (isSuc bool) &#123; // è¿™é‡Œæœ‰ä¸€ç§å¸¸è§çš„æ‹¼æ¥å­—ç¬¦ä¸²çš„æ–¹å¼ dsn := fmt.Sprintf(&quot;%s:%s@tcp(%s)/%s?charset=%s&quot;, viper.GetString(&quot;db.username&quot;), viper.GetString(&quot;db.password&quot;), viper.GetString(&quot;db.host&quot;), viper.GetString(&quot;db.name&quot;), viper.GetString(&quot;db.charset&quot;)) db, err = orm.Open(&quot;mysql&quot;, dsn) if err != nil &#123; panic(errors.New(&quot;mysqlè¿æ¥å¤±è´¥&quot;)) return false &#125; // è¿æ¥æ•°é…ç½®ä¹Ÿå¯ä»¥å†™å…¥é…ç½®ï¼Œåœ¨æ­¤è¯»å– db.DB().SetMaxIdleConns(viper.GetInt(&quot;db.MaxIdleConns&quot;)) db.DB().SetMaxOpenConns(viper.GetInt(&quot;db.MaxOpenConns&quot;)) // db.LogMode(true) return true &#125; åé¢è·å–è¿æ¥æ± å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ db.GetInstance() redisï¼š package db import ( &quot;fmt&quot; &quot;github.com/spf13/viper&quot; &quot;github.com/go-redis/redis&quot; ) var RedisClient *redis.Client func InitRedis() &#123; RedisClient = redis.NewClient(&amp;redis.Options&#123; Addr: fmt.Sprintf(&quot;%s:%s&quot;, viper.GetString(&quot;redis.host&quot;), viper.GetString(&quot;redis.port&quot;)), Password: viper.GetString(&quot;redis.auth&quot;), DB: 0, &#125;) _, err := RedisClient.Ping().Result() if err != nil &#123; panic(&quot;redis ping error&quot;) &#125; &#125; RedisClientå°±æ˜¯æˆ‘ä»¬åé¢å¯ä»¥ç”¨çš„redisè¿æ¥æ± ã€‚ åœ¨mainä¸­åŠ å…¥åˆå§‹åŒ–è¿æ¥æ± çš„ä»£ç å³å¯ï¼š // è¿æ¥mysqlæ•°æ®åº“ btn := db.GetInstance().InitPool() if !btn &#123; log.Println(&quot;init database pool failure...&quot;) panic(errors.New(&quot;init database pool failure&quot;)) &#125; // redis db.InitRedis() è·¯ç”±ä¸æ§åˆ¶å™¨ä¸ºäº†æ–¹ä¾¿è·¯ç”±ï¼Œæˆ‘ä»¬æŠŠè·¯ç”±ç®¡ç†å•ç‹¬åˆ°routerã€‚ package router import ( &quot;net/http&quot; &quot;github.com/gin-gonic/gin&quot; &quot;local.com/sai0556/demo2-gin-frame/controller&quot; ) func Load(g *gin.Engine) *gin.Engine &#123; g.Use(gin.Recovery()) // 404 g.NoRoute(func (c *gin.Context) &#123; c.String(http.StatusNotFound, &quot;404 not found&quot;); &#125;) g.GET(&quot;/&quot;, controller.Index) return g &#125; controller: package controller import ( &quot;net/http&quot; &quot;github.com/gin-gonic/gin&quot; ) // è¿”å› type Response struct &#123; Code int `json:&quot;code&quot;` Message string `json:&quot;message&quot;` Data interface&#123;&#125; `json:&quot;data&quot;` &#125; // apiè¿”å›ç»“æ„ func ApiResponse(c *gin.Context, code int, message string, data interface&#123;&#125;) &#123; c.JSON(http.StatusOK, Response&#123; Code: code, Message: message, Data: data, &#125;) &#125; func Index(c *gin.Context) &#123; ApiResponse(c, 0, &quot;success&quot;, nil) &#125; åˆ°è¿™å‘¢ï¼ŒåŸºæœ¬ä¹Ÿå°±å·®ä¸å¤šäº†ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹å®Œæ•´çš„mainï¼š package main // import è¿™é‡Œæˆ‘ä¹ æƒ¯æŠŠå®˜æ–¹åº“ï¼Œå¼€æºåº“ï¼Œæœ¬åœ°moduleä¾æ¬¡åˆ†å¼€åˆ—å‡º import ( &quot;log&quot; &quot;errors&quot; &quot;github.com/spf13/pflag&quot; &quot;github.com/spf13/viper&quot; &quot;github.com/gin-gonic/gin&quot; &quot;local.com/sai0556/demo2-gin-frame/config&quot; &quot;local.com/sai0556/demo2-gin-frame/db&quot; &quot;local.com/sai0556/demo2-gin-frame/router&quot; ) var ( conf = pflag.StringP(&quot;config&quot;, &quot;c&quot;, &quot;&quot;, &quot;config filepath&quot;) ) func main() &#123; pflag.Parse() // åˆå§‹åŒ–é…ç½® if err := config.Run(*conf); err != nil &#123; panic(err) &#125; // è¿æ¥mysqlæ•°æ®åº“ btn := db.GetInstance().InitPool() if !btn &#123; log.Println(&quot;init database pool failure...&quot;) panic(errors.New(&quot;init database pool failure&quot;)) &#125; // redis db.InitRedis() gin.SetMode(viper.GetString(&quot;mode&quot;)) g := gin.New() g = router.Load(g) g.Run(viper.GetString(&quot;addr&quot;)) &#125; æ•´åˆæ—¥å¿—è¿™é‡Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸‹logï¼š log: level: debug # æ—¥å¿—çº§åˆ«ï¼Œinfoï¼Œdebugï¼Œerror file_format: &quot;%Y%m%d&quot; # æ–‡ä»¶æ ¼å¼ max_save_days: 30 # ä¿å­˜å¤©æ•° file_type: one # one, level å•æ–‡ä»¶å­˜å‚¨è¿˜æ˜¯ä»¥levelçº§åˆ«å­˜å‚¨ æ•´åˆloggerï¼š package logger import ( &quot;io&quot; &quot;log&quot; &quot;time&quot; &quot;github.com/lestrrat-go/file-rotatelogs&quot; &quot;go.uber.org/zap&quot; &quot;go.uber.org/zap/zapcore&quot; &quot;github.com/spf13/viper&quot; ) var Logger *zap.Logger var LogLevel string var FileFormat string // åˆå§‹åŒ–æ—¥å¿— logger func init() &#123; // è®¾ç½®ä¸€äº›åŸºæœ¬æ—¥å¿—æ ¼å¼ config := zapcore.EncoderConfig&#123; MessageKey: &quot;msg&quot;, LevelKey: &quot;level&quot;, EncodeLevel: zapcore.CapitalLevelEncoder, TimeKey: &quot;ts&quot;, EncodeTime: func(t time.Time, enc zapcore.PrimitiveArrayEncoder) &#123; enc.AppendString(t.Format(&quot;2006-01-02 15:04:05&quot;)) &#125;, CallerKey: &quot;file&quot;, EncodeCaller: zapcore.ShortCallerEncoder, EncodeDuration: func(d time.Duration, enc zapcore.PrimitiveArrayEncoder) &#123; enc.AppendInt64(int64(d) / 1000000) &#125;, &#125; encoder := zapcore.NewConsoleEncoder(config) FileFormat, saveType, LogLevel := &quot;%Y%m%d&quot;, &quot;one&quot;, &quot;info&quot; if viper.IsSet(&quot;log.file_format&quot;) &#123; FileFormat = viper.GetString(&quot;log.file_format&quot;) &#125; if viper.IsSet(&quot;log.level&quot;) &#123; LogLevel = viper.GetString(&quot;log.level&quot;) &#125; if viper.IsSet(&quot;log.save_type&quot;) &#123; saveType = viper.GetString(&quot;log.save_type&quot;) &#125; logLevel := zap.DebugLevel switch LogLevel &#123; case &quot;debug&quot;: logLevel = zap.DebugLevel case &quot;info&quot;: logLevel = zap.InfoLevel case &quot;error&quot;: logLevel = zap.ErrorLevel default: logLevel = zap.InfoLevel &#125; switch saveType &#123; case &quot;level&quot;: Logger = getLevelLogger(encoder, logLevel, FileFormat) default: Logger = getOneLogger(encoder, logLevel, FileFormat) &#125; &#125; func getLevelLogger(encoder zapcore.Encoder, logLevel zapcore.Level, fileFormat string) *zap.Logger &#123; infoLevel := zap.LevelEnablerFunc(func(lvl zapcore.Level) bool &#123; return lvl == zapcore.InfoLevel &amp;&amp; lvl &gt;= logLevel &#125;) debugLevel := zap.LevelEnablerFunc(func(lvl zapcore.Level) bool &#123; return lvl == zapcore.DebugLevel &amp;&amp; lvl &gt;= logLevel &#125;) errorLevel := zap.LevelEnablerFunc(func(lvl zapcore.Level) bool &#123; return lvl &gt;= zapcore.ErrorLevel &amp;&amp; lvl &gt;= logLevel &#125;) // è·å– infoã€warnæ—¥å¿—æ–‡ä»¶çš„io.Writer æŠ½è±¡ getLoggerWriter() åœ¨ä¸‹æ–¹å®ç° infoWriter := getLoggerWriter(&quot;./log/info&quot;, fileFormat) errorWriter := getLoggerWriter(&quot;./log/error&quot;, fileFormat) debugWriter := getLoggerWriter(&quot;./log/debug&quot;, fileFormat) // æœ€ååˆ›å»ºå…·ä½“çš„Logger core := zapcore.NewTee( zapcore.NewCore(encoder, zapcore.AddSync(debugWriter), debugLevel), zapcore.NewCore(encoder, zapcore.AddSync(infoWriter), infoLevel), zapcore.NewCore(encoder, zapcore.AddSync(errorWriter), errorLevel), ) return zap.New(core, zap.AddCaller(), zap.AddStacktrace(zap.WarnLevel)) &#125; func getOneLogger(encoder zapcore.Encoder, logLevel zapcore.Level, fileFormat string) *zap.Logger &#123; infoWriter := getLoggerWriter(&quot;./log/info&quot;, fileFormat) infoLevel := zap.LevelEnablerFunc(func(lvl zapcore.Level) bool &#123; return lvl == zapcore.InfoLevel &amp;&amp; lvl &gt;= logLevel &#125;) core := zapcore.NewTee( zapcore.NewCore(encoder, zapcore.AddSync(infoWriter), infoLevel), ) return zap.New(core, zap.AddCaller(), zap.AddStacktrace(zap.WarnLevel)) &#125; func getLoggerWriter(filename, fileFormat string) io.Writer &#123; // ç”Ÿæˆrotatelogsçš„Logger å®é™…ç”Ÿæˆçš„æ–‡ä»¶å file_YYmmddHH.log hook, err := rotatelogs.New( filename+fileFormat+&quot;.log&quot;, rotatelogs.WithLinkName(filename), // ä¿å­˜å¤©æ•° rotatelogs.WithMaxAge(time.Hour*24*30), // åˆ‡å‰²é¢‘ç‡24å°æ—¶ rotatelogs.WithRotationTime(time.Hour*24), ) if err != nil &#123; log.Println(&quot;æ—¥å¿—å¯åŠ¨å¼‚å¸¸&quot;) panic(err) &#125; return hook &#125; func Debug(format string, v ...interface&#123;&#125;) &#123; Logger.Sugar().Debugf(format, v...) &#125; func Info(format string, v ...interface&#123;&#125;) &#123; Logger.Sugar().Infof(format, v...) &#125; func Error(format string, v ...interface&#123;&#125;) &#123; Logger.Sugar().Errorf(format, v...) &#125; è¿™é‡Œæ³¨æ„initå‡½æ•°ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨loggerå…¶ä¸­å‡½æ•°å³å¯ï¼Œç¨‹åºåŠ è½½åŒ…çš„è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨æ‰§è¡Œinitå‡½æ•°ã€‚å…³äºinitæœ‰ä»¥ä¸‹è¯´æ˜ï¼š initå‡½æ•°æ˜¯ç”¨äºç¨‹åºæ‰§è¡Œå‰åšåŒ…çš„åˆå§‹åŒ–çš„å‡½æ•°ï¼Œæ¯”å¦‚åˆå§‹åŒ–åŒ…é‡Œçš„å˜é‡ç­‰ æ¯ä¸ªåŒ…å¯ä»¥æ‹¥æœ‰å¤šä¸ªinitå‡½æ•° åŒ…çš„æ¯ä¸ªæºæ–‡ä»¶ä¹Ÿå¯ä»¥æ‹¥æœ‰å¤šä¸ªinitå‡½æ•° åŒä¸€ä¸ªåŒ…ä¸­å¤šä¸ªinitå‡½æ•°çš„æ‰§è¡Œé¡ºåºgoè¯­è¨€æ²¡æœ‰æ˜ç¡®çš„å®šä¹‰(è¯´æ˜) ä¸åŒåŒ…çš„initå‡½æ•°æŒ‰ç…§åŒ…å¯¼å…¥çš„ä¾èµ–å…³ç³»å†³å®šè¯¥åˆå§‹åŒ–å‡½æ•°çš„æ‰§è¡Œé¡ºåº initå‡½æ•°ä¸èƒ½è¢«å…¶ä»–å‡½æ•°è°ƒç”¨ï¼Œè€Œæ˜¯åœ¨mainå‡½æ•°æ‰§è¡Œä¹‹å‰ï¼Œè‡ªåŠ¨è¢«è°ƒç”¨ æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ï¼š logger.Info(&quot;i&#x27;m log123-----Info&quot;) logger.Error(&quot;i&#x27;m log123-----Error&quot;) å¹³æ»‘é‡å¯å½“ç¨‹åºåœ¨çº¿ä¸Šç¨³å®šè¿è¡Œåï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå»æ›´æ–°ä¸€äº›åŠŸèƒ½ï¼Œä½†å‘å¸ƒä»£ç çš„åŒæ—¶ï¼Œå‡å¦‚æœ‰ç”¨æˆ·æ­£åœ¨ä½¿ç”¨ï¼Œç›²ç›®å‘å¸ƒä»£ç å¯èƒ½ä¼šé€ æˆç”¨æˆ·çŸ­æš‚å¤±çœŸï¼Œè¿™æ—¶å€™å¹³æ»‘é‡å¯å°±æ¥äº†ã€‚ å¯¹äºå¹³æ»‘é‡å¯ï¼Œå…¶å®æœ‰å¾ˆå¤šæ–¹æ¡ˆï¼Œè¿™é‡Œæˆ‘ä»¬åªä»è‡ªèº«ä»£ç çº§åˆ«æ¥å®Œæˆï¼Œè€Œå³ä¾¿æ˜¯ä»£ç çº§åˆ«ï¼Œç›®å‰ä¹Ÿæœ‰å¤šç§å®ç°æ–¹æ¡ˆï¼Œæ¯”å¦‚ç¬¬ä¸‰æ–¹åº“endlessè¿™ç§ï¼Œæˆ‘è¿™é‡Œä¸»è¦å‚è€ƒäº† https://github.com/kuangchanglang/gracefulgithub.com/kuangchanglang/graceful ç®€å•è¯´æ˜ä¸‹å¤„ç†æ­¥éª¤ï¼š ç›‘å¬ä¿¡å·ï¼ˆUSR2ï¼Œå¯è‡ªå®šä¹‰å…¶ä»–ä¿¡å·ï¼‰ æ”¶åˆ°ä¿¡å·æ—¶forkå­è¿›ç¨‹ï¼ˆä½¿ç”¨ç›¸åŒçš„å¯åŠ¨å‘½ä»¤ï¼‰ï¼Œå°†æœåŠ¡ç›‘å¬çš„socketæ–‡ä»¶æè¿°ç¬¦ä¼ é€’ç»™å­è¿›ç¨‹ å­è¿›ç¨‹ç›‘å¬çˆ¶è¿›ç¨‹çš„socketï¼Œè¿™ä¸ªæ—¶å€™çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹éƒ½å¯ä»¥æ¥æ”¶è¯·æ±‚ å­è¿›ç¨‹å¯åŠ¨æˆåŠŸä¹‹åï¼Œçˆ¶è¿›ç¨‹åœæ­¢æ¥æ”¶æ–°çš„è¿æ¥ï¼Œç­‰å¾…æ—§è¿æ¥å¤„ç†å®Œæˆï¼ˆæˆ–è¶…æ—¶ï¼‰ çˆ¶è¿›ç¨‹é€€å‡ºï¼Œé‡å¯å®Œæˆ è¯¦ç»†åˆ†æå¯çœ‹åº•éƒ¨å‚è€ƒ-GolangæœåŠ¡å™¨çƒ­é‡å¯ã€çƒ­å‡çº§ã€çƒ­æ›´æ–°ã€‚ å¯åŠ¨æ£€æŸ¥ç»“åˆä¸Šé¢çš„ä¼˜é›…é‡å¯ï¼Œæˆ‘ä»¬åœ¨å¯åŠ¨æ—¶é…ç½®ä¸Šå¯åŠ¨å¥åº·æ£€æŸ¥ï¼š package main // import è¿™é‡Œæˆ‘ä¹ æƒ¯æŠŠå®˜æ–¹åº“ï¼Œå¼€æºåº“ï¼Œæœ¬åœ°moduleä¾æ¬¡åˆ†å¼€åˆ—å‡º import ( &quot;fmt&quot; &quot;time&quot; &quot;errors&quot; &quot;net/http&quot; &quot;github.com/spf13/pflag&quot; &quot;github.com/spf13/viper&quot; &quot;github.com/gin-gonic/gin&quot; &quot;local.com/sai0556/demo2-gin-frame/config&quot; &quot;local.com/sai0556/demo2-gin-frame/db&quot; &quot;local.com/sai0556/demo2-gin-frame/router&quot; &quot;local.com/sai0556/demo2-gin-frame/logger&quot; &quot;local.com/sai0556/demo2-gin-frame/graceful&quot; ) var ( conf = pflag.StringP(&quot;config&quot;, &quot;c&quot;, &quot;&quot;, &quot;config filepath&quot;) ) func main() &#123; pflag.Parse() // åˆå§‹åŒ–é…ç½® if err := config.Run(*conf); err != nil &#123; panic(err) &#125; // logger.Info(&quot;i&#x27;m log123-----Info&quot;) // logger.Error(&quot;i&#x27;m log123-----Error&quot;) // è¿æ¥mysqlæ•°æ®åº“ DB := db.GetDB() defer db.CloseDB(DB) // redis db.InitRedis() gin.SetMode(viper.GetString(&quot;mode&quot;)) g := gin.New() g = router.Load(g) // g.Run(viper.GetString(&quot;addr&quot;)) go func() &#123; if err := pingServer(); err != nil &#123; fmt.Println(&quot;fail:å¥åº·æ£€æµ‹å¤±è´¥&quot;, err) &#125; fmt.Println(&quot;success:å¥åº·æ£€æµ‹æˆåŠŸ&quot;) &#125;() logger.Info(&quot;å¯åŠ¨httpæœåŠ¡ç«¯å£%s\\n&quot;, viper.GetString(&quot;addr&quot;)) if err := graceful.ListenAndServe(viper.GetString(&quot;addr&quot;), g); err != nil &amp;&amp; err != http.ErrServerClosed &#123; logger.Error(&quot;fail:httpæœåŠ¡å¯åŠ¨å¤±è´¥: %s\\n&quot;, err) &#125; &#125; // å¥åº·æ£€æŸ¥ func pingServer() error &#123; for i := 0; i &lt; viper.GetInt(&quot;max_ping_count&quot;); i++ &#123; url := fmt.Sprintf(&quot;%s%s%s&quot;, &quot;http://127.0.0.1&quot;, viper.GetString(&quot;addr&quot;), viper.GetString(&quot;healthCheck&quot;)) fmt.Println(url) resp, err := http.Get(url) if err == nil &amp;&amp; resp.StatusCode == 200 &#123; return nil &#125; time.Sleep(time.Second) &#125; return errors.New(&quot;å¥åº·æ£€æµ‹404&quot;) &#125; è¿™é‡Œå°±æ¯”è¾ƒç®€å•ï¼Œå¦å¤–å¯åŠ¨ä¸€ä¸ªåç¨‹ï¼Œå»pingå¥åº·æ£€æµ‹çš„urlå³å¯ã€‚ æ‰“åŒ…è„šæœ¬shell #!/bin/bash SERVER=&quot;demo2-gin-frame&quot; function status() &#123; if [ &quot;`pgrep $SERVER -u $UID`&quot; != &quot;&quot; ];then echo $SERVER is running else echo $SERVER is not running fi &#125; function build() &#123; echo &quot;build...&quot; CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o ./$SERVER main.go if [ $? -ne &quot;0&quot; ];then echo &quot;built error!!!&quot; return fi echo &quot;built success!&quot; &#125; case &quot;$1&quot; in &#x27;status&#x27;) status ;; &#x27;build&#x27;) build ;; *) echo &quot;unknown, please: $0 &#123;status or build&#125;&quot; exit 1 ;; esac bat echo &quot;build...&quot; SET CGO_ENABLED=0 SET GOOS=linux go build -o demo2-gin-frame if %errorlevel% == 0 ( echo &quot;built successfully&quot; ) else ( echo &quot;built fail!!!&quot; ) å¯¹äºç¨‹åºçš„é‡å¯å’Œä¿æ´»ï¼Œå»ºè®®é…åˆsupervisorä½¿ç”¨ã€‚ å¥½ï¼Œåˆ°è¿™é‡Œæˆ‘ä»¬çš„round 2å°±ç»“æŸäº†ã€‚ä¸‹ä¸€è½®æˆ‘ä»¬æ¥ç©ç©é’‰é’‰æ™ºèƒ½æœºå™¨äººã€‚ ç‚¹å‡»ç›´è¾¾å®Œæ•´ä»£ç  å‚è€ƒï¼š golang zap æ—¥å¿—åº“ä½¿ç”¨ï¼ˆå«æ–‡ä»¶åˆ‡å‰²ã€åˆ†çº§åˆ«å­˜å‚¨å’Œå…¨å±€ä½¿ç”¨ç­‰ï¼‰ åŸºäºGoè¯­è¨€æ„å»ºä¼ä¸šçº§çš„ RESTful API æœåŠ¡ golang initå‡½æ•° - Goè¯­è¨€ä¸­æ–‡ç½‘ - Golangä¸­æ–‡ç¤¾åŒº GolangæœåŠ¡å™¨çƒ­é‡å¯ã€çƒ­å‡çº§ã€çƒ­æ›´æ–°(safe and graceful hot-restart/reload http server)è¯¦è§£","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"é˜²æ­¢æ¼æ‰“å¡ï¼Œåˆ©ç”¨ginå’Œcronæ¥åšä¸€ä¸ªæ™ºèƒ½æé†’","slug":"goexample3","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:30:56.412Z","comments":true,"path":"2021/02/12/goexample3/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample3/","excerpt":"","text":"ç›®æ ‡ï¼š æ¯å¤©10ç‚¹æé†’æˆ‘æ‰“å¡ æŸ¥è¯¢æ­å·å¤©æ°” ä½¿ç”¨çš„åº“ï¼š github.com/robfig/cron æ€è·¯round2é‡Œé¢æˆ‘ä»¬åšäº†ä¸ªæ¡†æ¶ï¼Œæˆ‘ä»¬ä¸å¦¨ä»¥æ­¤ä¸ºåŸºç¡€ï¼Œæ¥å®Œæˆè¿™ä¸ªdemoã€‚æˆ‘ä»¬é€šè¿‡è§£æä¸åŒæ—¶æ®µçš„æé†’ä»»åŠ¡ï¼Œè§„å¾‹åœ°å­˜å‚¨åˆ°redisçš„æœ‰åºé›†åˆï¼Œ10så»æŸ¥è¯¢ä¸€æ¬¡æœ‰æ²¡æœ‰éœ€è¦æé†’çš„ä»»åŠ¡ï¼Œå¦‚æœ‰å‘é€åˆ°é’‰é’‰ã€‚ (ä»£ç é¢å¤–è¯´æ˜ï¼šredisæˆ‘æ›´æ–°æˆäº†v8ç‰ˆæœ¬ï¼Œå‘½ä»¤å‰éœ€è¦åŠ ä¸Šä¸‹æ–‡ï¼Œæ³¨æ„ä¸€ä¸‹) æ¥å…¥é’‰é’‰æœºå™¨äººé’‰é’‰æœºå™¨äººæ–‡æ¡£ æŒ‰ç…§æ–‡æ¡£åœ¨ç¾¤é‡Œæ–°å»ºæœºå™¨äººå³å¯ã€‚æˆ‘å¼€å¯çš„æ˜¯webhookè‡ªå®šä¹‰æœºå™¨äººï¼Œoutgoingæé€åœ°å€å°±æ˜¯é¡¹ç›®æ¥æ”¶ä¿¡æ¯åœ°å€ï¼Œæ¯”å¦‚ï¼šhttp://cron.13sai.com/dingdingPost å»ºè®®è®¾ç½®æˆåŠ ç­¾æˆ–ipé™åˆ¶ï¼Œä»¥é˜²è¢«æ¶æ„æ”»å‡» å…³é”®å­—// util/common.go // å°±åˆ—äº†ä¸€äº›å¸¸è§çš„ï¼Œå¯è‡ªè¡Œæ‰©å±• func UpdateKeywords() &#123; redis := model.RedisClient.Pipeline() key := KeyWords redis.HSet(model.Ctx, key, &quot;åˆ†é’Ÿå&quot;, &quot;1|60&quot;) redis.HSet(model.Ctx, key, &quot;æ—¶å&quot;, &quot;1|3600&quot;) redis.HSet(model.Ctx, key, &quot;å¤©å&quot;, &quot;1|86400&quot;) redis.HSet(model.Ctx, key, &quot;æ¯å¤©&quot;, &quot;-1|1&quot;) redis.HSet(model.Ctx, key, &quot;æ¯å‘¨ä¸€&quot;, &quot;2|0&quot;) redis.HSet(model.Ctx, key, &quot;æ¯å‘¨äºŒ&quot;, &quot;2|1&quot;) redis.HSet(model.Ctx, key, &quot;æ¯å‘¨ä¸‰&quot;, &quot;2|2&quot;) redis.HSet(model.Ctx, key, &quot;æ¯å‘¨å››&quot;, &quot;2|3&quot;) redis.HSet(model.Ctx, key, &quot;æ¯å‘¨äº”&quot;, &quot;2|4&quot;) redis.HSet(model.Ctx, key, &quot;æ¯å‘¨å…­&quot;, &quot;2|5&quot;) redis.HSet(model.Ctx, key, &quot;æ¯å‘¨æ—¥&quot;, &quot;2|6&quot;) redis.HSet(model.Ctx, key, &quot;å‘¨ä¸€&quot;, &quot;3|0&quot;) redis.HSet(model.Ctx, key, &quot;å‘¨äºŒ&quot;, &quot;3|1&quot;) redis.HSet(model.Ctx, key, &quot;å‘¨ä¸‰&quot;, &quot;3|2&quot;) redis.HSet(model.Ctx, key, &quot;å‘¨å››&quot;, &quot;3|3&quot;) redis.HSet(model.Ctx, key, &quot;å‘¨äº”&quot;, &quot;3|4&quot;) redis.HSet(model.Ctx, key, &quot;å‘¨å…­&quot;, &quot;3|5&quot;) ... redis.HSet(model.Ctx, key, &quot;ä»Šå¤©&quot;, &quot;4|0&quot;) redis.HSet(model.Ctx, key, &quot;æ˜å¤©&quot;, &quot;4|1&quot;) redis.HSet(model.Ctx, key, &quot;åå¤©&quot;, &quot;4|2&quot;) redis.HSet(model.Ctx, key, &quot;å–æ¶ˆ&quot;, &quot;0|0&quot;) redis.Exec(model.Ctx) &#125; å…³é”®å­—ï¼Œå¯ä»¥è‡ªè¡Œæ‰©å±•ï¼Œå¯èƒ½ä¼šæœ‰è¦†ç›–çš„æƒ…å†µï¼Œè¿™é‡Œéœ€è¦æŠ‰æ‹©ï¼Œæ˜¯åŒ¹é…ç¬¬ä¸€ä¸ªè¿˜æ˜¯åŒ¹é…å­—æ•°æœ€å¤šçš„ï¼Œæˆ‘æ­¤å¤„é€‰æ‹©åè€…çš„ã€‚ è§£æå†…å®¹é’‰é’‰æ–‡æ¡£çš„outgoingè¯´æ˜ä¸å…¨ï¼Œæˆ–è€…æ˜¯è—åœ¨å“ªé‡Œæˆ‘æ²¡æ‰¾åˆ°ï¼Œå¯ä»¥ä½¿ç”¨@æœºå™¨äººæ¥æ”¶ä¿¡æ¯æ‰“å°çœ‹ä¸€ä¸‹ã€‚ //å…³æ³¨senderIdå‘é€äººidï¼Œtextå‘é€å†…å®¹ï¼ŒsenderNickå‘é€äººæ˜µç§°å³å¯ &#123; &quot;conversationId&quot;:&quot;xxx&quot;, &quot;atUsers&quot;:[ &#123; &quot;dingtalkId&quot;:&quot;xxx&quot; &#125;], &quot;chatbotUserId&quot;:&quot;xxx&quot;, &quot;msgId&quot;:&quot;xxx&quot;, &quot;senderNick&quot;:&quot;sai0556&quot;, &quot;isAdmin&quot;:false, &quot;sessionWebhookExpiredTime&quot;:1594978626787, &quot;createAt&quot;:1594973226742, &quot;conversationType&quot;:&quot;2&quot;, &quot;senderId&quot;:&quot;xxx&quot;, &quot;conversationTitle&quot;:&quot;æ™ºèƒ½å¤‡å¿˜å½•&quot;, &quot;isInAtList&quot;:true, &quot;sessionWebhook&quot;:&quot;xxx&quot;, &quot;text&quot;:&#123; &quot;content&quot;:&quot; hello gin-frame&quot; &#125;, &quot;msgtype&quot;:&quot;text&quot; &#125; å®šä¹‰ä¸€ä¸ªstructï¼Œæ¥æ”¶æ¶ˆæ¯ type DingDingMsgContent struct &#123; SenderNick string `json:&quot;senderNick&quot;` SenderId string `json:&quot;senderId&quot;` Text struct &#123; Content string `json:&quot;content&quot;` &#125; `json:&quot;text&quot;` &#125; func DingDing(c *gin.Context) &#123; data, _ := ioutil.ReadAll(c.Request.Body) form := DingDingMsgContent&#123;&#125; err := json.Unmarshal([]byte(data), &amp;form) // err := c.ShouldBindJSON(&amp;form) if err != nil &#123; fmt.Println(err) return &#125; .... &#125; è§£æï¼Œæ³¨æ„å®šä¹‰äº†ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚ç»‘å®šæ‰‹æœºï¼Œå–æ¶ˆä»»åŠ¡ç­‰ï¼Œåšå¯¹åº”çš„ç‰¹æ®Šå¤„ç†ï¼Œç»‘å®šæ‰‹æœºæ˜¯ä¸ºäº†@ æŸäººï¼Œå¦åˆ™æ¶ˆæ¯å®¹æ˜“è¢«å¿½ç•¥ã€‚ func parseContent(form DingDingMsgContent) (err error) &#123; str := form.Text.Content redis := db.RedisClient fmt.Println(str) // è¦å…ˆç»‘å®šå“Ÿï¼Œä¸ç„¶æ— æ³•@åˆ°å¯¹åº”çš„äºº index := strings.Index(str, &quot;ç»‘å®šæ‰‹æœº&quot;) if index &gt; -1 &#123; reg := regexp.MustCompile(&quot;1[0-9]&#123;10&#125;&quot;) res := reg.FindAllString(str, 1) if len(res) &lt; 1 || res[0] == &quot;&quot; &#123; err = errors.New(&quot;æ‰‹æœºæ ¼å¼ä¸æ­£ç¡®&quot;) return &#125; redis.HSet(db.Ctx, util.KeyDingDingID, form.SenderId, res[0]) util.SendDD(&quot;ç»‘å®šæˆåŠŸ&quot;) return &#125; hExist := redis.HExists(db.Ctx, util.KeyDingDingID, form.SenderId) if !hExist.Val() &#123; err = errors.New(&quot;ç»‘å®šæ‰‹æœºå·æ‰èƒ½ç²¾ç¡®æé†’å“¦ï¼Œå‘é€--ç»‘å®šæ‰‹æœº 13456567878--@æˆ‘å³å¯&quot;) return &#125; index = strings.Index(util.StrSub(str, 0, 10), &quot;æˆ‘çš„æé†’&quot;) fmt.Println(index, &quot;---&quot;, util.StrSub(str, 0, 6)) if index &gt; -1 &#123; www := util.QueryAllQueue(form.SenderId); if len(www) &lt; 1 &#123; err = errors.New(&quot;æš‚æ— ä»»åŠ¡&quot;) return &#125; msg := &quot;&quot; for key,value := range www &#123; fmt.Println(strings.Index(value, &quot;@&quot;)) value := value[0:strings.Index(value, &quot;@&quot;)] fmt.Println(value) msg = util.StrCombine(msg, &quot;ä»»åŠ¡idï¼š&quot;, key, &quot;ï¼Œä»»åŠ¡å†…å®¹ï¼š&quot;, value, &quot;&#123;br&#125;&quot;) &#125; err = errors.New(msg) return &#125; index = strings.Index(util.StrSub(str, 0, 10), &quot;æŸ¥çœ‹ä»»åŠ¡&quot;) fmt.Println(index, &quot;---&quot;, util.StrSub(str, 0, 6)) if index &gt; -1 &#123; www := util.QueryAllQueue(form.SenderId); if len(www) &lt; 1 &#123; err = errors.New(&quot;æš‚æ— ä»»åŠ¡&quot;) return &#125; msg := &quot;&quot; for key,value := range www &#123; fmt.Println(strings.Index(value, &quot;@&quot;)) value := value[0:strings.Index(value, &quot;@&quot;)] fmt.Println(value) msg = util.StrCombine(msg, &quot;ä»»åŠ¡idï¼š&quot;, key, &quot;ï¼Œä»»åŠ¡å†…å®¹ï¼š&quot;, value, &quot;&#123;br&#125;&quot;) &#125; err = errors.New(msg) return &#125; index = strings.Index(util.StrSub(str, 0, 10), &quot;å–æ¶ˆæ‰€æœ‰ä»»åŠ¡&quot;) fmt.Println(index, &quot;---&quot;, util.StrSub(str, 0, 6)) if index &gt; -1 &#123; if er := util.CancelAllQueue(form.SenderId); er != nil &#123; err = er return &#125; err = errors.New(&quot;å–æ¶ˆæˆåŠŸ&quot;) return &#125; index = strings.Index(util.StrSub(str, 0, 10), &quot;å–æ¶ˆ&quot;) if index &gt; -1 &#123; reg := regexp.MustCompile(&quot;[a-z0-9]&#123;32&#125;&quot;) res := reg.FindAllString(str, 1) if len(res) &lt; 1 &#123; err = errors.New(&quot;ä»»åŠ¡idä¸æ­£ç¡®&quot;) return &#125; if er := util.CancelQueue(res[0], form.SenderId); er != nil &#123; err = er return &#125; err = errors.New(&quot;å–æ¶ˆæˆåŠŸ&quot;) return &#125; return &#125; // æé†’å†…å®¹ func tips(form DingDingMsgContent) (err error) &#123; rd := db.RedisClient str := form.Text.Content mobile := rd.HGet(db.Ctx, util.KeyDingDingID, form.SenderId).Val() key := util.KeyWords list, _ := rd.HGetAll(db.Ctx, key).Result() now := time.Now().Unix() tipsType := 1 k := &quot;&quot; v := &quot;&quot; fmt.Println(&quot;str&quot;, str) index := 0 for key, value := range list &#123; index = util.UnicodeIndex(str, key) if index &gt; -1 &amp;&amp; util.StrLen(key) &gt; util.StrLen(k) &#123; fmt.Println(&quot;index&quot;, index, str, key, value) k = key v = value &#125; &#125; msg := &quot;&quot; var score int64 if k != &quot;&quot; &#123; kLen := util.StrLen(k) msg = util.StrSub(str, index+kLen) val := strings.Split(v, &quot;|&quot;) unit := val[1] units,_ := strconv.Atoi(unit) switch val[0] &#123; // å¤šå°‘æ—¶é—´å case &quot;1&quot;: reg := regexp.MustCompile(&quot;[0-9]&#123;1,2&#125;&quot;) res := reg.FindAllString(str, 1) minute, _ := strconv.Atoi(res[0]) score = now + int64(units*minute) // æ¯å‘¨ case &quot;2&quot;: reg := regexp.MustCompile(&quot;[0-9]&#123;1,2&#125;&quot;) res := reg.FindAllString(util.StrSub(msg, 0, 7), -1) hour := 9 minute := 0 if len(res) &gt; 0 &#123; hour, _ = strconv.Atoi(res[0]) &#125; if len(res) &gt; 1 &#123; minute, _ = strconv.Atoi(res[1]) &#125; now = util.GetWeekTS(int64(units)) score = now + int64(60*minute + 3600*hour) tipsType = 2 // ä¸‹å‘¨ case &quot;3&quot;: reg := regexp.MustCompile(&quot;[0-9]&#123;1,2&#125;&quot;) res := reg.FindAllString(util.StrSub(msg, 0, 7), -1) hour := 9 minute := 0 if len(res) &gt; 0 &#123; hour, _ = strconv.Atoi(res[0]) &#125; if len(res) &gt; 1 &#123; minute, _ = strconv.Atoi(res[1]) &#125; now = util.TodayTS() score = now + int64(60*minute + 3600*hour + units*86400) case &quot;4&quot;: reg := regexp.MustCompile(&quot;[0-9]&#123;1,2&#125;&quot;) res := reg.FindAllString(util.StrSub(msg, 0, 7), -1) hour := 9 minute := 0 if len(res) &gt; 0 &#123; hour, _ = strconv.Atoi(res[0]) &#125; if len(res) &gt; 1 &#123; minute, _ = strconv.Atoi(res[1]) &#125; now = util.TodayTS() + 86400*int64(units) score = now + int64(60*minute + 3600*hour) case &quot;-1&quot;: reg := regexp.MustCompile(&quot;[0-9]&#123;1,10&#125;&quot;) res := reg.FindAllString(util.StrSub(msg, 0, 7), -1) fmt.Println(&quot;res&quot;, res) hour := 9 minute := 0 if len(res) &gt; 0 &#123; hour, _ = strconv.Atoi(res[0]) &#125; if len(res) &gt; 1 &#123; minute, _ = strconv.Atoi(res[1]) &#125; now = util.TodayTS() + 86400 score = now + int64(60*minute + 3600*hour) fmt.Println(now, score, minute, hour) tipsType = 3 default: &#125; &#125; else &#123; reg := regexp.MustCompile(&quot;(([0-9]&#123;4&#125;)[-|/|å¹´])?([0-9]&#123;1,2&#125;)[-|/|æœˆ]([0-9]&#123;1,2&#125;)æ—¥?&quot;) pi := reg.FindAllStringSubmatch(str, -1) if (len(pi) &gt; 0 ) &#123; date := pi[0] if date[2] == &quot;&quot; &#123; date[2] = &quot;2020&quot; &#125; location, _ := time.LoadLocation(&quot;Asia/Shanghai&quot;) tm2, _ := time.ParseInLocation(&quot;2006/01/02&quot;, fmt.Sprintf(&quot;%s/%s/%s&quot;, date[2], date[3], date[4]), location) score = util.GetZeroTime(tm2).Unix() msg = reg.ReplaceAllString(str, &quot;&quot;) fmt.Println(msg) &#125; else &#123; msg = str score = util.TodayTS() &#125; reg = regexp.MustCompile(&quot;[0-9]&#123;1,10&#125;&quot;) res := reg.FindAllString(util.StrSub(msg, 0, 7), -1) fmt.Println(&quot;res&quot;, res) hour := 9 minute := 0 if len(res) &gt;= 1 &#123; hour, _ = strconv.Atoi(res[0]) fmt.Println(&quot;hour&quot;, hour, minute) &#125; if len(res) &gt; 1 &#123; minute, _ = strconv.Atoi(res[1]) &#125; score += int64(60*minute + 3600*hour) &#125; if msg == &quot;&quot; &#123; err = errors.New(&quot;ä½ è¯´å•¥&quot;) return &#125; index = util.UnicodeIndex(msg, &quot;æé†’æˆ‘&quot;) index2 := util.UnicodeIndex(msg, &quot;æé†’&quot;) if index2 &lt; 0 &#123; err = errors.New(&quot;å¤§å“¥ï¼Œè¦æˆ‘æé†’ä½ å¹²å•¥å‘¢ï¼Ÿè¯·å‘é€--ä¸‹å‘¨ä¸€13ç‚¹æé†’æˆ‘å†™ä½œä¸š&quot;) return &#125; if index &lt; 0 &amp;&amp; index2 &gt; -1 &#123; msg = util.StrSub(msg, index2+2) &#125; else &#123; msg = util.StrSub(msg, index+3) &#125; fmt.Println(msg, mobile) msg = util.StrCombine(msg, &quot;@&quot;, mobile) fmt.Println(score, msg, tipsType, err) if err != nil &#123; util.SendDD(err.Error()) return &#125; member := util.StrCombine(strconv.Itoa(tipsType), msg) rd.ZAdd(db.Ctx, util.KeyCrontab, &amp;redis.Z&#123; Score: float64(score), Member: member, &#125;) uniqueKey := util.Md5(member) rd.HSet(db.Ctx, util.StrCombine(util.KeyUserCron, form.SenderId), uniqueKey, member) util.SendDD(fmt.Sprintf(&quot;è®¾ç½®æˆåŠŸ(å–æ¶ˆè¯·å›å¤ï¼šå–æ¶ˆä»»åŠ¡%s)--%sæé†’æ‚¨%s&quot;, uniqueKey, time.Unix(score, 0).Format(&quot;2006/01/02 15:04:05&quot;), msg)) return &#125; å‘é€é’‰é’‰æ¶ˆæ¯è¿™é‡Œå°±æ˜¯å¯¹æ¥é’‰é’‰æ¥å£ï¼Œè§£æç»™éœ€è¦æé†’çš„äººå°±è¡Œï¼Œå°±ä¸åšè¿‡å¤šè¯´æ˜äº†ã€‚ func SendDD(msg string) &#123; // æ‰“å°å‡ºæ¥çœ‹çœ‹æ˜¯ä¸ªå•¥ fmt.Println(&quot;dingding-----------&quot;) fmt.Println(msg) tips := make(map[string]interface&#123;&#125;) content := make(map[string]interface&#123;&#125;) tips[&quot;msgtype&quot;] = &quot;markdown&quot; // @ æ˜¯ç”¨æ¥æé†’ç¾¤é‡Œå¯¹åº”çš„äºº arr := strings.Split(msg, &quot;@&quot;) // [æé†’]æ˜¯æœºå™¨äººå…³é”®å­—ï¼Œä¸ªäººå»ºè®®è®¾ç½®æœºå™¨äººé™åˆ¶ipæˆ–ä½¿ç”¨tokenï¼Œæ¯”è¾ƒé è°± content[&quot;text&quot;] = fmt.Sprintf(&quot;%s&quot;, strings.Replace(arr[0], &quot;&#123;br&#125;&quot;, &quot; \\n\\n&quot;, -1)) content[&quot;title&quot;] = &quot;é¹…é¹…é¹…&quot; if len(arr) &gt; 1 &#123; mobile := make([]string, 0) at := make(map[string]interface&#123;&#125;) mobile = append(mobile, arr[1]) at[&quot;atMobiles&quot;] = mobile tips[&quot;at&quot;] = at content[&quot;text&quot;] = fmt.Sprintf(&quot;%s @%s&quot;, content[&quot;text&quot;], arr[1]) &#125; tips[&quot;markdown&quot;] = content bytesData, err := json.Marshal(tips) if err != nil &#123; fmt.Println(err.Error() ) return &#125; reader := bytes.NewReader(bytesData) url := viper.GetString(&quot;dingding_url&quot;) request, err := http.NewRequest(&quot;POST&quot;, url, reader) if err != nil &#123; return &#125; request.Header.Set(&quot;Content-Type&quot;, &quot;application/json;charset=UTF-8&quot;) client := http.Client&#123;&#125; _, err = client.Do(request) if err != nil &#123; fmt.Println(err.Error()) return &#125; // å·æ‡’ä¸é‡è¯•äº† // respBytes, err := ioutil.ReadAll(resp.Body) // if err != nil &#123; // fmt.Println(err.Error()) // return // &#125; // //byteæ•°ç»„ç›´æ¥è½¬æˆstringï¼Œä¼˜åŒ–å†…å­˜ // str := (*string)(unsafe.Pointer(&amp;respBytes)) // fmt.Println(*str) &#125; å®šæ—¶å‘é€ä¸ä»»åŠ¡å–æ¶ˆè¿™å°±æ˜¯å‘é€æé†’çš„æ ¸å¿ƒä»£ç äº†ï¼Œè¯¦ç»†ä½¿ç”¨è¯´æ˜å¯ä»¥çœ‹ä¸‹ï¼š Golang cron å®šæ—¶ä»»åŠ¡ä½¿ç”¨ func Cron() &#123; c := cron.New() spec := &quot;*/10 * * * * ?&quot; c.AddJob(spec, Queue&#123;&#125;) c.Start() &#125; type Queue struct &#123; &#125; func (q Queue) Run() &#123; now := time.Now().Unix() rd := model.RedisClient op := &amp;redis.ZRangeBy&#123; Min: &quot;0&quot;, Max: strconv.FormatInt(now, 10), &#125; ret, err := rd.ZRangeByScoreWithScores(model.Ctx, KeyCrontab, op).Result() if err != nil &#123; fmt.Printf(&quot;zrangebyscore failed, err:%v\\n&quot;, err) return &#125; for _, z := range ret &#123; fmt.Println(z.Member.(string), z.Score) QueueDo(z.Member.(string), z.Score) &#125; &#125; func QueueDo(msg string, score float64) &#123; msgType := msg[0:1] SendDD(msg[1:]) rd := model.RedisClient rd.ZRem(model.Ctx, KeyCrontab, msg) switch msgType &#123; case &quot;2&quot;: rd.ZAdd(model.Ctx, KeyCrontab, &amp;redis.Z&#123; Score: score + 7*86400, Member: msg, &#125;) case &quot;3&quot;: rd.ZAdd(model.Ctx, KeyCrontab, &amp;redis.Z&#123; Score: score + 86400, Member: msg, &#125;) default: rd.ZRem(model.Ctx, KeyCrontab, msg) &#125; &#125; // å–æ¶ˆæé†’ func CancelQueue(uniqueKey string, SenderId string) (err error) &#123; rd := model.RedisClient member := rd.HGet(model.Ctx, StrCombine(KeyUserCron, SenderId), uniqueKey).Val() if member == &quot;&quot; &#123; fmt.Println(StrCombine(KeyUserCron, SenderId), uniqueKey) err = errors.New(&quot;æ²¡æœ‰æ­¤ä»»åŠ¡&quot;) return &#125; fmt.Println(member, &quot;member&quot;) rd.ZRem(model.Ctx, KeyCrontab, member) rd.HDel(model.Ctx, StrCombine(KeyUserCron, SenderId), uniqueKey) err = errors.New(&quot;å–æ¶ˆæˆåŠŸ&quot;) return &#125; // å–æ¶ˆæ‰€æœ‰ func CancelAllQueue(SenderId string) (err error) &#123; rd := model.RedisClient list, _ := rd.HGetAll(model.Ctx, StrCombine(KeyUserCron, SenderId)).Result() for _, value := range list &#123; rd.ZRem(model.Ctx, KeyCrontab, value) &#125; rd.Del(model.Ctx, StrCombine(KeyUserCron, SenderId)) err = errors.New(&quot;å·²ç»å–æ¶ˆæ‰€æœ‰æé†’ä»»åŠ¡&quot;) return &#125; func QueryAllQueue(SenderId string) (map[string]string) &#123; rd := model.RedisClient list, _ := rd.HGetAll(model.Ctx, StrCombine(KeyUserCron, SenderId)).Result() // fmt.Println(list) return list &#125; å¤©æ°”ä¸èŠå¤©ç»™ä½ æ˜¯æ¥äº†ä¸€ä¸ªå…è´¹æ™ºèƒ½æ¥å£ï¼Œæœ‰å…´è¶£å¯æŸ¥çœ‹githubé…ç½®æ–‡ä»¶ã€‚ æ¥çœ‹çœ‹æ•ˆæœ æ€»ç»“è¿™ä¸ªdemoå…¶å®ä¸»è¦ç‚¹å°±æ˜¯è§£æé’‰é’‰æ¨é€å†…å®¹åšå¯¹åº”çš„å¤„ç†ï¼Œå› å…³é”®å­—è¿‡å¤šï¼Œä»£ç å…¶å®æœ‰ç‚¹å•°å—¦ï¼Œä½ å¯ä»¥è‡ªè¡Œä¼˜åŒ–ï¼Œå¯¹æ¥æ™ºèƒ½æ¥å£å’Œé’‰é’‰æ¥å£ï¼Œè¿˜æ˜¯å®šæ—¶ä»»åŠ¡å…¶å®éƒ½æ˜¯ç›¸å¯¹ç®€å•çš„ï¼Œå½“ç„¶ï¼Œè¿™åªæ˜¯å¾ˆåŸºç¡€çš„åŠŸèƒ½ï¼Œä½ å¯ä»¥è‡ªè¡Œæ‰©å±•ã€‚å¦å¤–ï¼Œè¿™æ¬¡ä¹‹åˆ—å‡ºäº†ä¸»è¦ä»£ç ï¼Œæ²¡æœ‰åšååˆ†è¯¦å°½çš„è¯´æ˜ï¼Œæœ‰å…´è¶£å¯ä»¥æŸ¥çœ‹æºç ã€‚ æŸ¥çœ‹githubæºç  å•°å—¦è¿™ä¸ªdemoçš„èµ·åˆä¹Ÿæ˜¯æˆ‘ä»¬å‡ ä¸ªåŒäº‹è€å¿˜è®°æ‰“å¡ï¼Œæœ‰äº†è¿™ä¸ªdemoï¼Œèµ·åˆåªèƒ½æé†’æ‰“å¡ï¼Œåé¢é™†ç»­åŠ å…¥äº†å–æ¶ˆã€æŸ¥çœ‹ã€æŸ¥è¯¢å¤©æ°”ç­‰åŠŸèƒ½ï¼Œå¤§å®¶å­¦ä¹ æŠ€æœ¯çš„æ—¶å€™ä¹Ÿå¯ä»¥è€ƒè™‘åº”ç”¨åˆ°ç”Ÿæ´»åœºæ™¯å½“ä¸­ï¼Œè¿™æ ·å­¦ä¹ èµ·æ¥ä¹Ÿæ¯”è¾ƒæœ‰æœ‰è¶£ï¼Œå®è·µä¸­ä¹Ÿä¼šå‘ç°å¾ˆå¤šæƒ³ä¸åˆ°çš„é—®é¢˜ï¼Œæœ€åï¼Œç¥å¤§å®¶å·¥ä½œæ„‰å¿«ï¼Œä¸å¿˜æ‰“å¡ã€‚","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"gRPC","slug":"goexample4","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:30:59.795Z","comments":true,"path":"2021/02/12/goexample4/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample4/","excerpt":"","text":"åœ¨è¿›è¡Œround 4ä¹‹å‰å‘¢ï¼Œè¯´ä¸€ä¸‹goçš„modulesï¼Œä¹‹å‰çš„3ä¸ªdemoä¸­ï¼Œå…¶å®æˆ‘å°±ç›´æ¥ç”¨åˆ°äº†ï¼Œæ²¡åšè¯´æ˜ï¼Œä¸ªäººè§‰å¾—modulesçš„å¼•è¿›ç®—æ˜¯ä¸€ä¸ªå¤§æ”¹è¿›äº†ï¼Œè®©æˆ‘ä»¬å¯ä»¥è„±ç¦»gopathçš„æŸç¼šï¼Œå…·ä½“è¯´æ˜ä¸é…ç½®ï¼Œå¯ä»¥çœ‹æˆ‘çš„è¿™ä¸€ç¯‡æ–‡ç« ï¼š go modules åŠ¡å¿…è®¾ç½®GOPROXYï¼Œä¼šå¤§å¤§æé«˜go getçš„é€Ÿåº¦ã€‚ gRPC æ˜¯å¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒä¸­è¿è¡Œçš„ç°ä»£å¼€æºé«˜æ€§èƒ½ RPC æ¡†æ¶ã€‚å®ƒå¯ä»¥é€šè¿‡å¯æ’æ‹”çš„æ”¯æŒæ¥æœ‰æ•ˆåœ°è¿æ¥æ•°æ®ä¸­å¿ƒå†…å’Œè·¨æ•°æ®ä¸­å¿ƒçš„æœåŠ¡ï¼Œä»¥å®ç°è´Ÿè½½å¹³è¡¡ï¼Œè·Ÿè¸ªï¼Œè¿è¡ŒçŠ¶å†µæ£€æŸ¥å’Œèº«ä»½éªŒè¯ã€‚å®ƒä¹Ÿé€‚ç”¨äºåˆ†å¸ƒå¼è®¡ç®—çš„æœ€åä¸€è‹±é‡Œï¼Œä»¥å°†è®¾å¤‡ï¼Œç§»åŠ¨åº”ç”¨ç¨‹åºå’Œæµè§ˆå™¨è¿æ¥åˆ°åç«¯æœåŠ¡ã€‚ å®‰è£…protocol buffer ç¼–è¯‘å™¨macï¼š brew install protobuf å…¶ä»–ç³»ç»Ÿå¯ä»¥å°è¯•ç¼–è¯‘å®‰è£… protocolbuffers/protobuf å®‰è£…gprcgo get -u google.golang.org/grpc å®‰è£…protoc-gen-goæ’ä»¶go get -u github.com/golang/protobuf/protoc-gen-go ä½¿ç”¨æ–°å»ºhelloç›®å½•ï¼Œè¿›å…¥åæ‰§è¡Œï¼š protoc --proto_path hello/ --go_out=plugins=grpc:hello hello.proto ä¼šçœ‹åˆ°helloç›®å½•ä¸‹ç”Ÿæˆäº†hello.pb.goæ–‡ä»¶ã€‚ å½“ç„¶ï¼Œå…¶ä¸­çš„ hello.proto æ˜¯é¢„å…ˆè‡ªå®šä¹‰åœ¨helloæ–‡ä»¶å¤¹ä¸‹çš„ï¼Œå¦‚ï¼š syntax = &quot;proto3&quot;; //è¯­æ³•å£°æ˜ package hello; //åŒ…å // å®šä¹‰æœåŠ¡ service Greeter &#123; rpc SayHello (HelloRequest) returns (HelloReply) &#123;&#125; &#125; // è¯·æ±‚æ•°æ®æ ¼å¼ message HelloRequest &#123; string name = 1; &#125; // å“åº”æ•°æ®æ ¼å¼ message HelloReply &#123; string message = 1; &#125; serveræ–°å»ºserverç›®å½•ï¼Œgolangä¾‹å­ä»£ç æ¥è‡ªï¼šhttps://github.com/grpc/grpc-go/tree/master/examples/helloworld // main.go package main import ( &quot;context&quot; &quot;log&quot; &quot;net&quot; &quot;google.golang.org/grpc&quot; pb &quot;local.com/sai/game/grpc/hello&quot; ) const ( port = &quot;:50051&quot; ) // server is used to implement helloworld.GreeterServer. type server struct &#123; pb.UnimplementedGreeterServer &#125; // SayHello implements helloworld.GreeterServer func (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) &#123; log.Printf(&quot;Received: %v&quot;, in.GetName()) return &amp;pb.HelloReply&#123;Message: &quot;Hello &quot; + in.GetName()&#125;, nil &#125; func main() &#123; lis, err := net.Listen(&quot;tcp&quot;, port) if err != nil &#123; log.Fatalf(&quot;failed to listen: %v&quot;, err) &#125; s := grpc.NewServer() pb.RegisterGreeterServer(s, &amp;server&#123;&#125;) if err := s.Serve(lis); err != nil &#123; log.Fatalf(&quot;failed to serve: %v&quot;, err) &#125; &#125; clientgo client// client.go package main import ( &quot;context&quot; &quot;log&quot; &quot;os&quot; &quot;time&quot; &quot;google.golang.org/grpc&quot; pb &quot;local.com/sai/game/grpc/hello&quot; ) const ( address = &quot;127.0.0.1:50051&quot; defaultName = &quot;13sai&quot; ) func main() &#123; // Set up a connection to the server. conn, err := grpc.Dial(address, grpc.WithInsecure(), grpc.WithBlock()) if err != nil &#123; log.Fatalf(&quot;did not connect: %v&quot;, err) &#125; defer conn.Close() c := pb.NewGreeterClient(conn) // Contact the server and print out its response. name := defaultName if len(os.Args) &gt; 1 &#123; name = os.Args[1] &#125; ctx, cancel := context.WithTimeout(context.Background(), time.Second) defer cancel() r, err := c.SayHello(ctx, &amp;pb.HelloRequest&#123;Name: name&#125;) if err != nil &#123; log.Fatalf(&quot;could not greet: %v&quot;, err) &#125; log.Printf(&quot;Greeting: %s&quot;, r.GetMessage()) &#125;` php clientæ‰©å±•å®‰è£… grpcæ‰©å±•ä¸‹è½½ profo ä¸‹è½½å®‰è£…åˆé€‚ç‰ˆæœ¬çš„æ‰©å±•å³å¯ï¼Œè®°å¾—åˆ«å¿˜è®°åœ¨php.iniä¸­åŠ å…¥ï¼š extension=grpc.so extension=protobuf.so è‡ªåŠ¨ç”Ÿæˆä»£ç protoc --php_out=client hello/hello.proto ä¼šçœ‹åˆ°clientç›®å½•ä¸‹ç”Ÿæˆäº†GPBMetadataå’ŒHelloä¸¤ä¸ªç›®å½•ã€‚ å¦‚æœä½ å¯¹grpcç›¸å¯¹å«ç†Ÿç»ƒï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œä»£ç ç¼–å†™ï¼š &lt;?php require __DIR__ . &#x27;/vendor/autoload.php&#x27;; class Client extends \\Grpc\\BaseStub&#123; public function __construct($hostname, $opts, $channel = null) &#123; parent::__construct($hostname, $opts, $channel); &#125; /** * rpc SayHello(HelloRequest) returns (HelloReply) &#123;&#125; * æ–¹æ³•åå°½é‡å’Œ (gprc å®šä¹‰ Greeter æœåŠ¡)çš„æ–¹æ³•ä¸€æ · * ç”¨äºè¯·æ±‚å’Œå“åº”è¯¥æœåŠ¡ */ public function SayHello(\\Hello\\HelloRequest $argument)&#123; // (/hello.Greeter/SayHello) æ˜¯è¯·æ±‚æœåŠ¡ç«¯é‚£ä¸ªæœåŠ¡å’Œæ–¹æ³•ï¼ŒåŸºæœ¬å’Œ proto æ–‡ä»¶å®šä¹‰ä¸€æ · return $this-&gt;_simpleRequest(&#x27;/hello.Greeter/SayHello&#x27;, $argument, [&#x27;\\Hello\\HelloReply&#x27;, &#x27;decode&#x27;] ); &#125; &#125; //ç”¨äºè¿æ¥ æœåŠ¡ç«¯ $client = new \\Client(&#x27;127.0.0.1:50051&#x27;, [ &#x27;credentials&#x27; =&gt; Grpc\\ChannelCredentials::createInsecure() ]); //å®ä¾‹åŒ– TestRequest è¯·æ±‚ç±» $request = new \\Hello\\HelloRequest(); $request-&gt;setName(&quot;fairy&quot;); //è°ƒç”¨è¿œç¨‹æœåŠ¡ $get = $client-&gt;SayHello($request)-&gt;wait(); //è¿”å›æ•°ç»„ //$reply æ˜¯ TestReply å¯¹è±¡ //$status æ˜¯æ•°ç»„ list($reply, $status) = $get; echo $reply-&gt;getMessage().PHP_EOL; // print_r($client-&gt;SayHello($request)); å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨grpc_php_pluginæ’ä»¶ç”Ÿæˆã€‚ grpc-php grpc_php_pluginæ’ä»¶cloneå¤ªæ…¢å¯ä»¥ä½¿ç”¨ç äº‘ git clone -b $(curl -L https://grpc.io/release) https://github.com/grpc/grpc cd grpc #è¿™ä¸€æ­¥å¾ˆæ…¢ï¼Œæš‚æœªæ‰¾åˆ°ä»€ä¹ˆå¥½æ–¹æ³• git submodule update --init make grpc_php_plugin æ–°å»ºphp-clientï¼Œå†æ¥è‡ªåŠ¨ç”Ÿæˆï¼š protoc -I=./hello hello.proto --php_out=./php-client/ --grpc_out=php-client/ --plugin=protoc-gen-grpc=/Users/wangzetao/www/grpc1/bins/opt/grpc_php_plugin ä¼šå‘ç°æ¯”ä¸Šé¢è‡ªåŠ¨ç”Ÿæˆå¤šäº†ä¸€ä¸ªGreeterClient.php &lt;?php // client.php require __DIR__ . &#x27;/vendor/autoload.php&#x27;; //ç”¨äºè¿æ¥ æœåŠ¡ç«¯ $client = new \\Hello\\GreeterClient(&#x27;127.0.0.1:50051&#x27;, [ &#x27;credentials&#x27; =&gt; Grpc\\ChannelCredentials::createInsecure() ]); //å®ä¾‹åŒ– TestRequest è¯·æ±‚ç±» $request = new \\Hello\\HelloRequest(); $request-&gt;setName(&quot;world&quot;); //è°ƒç”¨è¿œç¨‹æœåŠ¡ $get = $client-&gt;SayHello($request)-&gt;wait(); //è¿”å›æ•°ç»„ //$status æ˜¯æ•°ç»„ list($reply, $status) = $get; echo $reply-&gt;getMessage().PHP_EOL; // print_r($client-&gt;SayHello($request)); è¿è¡Œæµ‹è¯• go run grpc/server/main.go go run grpc/client/main.gogo run grpc/client/client.phpgo run grpc/client/php-client.php grpcåˆä½“éªŒå®Œæˆäº†ï¼Œæœ¬æ¬¡åªæ˜¯å°å°çš„ä½¿ç”¨äº†ä¸€ä¸‹å­ï¼Œåç»­æ„Ÿå…´è¶£çš„è¯å¯ä»¥æ·±å…¥å­¦ä¹ ä¸€ä¸‹ã€‚æ–‡ä¸­å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡å‡ºäº¤æµã€‚ è¿™ç¯‡æ˜¯ä¹‹å‰çš„æ–‡ç« ï¼Œä»£ç ç®€å•ï¼Œå°±ä¸å†å†™ä¸€éäº†ã€‚","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"goé¢å‘å¯¹è±¡","slug":"goexample5","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:31:02.779Z","comments":true,"path":"2021/02/12/goexample5/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample5/","excerpt":"","text":"é¢å‘å¯¹è±¡ (Object Oriented,OO) çš„æ€æƒ³å¯¹è½¯ä»¶å¼€å‘ç›¸å½“é‡è¦ï¼Œå®ƒçš„æ¦‚å¿µå’Œåº”ç”¨ç”šè‡³å·²è¶…è¶Šäº†ç¨‹åºè®¾è®¡å’Œè½¯ä»¶å¼€å‘ï¼Œæ‰©å±•åˆ°å¦‚æ•°æ®åº“ç³»ç»Ÿã€äº¤äº’å¼ç•Œé¢ã€åº”ç”¨ç»“æ„ã€åº”ç”¨å¹³å°ã€åˆ†å¸ƒå¼ç³»ç»Ÿã€ç½‘ç»œç®¡ç†ç»“æ„ã€CAD æŠ€æœ¯ã€äººå·¥æ™ºèƒ½ç­‰é¢†åŸŸã€‚é¢å‘å¯¹è±¡æ˜¯ä¸€ç§å¯¹ç°å®ä¸–ç•Œç†è§£å’ŒæŠ½è±¡çš„æ–¹æ³•ï¼Œæ˜¯è®¡ç®—æœºç¼–ç¨‹æŠ€æœ¯å‘å±•åˆ°ä¸€å®šé˜¶æ®µåçš„äº§ç‰©ã€‚ ä¸¥æ ¼æ¥è¯´ï¼Œgoä¸å±äºé¢å‘å¯¹è±¡çš„è¯­è¨€ï¼ˆæš‚ä¸æ”¯æŒç»§æ‰¿ï¼‰ï¼Œä½†goå…è®¸é¢å‘å¯¹è±¡çš„ç¼–ç¨‹é£æ ¼ã€‚ä»Šå¤©æˆ‘ä»¬å°±æ¥å®ç°ä¸€ä¸ªé¢å‘å¯¹è±¡çš„demoã€‚ å®åœ¨æ²¡æƒ³åˆ°å¥½ä¸€ç‚¹çš„ä¾‹å­ï¼Œä¸çŸ¥é“å¤§ä¼™æœ‰æ²¡æœ‰å¯¹è±¡ï¼Œä¸å¦‚ä»¥girl friendä¸ºä¾‹æ¥å¼„ä¸ªdemo å§ï¼Œå¥³åŒå­¦è¯·newä¸€ä¸ªboyfrindã€‚å½“ç„¶äº†ï¼Œnewä»€ä¹ˆéƒ½è¡Œï¼Œéšä½ å–œæ¬¢â€¦â€¦. æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå¥³æœ‹å‹å¯¹è±¡ï¼š type GirlFriend struct &#123; height int // èº«é«˜ weight int // ä½“é‡ age int // å¹´é¾„ name string // å§“å content string // ç»“æŸè¯­ greetings string // é—®å€™è¯­ &#125; æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰èº«é«˜ï¼Œä½“é‡ï¼Œå¹´é¾„ï¼Œå§“åï¼š func (gf *GirlFriend) SetHeight(v int) &#123; gf.height = v &#125; func (gf *GirlFriend) SetWeight(v int) &#123; gf.weight = v &#125; func (gf *GirlFriend) SetAge(v int) &#123; gf.age = v &#125; func (gf *GirlFriend) SetName(v string) &#123; gf.name = v &#125; å–œæ¬¢ä½¿ç”¨é“¾å¼æ“ä½œçš„å¯ä»¥è¿™ä¹ˆæ¥ï¼ŒæŠŠå¥³æœ‹å‹returnå›å»å³å¯ï¼š func (gf *GirlFriend) SetContent(v string) *GirlFriend &#123; gf.content = v return gf &#125; func (gf *GirlFriend) SetGreeting(v string) *GirlFriend &#123; gf.greetings = v return gf &#125; æˆ‘ä»¬å½“ç„¶è¿˜æœ‰å®ç°ä¸€ä¸‹ï¼Œæ²¡æœ‰å¥³æœ‹å‹ï¼Œnewä¸€ä¸ªï¼š func NewOne() *GirlFriend &#123; return &amp;GirlFriend&#123;&#125; &#125; newå‡ºæ¥äº†ï¼Œå½“ç„¶è¦ç§€ä¸€ä¸‹ï¼š func (gf *GirlFriend) Show() &#123; fmt.Println(gf.greetings + &quot;æˆ‘æ˜¯&quot; + gf.name + &quot;,ä»Šå¹´&quot; + strconv.Itoa(gf.age) + &quot;å²ï¼Œèº«é«˜&quot; + strconv.Itoa(gf.height) + &quot;cm,ä½“é‡&quot; + strconv.Itoa(gf.weight) + &quot;kgã€‚&quot; + gf.content) &#125; æˆ‘ä»¬æ¥è¿è¡Œä¸€ä¸ªï¼š package main import ( &quot;demo5-OOP/oop&quot; ) func main() &#123; gf := oop.NewOne() gf.SetName(&quot;Lily&quot;) gf.SetHeight(170) gf.SetWeight(50) gf.SetGreeting(&quot;hello,&quot;).SetContent(&quot;thanks for your great creavity!&quot;).SetAge(24) gf.Show() &#125; è¿™ä¸€ç¯‡æ¯”è¾ƒç®€å•ï¼Œä¾‹å­å‘¢ï¼Œä»…ä»…æ˜¯ç©ç¬‘ï¼Œä¸å¯å½“çœŸï¼Œå¥³æœ‹å‹newæ˜¯ä¸å¯è¡Œçš„ï¼Œè¿˜æ˜¯è¦ä¸»åŠ¨å»è¿½çš„ã€‚è¿™é‡Œä¸»è¦æ˜¯å±•ç¤ºä¸€ä¸‹goçš„é¢å‘å¯¹è±¡å®ç°ï¼Œåœ¨ä½¿ç”¨å…¶ä»–åº“çš„è¿‡ç¨‹ä¸­åº”è¯¥æœ‰æ³¨æ„åˆ°ä¸€äº›æ¨¡å—ä½¿ç”¨äº†é¢å‘å¯¹è±¡çš„å®ç°ï¼Œå¸Œæœ›å¤§å®¶å»åšä¸€äº›æŠ½è±¡ï¼Œåœ¨è‡ªå·±çš„é¡¹ç›®åˆé€‚çš„åœ°æ–¹å»å®ç°ä¸€ä¸‹ï¼Œè®©è‡ªå·±çš„ä»£ç æ›´ä¼˜é›…ã€æ›´å¥å£®ï¼Œä¹Ÿå¸Œæœ›å¤§å®¶éƒ½èƒ½æ‰¾åˆ°å¯¹çš„äººï¼Œä¸€èµ·newä¸€ä¸ªbabyã€‚ å®Œæ•´ä»£ç ç‚¹å‡»è¿›github","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"go-kit","slug":"goexample6","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:31:08.002Z","comments":true,"path":"2021/02/12/goexample6/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample6/","excerpt":"","text":"ä½•ä¸ºgo-kit Go kit is a programming toolkit for building microservices (or elegant monoliths) in Go. We solve common problems in distributed systems and application architecture so you can focus on delivering business value. go kitæ˜¯ä¸€ä¸ªç”¨äºåœ¨Goä¸­æ„å»ºå¾®æœåŠ¡ï¼ˆæˆ–ä¼˜é›…çš„æ•´ä½“ï¼‰çš„ç¼–ç¨‹å·¥å…·åŒ…ï¼Œè§£å†³äº†åˆ†å¸ƒå¼ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä½“ç³»ç»“æ„ä¸­çš„å¸¸è§é—®é¢˜ï¼Œä»¥ä¾¿å¼€å‘è€…èƒ½å¤Ÿä¸“æ³¨äºä¸šåŠ¡äº¤ä»˜ã€‚ go-kitä¸»è¦åˆ†ä¸ºä¸‰å±‚ç»“æ„ï¼šTransportå±‚ï¼ŒEndpointå±‚ï¼ŒServiceå±‚ã€‚ Transport è´Ÿè´£ä¸ä¼ è¾“åè®®HTTPã€GRPCç­‰ç›¸å…³çš„é€»è¾‘ Endpoint è´Ÿè´£request/responseæ ¼å¼çš„è½¬æ¢ï¼Œä»¥åŠå…¬ç”¨æ‹¦æˆªå™¨ç›¸å…³çš„é€»è¾‘ Service ä¸šåŠ¡é€»è¾‘ã€‚ å¦å¤–ï¼Œgo-kitæä¾›logæ—¥å¿—ï¼Œmetricè®¡æ•°å™¨ï¼Œtracingè¯·æ±‚è·Ÿè¸ªï¼ŒcircuitbreakeræœåŠ¡ç†”æ–­ï¼Œrate-limiteré™æµå™¨ç­‰æ¨¡å—ã€‚ç®€å•è¯´ï¼Œgo-kitæä¾›äº†å¾®æœåŠ¡æ¶æ„å¸¸è§çš„åŸºç¡€æ¨¡å—ï¼Œå¯ä»¥è®©å¼€å‘è€…çœå»å¾ˆå¤šæ—¶é—´ã€‚ å¼€å§‹äº†è§£è¿˜ä¸å¤Ÿï¼Œshow codeã€‚ æˆ‘ä»¬å…ˆå®šä¹‰ä¸‹serviceï¼Œä¸å¦‚å°±åšä¸ªç®€å•çš„è®¡ç®—å™¨ï¼Œä»…ä»…åšæ¼”ç¤ºï¼Œæœ‰åŠ å‡åŠŸèƒ½å³å¯ï¼Œä¸æ•´å¤ªå¤æ‚äº†ã€‚ package service // æ¥å£å®šä¹‰ type CalculateService interface &#123; Add(a, b int) int Reduce(a, b int) int Multi(a, b int) int &#125; type calculateService struct&#123;&#125; func NewService() *calculateService &#123; return &amp;calculateService&#123;&#125; &#125; func (s *calculateService) Add(a, b int) int &#123; return a + b &#125; func (s *calculateService) Reduce(a, b int) int &#123; return a - b &#125; func (s *calculateService) Multi(a, b int) int &#123; return a * b &#125; æ³¨æ„ï¼šGo æ¥å£æ˜¯ä¸€ç»„æ–¹æ³•çš„é›†åˆï¼Œå¯ä»¥ç†è§£ä¸ºæŠ½è±¡çš„ç±»å‹ã€‚å®ƒæä¾›äº†ä¸€ç§éä¾µå…¥å¼çš„æ¥å£ã€‚ä»»ä½•ç±»å‹ï¼Œåªè¦å®ç°äº†è¯¥æ¥å£ä¸­æ–¹æ³•é›†ï¼Œé‚£ä¹ˆå°±å±äºè¿™ä¸ªç±»å‹ã€‚ï¼ˆè¿™æ˜¯goä¸­éå¸¸å¸¸ç”¨çš„ç‰¹æ€§ï¼Œåˆ‡è®°) endpointæ ¼å¼åŒ–è¯·æ±‚ï¼Œè°ƒç”¨serviceæœåŠ¡ï¼Œå¹¶æ ¼å¼åŒ–è¾“å‡º package endpoint import ( &quot;context&quot; &quot;demo6/service&quot; &quot;fmt&quot; &quot;github.com/go-kit/kit/endpoint&quot; ) type Request struct &#123; A int `json:&quot;a&quot; form:&quot;a&quot;` B int `json:&quot;b&quot; form:&quot;b&quot;` &#125; type Res struct &#123; Res int `json:&quot;res&quot;` Err error `json:&quot;err&quot;` &#125; func MakeAddEndpoint(s service.CalculateService) endpoint.Endpoint &#123; return func(_ context.Context, request interface&#123;&#125;) (interface&#123;&#125;, error) &#123; req := request.(Request) return Res&#123;Res: s.Add(req.A, req.B)&#125;, nil &#125; &#125; func MakeReduceEndpoint(s service.CalculateService) endpoint.Endpoint &#123; return func(_ context.Context, request interface&#123;&#125;) (interface&#123;&#125;, error) &#123; req := request.(Request) return Res&#123;Res: s.Reduce(req.A, req.B)&#125;, nil &#125; &#125; func MakeMultiEndpoint(s service.CalculateService) endpoint.Endpoint &#123; return func(_ context.Context, request interface&#123;&#125;) (interface&#123;&#125;, error) &#123; req := request.(Request) return Res&#123;Res: s.Multi(req.A, req.B)&#125;, nil &#125; &#125; æ¥ä¸‹æ¥ï¼Œå®šä¹‰transportå®šä¹‰è¯·æ±‚æ–¹å¼ï¼ˆè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨jsonï¼‰ï¼š package transport import ( &quot;context&quot; &quot;demo6/endpoint&quot; &quot;encoding/json&quot; &quot;errors&quot; &quot;net/http&quot; ) func DecodeRequest(_ context.Context, r *http.Request) (interface&#123;&#125;, error) &#123; var req endpoint.Request if err := json.NewDecoder(r.Body).Decode(&amp;req); err != nil &#123; return nil, errors.New(&quot;params error&quot;) &#125; return req, nil &#125; func EncodeResponse(_ context.Context, w http.ResponseWriter, res interface&#123;&#125;) error &#123; return json.NewEncoder(w).Encode(res) &#125; æœ€åæˆ‘ä»¬å°†å®ƒä»¬endpointå’Œtransportç²˜åˆèµ·æ¥ï¼Œè·‘èµ·æ¥goï½ package main import ( &quot;demo6/endpoint&quot; &quot;demo6/service&quot; &quot;demo6/transport&quot; &quot;net/http&quot; httpTransport &quot;github.com/go-kit/kit/transport/http&quot; ) func main() &#123; s := service.NewService() add := httpTransport.NewServer( endpoint.MakeAddEndpoint(s), transport.DecodeRequest, transport.EncodeResponse, ) reduce := httpTransport.NewServer( endpoint.MakeReduceEndpoint(s), transport.DecodeRequest, transport.EncodeResponse, ) multi := httpTransport.NewServer( endpoint.MakeMultiEndpoint(s), transport.DecodeRequest, transport.EncodeResponse, ) http.Handle(&quot;/add&quot;, add) http.Handle(&quot;/reduce&quot;, reduce) http.Handle(&quot;/multi&quot;, multi) http.ListenAndServe(&quot;:9009&quot;, nil) &#125; è¿è¡Œèµ·æ¥ï¼š æˆåŠŸè¿è¡Œï¼ è¯¦ç»†ä»£ç è¿›githubgithub.com/13sai/go-example/tree/main/demo6-go-kit ç•™ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹äºjsonæ ¼å¼é”™è¯¯çš„è¯·æ±‚ï¼Œè¿”å›çš„ä¸æ˜¯jsonï¼Œå¦‚ä½•æ”¹é€ ï¼Œè®©æ¥å£è¿”å›jsonå‘¢ï¼Ÿ æœ€è¿‘è‡ªå·±åœ¨ç ”ç©¶goå¾®æœåŠ¡è¿™å—çš„çŸ¥è¯†ï¼Œåç»­å‡ ç¯‡æ–‡å­—åº”è¯¥éƒ½ä¼šä»¥go-kitä¸ºåŸºç¡€å±•å¼€ï¼Œæœ‰å…´è¶£å¯ç»§ç»­å…³æ³¨ã€‚","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"docker-composeæ•´åˆgo-kitå’Œmysqlã€redis","slug":"goexample7","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:31:11.825Z","comments":true,"path":"2021/02/12/goexample7/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample7/","excerpt":"","text":"ä¸“æ ä¹‹å‰æœ‰ä½¿ç”¨go-kitã€gormã€go-redisï¼Œæ‰€ä»¥éƒ¨åˆ†å†…å®¹å°±å¿½ç•¥ã€‚ å®šä¹‰modelä¸»è¦å®ç°SelectByEmailï¼ˆæŸ¥æ‰¾ï¼‰å’ŒSaveï¼ˆæ–°å»ºï¼‰ä¸¤ä¸ªæ–¹æ³•ï¼š package model import &quot;time&quot; type UserEntity struct &#123; ID int64 Username string Password string Email string CreatedAt time.Time &#125; func (UserEntity) TableName() string &#123; return &quot;user&quot; &#125; type UserDao interface &#123; SelectByEmail(email string) (*UserEntity, error) Save(user *UserEntity) error &#125; type UserDaoImpl struct&#123;&#125; func (u *UserDaoImpl) SelectByEmail(email string) (*UserEntity, error) &#123; user := &amp;UserEntity&#123;&#125; err := db.Where(&quot;email = ?&quot;, email).First(user).Error return user, err &#125; func (u *UserDaoImpl) Save(user *UserEntity) error &#123; return db.Create(user).Error &#125; ä¸šåŠ¡servicepackage service import ( &quot;context&quot; &quot;demo7-docker-compose/model&quot; &quot;errors&quot; &quot;log&quot; &quot;time&quot; &quot;github.com/jinzhu/gorm&quot; ) type UserInfoDTO struct &#123; ID int64 `json:&quot;id&quot;` Username string `json:&quot;username&quot;` Email string `json:&quot;email&quot;` &#125; var ( ErrUserExisted = errors.New(&quot;user is existed&quot;) ErrPassword = errors.New(&quot;email and password are not match&quot;) ErrRegistering = errors.New(&quot;email is registering&quot;) ) type RegisterUser struct &#123; Username string Password string Email string &#125; type UserService interface &#123; Login(ctx context.Context, email, pass string) (*UserInfoDTO, error) Register(ctx context.Context, user *RegisterUser) (*UserInfoDTO, error) &#125; type UserServiceImpl struct &#123; userDao model.UserDao &#125; func MakeUserServiceImpl(userDao model.UserDao) UserService &#123; return &amp;UserServiceImpl&#123; userDao, &#125; &#125; func (userService *UserServiceImpl) Login(ctx context.Context, email, password string) (*UserInfoDTO, error) &#123; user, err := userService.userDao.SelectByEmail(email) if err == nil &#123; if user.Password == password &#123; return &amp;UserInfoDTO&#123; ID: user.ID, Username: user.Username, Email: user.Email, &#125;, nil &#125; else &#123; return nil, ErrPassword &#125; &#125; else &#123; log.Printf(&quot;err : %s&quot;, err) &#125; return nil, err &#125; func (userService UserServiceImpl) Register(ctx context.Context, user *RegisterUser) (*UserInfoDTO, error) &#123; ret := model.RedisClient.SetNX(user.Email, 1, time.Duration(5)*time.Second) if ret.Val() == false &#123; return nil, ErrRegistering &#125; defer model.RedisClient.Del(user.Email) existUser, err := userService.userDao.SelectByEmail(user.Email) if (err == nil &amp;&amp; existUser == nil) || err == gorm.ErrRecordNotFound &#123; newUser := &amp;model.UserEntity&#123; Username: user.Username, Password: user.Password, Email: user.Email, &#125; err = userService.userDao.Save(newUser) if err == nil &#123; return &amp;UserInfoDTO&#123; ID: newUser.ID, Username: newUser.Username, Email: newUser.Email, &#125;, nil &#125; &#125; if err == nil &#123; err = ErrUserExisted &#125; return nil, err &#125; æ­¤å¤„æ³¨æ„åˆ†å¸ƒå¼é”çš„å®ç°ï¼Œåˆ©ç”¨äº†redisçš„setnxæ–¹æ³•ï¼Œå¹¶å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå¯¹åº”redisä¸­çš„ SET key value [EX seconds] [PX milliseconds] [NX|XX] ret := model.RedisClient.SetNX(user.Email, 1, time.Duration(5)*time.Second) if ret.Val() == false &#123; return nil, ErrRegistering &#125; defer model.RedisClient.Del(user.Email) å¯¹äºendpointå’Œtransportï¼Œå°±ä¸ä¹‹å‰çš„æ²¡æœ‰å¤ªå¤§å·®åˆ«äº†ï¼Œæˆ‘ä»¬è¿™é‡Œå°±æš‚æ—¶ç•¥å»ï¼Œæœ‰å…´è¶£å¯ç‚¹å‡»æ–‡ç« æœ€åçš„æºç æŸ¥çœ‹ã€‚ mysqlå’Œrediså®¹å™¨mysqlçš„Dockerfileï¼š FROM mysql:5.7 WORKDIR /docker-entrypoint-initdb.d ENV LANG=C.UTF-8 COPY user.sql . è¿è¡Œmysql-for-userå®¹å™¨ docker run -itd --name mysql-for-user -p 3316:3306 -e MYSQL_ROOT_PASSWORD=111111 mysql-for-user è¿™é‡Œå®¹å™¨å¯åŠ¨çš„æ—¶å€™æ˜¯å¯ä»¥æ‰§è¡Œuser.sqlçš„ã€‚ï¼ˆå¯é€šè¿‡docker logs mysql-for-useræŸ¥çœ‹å®¹å™¨å¯åŠ¨ä¿¡æ¯ï¼‰ /usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/user.sql rediså®¹å™¨çš„å¯åŠ¨ç®€å• docker pull redis:5.0 docker run -itd --name redis5 -p 6389:6379 redis:5.0 ç„¶åæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸»ç¨‹åºï¼Œæ™ºèƒ½åˆ°8089ç«¯å£ï¼š go run main.go -service.port 8089 æµ‹è¯•ä¸€ä¸‹ã€‚ å¯ä»¥å®ç°ç™»å½•ä¸æ³¨å†ŒåŠŸèƒ½ã€‚ æ‰“åŒ…ä¼šå‘˜é•œåƒå…ˆç¼–è¯‘ï¼š CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o user . userçš„dockerfile FROM alpine:3.12 WORKDIR / COPY ./user / ENTRYPOINT [&quot;./user&quot;] æ„å»ºé•œåƒ: docker build -t user-alpine . docker-composeversion: &#x27;2.1&#x27; services: user13: image: user-alpine depends_on: - redis - mysql ports: - &quot;8088:8088&quot; links: - redis - mysql networks: - user mysql: image: mysql-for-user ports: - &quot;3306:3306&quot; expose: - &quot;3306&quot; environment: - MYSQL_ROOT_PASSWORD=111111 networks: - user restart: always redis: image: redis:5.0 ports: - &quot;6379:6379&quot; expose: - &quot;6379&quot; networks: - user networks: user: driver: bridge è¯´æ˜ï¼š depends_on ä¾èµ–ï¼Œæ­¤å¤„è¡¨ç¤ºuser13ä¾èµ–redisã€mysqlï¼Œè¢«ä¾èµ–è€…ä¼šä¼˜å…ˆæ„å»ºï¼Œä½†æ˜¯æ˜¯å¯èƒ½è„šæœ¬ä¸ºè¿è¡ŒæˆåŠŸçš„ï¼Œæ‰€ä»¥user13æ˜¯æœ‰å¯èƒ½åˆšå¼€å§‹è¿æ¥ä¸ä¸Šmysqlçš„ï¼Œdocker startå³å¯ links è¿æ¥ï¼Œæ­¤å¤„user13è¿æ¥åˆ°redisã€mysqlï¼Œå¯ä»¥ç”¨å®ƒä»¬æ›¿ä»£è¿æ¥æ•°æ®åº“çš„host environment ç¯å¢ƒå˜é‡ expose å¯¹linksæš´éœ²çš„ç«¯å£ è¿è¡Œdocker-compose upå³å¯ã€‚ å¯ä»¥çœ‹è§æœåŠ¡è¿è¡ŒæˆåŠŸäº†ã€‚wowï½ è¯¦ç»†ä»£ç ç‚¹å‡»è¿›github dcoker composerè¯­æ³•å¯çœ‹èœé¸Ÿæ•™ç¨‹ï¼š Docker Compose | èœé¸Ÿæ•™ç¨‹ æ–‡ä¸­éƒ¨åˆ†çŸ¥è¯†æ¥è‡ªã€ŠGoå¾®æœåŠ¡å®æˆ˜38è®²ã€‹ï¼Œæœ‰å…´è¶£å¯å‰å¾€æŸ¥çœ‹ï¼š","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"goruntineå’Œchannel","slug":"goexample8","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:31:15.517Z","comments":true,"path":"2021/02/12/goexample8/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample8/","excerpt":"","text":"å‰é¢å‡ ä¸ªå›åˆï¼Œæˆ‘ä»¬éƒ½æ˜¯å®ä¾‹ï¼Œä½†åœ¨goä¸­æœ‰ä¸ªå¾ˆå¸¸ç”¨çš„ä¸œä¸œï¼Œæˆ‘ä»¬ä»£ç ä½¿ç”¨çš„ä¸å¤šï¼Œè¿™ä¸€æ¬¡æˆ‘ä»¬å•ç‹¬æ‹¿æ¥è®²è®²ã€‚ goroutine goroutineæ˜¯goè¯­è¨€ç‰¹æœ‰çš„å¹¶å‘ä½“ï¼Œæ˜¯ä¸€ç§è½»é‡çº§çš„çº¿ç¨‹ï¼Œç”±goå…³é”®å­—å¯åŠ¨ã€‚ goroutineé‡‡ç”¨çš„æ˜¯åŠæŠ¢å å¸‚çš„åä½œè°ƒåº¦ï¼Œåªæœ‰å½“å‰goroutineå‘ç”Ÿé˜»å¡æ—¶æ‰ä¼šå¯¼è‡´è°ƒåº¦ï¼ˆä¹Ÿå°±æ˜¯goroutineçš„åˆ‡æ¢ï¼‰ã€‚ é‚£ä¹ˆé¡¹ç›®ä¸­ä½¿ç”¨äº†å¤šä¸ªgoroutineï¼Œå¦‚ä½•åœ¨ä¸åŒçš„goroutineä¹‹é—´é€šä¿¡å‘¢ï¼Ÿ å­¦ä¹ goçš„è¿‡ç¨‹ä¸­ï¼Œæƒ³å¿…ä½ åº”è¯¥çŸ¥é“æœ‰è¿™ä¹ˆä¸€ä¸ªç»å…¸çš„å¥å­ï¼š Do not communicate by sharing memory; instead, share memory by communicating. goroutineçš„é€šä¿¡ç”¨é€šé“ é€šé“æ˜¯ä¸ªå•¥ï¼Ÿ ä¸€ä¸ªé€šé“ç›¸å½“äºä¸€ä¸ªå…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„é˜Ÿåˆ—ï¼Œé€šé“ä¸­çš„å„ä¸ªå…ƒç´ æ˜¯ä¸¥æ ¼åœ°æŒ‰ç…§å‘é€çš„é¡ºåºæ’åˆ—çš„ï¼Œå…ˆè¢«å‘é€é€šé“çš„ä¸€å®šä¼šå…ˆè¢«æ¥æ”¶ã€‚å…ƒç´ çš„å‘é€å’Œæ¥æ”¶éƒ½éœ€è¦ç”¨åˆ°æ“ä½œç¬¦&lt;-ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªFIFOç®€å•çš„ä¾‹å­ package main import &quot;fmt&quot; func main() &#123; ch := make(chan int, 5) ch &lt;- 1 ch &lt;- 2 ch &lt;- 3 ch &lt;- 4 ch &lt;- 5 fmt.Println(&quot;1-&quot;, &lt;-ch) fmt.Println(&quot;2-&quot;, &lt;-ch) ch &lt;- 6 fmt.Println(&quot;3-&quot;, &lt;-ch) fmt.Println(&quot;4-&quot;, &lt;-ch) fmt.Println(&quot;5-&quot;, &lt;-ch) fmt.Println(&quot;6-&quot;, &lt;-ch) close(ch) &#125; /* æ‰“å°çš„å†…å®¹å¦‚ä¸‹ï¼š 1- 1 2- 2 3- 3 4- 4 5- 5 6- 6 */ æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹é€šé“çš„å¸¸è§„æ“ä½œï¼š åˆ›å»ºé€šé“é€šé“ï¼ˆchannelï¼‰åˆ†ä¸¤ç§ï¼ˆå®¹é‡æ˜¯å¦ä¸º0ï¼‰ï¼š ç¼“å†²é€šé“ éç¼“å†²é€šé“ // ç¼“å†²é€šé“ ch1 := make(chan int, 10) ch2 := make(chan bool, 2) // éç¼“å†²é€šé“ ch3 := make(chan int) ch4 := make(chan bool, 0) å‘é€é€šé“æ•°æ®// åˆ›å»ºä¸€ä¸ªç©ºæ¥å£é€šé“ï¼Œæ³¨æ„å®šä¹‰çš„é€šé“ç±»å‹æœ‰ ch := make(chan interface&#123;&#125;) // å°†0æ”¾å…¥é€šé“ä¸­ ch &lt;- 0 // å°†helloå­—ç¬¦ä¸²æ”¾å…¥é€šé“ä¸­ ch &lt;- &quot;hello&quot; æ¥æ”¶é€šé“æ•°æ®1. é˜»å¡æ¥æ”¶æ•°æ®é˜»å¡æ¨¡å¼æ¥æ”¶æ•°æ®æ—¶ï¼Œå°†æ¥æ”¶å˜é‡ä½œä¸º&lt;-æ“ä½œç¬¦çš„å·¦å€¼ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š data := &lt;-ch æ‰§è¡Œè¯¥è¯­å¥æ—¶å°†ä¼šé˜»å¡ï¼Œç›´åˆ°æ¥æ”¶åˆ°æ•°æ®å¹¶èµ‹å€¼ç»™ data å˜é‡ã€‚ 2. éé˜»å¡æ¥æ”¶æ•°æ®ä½¿ç”¨éé˜»å¡æ–¹å¼ä»é€šé“æ¥æ”¶æ•°æ®æ—¶ï¼Œè¯­å¥ä¸ä¼šå‘ç”Ÿé˜»å¡ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š data, ok := &lt;-ch // dataï¼šè¡¨ç¤ºæ¥æ”¶åˆ°çš„æ•°æ®ã€‚æœªæ¥æ”¶åˆ°æ•°æ®æ—¶ï¼Œdata ä¸ºé€šé“ç±»å‹çš„é›¶å€¼ // okï¼šè¡¨ç¤ºæ˜¯å¦æ¥æ”¶åˆ°æ•°æ®ã€‚ éé˜»å¡çš„é€šé“æ¥æ”¶æ–¹æ³•å¯èƒ½é€ æˆé«˜çš„ CPU å ç”¨ï¼Œå› æ­¤ä½¿ç”¨éå¸¸å°‘ã€‚å¦‚æœéœ€è¦å®ç°æ¥æ”¶è¶…æ—¶æ£€æµ‹ï¼Œå¯ä»¥é…åˆ select å’Œè®¡æ—¶å™¨ channel è¿›è¡Œï¼Œå¯ä»¥å‚è§åé¢çš„å†…å®¹ã€‚ 3. æ¥æ”¶ä»»æ„æ•°æ®ï¼Œå¿½ç•¥æ¥æ”¶çš„æ•°æ®é˜»å¡æ¥æ”¶æ•°æ®åï¼Œå¿½ç•¥ä»é€šé“è¿”å›çš„æ•°æ®ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š &lt;-ch 4. å¾ªç¯æ¥æ”¶é€šé“çš„æ•°æ®æ¥æ”¶å¯ä»¥å€Ÿç”¨ for range è¯­å¥è¿›è¡Œå¤šä¸ªå…ƒç´ çš„æ¥æ”¶æ“ä½œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š package main import ( &quot;fmt&quot; &quot;time&quot; ) func main() &#123; // æ„å»ºä¸€ä¸ªé€šé“ ch := make(chan int) // å¼€å¯ä¸€ä¸ªå¹¶å‘åŒ¿åå‡½æ•° go func() &#123; // ä»3å¾ªç¯åˆ°0 for i := 3; i &gt;= 0; i-- &#123; // å‘é€3åˆ°0ä¹‹é—´çš„æ•°å€¼ ch &lt;- i // æ¯æ¬¡å‘é€å®Œæ—¶ç­‰å¾… time.Sleep(time.Second) &#125; &#125;() // éå†æ¥æ”¶é€šé“æ•°æ® for data := range ch &#123; // æ‰“å°é€šé“æ•°æ® fmt.Println(data) // å½“é‡åˆ°æ•°æ®0æ—¶, é€€å‡ºæ¥æ”¶å¾ªç¯ if data == 0 &#123; break &#125; &#125; &#125; å…³é—­é€šé“ch := make(chan string) ... close(ch) é€šé“ç‰¹æ€§ å¯¹äºåŒä¸€ä¸ªé€šé“ï¼Œå‘é€æ“ä½œä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œæ¥æ”¶æ“ä½œä¹‹é—´ä¹Ÿæ˜¯äº’æ–¥çš„ï¼ˆå¹¶å‘å®‰å…¨ï¼‰ å‘é€æ“ä½œå’Œæ¥æ”¶æ“ä½œä¸­å¯¹å…ƒç´ å€¼çš„å¤„ç†éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„ã€‚ å‘é€æ“ä½œåœ¨å®Œå…¨å®Œæˆä¹‹å‰ä¼šè¢«é˜»å¡ï¼Œæ¥æ”¶æ“ä½œä¹Ÿæ˜¯ä¸€æ ·ã€‚ å¯¹äºç¼“å†²é€šé“ï¼šå¦‚æœé€šé“å·²æ»¡ï¼Œé‚£ä¹ˆå¯¹å®ƒçš„æ‰€æœ‰å‘é€æ“ä½œéƒ½ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é€šé“ä¸­æœ‰å…ƒç´ å€¼è¢«æ¥æ”¶èµ°ï¼›å¦‚æœé€šé“å·²ç©ºï¼Œé‚£ä¹ˆå¯¹å®ƒçš„æ‰€æœ‰æ¥æ”¶æ“ä½œéƒ½ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é€šé“ä¸­æœ‰æ–°çš„å…ƒç´ å€¼å‡ºç°ã€‚ å¯¹äºéç¼“å†²é€šé“ï¼šæ— è®ºæ˜¯å‘é€æ“ä½œè¿˜æ˜¯æ¥æ”¶æ“ä½œï¼Œä¸€å¼€å§‹æ‰§è¡Œå°±ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é…å¯¹çš„æ“ä½œä¹Ÿå¼€å§‹æ‰§è¡Œï¼Œæ‰ä¼šç»§ç»­ä¼ é€’ã€‚ æ³¨æ„ç‚¹ï¼š å…³é—­é€šé“è¦åœ¨å‘é€æ–¹å…³é—­ï¼Œå…³é—­åå¦‚æœchannelå†…è¿˜æœ‰å…ƒç´ ï¼Œå¹¶ä¸ä¼šå¯¹æ¥ä¸‹æ¥çš„æ¥æ”¶äº§ç”Ÿå½±å“ å•å‘é€šé“æœ€ä¸»è¦çš„ç”¨é€”å°±æ˜¯çº¦æŸå…¶ä»–ä»£ç çš„è¡Œä¸º é€šè¿‡å‡½æ•°çš„å‚æ•°ç±»å‹æˆ–è€…è¿”å›å€¼ç±»å‹æ¥é™åˆ¶ï¼ˆGoçš„è¯­æ³•ç³–ï¼‰ã€‚ func(ch chan&lt;- int)ï¼›ä¼ å…¥åŒå‘é€šé“ï¼Œåœ¨å‡½æ•°é‡Œé¢è°ƒç”¨chåªèƒ½å‘é€ func() (ch &lt;-chan int)ï¼›è¿”å›åŒå‘é€šé“ï¼Œåœ¨å‡½æ•°å¤–é¢é‡Œé¢è°ƒç”¨chåªèƒ½æ¥æ”¶ è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æä¸€ä¸‹channelç‹¬æœ‰çš„å…³é”®å­—â€”â€”selectã€‚ A â€œselectâ€ statement chooses which of a set of possible send or receive operations will proceed. It looks similar to a â€œswitchâ€ statement but with the cases all referring to communication operations. ä¸€ä¸ªselectè¯­å¥ç”¨æ¥é€‰æ‹©å“ªä¸ªcaseä¸­çš„å‘é€æˆ–æ¥æ”¶æ“ä½œå¯ä»¥è¢«ç«‹å³æ‰§è¡Œã€‚å®ƒç±»ä¼¼äºswitchè¯­å¥ï¼Œä½†æ˜¯å®ƒçš„caseæ¶‰åŠåˆ°channelæœ‰å…³çš„I/Oæ“ä½œã€‚ è¯´å®Œè¿™äº›æ¦‚å¿µæ€§çš„ç©æ„å„¿ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ¥å‡ ä¸ªå®ä¾‹ï¼Œæ„Ÿå—ä¸€ä¸‹goroutineé…åˆchannelä½¿ç”¨çš„å¿«æ„Ÿã€‚ chané…åˆselectå®ç°è¶…æ—¶å¤„ç†func main() &#123; timeout := make(chan bool) go func() &#123; time.Sleep(3e9) timeout &lt;- true &#125;() ch := make(chan int) select &#123; case &lt;-ch: case &lt;-timeout: fmt.Println(&quot;timeout!&quot;) &#125; &#125; éç¼“å†²é€šé“ï¼Œç›‘å¬ä¿¡å·é‡// æ¥è‡ªginæ–‡æ¡£çš„ä¾‹å­ func main() &#123; router := gin.Default() router.GET(&quot;/&quot;, func(c *gin.Context) &#123; time.Sleep(5 * time.Second) c.String(http.StatusOK, &quot;Welcome Gin Server&quot;) &#125;) srv := &amp;http.Server&#123; Addr: &quot;:8080&quot;, Handler: router, &#125; go func() &#123; // æœåŠ¡è¿æ¥ if err := srv.ListenAndServe(); err != nil &amp;&amp; err != http.ErrServerClosed &#123; log.Fatalf(&quot;listen: %s\\n&quot;, err) &#125; &#125;() // ç­‰å¾…ä¸­æ–­ä¿¡å·ä»¥ä¼˜é›…åœ°å…³é—­æœåŠ¡å™¨ï¼ˆè®¾ç½® 5 ç§’çš„è¶…æ—¶æ—¶é—´ï¼‰ quit := make(chan os.Signal) signal.Notify(quit, os.Interrupt) &lt;-quit log.Println(&quot;Shutdown Server ...&quot;) ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second) defer cancel() if err := srv.Shutdown(ctx); err != nil &#123; log.Fatal(&quot;Server Shutdown:&quot;, err) &#125; log.Println(&quot;Server exiting&quot;) &#125; å½“ç„¶è¿˜æœ‰å…¶ä»–åº”ç”¨åœºæ™¯ï¼Œå¦‚æ¶ˆæ¯ä¼ é€’ã€æ¶ˆæ¯è¿‡æ»¤ï¼Œäº‹ä»¶è®¢é˜…ä¸å¹¿æ’­ï¼Œè¯·æ±‚ã€å“åº”è½¬å‘ï¼Œå¹¶å‘æ§åˆ¶ï¼ŒåŒæ­¥ä¸å¼‚æ­¥ç­‰ï¼Œå¯å‚è€ƒä¸‹é¢çš„æ–‡ç« ï¼š æ€»ç»“äº†æ‰çŸ¥é“ï¼ŒåŸæ¥channelæœ‰è¿™ä¹ˆå¤šç”¨æ³•ï¼ å®ä¾‹ä»£ç ç‚¹å‡»è§githubgithub.com/13sai/go-example/tree/main/demo8-goroutine-channel å‚è€ƒï¼š Goè¯­è¨€é€šé“ï¼ˆchanï¼‰â€”â€”goroutineä¹‹é—´é€šä¿¡çš„ç®¡é“ Goè¯­è¨€æ ¸å¿ƒ36è®²_Golang_Goè¯­è¨€-æå®¢æ—¶é—´","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"golangé™æµå™¨","slug":"goexample9","date":"2021-02-12T13:48:20.000Z","updated":"2022-03-30T11:31:19.650Z","comments":true,"path":"2021/02/12/goexample9/","link":"","permalink":"https://github.13sai.com/2021/02/12/goexample9/","excerpt":"","text":"é™æµåº”è¯¥æ˜¯æˆ‘ä»¬å¼€å‘ä¸­ç»å¸¸é‡åˆ°çš„äº†ï¼Œé™æµå™¨èƒ½ä¿è¯æˆ‘ä»¬ä¸è‡³äºåœ¨æµé‡è¿‡å¤§çš„æ—¶å€™æœåŠ¡è¶…è¿‡è´Ÿè½½ï¼Œèƒ½æœ‰æ•ˆåœ°ä¿è¯æœåŠ¡çš„å¯ç”¨å’Œç¨³å®šã€‚ goè‡ªå¸¦æœ‰é™æµå™¨rateï¼Œå®ƒçš„æœ¬è´¨å…¶å®å°±æ˜¯ä»¤ç‰Œæ¡¶ã€‚ç”¨èµ·æ¥ä¹Ÿååˆ†ç®€å•ã€‚æˆ‘ä»¬ä¿®æ”¹ä¸‹ä¹‹å‰çš„httpæœåŠ¡åšä¸€äº›ä¿®æ”¹ï¼š func main() &#123; // ServeMuxç±»å‹æ˜¯HTTPè¯·æ±‚çš„å¤šè·¯è½¬æ¥å™¨ã€‚å®ƒä¼šå°†æ¯ä¸€ä¸ªæ¥æ”¶çš„è¯·æ±‚çš„URLä¸ä¸€ä¸ªæ³¨å†Œæ¨¡å¼çš„åˆ—è¡¨è¿›è¡ŒåŒ¹é…ï¼Œå¹¶è°ƒç”¨å’ŒURLæœ€åŒ¹é…çš„æ¨¡å¼çš„å¤„ç†å™¨ã€‚ mux := http.NewServeMux() mux.HandleFunc(&quot;/&quot;, defaultHttp) http.ListenAndServe(&quot;:8080&quot;, middlewareLimit(mux)) &#125; // é™æµæ¡¶ var limiter = rate.NewLimiter(rate.Every(time.Second), 1) func middlewareLimit(next http.Handler) http.Handler &#123; return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) &#123; if limiter.Allow() == false &#123; fmt.Println(&quot;limit&quot;) return &#125; next.ServeHTTP(w, r) &#125;) &#125; // é»˜è®¤httpå¤„ç† func defaultHttp(w http.ResponseWriter, r *http.Request) &#123; path := r.URL.Path if path == &quot;/&quot; &#123; w.Write([]byte(&quot;index&quot;)) fmt.Println(&quot;index&quot;) return &#125; // è‡ªå®šä¹‰404 http.Error(w, &quot;you lost???&quot;, http.StatusNotFound) &#125; è¿™é‡Œçš„ var limiter = rate.NewLimiter(rate.Every(2*time.Second), 1) å°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªé™æµå™¨ï¼Œç”Ÿæˆé€Ÿç‡æ˜¯1 ä¸ª/sï¼Œä»¤ç‰Œæ¡¶çš„å®¹é‡æ˜¯1ã€‚ä¹Ÿå°±æ˜¯æ¯ç§’æœ€å¤šèƒ½é€šè¿‡2ä¸ªè¯·æ±‚ã€‚ æˆ‘ä»¬å¯ä»¥ç”¨abæˆ–è€…å¿«é€Ÿåˆ·æ–°æµè§ˆå™¨æ¥çœ‹ä¸€ä¸‹æ•ˆæœ æ˜¯ä¸æ˜¯æœ‰ç‚¹ç±»ä¼¼nginxçš„é™æµæ¨¡å—ï¼š limit_req_zone $binary_remote_addr zone=one:10m rate=1r/s; server &#123; ... location / &#123; #ç¼“å­˜åŒºé˜Ÿåˆ—burst=5ä¸ª,nodelayè¡¨ç¤ºä¸å»¶æœŸ(è¶…è¿‡çš„è¯·æ±‚å¤±è´¥)ï¼Œå³æ¯ç§’æœ€å¤šå¯å¤„ç†rate+burstä¸ª,åŒæ—¶å¤„ç†rateä¸ªã€‚ limit_req zone=one burst=1 nodelay; &#125; &#125; ä¸Šé¢çš„ä»£ç æœ‰ä¸¤å¤„æ³¨æ„ç‚¹ï¼š middlewareLimit å¯çœ‹ä½œä¸€ä¸ªhttp serverçš„å‰ç½®ä¸­é—´ä»¶ï¼Œä½ å¯ä»¥ç±»æ¯”å»è‡ªå·±å¤„ç†å¤æ‚çš„httpä¸­é—´ä»¶ä¸šåŠ¡ã€‚ é™æµå™¨çš„åˆå§‹åŒ–åŠ¡å¿…åœ¨ä¸­é—´ä»¶å‰ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¿®æ”¹ä»£ç å†æµ‹è¯•: func middlewareLimit(next http.Handler) http.Handler &#123; return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) &#123; limiter := rate.NewLimiter(rate.Every(2*time.Second), 10) if limiter.Allow() == false &#123; fmt.Println(&quot;limit&quot;) return &#125; next.ServeHTTP(w, r) &#125;) &#125; æ­¤å¤–ï¼ŒLimiter ä¹Ÿæœ‰å…¶ä»–çš„æ–¹æ³•ï¼š SetLimit(Limit) åŠ¨æ€ä¿®æ”¹æ”¾å…¥ä»¤ç‰Œçš„é€Ÿç‡ SetBurst(int) åŠ¨æ€ä¿®æ”¹æ¡¶å¤§å° Wait/WaitN å½“æ²¡æœ‰å¯ç”¨äº‹ä»¶æ—¶ï¼Œå°†é˜»å¡ç­‰å¾… Reserve/ReserveN å½“æ²¡æœ‰å¯ç”¨äº‹ä»¶æ—¶ï¼Œè¿”å› Reservationï¼Œå’Œè¦ç­‰å¾…å¤šä¹…æ‰èƒ½è·å¾—è¶³å¤Ÿçš„äº‹ä»¶ ä»£ç ç‚¹å‡»è§githubgithub.com/13sai/go-example/tree/main/demo9-rate","categories":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"}],"tags":[{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"}]},{"title":"DockeråŸºç¡€ä¸å¸¸ç”¨å‘½ä»¤","slug":"DockeråŸºç¡€ä¸å¸¸ç”¨å‘½ä»¤","date":"2021-02-10T07:13:35.000Z","updated":"2022-03-19T14:35:21.573Z","comments":true,"path":"2021/02/10/312/","link":"","permalink":"https://github.13sai.com/2021/02/10/312/","excerpt":"","text":"Docker æ˜¯ä»€ä¹ˆï¼ŸDocker å±äº Linux å®¹å™¨çš„ä¸€ç§å°è£…ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ã€‚å®ƒæ˜¯ç›®å‰æœ€æµè¡Œçš„ Linux å®¹å™¨è§£å†³æ–¹æ¡ˆã€‚ Docker å°†åº”ç”¨ç¨‹åºä¸è¯¥ç¨‹åºçš„ä¾èµ–ï¼Œæ‰“åŒ…åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ã€‚è¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿå®¹å™¨ã€‚ç¨‹åºåœ¨è¿™ä¸ªè™šæ‹Ÿå®¹å™¨é‡Œè¿è¡Œï¼Œå°±å¥½åƒåœ¨çœŸå®çš„ç‰©ç†æœºä¸Šè¿è¡Œä¸€æ ·ã€‚æœ‰äº† Dockerï¼Œå°±ä¸ç”¨æ‹…å¿ƒç¯å¢ƒé—®é¢˜ã€‚ æ€»ä½“æ¥è¯´ï¼ŒDocker çš„æ¥å£ç›¸å½“ç®€å•ï¼Œç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œä½¿ç”¨å®¹å™¨ï¼ŒæŠŠè‡ªå·±çš„åº”ç”¨æ”¾å…¥å®¹å™¨ã€‚å®¹å™¨è¿˜å¯ä»¥è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€å¤åˆ¶ã€åˆ†äº«ã€ä¿®æ”¹ï¼Œå°±åƒç®¡ç†æ™®é€šçš„ä»£ç ä¸€æ ·ã€‚ Dockerçš„ä¸‰ä¸ªæ¦‚å¿µ é•œåƒï¼ˆImageï¼‰ï¼šç±»ä¼¼äºè™šæ‹Ÿæœºä¸­çš„é•œåƒï¼Œæ˜¯ä¸€ä¸ªåŒ…å«æœ‰æ–‡ä»¶ç³»ç»Ÿçš„é¢å‘Dockerå¼•æ“çš„åªè¯»æ¨¡æ¿ã€‚ä»»ä½•åº”ç”¨ç¨‹åºè¿è¡Œéƒ½éœ€è¦ç¯å¢ƒï¼Œè€Œé•œåƒå°±æ˜¯ç”¨æ¥æä¾›è¿™ç§è¿è¡Œç¯å¢ƒçš„ã€‚ä¾‹å¦‚ä¸€ä¸ªUbuntué•œåƒå°±æ˜¯ä¸€ä¸ªåŒ…å«Ubuntuæ“ä½œç³»ç»Ÿç¯å¢ƒçš„æ¨¡æ¿ï¼ŒåŒç†åœ¨è¯¥é•œåƒä¸Šè£…ä¸ŠApacheè½¯ä»¶ï¼Œå°±å¯ä»¥ç§°ä¸ºApacheé•œåƒã€‚ å®¹å™¨ï¼ˆContainerï¼‰ï¼šç±»ä¼¼äºä¸€ä¸ªè½»é‡çº§çš„æ²™ç›’ï¼Œå¯ä»¥å°†å…¶çœ‹ä½œä¸€ä¸ªæç®€çš„Linuxç³»ç»Ÿç¯å¢ƒï¼ˆåŒ…æ‹¬rootæƒé™ã€è¿›ç¨‹ç©ºé—´ã€ç”¨æˆ·ç©ºé—´å’Œç½‘ç»œç©ºé—´ç­‰ï¼‰ï¼Œä»¥åŠè¿è¡Œåœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºã€‚Dockerå¼•æ“åˆ©ç”¨å®¹å™¨æ¥è¿è¡Œã€éš”ç¦»å„ä¸ªåº”ç”¨ã€‚å®¹å™¨æ˜¯é•œåƒåˆ›å»ºçš„åº”ç”¨å®ä¾‹ï¼Œå¯ä»¥åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤å®¹å™¨ï¼Œå„ä¸ªå®¹å™¨ä¹‹é—´æ˜¯æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œäº’ä¸å½±å“ã€‚æ³¨æ„ï¼šé•œåƒæœ¬èº«æ˜¯åªè¯»çš„ï¼Œå®¹å™¨ä»é•œåƒå¯åŠ¨æ—¶ï¼ŒDockeråœ¨é•œåƒçš„ä¸Šå±‚åˆ›å»ºä¸€ä¸ªå¯å†™å±‚ï¼Œé•œåƒæœ¬èº«ä¸å˜ã€‚ ä»“åº“ï¼ˆRepositoryï¼‰ï¼šç±»ä¼¼äºä»£ç ä»“åº“ï¼Œè¿™é‡Œæ˜¯é•œåƒä»“åº“ï¼Œæ˜¯Dockerç”¨æ¥é›†ä¸­å­˜æ”¾é•œåƒæ–‡ä»¶çš„åœ°æ–¹ã€‚æ³¨æ„ä¸æ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰çš„åŒºåˆ«ï¼šæ³¨å†ŒæœåŠ¡å™¨æ˜¯å­˜æ”¾ä»“åº“çš„åœ°æ–¹ï¼Œä¸€èˆ¬ä¼šæœ‰å¤šä¸ªä»“åº“ï¼›è€Œä»“åº“æ˜¯å­˜æ”¾é•œåƒçš„åœ°æ–¹ï¼Œä¸€èˆ¬æ¯ä¸ªä»“åº“å­˜æ”¾ä¸€ç±»é•œåƒï¼Œæ¯ä¸ªé•œåƒåˆ©ç”¨tagè¿›è¡ŒåŒºåˆ†ï¼Œæ¯”å¦‚Ubuntuä»“åº“å­˜æ”¾æœ‰å¤šä¸ªç‰ˆæœ¬ï¼ˆ12.04ã€14.04ç­‰ï¼‰çš„Ubuntué•œåƒã€‚ Docker çš„ç”¨é€”Docker çš„ä¸»è¦ç”¨é€”ï¼Œç›®å‰æœ‰ä¸‰å¤§ç±»ã€‚ ï¼ˆ1ï¼‰æä¾›ä¸€æ¬¡æ€§çš„ç¯å¢ƒã€‚æ¯”å¦‚ï¼Œæœ¬åœ°æµ‹è¯•ä»–äººçš„è½¯ä»¶ã€æŒç»­é›†æˆçš„æ—¶å€™æä¾›å•å…ƒæµ‹è¯•å’Œæ„å»ºçš„ç¯å¢ƒã€‚ ï¼ˆ2ï¼‰æä¾›å¼¹æ€§çš„äº‘æœåŠ¡ã€‚å› ä¸º Docker å®¹å™¨å¯ä»¥éšå¼€éšå…³ï¼Œå¾ˆé€‚åˆåŠ¨æ€æ‰©å®¹å’Œç¼©å®¹ã€‚ ï¼ˆ3ï¼‰ç»„å»ºå¾®æœåŠ¡æ¶æ„ã€‚é€šè¿‡å¤šä¸ªå®¹å™¨ï¼Œä¸€å°æœºå™¨å¯ä»¥è·‘å¤šä¸ªæœåŠ¡ï¼Œå› æ­¤åœ¨æœ¬æœºå°±å¯ä»¥æ¨¡æ‹Ÿå‡ºå¾®æœåŠ¡æ¶æ„ã€‚ Dockerçš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹1. æ›´é«˜æ•ˆçš„åˆ©ç”¨ç³»ç»Ÿèµ„æº dockerå¯¹ç³»ç»Ÿèµ„æºçš„åˆ©ç”¨ç‡æ›´é«˜ï¼Œæ— è®ºæ˜¯åº”ç”¨æ‰§è¡Œé€Ÿåº¦ï¼Œå†…å­˜æŸè€—æˆ–è€…æ–‡ä»¶å­˜å‚¨é€Ÿåº¦ï¼Œéƒ½è¦æ¯”ä¼ ç»Ÿè™šæ‹ŸæœºæŠ€æœ¯æ›´é«˜æ•ˆã€‚å› æ­¤ï¼Œç›¸æ¯”è™šæ‹ŸæœºæŠ€æœ¯ï¼Œä¸€ä¸ªç›¸åŒé…ç½®çš„ä¸»æœºå¾€å¾€å¯ä»¥è¿è¡Œæ›´å¤šæ•°é‡çš„åº”ç”¨ã€‚ 2. æ›´å¿«é€Ÿçš„å¯åŠ¨æ—¶é—´ ä¼ ç»Ÿçš„è™šæ‹ŸæœºæŠ€æœ¯å¯åŠ¨åº”ç”¨æœåŠ¡å¾€å¾€éœ€è¦æ•°åˆ†é’Ÿï¼Œè€Œdockerå®¹å™¨åº”ç”¨ï¼Œç”±äºç›´æ¥è¿è¡Œäºå®¿ä¸»å†…æ ¸ï¼Œæ— éœ€å¯åŠ¨å®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œå› æ­¤å¯ä»¥åšåˆ°ç§’çº§ï¼Œç”šè‡³æ¯«ç§’çº§çš„å¯åŠ¨æ—¶é—´ï¼Œå¤§å¤§çš„èŠ‚çº¦äº†å¼€å‘æµ‹è¯•ï¼Œéƒ¨ç½²çš„æ—¶é—´ã€‚ 3. ä¸€è‡´çš„è¿è¡Œç¯å¢ƒ å¼€å‘è¿‡ç¨‹ä¸­å¸¸è§çš„ä¸€ä¸ªé—®é¢˜æ˜¯ç¯å¢ƒä¸€è‡´é—®é¢˜ï¼Œç”±äºå¼€å‘ç¯å¢ƒï¼Œæµ‹è¯•ç¯å¢ƒï¼Œç”Ÿäº§ç¯å¢ƒä¸ä¸€è‡´ï¼Œå¯¼è‡´æœ‰äº›bugå¹¶æœªåœ¨å¼€å‘è¿‡ç¨‹ä¸­å‘ç°ã€‚è€Œdockerçš„é•œåƒæä¾›äº†é™¤å†…æ ¸å¤–å®Œæ•´çš„è¿è¡Œæ—¶ç¯å¢ƒï¼Œç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§ï¼Œä»è€Œä¸ä¼šåœ¨å‡ºç°â€œè¿™æ®µä»£ç åœ¨æˆ‘æœºå™¨ä¸Šæ²¡é—®é¢˜â€è¿™ç±»é—®é¢˜ã€‚ 4. æŒç»­æ”¯ä»˜å’Œéƒ¨ç½² å¯¹å¼€å‘å’Œè¿ç»´äººå‘˜æ¥è¯´ï¼Œæœ€å¸Œæœ›å°±æ˜¯ä¸€æ¬¡åˆ›å»ºå’Œéƒ¨ç½²ï¼Œå¯ä»¥åœ¨ä»»æ„çš„åœ°æ–¹è¿è¡Œã€‚ï¼ˆå®šåˆ¶åº”ç”¨é•œåƒæ¥å®ç°é›†æˆã€æŒç»­æ”¯ä»˜ã€éƒ¨ç½²ã€‚å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡dockerfileæ¥è¿›è¡Œé•œåƒæ„å»ºï¼Œå¹¶ç»“åˆæŒç»­é›†æˆç³»ç»Ÿè¿›è¡Œé›†æˆæµ‹è¯•ï¼Œè€Œè¿ç»´äººå‘˜åˆ™å¯ä»¥ç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¿«é€Ÿéƒ¨ç½²è¯¥é•œåƒï¼Œç”šè‡³ç»“åˆæŒç»­éƒ¨ç½²ç³»ç»Ÿè¿›è¡Œè‡ªåŠ¨éƒ¨ç½²ï¼‰ã€‚è€Œä¸”ä½¿ç”¨dockerfileä½¿é•œåƒæ„å»ºé€æ˜åŒ–ï¼Œä¸ä»…ä»…å¼€å‘å›¢é˜Ÿå¯ä»¥ç†è§£åº”ç”¨è¿è¡Œç¯å¢ƒï¼Œä¹Ÿæ–¹ä¾¿è¿ç»´å›¢é˜Ÿç†è§£åº”ç”¨è¿è¡Œæ‰€éœ€æ¡ä»¶ï¼Œå¸®åŠ©æ›´å¥½çš„ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½²è¯¥é•œåƒã€‚ 5. æ›´è½»æ¾çš„è¿ç§» ç”±äºdockerç¡®ä¿äº†æ‰§è¡Œç¯å¢ƒçš„ä¸€è‡´æ€§ï¼Œä½¿å¾—åº”ç”¨çš„è¿ç§»æ›´åŠ çš„å®¹æ˜“ã€‚dockerå¯ä»¥åœ¨å¾ˆå¤šå¹³å°ä¸Šè¿è¡Œï¼Œæ— è®ºæ˜¯ç‰©ç†æœºã€è™šæ‹Ÿæœºã€å…¬æœ‰äº‘ã€ç§æœ‰äº‘ã€ç”šè‡³æ˜¯ç¬”è®°æœ¬ã€å…¶è¿è¡Œç»“æœæ˜¯ä¸€è‡´çš„ã€‚å› æ­¤ç”¨æˆ·å¯ä»¥å¾ˆè½»æ˜“çš„å°†åœ¨ä¸€ä¸ªå¹³å°ä¸Šè¿è¡Œçš„åº”ç”¨ï¼Œè¿ç§»åˆ°å¦ä¸€ä¸ªå¹³å°ä¸Šï¼Œè€Œä¸ç”¨æ‹…å¿ƒè¿è¡Œç¯å¢ƒçš„å˜åŒ–å¯¼è‡´åº”ç”¨æ— æ³•æ­£å¸¸è¿è¡Œçš„æƒ…å†µã€‚ 6. æ›´è½»æ¾çš„ç»´æŠ¤å’Œæ‹“å±• dockerä½¿ç”¨çš„åˆ†å±‚å­˜å‚¨ä»¥åŠé•œåƒçš„æŠ€æœ¯ï¼Œä½¿å¾—åº”ç”¨é‡å¤éƒ¨åˆ†çš„å¤ç”¨æ›´ä¸ºå®¹æ˜“ï¼Œä¹Ÿä½¿å¾—åº”ç”¨çš„ç»´æŠ¤æ›´æ–°æ›´åŠ ç®€å•ï¼ŒåŸºäºåŸºç¡€é•œåƒè¿›ä¸€æ­¥æ‰©å±•é•œåƒä¹Ÿå˜å¾—ååˆ†ç®€å•ã€‚æ­¤å¤–ï¼Œdockerå›¢é˜ŸåŒå„ä¸ªå¼€æºé¡¹ç›®å›¢é˜Ÿä¸€èµ·ç»´æŠ¤äº†ä¸€å¤§æ‰¹é«˜è´¨é‡çš„å®˜ç½‘é•œåƒï¼Œæ—¢å¯ä»¥ç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œåˆå¯ä»¥ä½œä¸ºåŸºç¡€è¿›ä¸€æ­¥å®šåˆ¶ï¼Œå¤§å¤§çš„é™ä½äº†åº”ç”¨æœåŠ¡çš„é•œåƒåˆ¶ä½œæˆæœ¬ã€‚ ç¼ºç‚¹1.éš”ç¦»æ€§ åŸºäºhypervisorçš„è™šæ‹ŸæŠ€æœ¯ï¼Œåœ¨éš”ç¦»æ€§ä¸Šæ¯”å®¹å™¨æŠ€æœ¯è¦å¥½ï¼Œå®ƒä»¬çš„ç³»ç»Ÿç¡¬ä»¶èµ„æºå®Œå…¨ä¸Šè™šæ‹ŸåŒ–çš„ï¼Œå½“ä¸€å°è™šæ‹Ÿæœºå‡ºç°ç³»ç»Ÿçº§åˆ«çš„é—®é¢˜ï¼Œå¾€å¾€ä¸ä¼šè”“å»¶åˆ°åŒä¸€å®¿ä¸»æœºä¸Šçš„å…¶å®ƒè™šæ‹Ÿæœºä¸Šï¼Œä½†æ˜¯å®¹å™¨å°±ä¸ä¸€æ ·äº†ï¼Œå®¹å™¨ä¹‹é—´å…±äº«åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸åŠå…¶å®ƒç»„ä»¶ï¼Œæ‰€ä»¥åœ¨å—åˆ°è¯¸å¦‚é»‘å®¢æ”»å‡»è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼Œå¾ˆå®¹æ˜“é€šè¿‡åº•å±‚æ“ä½œç³»ç»Ÿå½±å“çš„å…¶å®ƒå®¹å™¨ï¼Œç”šè‡³é€ä¸ªå‡»ç ´ï¼Œäº§ç”Ÿè¿é”ååº”ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡éƒ¨ç½²å®¹å™¨æ¥è§£å†³ï¼Œä½†éšä¹‹åˆä¼šäº§ç”Ÿæ–°çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆæœ¬å¢åŠ ä»¥åŠæ€§èƒ½é—®é¢˜ã€‚ 2.æ€§èƒ½ ä¸ç®¡æ˜¯è™šæ‹Ÿæœºè¿˜æ˜¯å®¹å™¨ï¼Œéƒ½æ˜¯è¿ç”¨ä¸åŒçš„æŠ€æœ¯å¯¹åº”ç”¨æœ¬èº«è¿›è¡Œäº†ä¸€å®šç¨‹åº¦çš„å°è£…ä¸éš”ç¦»ï¼Œåœ¨é™ä½åº”ç”¨å’Œåº”ç”¨ä¹‹é—´ä»¥åŠåº”ç”¨å’Œç¯å¢ƒä¹‹é—´çš„è€¦åˆæ€§ä¸Šåšäº†å¾ˆå¤šåŠªåŠ›ï¼Œä½†æ˜¯éšä¹‹è€Œæ¥çš„ï¼Œå°±ä¼šäº§ç”Ÿæ›´è¿‡çš„ç½‘ç»œè¿æ¥è½¬å‘å’Œæ•°æ®äº¤äº’ï¼Œè¿™åœ¨ä½å¹¶å‘ç³»ç»Ÿä¸Šè™½ç„¶ä¸ä¼šå¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯å½“åŒä¸€è™šæ‹Ÿæœºæˆ–è€…æœåŠ¡å™¨ä¸‹é¢çš„å®¹å™¨éœ€è¦æ›´é«˜å¹¶å‘é‡æ”¯æ’‘çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘é—®é¢˜æˆä¸ºç³»ç»Ÿç“¶é¢ˆçš„æ—¶å€™ï¼Œå®¹å™¨ä¼šå°†è¿™ä¸ªé—®é¢˜æ”¾å¤§ï¼Œæ‰€ä»¥ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„åœºæ™¯éƒ½é€‚åˆå®¹å™¨æŠ€æœ¯ã€‚ 3.å­˜å‚¨æ–¹æ¡ˆ å®¹å™¨çš„è¯ç”Ÿå¹¶ä¸æ˜¯ä¸ºOSæŠ½è±¡æœåŠ¡çš„ï¼Œè¿™æ˜¯å®ƒå’Œè™šæ‹Ÿæœºæœ€å¤§çš„åŒºåˆ«ï¼Œè¿™æ ·çš„åŸºå› æ„å‘³ç€å®¹å™¨å¤©ç”Ÿæ˜¯ä¸ºåº”ç”¨ç¯å¢ƒåšæ›´å¤šçš„åŠªåŠ›ï¼Œå®¹å™¨çš„ä¼¸ç¼©ä¹Ÿæ˜¯åŸºäºå®¹å™¨çš„è¿™ä¸€ç‰¹æ€§ï¼Œè€Œä¸ä¹‹ç›¸å¯¹çš„ï¼Œéœ€è¦æŒä¹…åŒ–å­˜å‚¨æ–¹æ¡ˆæ°æ°ç›¸åï¼Œåœ¨æ•°æ®å­˜å‚¨è¿™ä¸€ç‚¹ä¸ŠDockerå®¹å™¨æä¾›çš„è§£å†³æ–¹æ¡ˆæ˜¯åˆ©ç”¨volumeæ¥å£(å­˜å‚¨å·)å½¢æˆæ•°æ®çš„æ˜ å°„å’Œè½¬ç§»ï¼Œä»¥å®ç°æ•°æ®æŒä¹…åŒ–çš„ç›®çš„ã€‚ä½†æ˜¯è¿™æ ·åŒæ ·ä¹Ÿä¼šé€ æˆä¸€éƒ¨åˆ†èµ„æºçš„æµªè´¹å’Œæ›´å¤šçš„äº¤äº’ï¼Œä¸ç®¡æ˜¯æ˜ å°„åˆ°å®¿ä¸»æœºä¸Šè¿˜æ˜¯ç½‘ç»œç£ç›˜ï¼Œéƒ½æ˜¯é€€è€Œæ±‚å…¶æ¬¡çš„è§£å†³æ–¹æ¡ˆã€‚ åŸºç¡€å‘½ä»¤ å¯åŠ¨ docker start å®¹å™¨å åˆ é™¤ docker rm å®¹å™¨å åœæ­¢æ‰€æœ‰å®¹å™¨ docker stop $(docker ps -a -q) åˆ é™¤æ‰€æœ‰å®¹å™¨ docker rm $(docker ps -a -q) å®¹å™¨æ„å»ºé•œåƒ Usage:docker build [OPTIONS] PATH | URL | - OPTIONS: -t ï¼Œ--tag list #æ„å»ºåçš„é•œåƒåç§° -fï¼Œ --file string #æŒ‡å®šDockerfiileæ–‡ä»¶ä½ç½® ç¤ºä¾‹: - 1ï¼Œdocker build . - 2ï¼Œdocker build -t redis:v1 . - 3ï¼Œdocker build -t redis:v2 -f /path/Dockerfile /path ä¸€èˆ¬å¸¸ç”¨ç¬¬2ç§æ–¹å¼æ„å»ºï¼Œæˆ‘ä»¬åœ¨æ„å»ºæ—¶éƒ½ä¼šåˆ‡æ¢åˆ°Dockerfileæ–‡ä»¶çš„ç›®å½•ä¸‹è¿›è¡Œæ„å»ºï¼Œæ‰€ä»¥ä¸éœ€è¦æŒ‡å®š-få‚æ•° è¿›å…¥å®¹å™¨ï¼ˆæœªå¿…ä¸€å®šæ˜¯bashå‘½ä»¤ï¼‰ docker exec -it å®¹å™¨å bash æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯ docker inspect å®¹å™¨å æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿— docker logs å®¹å™¨å æŸ¥çœ‹æœ¬åœ°é•œåƒ docker images docker ç½‘ç»œ å‘½ä»¤ è¯´æ˜ docker network connect å°†å®¹å™¨è¿æ¥åˆ°ç½‘ç»œã€‚ docker network create åˆ›å»ºæ–°çš„ Docker ç½‘ç»œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨ Windows ä¸Šä¼šé‡‡ç”¨ NAT é©±åŠ¨ï¼Œåœ¨ Linux ä¸Šä¼šé‡‡ç”¨ Bridge é©±åŠ¨ã€‚å¯ä»¥ä½¿ç”¨ -d å‚æ•°æŒ‡å®šé©±åŠ¨ï¼ˆç½‘ç»œç±»å‹ï¼‰ã€‚ docker network disconnect æ–­å¼€å®¹å™¨çš„ç½‘ç»œã€‚ docker network inspect æä¾› Docker ç½‘ç»œçš„è¯¦ç»†é…ç½®ä¿¡æ¯ã€‚ docker network ls ç”¨äºåˆ—å‡ºè¿è¡Œåœ¨æœ¬åœ° Docker ä¸»æœºä¸Šçš„å…¨éƒ¨ç½‘ç»œã€‚ docker network prune åˆ é™¤ Docker ä¸»æœºä¸Šå…¨éƒ¨æœªä½¿ç”¨çš„ç½‘ç»œã€‚ docker network rm åˆ é™¤ Docker ä¸»æœºä¸ŠæŒ‡å®šç½‘ç»œã€‚ é•œåƒçš„ä¿å­˜ docker save ae513a47849c &gt; nginx-save.tar or docker save -o nginx-save.tar ae513a47849c é•œåƒçš„å¯¼å…¥ docker load &lt; nginx-save.tar or docker load -i nginx-save.tar å®¹å™¨çš„å¯¼å‡º docker export -o mysql-`date +%Y%m%d`.tar 220aee82cfea å®¹å™¨çš„å¯¼å…¥ docker import my_ubuntu_v3.tar runoob/ubuntu:v4 é•œåƒå’Œå®¹å™¨å¯¼å‡ºå’Œå¯¼å…¥çš„åŒºåˆ«: 1.é•œåƒå¯¼å…¥æ˜¯å¤åˆ¶çš„è¿‡ç¨‹2.å®¹å™¨å¯¼å…¥æ˜¯å°†å½“å‰å®¹å™¨å˜æˆä¸€ä¸ªæ–°çš„é•œåƒ save å’Œ exportåŒºåˆ«ï¼š save ä¿å­˜é•œåƒæ‰€æœ‰çš„ä¿¡æ¯-åŒ…å«å†å² export åªå¯¼å‡ºå½“å‰çš„ä¿¡æ¯","categories":[{"name":"Docker","slug":"Docker","permalink":"https://github.13sai.com/categories/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://github.13sai.com/tags/Docker/"}]},{"title":"sync.Map","slug":"sync.Map","date":"2021-02-06T12:31:36.000Z","updated":"2022-03-19T15:22:02.755Z","comments":true,"path":"2021/02/06/syncMap/","link":"","permalink":"https://github.13sai.com/2021/02/06/syncMap/","excerpt":"","text":"sync.Map æ˜¯1.9ç‰ˆæœ¬æ‰åŠ å…¥çš„ï¼Œæ˜¯çº¿ç¨‹å¹¶å‘å®‰å…¨çš„mapï¼Œç±»å‹å¯ä»¥çœ‹åšmap[interface{}]interface{}ã€‚ ç»“æ„Map type Map struct &#123; mu Mutex //äº’æ–¥é”ï¼Œç”¨äºé”å®šdirty map read atomic.Value //ä¼˜å…ˆè¯»map,æ”¯æŒåŸå­æ“ä½œï¼Œæºç æ³¨é‡Šå†™äº†readOnlyä¸æ˜¯è¯´readæ˜¯åªè¯»ï¼Œè€Œæ˜¯å®ƒçš„ç»“æ„ä½“æ˜¯readOnly dirty map[interface&#123;&#125;]*entry // dirtyæ˜¯ä¸€ä¸ªå½“å‰æœ€æ–°çš„mapï¼Œå…è®¸è¯»å†™ misses int // ä¸»è¦è®°å½•readè¯»å–ä¸åˆ°æ•°æ®åŠ é”è¯»å–read mapä»¥åŠdirty mapçš„æ¬¡æ•°ï¼Œå½“missesç­‰äºdirtyçš„é•¿åº¦æ—¶ï¼Œä¼šå°†dirtyå¤åˆ¶åˆ°read &#125; readOnly type readOnly struct &#123; m map[interface&#123;&#125;]*entry amended bool // å¦‚æœæ•°æ®åœ¨dirtyä¸­ä½†æ²¡æœ‰åœ¨readä¸­ï¼Œè¯¥å€¼ä¸ºtrue,ä½œä¸ºä¿®æ”¹æ ‡è¯† &#125; entry type entry struct &#123; // nil: è¡¨ç¤ºä¸ºè¢«åˆ é™¤ï¼Œè°ƒç”¨Delete()å¯ä»¥å°†read mapä¸­çš„å…ƒç´ ç½®ä¸ºnil // expunged: ä¹Ÿæ˜¯è¡¨ç¤ºè¢«åˆ é™¤ï¼Œä½†æ˜¯è¯¥é”®åªåœ¨readè€Œæ²¡æœ‰åœ¨dirtyä¸­ï¼Œè¿™ç§æƒ…å†µå‡ºç°åœ¨å°†readå¤åˆ¶åˆ°dirtyä¸­ï¼Œå³å¤åˆ¶çš„è¿‡ç¨‹ä¼šå…ˆå°†nilæ ‡è®°ä¸ºexpungedï¼Œç„¶åä¸å°†å…¶å¤åˆ¶åˆ°dirty // å…¶ä»–: è¡¨ç¤ºå­˜ç€çœŸæ­£çš„æ•°æ® p unsafe.Pointer // *interface&#123;&#125; &#125; Load æŸ¥æ‰¾æ ¹æ®keyæ¥æŸ¥æ‰¾ valueï¼Œ å‡½æ•°ä¸º Load()ï¼Œæºç å¦‚ä¸‹ï¼š func (m *Map) Load(key interface&#123;&#125;) (value interface&#123;&#125;, ok bool) &#123; // é¦–å…ˆä»åªè¯»readyçš„mapä¸­æŸ¥æ‰¾ï¼Œè¿™æ—¶ä¸éœ€è¦åŠ é” read, _ := m.read.Load().(readOnly) e, ok := read.m[key] // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå¹¶ä¸”read.amendedä¸ºtrueï¼Œè¯´æ˜dirtyä¸­æœ‰æ–°æ•°æ®ï¼Œä»dirtyä¸­æŸ¥æ‰¾ï¼Œå¼€å§‹åŠ é”äº† if !ok &amp;&amp; read.amended &#123; m.mu.Lock() // åŠ é” // åˆåœ¨ readonly ä¸­æ£€æŸ¥ä¸€éï¼Œå› ä¸ºåœ¨åŠ é”çš„æ—¶å€™ dirty çš„æ•°æ®å¯èƒ½å·²ç»è¿ç§»åˆ°äº†readä¸­ read, _ = m.read.Load().(readOnly) e, ok = read.m[key] // read è¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œå¹¶ä¸”dirtyä¸­æœ‰æ•°æ® if !ok &amp;&amp; read.amended &#123; e, ok = m.dirty[key] //ä» dirty ä¸­æŸ¥æ‰¾æ•°æ® // ä¸ç®¡m.dirtyä¸­å­˜ä¸å­˜åœ¨ï¼Œéƒ½å°†misses + 1 // missLocked() ä¸­æ»¡è¶³æ¡ä»¶åå°±ä¼šæŠŠm.dirtyä¸­æ•°æ®è¿ç§»åˆ°m.readä¸­ m.missLocked() &#125; m.mu.Unlock() &#125; if !ok &#123; return nil, false &#125; return e.load() &#125; ä»å‡½æ•°å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæŸ¥è¯¢çš„é”®å€¼æ­£å¥½åœ¨m.readä¸­ï¼Œä¸éœ€è¦åŠ é”ï¼Œç›´æ¥è¿”å›ç»“æœï¼Œä¼˜åŒ–äº†æ€§èƒ½ã€‚ å³ä½¿ä¸åœ¨readä¸­ï¼Œç»è¿‡å‡ æ¬¡missåï¼Œ m.dirtyä¸­çš„æ•°æ®ä¹Ÿä¼šè¿ç§»åˆ°m.readä¸­ï¼Œè¿™æ—¶åˆå¯ä»¥ä»readä¸­æŸ¥æ‰¾ã€‚æ‰€ä»¥å¯¹äºæ›´æ–°ï¼å¢åŠ è¾ƒå°‘ï¼ŒåŠ è½½å­˜åœ¨çš„keyå¾ˆå¤šçš„caseï¼Œæ€§èƒ½åŸºæœ¬å’Œæ— é”çš„mapç±»ä¼¼ã€‚ missLockerd è¿ç§»æ•°æ® func (m *Map) missLocked() &#123; m.misses++ if m.misses &lt; len(m.dirty) &#123;//missesæ¬¡æ•°å°äº dirtyçš„é•¿åº¦ï¼Œå°±ä¸è¿ç§»æ•°æ®ï¼Œç›´æ¥è¿”å› return &#125; m.read.Store(readOnly&#123;m: m.dirty&#125;) //å¼€å§‹è¿ç§»æ•°æ® m.dirty = nil //è¿ç§»å®Œdirtyå°±èµ‹å€¼ä¸ºnil m.misses = 0 //è¿ç§»å®Œ misseså½’0 &#125; Store å­˜å‚¨func (m *Map) Store(key, value interface&#123;&#125;) &#123; // ç›´æ¥åœ¨readä¸­æŸ¥æ‰¾å€¼ï¼Œæ‰¾åˆ°äº†ï¼Œå°±å°è¯• tryStore() æ›´æ–°å€¼ read, _ := m.read.Load().(readOnly) if e, ok := read.m[key]; ok &amp;&amp; e.tryStore(&amp;value) &#123; return &#125; // m.read ä¸­ä¸å­˜åœ¨ m.mu.Lock() read, _ = m.read.Load().(readOnly) if e, ok := read.m[key]; ok &#123; if e.unexpungeLocked() &#123; // æœªè¢«æ ‡è®°æˆåˆ é™¤ï¼Œå‰é¢è®²åˆ°entryæ•°æ®ç»“æ„æ—¶ï¼Œé‡Œé¢çš„på€¼æœ‰3ç§ã€‚1.nil 2.expungedï¼Œè¿™ä¸ªå€¼å«ä¹‰æœ‰ç‚¹å¤æ‚ï¼Œå¯ä»¥çœ‹çœ‹å‰é¢entryæ•°æ®ç»“æ„ 3.æ­£å¸¸å€¼ m.dirty[key] = e // åŠ å…¥åˆ°dirtyé‡Œ &#125; e.storeLocked(&amp;value) // æ›´æ–°å€¼ &#125; else if e, ok := m.dirty[key]; ok &#123; // å­˜åœ¨äº dirty ä¸­ï¼Œç›´æ¥æ›´æ–° e.storeLocked(&amp;value) &#125; else &#123; // æ–°çš„å€¼ if !read.amended &#123; // m.dirty ä¸­æ²¡æœ‰æ–°æ•°æ®ï¼Œå¢åŠ åˆ° m.dirty ä¸­ // We&#x27;re adding the first new key to the dirty map. // Make sure it is allocated and mark the read-only map as incomplete. m.dirtyLocked() // ä» m.readä¸­å¤åˆ¶æœªåˆ é™¤çš„æ•°æ® m.read.Store(readOnly&#123;m: read.m, amended: true&#125;) &#125; m.dirty[key] = newEntry(value) //å°†è¿™ä¸ªentryåŠ å…¥åˆ°m.dirtyä¸­ &#125; m.mu.Unlock() &#125; æ“ä½œéƒ½æ˜¯å…ˆä»m.readå¼€å§‹ï¼Œä¸æ»¡è¶³æ¡ä»¶å†åŠ é”ï¼Œç„¶åæ“ä½œm.dirtyã€‚ Delete åˆ é™¤func (m *Map) Delete(key interface&#123;&#125;) &#123; // ä» m.read ä¸­å¼€å§‹æŸ¥æ‰¾ read, _ := m.read.Load().(readOnly) e, ok := read.m[key] if !ok &amp;&amp; read.amended &#123; // m.readä¸­æ²¡æœ‰æ‰¾åˆ°ï¼Œå¹¶ä¸”å¯èƒ½å­˜åœ¨äºm.dirtyä¸­ï¼ŒåŠ é”æŸ¥æ‰¾ m.mu.Lock() // åŠ é” read, _ = m.read.Load().(readOnly) // å†åœ¨m.readä¸­æŸ¥æ‰¾ä¸€æ¬¡ e, ok = read.m[key] if !ok &amp;&amp; read.amended &#123; //m.readä¸­åˆæ²¡æ‰¾åˆ°ï¼Œamendedæ ‡å¿—ä½trueï¼Œè¯´æ˜åœ¨m.dirtyä¸­ delete(m.dirty, key) // åˆ é™¤ &#125; m.mu.Unlock() &#125; if ok &#123; // åœ¨ m.ready ä¸­å°±ç›´æ¥åˆ é™¤ e.delete() &#125; &#125; ä½¿ç”¨package main import ( &quot;fmt&quot; &quot;sync&quot; ) func main() &#123; var sm sync.Map sm.Store(&quot;www&quot;, &quot;2343125&quot;) sm.Store(&quot;test&quot;, 111) var v interface&#123;&#125; v, _ = sm.Load(&quot;www&quot;) fmt.Printf(&quot;%T&quot;, v) sm.Delete(&quot;test&quot;) v, _ = sm.Load(&quot;test&quot;) fmt.Printf(&quot;%T&quot;, v) &#125; // string&lt;nil&gt; å‚è€ƒï¼š sync.Mapæºç  sync.Mapæºç åˆ†æ æ·±å…¥ç†è§£Goè¯­è¨€(05)ï¼šsync.mapåŸç†åˆ†æ","categories":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/categories/gosourcecode/"}],"tags":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/tags/gosourcecode/"}]},{"title":"sync.Once","slug":"sync.Once","date":"2021-02-06T12:31:36.000Z","updated":"2022-03-30T11:30:18.452Z","comments":true,"path":"2021/02/06/syncOnce/","link":"","permalink":"https://github.13sai.com/2021/02/06/syncOnce/","excerpt":"","text":"sync.Onceçš„æºç ååˆ†ç®€å•ï¼Œè€Œä¸”æ³¨é‡Šååˆ†æ¸…æ¥šï¼Œç›´æ¥æ¥çœ‹ä¸€ä¸‹ã€‚ æºç å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“Once type Once struct &#123; done uint32 // æ˜¯å¦æ‰§è¡Œè¿‡ï¼Œåˆå§‹å€¼ä¸º0 m Mutex // é” &#125; å¯¹å¤–æä¾›äº†ä¸€ä¸ªæ–¹æ³•Doï¼ŒOnce.Doå¯ä»¥ç†è§£æˆèµ„æºåˆå§‹åŒ–ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ func (o *Once) Do(f func()) &#123; // è¿™é‡Œä¿è¯åŸå­æ€§çš„è¯»å–o.doneï¼Œå¦‚æœæœªæ‰§è¡Œ0ï¼Œè°ƒç”¨doSlow if atomic.LoadUint32(&amp;o.done) == 0 &#123; // Outlined slow-path to allow inlining of the fast-path. o.doSlow(f) &#125; &#125; func (o *Once) doSlow(f func()) &#123; o.m.Lock() // é”ä½ defer o.m.Unlock() // æœ€åé‡Šæ”¾é” // å¦‚æœæœªæ‰§è¡Œè¿‡fï¼Œå°±æ‰§è¡Œfï¼Œå¹¶ä¿®æ”¹o.doneä¸º1 // è¿™é‡Œå·²ç»åŠ é”äº†ï¼Œä¿è¯äº†åŸå­æ€§ï¼Œä¸éœ€è¦ä½¿ç”¨atomic.LoadUint32 if o.done == 0 &#123; defer atomic.StoreUint32(&amp;o.done, 1) f() &#125; &#125; å¦‚æœä½ ç†Ÿæ‚‰atomicï¼Œè¿™é‡Œä½ å¯èƒ½ä¼šæœ‰ä¸ªç–‘é—®ï¼ŒDoæ–¹æ³•é‡Œé¢ä¸ºä½•ä¸ç›´æ¥ä½¿ç”¨casåŸå­æ“ä½œå‘¢ï¼Œé‚£å¤šç®€æ´ï¼Ÿ if atomic.CompareAndSwapUint32(&amp;o.done, 0, 1) &#123; f() &#125; å…¶å®æºç æ³¨é‡Šé‡Œå·²ç»æœ‰äº†è¯´æ˜ï¼Œè¿™æ ·çš„å®ç°å¹¶ä¸åˆç†ã€‚ å½“ä½ æœ‰2ä¸ªå¹¶å‘è¯·æ±‚è°ƒç”¨Doï¼Œè¿™æ ·çš„å®ç°ç¡®å®èƒ½ä¿è¯åªä¼šè°ƒç”¨ä¸€æ¬¡fã€‚ä½†æ˜¯ï¼Œå‡å¦‚fçš„æ‰§è¡Œéœ€è¦ä¸€æ®µæ—¶é—´ï¼Œæ¯”å¦‚åˆå§‹åŒ–æ•°æ®åº“è¿æ¥æ± ï¼Œå½“fæ‰§è¡Œå°šæœªå®Œæˆï¼Œå¹¶å‘ä¸­å¦ä¸€ä¸ªè¯·æ±‚å› ä¸ºæ²¡æœ‰æ‰§è¡ŒåŸå­æ“ä½œç›´æ¥è¿”å›äº†ï¼Œä½¿ç”¨fä¸­åˆå§‹åŒ–çš„è¿æ¥æ± å°±å¿…ç„¶ä¼šå¤±è´¥ï¼Œé‚£ä¹ˆè¿™æ ·çš„å®ç°æ˜¾ç„¶æ˜¯ä¸å¯å–çš„ã€‚ æ‰€ä»¥å¿…é¡»ç¡®ä¿fæ‰§è¡Œå®Œæˆä¹‹åï¼Œæ‰èƒ½å°†doneç½®ä¸º1ã€‚ ä½¿ç”¨var one sync.Once fun1 := func() &#123; fmt.Println(&quot;do one&quot;) &#125; fun2 := func() &#123; fmt.Println(&quot;do two&quot;) &#125; one.Do(fun1) one.Do(fun2) output: do one å¯ä»¥çœ‹åˆ°åªæ‰§è¡Œäº†ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯fun1ã€‚ å…¶å®onceå¾ˆé€‚åˆåº”ç”¨åˆ°å•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚è¿æ¥æ•°æ®åº“ï¼Œ package db import ( &quot;github.com/jinzhu/gorm&quot; _ &quot;github.com/jinzhu/gorm/dialects/mysql&quot; &quot;github.com/spf13/viper&quot; ) var once sync.Once var db *gorm.DB // å•ä¾‹æ¨¡å¼è·å–*gorm.DB func GetDB() *gorm.DB &#123; once.Do(func() &#123; db = openPool() &#125;) return db &#125; func openPool() *gorm.DB &#123; ... &#125; å¥½äº†ï¼ŒOnceæ˜¯å¾ˆå¸¸ç”¨çš„ï¼Œä¹Ÿå¾ˆé€‚åˆå•ä¾‹æ¨¡å¼ä½¿ç”¨ï¼Œæºç ç®€å•æ˜äº†ï¼Œä»¥ååœ¨é¡¹ç›®ä¸­å¤šå¤šä½¿ç”¨å§ï¼","categories":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/categories/gosourcecode/"}],"tags":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/tags/gosourcecode/"}]},{"title":"vueå­ç»„ä»¶","slug":"vueå­ç»„ä»¶","date":"2021-01-26T02:14:53.000Z","updated":"2022-03-19T14:35:21.821Z","comments":true,"path":"2021/01/26/305/","link":"","permalink":"https://github.13sai.com/2021/01/26/305/","excerpt":"","text":"å…ˆæ¥çœ‹demo: çˆ¶ç»„ä»¶ï¼š &lt;template&gt; &lt;div class=&quot;app-container calendar-list-container&quot;&gt; &lt;el-tabs v-model=&quot;activeName&quot; type=&quot;card&quot;&gt; &lt;el-tab-pane label=&quot;å¾…å®¡æ ¸&quot; name=&quot;first&quot;&gt; &lt;test-page status=&quot;1&quot; @toP=&quot;funct&quot;&gt;&lt;/test-page&gt; &lt;/el-tab-pane&gt; &lt;el-tab-pane label=&quot;å…¨éƒ¨&quot; name=&quot;second&quot;&gt; &lt;test-page status=&quot;0&quot;&gt;&lt;/test-page&gt; &lt;/el-tab-pane&gt; &lt;/el-tabs&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; import TestPage from &#x27;@/views/components/TestPage&#x27; export default &#123; components: &#123; TestPage &#125;, name: &quot;test&quot;, data() &#123; return &#123; activeName: &#x27;first&#x27;, &#125;; &#125;, methods: &#123; funct(v) &#123; console.warn(v) &#125; &#125; &#125;; &lt;/script&gt; å­ç»„ä»¶ &lt;template&gt; &lt;div&gt; &lt;el-table key=&quot;tableList&quot; v-loading=&quot;listLoading&quot; :data=&quot;list&quot; element-loading-text=&quot;ç»™æˆ‘ä¸€ç‚¹æ—¶é—´&quot; border fit highlight-current-row style=&quot;width: 100%&quot; &gt; &lt;el-table-column align=&quot;center&quot; label=&quot;id&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;span&gt;&#123;&#123; scope.row.id &#125;&#125;&lt;/span&gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column align=&quot;center&quot; label=&quot;åœ°ç‚¹&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;span&gt;&#123;&#123; scope.row.address &#125;&#125;&lt;/span&gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column align=&quot;center&quot; label=&quot;çŠ¶æ€&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;el-tag type=&quot;info&quot; v-if=&quot;scope.row.status == 0&quot;&gt;å·²æ‹’ç»&lt;/el-tag&gt; &lt;el-tag v-if=&quot;scope.row.status == 1&quot;&gt;å®¡æ ¸ä¸­&lt;/el-tag&gt; &lt;el-tag type=&quot;success&quot; v-if=&quot;scope.row.status == 2&quot;&gt;å·²é€šè¿‡&lt;/el-tag&gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column align=&quot;center&quot; label=&quot;æ´»åŠ¨æ—¶é—´&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;span&gt;&#123;&#123; scope.row.start_date &#125;&#125;&lt;/span&gt;&lt;br&gt;è‡³ &lt;span&gt;&#123;&#123; scope.row.end_date &#125;&#125;&lt;/span&gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;/el-table&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; ... export default &#123; name: &quot;TestPage&quot;, props: [&#x27;status&#x27;], data() &#123; return &#123; list: [], pagination: &quot;&quot;, listQuery: &#123; page: 1, limit: 20, status: 1, type:&#x27;&#x27;, &#125;, typeList: [], dialogFormVisible: false, temp: &#123; image : &#x27;&#x27;, user: &#123; nickname: &#x27;&#x27;, &#125;, college: &#123; name: &quot;&quot;, &#125;, materials: [], &#125;, &#125;; &#125;, created() &#123; this.listQuery.status = this.$props.status; this.getList(); this.$emit(&#x27;toP&#x27;, this.listQuery) &#125;, methods: &#123; ... &#125; &#125;; &lt;/script&gt; &lt;style&gt; .row-container .el-row &#123; margin-bottom: 20px; &amp;:last-child &#123; margin-bottom: 0; &#125; &#125; &lt;/style&gt; è¿™ä¸ªdemoç®€å•ä½¿ç”¨äº†ç»„ä»¶å¼•å…¥ï¼ŒåŠå­ç»„ä»¶äºçˆ¶ç»„ä»¶é€šä¿¡ã€‚ å¼•å…¥å­ç»„ä»¶import TestPage from &#x27;@/views/components/TestPage&#x27; export default &#123; components: &#123; TestPage &#125;, ä½¿ç”¨: &lt;test-page&gt;&lt;/test-page&gt; çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®åˆ°å­ç»„ä»¶çˆ¶ç»„ä»¶çš„statuså°±æ˜¯ä¼ é€’çš„æ•°æ® &lt;test-page status=&quot;0&quot;&gt;&lt;/test-page&gt; å­ç»„ä»¶æ¥æ”¶ï¼š this.$props.status å­ç»„ä»¶ä¼ é€’æ•°æ®åˆ°çˆ¶ç»„ä»¶å­ç»„ä»¶ï¼Œå…¶å®æ˜¯ä¼ é€’äº†ä¸€ä¸ªtoPäº‹ä»¶ this.$emit(&#x27;toP&#x27;, this.listQuery) çˆ¶ç»„ä»¶ &lt;test-page @toP=&quot;funct&quot;&gt;&lt;/test-page&gt; ... methods: &#123; funct(v) &#123; console.warn(v) &#125; &#125; è¿™é‡Œéœ€è¦ç¨å¾®æ³¨æ„çš„å°±æ˜¯é©¼å³°å‘½åè½¬**-**ï¼Œä½¿ç”¨ç›¸å¯¹ç®€å•ã€‚","categories":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/categories/js/"}],"tags":[{"name":"vue","slug":"vue","permalink":"https://github.13sai.com/tags/vue/"}]},{"title":"ç½‘ç«™ä¸èƒ½è®¿é—®çš„é—®é¢˜é›†åˆ","slug":"ç½‘ç«™ä¸èƒ½è®¿é—®çš„é—®é¢˜é›†åˆ","date":"2021-01-13T03:43:22.000Z","updated":"2022-03-19T14:35:21.939Z","comments":true,"path":"2021/01/13/302/","link":"","permalink":"https://github.13sai.com/2021/01/13/302/","excerpt":"","text":"httpsè®¿é—®ä¸äº†ç°è±¡httpsè®¿é—®ä¸äº†ï¼Œç»‘å®šhostå¯è®¿é—®ï¼Œç½‘ç«™æ— æŠ¥é”™ æ’æŸ¥pingåŸŸåå¯¹äºipä¹Ÿæ­£å¸¸ï¼Œtelnet 443ç«¯å£å¤±è´¥ å¤„ç†å¼€å¯443ç«¯å£ åŠ äº†CDNçš„éƒ¨åˆ†é¡µé¢çªç„¶æ‰“ä¸å¼€ç°è±¡åŠ äº†cdnçš„éƒ¨åˆ†é¡µé¢æ‰“ä¸å¼€ï¼Œhttpé¡µé¢è®¿é—®æ­£å¸¸ï¼Œç»‘å®šhostè®¿é—®ä¹Ÿæ­£å¸¸ æ‰“ä¸å¼€çš„æƒ…å†µnginxæœ‰æŠ¥é”™å¦‚ï¼š pwritev() â€œ/usr/local/webserver/nginx_new/fastcgi_temp/1/96/0001214961â€ failed (28: No space left on device) while reading upstream, client: 61.241.120.188, server:www.13sai.com, request: â€œGET / HTTP/1.1â€, upstream: â€œfastcgi://127.0.0.1:9000â€, host: â€œwww.13sai.com&quot;ï¼Œååˆåé¦ˆåå°æ–‡ä»¶ä¸Šä¼ å¤±è´¥ æ’æŸ¥å»æ‰cdnèƒ½æ­£å¸¸è®¿é—®ï¼ŒæŒ‚è½½ç£ç›˜æœªæ»¡ï¼Œç³»ç»Ÿç›˜æ»¡ï¼Œä¹ä¸€çœ‹æ˜¯cdnå’Œwafé—®é¢˜ å¤„ç†ç³»ç»Ÿç›˜100%ï¼Œæ³¨æ„No space left on deviceï¼ŒæŒªåŠ¨å¤§æ–‡ä»¶åˆ°æŒ‚è½½çš„ç£ç›˜ï¼Œcdné¡µé¢ä¹Ÿæ¢å¤æ­£å¸¸ å»ºè®®ä¸Šä¼ å¤§æ–‡ä»¶ï¼Œä¸‹è½½å¤§æ–‡ä»¶å°½é‡åˆ«æ”¾åœ¨ç³»ç»Ÿç›˜","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/tags/web/"}]},{"title":"goæºç ä¹‹context","slug":"context","date":"2021-01-06T12:31:36.000Z","updated":"2022-03-19T15:22:15.710Z","comments":true,"path":"2021/01/06/context/","link":"","permalink":"https://github.13sai.com/2021/01/06/context/","excerpt":"","text":"å®šä¹‰è¯´æ˜ Package context defines the Context type, which carries deadlines, cancelation signals, and other request-scoped values across API boundaries and between processes.Incoming requests to a server should create a Context, and outgoing calls to servers should accept a Context. The chain of function calls between them must propagate the Context, optionally replacing it with a derived Context created using WithCancel, WithDeadline, WithTimeout, or WithValue. When a Context is canceled, all Contexts derived from it are also canceled. ç²—ç•¥ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼š contextå®šä¹‰äº†ä¸Šä¸‹æ–‡ç±»å‹ï¼Œå®ƒæºå¸¦è·¨è¶ŠAPIè¾¹ç•Œå’Œè¿›ç¨‹ä¹‹é—´çš„deadlinesã€å–æ¶ˆä¿¡å·å’Œå…¶ä»–è¯·æ±‚èŒƒå›´çš„å€¼ã€‚å¯¹æœåŠ¡å™¨çš„ä¼ å…¥è¯·æ±‚åº”è¯¥åˆ›å»ºä¸Šä¸‹æ–‡ï¼Œå¯¹æœåŠ¡å™¨çš„ä¼ å‡ºè°ƒç”¨åº”è¯¥æ¥å—ä¸Šä¸‹æ–‡ã€‚å®ƒä»¬ä¹‹é—´çš„å‡½æ•°è°ƒç”¨é“¾å¿…é¡»ä¼ æ’­ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥é€‰æ‹©ç”¨ä½¿ç”¨WithCancelã€WithDeadlineã€WithTimeoutæˆ–WithValueåˆ›å»ºçš„æ´¾ç”Ÿä¸Šä¸‹æ–‡æ›¿æ¢å®ƒã€‚å½“ä¸€ä¸ªä¸Šä¸‹æ–‡è¢«å–æ¶ˆæ—¶ï¼Œæ‰€æœ‰ä»å®ƒæ´¾ç”Ÿçš„ä¸Šä¸‹æ–‡ä¹Ÿè¢«å–æ¶ˆã€‚ æºç ç»“æ„ åç§° ç±»å‹ è¯´æ˜ Context interface å®šä¹‰äº† Context æ¥å£çš„å››ä¸ªæ–¹æ³•Deadlineã€Doneã€Errã€Value emptyCtx int æ³¨æ„ï¼šemptyCtxæ°¸è¿œä¸ä¼šå–æ¶ˆï¼Œæ²¡æœ‰å€¼ï¼Œä¹Ÿæ²¡æœ‰æˆªæ­¢æ—¥æœŸã€‚è¿™é‡Œä½¿ç”¨çš„æ˜¯ç±»å‹ç­‰ä»·å®šä¹‰ï¼ŒemptyCtxç­‰ä»·äºintç±»å‹ã€‚å¹¶ä¸”å®šä¹‰ä¸Šé¢çš„å››ä¸ªæ–¹æ³•å’ŒStringæ–¹æ³•ã€‚ Background func è¿”å›new(emptyCtx) TODO func è¿”å›new(emptyCtx) CancelFunc func CancelFuncå‘Šè¯‰æ“ä½œæ”¾å¼ƒå…¶å·¥ä½œï¼Œä¸ç­‰å¾…å·¥ä½œåœæ­¢ã€‚å¤šä¸ªgoroutineå¯ä»¥åŒæ—¶è°ƒç”¨CancelFuncã€‚åœ¨ç¬¬ä¸€ä¸ªè°ƒç”¨ä¹‹åï¼Œå¯¹CancelFuncçš„åç»­è°ƒç”¨å°†ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ WithCancel func WithCancelè¿”å›ä¸€ä¸ªå¸¦æœ‰æ–°çš„Doneé€šé“çš„parentå‰¯æœ¬ã€‚å½“è¿”å›çš„cancelå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¸Šä¸‹æ–‡çš„Doneé€šé“è¢«å…³é—­æˆ–è€…å½“çˆ¶ä¸Šä¸‹æ–‡çš„Doneé€šé“å…³é—­æ—¶ï¼Œæ— è®ºå“ªä¸ªå…ˆå‘ç”Ÿã€‚å–æ¶ˆæ­¤ä¸Šä¸‹æ–‡å°†é‡Šæ”¾ä¸ä¹‹ç›¸å…³çš„èµ„æºï¼Œä»£ç ä¹Ÿåº”è¯¥å¦‚æ­¤åœ¨æ­¤ä¸Šä¸‹æ–‡ä¸­è¿è¡Œçš„æ“ä½œä¸€å®Œæˆï¼Œå°±è°ƒç”¨cancelã€‚ newCancelCtx func è¿”å›ä¸€ä¸ªåˆå§‹åŒ–çš„cancelCtx propagateCancel func propagateCancelåœ¨çˆ¶å…ƒç´ è¢«å–æ¶ˆæ—¶å–æ¶ˆå­å…ƒç´ ï¼Œè¿™é‡Œæœ‰ç”¨åˆ°åŸå­é” parentCancelCtx func æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¯å–æ¶ˆçš„çˆ¶èŠ‚ç‚¹ removeChild func ç§»é™¤çˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ canceler interface å–æ¶ˆè€…ï¼Œå®šä¹‰äº†cancelå’ŒDoneä¸¤ä¸ªæ–¹æ³• init func åˆå§‹åŒ–æ–¹æ³• cancelCtx struct ä¸€ä¸ªå¯ä»¥å–æ¶ˆçš„ Context contextName func è¿”å›ä¸Šä¸‹æ–‡åç§° WithDeadline func åˆ›å»ºä¸€ä¸ªæœ‰ deadline çš„ context timerCtx struct timerCtxå¸¦æœ‰timeout å’Œdeadline ã€‚å®ƒå°†cancelCtxåµŒå…¥åˆ°å®ç°Doneå’ŒErrã€‚å®ƒé€šè¿‡åœæ­¢è®¡æ—¶å™¨æ¥å®ç°å–æ¶ˆï¼Œç„¶åå§”æ‰˜ç»™cancelCtx.cancelã€‚ WithTimeout func åˆ›å»ºä¸€ä¸ªæœ‰ timeout çš„ context WithValue func åˆ›å»ºä¸€ä¸ªå­˜å‚¨ k-v å¯¹çš„ context valueCtx struct å­˜å‚¨k-vï¼Œé…åˆWithValueä½¿ç”¨ stringify func æ¥å£ç±»å‹è¿”å›å­—ç¬¦ä¸² Contexttype Context interface &#123; // è·å–è®¾ç½®çš„æˆªæ­¢æ—¶é—´çš„æ„æ€ï¼Œç¬¬ä¸€ä¸ªè¿”å›å¼æ˜¯æˆªæ­¢æ—¶é—´ï¼Œåˆ°äº†è¿™ä¸ªæ—¶é—´ç‚¹ï¼ŒContextä¼šè‡ªåŠ¨å‘èµ·å–æ¶ˆè¯·æ±‚ï¼›ç¬¬äºŒä¸ªè¿”å›å€¼ok==falseæ—¶è¡¨ç¤ºæ²¡æœ‰è®¾ç½®æˆªæ­¢æ—¶é—´ï¼Œå¦‚æœéœ€è¦å–æ¶ˆçš„è¯ï¼Œéœ€è¦è°ƒç”¨å–æ¶ˆå‡½æ•°è¿›è¡Œå–æ¶ˆ Deadline() (deadline time.Time, ok bool) // è¿”å›ä¸€ä¸ªåªè¯»çš„chanï¼Œç±»å‹ä¸ºstruct&#123;&#125;ï¼Œæˆ‘ä»¬åœ¨goroutineä¸­ï¼Œå¦‚æœè¯¥æ–¹æ³•è¿”å›çš„chanå¯ä»¥è¯»å–ï¼Œåˆ™æ„å‘³ç€parent contextå·²ç»å‘èµ·äº†å–æ¶ˆè¯·æ±‚ï¼Œæˆ‘ä»¬é€šè¿‡Doneæ–¹æ³•æ”¶åˆ°è¿™ä¸ªä¿¡å·åï¼Œå°±åº”è¯¥åšæ¸…ç†æ“ä½œï¼Œç„¶åé€€å‡ºgoroutineï¼Œé‡Šæ”¾èµ„æºã€‚ Done() &lt;-chan struct&#123;&#125; // åœ¨ channel Done å…³é—­åï¼Œè¿”å› context å–æ¶ˆåŸå›  Err() error // è·å–è¯¥Contextä¸Šç»‘å®šçš„å€¼ï¼Œæ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œæ‰€ä»¥è¦é€šè¿‡ä¸€ä¸ªKeyæ‰å¯ä»¥è·å–å¯¹åº”çš„å€¼ï¼Œè¿™ä¸ªå€¼ä¸€èˆ¬æ˜¯å¹¶å‘å®‰å…¨çš„ Value(key interface&#123;&#125;) interface&#123;&#125; &#125; cancelertype canceler interface &#123; cancel(removeFromParent bool, err error) Done() &lt;-chan struct&#123;&#125; &#125; å®ç°äº†ä¸Šé¢å®šä¹‰çš„ä¸¤ä¸ªæ–¹æ³•çš„ Contextï¼Œå°±è¡¨æ˜è¯¥ Context æ˜¯å¯å–æ¶ˆçš„ã€‚æºç ä¸­æœ‰ä¸¤ä¸ªç±»å‹å®ç°äº† canceler æ¥å£ï¼š*cancelCtx å’Œ *timerCtxã€‚æ³¨æ„æ˜¯åŠ äº† * å·çš„ï¼Œæ˜¯è¿™ä¸¤ä¸ªç»“æ„ä½“çš„æŒ‡é’ˆå®ç°äº† canceler æ¥å£ã€‚ æ¥å£è®¾è®¡æˆè¿™ä¸ªæ ·å­çš„åŸå› ï¼š â€œå–æ¶ˆâ€æ“ä½œåº”è¯¥æ˜¯å»ºè®®æ€§ï¼Œè€Œéå¼ºåˆ¶æ€§ â€œå–æ¶ˆâ€æ“ä½œåº”è¯¥å¯ä¼ é€’ emptyCtxtype emptyCtx int func (*emptyCtx) Deadline() (deadline time.Time, ok bool) &#123; return &#125; func (*emptyCtx) Done() &lt;-chan struct&#123;&#125; &#123; return nil &#125; func (*emptyCtx) Err() error &#123; return nil &#125; func (*emptyCtx) Value(key interface&#123;&#125;) interface&#123;&#125; &#123; return nil &#125; func (e *emptyCtx) String() string &#123; switch e &#123; case background: return &quot;context.Background&quot; case todo: return &quot;context.TODO&quot; &#125; return &quot;unknown empty Context&quot; &#125; cancelCtx type cancelCtx struct &#123; Context mu sync.Mutex // äº’æ–¥é” done chan struct&#123;&#125; children map[canceler]struct&#123;&#125; err error &#125; æˆ‘ä»¬é‡ç‚¹çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³• func (c *cancelCtx) cancel(removeFromParent bool, err error) &#123; if err == nil &#123; panic(&quot;context: internal error: missing cancel error&quot;) &#125; c.mu.Lock() if c.err != nil &#123; c.mu.Unlock() return // å·²ç»è¢«å…¶ä»–åç¨‹å–æ¶ˆ &#125; // ç»™ err å­—æ®µèµ‹å€¼ c.err = err // å…³é—­ channelï¼Œé€šçŸ¥å…¶ä»–åç¨‹ if c.done == nil &#123; c.done = closedchan &#125; else &#123; close(c.done) &#125; // éå†å®ƒçš„æ‰€æœ‰å­èŠ‚ç‚¹ for child := range c.children &#123; // é€’å½’åœ°å–æ¶ˆæ‰€æœ‰å­èŠ‚ç‚¹ child.cancel(false, err) &#125; // å°†å­èŠ‚ç‚¹ç½®ç©º c.children = nil c.mu.Unlock() if removeFromParent &#123; // ä»çˆ¶èŠ‚ç‚¹ä¸­ç§»é™¤è‡ªå·± removeChild(c.Context, c) &#125; &#125; cancel()æ–¹æ³•çš„åŠŸèƒ½å°±æ˜¯å…³é—­ channelï¼šc.doneï¼›é€’å½’åœ°å–æ¶ˆå®ƒçš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼›ä»çˆ¶èŠ‚ç‚¹ä»åˆ é™¤è‡ªå·±ã€‚è¾¾åˆ°çš„æ•ˆæœæ˜¯é€šè¿‡å…³é—­ channelï¼Œå°†å–æ¶ˆä¿¡å·ä¼ é€’ç»™äº†å®ƒçš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚ func WithCancel(parent Context) (ctx Context, cancel CancelFunc) func WithDeadline(parent Context, deadline time.Time) (Context, CancelFunc) func WithTimeout(parent Context, timeout time.Duration) (Context, CancelFunc) func WithValue(parent Context, key, val interface&#123;&#125;) Context ä¸Šé¢å››ä¸ªå¯ä»¥ç†è§£ä¸ºContextçš„ç»§æ‰¿è¡ç”Ÿã€‚ å¯¹äºæˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨æ¥è¯´ï¼Œå­¦ä¼šContextçš„ç»§æ‰¿çš„4ä¸ªæ–¹æ³•å’ŒBackgroundã€TODOåŸºæœ¬å°±å¤Ÿäº†ã€‚ Contextä½¿ç”¨åœºæ™¯ è¶…æ—¶è¯·æ±‚ package main import ( &quot;context&quot; &quot;fmt&quot; &quot;time&quot; ) func main() &#123; ctx, cancel := context.WithTimeout(context.Background(), 50*time.Millisecond) defer cancel() select &#123; case &lt;-time.After(1 * time.Second): fmt.Println(&quot;overslept&quot;) case &lt;-ctx.Done(): fmt.Println(ctx.Err()) // prints &quot;context deadline exceeded&quot; &#125; &#125; å…±äº«æ•°æ® package main import ( &quot;context&quot; &quot;fmt&quot; ) func main() &#123; ctx := context.Background() process(ctx) ctx = context.WithValue(ctx, &quot;traceId&quot;, &quot;qcrao-2019&quot;) process(ctx) &#125; func process(ctx context.Context) &#123; traceId, ok := ctx.Value(&quot;traceId&quot;).(string) if ok &#123; fmt.Printf(&quot;process over. trace_id=%s\\n&quot;, traceId) &#125; else &#123; fmt.Printf(&quot;process over. no trace_id\\n&quot;) &#125; &#125; è¿™ä¸ªåœ¨webå¼€å‘ä¸­å¾ˆå®ç”¨ï¼Œä¼ é€’sessionã€tokenç­‰ä¿¡æ¯ã€‚ é˜²æ­¢ goroutine æ³„æ¼package main import ( &quot;time&quot; &quot;fmt&quot; ) func gen() &lt;-chan int &#123; ch := make(chan int) go func() &#123; var n int for &#123; ch &lt;- n n++ time.Sleep(time.Second) &#125; &#125;() return ch &#125; func main() &#123; for n := range gen() &#123; fmt.Println(n) if n == 5 &#123; break &#125; &#125; &#125; å½“ n = 5 çš„æ—¶å€™ï¼Œç›´æ¥ break ã€‚ä½†æ˜¯ gen çš„åç¨‹å°±ä¼šæ‰§è¡Œæ— é™å¾ªç¯ï¼Œæ°¸è¿œä¸ä¼šåœä¸‹æ¥ã€‚å‘ç”Ÿäº† goroutine æ³„æ¼ã€‚ package main import ( &quot;time&quot; &quot;fmt&quot; &quot;context&quot; ) func gen(ctx context.Context) &lt;-chan int &#123; ch := make(chan int) go func() &#123; var n int for &#123; select &#123; case &lt;-ctx.Done(): return case ch &lt;- n: n++ time.Sleep(time.Second) &#125; &#125; &#125;() return ch &#125; func main() &#123; ctx, cancel := context.WithCancel(context.Background()) defer cancel() // é¿å…å…¶ä»–åœ°æ–¹å¿˜è®° cancelï¼Œä¸”é‡å¤è°ƒç”¨ä¸å½±å“ for n := range gen(ctx) &#123; fmt.Println(n) if n == 5 &#123; cancel() break &#125; &#125; &#125; Context ä½¿ç”¨åŸåˆ™æœ€åè®°ä½å‡ ä¸ªä¸»è¦çš„ä½¿ç”¨åŸåˆ™ï¼š ä¸è¦å°† Context å¡åˆ°ç»“æ„ä½“é‡Œã€‚ç›´æ¥å°† Context ç±»å‹ä½œä¸ºå‡½æ•°çš„ç¬¬ä¸€å‚æ•°ï¼Œè€Œä¸”ä¸€èˆ¬éƒ½å‘½åä¸º ctxã€‚ ä¸è¦å‘å‡½æ•°ä¼ å…¥ä¸€ä¸ª nil çš„ contextï¼Œå¦‚æœä½ å®åœ¨ä¸çŸ¥é“ä¼ ä»€ä¹ˆï¼Œæ ‡å‡†åº“ç»™ä½ å‡†å¤‡å¥½äº†ä¸€ä¸ª contextï¼štodoã€‚ ä¸è¦æŠŠæœ¬åº”è¯¥ä½œä¸ºå‡½æ•°å‚æ•°çš„ç±»å‹å¡åˆ° context ä¸­ï¼Œcontext å­˜å‚¨çš„åº”è¯¥æ˜¯ä¸€äº›å…±åŒçš„æ•°æ®ã€‚ä¾‹å¦‚ï¼šç™»é™†çš„ sessionã€cookie ç­‰ã€‚ åŒä¸€ä¸ª context å¯èƒ½ä¼šè¢«ä¼ é€’åˆ°å¤šä¸ª goroutineï¼Œåˆ«æ‹…å¿ƒï¼Œcontext æ˜¯å¹¶å‘å®‰å…¨çš„ã€‚ å‚è€ƒæ–‡ç« ï¼š æ·±åº¦è§£å¯†Goè¯­è¨€ä¹‹context Goè¯­è¨€å®æˆ˜ç¬”è®°ï¼ˆäºŒåï¼‰| Go Contextâ€‹","categories":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/categories/gosourcecode/"}],"tags":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/tags/gosourcecode/"}]},{"title":"x/rate/limit","slug":"rate","date":"2021-01-06T12:31:36.000Z","updated":"2022-03-19T15:22:10.008Z","comments":true,"path":"2021/01/06/rate/","link":"","permalink":"https://github.13sai.com/2021/01/06/rate/","excerpt":"","text":"é™æµæ˜¯ä¿è¯æœåŠ¡å¯ç”¨æ€§å’Œç¨³å®šçš„åˆ©å™¨ä¹‹ä¸€ã€‚goè‡ªå¸¦æœ‰é™æµå™¨rateï¼Œæˆ‘ä»¬æ¥ç ”è¯»ä¸€ä¸‹æºç ï¼Œæºç è¾ƒå°‘ï¼Œæˆ‘ä»¬åˆ—å‡ºä¸»è¦ä»£ç éƒ¨åˆ†ï¼Œæ³¨é‡Šè¯´æ˜ï¼š // é™å®šé€Ÿç‡ type Limit float64 // å¸¸é‡Infï¼šæ— é€Ÿç‡é™åˆ¶ const Inf = Limit(math.MaxFloat64) // é™æµå™¨çš„ç»“æ„ä½“ï¼Œæœ¬è´¨å°±æ˜¯ä¸€ä¸ªä»¤ç‰Œæ¡¶ï¼Œ type Limiter struct &#123; mu sync.Mutex limit Limit burst int tokens float64 // è®°å½•ä¸Šæ¬¡ Limiter è¢«æ›´æ–°çš„æ—¶é—´ last time.Time // lastEvent è®°å½•é€Ÿç‡å—é™åˆ¶çš„æ—¶é—´ lastEvent time.Time &#125; // newä¸€ä¸ªæ–°çš„é™æµå™¨ *Limiterï¼Œræ˜¯é€Ÿç‡ï¼Œbæ˜¯å…è®¸çªå‘çš„ä»¤ç‰Œæ•°é‡ func NewLimiter(r Limit, b int) *Limiter &#123; return &amp;Limiter&#123; limit: r, burst: b, &#125; &#125; // Reservation ä¿å­˜äº†é™æµå™¨å»¶è¿Ÿåå‘ç”Ÿçš„äº‹ä»¶ä¿¡æ¯ type Reservation struct &#123; // æ˜¯å¦æ»¡è¶³æ¡ä»¶åˆ†é…äº†ä»¤ç‰Œå•Š ok bool // é™æµå™¨ lim *Limiter // ä»¤ç‰Œæ•°é‡ tokens int // æ»¡è¶³ä»¤ç‰Œå‘æ”¾çš„æ—¶é—´ timeToAct time.Time // ä»¤ç‰Œå‘æ”¾é€Ÿç‡ limit Limit &#125; // è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„å†…éƒ¨å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªReservation func (lim *Limiter) reserveN(now time.Time, n int, maxFutureReserve time.Duration) Reservation &#123; // äº’æ–¥é”ï¼Œä¿è¯åŸå­æ€§ lim.mu.Lock() // åˆ¤æ–­é€Ÿç‡æ˜¯ä¸æ˜¯æœ€å¤§ï¼Œæ˜¯çš„è¯æ— éœ€é™æµ if lim.limit == Inf &#123; lim.mu.Unlock() return Reservation&#123; ok: true, lim: lim, tokens: n, timeToAct: now, &#125; &#125; // è°ƒç”¨ advance æ–¹æ³•ï¼Œè·å–æœ€æ–°çš„æ—¶é—´ã€ä¸Šä¸€æ¬¡å–å¾—ä»¤ç‰Œçš„æ—¶é—´ã€æœ€æ–°çš„tokenæ•°é‡ now, last, tokens := lim.advance(now) // æ›´æ–°tokenæ•°é‡ tokens -= float64(n) // è®¡ç®—ç­‰å¾…æ—¶é—´ï¼Œæ•°é‡å°äº0è¡¨ç¤ºä»¤ç‰Œæ¡¶ä¸­æœ¨æœ‰å¯ç”¨çš„ä»¤ç‰Œäº† var waitDuration time.Duration if tokens &lt; 0 &#123; waitDuration = lim.limit.durationFromTokens(-tokens) &#125; // è®¡ç®—ç»“æœ ok := n &lt;= lim.burst &amp;&amp; waitDuration &lt;= maxFutureReserve // åˆå§‹åŒ– Reservation r := Reservation&#123; ok: ok, lim: lim, limit: lim.limit, &#125; // æ›´æ–°ä»¤ç‰Œæ¡¶æ•°é‡å’Œæ—¶é—´ if ok &#123; r.tokens = n r.timeToAct = now.Add(waitDuration) &#125; // æ›´æ–°é™æµå™¨æœ€æ–°å–å¾—ä»¤ç‰Œçš„æ—¶é—´ã€æ•°é‡ã€äº‹ä»¶ if ok &#123; lim.last = now lim.tokens = tokens lim.lastEvent = r.timeToAct &#125; else &#123; lim.last = last &#125; lim.mu.Unlock() return r &#125; // è®¡ç®—æ—¶é—´å˜åŒ–çš„ Limiter çš„çŠ¶æ€å˜åŒ–ï¼Œå¾—åˆ°æœ€æ–°çš„æ—¶é—´ï¼Œæœ€åä¸€æ¬¡å–å¾—ä»¤ç‰Œçš„æ—¶é—´å’Œ token ä»¤ç‰Œæ•°é‡ func (lim *Limiter) advance(now time.Time) (newNow time.Time, newLast time.Time, newTokens float64) &#123; last := lim.last if now.Before(last) &#123; last = now &#125; maxElapsed := lim.limit.durationFromTokens(float64(lim.burst) - lim.tokens) elapsed := now.Sub(last) if elapsed &gt; maxElapsed &#123; elapsed = maxElapsed &#125; delta := lim.limit.tokensFromDuration(elapsed) tokens := lim.tokens + delta if burst := float64(lim.burst); tokens &gt; burst &#123; tokens = burst &#125; return now, last, tokens &#125; // è¿™é‡Œå•ç‹¬æ”¾å‡ºæ¥ï¼Œæ˜¯æé†’ä¸€ä¸‹ï¼Œgoä¹Ÿæœ‰ç²¾åº¦ç¼ºå¤±é—®é¢˜ï¼Œæ‰€ä»¥å¤æ‚è®¡ç®—è¦æ³¨æ„ func (limit Limit) tokensFromDuration(d time.Duration) float64 &#123; sec := float64(d/time.Second) * float64(limit) nsec := float64(d%time.Second) * float64(limit) return sec + nsec/1e9 &#125; ä½¿ç”¨å®ä¾‹å’Œdemoå¯çœ‹ï¼š golang é™æµå™¨","categories":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/categories/gosourcecode/"}],"tags":[{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/tags/gosourcecode/"}]},{"title":"MongoDBçš„ç®€å•ä½¿ç”¨è¯´æ˜","slug":"MongoDBçš„ç®€å•ä½¿ç”¨è¯´æ˜","date":"2020-12-24T11:55:10.000Z","updated":"2022-03-19T14:35:21.612Z","comments":true,"path":"2020/12/24/301/","link":"","permalink":"https://github.13sai.com/2020/12/24/301/","excerpt":"","text":"å®‰è£…// ä¸‹è½½ï¼Œæ³¨æ„ä¸‹è½½å¯¹åº”çš„ç³»ç»Ÿç‰ˆæœ¬ï¼Œå¦åˆ™å®‰è£…ä¼šæŠ¥é”™ wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-4.4.1.tgz // è§£å‹å³å¯ï¼Œæ— éœ€ç¼–è¯‘å®‰è£… tar -zxvf mongodb-linux-x86_64-rhel70-4.4.1.tgz mv mongodb-linux-x86_64-rhel70-4.4.1 /usr/local/mongodb å¯åŠ¨æœåŠ¡æ–°å»ºmongodb.confï¼ˆç‰ˆæœ¬å¯èƒ½ä¸ä¸€æ ·ï¼Œç•¥æœ‰ä¸åŒï¼‰ dbpath = /data/mongodb/data #æ•°æ®æ–‡ä»¶å­˜æ”¾ç›®å½• logpath = /data/mongodb/log/mongodb.log #æ—¥å¿—æ–‡ä»¶å­˜æ”¾ç›®å½• port = 27000 #ç«¯å£ fork = true #ä»¥å®ˆæŠ¤ç¨‹åºçš„æ–¹å¼å¯ç”¨ï¼Œå³åœ¨åå°è¿è¡Œ bind_ip=127.0.0.1 cd /usr/local/mongodb/ // å¯åŠ¨æœåŠ¡ bin/mongod -f ./mongodb.conf æ–°å¢ç”¨æˆ·è®¾ç½®å¯†ç  use admin; db.createUser(&#123;user:&quot;root&quot;,pwd:&quot;666888&quot;,roles:[&quot;userAdminAnyDatabase&quot;]&#125;); use test; db.createUser(&#123; user: &quot;test&quot;, pwd: &quot;123456&quot;, roles: [&#123;role: &quot;readWrite&quot;,db: &quot;hotel&quot;&#125;] &#125;) db.createUser( &#123; user: &quot;admin&quot;, pwd: &quot;5176567&quot;, roles: [&#123;role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot;&#125;] &#125; ) roleçš„è¯´æ˜ Readï¼šå…è®¸ç”¨æˆ·è¯»å–æŒ‡å®šæ•°æ®åº“ readWriteï¼šå…è®¸ç”¨æˆ·è¯»å†™æŒ‡å®šæ•°æ®åº“ dbAdminï¼šå…è®¸ç”¨æˆ·åœ¨æŒ‡å®šæ•°æ®åº“ä¸­æ‰§è¡Œç®¡ç†å‡½æ•°ï¼Œå¦‚ç´¢å¼•åˆ›å»ºã€åˆ é™¤ï¼ŒæŸ¥çœ‹ç»Ÿè®¡æˆ–è®¿é—®system.profile userAdminï¼šå…è®¸ç”¨æˆ·å‘system.usersé›†åˆå†™å…¥ï¼Œå¯ä»¥æ‰¾æŒ‡å®šæ•°æ®åº“é‡Œåˆ›å»ºã€åˆ é™¤å’Œç®¡ç†ç”¨æˆ· clusterAdminï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰åˆ†ç‰‡å’Œå¤åˆ¶é›†ç›¸å…³å‡½æ•°çš„ç®¡ç†æƒé™ã€‚ readAnyDatabaseï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„è¯»æƒé™ readWriteAnyDatabaseï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„è¯»å†™æƒé™ userAdminAnyDatabaseï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„userAdminæƒé™ dbAdminAnyDatabaseï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„dbAdminæƒé™ã€‚ rootï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ã€‚è¶…çº§è´¦å·ï¼Œè¶…çº§æƒé™ å»ºè®®å‡ºrootå’Œadminï¼Œå„ä¸ªæ•°æ®åº“ä½¿ç”¨è‡ªå·±ç‹¬ç«‹çš„è´¦å·å¯†ç ã€‚ authå°è¯•ä¸€ä¸‹ï¼Œå¦‚æœè¿”å›1ï¼Œè¡¨ç¤ºauthéªŒè¯æˆåŠŸ db.auth(&#x27;root&#x27;, &#x27;666888&#x27;) å¸¸ç”¨å‘½ä»¤å…³é—­mongoæœåŠ¡ use admin db.shutdownServer() æ¸…ç©ºå½“å‰æ•°æ®åº“ use xxx db.dropDatabase() é›†æˆåˆ°Laravelå®‰è£… composer require jenssegers/mongodb 3.6.x ä½ç‰ˆæœ¬éœ€è¦åœ¨config/app.phpåŠ å…¥ Jenssegers\\Mongodb\\MongodbServiceProvider::class, é…ç½®database.php &#x27;mongodb&#x27; =&gt; [ &#x27;driver&#x27; =&gt; &#x27;mongodb&#x27;, &#x27;host&#x27; =&gt; env(&#x27;MONGODB_HOST&#x27;, &#x27;127.0.0.1&#x27;), &#x27;port&#x27; =&gt; env(&#x27;MONGODB_PORT&#x27;, 27017), &#x27;database&#x27; =&gt; env(&#x27;MONGODB_DATABASE&#x27;, &#x27;test&#x27;), &#x27;username&#x27; =&gt; env(&#x27;MONGODB_USERNAME&#x27;, &#x27;test&#x27;), &#x27;password&#x27; =&gt; env(&#x27;MONGODB_PWD&#x27;, &#x27;&#x27;), &#x27;options&#x27; =&gt; [ // here you can pass more settings to the Mongo Driver Manager // see https://www.php.net/manual/en/mongodb-driver-manager.construct.php under &quot;Uri Options&quot; for a list of complete parameters that you can use &#x27;database&#x27; =&gt; env(&#x27;MONGODB_AUTHENTICATION_DATABASE&#x27;, &#x27;hotel&#x27;), // required with Mongo 3+ ], ], Modelå®šä¹‰: &lt;?php /** * Author: 13sai * Date: 2020/12/22 * Time: 15:08 */ namespace App\\Models; use Jenssegers\\Mongodb\\Eloquent\\Model; class Product extends Model &#123; protected $collection = &#x27;products&#x27;; protected $connection = &#x27;mongodb&#x27;; protected $guarded = [&#x27;id&#x27;]; &#125; ä½¿ç”¨: $users = User::distinct(&#x27;name&#x27;)-&gt;get(); $users = User::whereIn(&#x27;age&#x27;, [16, 18, 20])-&gt;get(); $total = Product::count(); $price = Product::avg(&#x27;price&#x27;); Eloquent ORMå¸¸ç”¨çš„å‘½ä»¤å‡æ”¯æŒï¼Œç”¨èµ·æ¥æ¯«æ— è¿å’Œæ„Ÿï¼Œselectç•¥æœ‰ä¸åŒï¼Œä¼šæŠŠ_idæŸ¥è¯¢å‡ºæ¥ã€‚ æ›´å¤šå‘½ä»¤ç‚¹å‡»æŸ¥çœ‹ä»£ç ä»“åº“ å¤§è‡´ä¹Ÿå°±è¿™äº›äº†ï¼Œèµ¶ç´§ä½¿ç”¨èµ·æ¥å§ï¼ï¼ï¼","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"MongoDB","slug":"MongoDB","permalink":"https://github.13sai.com/tags/MongoDB/"}]},{"title":"goçš„å¹¶å‘æ¨¡å‹","slug":"goçš„å¹¶å‘æ¨¡å‹","date":"2020-11-21T13:26:35.000Z","updated":"2022-03-19T14:35:21.708Z","comments":true,"path":"2020/11/21/283/","link":"","permalink":"https://github.13sai.com/2020/11/21/283/","excerpt":"","text":"ä»‹ç»å¹¶å‘æ¨¡å‹ï¼Œæˆ‘ä»¬å…ˆæ¥è¯´ä¸€ä¸‹å¹¶å‘å’Œå¹¶è¡Œã€‚ å¹¶å‘å’Œå¹¶è¡Œå¹¶å‘å’Œå¹¶è¡Œå¦æ˜¯ä¸ºäº†å……åˆ†åˆ©ç”¨CPUå¤šæ ¸è®¡ç®—èµ„æºæå‡ºæ¥çš„æ¦‚å¿µã€‚ å¹¶å‘æŒ‡çš„æ˜¯åœ¨åŒä¸€ä¸ªæ—¶é—´æ®µå†…ï¼Œå¤šæ¡æŒ‡ä»¤åœ¨CPUä¸ŠåŒæ—¶æ‰§è¡Œ å¹¶è¡Œå€¼å¾—æ˜¯åœ¨åŒä¸€æ—¶åˆ»ï¼Œå¤šæ¡æŒ‡ä»¤åœ¨CPUä¸ŠåŒæ—¶æ‰§è¡Œ å¹¶å‘ç¨‹åºå…¶å®å¹¶ä¸è¦æ±‚CPUå…·å¤‡å¤šæ ¸è®¡ç®—çš„èƒ½åŠ›ï¼Œåœ¨åŒä¸€æ—¶é—´æ®µå†…ï¼Œå¤šä¸ªçº¿ç¨‹ä¼šè¢«åˆ†é…ä¸€å®šçš„æ‰§è¡Œæ—¶é—´ç‰‡ï¼Œåœ¨CPUä¸Šè¢«å¿«é€Ÿè½®æ¢æ‰§è¡Œã€‚ CSPå¹¶å‘æ¨¡å‹Goè¯­è¨€ä¸­å®ç°äº†ä¸¤ç§å¹¶å‘æ¨¡å‹ï¼Œä¸€ç§æ˜¯ä¾èµ–äºå…±äº«å†…å­˜å®ç°çš„çº¿ç¨‹-é”å¹¶å‘æ¨¡å‹ï¼Œå¦ä¸€ç§åˆ™æ˜¯CSPã€‚ CSPå€¡å¯¼ä½¿ç”¨é€šä¿¡æ¥å…±äº«å†…å­˜ï¼Œå®ƒæœ‰ä¸¤ä¸ªå…³é”®ç‚¹ï¼š å¹¶å‘å®ä½“ï¼Œé€šå¸¸å¯ä»¥ç†è§£ä¸ºæ‰§è¡Œçº¿ç¨‹ï¼Œå®ƒä»¬ç›¸äº’ç‹¬ç«‹ä¸”å¯ä»¥å¹¶å‘æ‰§è¡Œ é€šé“ï¼Œå¹¶å‘å®ä½“ä¹‹é—´é€šè¿‡é€šé“å‘é€æ¶ˆæ¯ï¼Œè¿›è¡Œé€šä¿¡ CSP ç±»ä¼¼äºæˆ‘ä»¬å¸¸ç”¨çš„åŒæ­¥é˜Ÿåˆ—ï¼Œå®ƒå…³æ³¨çš„æ¶ˆæ¯ä¼ è¾“çš„æ–¹å¼ï¼ˆé€šé“ï¼‰ï¼Œå¹¶ä¸å…³æ³¨æ¶ˆæ¯å®ä½“ã€‚å‘é€è€…å’Œæ¥æ”¶è€…å¯èƒ½å¹¶ä¸çŸ¥é“å¯¹æ–¹æ˜¯è°ï¼Œè€¦åˆåº¦æ˜¯å¾ˆä½çš„ã€‚ è™½ç„¶CSPçš„é€šé“æä¾›äº†æå¤§çš„çµæ´»æ€§ï¼Œä½†ä½œä¸ºç‹¬ç«‹çš„å¯¹è±¡ï¼Œå®ƒå¯ä»¥è¢«ä»»æ„å¹¶å‘å®ä½“åˆ›å»ºã€è¯»å–ã€å†™å…¥ã€ä½¿ç”¨ï¼Œä½†ä½¿ç”¨æ—¶åŠ¡å¿…æ³¨æ„ï¼Œå½“ä¸€ä¸ªå¹¶å‘å®ä½“åœ¨è¯»å–ä¸€ä¸ªæ°¸è¿œæ²¡æœ‰æ•°æ®æ”¾å…¥çš„é€šé“æˆ–è€…æŠŠæ•°æ®æ”¾å…¥ä¸€ä¸ªæ°¸è¿œä¸ä¼šè¢«è¯»å–çš„é€šé“ï¼Œæ˜¯ä¼šè¢«é˜»å¡ï¼Œå‘ç”Ÿæ­»é”çš„ã€‚ MPGçº¿ç¨‹æ¨¡å‹Goè¯­è¨€ä¸ä½†æœ‰ç€ç‹¬ç‰¹çš„å¹¶å‘ç¼–ç¨‹æ¨¡å‹ï¼Œè¿˜æ‹¥æœ‰å¼ºå¤§çš„ç”¨äºè°ƒåº¦goroutineã€å¯¹æ¥ç³»ç»Ÿçº§çº¿ç¨‹çš„è°ƒåº¦å™¨ã€‚ è¿™ä¸ªè°ƒåº¦å™¨æ˜¯Goè¯­è¨€è¿è¡Œæ—¶ç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒä¸»è¦è´Ÿè´£ç»Ÿç­¹è°ƒé…Goå¹¶å‘ç¼–ç¨‹æ¨¡å‹ä¸­çš„ä¸‰ä¸ªä¸»è¦å…ƒç´ ï¼Œå³ï¼šMPGã€‚ æ¨¡å— è¯´æ˜ Machine ä¸€ä¸ªMachineå¯¹åº”ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ï¼Œç›¸å½“äºå†…æ ¸çº¿ç¨‹åœ¨Goè¿›ç¨‹ä¸­çš„æ˜ å°„ Processor ä¸€ä¸ªProcessorè¡¨ç¤ºæ‰§è¡ŒGoç¨‹åºæ‰€å¿…é¡»çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå¯ä»¥ç†è§£ä¸ºç”¨æˆ·ä»£ç é€»è¾‘çš„å¤„ç†å™¨ Goroutine æ˜¯å¯¹Goè¯­è¨€ä¸­ä»£ç ç‰‡æ®µçš„å°è£…ï¼Œå…¶å®æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ç”¨æˆ·çº¿ç¨‹ Må’ŒPæ˜¯ä¸€å¯¹ä¸€ç»‘å®šçš„ï¼Œä½†ç”±äºPçš„å­˜åœ¨ï¼ŒGå’ŒMå¯ä»¥å‘ˆç°å‡ºå¤šå¯¹å¤šçš„å…³ç³»ã€‚å½“ä¸€ä¸ªæ­£åœ¨ä¸æŸä¸ªMå¯¹æ¥å¹¶è¿è¡Œç€çš„Gï¼Œéœ€è¦å› æŸä¸ªäº‹ä»¶ï¼ˆæ¯”å¦‚ç­‰å¾…I/Oæˆ–é”çš„è§£é™¤ï¼‰è€Œæš‚åœè¿è¡Œçš„æ—¶å€™ï¼Œè°ƒåº¦å™¨æ€»ä¼šåŠæ—¶åœ°å‘ç°ï¼Œå¹¶æŠŠè¿™ä¸ªGä¸é‚£ä¸ªMåˆ†ç¦»å¼€ï¼Œä»¥é‡Šæ”¾è®¡ç®—èµ„æºä¾›é‚£äº›ç­‰å¾…è¿è¡Œçš„Gä½¿ç”¨ã€‚ å¯ä»¥çœ‹å›¾ï¼Œæ›´ç›´è§‚ï¼š æœ‰å…³På’ŒMçš„ä¸ªæ•°é—®é¢˜ Pçš„æ•°é‡ï¼š ç”±å¯åŠ¨æ—¶ç¯å¢ƒå˜é‡$GOMAXPROCSæˆ–è€…æ˜¯ç”±runtimeçš„æ–¹æ³•GOMAXPROCS()å†³å®šã€‚è¿™æ„å‘³ç€åœ¨ç¨‹åºæ‰§è¡Œçš„ä»»æ„æ—¶åˆ»éƒ½åªæœ‰$GOMAXPROCSä¸ªgoroutineåœ¨åŒæ—¶è¿è¡Œã€‚ Mçš„æ•°é‡: goè¯­è¨€æœ¬èº«çš„é™åˆ¶ï¼šgoç¨‹åºå¯åŠ¨æ—¶ï¼Œä¼šè®¾ç½®Mçš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤10000ã€‚ä½†æ˜¯å†…æ ¸å¾ˆéš¾æ”¯æŒè¿™ä¹ˆå¤šçš„çº¿ç¨‹æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªé™åˆ¶å¯ä»¥å¿½ç•¥ã€‚ runtime/debugä¸­çš„SetMaxThreadså‡½æ•°ï¼Œè®¾ç½®Mçš„æœ€å¤§æ•°é‡ã€‚ Mä¸Pçš„æ•°é‡æ²¡æœ‰ç»å¯¹å…³ç³»ï¼Œä¸€ä¸ªMé˜»å¡ï¼ŒPå°±ä¼šå»åˆ›å»ºæˆ–è€…åˆ‡æ¢å¦ä¸€ä¸ªMï¼Œæ‰€ä»¥ï¼Œå³ä½¿Pçš„é»˜è®¤æ•°é‡æ˜¯1ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šåˆ›å»ºå¾ˆå¤šä¸ªMå‡ºæ¥ã€‚ På’ŒMä½•æ—¶ä¼šè¢«åˆ›å»ºï¼š Pä½•æ—¶åˆ›å»ºï¼šåœ¨ç¡®å®šäº†Pçš„æœ€å¤§æ•°é‡nåï¼Œè¿è¡Œæ—¶ç³»ç»Ÿä¼šæ ¹æ®è¿™ä¸ªæ•°é‡åˆ›å»ºnä¸ªPã€‚ Mä½•æ—¶åˆ›å»ºï¼šæ²¡æœ‰è¶³å¤Ÿçš„Mæ¥å…³è”På¹¶è¿è¡Œå…¶ä¸­çš„å¯è¿è¡Œçš„Gã€‚æ¯”å¦‚æ‰€æœ‰çš„Mæ­¤æ—¶éƒ½é˜»å¡ä½äº†ï¼Œè€ŒPä¸­è¿˜æœ‰å¾ˆå¤šå°±ç»ªä»»åŠ¡ï¼Œå°±ä¼šå»å¯»æ‰¾ç©ºé—²çš„Mï¼Œè€Œæ²¡æœ‰ç©ºé—²çš„ï¼Œå°±ä¼šå»åˆ›å»ºæ–°çš„Mã€‚ å‚è€ƒï¼š ã€ŠGoè¯­è¨€é«˜å¹¶å‘äºä¸ºæœåŠ¡å®æˆ˜ã€‹ ã€ŠGoè¯­è¨€æ ¸å¿ƒ36è®²ã€‹ Golangè°ƒåº¦å™¨GMPåŸç†ä¸è°ƒåº¦å…¨åˆ†æ","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"MySQLé—´éš™é”","slug":"MySQLé—´éš™é”","date":"2020-10-27T12:01:18.000Z","updated":"2022-03-19T15:35:29.266Z","comments":true,"path":"2020/10/27/MySQL-gaplock/","link":"","permalink":"https://github.13sai.com/2020/10/27/MySQL-gaplock/","excerpt":"","text":"gap lockï¼Œä¹Ÿå°±æ˜¯é—´éš™é”ï¼Œæ˜¯innodbè¡Œçº§é”çš„ä¸€ç§ï¼Œå…¶ä»–çš„è¿˜æœ‰record lock, Next-KeyLocksã€‚ è¡Œé”ï¼ˆRecord Lockï¼‰ï¼šé”ç›´æ¥åŠ åœ¨ç´¢å¼•è®°å½•ä¸Šé¢ã€‚ é—´éš™é”ï¼ˆGap Lockï¼‰ï¼šé”åŠ åœ¨ä¸å­˜åœ¨çš„ç©ºé—²ç©ºé—´ï¼Œå¯ä»¥æ˜¯ä¸¤ä¸ªç´¢å¼•è®°å½•ä¹‹é—´ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¬¬ä¸€ä¸ªç´¢å¼•è®°å½•ä¹‹å‰æˆ–æœ€åä¸€ä¸ªç´¢å¼•ä¹‹åçš„ç©ºé—´ã€‚ Next-Key Lockï¼šè¡Œé”ä¸é—´éš™é”ç»„åˆèµ·æ¥ç”¨å°±å«åšNext-Key Lockã€‚ ä»€ä¹ˆæ—¶å€™ä¼šå–å¾—gap lockè¿™å’Œéš”ç¦»çº§åˆ«æœ‰å…³,åªåœ¨REPEATABLE READæˆ–ä»¥ä¸Šçš„éš”ç¦»çº§åˆ«ä¸‹çš„ç‰¹å®šæ“ä½œæ‰ä¼šå–å¾—gap lockæˆ–nextkey lockã€‚locking readsï¼ŒUPDATEå’ŒDELETEæ—¶ï¼Œé™¤äº†å¯¹å”¯ä¸€ç´¢å¼•çš„å”¯ä¸€æœç´¢å¤–éƒ½ä¼šè·å–gapé”æˆ–next-keyé”ã€‚å³é”ä½å…¶æ‰«æçš„èŒƒå›´ã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹å®ä¾‹ï¼š mysql&gt; CREATE TABLE `test` ( `id` int(11) DEFAULT NULL, `c1` int(11) DEFAULT NULL, KEY `test_idx1` (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4; æ’å…¥3æ¡è®°å½•ï¼Œ mysql&gt; insert into test values(10,1); insert into test values(20,2); insert into test values(30,3); åœ¨REPEATABLE READä¸‹ï¼Œæ›´æ–°ä¸€æ¡è®°å½•ä¸æäº¤ï¼Œç„¶åçœ‹çœ‹èƒ½é˜»å¡å¦å¤–çš„ä¼šè¯å“ªäº›æ“ä½œã€‚ SESSION 1: SESSION 1ä¸­æ›´æ–°id=20çš„è®°å½• mysql&gt; begin; Query OK, 0 rows affected (0.00 sec) mysql&gt; update test set c1=2 where id=20; Query OK, 1 row affected (0.04 sec) Rows matched: 1 Changed: 1 Warnings: 0 SESSION 2: mysql&gt; begin; Query OK, 0 rows affected (0.00 sec) mysql&gt; insert into test values(9,4); Query OK, 1 row affected (0.00 sec) mysql&gt; insert into test values(10,4); ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction mysql&gt; insert into test values(19,4); ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction mysql&gt; update test set c1=22 where id=20; ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction mysql&gt; insert into test values(20,4); ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction mysql&gt; insert into test values(21,4); ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction mysql&gt; insert into test values(29,4); ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction mysql&gt; insert into test values(30,4); Query OK, 1 row affected (0.01 sec) SESSION 2ä¸­ï¼Œæ‰§è¡Œæ’å…¥æ“ä½œï¼Œå‘ç°[10,30)èŒƒå›´ä¸èƒ½æ’å…¥æ•°æ®ã€‚ SESSION 1: mysql&gt; begin; mysql&gt; update test set c1=4 where id=21; Query OK, 0 rows affected (0.00 sec) SESSION 2: mysql&gt; begin; mysql&gt; update test set c1=22 where id=20; Query OK, 1 row affected (0.01 sec) mysql&gt; insert into test values(20,4); ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction mysql&gt; update test set c1=4 where id=30; Query OK, 0 rows affected (0.00 sec) è¿™é‡Œå‘¢ï¼Œæ˜¯å»é”ä½äº†ä¸€æ¡ä¸å­˜åœ¨çš„è®°å½•ï¼Œä»–ä¼šé”ä½æœ€è¿‘çš„[20,30)åŒºé—´ï¼Œç„¶è€Œä¸å‰ä¸€ä¸ªä¾‹å­ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œupdateï¼ˆid = 20ï¼‰æ˜¯å¯ä»¥æˆåŠŸçš„ï¼Œinsertï¼ˆid = 20ï¼‰æ˜¯ä¸å¯ä»¥çš„ã€‚ å¦‚æœSESSION 1çš„è¡¨æ‰«ææ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼Œé‚£ä¹ˆgapæˆ–next-keyé”ä½çš„èŒƒå›´æ˜¯æ•´ä¸ªè¡¨ï¼Œå³ä»»ä½•å€¼éƒ½ä¸èƒ½æ’å…¥ã€‚ ä½œç”¨é—´éš™é”åœ¨InnoDBçš„å”¯ä¸€ä½œç”¨å°±æ˜¯é˜²æ­¢å…¶å®ƒäº‹åŠ¡çš„æ’å…¥æ“ä½œï¼Œä»¥æ­¤æ¥è¾¾åˆ°é˜²æ­¢å¹»è¯»çš„å‘ç”Ÿï¼Œæ‰€ä»¥é—´éš™é”ä¸åˆ†ä»€ä¹ˆå…±äº«é”ä¸æ’å®ƒé”ã€‚ æ—¢ç„¶çŸ¥é“æœ‰gap lockå’Œnext key lockï¼Œæˆ‘ä»¬å¼€å‘ä¸­å°±è¦é¿å…æ”¶åˆ°å…¶å½±å“ï¼Œåœ¨å¹¶å‘åœºæ™¯ä¸‹ï¼Œä½¿ç”¨é”å°½é‡èµ°ç´¢å¼•ï¼Œç”šè‡³æ˜¯å”¯ä¸€ç´¢å¼•ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥å…³é—­é—´éš™é”ï¼Œå¯ä»¥æŠŠéš”ç¦»çº§åˆ«é™ä¸ºè¯»å·²æäº¤Read Committedï¼Œæˆ–è€…å¼€å¯å‚æ•°innodb_locks_unsafe_for_binlogã€‚","categories":[{"name":"MySQL","slug":"MySQL","permalink":"https://github.13sai.com/categories/MySQL/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"layerå…³é—­çš„é—®é¢˜","slug":"layerå…³é—­çš„é—®é¢˜","date":"2020-10-21T11:54:05.000Z","updated":"2022-03-19T14:35:21.762Z","comments":true,"path":"2020/10/21/277/","link":"","permalink":"https://github.13sai.com/2020/10/21/277/","excerpt":"","text":"layerå¼¹å‡ºå±‚åº”è¯¥æ˜¯æˆ‘ä»¬æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªç»„ä»¶äº†ã€‚ é‡åˆ°ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¼¹å‡ºå±‚åŠ ä¸Šä¸‹ä¸€ä¸ªä¸Šä¸€ä¸ªï¼Œå…¶å®æŒ‰ç†æ˜¯æ¯”è¾ƒå¥½å®ç°ï¼Œç‚¹å‡»ä¸Šä¸€ä¸ªä¸‹ä¸€ä¸ªæŒ‰é’®ï¼Œè°ƒç”¨ä¸€ä¸‹layer.closeå³å¯ï¼Œç„¶è€Œæ— å¥ˆçš„æ˜¯å¼¹å‡ºçš„æ˜¯ä¸€ä¸ªiframeï¼Œéƒ½ä¸åœ¨ä¸€ä¸ªé¡µé¢ï¼Œå¦‚ä½•è°ƒç”¨layer.closeã€‚ é‚£å¯æ€ä¹ˆåŠå‘¢ï¼Ÿ var index=parent.layer.getFrameIndex(window.name); parent.layer.close(index); parent.layer.open(&#123; type: 2, title: &#x27;è¯¦æƒ…&#x27;, shadeClose: true, area: [&#x27;1000px&#x27;, &#x27;96%&#x27;], content: &quot;...&quot; &#125;); å¦‚ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨parent.layer.closeï¼Œå¹¶é€šè¿‡parent.layer.getFrameIndexè·å–å‰¯é¡µé¢çš„layerå…ƒç´ ï¼Œè¿™æ ·å°±å®ç°æ­¤éœ€æ±‚äº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"golangçš„timeä½¿ç”¨","slug":"golangçš„timeä½¿ç”¨","date":"2020-09-10T12:44:26.000Z","updated":"2022-03-19T14:35:21.690Z","comments":true,"path":"2020/09/10/275/","link":"","permalink":"https://github.13sai.com/2020/09/10/275/","excerpt":"","text":"timeåº”è¯¥æ˜¯å¼€å‘ä¸­æ¯”è¾ƒå¸¸ç”¨çš„åº“äº†ï¼Œå¸¸è§æ–¹æ³•è¯´æ˜ï¼š package main import ( &quot;time&quot; &quot;fmt&quot; ) func main() &#123; a := time.Now().Unix() fmt.Println(&quot;æ—¶é—´æˆ³---&quot;, a) // 2006-01-02 15:04:05 è®°ä½è¿™ä¸€åˆ» b := time.Now().Format(&quot;2006-01-02 15:04:05&quot;) fmt.Println(&quot;æ ¼å¼åŒ–æ—¶é—´&quot;, b) /** func (t Time) Add(d Duration) Time Durationå¦‚ä¸‹ const ( Nanosecond Duration = 1 Microsecond = 1000 * Nanosecond Millisecond = 1000 * Microsecond Second = 1000 * Millisecond Minute = 60 * Second Hour = 60 * Minute ) */ c := time.Now().Add(time.Minute * 3) fmt.Println(&quot;3åˆ†é’Ÿåæ—¶é—´&quot;, c.Format(&quot;2006-01-02 15:04:05&quot;)) /** func (t Time) AddDate(years int, months int, days int) Time */ d := time.Now().AddDate(-1, 1,10) fmt.Println(&quot;æ—¶é—´&quot;, d.Format(&quot;2006-01-02 15:04:05&quot;)) // è¿”å›å¹´æœˆæ—¥ä¸‰ä¸ªå€¼ fmt.Println(time.Now().Date()) // è¿”å›æ—¶åˆ†ç§’ä¸‰ä¸ªå€¼ fmt.Println(time.Now().Clock()) fmt.Println(time.Now().Year(), time.Now().Month(), time.Now().Day()) fmt.Println(time.Now().Weekday(), time.Now().Hour()) fmt.Println(time.Now().YearDay()) fmt.Println(time.Since(d)) // tringè¿”å›é‡‡ç”¨å¦‚ä¸‹æ ¼å¼å­—ç¬¦ä¸²çš„æ ¼å¼åŒ–æ—¶é—´ã€‚ // &quot;2006-01-02 15:04:05.999999999 -0700 MST&quot; fmt.Println(time.Now().String()) time.AfterFunc(2*time.Second, func() &#123; fmt.Println(&quot;hello 2s&quot;) &#125;) loc, _ := time.LoadLocation(&quot;Asia/Shanghai&quot;) const longForm = &quot;Jan 2, 2006 at 3:04pm (MST)&quot; const shortForm = &quot;2006-Jan-02&quot; t, _ := time.ParseInLocation(longForm, &quot;Jul 9, 2012 at 5:02am (CEST)&quot;, loc) fmt.Println(t) /** func ParseInLocation(layout, value string, loc *Location) (Time, error) */ t, _ = time.ParseInLocation(shortForm, &quot;2022-Jul-09&quot;, loc) fmt.Println(t) /** func Parse(layout, value string) (Time, error) è§£æä¸€ä¸ªæ ¼å¼åŒ–çš„æ—¶é—´å­—ç¬¦ä¸²å¹¶è¿”å›å®ƒä»£è¡¨çš„æ—¶é—´ ParseInLocationç±»ä¼¼Parseä½†æœ‰ä¸¤ä¸ªé‡è¦çš„ä¸åŒä¹‹å¤„ã€‚ ç¬¬ä¸€ï¼Œå½“ç¼ºå°‘æ—¶åŒºä¿¡æ¯æ—¶ï¼ŒParseå°†æ—¶é—´è§£é‡Šä¸ºUTCæ—¶é—´ï¼Œè€ŒParseInLocationå°†è¿”å›å€¼çš„Locationè®¾ç½®ä¸ºlocï¼› ç¬¬äºŒï¼Œå½“æ—¶é—´å­—ç¬¦ä¸²æä¾›äº†æ—¶åŒºåç§»é‡ä¿¡æ¯æ—¶ï¼ŒParseä¼šå°è¯•å»åŒ¹é…æœ¬åœ°æ—¶åŒºï¼Œè€ŒParseInLocationä¼šå»åŒ¹é…loc */ t, _ = time.Parse(longForm, &quot;Feb 3, 2023 at 7:54pm (PST)&quot;) fmt.Println(t) t, _ = time.Parse(shortForm, &quot;2020-Feb-03&quot;) fmt.Println(t) ch := make(chan int) timeout := time.After(time.Second * 2) timer := time.NewTimer(time.Second * 4) var i int go func() &#123; for &#123; // i++ select &#123; case &lt;- ch: fmt.Println(&quot;channel close&quot;) return case &lt;- timer.C: fmt.Println(&quot;4sçš„NewTimerå®šæ—¶ä»»åŠ¡&quot;) case &lt;- timeout: fmt.Println(&quot;4så®šæ—¶è¾“å‡º&quot;) case &lt;- time.After(time.Second * 6): fmt.Println(&quot;6såˆ°äº†&quot;) // default: // //Sleep 1ç§’ï¼Œå‚æ•°å°±æ˜¯ä¸Šé¢çš„Duration // time.Sleep(time.Second * 1) // fmt.Println(&quot;go 1s&quot;) &#125; &#125; &#125;() time.Sleep(time.Second * 15) fmt.Println(&quot;close----&quot;) close(ch) time.Sleep(time.Second * 2) &#125;","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"Laravelé…åˆMaatwebsiteExcelå®ç°Excelå¯¼å‡º","slug":"Laravel6é…åˆMaatwebsiteExcelå®ç°Excelå¯¼å‡º","date":"2020-08-31T04:43:01.000Z","updated":"2022-07-05T08:53:43.546Z","comments":true,"path":"2020/08/31/272/","link":"","permalink":"https://github.13sai.com/2020/08/31/272/","excerpt":"","text":"ç›¸æ¯”å¯¼å…¥ï¼Œé¡¹ç›®ä¸­å¯¼å‡ºåœºæ™¯æ›´å¤šï¼Œä¼°æ‘¸ç€ç°åœ¨æœ‰åå¤šä¸ªå¯¼å‡ºäº†ï¼Œä¹‹å‰å†™äº†å¯¼å…¥ï¼Œè¿™ä¼šæ‰æŠŠå¯¼å‡ºè¡¥ä¸Šã€‚ å®‰è£…ä¹‹å‰è¯´è¿‡ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹é…ç½®ï¼Œè™½ç„¶å·²æœ‰é»˜è®¤é…ç½®ï¼Œä½†è¿˜æ˜¯æœ‰ä¿®æ”¹é…ç½®çš„åœºæ™¯ï¼Œæ‰€ä»¥å»ºè®®ç”Ÿæˆé…ç½®æ–‡ä»¶ã€‚ é…ç½®//ç”Ÿæˆconfig/excel.php php artisan vendor:publish --provider=&quot;Maatwebsite\\Excel\\ExcelServiceProvider&quot; é…ç½®åªæä¸€ä¸ªï¼Œå…¶ä»–æ³¨é‡Šè›®ç»†çš„ï¼Œ &#x27;csv&#x27; =&gt; [ &#x27;delimiter&#x27; =&gt; &#x27;,&#x27;, &#x27;enclosure&#x27; =&gt; &#x27;&quot;&#x27;, &#x27;line_ending&#x27; =&gt; PHP_EOL, // å¯¼å‡ºcsvä¸­æ–‡ä¹±ç ï¼ŒæŠŠuse_bomè®¾ä¸ºtrueå³å¯ &#x27;use_bom&#x27; =&gt; true, &#x27;include_separator_line&#x27; =&gt; false, &#x27;excel_compatibility&#x27; =&gt; false, ], æ¥ä¸‹æ¥ï¼Œæ¥å®Œæˆä¸€ä¸ªå¯¼å‡ºçš„demoè¯´æ˜ä¸‹å¸¸ç”¨çš„ä¸€äº›ç‚¹ã€‚ DEMOphp artisan make:export MultiExport ç”Ÿæˆæ–‡ä»¶å¦‚ä¸‹ï¼š &lt;?php namespace App\\Exports; use Maatwebsite\\Excel\\Concerns\\FromCollection; class MultiExport implements FromCollection &#123; /** * @return \\Illuminate\\Support\\Collection */ public function collection() &#123; // &#125; &#125; è‡ªå®šä¹‰sheetï¼Œå¢åŠ  WithTitle è‡ªå®šä¹‰åˆ—åï¼Œå¢åŠ WithHeadings ä¸æƒ³ä½¿ç”¨Collectionï¼Œæ›¿æ¢FromCollectionä½¿ç”¨FromArray å¤šä¸ªsheetï¼Œæ›¿æ¢FromCollectionä½¿ç”¨WithMultipleSheets ç»è¿‡æ”¹é€ ï¼š &lt;?php /** * å¤šé‡å¯¼å‡º */ namespace App\\Exports; use App\\Exports\\MultiExportA; use App\\Exports\\MultiExportB; use Maatwebsite\\Excel\\Concerns\\WithMultipleSheets; class MultiExport implements WithMultipleSheets &#123; private $date; public function __construct($date) &#123; $this-&gt;date = $date; &#125; public function sheets(): array &#123; $sheets = []; $sheets[] = new MultiExportA($this-&gt;date); $sheets[] = new MultiExportB($this-&gt;date); return $sheets; &#125; &#125; --- // MultiExportAï¼ŒMultiExportBç±»æ¯”å³å¯ &lt;?php namespace App\\Exports; use Maatwebsite\\Excel\\Concerns\\FromArray; use Maatwebsite\\Excel\\Concerns\\WithHeadings; use Maatwebsite\\Excel\\Concerns\\WithTitle; use App\\Models\\ExportA; class MultiExportA implements FromArray, WithTitle, WithHeadings &#123; private $date; public function __construct($date, $cityId) &#123; $this-&gt;date = $date; &#125; public function headings(): array &#123; return [ &#x27;ID&#x27;, &#x27;åç§°&#x27;, &#x27;ä»·æ ¼&#x27;, &#x27;æ‰‹æœº&#x27; ]; &#125; /** * @return array */ public function array() : array &#123; $data = ExportA::where(&#x27;date&#x27;, $this-&gt;date) -&gt;get() -&gt;toArray(); $ret = []; foreach ($data as $val) &#123; // ä¸€æ®µç¥å¥‡çš„ä»£ç è®¡ç®—å‡ºäº†ä»·æ ¼ $price = ...; $ret[] = [ &#x27;id&#x27; =&gt; $val[&#x27;id&#x27;].&quot;\\t&quot;, &#x27;name&#x27; =&gt; $val[&#x27;name&#x27;], &#x27;price&#x27; =&gt; $price, // è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œç¼–ç excelä½¿ç”¨äº†ç§‘å­¦è®¡æ•°æ³• &#x27;mobile&#x27; =&gt; $val[&#x27;mobile&#x27;].&quot;\\t&quot;, ]; &#125; return $ret; &#125; /** * @return string */ public function title(): string &#123; return &#x27;è¡¨æ ¼A&#x27;; &#125; &#125; ä½¿ç”¨ // ä¿å­˜ $obj = new MultiExport($date); Excel::store($obj, &#x27;MultiExport&#x27;.$date.&#x27;.xlsx&#x27;); // ä¸‹è½½csv Excel::download($obj, &#x27;MultiExport&#x27;.$date.&#x27;.csv&#x27;, \\Maatwebsite\\Excel\\Excel::CSV, [&#x27;Content-Type&#x27; =&gt; &#x27;text/csv&#x27;]); é—®é¢˜æ€è€ƒå½“æ•°æ®é‡è¿‡å¤§çš„æ—¶å€™ï¼Œå¯¼å‡ºæ—¶å¾ˆå¯èƒ½ä¼šå†…å­˜æº¢å‡ºäº†ã€‚å»ºè®®ï¼š ä½¿ç”¨å…¶ä»–é«˜æ€§èƒ½çš„ç»„ä»¶ï¼Œæˆ–è€…ä½¿ç”¨åŸç”Ÿä»£ç æµå¼è¾“å‡ºåˆ°æµè§ˆå™¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å…¶ä»–è¯­è¨€ï¼ˆæ¯”å¦‚goï¼‰ç¼–å†™ æ–‡ä»¶è¿‡å¤§ï¼ŒExcelæ‰“å¼€å¤§æ•°æ®é‡æ–‡ä»¶ä¹Ÿå¾ˆé¸¡è‚‹ï¼Œå®¹æ˜“å¡æ­»ç”šè‡³å´©æºƒï¼Œå°è¯•åˆ†æ–‡ä»¶å¯¼å‡ºï¼Œæ¯”å¦‚1wä¸€ä¸ªæ–‡ä»¶ éƒ¨åˆ†å¯¼å‡ºè¿‡ç¨‹å¯èƒ½æœ‰è®¡ç®—ï¼Œå¯ä»¥æå‰è®¡ç®—å¥½ï¼Œå¯¼å‡ºæ—¶ç›´æ¥è¯»è¡¨ï¼Œä½¿ç”¨LazyCollectionï¼Œ ä½¿ç”¨ Lazy Collections æ¥æé«˜ Laravel Excel è¯»å–çš„æ€§èƒ½ï¼ˆè½»æ¾æ”¯æŒç™¾ä¸‡æ•°æ®ï¼‰","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"}]},{"title":"Laravelå¸¸ç”¨ä»£ç åˆé›†","slug":"Laravelå¸¸ç”¨ä»£ç åˆé›†","date":"2020-08-30T12:40:13.000Z","updated":"2022-07-05T08:53:34.608Z","comments":true,"path":"2020/08/30/270/","link":"","permalink":"https://github.13sai.com/2020/08/30/270/","excerpt":"","text":"ç”¨Laravelä¹Ÿæœ‰ä¸çŸ­çš„æ—¶é—´äº†ï¼Œä¹Ÿç”¨è¿‡ä¸å°‘ç‰ˆæœ¬äº†ï¼Œä»¥ä¸‹ä»£ç æ˜¯åœ¨æ—¥å¸¸é¡¹ç›®ä¸­æ”¶é›†ï¼Œä½œä¸ºç¬”è®°ï¼Œä¹Ÿåˆ†äº«å‡ºæ¥ï¼Œå¸Œæœ›å¯¹ä½ æœ‰ç‚¹ç”¨å¤„ã€‚æ³¨ï¼šç‰ˆæœ¬æ²¡æ ‡æ³¨ï¼Œè‹¥æœ‰ä¸å…¼å®¹çš„é—®é¢˜ï¼Œå¾®è°ƒå³å¯ã€‚ éªŒè¯ä¸å¤ªä¹ æƒ¯å•ç‹¬å¼„ä¸ªRequestéªŒè¯ç±»ï¼Œæ¯”è¾ƒä¹ æƒ¯ä¸‹é¢çš„å†™æ³•ï¼š use Illuminate\\Http\\Request; use Illuminate\\Support\\Facades\\Validator; $inputData = $request-&gt;only([&#x27;name&#x27;, &#x27;address&#x27;, &#x27;mobile&#x27;, &#x27;draw_id&#x27;]); $messages = [ &#x27;required&#x27;=&gt;&#x27;:attributeä¸ºå¿…å¡«é¡¹&#x27;, &#x27;int&#x27;=&gt;&#x27;:attributeå‚æ•°ç±»å‹é”™è¯¯&#x27;, &#x27;max&#x27;=&gt;&#x27;:attributeé•¿åº¦ä¸å¾—è¶…è¿‡ :size&#x27;, ]; $validator = Validator::make($inputData, [ &#x27;draw_id&#x27; =&gt; &#x27;required|int&#x27;, &#x27;name&#x27; =&gt; &#x27;required&#x27;, &#x27;mobile&#x27; =&gt; &#x27;required&#x27;, &#x27;address&#x27; =&gt; &#x27;required&#x27;, ], $messages,[ &#x27;name&#x27;=&gt;&#x27;æ”¶è´§äººå§“å&#x27;, &#x27;mobile&#x27;=&gt;&#x27;æ‰‹æœºå·ç &#x27;, &#x27;address&#x27;=&gt;&#x27;æ”¶è´§åœ°å€&#x27;, ]); if ($validator-&gt;fails()) &#123; return self::response([], current($validator-&gt;errors()-&gt;all()), 2); &#125; ORMå…³è”æŸ¥è¯¢ ä¸€å¯¹ä¸€ // Modelå®šä¹‰ï¼Œå…³è”å¤–é”® class User extends Model &#123; ... public function userIntegral() &#123; return $this-&gt;hasOne(&#x27;App\\Models\\UserIntegral&#x27;, &#x27;user_id&#x27;, &#x27;id&#x27;); &#125; &#125; // ä½¿ç”¨withæŸ¥è¯¢ (new User())-&gt;with(&#x27;userIntegral&#x27;)-&gt;orderBy(&#x27;id&#x27;, &#x27;desc&#x27;)-&gt;paginate($limit); ä¸€å¯¹å¤š //Model namespace App\\Models; use Illuminate\\Database\\Eloquent\\Model; class Hotel extends Model &#123; public function orders() &#123; return $this-&gt;hasMany(&#x27;App\\Models\\Order&#x27;); &#125; &#125; //ä½¿ç”¨ï¼Œæ¯”å¦‚æŸ¥è¯¢æŸä¸ªHotelä¸‹status=30çš„Order $hotel = Hotel::with([&#x27;orders&#x27; =&gt; function ($query) &#123; $query-&gt;where(&#x27;status&#x27;, 30); &#125;])-&gt;find(4); ç»Ÿä¸€å¼‚å¸¸å¤„ç†è¿™ä¸ªå¯ä»¥å‚è§ä¹‹å‰çš„æ–‡ç« Laravel ç»Ÿä¸€é”™è¯¯å¤„ç†ä¸º JSON é˜Ÿåˆ—å¤±è´¥é˜Ÿåˆ—å…¥åº“ ç”Ÿæˆè¡¨ç”Ÿæˆfailed_jobsè¡¨ php artisan queue:failed-table php artisan migrate å•ç‹¬å¤„ç† å¯ä»¥åœ¨Jobä¸­å•ç‹¬å¤„ç†å¤±è´¥ï¼ŒJobå¤±è´¥ä¹Ÿä¼šå†™å…¥ä¸Šé¢ç”Ÿæˆçš„failed_jobsè¡¨ /** * ä»»åŠ¡å¤±è´¥çš„å¤„ç†è¿‡ç¨‹ * * @param Exception $exception * [@return](https://learnku.com/users/31554) void */ public function failed(Exception $exception) &#123; // å¤„ç† &#125; é‡è¯•é˜Ÿåˆ—æœ‰æ—¶å€™ä»£ç æœ‰æ¼æ´å¯èƒ½ä¼šæœ‰é˜Ÿåˆ—æ‰§è¡Œå¤±è´¥çš„çŠ¶å†µï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦é‡è¯•ã€‚ æŸ¥çœ‹æ‰€æœ‰å¤±è´¥php artisan queue:failed é‡è¯•æ‰€æœ‰å¤±è´¥php artisan queue:retry all é‡è¯•å•ä¸ªå¤±è´¥php artisan queue:retry 13 æ¸…ç©ºå¤±è´¥ï¼ˆé‡è¦çš„é˜Ÿåˆ—æ•°æ®ä¸‡ä¸å¯è¿™ä¹ˆæ“ä½œï¼‰php artisan queue:flush å¦å¤–ï¼Œæ‰‹åŠ¨å»æ“ä½œç¡®å®ä¸å¤ªæ–¹ä¾¿ï¼Œä½ å¯ä»¥è®¾ç½®ä¸ªcronï¼Œå®šæ—¶é‡è¯•æ‰€æœ‰å¤±è´¥ï¼Œä½†åŠ¡å¿…è¦æ³¨æ„æ¶ˆæ¯æé†’ï¼Œä»¥å…é˜Ÿåˆ—ä¸€ç›´é‡è¯•ä¸€ç›´å¤±è´¥ï¼Œå¾€å¤è¿è¡Œï¼Œå½±å“äº†æ­£å¸¸çš„é˜Ÿåˆ—æ€§èƒ½ã€‚ å…¶ä»–å¸¸ç”¨ä»£ç æ–‡ä»¶ä¸Šä¼ OSS&lt;?php namespace App\\Http\\Controllers; use Illuminate\\Http\\Request; use Controller; use Illuminate\\Support\\Facades\\Storage; use Illuminate\\Support\\Facades\\Validator; use OSS\\OssClient; use OSS\\Core\\OssException; class UploadController extends Controller &#123; public function index(Request $request) &#123; $file = $request-&gt;file(&#x27;file&#x27;); if ($file-&gt;isValid()) &#123; $ext = $file-&gt;getClientOriginalExtension(); $realPath = $file-&gt;getRealPath(); $filepath = config(&#x27;app.env&#x27;).&#x27;/&#x27; . md5(uniqid(&#x27;&#x27;, true)); $result = $this-&gt;uploadOss($realPath, $filepath.&quot;.&quot;.$ext); if ($result[&#x27;code&#x27;]) &#123; return response([&#x27;code&#x27; =&gt; 2, &#x27;msg&#x27; =&gt; $result[&#x27;msg&#x27;]]); &#125; else &#123; return response([&#x27;code&#x27; =&gt; 0, &#x27;msg&#x27; =&gt; &#x27;ä¸Šä¼ æˆåŠŸ&#x27;, &#x27;data&#x27; =&gt; [ &#x27;filepath&#x27; =&gt; $result[&#x27;data&#x27;][&#x27;url&#x27;], &#x27;data&#x27; =&gt; $request-&gt;all() ]]); &#125; &#125; &#125; /** * ä¸Šä¼ oss * @param $filePath å½“å‰è·¯å¾„ * @param $object é¢„å®šä¹‰æ–‡ä»¶åï¼Œå¯å«æ–‡ä»¶å¤¹ * [@return](https://learnku.com/users/31554) array */ public function uploadOss($filePath, $object) &#123; $accessKeyId = config(&#x27;filesystems.disks&#x27;)[config(&#x27;filesystems.default&#x27;)][&#x27;access_key&#x27;]; $accessKeySecret = config(&#x27;filesystems.disks&#x27;)[config(&#x27;filesystems.default&#x27;)][&#x27;secret_key&#x27;]; $endpoint = config(&#x27;filesystems.disks&#x27;)[config(&#x27;filesystems.default&#x27;)][&#x27;endpoint&#x27;]; $bucket= config(&#x27;filesystems.disks&#x27;)[config(&#x27;filesystems.default&#x27;)][&#x27;bucket&#x27;]; $url = config(&#x27;filesystems.disks&#x27;)[config(&#x27;filesystems.default&#x27;)][&#x27;host&#x27;]; try&#123; $ossClient = new OssClient($accessKeyId, $accessKeySecret, $endpoint); $ossClient-&gt;uploadFile($bucket, $object, $filePath); return [ &#x27;code&#x27; =&gt; 0, &#x27;data&#x27; =&gt; [ &#x27;url&#x27; =&gt; $url.&#x27;/&#x27;.$object ] ]; &#125; catch(OssException $e) &#123; return [ &#x27;code&#x27; =&gt; 1, &#x27;msg&#x27; =&gt; $e-&gt;getMessage() ]; &#125; &#125; &#125; // ------- // é…ç½® &#x27;oss&#x27; =&gt; [ &#x27;driver&#x27; =&gt; &#x27;oss&#x27;, &#x27;root&#x27; =&gt; &#x27;&#x27;, &#x27;access_key&#x27; =&gt; env(&#x27;OSS_ACCESS_KEY&#x27;), &#x27;secret_key&#x27; =&gt; env(&#x27;OSS_SECRET_KEY&#x27;), &#x27;endpoint&#x27; =&gt; env(&#x27;OSS_ENDPOINT&#x27;), // ä½¿ç”¨ ssl è¿™é‡Œè®¾ç½®å¦‚: https://oss-cn-beijing.aliyuncs.com &#x27;bucket&#x27; =&gt; env(&#x27;OSS_BUCKET&#x27;), &#x27;isCName&#x27; =&gt; env(&#x27;OSS_IS_CNAME&#x27;, false), // å¦‚æœ isCname ä¸º falseï¼Œendpoint åº”é…ç½® oss æä¾›çš„åŸŸåå¦‚ï¼š`oss-cn-beijing.aliyuncs.com`ï¼Œå¦åˆ™ä¸ºè‡ªå®šä¹‰åŸŸåï¼Œï¼Œcname æˆ– cdn è¯·è‡ªè¡Œåˆ°é˜¿é‡Œ oss åå°é…ç½®å¹¶ç»‘å®š bucket &#x27;host&#x27; =&gt; env(&#x27;OSS_HOST&#x27;, &#x27;&#x27;) ], jsonè¾“å‡ºprotected static $code = 0; protected static $msg = &#x27;ok&#x27;; public function response($data = [], $msg = &#x27;&#x27;, $code = 0) &#123; if (is_null($data)) &#123; $data = new \\stdClass(); &#125; return response()-&gt;json([ &#x27;code&#x27; =&gt; $code? $code : self::$code, &#x27;msg&#x27; =&gt; $msg? $msg : self::$msg, &#x27;data&#x27; =&gt; $data, ], 200); &#125; è¿›ç¨‹é” æ™®é€šç‰ˆæœ¬ // $autoDelå­—æ®µåˆ é™¤ï¼Œ$ttl è¿‡æœŸæ—¶é—´ï¼Œç§’ public function processLock($key, $autoDel = true, $ttl = 60) &#123; $key = &#x27;processLock:&#x27;.$key; // ä¸åŒç‰ˆæœ¬æˆ–redisæ‰©å±•ï¼Œä¼šæœ‰ç•¥å¾®ä¸åŒï¼Œè‡ªè¡Œè°ƒæ•´ä¸‹ä»£ç å³å¯ if (Redis::Command(&#x27;set&#x27;, [$key, 1, &#x27;EX&#x27;, $ttl, &#x27;NX&#x27;])) &#123; if ($autoDel) &#123; register_shutdown_function(function () use ($key) &#123; Redis::del($key); &#125;); &#125; return true; &#125; return false; &#125; luaç‰ˆæœ¬ public function getScript() &#123; return &lt;&lt;&lt;LUA local ret = redis.call(&quot;setnx&quot;, KEYS[1], ARGV[1]) if ret == 1 then return redis.call(&quot;expire&quot;, KEYS[1], ARGV[2]) else return 0 end LUA; &#125; public function processLock($key, $autoDel = true, $ttl = 60) &#123; if (Redis::eval($this-&gt;getScript(), 1, $key, 1, $ttl)) &#123; if ($autoDel) &#123; register_shutdown_function(function () use ($key) &#123; Redis::del($key); &#125;); &#125; &#125; return false; &#125; è¯´æ˜ï¼šRedis::evalè¡Œç¬¬ä¸€ä¸ª1è¡¨ç¤ºkeyçš„æ•°é‡ï¼Œæ˜¯ä¸ºäº†åŒºåˆ†KEYSå’ŒARGVã€‚ JWTLaravel é…åˆ jwt ä½¿ç”¨ ç³»ç»Ÿé€šçŸ¥åˆ°é’‰é’‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é˜Ÿåˆ—ï¼ŒæŠŠä¸€äº›é‡è¦çš„é€šçŸ¥æŠ•åˆ°é’‰é’‰ï¼Œä¸»è¦ä»£ç å¦‚ä¸‹ï¼š &lt;?php namespace App\\Jobs; use Illuminate\\Bus\\Queueable; use Illuminate\\Contracts\\Queue\\ShouldQueue; use Illuminate\\Foundation\\Bus\\Dispatchable; use Illuminate\\Queue\\InteractsWithQueue; use Illuminate\\Queue\\SerializesModels; use Illuminate\\Support\\Facades\\Log; use GuzzleHttp\\Client; class SystemNotify implements ShouldQueue &#123; use Dispatchable, InteractsWithQueue, Queueable, SerializesModels; private $title; private $content; private $type; private $robot; const DD_URL = &#x27;https://oapi.dingtalk.com&#x27;; /** * Create a new job instance. * * @param $title * @param string $content * @param string $type text, markdown * @param int $robot */ public function __construct($title, $content = &#x27;&#x27;, $type = &#x27;markdown&#x27;, $robot = 1) &#123; // å•ç‹¬ä½¿ç”¨SystemNotifyé˜Ÿåˆ— $this-&gt;queue = &#x27;SystemNotify&#x27;; $this-&gt;title = $title; $this-&gt;content = $content; $this-&gt;type = $type; $this-&gt;robot = $robot; &#125; /** * Execute the job. * * @return void */ public function handle() &#123; // å¯ä»¥ä¸ä½¿ç”¨å…³é”®å­—ï¼Œå»ºè®®é’‰é’‰æœºå™¨äººä½¿ç”¨IPæ®µè®¾ç½®ï¼Œæ›´ä¸ºå®‰å…¨ switch ($this-&gt;type)&#123; case &#x27;markdown&#x27;: $params = [ &#x27;msgtype&#x27; =&gt; $this-&gt;type, $this-&gt;type =&gt; [ &#x27;title&#x27; =&gt; $this-&gt;title.&#x27;[å…³é”®å­—]&#x27;, &#x27;text&#x27; =&gt; $this-&gt;content ] ]; break; default: $params = [ &#x27;msgtype&#x27; =&gt; $this-&gt;type, $this-&gt;type =&gt; [ &#x27;content&#x27; =&gt; $this-&gt;content.&#x27;[å…³é”®å­—]&#x27;, ] ]; break; &#125; $params = json_encode($params, JSON_UNESCAPED_UNICODE); $uri = self::URL_MAPPING[$this-&gt;robot]; $this-&gt;getClient()-&gt;request(&#x27;POST&#x27;, $uri, [ &#x27;headers&#x27; =&gt; [ &#x27;Content-Type&#x27; =&gt; &#x27;application/json;charset=utf-8&#x27; ], &#x27;body&#x27; =&gt; $params ]); &#125; // å¯¹åº”ä¸åŒçš„é’‰é’‰ç¾¤é€šçŸ¥ï¼Œä¿®æ”¹access_tokenå‚æ•°å³å¯ const URL_MAPPING = [ 1 =&gt; &#x27;/robot/send?access_token=@1&#x27;, 2 =&gt; &#x27;/robot/send?access_token=@2&#x27; ]; public function getClient() &#123; return new Client([ &#x27;base_uri&#x27; =&gt; &#x27;https://oapi.dingtalk.com&#x27;, &#x27;timeout&#x27; =&gt; 30, &#x27;verify&#x27; =&gt; false ]); &#125; &#125; è¯´æ˜ï¼šé€šçŸ¥å†…å®¹å¯ä»¥è‡ªå®šä¹‰ï¼Œæ·»åŠ æ™ºèƒ½æœºå™¨äººæ“ä½œæ¯”è¾ƒç®€å•å°±ä¸èµ˜è¿°äº† é’‰é’‰æ–‡æ¡£ åå°æ“ä½œæ—¥å¿—åˆ©ç”¨ Laravel ä¸­é—´ä»¶ç»™åå°åŠ ä¸ªæ“ä½œæ—¥å¿— ExcelLaravel6 é…åˆ Maatwebsite\\Excel å®ç° Excel å¯¼å…¥ Laravel6 é…åˆ Maatwebsite\\Excel å®ç° Excel å¯¼å‡º é™†ç»­è¡¥å……ä¸­â€¦","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"}]},{"title":"æœ€è¿‘ä½¿ç”¨ginçš„æ€»ç»“","slug":"æœ€è¿‘ä½¿ç”¨ginçš„æ€»ç»“","date":"2020-07-20T03:19:09.000Z","updated":"2022-03-19T14:35:21.925Z","comments":true,"path":"2020/07/20/261/","link":"","permalink":"https://github.13sai.com/2020/07/20/261/","excerpt":"","text":"æœ€è¿‘æœ‰æ–°é¡¹ç›®æ˜¯åˆ©ç”¨ginå¼€å‘çš„ï¼Œè¿‡ç¨‹ä¸­é‡åˆ°ä¸€äº›é—®é¢˜ï¼Œæ€»ç»“ä¸€ä¸‹ï¼Œä½œä¸ºç¬”è®°ï¼Œä¹Ÿå¸Œæœ›èƒ½å¸®åŠ©åˆ°ä½ ã€‚ è·¨åŸŸé—®é¢˜ä¸­é—´ä»¶ï¼š func Cors() gin.HandlerFunc &#123; return func(c *gin.Context) &#123; // è¿™é‡Œå¯ä»¥ç”¨*ï¼Œä¹Ÿå¯ä»¥ç”¨ä½ æŒ‡å®šçš„åŸŸå c.Header(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;) // å…è®¸å¤´éƒ¨å‚æ•° c.Header(&quot;Access-Control-Allow-Headers&quot;, &quot;Content-Type,AccessToken,X-CSRF-Token, Authorization, Token&quot;) // å…è®¸çš„æ–¹æ³• c.Header(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, GET, OPTIONS&quot;) c.Header(&quot;Access-Control-Expose-Headers&quot;, &quot;Content-Length, Access-Control-Allow-Origin, Access-Control-Allow-Headers, Content-Type&quot;) c.Header(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;) method := c.Request.Method //æ”¾è¡ŒOPTIONSæ–¹æ³• if method == &quot;OPTIONS&quot; &#123; c.AbortWithStatus(http.StatusOK) &#125; // å¤„ç†è¯·æ±‚ c.Next() &#125; &#125; ç„¶ååœ¨è·¯ç”±ä¸­åŠ å…¥ï¼š // g : *gin.Engine g.Use(Cors()) å½“ç„¶ä¹Ÿå¯ä»¥åœ¨Nginxå±‚é…ç½®ï¼Œå¯è‡ªè¡ŒæŸ¥é˜…ï¼Œæˆ‘å°±ä¸å±•å¼€äº†ã€‚ ä½¿ç”¨å¤šä¸ªä¸­é—´ä»¶// g : *gin.Engine g.Use(Cors()) g.Use(Session()) ä¸­é—´ä»¶ç»ˆæ­¢è¯·æ±‚func Auth() gin.HandlerFunc &#123; return func(c *gin.Context) &#123; uid := c.MustGet(&quot;uid&quot;).(int) if uid == 0 &#123; c.Abort() controller.SendResponse(c, 401, &quot;æœªç™»å½•&quot;, nil) // returnå¯å¿½ç•¥ return &#125; else &#123; c.Next() &#125; &#125; &#125; sessionä½¿ç”¨package util import ( &quot;github.com/gin-gonic/gin&quot; &quot;github.com/gin-contrib/sessions&quot; &quot;github.com/gin-contrib/sessions/redis&quot; redisGo &quot;github.com/gomodule/redigo/redis&quot; &quot;github.com/spf13/viper&quot; ) // å¯åŠ¨session func SessionStart(g *gin.Engine, RedisClient *redisGo.Pool, key ...[]byte) &#123; store, _ := redis.NewStoreWithPool(RedisClient, []byte(viper.GetString(&quot;name&quot;))) redis.SetKeyPrefix(store, &quot;session_&quot;) g.Use(sessions.Sessions(viper.GetString(&quot;name&quot;), store)) &#125; // ä½¿ç”¨session session := sessions.Default(c) session.Set(&quot;uid&quot;, uid) uid := session.Get(&quot;uid&quot;) ä¸Šä¼ ossimport ( &quot;os&quot; &quot;github.com/aliyun/aliyun-oss-go-sdk/oss&quot; &quot;github.com/spf13/viper&quot; ) func upload(localPath string, iType int, Name string) (path string) &#123; client, err := oss.New(viper.GetString(&quot;oss.end_point&quot;), viper.GetString(&quot;oss.access_key_id&quot;), viper.GetString(&quot;oss.access_key_secret&quot;)) if err != nil &#123; return &#125; // è·å–å­˜å‚¨ç©ºé—´ã€‚ bucket, err := client.Bucket(viper.GetString(&quot;oss.bucket&quot;)) if err != nil &#123; return &#125; // ä¸Šä¼ æœ¬åœ°æ–‡ä»¶ã€‚ ossPath := fmt.Sprintf(&quot;%s/%s&quot;, &quot;qiling&quot;, Name) err = bucket.PutObjectFromFile(ossPath, localPath) if err != nil &#123; return &#125; path = fmt.Sprintf(&quot;%s/%s&quot;, viper.GetString(&quot;oss.hosts&quot;), ossPath) os.Remove(localPath) return &#125; å‡ ä¸ªå®ç”¨çš„æ–¹æ³•import ( &quot;fmt&quot; &quot;crypto/md5&quot; &quot;bytes&quot; &quot;regexp&quot; ) // md5 func Md5(str string) string &#123; return fmt.Sprintf(&quot;%x&quot;, md5.Sum([]byte(str))); &#125; // åˆ¤æ–­æ˜¯ä¸æ˜¯çœŸå®æ‰‹æœºå·ç  func IsMobile(mobile string) bool &#123; result, _ := regexp.MatchString(`^(1\\d&#123;10&#125;)$`, mobile) if result &#123; return true &#125; else &#123; return false &#125; &#125; // åˆå¹¶å­—ç¬¦ä¸² func StrCombine(str ...string) string &#123; var bt bytes.Buffer for _, arg := range str &#123; bt.WriteString(arg) &#125; //è·å¾—æ‹¼æ¥åçš„å­—ç¬¦ä¸² return bt.String() &#125; å¤§æ¦‚å°±è¿™äº›äº†ï¼Œåé¢æœ‰å¯ä»¥åˆ†æçš„å†è¡¥å……ã€‚","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"gin","slug":"gin","permalink":"https://github.13sai.com/tags/gin/"}]},{"title":"ä½¿ç”¨vue-element-adminçš„ä¸€äº›æ€»ç»“","slug":"ä½¿ç”¨vue-element-adminçš„ä¸€äº›æ€»ç»“","date":"2020-07-14T03:28:52.000Z","updated":"2022-03-19T14:35:21.855Z","comments":true,"path":"2020/07/14/262/","link":"","permalink":"https://github.13sai.com/2020/07/14/262/","excerpt":"","text":"æœ€è¿‘å¼€å‘çš„é¡¹ç›®åå°åŸºäºvue-element-adminå¼€å‘ï¼Œåœ¨é€æ­¥å®Œå–„çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œç‰¹æ­¤æ€»ç»“ï¼Œå¸Œæœ›èƒ½å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚ å…ˆä¸Šé“¾æ¥ï¼ŒçœŸçš„å¾ˆå¥½ç”¨ï¼Œå®‰åˆ©ä¸€ä¸‹ï¼Œé“¾æ¥å¦‚ä¸‹ï¼š A magical vue admin åŸºæœ¬ä¸Šå¸¸ç”¨çš„ä¸å¸¸ç”¨çš„åŠŸèƒ½éƒ½æœ‰ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œæœ‰å…´è¶£é“¾æ¥ç›´è¾¾ï¼Œæ­£å¼å¼€å§‹æ­£æ–‡ã€‚ ä¿®æ”¹èœå•å›¾æ ‡ä¸ºelementUIå›¾æ ‡å®˜æ–¹çš„svgå›¾æ ‡ç¡®å®æ¯”è¾ƒå°‘ï¼Œæ·»åŠ æˆ‘ä¹Ÿè§‰å¾—ç¹çï¼Œå¦å¤–ï¼Œæ—¢ç„¶é›†æˆäº†elementUIï¼Œç›´æ¥ç”¨elementUIå›¾æ ‡å°±å¥½äº†ã€‚ æ”¹ï¼š ä¿®æ”¹èœå•iconä¸ºelementUIå›¾æ ‡ï¼š // æ–‡ä»¶åœ°å€ï¼šsrc\\layout\\components\\Sidebar\\Item.vue // if (icon) &#123; // vnodes.push(&lt;svg-icon icon-class=&#123;icon&#125;/&gt;) // &#125; if (icon) &#123; vnodes.push(&lt;i class=&#123;icon&#125;&gt;&lt;/i&gt;) &#125; å…³é—­eslintå®˜ç½‘å·²æœ‰ç­”æ¡ˆ // vue.config.js lintOnSave: false butï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯gitç®¡ç†ä»£ç ï¼Œä¼šå‘ç°commitçš„æ—¶å€™ä¾æ—§ä¼šè§¦å‘eslintã€‚ // package.json &quot;lint-staged&quot;: &#123; &quot;src/**/*.&#123;js,vue&#125;&quot;: [ &quot;eslint --fix&quot;, // åˆ é™¤è¿™ä¸€è¡Œ &quot;git add&quot; ] &#125;, å¢åŠ æœ¬åœ°ç¯å¢ƒå˜é‡// package.json &quot;scripts&quot;: &#123; &quot;local&quot;: &quot;vue-cli-service serve --mode local&quot;, ... &#125;, å¤åˆ¶.env.productionä¸º.env.localï¼Œè‡ªå®šä¹‰é…ç½®åï¼Œè¿è¡Œï¼š yarn run local ç¼“å­˜é¡µé¢æƒ³ç¼“å­˜çš„é¡µé¢ï¼š &lt;script&gt; export default &#123; name: &quot;cacheIndex&quot;, åŠ å…¥cachedViews // src\\store\\modules\\tagsView.js const state = &#123; visitedViews: [], cachedViews: [ &#x27;cacheIndex&#x27; ] &#125; æœ€è¿‘å¼€å‘çš„é¡¹ç›®åå°åŸºäºvue-element-adminå¼€å‘ï¼Œåœ¨é€æ­¥å®Œå–„çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œç‰¹æ­¤æ€»ç»“ï¼Œå¸Œæœ›èƒ½å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚ å…ˆä¸Šé“¾æ¥ï¼ŒçœŸçš„å¾ˆå¥½ç”¨ï¼Œå®‰åˆ©ä¸€ä¸‹ï¼Œé“¾æ¥å¦‚ä¸‹ï¼š A magical vue admin åŸºæœ¬ä¸Šå¸¸ç”¨çš„ä¸å¸¸ç”¨çš„åŠŸèƒ½éƒ½æœ‰ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œæœ‰å…´è¶£é“¾æ¥ç›´è¾¾ï¼Œæ­£å¼å¼€å§‹æ­£æ–‡ã€‚ ä¿®æ”¹èœå•å›¾æ ‡ä¸ºelementUIå›¾æ ‡å®˜æ–¹çš„svgå›¾æ ‡ç¡®å®æ¯”è¾ƒå°‘ï¼Œæ·»åŠ æˆ‘ä¹Ÿè§‰å¾—ç¹çï¼Œå¦å¤–ï¼Œæ—¢ç„¶é›†æˆäº†elementUIï¼Œç›´æ¥ç”¨elementUIå›¾æ ‡å°±å¥½äº†ã€‚ æ”¹ï¼š ä¿®æ”¹èœå•iconä¸ºelementUIå›¾æ ‡ï¼š // æ–‡ä»¶åœ°å€ï¼šsrc\\layout\\components\\Sidebar\\Item.vue // if (icon) &#123; // vnodes.push(&lt;svg-icon icon-class=&#123;icon&#125;/&gt;) // &#125; if (icon) &#123; vnodes.push(&lt;i class=&#123;icon&#125;&gt;&lt;/i&gt;) &#125; å…³é—­eslintå®˜ç½‘å·²æœ‰ç­”æ¡ˆ // vue.config.js lintOnSave: false butï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯gitç®¡ç†ä»£ç ï¼Œä¼šå‘ç°commitçš„æ—¶å€™ä¾æ—§ä¼šè§¦å‘eslintã€‚ // package.json &quot;lint-staged&quot;: &#123; &quot;src/**/*.&#123;js,vue&#125;&quot;: [ &quot;eslint --fix&quot;, // åˆ é™¤è¿™ä¸€è¡Œ &quot;git add&quot; ] &#125;, å¢åŠ æœ¬åœ°ç¯å¢ƒå˜é‡// package.json &quot;scripts&quot;: &#123; &quot;local&quot;: &quot;vue-cli-service serve --mode local&quot;, ... &#125;, å¤åˆ¶.env.productionä¸º.env.localï¼Œè‡ªå®šä¹‰é…ç½®åï¼Œè¿è¡Œï¼š yarn run local ç¼“å­˜é¡µé¢æƒ³ç¼“å­˜çš„é¡µé¢ï¼š &lt;script&gt; export default &#123; name: &quot;cacheIndex&quot;, åŠ å…¥cachedViews // src\\store\\modules\\tagsView.js const state = &#123; visitedViews: [], cachedViews: [ &#x27;cacheIndex&#x27; ] &#125;","categories":[{"name":"vue","slug":"vue","permalink":"https://github.13sai.com/categories/vue/"}],"tags":[{"name":"ElementUI","slug":"ElementUI","permalink":"https://github.13sai.com/tags/ElementUI/"}]},{"title":"PHPçš„æ„æˆå’Œç”Ÿå‘½å‘¨æœŸ","slug":"PHPçš„æ„æˆå’Œç”Ÿå‘½å‘¨æœŸ","date":"2020-06-03T08:05:37.000Z","updated":"2022-03-19T14:35:21.632Z","comments":true,"path":"2020/06/03/253/","link":"","permalink":"https://github.13sai.com/2020/06/03/253/","excerpt":"","text":"PHPçš„æºç æ„æˆ SAPIï¼ˆPHPçš„åº”ç”¨æ¥å£å±‚ï¼‰ mainï¼ˆä¸»è¦ä»£ç ï¼Œè¾“å…¥/è¾“å‡ºï¼Œwebé€šä¿¡ä»¥åŠPHPæ¡†æ¶çš„åˆå§‹åŒ–æ“ä½œç­‰ï¼‰ ZendVMï¼ˆPHPè§£æå™¨çš„ä¸»è¦å®ç°ï¼Œä»£ç çš„è§£é‡Šå’Œæ‰§è¡Œï¼Œæ ¸å¿ƒéƒ¨åˆ†ï¼‰ Extensionï¼ˆå¯åˆ†ä¸ºPHPå’ŒZendæ‰©å±•ï¼‰ ç”Ÿå‘½å‘¨æœŸ æ¨¡å—åˆå§‹åŒ–ï¼ˆPHPæ¡†æ¶ï¼ŒZendå¼•æ“çš„åˆå§‹åŒ–æ“ä½œï¼‰ è¯·æ±‚åˆå§‹åŒ–ï¼ˆå¯¹äºFPMè€Œè¨€ï¼Œæ˜¯åœ¨workerè¿›ç¨‹acceptä¸€ä¸ªè¯·æ±‚å¹¶è¯»å–/è§£æå®Œè¯·æ±‚æ•°æ®åçš„ä¸€ä¸ªé˜¶æ®µï¼‰ æ‰§è¡Œè„šæœ¬é˜¶æ®µï¼ˆPHPä»£ç çš„ç¼–è¯‘ã€æ‰§è¡Œï¼ŒPHPè„šæœ¬ç»å†ä»æºä»£ç åˆ°æŠ½è±¡è¯­æ³•æ ‘å†åˆ°oplineæŒ‡ä»¤ï¼ŒoplineæŒ‡ä»¤ä¹Ÿå°±æ˜¯Zendå¼•æ“å¯è¯†åˆ«çš„æ‰§è¡ŒæŒ‡ä»¤ï¼‰ è¯·æ±‚å…³é—­é˜¶æ®µï¼ˆflushè¾“å‡ºå†…å®¹ï¼Œå‘é€HTTPåº”ç­”headerå¤´ï¼Œæ¸…ç†å…¨å±€å˜é‡ã€å…³é—­ç¼–è¯‘å™¨ã€å…³é—­æ‰§è¡Œå™¨ç­‰ï¼Œresgister_shutdown_functionä¹Ÿæ˜¯åœ¨æ­¤æ‰§è¡Œï¼‰ æ¨¡å—å…³é—­é˜¶æ®µï¼ˆSAPIå…³é—­æ—¶æ‰§è¡Œï¼‰ æ ¹æ®ä¸åŒSAPIçš„å®ç°ï¼Œä¼šæœ‰ä¸€äº›å·®åˆ«ã€‚æ¯”å¦‚å‘½ä»¤è¡Œæ¨¡å¼ï¼Œæ¯æ‰§è¡Œä¸€æ¬¡è„šæœ¬éƒ½è¦ç»å†è¿™äº”ä¸ªé˜¶æ®µï¼›è€ŒFastCGIæ¨¡å¼ä¸‹ï¼Œåªåœ¨å¯åŠ¨æ—¶æ‰§è¡Œä¸€æ¬¡æ¨¡å—åˆå§‹åŒ–ï¼Œç„¶åè¯·æ±‚åªç»å†è¯·æ±‚åˆå§‹åŒ–ï¼Œæ‰§è¡Œè„šæœ¬å’Œè¯·æ±‚å…³é—­å‡ ä¸ªé˜¶æ®µã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"åˆ©ç”¨ElementUIçš„tableå’Œcalendaråˆ¶ä½œä¸€ä¸ªä»·æ ¼æ—¥å†","slug":"åˆ©ç”¨ElementUIçš„tableå’Œcalendaråˆ¶ä½œä¸€ä¸ªä»·æ ¼æ—¥å†","date":"2020-05-04T11:43:59.000Z","updated":"2022-03-19T14:35:21.880Z","comments":true,"path":"2020/05/04/250/","link":"","permalink":"https://github.13sai.com/2020/05/04/250/","excerpt":"","text":"é¡¹ç›®ä¸­éœ€è¦åšä¸€ä¸ªä»·æ ¼æ—¥å†ï¼Œä¾¿äºå±•ç¤ºå’Œä¿®æ”¹æ—¥æœŸä»·æ ¼ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹æœ€ç»ˆæ•ˆæœï¼Œç„¶ååˆ©ç”¨ElementUIçš„table å’Œ calendar å®ç°ä¸€ä¸‹ã€‚ æ¥çœ‹çœ‹ä¸»è¦ä»£ç ï¼ˆä»£ç ä»…ä¿ç•™äº†ä¸»è¦ä»£ç å’Œå±æ€§ï¼Œå¹¶ä¸å®Œæ•´ï¼Œå¯ä»¥è‡ªè¡Œæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ï¼‰ï¼š &lt;template&gt; &lt;div class=&quot;calendar-list-container&quot;&gt; &lt;!--expand-row-keysè®¾ç½®äº†row-keyä¹Ÿè¦è®¾ç½®ï¼Œ expand-change å½“ç”¨æˆ·å¯¹æŸä¸€è¡Œå±•å¼€æˆ–è€…å…³é—­çš„æ—¶å€™ä¼šè§¦å‘è¯¥äº‹ä»¶ï¼ˆå±•å¼€è¡Œæ—¶ï¼Œå›è°ƒçš„ç¬¬äºŒä¸ªå‚æ•°ä¸º expandedRowsï¼›æ ‘å½¢è¡¨æ ¼æ—¶ç¬¬äºŒå‚æ•°ä¸º expandedï¼‰ row, (expandedRows | expanded)--&gt; &lt;el-table ref=&quot;table&quot; key=&quot;id&quot; v-loading=&quot;listLoading&quot; :data=&quot;list&quot; element-loading-text=&quot;loading&quot; row-key=&quot;id&quot; :expand-row-keys=&quot;expands&quot; @expand-change=&quot;expandChange&quot; &gt; &lt;el-table-column align=&quot;center&quot; type=&quot;expand&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;!--ä»·æ ¼æ—¥å†æ¸²æŸ“ --&gt; &lt;el-calendar v-loading=&quot;calendarLoad&quot; element-loading-text=&quot;loading&quot; &gt; &lt;template slot=&quot;dateCell&quot; slot-scope=&quot;&#123;date, data&#125;&quot; &gt; &lt;!--ä»Šæ—¥åŠä¹‹åçš„ä»·æ ¼å¯è®¾ç½®setPrice --&gt; &lt;div :class=&quot;nowDay &lt;= data.day.replace(/-/g, &#x27;&#x27;)? &#x27;calendar-div&#x27; : &#x27;calendar-div calendar-prev&#x27;&quot; @click=&quot;nowDay &lt;= data.day.replace(/-/g, &#x27;&#x27;) &amp;&amp; setPrice(data, date)&quot; &gt; &lt;div&gt;&#123;&#123; data.day.slice(-2) &#125;&#125;&lt;/div&gt; &lt;div v-if=&quot;data.type == &#x27;current-month&#x27; &amp;&amp; refreshPrice(data)&quot; class=&quot;price &quot; &gt; é¢„è®¢ä»·ï¼š&#123;&#123; priceList[data.day.slice(-2) -1] &#125;&#125;å…ƒ &lt;/div&gt; &lt;/div&gt; &lt;/template&gt; &lt;/el-calendar&gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column align=&quot;center&quot; label=&quot;åç§°&quot; class-name=&quot;overflow-on&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &#123;&#123; scope.row.name &#125;&#125; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column align=&quot;center&quot; label=&quot;å›¾ç‰‡&quot; width=&quot;210&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;img :src=&quot;scope.row.imageList[0]&quot; style=&quot;width:150px&quot; &gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column align=&quot;center&quot; label=&quot;ä»Šæ—¥ä»·æ ¼&quot; max-width=&quot;200&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;span&gt;&#123;&#123; scope.row.price &#125;&#125;&lt;/span&gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column align=&quot;center&quot; label=&quot;åŸä»·&quot; max-width=&quot;200&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;span&gt;&#123;&#123; scope.row.original_price &#125;&#125;&lt;/span&gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;el-table-column align=&quot;center&quot; label=&quot;æ“ä½œ&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &lt;el-button type=&quot;primary&quot; @click=&quot;handleCheck(scope.row)&quot; &gt; ä»·æ ¼è®¾ç½® &lt;/el-button&gt; &lt;/template&gt; &lt;/el-table-column&gt; &lt;/el-table&gt; &lt;el-dialog title=&quot;è®¾ç½®ä»·æ ¼&quot; :visible.sync=&quot;dialogPriceVisible&quot; &gt; &lt;el-form class=&quot;small-space&quot; :model=&quot;temp&quot; label-position=&quot;left&quot; label-width=&quot;100px&quot; style=&quot;width: 500px; margin-left:50px;&quot; &gt; &lt;el-form-item label=&quot;åç§°&quot;&gt; &lt;el-input v-model=&quot;temp.name&quot; disabled /&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;æ—¶é—´æ®µ&quot;&gt; &lt;el-date-picker v-model=&quot;temp.date&quot; type=&quot;daterange&quot; range-separator=&quot;è‡³&quot; start-placeholder=&quot;å¼€å§‹æ—¥æœŸ&quot; end-placeholder=&quot;ç»“æŸæ—¥æœŸ&quot; :picker-options=&quot;pickerBeginDateBefore&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;åˆ†æ—¶è®¡ä»·&quot; prop=&quot;is_part&quot; required &gt; &lt;el-radio v-model=&quot;temp.is_part&quot; :label=&quot;0&quot; &gt; ä¸åˆ†å¹³æ—¶å‘¨æœ« &lt;/el-radio&gt; &lt;el-radio v-model=&quot;temp.is_part&quot; :label=&quot;1&quot; &gt; åŒºåˆ†å‘¨æœ« &lt;/el-radio&gt; &lt;/el-form-item&gt; &lt;el-form-item label=&quot;å¹³æ—¶ä»·&quot;&gt; &lt;el-input v-model=&quot;temp.normal_price&quot; /&gt; &lt;/el-form-item&gt; &lt;el-form-item v-if=&quot;temp.is_part == 1&quot; label=&quot;å‘¨æœ«ä»·&quot; &gt; &lt;el-input v-model=&quot;temp.week_price&quot; /&gt; &lt;/el-form-item&gt; &lt;/el-form&gt; &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot; &gt; &lt;el-button @click=&quot;dialogPriceVisible = false&quot;&gt; å– æ¶ˆ &lt;/el-button&gt; &lt;el-button type=&quot;primary&quot; @click=&quot;putPrice&quot; &gt; ç¡® å®š &lt;/el-button&gt; &lt;/div&gt; &lt;/el-dialog&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; import &#123; fetchList, setRoomPrice, getRoomPrice &#125; from &quot;@/api&quot;; import moment from &#x27;moment&#x27;; export default &#123; name: &quot;room&quot;, data() &#123; return &#123; pickerBeginDateBefore:&#123; disabledDate(time) &#123; return time.getTime() &lt; Date.now() - 86400*1000; &#125; &#125;, schedule: [], list: [], dialogPriceVisible: false, dialogFormVisible: false, priceDate: &#x27;2020-01-01&#x27;, nowDate: 1, nowMonth: 1, nowDay: 0, nowYear: 2020, calendarMonth: 1, priceList: [], expands: [],//åªå±•å¼€ä¸€è¡Œæ”¾å…¥å½“å‰è¡Œid room: &#123;&#125;, listLoading:false, calendarLoad: false, &#125;; &#125;, created() &#123; this.priceDate = new Date(); this.nowDate = this.priceDate.getDate(); this.nowMonth = this.priceDate.getMonth(); this.calendarMonth = this.nowMonth; this.nowYear = this.priceDate.getFullYear(); this.nowDay = this.priceDate.getFullYear()*10000+ (1+this.priceDate.getMonth())*100+ this.priceDate.getDate(); &#125;, methods: &#123; refreshPrice (data) &#123; // console.log(data); if (!data.isSelected) &#123; return true; &#125; if (data.day.slice(5, 7) == this.calendarMonth + 1) &#123; return true; &#125; this.calendarMonth = data.day.slice(5, 7) - 1; var that = this; getRoomPrice(that.room.id, &#123;&#x27;date&#x27;: data.day&#125;).then(response =&gt; &#123; var arr = []; response.data.priceList.forEach((item,index,array)=&gt;&#123; arr[index] = item? item : that.room.price; &#125;) that.priceList = arr &#125;); that.$forceUpdate() &#125;, getRowKeys(row) &#123; // console.log(row.id) return row.id //è¿™é‡Œçœ‹è¿™ä¸€è¡Œä¸­éœ€è¦æ ¹æ®å“ªä¸ªå±æ€§å€¼æ˜¯id &#125;, selectDate(type) &#123; // consoloe.log(type) &#125;, expandChange(row, expandedRows) &#123; // console.log(this.expands) var that = this; that.room = row; // æ¯æ¬¡åªå±•å¼€ä¸€è¡Œ if (expandedRows.length) &#123; that.calendarLoad = true; getRoomPrice(row.id, &#123;&#x27;date&#x27;: this.priceDate&#125;).then(response =&gt; &#123; that.calendarLoad = false; var arr = []; response.data.priceList.forEach((item,index,array)=&gt;&#123; arr[index] = item? item : row.price; &#125;) that.priceList = arr that.expands = [row.id] &#125;); &#125; else &#123; // æ”¶èµ·ä»·æ ¼æ—¥å† that.expands = [] &#125; &#125;, setPrice(data, date) &#123; if (this.nowDay &gt; data.day.replace(/-/g, &#x27;&#x27;)) &#123; return false; &#125; var that = this; this.temp = &#123; name: that.room.name, date: [date, date], is_part: 0, &#125;; this.dialogPriceVisible = true; &#125;, putPrice() &#123; this.dialogPriceVisible = true; setRoomPrice(this.room.id, this.temp).then(res =&gt; &#123; if (res.code == 0) &#123; this.$message.success(&quot;ç¼–è¾‘æˆåŠŸ&quot;); this.dialogPriceVisible = !this.dialogPriceVisible; var that = this; getRoomPrice(that.room.id, &#123;&#x27;date&#x27;: this.temp.date[0]&#125;).then(response =&gt; &#123; var arr = []; response.data.priceList.forEach((item,index,array)=&gt;&#123; arr[index] = item? item : that.room.price; &#125;) that.priceList = arr &#125;); fetchList(that.params).then(response =&gt; &#123; that.list = response.data; &#125;); that.resetTemp(); that.$forceUpdate() &#125; else &#123; this.$message.error(res.msg); &#125; &#125;); &#125;, // ç”¨äºå¯å±•å¼€è¡¨æ ¼ä¸æ ‘å½¢è¡¨æ ¼ï¼Œåˆ‡æ¢æŸä¸€è¡Œçš„å±•å¼€çŠ¶æ€ï¼Œå¦‚æœä½¿ç”¨äº†ç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™æ˜¯è®¾ç½®è¿™ä¸€è¡Œå±•å¼€ä¸å¦ï¼ˆexpanded ä¸º true åˆ™å±•å¼€ï¼‰ handleCheck(row) &#123; const $table = this.$refs.table $table.toggleRowExpansion(row) &#125; &#125; &#125;; &lt;/script&gt; ä»·æ ¼æ—¥å†è¿”å›æ•°æ®æ ¼å¼ï¼š &#123; &quot;status&quot;: &quot;success&quot;, &quot;code&quot;: 0, &quot;msg&quot;: &quot;æ“ä½œæˆåŠŸ&quot;, &quot;data&quot;: &#123; &quot;room&quot;: &#123; &quot;name&quot;: &quot;å¤§åºŠæˆ¿&quot;, &quot;price&quot;: 299, &quot;original_price&quot;: 289 &#125;, &quot;priceList&quot;: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, 209, 219, false, false, false, false, false], &#125; &#125; priceListæ˜¯æœ¬æœˆä»·æ ¼ï¼Œfalseè¡¨ç¤ºæœªè®¾ç½®ã€‚ tableçš„åŠŸèƒ½æ¯”è¾ƒå¼ºå¤§ï¼Œéƒ¨åˆ†å±æ€§å‡½æ•°å¹¶ä¸å¸¸ç”¨ï¼Œå¯ä»¥è‡ªè¡Œæ‰“å°å‡ºæ¥çœ‹çœ‹ï¼Œç ”ç©¶ä¸€ä¸‹å³å¯ã€‚calendaræ˜¯2.8ç‰ˆæœ¬æ–°å¢çš„ç»„ä»¶ï¼Œå¦‚æœç‰ˆæœ¬è¿‡ä½ï¼Œå¯ä»¥å°è¯•å‡çº§åˆ°æ–°ç‰ˆæœ¬ã€‚","categories":[{"name":"vue","slug":"vue","permalink":"https://github.13sai.com/categories/vue/"}],"tags":[{"name":"ElementUI","slug":"ElementUI","permalink":"https://github.13sai.com/tags/ElementUI/"}]},{"title":"åˆ©ç”¨Laravelä¸­é—´ä»¶ç»™åå°åŠ ä¸ªæ“ä½œæ—¥å¿—","slug":"åˆ©ç”¨Laravelä¸­é—´ä»¶ç»™åå°åŠ ä¸ªæ“ä½œæ—¥å¿—","date":"2020-04-29T12:48:08.000Z","updated":"2022-05-06T09:00:22.699Z","comments":true,"path":"2020/04/29/248/","link":"","permalink":"https://github.13sai.com/2020/04/29/248/","excerpt":"","text":"é¡¹ç›®åå°è§’è‰²åŠäººå‘˜å˜å¤šï¼Œéœ€è¦åŠ ä¸‹æ—¥å¿—ï¼Œæ–¹ä¾¿æŸ¥è¯¢ï¼Œä¸å¦¨åˆ©ç”¨ä¸­é—´ä»¶å®ç°ä¸‹ã€‚ æ–¹æ¡ˆï¼š ä¸­é—´ä»¶åˆ¤æ–­æ˜¯å¦éœ€è¦è®°å½•ï¼Œå†™å…¥é˜Ÿåˆ— é˜Ÿåˆ—å†™å…¥æ•°æ®åº“ è¡¨è®¾è®¡ CREATE TABLE `admin_log` ( `id` int(10) unsigned NOT NULL AUTO_INCREMENT, `user_id` int(11) NOT NULL, `path` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `method` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL, `ip` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `input` text COLLATE utf8mb4_unicode_ci NOT NULL, `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci ROW_FORMAT=DYNAMIC; æ–°å»ºä¸­é—´ä»¶AdminLogMiddlewareï¼Œåœ¨åå°è·¯ç”±ä¸­åŠ å…¥æ­¤ä¸­é—´ä»¶å³å¯ï¼Œ &lt;?php /** * Author: sai * Date: 2020/4/1 * Time: 16:19 */ namespace App\\Http\\Middleware; use App\\Jobs\\OperationLogJob; use Closure; use Auth; class AdminLogMiddleware &#123; /** * å¤„ç†ä¼ å…¥çš„å‚æ•° * * @param \\Illuminate\\Http\\Request $request * @param \\Closure $next * @param string $role * @return mixed */ public function handle($request, Closure $next, $role) &#123; // å‰”é™¤GETï¼ŒOPTIONSè¯·æ±‚ if (!in_array($method = $request-&gt;getMethod(), [&#x27;GET&#x27;, &#x27;OPTIONS&#x27;])) &#123; $data = [ &#x27;user_id&#x27; =&gt; Auth::guard(&#x27;admin&#x27;)-&gt;id(), &#x27;path&#x27; =&gt; $request-&gt;getPathInfo(), &#x27;method&#x27; =&gt; $method, &#x27;ip&#x27; =&gt; $request-&gt;getClientIp(), &#x27;input&#x27; =&gt; \\json_encode($request-&gt;all(), JSON_HEX_TAG | JSON_HEX_APOS | JSON_HEX_QUOT | JSON_HEX_AMP | JSON_UNESCAPED_UNICODE), ]; // å¼‚æ­¥å†™å…¥ï¼Œæé«˜æ“ä½œæµç•…æ€§ $job = (new OperationLogJob($data)); dispatch($job); &#125; return $next($request); &#125; &#125; &lt;?php namespace App\\Jobs; use App\\Models\\AdminLog; use Illuminate\\Bus\\Queueable; use Illuminate\\Contracts\\Queue\\ShouldQueue; use Illuminate\\Foundation\\Bus\\Dispatchable; use Illuminate\\Queue\\InteractsWithQueue; use Illuminate\\Queue\\SerializesModels; class OperationLogJob implements ShouldQueue &#123; use Dispatchable, InteractsWithQueue, Queueable, SerializesModels; /** * Create a new job instance. * * @return void */ public function __construct($data) &#123; // $this-&gt;queue = &#x27;adminLog&#x27;; $this-&gt;data = $data; &#125; private $data; /** * Execute the job. * * @return void */ public function handle() &#123; // AdminLog::create($this-&gt;data); &#125; &#125; æ‰§è¡Œé˜Ÿåˆ—ï¼š php artisan queue:work --queue=adminLog å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸å†™å…¥æ•°æ®åº“ï¼Œå†™åœ¨logæ–‡ä»¶é‡Œï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚ å¦å¤–ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œä¹Ÿå¯ä»¥ç»™åå°ç»Ÿä¸€åŠ å…¥AdminLogMiddlewareä¸­é—´ä»¶ï¼ŒæŠŠä¸éœ€è¦åšè®°å½•çš„è·¯ç”±åŠ å…¥é…ç½®æ–‡ä»¶ï¼Œåœ¨ä¸­é—´ä»¶åŠ å…¥åˆ¤æ–­ï¼Œçœå»åœ¨è·¯ç”±é…ç½®å»åŒºåˆ†æ˜¯å¦éœ€è¦è®°å½•ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"}]},{"title":"ElementUIä¸­tableè¡¨æ ¼è‡ªå®šä¹‰è¡¨å¤´Tooltipæ–‡å­—æç¤º","slug":"ElementUIä¸­tableè¡¨æ ¼è‡ªå®šä¹‰è¡¨å¤´Tooltipæ–‡å­—æç¤º","date":"2020-04-29T08:18:28.000Z","updated":"2022-03-19T14:35:21.581Z","comments":true,"path":"2020/04/29/247/","link":"","permalink":"https://github.13sai.com/2020/04/29/247/","excerpt":"","text":"tableè¡¨æ ¼éœ€è¦å¢åŠ æç¤ºæ–‡æ¡ˆè¯´æ˜ï¼Œæ²¡æœ‰ç°æˆçš„å±æ€§æ·»åŠ ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡render-headeræ¥æ¸²æŸ“è¡¨å¤´ã€‚ ä»£ç å¦‚ä¸‹ï¼š &lt;el-table-column align=&quot;center&quot; label=&quot;ä»·æ ¼&quot; :render-header=&quot;renderTipsHeader&quot; &gt; &lt;template slot-scope=&quot;scope&quot;&gt; &#123;&#123; scope.row.amount &#125;&#125; &lt;/template&gt; &lt;/el-table-column&gt; renderTipsHeaderï¼š renderTipsHeader (h,&#123;column&#125;) &#123; return h( &#x27;div&#x27;,[ h(&#x27;span&#x27;, column.label), h(&#x27;el-tooltip&#x27;,&#123; props:&#123; effect:&#x27;dark&#x27;, content:&#x27;æç¤ºæ–‡æ¡ˆ&#x27;, placement:&#x27;top&#x27; &#125;, &#125;,[ h(&#x27;i&#x27;, &#123; class:&#x27;el-icon-question&#x27;, style:&#x27;color:#409EFF;margin-left:5px;&#x27; &#125;) ]) ] ); &#125; æ•ˆæœå¦‚å›¾ï¼š render-header åˆ—æ ‡é¢˜ Label åŒºåŸŸæ¸²æŸ“ä½¿ç”¨çš„ Function Function(h, &#123; column, $index &#125;) æ„Ÿå…´è¶£å¯ä»¥æ‰“å°å‡ºæ¥çœ‹çœ‹ï¼Œè¿™é‡Œè¿˜æœ‰æ›´å¤æ‚çš„åº”ç”¨â€“https://github.com/Darkerxi/ElementUI-Table-column_render-header å‚è€ƒæ–‡ç« ï¼šelement-uiè‡ªå®šä¹‰tableè¡¨å¤´ï¼Œä¿®æ”¹æ ‡é¢˜æ ·å¼ã€æ·»åŠ tooltipåŠ :render-headerä½¿ç”¨ç®€ä»‹","categories":[{"name":"vue","slug":"vue","permalink":"https://github.13sai.com/categories/vue/"}],"tags":[{"name":"ElementUI","slug":"ElementUI","permalink":"https://github.13sai.com/tags/ElementUI/"}]},{"title":"åˆ†äº«æŒ‰æ—¥æ‰§è¡Œçš„è„šæœ¬","slug":"åˆ†äº«æŒ‰æ—¥æ‰§è¡Œçš„è„šæœ¬","date":"2020-04-25T09:55:07.000Z","updated":"2022-03-19T14:35:21.865Z","comments":true,"path":"2020/04/25/246/","link":"","permalink":"https://github.13sai.com/2020/04/25/246/","excerpt":"","text":"é¡¹ç›®ä¸­è¦åšä¸€äº›æŒ‰æ—¥è¿›è¡Œçš„ç»Ÿè®¡ï¼Œä¹‹å‰çš„ä»»åŠ¡éƒ½æ²¡è·‘ï¼Œå†™ä¸ªè„šæœ¬æ‰§è¡Œä¸‹ã€‚ plus.sh #!/bin/bash START_DATE=$1 END_DATE=$2 EXEC_COMMAND=$3 echo &#x27;start_date: &#x27;$START_DATE echo &#x27;end_date: &#x27;$END_DATE i=$START_DATE while [[ $i &lt; `date -d &quot;+1 day $END_DATE&quot; +%Y%m%d` ]] do echo $i $EXEC_COMMAND $i i=`date -d &quot;+1 day $i&quot; +%Y%m%d` done æ‰§è¡Œ ./plus.sh 2020-03-01 2020-04-24 â€˜php artisan command:testâ€™","categories":[{"name":"shell","slug":"shell","permalink":"https://github.13sai.com/categories/shell/"}],"tags":[{"name":"shell","slug":"shell","permalink":"https://github.13sai.com/tags/shell/"}]},{"title":"Laravelé…åˆMaatwebsiteExcelå®ç°Excelå¯¼å…¥","slug":"Laravel6é…åˆMaatwebsiteExcelå®ç°Excelå¯¼å…¥","date":"2020-04-05T02:52:58.000Z","updated":"2022-07-05T08:53:04.717Z","comments":true,"path":"2020/04/05/245/","link":"","permalink":"https://github.13sai.com/2020/04/05/245/","excerpt":"","text":"å‰ä¸€æ®µéœ€è¦é¡¹ç›®ä¸­éœ€è¦é€šè¿‡Excelå¯¼å…¥ç”¨æˆ·ï¼Œä¹‹å‰ç”¨è¿‡phpexcelï¼Œæ€»æ„Ÿè§‰å¤ªè¿‡ç¹çï¼Œå°è±¡ä¸­phpexcelä¹Ÿå¾ˆä¹…æ²¡æ›´æ–°ï¼Œçœ‹åˆ°é¡¹ç›®ä¸­æœ‰ä½¿ç”¨Maatwebsite\\Excelï¼Œä¾¿å°è¯•ä½¿ç”¨ä¸€ä¸‹ã€‚ å®‰è£…composer require maatwebsite/excel å¯¼å…¥ç”Ÿæˆå¯¼å…¥ç±»php artisan make:import AdminsImport --model=Admin ä¼šçœ‹åˆ°appä¸‹é¢ç”Ÿæˆäº†Importsæ–‡ä»¶å¤¹ã€‚ å®Œå–„ä¸šåŠ¡é€»è¾‘&lt;?php namespace App\\Imports; use App\\Models\\Admin; use function EasyWeChat\\Kernel\\Support\\str_random; use Maatwebsite\\Excel\\Concerns\\ToModel; class AdminsImport implements ToModel &#123; /** * @param array $row * * @return \\Illuminate\\Database\\Eloquent\\Model|null */ public function model(array $row) &#123; //è¿‡æ»¤è¡¨å¤´å’Œç©ºè¡Œï¼Œæˆ‘è¿™è¾¹è¡¨å¤´çš„ç¬¬ä¸€ä¸ªå•å…ƒæ ¼æ˜¯idï¼Œå…·ä½“è‡ªè¡Œè°ƒæ•´ if (empty($row[0]) || $row[0] == &#x27;id&#x27;) &#123; return null; &#125; return new Admin([ &#x27;username&#x27; =&gt; $row[2], &#x27;password&#x27; =&gt; bcrypt($row[3]), &#x27;api_token&#x27; =&gt; str_random(60), ]); &#125; &#125; å¯¼å…¥ä»»åŠ¡&lt;?php namespace App\\Console\\Commands; use App\\Imports\\AdminsImport; use Illuminate\\Console\\Command; use Maatwebsite\\Excel\\Facades\\Excel; class ImportAdmin extends Command &#123; /** * The name and signature of the console command. * * @var string */ protected $signature = &#x27;importAdmin&#x27;; /** * The console command description. * * @var string */ protected $description = &#x27;å¯¼å…¥admin&#x27;; /** * Create a new command instance. * * @return void */ public function __construct() &#123; parent::__construct(); &#125; /** * Execute the console command. * * @return mixed */ public function handle() &#123; Excel::import(new AdminsImport(), storage_path(&#x27;files/export.xlsx&#x27;)); $this-&gt;info($this-&gt;description.&#x27;å®Œæˆ&#x27;); &#125; &#125; å…¶ä»–é€»è¾‘å½“ç„¶ï¼Œå¯èƒ½ä¸šåŠ¡å¿…ä¸ä»…ä»…æ˜¯å†™å…¥æ•°æ®ï¼Œå¯èƒ½æœ‰ä¸€äº›è®¾è®¡å…·ä½“ä¸šåŠ¡çš„æ“ä½œï¼Œé‚£ä¹ˆä½ å¯ä»¥è¿™æ ·æ“ä½œã€‚ &lt;?php namespace App\\Imports; use App\\Models\\Admin; use function EasyWeChat\\Kernel\\Support\\str_random; use Maatwebsite\\Excel\\Concerns\\ToCollection; use Illuminate\\Support\\Collection; class AdminsImport implements ToCollection &#123; public function collection(Collection $rows) &#123; //å¦‚æœéœ€è¦å»é™¤è¡¨å¤´ unset($rows[0]); //$rows æ˜¯æ•°ç»„æ ¼å¼ return $this-&gt;createData($rows); &#125; public function createData($rows) &#123; $success = 0; foreach ($rows as $row) &#123; $row[0] = (int) $row[0]; if (empty($row[0])) &#123; continue; &#125; (new Admin())-&gt;create( [ &#x27;username&#x27; =&gt; $row[2], &#x27;name&#x27; =&gt; $row[2], &#x27;password&#x27; =&gt; bcrypt($row[3]), &#x27;api_token&#x27; =&gt; str_random(60), ] ); // å…¶ä»–ä¸šåŠ¡ä»£ç  $success++; &#125; return $success.&#x27;-&#x27;.count($rows); &#125; &#125; æ‰§è¡Œphp7.2 artisan importAdmin æ€»çš„æ¥è¯´ï¼Œä½¿ç”¨èµ·æ¥è¿˜æ˜¯ç®€å•æ˜äº†çš„ã€‚ moreå…·ä½“å¯¼å…¥å®ç°å¯ä»¥æœç´¢Maatwebsite\\Excel\\ExcelæŸ¥çœ‹ï¼Œé‡Œé¢è¿˜æœ‰å¯¼å‡ºã€ä»¥é˜Ÿåˆ—æ–¹å¼å¯¼å…¥ç­‰ï¼Œæ”¯æŒçš„æ ¼å¼ä¹Ÿæ˜¯å¤šç§å¤šæ ·ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼ŒåŠŸèƒ½è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ï¼Œè¶³å¤Ÿåº”ä»˜æ—¥å¸¸éœ€æ±‚äº†ã€‚ &lt;?php namespace Maatwebsite\\Excel; use Illuminate\\Support\\Collection; use Maatwebsite\\Excel\\Files\\Filesystem; use Maatwebsite\\Excel\\Files\\TemporaryFile; use Illuminate\\Contracts\\Queue\\ShouldQueue; use Illuminate\\Foundation\\Bus\\PendingDispatch; use Maatwebsite\\Excel\\Helpers\\FileTypeDetector; class Excel implements Exporter, Importer &#123; use RegistersCustomConcerns; const XLSX = &#x27;Xlsx&#x27;; const CSV = &#x27;Csv&#x27;; const TSV = &#x27;Csv&#x27;; const ODS = &#x27;Ods&#x27;; const XLS = &#x27;Xls&#x27;; const SLK = &#x27;Slk&#x27;; const XML = &#x27;Xml&#x27;; const GNUMERIC = &#x27;Gnumeric&#x27;; const HTML = &#x27;Html&#x27;; const MPDF = &#x27;Mpdf&#x27;; const DOMPDF = &#x27;Dompdf&#x27;; const TCPDF = &#x27;Tcpdf&#x27;; /** * @var Writer */ protected $writer; /** * @var QueuedWriter */ protected $queuedWriter; /** * @var Filesystem */ protected $filesystem; /** * @var Reader */ private $reader; /** * @param Writer $writer * @param QueuedWriter $queuedWriter * @param Reader $reader * @param Filesystem $filesystem */ public function __construct( Writer $writer, QueuedWriter $queuedWriter, Reader $reader, Filesystem $filesystem ) &#123; $this-&gt;writer = $writer; $this-&gt;reader = $reader; $this-&gt;filesystem = $filesystem; $this-&gt;queuedWriter = $queuedWriter; &#125; /** * &#123;@inheritdoc&#125; */ public function download($export, string $fileName, string $writerType = null, array $headers = []) &#123; return response()-&gt;download( $this-&gt;export($export, $fileName, $writerType)-&gt;getLocalPath(), $fileName, $headers )-&gt;deleteFileAfterSend(true); &#125; /** * &#123;@inheritdoc&#125; */ public function store($export, string $filePath, string $diskName = null, string $writerType = null, $diskOptions = []) &#123; if ($export instanceof ShouldQueue) &#123; return $this-&gt;queue($export, $filePath, $diskName, $writerType, $diskOptions); &#125; $temporaryFile = $this-&gt;export($export, $filePath, $writerType); $exported = $this-&gt;filesystem-&gt;disk($diskName, $diskOptions)-&gt;copy( $temporaryFile, $filePath ); $temporaryFile-&gt;delete(); return $exported; &#125; /** * &#123;@inheritdoc&#125; */ public function queue($export, string $filePath, string $disk = null, string $writerType = null, $diskOptions = []) &#123; $writerType = FileTypeDetector::detectStrict($filePath, $writerType); return $this-&gt;queuedWriter-&gt;store( $export, $filePath, $disk, $writerType, $diskOptions ); &#125; /** * &#123;@inheritdoc&#125; */ public function raw($export, string $writerType) &#123; $temporaryFile = $this-&gt;writer-&gt;export($export, $writerType); $contents = $temporaryFile-&gt;contents(); $temporaryFile-&gt;delete(); return $contents; &#125; /** * &#123;@inheritdoc&#125; */ public function import($import, $filePath, string $disk = null, string $readerType = null) &#123; $readerType = FileTypeDetector::detect($filePath, $readerType); $response = $this-&gt;reader-&gt;read($import, $filePath, $readerType, $disk); if ($response instanceof PendingDispatch) &#123; return $response; &#125; return $this; &#125; /** * &#123;@inheritdoc&#125; */ public function toArray($import, $filePath, string $disk = null, string $readerType = null): array &#123; $readerType = FileTypeDetector::detect($filePath, $readerType); return $this-&gt;reader-&gt;toArray($import, $filePath, $readerType, $disk); &#125; /** * &#123;@inheritdoc&#125; */ public function toCollection($import, $filePath, string $disk = null, string $readerType = null): Collection &#123; $readerType = FileTypeDetector::detect($filePath, $readerType); return $this-&gt;reader-&gt;toCollection($import, $filePath, $readerType, $disk); &#125; /** * &#123;@inheritdoc&#125; */ public function queueImport(ShouldQueue $import, $filePath, string $disk = null, string $readerType = null) &#123; return $this-&gt;import($import, $filePath, $disk, $readerType); &#125; /** * @param object $export * @param string|null $fileName * @param string $writerType * * @throws \\PhpOffice\\PhpSpreadsheet\\Exception * @return TemporaryFile */ protected function export($export, string $fileName, string $writerType = null): TemporaryFile &#123; $writerType = FileTypeDetector::detectStrict($fileName, $writerType); return $this-&gt;writer-&gt;export($export, $writerType); &#125; &#125; æœ€åï¼Œæ„Ÿè°¢ä¸‹é¢è¿™ä¸€ç¯‡ç«™å†…æ–‡ç« è®©æˆ‘å¿«é€Ÿä¸Šæ‰‹ã€‚ maatwebsite/Excel 3.1 ä½¿ç”¨æ•™ç¨‹ ï¼ˆå¯¼å…¥ç¯‡ï¼‰ æœ€åï¼Œé™„ä¸ŠLaravel Excel æ–‡æ¡£ï¼š Laravel Excel","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"}]},{"title":"goçš„ç±»å‹è½¬æ¢","slug":"goçš„ç±»å‹è½¬æ¢","date":"2020-03-29T14:34:45.000Z","updated":"2022-03-19T14:35:21.710Z","comments":true,"path":"2020/03/29/243/","link":"","permalink":"https://github.13sai.com/2020/03/29/243/","excerpt":"","text":"ç±»å‹è½¬æ¢æ˜¯ç»å¸¸ä½¿ç”¨åˆ°çš„ï¼Œæ±‡æ€»äº†ä¸€äº›æ¯”è¾ƒå¸¸è§çš„ç”¨æ³•ï¼Œåˆ†äº«ç»™ä½ ï½ package main /** å˜é‡ç±»å‹è½¬æ¢ */ import ( &quot;fmt&quot; &quot;reflect&quot; &quot;strconv&quot; ) func main() &#123; v := &quot;hello world&quot; fmt.Println(typeofFmt(v)) fmt.Println(typeofReflect(v)) str := &quot;1245&quot; fmt.Println(stringToInt(str)) fmt.Println(stringToInt64(str)) a := 3545; var b int64; b = 98; fmt.Println(int64ToString(b)) fmt.Println(intToString(a)) var f float64 f = 3.45 fmt.Println(floatToString(f)) str = &quot;1.24&quot; fmt.Println(stringToFloat(str)) //intåˆ°int64 fmt.Println(int64(1234)) //int è½¬åŒ–ä¸º float score := 100 fmt.Println(float64(score)) &#125; // åˆ©ç”¨fmt func typeofFmt(v interface&#123;&#125;) string &#123; return fmt.Sprintf(&quot;%T&quot;, v) &#125; // åˆ©ç”¨reflect func typeofReflect(v interface&#123;&#125;) string &#123; return reflect.TypeOf(v).String() &#125; // stringè½¬int func stringToInt(a string) int &#123; d,_ := strconv.Atoi(a) return d &#125; //Atoiæ˜¯ParseInt(s, 10, 0)çš„ç®€å†™ã€‚ // stringè½¬int64 func stringToInt64(a string) int64 &#123; d, _ := strconv.ParseInt(a, 10, 64) return d &#125; /** func ParseInt(s string, base int, bitSize int) (i int64, err error) è¿”å›å­—ç¬¦ä¸²è¡¨ç¤ºçš„æ•´æ•°å€¼ï¼Œæ¥å—æ­£è´Ÿå·ã€‚ baseæŒ‡å®šè¿›åˆ¶ï¼ˆ2åˆ°36ï¼‰ï¼Œå¦‚æœbaseä¸º0ï¼Œåˆ™ä¼šä»å­—ç¬¦ä¸²å‰ç½®åˆ¤æ–­ï¼Œ&quot;0x&quot;æ˜¯16è¿›åˆ¶ï¼Œ&quot;0&quot;æ˜¯8è¿›åˆ¶ï¼Œå¦åˆ™æ˜¯10è¿›åˆ¶ï¼› bitSizeæŒ‡å®šç»“æœå¿…é¡»èƒ½æ— æº¢å‡ºèµ‹å€¼çš„æ•´æ•°ç±»å‹ï¼Œ0ã€8ã€16ã€32ã€64 åˆ†åˆ«ä»£è¡¨ intã€int8ã€int16ã€int32ã€int64ï¼›è¿”å›çš„erræ˜¯*NumErrç±»å‹çš„ï¼Œå¦‚æœè¯­æ³•æœ‰è¯¯ï¼Œerr.Error = ErrSyntaxï¼›å¦‚æœç»“æœè¶…å‡ºç±»å‹èŒƒå›´err.Error = ErrRangeã€‚ */ // intè½¬string func intToString(a int) string &#123; str := strconv.Itoa(a) return str &#125; // int64è½¬string func int64ToString(a int64) string &#123; str := strconv.FormatInt(a,10) return str &#125; /** func FormatInt(i int64, base int) string è¿”å›içš„baseè¿›åˆ¶çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚base å¿…é¡»åœ¨2åˆ°36ä¹‹é—´ï¼Œç»“æœä¸­ä¼šä½¿ç”¨å°å†™å­—æ¯&#x27;a&#x27;åˆ°&#x27;z&#x27;è¡¨ç¤ºå¤§äº10çš„æ•°å­—ã€‚ */ // floatè½¬string func floatToString (f float64) string &#123; return strconv.FormatFloat(f,&#x27;f&#x27;,-1,32) &#125; /** func FormatFloat(f float64, fmt byte, prec, bitSize int) string bitSizeè¡¨ç¤ºfçš„æ¥æºç±»å‹ï¼ˆ32ï¼šfloat32ã€64ï¼šfloat64ï¼‰ï¼Œä¼šæ®æ­¤è¿›è¡Œèˆå…¥ã€‚ fmtè¡¨ç¤ºæ ¼å¼ï¼š&#x27;f&#x27;ï¼ˆ-ddd.ddddï¼‰ã€&#x27;b&#x27;ï¼ˆ-ddddpÂ±dddï¼ŒæŒ‡æ•°ä¸ºäºŒè¿›åˆ¶ï¼‰ã€&#x27;e&#x27;ï¼ˆ-d.ddddeÂ±ddï¼Œåè¿›åˆ¶æŒ‡æ•°ï¼‰ã€&#x27;E&#x27;ï¼ˆ-d.ddddEÂ±ddï¼Œåè¿›åˆ¶æŒ‡æ•°ï¼‰ã€&#x27;g&#x27;ï¼ˆæŒ‡æ•°å¾ˆå¤§æ—¶ç”¨&#x27;e&#x27;æ ¼å¼ï¼Œå¦åˆ™&#x27;f&#x27;æ ¼å¼ï¼‰ã€&#x27;G&#x27;ï¼ˆæŒ‡æ•°å¾ˆå¤§æ—¶ç”¨&#x27;E&#x27;æ ¼å¼ï¼Œå¦åˆ™&#x27;f&#x27;æ ¼å¼ï¼‰ã€‚ precæ§åˆ¶ç²¾åº¦ï¼ˆæ’é™¤æŒ‡æ•°éƒ¨åˆ†ï¼‰ï¼šå¯¹&#x27;f&#x27;ã€&#x27;e&#x27;ã€&#x27;E&#x27;ï¼Œå®ƒè¡¨ç¤ºå°æ•°ç‚¹åçš„æ•°å­—ä¸ªæ•°ï¼›å¯¹&#x27;g&#x27;ã€&#x27;G&#x27;ï¼Œå®ƒæ§åˆ¶æ€»çš„æ•°å­—ä¸ªæ•°ã€‚å¦‚æœprec ä¸º-1ï¼Œåˆ™ä»£è¡¨ä½¿ç”¨æœ€å°‘æ•°é‡çš„ã€ä½†åˆå¿…éœ€çš„æ•°å­—æ¥è¡¨ç¤ºfã€‚ */ // stringè½¬float func stringToFloat(s string) float64 &#123; f,_ := strconv.ParseFloat(s,64) return f &#125; /** func ParseFloat(s string, bitSize int) (f float64, err error) è§£æä¸€ä¸ªè¡¨ç¤ºæµ®ç‚¹æ•°çš„å­—ç¬¦ä¸²å¹¶è¿”å›å…¶å€¼ã€‚ å¦‚æœsåˆä¹è¯­æ³•è§„åˆ™ï¼Œå‡½æ•°ä¼šè¿”å›æœ€ä¸ºæ¥è¿‘sè¡¨ç¤ºå€¼çš„ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ˆä½¿ç”¨IEEE754è§„èŒƒèˆå…¥ï¼‰ã€‚bitSizeæŒ‡å®šäº†æœŸæœ›çš„æ¥æ”¶ç±»å‹ï¼Œ32æ˜¯float32ï¼ˆè¿”å›å€¼å¯ä»¥ä¸æ”¹å˜ç²¾ç¡®å€¼çš„èµ‹å€¼ç»™float32ï¼‰ï¼Œ64æ˜¯float64ï¼›è¿”å›å€¼erræ˜¯*NumErrç±»å‹çš„ï¼Œè¯­æ³•æœ‰è¯¯çš„ï¼Œerr.Error=ErrSyntaxï¼›ç»“æœè¶…å‡ºè¡¨ç¤ºèŒƒå›´çš„ï¼Œè¿”å›å€¼fä¸ºÂ±Infï¼Œerr.Error= ErrRangeã€‚ */ æ›´å¤šç±»å‹è½¬æ¢ç›¸å…³å¯æŸ¥çœ‹æ ‡å‡†åº“ï¼š- strconv æŠ€æœ¯æ–‡ç« ä¹Ÿå‘å¸ƒåœ¨è‡ªå·±çš„å…¬ä¼—å·ã€çˆ±å¥½å†å²çš„ç¨‹åºå‘˜ã€‘ï¼Œæ¬¢è¿æ‰«ç å…³æ³¨ï¼Œè°¢è°¢ï¼","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"Rediså¸¸ç”¨ç±»å‹åŠåº”ç”¨åœºæ™¯","slug":"Rediså¸¸ç”¨ç±»å‹åŠåº”ç”¨åœºæ™¯","date":"2020-03-22T13:36:48.000Z","updated":"2022-03-30T11:24:19.429Z","comments":true,"path":"2020/03/22/230/","link":"","permalink":"https://github.13sai.com/2020/03/22/230/","excerpt":"","text":"ä¸»è¦ç±»å‹ å­—ç¬¦ä¸²ï¼ˆstringsï¼Œbitmapsï¼‰ æ•£åˆ—ï¼ˆhashesï¼‰ åˆ—è¡¨ï¼ˆlistsï¼‰ é›†åˆï¼ˆsetsï¼‰ æœ‰åºé›†åˆï¼ˆsorted setsï¼‰ hyperloglogs å‘å¸ƒè®¢é˜…ï¼ˆpub/subï¼‰ åœ°ç†ç©ºé—´ï¼ˆgeospatialï¼‰ Streamï¼ˆ5.0ç‰ˆæœ¬æ–°å¢ï¼‰ å…³äºå‘½ä»¤æˆ‘æ¨èçœ‹è¿™ä¸¤ä¸ªï¼š http://doc.redisfans.com/ http://www.redis.cn/commands.html åº”ç”¨åœºæ™¯strings ç¼“å­˜ åˆ†å¸ƒå¼é”ï¼ˆsetnxï¼‰ ç­¾åˆ°ç»Ÿè®¡ï¼ˆsetbitï¼‰ è®¡æ•°ï¼ˆincrï¼‰ hashes ç¼“å­˜ ç”¨æˆ·æ ‡ç­¾ lists é˜Ÿåˆ— sets äº¤é›†å¹¶é›† æ•°æ®å»é‡ zset æ’è¡Œæ¦œ å»¶æ—¶ä»»åŠ¡ é™æµ hyperloglogs uvç»Ÿè®¡ï¼ˆipç»Ÿè®¡ï¼‰ pub/sub å‘å¸ƒè®¢é˜…ï¼ˆä¸æ˜¯ç‰¹åˆ«å¯é ï¼‰ geospatial é™„è¿‘çš„äºº Stream é˜Ÿåˆ— å‘å¸ƒè®¢é˜… å…¶ä»–åˆ©ç”¨äº‹åŠ¡å®ç°ç§’æ€ä»¥phpä»£ç ä¸ºä¾‹ï¼š WATCHå‘½ä»¤å¯ä»¥ç›‘æ§ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œä¸€æ—¦å…¶ä¸­æœ‰ä¸€ä¸ªé”®è¢«ä¿®æ”¹ï¼ˆæˆ–åˆ é™¤ï¼‰ï¼Œä¹‹åçš„äº‹åŠ¡å°±ä¸ä¼šæ‰§è¡Œã€‚ç›‘æ§ä¸€ç›´æŒç»­åˆ°EXECå‘½ä»¤ï¼ˆäº‹åŠ¡ä¸­çš„å‘½ä»¤æ˜¯åœ¨EXECä¹‹åæ‰æ‰§è¡Œçš„ï¼Œæ‰€ä»¥åœ¨MULTIå‘½ä»¤åå¯ä»¥ä¿®æ”¹WATCHç›‘æ§çš„é”®å€¼ï¼‰ // åº“å­˜ä¸º5 //å®ä¾‹åŒ–redis $redis = new Redis(); //è¿æ¥ $redis-&gt;connect(&#x27;127.0.0.1&#x27;, 6379); $key = &#x27;sale&#x27;; $redis-&gt;setnx($key, 0); // æ­¤é¡¹ä¸é¢„å®šä¹‰äº¦å¯ï¼Œä¿è¯keyå”¯ä¸€å°±è¡Œ $redis-&gt;watch($key); //ç›‘è§†ä¸€ä¸ª(æˆ–å¤šä¸ª) key ï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¿™ä¸ª(æˆ–è¿™äº›) key è¢«å…¶ä»–å‘½ä»¤æ‰€æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«æ‰“æ–­ã€‚ $sale_num = $redis-&gt;get($key); if ($sale_num &gt; 4) &#123; exit(); &#125; $redis-&gt;multi(); //æ ‡è®°äº‹åŠ¡ $redis-&gt;incr($key); //é”€é‡+1 sleep(1); //æ¨¡æ‹ŸçœŸå®ç¯å¢ƒ $ret = $redis-&gt;exec(); // äº‹åŠ¡å—å†…æ‰€æœ‰å‘½ä»¤çš„è¿”å›å€¼ï¼ŒæŒ‰å‘½ä»¤æ‰§è¡Œçš„å…ˆåé¡ºåºæ’åˆ—ã€‚ if ($ret) &#123; // è‡ªå®šä¹‰çš„ä¸€ä¸ªåŸºäºmedooçš„dbclass include &#x27;db.php&#x27;; $db = new db([ &#x27;database_type&#x27; =&gt; &#x27;mysql&#x27;, &#x27;database_name&#x27; =&gt; &#x27;test&#x27;, &#x27;server&#x27; =&gt; &#x27;13sai&#x27;, &#x27;username&#x27; =&gt; &#x27;13sai&#x27;, &#x27;password&#x27; =&gt; &#x27;*&#x27;, &#x27;charset&#x27; =&gt; &#x27;utf8&#x27; ]); $db-&gt;update(&#x27;goods&#x27;, [&quot;stock_num[-]&quot; =&gt; 1], [&#x27;id&#x27; =&gt; 1]); &#125; å¸ƒéš†è¿‡æ»¤å™¨ å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰æ˜¯1970å¹´ç”±å¸ƒéš†æå‡ºçš„ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡å’Œä¸€ç³»åˆ—éšæœºæ˜ å°„å‡½æ•°ã€‚å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚ phpå®ç°æ¨èçœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š https://github.13sai.com/2019/05/21/188/ å½“ç„¶ï¼ŒRedisè‡ªå·±ä¹Ÿæœ‰ç¬¬ä¸‰æ–¹æ¨¡å—ï¼š https://github.com/RedisBloom/RedisBloom git clone https://github.com/RedisBloom/RedisBloom.git cd redisbloom make /path/to/redis-server --loadmodule ./redisbloom.so Bloomï¼šå‘è¿‡æ»¤å™¨æ·»åŠ æ–°é¡¹,å¦‚æœå°šä¸å­˜åœ¨ï¼Œåˆ™ä¼šä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªæ–°çš„è¿‡æ»¤å™¨ 127.0.0.1:6379&gt; BF.ADD newFilter foo (integer) 1 Bloomï¼šæ£€æŸ¥è¿‡æ»¤å™¨ä¸­æ˜¯å¦å­˜åœ¨é¡¹ 127.0.0.1:6379&gt; BF.EXISTS newFilter foo (integer) 1 127.0.0.1:6379&gt; BF.EXISTS newFilter notpresent (integer) 0 é™æµRedis-cell// æå‰å®‰è£…rustå“Ÿ git clone https://github.com/brandur/redis-cell.git cd redis-cell cargo build --release cp target/release/libredis_cell.dylib /path/to/modules/ redis-server --loadmodule /path/to/modules/libredis_cell.so è¯¥æ¨¡å—åªæœ‰1æ¡æŒ‡ä»¤cl.throttleï¼Œå®ƒçš„å‚æ•°å’Œè¿”å›å€¼éƒ½ç•¥æ˜¾å¤æ‚ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæŒ‡ä»¤å…·ä½“è¯¥å¦‚ä½•ä½¿ç”¨ã€‚ &gt; cl.throttle limitThrot 15 30 60 1 â–² â–² â–² â–² â–² | | | | â””â”€â”€â”€â”€â”€ need 1 quota (å¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼ä¹Ÿæ˜¯1) | | â””â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€ 30 operations / 60 seconds è¿™æ˜¯æ¼æ°´é€Ÿç‡ | â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 15 capacity è¿™æ˜¯æ¼æ–—å®¹é‡ &gt; â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ key ä¸Šé¢è¿™ä¸ªæŒ‡ä»¤çš„æ„æ€æ˜¯å…è®¸é¢‘ç‡ä¸ºæ¯ 60s æœ€å¤š 30 æ¬¡(æ¼æ°´é€Ÿç‡)ï¼Œæ¼æ–—çš„åˆå§‹å®¹é‡ä¸º 15ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€å¼€å§‹å¯ä»¥å– 15 ä¸ªï¼Œç„¶åæ‰å¼€å§‹å—æ¼æ°´é€Ÿç‡çš„å½±å“ã€‚æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªæŒ‡ä»¤ä¸­æ¼æ°´é€Ÿç‡å˜æˆäº† 2 ä¸ªå‚æ•°ï¼Œæ›¿ä»£äº†ä¹‹å‰çš„å•ä¸ªæµ®ç‚¹æ•°ã€‚ç”¨ä¸¤ä¸ªå‚æ•°ç›¸é™¤çš„ç»“æœæ¥è¡¨è¾¾æ¼æ°´é€Ÿç‡ç›¸å¯¹å•ä¸ªæµ®ç‚¹æ•°è¦æ›´åŠ ç›´è§‚ä¸€äº›ã€‚ &gt; cl.throttle limitThrot 15 30 60 1 1) (integer) 0 # 0 è¡¨ç¤ºå…è®¸ï¼Œ1è¡¨ç¤ºæ‹’ç» 2) (integer) 15 # æ¼æ–—å®¹é‡capacity 3) (integer) 14 # æ¼æ–—å‰©ä½™ç©ºé—´left_quota 4) (integer) -1 # å¦‚æœæ‹’ç»äº†ï¼Œéœ€è¦å¤šé•¿æ—¶é—´åå†è¯•(æ¼æ–—æœ‰ç©ºé—´äº†ï¼Œå•ä½ç§’) 5) (integer) 2 # å¤šé•¿æ—¶é—´åï¼Œæ¼æ–—å®Œå…¨ç©ºå‡ºæ¥(left_quota==capacityï¼Œå•ä½ç§’) åŸºæœ¬ä¸Šå¸¸è§çš„åœºæ™¯å°±æ˜¯è¿™äº›äº†ï¼Œå„ä½å‘¨æœ«æ„‰å¿«ï¼","categories":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/categories/redis/"}],"tags":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/tags/redis/"}]},{"title":"MySQLæ˜¯å¦‚ä½•åšåˆ°ä¸ä¸¢æ•°æ®","slug":"MySQLæ˜¯å¦‚ä½•åšåˆ°ä¸ä¸¢æ•°æ®","date":"2020-03-18T03:36:48.000Z","updated":"2022-03-19T15:35:52.569Z","comments":true,"path":"2020/03/18/MySQL-data/","link":"","permalink":"https://github.13sai.com/2020/03/18/MySQL-data/","excerpt":"","text":"æœ¬æ–‡ä¸ºæå®¢æ—¶é—´ä¸“æ ã€ŠMySQLå®æˆ˜45è®²ã€‹ç¬”è®°ï¼Œæ–‡ä¸­éƒ¨åˆ†å›¾æ–‡æ¥è‡ªè¯¥ä¸“æ ã€‚é™„ä¸Šä¸“æ é“¾æ¥ï¼Œæœ‰å…´è¶£å¯ç‚¹å‡»è®¢é˜…ï¼šhttps://time.geekbang.org/column/intro/139 MySQLæ˜¯å¦‚ä½•åšåˆ°æ•°æ®ä¸ä¸¢å¤±å‘¢ï¼Ÿ æˆ‘ä»¬å…ˆæ¥ä»‹ç»ä¸‹WALã€‚ WAL(Write-Ahead Loggin)æœºåˆ¶WAL æ˜¯é¢„å†™å¼æ—¥å¿—, å…³é”®ç‚¹åœ¨äºå…ˆå†™æ—¥å¿—å†å†™ç£ç›˜. MySQLåœ¨å¯¹æ•°æ®é¡µè¿›è¡Œä¿®æ”¹æ—¶, é€šè¿‡å°†â€ä¿®æ”¹äº†ä»€ä¹ˆâ€è¿™ä¸ªæ“ä½œè®°å½•åœ¨æ—¥å¿—ä¸­, è€Œä¸å¿…é©¬ä¸Šå°†æ›´æ”¹å†…å®¹åˆ·æ–°åˆ°ç£ç›˜ä¸Š, ä»è€Œå°†éšæœºå†™è½¬æ¢ä¸ºé¡ºåºå†™, æé«˜äº†æ€§èƒ½ã€‚ è¿™ç§æœºåˆ¶ä¸€æ–¹é¢æé«˜äº†MySQLçš„ååé‡ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå®ç°äº†æ•°æ®çš„é«˜å¯é æ€§ã€‚ binlogçš„å†™å…¥æœºåˆ¶äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…ˆæŠŠæ—¥å¿—å†™åˆ°binlog cacheï¼Œäº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œå†æŠŠbinlog cacheå†™åˆ°binlogæ–‡ä»¶ä¸­ã€‚ ä¸€ä¸ªäº‹åŠ¡çš„binlogæ˜¯ä¸èƒ½è¢«æ‹†å¼€çš„ï¼Œå› æ­¤ä¸è®ºè¿™ä¸ªäº‹åŠ¡å¤šå¤§ï¼Œä¹Ÿè¦ç¡®ä¿ä¸€æ¬¡æ€§å†™å…¥ã€‚è¿™å°±æ¶‰åŠåˆ°äº†binlog cacheçš„ä¿å­˜é—®é¢˜ã€‚ ç³»ç»Ÿç»™binlog cacheåˆ†é…äº†ä¸€ç‰‡å†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸€ä¸ªï¼Œå‚æ•° binlog_cache_sizeç”¨äºæ§åˆ¶å•ä¸ªçº¿ç¨‹å†…binlog cacheæ‰€å å†…å­˜çš„å¤§å°ã€‚å¦‚æœè¶…è¿‡äº†è¿™ä¸ªå‚æ•°è§„å®šçš„å¤§å°ï¼Œå°±è¦æš‚å­˜åˆ°ç£ç›˜ã€‚ äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œæ‰§è¡Œå™¨æŠŠbinlog cacheé‡Œçš„å®Œæ•´äº‹åŠ¡å†™å…¥åˆ°binlogä¸­ï¼Œå¹¶æ¸…ç©ºbinlog cacheã€‚ å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±binlog cacheï¼Œä½†æ˜¯å…±ç”¨åŒä¸€ä»½binlogæ–‡ä»¶ã€‚ å›¾ä¸­çš„writeï¼ŒæŒ‡çš„å°±æ˜¯æŒ‡æŠŠæ—¥å¿—å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„page cacheï¼Œå¹¶æ²¡æœ‰æŠŠæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥é€Ÿåº¦æ¯”è¾ƒå¿«ã€‚ å›¾ä¸­çš„fsyncï¼Œæ‰æ˜¯å°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜çš„æ“ä½œã€‚ write å’Œfsyncçš„æ—¶æœºï¼Œæ˜¯ç”±å‚æ•°sync_binlogæ§åˆ¶çš„ï¼š sync_binlog=0çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½åªwriteï¼Œä¸fsyncï¼› sync_binlog=1çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½ä¼šæ‰§è¡Œfsyncï¼› sync_binlog=N(N&gt;1)çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½writeï¼Œä½†ç´¯ç§¯Nä¸ªäº‹åŠ¡åæ‰fsyncã€‚ å› æ­¤ï¼Œåœ¨å‡ºç°IOç“¶é¢ˆçš„åœºæ™¯é‡Œï¼Œå°†sync_binlogè®¾ç½®æˆä¸€ä¸ªæ¯”è¾ƒå¤§çš„å€¼ï¼Œå¯ä»¥æå‡æ€§èƒ½ã€‚åœ¨å®é™…çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œè€ƒè™‘åˆ°ä¸¢å¤±æ—¥å¿—é‡çš„å¯æ§æ€§ï¼Œä¸€èˆ¬ä¸å»ºè®®å°†è¿™ä¸ªå‚æ•°è®¾æˆ0ï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯å°†å…¶è®¾ç½®ä¸º100~1000ä¸­çš„æŸä¸ªæ•°å€¼ã€‚ ä½†æ˜¯ï¼Œå°†sync_binlogè®¾ç½®ä¸ºNï¼Œå¯¹åº”çš„é£é™©æ˜¯ï¼šå¦‚æœä¸»æœºå‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¼šä¸¢å¤±æœ€è¿‘Nä¸ªäº‹åŠ¡çš„binlogæ—¥å¿—ã€‚ redo logå…ˆè¯´è¯´è¯´redo logçš„ä¸‰ç§çŠ¶æ€ï¼š çº¢è‰²ï¼šå­˜åœ¨redo log bufferä¸­ï¼Œç‰©ç†ä¸Šæ˜¯åœ¨MySQLè¿›ç¨‹å†…å­˜ä¸­ é»„è‰²ï¼šå†™åˆ°ç£ç›˜(write)ï¼Œä½†æ˜¯æ²¡æœ‰æŒä¹…åŒ–ï¼ˆfsync)ï¼Œç‰©ç†ä¸Šæ˜¯åœ¨æ–‡ä»¶ç³»ç»Ÿçš„page cacheé‡Œé¢ ç»¿è‰²ï¼šæŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå¯¹åº”çš„æ˜¯hard disk ä¸ºäº†æ§åˆ¶ redo log çš„å†™å…¥ç­–ç•¥ï¼ŒInnoDB æä¾›äº† innodb_flush_log_at_trx_commit å‚ æ•°ï¼Œå®ƒæœ‰ä¸‰ç§å¯èƒ½å–å€¼: 0ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½åªæ˜¯æŠŠ redo log ç•™åœ¨ redo log buffer ä¸­ ; 1ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½å°† redo log ç›´æ¥æŒä¹…åŒ–åˆ°ç£ç›˜; 2 ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½åªæ˜¯æŠŠ redo log å†™åˆ° page cacheã€‚ InnoDB æœ‰ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œæ¯éš” 1 ç§’ï¼Œå°±ä¼šæŠŠ redo log buffer ä¸­çš„æ—¥å¿—ï¼Œè°ƒç”¨ write å†™ åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ page cacheï¼Œç„¶åè°ƒç”¨ fsync æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚ å®é™…ä¸Šï¼Œé™¤äº†åå°çº¿ç¨‹æ¯ç§’ä¸€æ¬¡çš„è½®è¯¢æ“ä½œå¤–ï¼Œè¿˜æœ‰ä¸¤ç§åœºæ™¯ä¼šè®©ä¸€ä¸ªæ²¡æœ‰æäº¤çš„äº‹åŠ¡çš„ redo log å†™å…¥åˆ°ç£ç›˜ä¸­ã€‚ 1. redo log buffer å ç”¨çš„ç©ºé—´å³å°†è¾¾åˆ° innodb_log_buffer_size ä¸€åŠçš„æ—¶ å€™ï¼Œåå°çº¿ç¨‹ä¼šä¸»åŠ¨å†™ç›˜ã€‚æ³¨æ„ï¼Œç”±äºè¿™ä¸ªäº‹åŠ¡å¹¶æ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥è¿™ä¸ªå†™ç›˜åŠ¨ä½œåªæ˜¯ writeï¼Œè€Œæ²¡æœ‰è°ƒç”¨ fsyncï¼Œä¹Ÿå°±æ˜¯åªç•™åœ¨äº†æ–‡ä»¶ç³»ç»Ÿçš„ page cacheã€‚ 2. å¹¶è¡Œçš„äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œé¡ºå¸¦å°†è¿™ä¸ªäº‹åŠ¡çš„ redo log buffer æŒä¹…åŒ–åˆ°ç£ ç›˜ã€‚å‡è®¾ä¸€ä¸ªäº‹åŠ¡ A æ‰§è¡Œåˆ°ä¸€åŠï¼Œå·²ç»å†™äº†ä¸€äº› redo log åˆ° buffer ä¸­ï¼Œè¿™æ—¶å€™æœ‰å¦ å¤–ä¸€ä¸ªçº¿ç¨‹çš„äº‹åŠ¡ B æäº¤ï¼Œå¦‚æœ innodb_flush_log_at_trx_commit è®¾ç½®çš„æ˜¯ 1ï¼Œé‚£ä¹ˆ æŒ‰ç…§è¿™ä¸ªå‚æ•°çš„é€»è¾‘ï¼Œäº‹åŠ¡ B è¦æŠŠ redo log buffer é‡Œçš„æ—¥å¿—å…¨éƒ¨æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚è¿™æ—¶ å€™ï¼Œå°±ä¼šå¸¦ä¸Šäº‹åŠ¡ A åœ¨ redo log buffer é‡Œçš„æ—¥å¿—ä¸€èµ·æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚ æ—¢ç„¶MySQLèƒ½ä¿è¯redo logå’Œbinlogèƒ½å¯é æ€§å†™å…¥ç£ç›˜ï¼Œé‚£ä¹ˆåœ¨ä»–ä»¬ä¸¤è€…ç›´æ¥å¦‚ä½•ä¿è¯å¯é è½¬æ¢çš„å‘¢ï¼Ÿ ä¸¤é˜¶æ®µæäº¤redo log å…ˆ prepareï¼Œå†å†™ binlogï¼Œæœ€åå†æŠŠ redo log commitã€‚åˆ©ç”¨è¿™ä¸ªä¸¤é˜¶æ®µæäº¤æœºåˆ¶ï¼ŒMySQLä¿è¯äº†redo logå’Œbinlogçš„å¯é ä¼ è¾“ã€‚ æœ€åæˆ‘ä»¬æ¥çœ‹ä¸‹æ•´ä½“ç®€å›¾ï¼š é…ç½®å»ºè®® innodb_flush_log_at_trx_commit=1ã€‚è¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡çš„redologéƒ½ç›´æ¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œä¿è¯mysqlé‡å¯åæ•°æ®ä¸ä¸¢å¤±ã€‚ sync_binlog=1ã€‚è¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡çš„binlogéƒ½ç›´æ¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œä¿è¯mysqlé‡å¯åbinlogè®°å½•æ˜¯å®Œæ•´çš„ã€‚","categories":[{"name":"MySQL","slug":"MySQL","permalink":"https://github.13sai.com/categories/MySQL/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"MySQLä¸»ä»","slug":"MySQLä¸»ä»","date":"2020-03-17T13:46:08.000Z","updated":"2022-03-19T15:36:19.213Z","comments":true,"path":"2020/03/17/MySQL-master-slave/","link":"","permalink":"https://github.13sai.com/2020/03/17/MySQL-master-slave/","excerpt":"","text":"æœ¬æ–‡ä¸ºæå®¢æ—¶é—´ä¸“æ ã€ŠMySQLå®æˆ˜45è®²ã€‹ç¬”è®°ï¼Œæ–‡ä¸­éƒ¨åˆ†å›¾æ–‡æ¥è‡ªè¯¥ä¸“æ ã€‚é™„ä¸Šä¸“æ é“¾æ¥ï¼Œæœ‰å…´è¶£å¯ç‚¹å‡»è®¢é˜…ï¼šhttps://time.geekbang.org/column/intro/139 æ˜¨å¤©çš„æ–‡ç« æˆ‘ä»¬æ“ä½œäº†ä¸»ä»å¤åˆ¶ï¼Œé‚£ä¹ˆä½ æœ‰ä»”ç»†æƒ³ä¸€æƒ³å·¥ä½œåŸç†å—ï¼Ÿ ä¸»ä»åŒæ­¥å¤åˆ¶åŸç†å¤åˆ¶ç®€å•åˆ†æˆä¸‰æ­¥ï¼š masterå°†æ”¹å˜è®°å½•åˆ°äºŒè¿›åˆ¶æ—¥å¿—(binary log)ä¸­ï¼ˆè¿™äº›è®°å½•å«åšäºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶ï¼Œbinary log eventsï¼‰ï¼› slaveå°†masterçš„binary log eventsæ‹·è´åˆ°å®ƒçš„ä¸­ç»§æ—¥å¿—(relay log)ï¼› slaveé‡åšä¸­ç»§æ—¥å¿—ä¸­çš„äº‹ä»¶ï¼Œå°†æ”¹å˜åæ˜ å®ƒè‡ªå·±çš„æ•°æ®ã€‚ å½“ç„¶ï¼Œå…¶ä¸­çš„ç»†èŠ‚æ˜¯å¾ˆå¤æ‚çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹æå®¢æ—¶é—´ã€ŠMySQLå®æˆ˜45è®²ã€‹ä¸“æ çš„å›¾ï¼š ä¸»åº“æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„æ›´æ–°è¯·æ±‚åï¼Œæ‰§è¡Œå†…éƒ¨äº‹åŠ¡çš„æ›´æ–°é€»è¾‘ï¼ŒåŒæ—¶å†™binlogã€‚ è€Œå¤‡åº“Bè·Ÿä¸»åº“Aä¹‹é—´ç»´æŒäº†ä¸€ä¸ªé•¿è¿æ¥ã€‚ä¸»åº“Aå†…éƒ¨æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸“é—¨ç”¨äºæœåŠ¡å¤‡åº“Bçš„è¿™ä¸ªé•¿è¿æ¥ã€‚ä¸€ä¸ªäº‹åŠ¡æ—¥å¿—åŒæ­¥çš„å®Œæ•´è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š åœ¨å¤‡åº“Bä¸Šé€šè¿‡change masterå‘½ä»¤ï¼Œè®¾ç½®ä¸»åº“Açš„IPã€ç«¯å£ã€ç”¨æˆ·åã€å¯†ç ï¼Œä»¥åŠè¦ä»å“ªä¸ªä½ç½®å¼€å§‹è¯·æ±‚binlogï¼Œè¿™ä¸ªä½ç½®åŒ…å«æ–‡ä»¶åå’Œæ—¥å¿—åç§»é‡ã€‚ åœ¨å¤‡åº“Bä¸Šæ‰§è¡Œstart slaveå‘½ä»¤ï¼Œè¿™æ—¶å€™å¤‡åº“ä¼šå¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹ï¼Œå°±æ˜¯å›¾ä¸­çš„io_threadå’Œsql_threadã€‚å…¶ä¸­io_threadè´Ÿè´£ä¸ä¸»åº“å»ºç«‹è¿æ¥ã€‚ ä¸»åº“Aæ ¡éªŒå®Œç”¨æˆ·åã€å¯†ç åï¼Œå¼€å§‹æŒ‰ç…§å¤‡åº“Bä¼ è¿‡æ¥çš„ä½ç½®ï¼Œä»æœ¬åœ°è¯»å–binlogï¼Œå‘ç»™Bã€‚ å¤‡åº“Bæ‹¿åˆ°binlogåï¼Œå†™åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œç§°ä¸ºä¸­è½¬æ—¥å¿—ï¼ˆrelay logï¼‰ã€‚ sql_threadè¯»å–ä¸­è½¬æ—¥å¿—ï¼Œè§£æå‡ºæ—¥å¿—é‡Œçš„å‘½ä»¤ï¼Œå¹¶æ‰§è¡Œã€‚ binlogé‡Œè®°å½•çš„æ˜¯ä»€ä¹ˆï¼Ÿé‚£ä¹ˆä»‹ç»äº†å·¥ä½œåŸç†ï¼Œä¹‹å‰ä¹Ÿæœ‰æ–‡ç« ä»‹ç»è¿‡binlogï¼Œé‚£ä¹ˆbinlogé‡Œåˆ°åº•è®°å½•çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ binlogæ ¹æ®é…ç½®è®°å½•çš„å†…å®¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬çœ‹è¡¨æ ¼ï¼š format å®šä¹‰ ä¼˜ç‚¹ ç¼ºç‚¹ statement è®°å½•çš„æ˜¯ä¿®æ”¹SQLè¯­å¥ æ—¥å¿—æ–‡ä»¶å°ï¼ŒèŠ‚çº¦IOï¼Œæé«˜æ€§èƒ½ å‡†ç¡®æ€§å·®ï¼Œå¯¹ä¸€äº›ç³»ç»Ÿå‡½æ•°ä¸èƒ½å‡†ç¡®å¤åˆ¶æˆ–ä¸èƒ½å¤åˆ¶ï¼Œå¦‚now()ã€uuid()ç­‰ row è®°å½•çš„æ˜¯æ¯è¡Œå®é™…æ•°æ®çš„å˜æ›´ å‡†ç¡®æ€§å¼ºï¼Œèƒ½å‡†ç¡®å¤åˆ¶æ•°æ®çš„å˜æ›´ æ—¥å¿—æ–‡ä»¶å¤§ï¼Œè¾ƒå¤§çš„ç½‘ç»œIOå’Œç£ç›˜IO mixed statementå’Œrowæ¨¡å¼çš„æ··åˆ å‡†ç¡®æ€§å¼ºï¼Œæ–‡ä»¶å¤§å°é€‚ä¸­ æœ‰å¯èƒ½å‘ç”Ÿä¸»ä»ä¸ä¸€è‡´é—®é¢˜ æ¨èä½¿ç”¨çš„æ˜¯rowæ¨¡å¼ï¼Œå‡†ç¡®æ€§é«˜ï¼Œè™½ç„¶è¯´æ–‡ä»¶å¤§ï¼Œä½†æ˜¯ç°åœ¨æœ‰SSDå’Œä¸‡å…†å…‰çº¤ç½‘ç»œï¼Œè¿™äº›ç£ç›˜IOå’Œç½‘ç»œIOéƒ½æ˜¯å¯ä»¥æ¥å—çš„ã€‚ mixedæ ¼å¼çš„æ„æ€æ˜¯ï¼ŒMySQLè‡ªå·±ä¼šåˆ¤æ–­è¿™æ¡SQLè¯­å¥æ˜¯å¦å¯èƒ½å¼•èµ·ä¸»å¤‡ä¸ä¸€è‡´ï¼Œå¦‚æœæœ‰å¯èƒ½ï¼Œå°±ç”¨rowæ ¼å¼ï¼Œå¦åˆ™å°±ç”¨statementæ ¼å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œmixedæ ¼å¼å¯ä»¥åˆ©ç”¨statmentæ ¼å¼çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶åˆé¿å…äº†æ•°æ®ä¸ä¸€è‡´çš„é£é™©ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨mixedæ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä¸¾ä¾‹è¯´æ˜ï¼ˆæ•°æ®æ¢å¤ï¼‰ï¼š æˆ‘ä»¬å°±åˆ†åˆ«ä»deleteã€insertå’Œupdateè¿™ä¸‰ç§SQLè¯­å¥çš„è§’åº¦ï¼Œæ¥çœ‹çœ‹æ•°æ®æ¢å¤çš„é—®é¢˜ã€‚ å³ä½¿æ‰§è¡Œçš„æ˜¯deleteè¯­å¥ï¼Œrowæ ¼å¼çš„binlogä¹Ÿä¼šæŠŠè¢«åˆ æ‰çš„è¡Œçš„æ•´è¡Œä¿¡æ¯ä¿å­˜èµ·æ¥ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ åœ¨æ‰§è¡Œå®Œä¸€æ¡deleteè¯­å¥ä»¥åï¼Œå‘ç°åˆ é”™æ•°æ®äº†ï¼Œå¯ä»¥ç›´æ¥æŠŠbinlogä¸­è®°å½•çš„deleteè¯­å¥è½¬æˆinsertï¼ŒæŠŠè¢«é”™åˆ çš„æ•°æ®æ’å…¥å›å»å°±å¯ä»¥æ¢å¤äº†ã€‚ å¦‚æœä½ æ˜¯æ‰§è¡Œé”™äº†insertè¯­å¥å‘¢ï¼Ÿé‚£å°±æ›´ç›´æ¥äº†ã€‚rowæ ¼å¼ä¸‹ï¼Œinsertè¯­å¥çš„binlogé‡Œä¼šè®°å½•æ‰€æœ‰çš„å­—æ®µä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥ç”¨æ¥ç²¾ç¡®å®šä½åˆšåˆšè¢«æ’å…¥çš„é‚£ä¸€è¡Œã€‚è¿™æ—¶ï¼Œä½ ç›´æ¥æŠŠinsertè¯­å¥è½¬æˆdeleteè¯­å¥ï¼Œåˆ é™¤æ‰è¿™è¢«è¯¯æ’å…¥çš„ä¸€è¡Œæ•°æ®å°±å¯ä»¥äº†ã€‚ å¦‚æœæ‰§è¡Œçš„æ˜¯updateè¯­å¥çš„è¯ï¼Œbinlogé‡Œé¢ä¼šè®°å½•ä¿®æ”¹å‰æ•´è¡Œçš„æ•°æ®å’Œä¿®æ”¹åçš„æ•´è¡Œæ•°æ®ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ è¯¯æ‰§è¡Œäº†updateè¯­å¥çš„è¯ï¼Œåªéœ€è¦æŠŠè¿™ä¸ªeventå‰åçš„ä¸¤è¡Œä¿¡æ¯å¯¹è°ƒä¸€ä¸‹ï¼Œå†å»æ•°æ®åº“é‡Œé¢æ‰§è¡Œï¼Œå°±èƒ½æ¢å¤è¿™ä¸ªæ›´æ–°æ“ä½œäº†ã€‚ å…¶å®ï¼Œç”±deleteã€insertæˆ–è€…updateè¯­å¥å¯¼è‡´çš„æ•°æ®æ“ä½œé”™è¯¯ï¼Œéœ€è¦æ¢å¤åˆ°æ“ä½œä¹‹å‰çŠ¶æ€çš„æƒ…å†µï¼Œä¹Ÿæ—¶æœ‰å‘ç”Ÿã€‚ æŸ¥çœ‹binlogbinlogæœ¬èº«æ˜¯ä¸€ç±»äºŒè¿›åˆ¶æ–‡ä»¶ã€‚äºŒè¿›åˆ¶æ–‡ä»¶æ›´çœç©ºé—´ï¼Œå†™å…¥é€Ÿåº¦æ›´å¿«ï¼Œæ˜¯æ— æ³•ç›´æ¥æ‰“å¼€æ¥æŸ¥çœ‹çš„ã€‚å› æ­¤mysqlæä¾›äº†å‘½ä»¤mysqlbinlogè¿›è¡ŒæŸ¥çœ‹ã€‚ä¸€èˆ¬çš„statementæ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”¨ä¸‹é¢å‘½ä»¤å°±å¯ä»¥ mysqlbinlog mysql-bin.000001 å¦‚æœæ˜¯rowæ ¼å¼ï¼ŒåŠ ä¸Š-væˆ–è€…-vvå‚æ•°å°±è¡Œï¼Œå¦‚ mysqlbinlog -vv mysql-bin.000001 é…ç½®å‚æ•° å‚æ•°å å«ä¹‰ log_bin = {on | off | base_name} æŒ‡å®šæ˜¯å¦å¯ç”¨è®°å½•äºŒè¿›åˆ¶æ—¥å¿—æˆ–è€…æŒ‡å®šä¸€ä¸ªæ—¥å¿—è·¯å¾„ sql_log_bin ={ on | off } æŒ‡å®šæ˜¯å¦å¯ç”¨è®°å½•äºŒè¿›åˆ¶æ—¥å¿— expire_logs_days æŒ‡å®šè‡ªåŠ¨åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—çš„æ—¶é—´ï¼Œå³æ—¥å¿—è¿‡æœŸæ—¶é—´ log_bin_index æŒ‡å®šmysql-bin.indexæ–‡ä»¶çš„è·¯å¾„ binlog_format = { mixed | row | statement } æŒ‡å®šäºŒè¿›åˆ¶æ—¥å¿—åŸºäºä»€ä¹ˆæ¨¡å¼è®°å½• max_binlog_size æŒ‡å®šäºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶æœ€å¤§å€¼ binlog_cache_size æŒ‡å®šäº‹åŠ¡æ—¥å¿—ç¼“å­˜åŒºå¤§å° max_binlog_cache_size æŒ‡å®šäºŒè¿›åˆ¶æ—¥å¿—ç¼“å­˜æœ€å¤§å¤§å° sync_binlog = { 0 | n } æŒ‡å®šå†™ç¼“å†²å¤šå°‘æ¬¡ï¼Œåˆ·ä¸€æ¬¡ç›˜ ä¹‹å‰æ˜¯ä»‹ç»ä¸€äº›æ¦‚å¿µçš„ä¸œè¥¿ï¼Œä»Šå¤©æˆ‘ä»¬æ¥æ¢æ¢å£å‘³ï¼Œå®é™…æ“ä½œä¸€ä¸‹å•Šï¼Œæ“ä½œå†…å®¹æ˜¯æ­å»ºæˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„MySQLä¸»ä»ã€‚ å‰æå·²ç»å®‰è£…å¥½äº†ä¸»æ•°æ®åº“å’Œä»æ•°æ®åº“ï¼Œå¹¶æ–°å»ºdatabaseä¸ºtestï¼Œå‡å¦‚ä¸€äº›æ•°æ®ã€‚ï¼ˆå› ä¸ºæ˜¯æµ‹è¯•ï¼Œå•æœºå™¨ä¸Šå¼€ä¸¤ä¸ªMySQLç¤ºä¾‹ä¹Ÿå¯ä»¥ï¼‰ masterGRANT REPLICATION SLAVE, REPLICATION CLIENT ON . TO repl@&#x27;127.0.0.1&#x27; IDENTIFIED BY &#x27;111111&#x27;; //åˆ†é…è´¦å· grant all on . to repl@&#x27;127.0.0.1&#x27;; //æˆæƒ æŸ¥çœ‹çŠ¶æ€ SHOW MASTER STATUS; //è®°ä½è¿™é‡Œçš„fileå’Œpositionã€‚ ä¿®æ”¹é…ç½® [mysqld] log-bin=mysql-bin server-id=1 é‡å¯ slaveä¿®æ”¹é…ç½®ï¼Œæ³¨æ„server_idè¦ä¸ä¸»åº“ï¼Œå…¶ä»–ä»åº“ä¸ä¸€æ ·ï¼Œå¯ä»¥è®¾ç½®æˆip [mysqld] log_bin = mysql-bin server_id = 2 relay_log = mysql-relay-bin log_slave_updates = 1 read_only = 1 é‡å¯åï¼Œå»ºè®®å…ˆè¿›è¡Œé‡ç½®æ“ä½œã€‚ reset slave è¿æ¥master CHANGE MASTER TO MASTER_HOST=&#x27;127.0.0.1&#x27;,MASTER_USER=&#x27;repl&#x27;, MASTER_PASSWORD=&#x27;111111&#x27;, MASTER_LOG_FILE=&#x27;mysql-bin.000051&#x27;,master_log_pos=8694; master_log_fileå’Œmaster_log_poså°±æ˜¯ä¸Šé¢è®°ä½çš„fileå’Œpositionï¼Œå…·ä½“è‡ªè¡Œä¿®æ”¹ã€‚ å¼€å¯å¹¶æŸ¥çœ‹çŠ¶æ€ start slave show slave status å¦‚æœSlave_IO_Runningå’ŒSlave_SQL_Runningéƒ½æ˜¾ç¤ºYesï¼Œä¸€èˆ¬å°±æˆåŠŸäº†ã€‚ å¤±è´¥ä¸€èˆ¬å°±æ˜¯master_log_posï¼Œmaster_log_fileé…ç½®æœ‰é—®é¢˜ï¼Œé‡æ–°é…ç½®ä¸‹å°±è¡Œäº†ã€‚ å¯ä»¥åœ¨masteræ’å…¥ä¿®æ”¹æ•°æ®ï¼Œæµ‹è¯•slaveæ˜¯å¦ç›¸åº”å˜åŒ–ã€‚ æ³¨æ„å¦‚æœmasterå·²æœ‰æ•°æ®ï¼Œå¯ä»¥é”å®šmasterï¼ˆflush tables with read lockï¼‰ï¼Œç„¶åå¯¼å‡ºåŒæ­¥åˆ°slaveï¼Œé…ç½®å®Œæˆåé‡Šæ”¾masterï¼ˆunlock tablesï¼‰ã€‚ å‚è€ƒæ–‡ç«  ã€åŸåˆ›ã€‘ç ”å‘åº”è¯¥æ‡‚çš„binlogçŸ¥è¯†(ä¸Š) https://www.cnblogs.com/rjzheng/p/9721765.html","categories":[{"name":"MySQL","slug":"MySQL","permalink":"https://github.13sai.com/categories/MySQL/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"MySQLçš„count","slug":"MySQLçš„count","date":"2020-03-15T13:25:48.000Z","updated":"2022-03-19T15:35:23.074Z","comments":true,"path":"2020/03/15/MySQL-count/","link":"","permalink":"https://github.13sai.com/2020/03/15/MySQL-count/","excerpt":"","text":"æœ¬æ–‡ä¸ºæå®¢æ—¶é—´ä¸“æ ã€ŠMySQLå®æˆ˜45è®²ã€‹ç¬”è®°ï¼Œæ–‡ä¸­éƒ¨åˆ†å›¾æ–‡æ¥è‡ªè¯¥ä¸“æ ã€‚ count(*)è¯­å¥åº”è¯¥æ˜¯æˆ‘ä»¬å¼€å‘ä¸­å¾ˆç»å¸¸ç”¨åˆ°çš„,né‚£ä¹ˆä½ æœ‰ä»”ç»†ç ”ç©¶è¿‡å—ï¼Ÿ å®ç°æ–¹å¼ MyISAMå¼•æ“æŠŠä¸€ä¸ªè¡¨çš„æ€»è¡Œæ•°å­˜åœ¨äº†ç£ç›˜ä¸Šï¼Œå› æ­¤æ‰§è¡Œcount()çš„æ—¶å€™ä¼šç›´æ¥è¿”å›è¿™ä¸ªæ•°ï¼Œæ•ˆç‡å¾ˆé«˜ï¼›å¦‚æœåŠ äº†where æ¡ä»¶çš„è¯ï¼ŒMyISAMè¡¨ä¹Ÿæ˜¯ä¸èƒ½è¿”å›å¾—è¿™ä¹ˆå¿«çš„ã€‚è€ŒInnoDBå¼•æ“å°±éº»çƒ¦äº†ï¼Œå®ƒæ‰§è¡Œcount()çš„æ—¶å€™ï¼Œéœ€è¦æŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œåœ°ä»å¼•æ“é‡Œé¢è¯»å‡ºæ¥ï¼Œç„¶ååˆ¤æ–­not nullç´¯ç§¯è®¡æ•°ã€‚ é‚£ä½ å°±é—®äº†ï¼Œä¸ºä»€ä¹ˆInnoDBä¸è·ŸMyISAMä¸€æ ·ï¼Œä¹ŸæŠŠæ•°å­—å­˜èµ·æ¥å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºå³ä½¿æ˜¯åœ¨åŒä¸€ä¸ªæ—¶åˆ»çš„å¤šä¸ªæŸ¥è¯¢ï¼Œç”±äºå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰çš„åŸå› ï¼ŒInnoDBè¡¨â€œåº”è¯¥è¿”å›å¤šå°‘è¡Œâ€ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ã€‚ å‡è®¾è¡¨tä¸­ç°åœ¨æœ‰10000æ¡è®°å½•ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸‰ä¸ªç”¨æˆ·å¹¶è¡Œçš„ä¼šè¯ã€‚ ä¼šè¯Aå…ˆå¯åŠ¨äº‹åŠ¡å¹¶æŸ¥è¯¢ä¸€æ¬¡è¡¨çš„æ€»è¡Œæ•°ï¼› ä¼šè¯Bå¯åŠ¨äº‹åŠ¡ï¼Œæ’å…¥ä¸€è¡Œåè®°å½•åï¼ŒæŸ¥è¯¢è¡¨çš„æ€»è¡Œæ•°ï¼› ä¼šè¯Cå…ˆå¯åŠ¨ä¸€ä¸ªå•ç‹¬çš„è¯­å¥ï¼Œæ’å…¥ä¸€è¡Œè®°å½•åï¼ŒæŸ¥è¯¢è¡¨çš„æ€»è¡Œæ•°ã€‚ æˆ‘ä»¬å‡è®¾ä»ä¸Šåˆ°ä¸‹æ˜¯æŒ‰ç…§æ—¶é—´é¡ºåºæ‰§è¡Œçš„ï¼ŒåŒä¸€è¡Œè¯­å¥æ˜¯åœ¨åŒä¸€æ—¶åˆ»æ‰§è¡Œçš„ã€‚ ä½ ä¼šçœ‹åˆ°ï¼Œåœ¨æœ€åä¸€ä¸ªæ—¶åˆ»ï¼Œä¸‰ä¸ªä¼šè¯Aã€Bã€Cä¼šåŒæ—¶æŸ¥è¯¢è¡¨tçš„æ€»è¡Œæ•°ï¼Œä½†æ‹¿åˆ°çš„ç»“æœå´ä¸åŒã€‚ è¿™å’ŒInnoDBçš„äº‹åŠ¡è®¾è®¡æœ‰å…³ç³»ï¼Œå¯é‡å¤è¯»æ˜¯å®ƒé»˜è®¤çš„éš”ç¦»çº§åˆ«ï¼Œåœ¨ä»£ç ä¸Šå°±æ˜¯é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶æ¥å®ç°çš„ã€‚æ¯ä¸€è¡Œè®°å½•éƒ½è¦åˆ¤æ–­è‡ªå·±æ˜¯å¦å¯¹è¿™ä¸ªä¼šè¯å¯è§ï¼Œå› æ­¤å¯¹äºcount(*)è¯·æ±‚æ¥è¯´ï¼ŒInnoDBåªå¥½æŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œåœ°è¯»å‡ºä¾æ¬¡åˆ¤æ–­ï¼Œå¯è§çš„è¡Œæ‰èƒ½å¤Ÿç”¨äºè®¡ç®—â€œåŸºäºè¿™ä¸ªæŸ¥è¯¢â€çš„è¡¨çš„æ€»è¡Œæ•°ã€‚ å½“ç„¶ï¼Œç°åœ¨è¿™ä¸ªçœ‹ä¸Šå»ç¬¨ç¬¨çš„MySQLï¼Œåœ¨æ‰§è¡Œcount(*)æ“ä½œçš„æ—¶å€™è¿˜æ˜¯åšäº†ä¼˜åŒ–çš„ã€‚ InnoDBæ”¯æŒçš„æ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼Œä¸»é”®ç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹æ˜¯æ•°æ®ï¼Œè€Œæ™®é€šç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹æ˜¯ä¸»é”®å€¼ã€‚æ‰€ä»¥ï¼Œæ™®é€šç´¢å¼•æ ‘æ¯”ä¸»é”®ç´¢å¼•æ ‘å°å¾ˆå¤šã€‚å¯¹äºcount(*)è¿™æ ·çš„æ“ä½œï¼Œéå†å“ªä¸ªç´¢å¼•æ ‘å¾—åˆ°çš„ç»“æœé€»è¾‘ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ã€‚å› æ­¤ï¼ŒMySQLä¼˜åŒ–å™¨ä¼šæ‰¾åˆ°æœ€å°çš„é‚£æ£µæ ‘æ¥éå†ã€‚ åœ¨ä¿è¯é€»è¾‘æ­£ç¡®çš„å‰æä¸‹ï¼Œå°½é‡å‡å°‘æ‰«æçš„æ•°æ®é‡ï¼Œæ˜¯æ•°æ®åº“ç³»ç»Ÿè®¾è®¡çš„é€šç”¨æ³•åˆ™ä¹‹ä¸€ã€‚ å¦‚æœä½ ç”¨è¿‡show table status å‘½ä»¤çš„è¯ï¼Œå°±ä¼šå‘ç°è¿™ä¸ªå‘½ä»¤çš„è¾“å‡ºç»“æœé‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªTABLE_ROWSç”¨äºæ˜¾ç¤ºè¿™ä¸ªè¡¨å½“å‰æœ‰å¤šå°‘è¡Œï¼Œè¿™ä¸ªå‘½ä»¤æ‰§è¡ŒæŒºå¿«çš„ï¼Œé‚£è¿™ä¸ªTABLE_ROWSèƒ½ä»£æ›¿count(*)å—ï¼Ÿ è€Œç´¢å¼•ç»Ÿè®¡çš„å€¼æ˜¯é€šè¿‡é‡‡æ ·æ¥ä¼°ç®—çš„ï¼Œå®é™…ä¸Šï¼ŒTABLE_ROWSå°±æ˜¯ä»è¿™ä¸ªé‡‡æ ·ä¼°ç®—å¾—æ¥çš„ï¼Œå› æ­¤å®ƒä¹Ÿä¸æ˜¯å¾ˆå‡†ã€‚æœ‰å¤šä¸å‡†å‘¢ï¼Œå®˜æ–¹æ–‡æ¡£è¯´è¯¯å·®å¯èƒ½è¾¾åˆ°40%åˆ°50%ã€‚æ‰€ä»¥ï¼Œshow table statuså‘½ä»¤æ˜¾ç¤ºçš„è¡Œæ•°ä¹Ÿä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚ MyISAMè¡¨è™½ç„¶count(*)å¾ˆå¿«ï¼Œä½†æ˜¯ä¸æ”¯æŒäº‹åŠ¡ï¼›show table statuså‘½ä»¤è™½ç„¶è¿”å›å¾ˆå¿«ï¼Œä½†æ˜¯ä¸å‡†ç¡®ï¼›InnoDBè¡¨ç›´æ¥count(*)ä¼šéå†å…¨è¡¨ï¼Œè™½ç„¶ç»“æœå‡†ç¡®ï¼Œä½†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚ é‚£ä¹ˆï¼Œå¦‚æœä½ ç°åœ¨æœ‰ä¸€ä¸ªé¡µé¢ç»å¸¸è¦æ˜¾ç¤ºè®°å½•æ€»æ•°ï¼Œåˆ°åº•åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬æœªå¿…å°±åªèƒ½çº ç»“äºcountï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±é¢å¤–è®¡æ•°ã€‚ è®¡æ•°æ–¹æ³•ç¼“å­˜è®¡æ•°å¯¹äºæ›´æ–°å¾ˆé¢‘ç¹çš„åº“æ¥è¯´ï¼Œä½ å¯èƒ½ä¼šç¬¬ä¸€æ—¶é—´æƒ³åˆ°ï¼Œç”¨ç¼“å­˜ç³»ç»Ÿæ¥æ”¯æŒï¼Œæ¯”å¦‚Redisã€‚ æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªRedisæœåŠ¡æ¥ä¿å­˜è¿™ä¸ªè¡¨çš„æ€»è¡Œæ•°ï¼Œè¯»å’Œæ›´æ–°æ“ä½œéƒ½å¾ˆå¿«ã€‚ å½“ç„¶ï¼Œä½¿ç”¨Rediså­˜å‚¨è®¡æ•°æ˜¯æœ‰ä¸€äº›é—®é¢˜çš„ã€‚ é¦–å…ˆï¼Œæ— æ³•ä¿è¯Rediså®Œå…¨å¯ç”¨ï¼Œå‡å¦‚å¼‚å¸¸æŒ‚æ‰ï¼Œæˆ‘ä»¬æ— æ³•ä¿è¯MySQLå’ŒRedisæ•°æ®çš„ä¸€è‡´æ€§ã€‚ å…¶æ¬¡ï¼Œå³ä½¿Redisæ­£å¸¸å¯ç”¨ï¼Œè®¡æ•°ä¹Ÿå¹¶ä¸ç²¾ç¡®ï¼Œå› ä¸ºMySQLå’ŒRediså­˜å‚¨å¿…ç„¶æœ‰å…ˆåä¹‹åˆ†ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¤šä¸ªä¼šè¯ä»Rediså’ŒMySQLè¯»åˆ°çš„æ•°æ®å¾ˆå¯èƒ½æ˜¯ä¸ä¸€è‡´çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å›¾ç‰‡ï¼Œå°±ä¸å±•å¼€è¯´æ˜äº†ã€‚ å½“ç„¶äº†ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼Œå› ä¸ºä¸šåŠ¡å¹¶ä¸è¦ä¿è¯æ•°æ®æ¯æ—¶æ¯åˆ»éƒ½æ˜¯ç²¾ç¡®çš„ï¼Œé‚£å°±æ— éœ€è€ƒè™‘è¿™äº›é—®é¢˜ï¼ŒRediså¼‚å¸¸åæˆ‘ä»¬å¯ä»¥ä»è®¡ç®—è¡¨è¡Œæ•°å»æ›´æ–°ã€‚ æ•°æ®åº“è®¡æ•°æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨MySQlæ–°å»ºä¸€å¼ è¡¨å»è®¡æ•°ã€‚é‚£ä¹ˆé’ˆå¯¹ç¼“å­˜è®¡æ•°çš„ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸‹ï¼š é¦–å…ˆï¼Œè¿™è§£å†³äº†å´©æºƒä¸¢å¤±çš„é—®é¢˜ï¼ŒInnoDBæ˜¯æ”¯æŒå´©æºƒæ¢å¤ä¸ä¸¢æ•°æ®çš„ã€‚ ç„¶åï¼Œæˆ‘ä»¬å†çœ‹çœ‹èƒ½ä¸èƒ½è§£å†³è®¡æ•°ä¸ç²¾ç¡®çš„é—®é¢˜ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬æœ‰â€œäº‹åŠ¡â€è¿™ä¸ªå¤§æ€å™¨ï¼Œå¯ä»¥ä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚ ä¸åŒçš„countç”¨æ³•å¯¹æ¯” count(ä¸»é”®id)ï¼šInnoDBå¼•æ“ä¼šéå†æ•´å¼ è¡¨ï¼ŒæŠŠæ¯ä¸€è¡Œçš„idå€¼éƒ½å–å‡ºæ¥ï¼Œè¿”å›ç»™serverå±‚ã€‚serverå±‚æ‹¿åˆ°idåï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºnullï¼Œå°±æŒ‰è¡Œç´¯åŠ ã€‚ count(1)ï¼šInnoDBå¼•æ“éå†æ•´å¼ è¡¨ï¼Œä½†ä¸å–å€¼ã€‚serverå±‚å¯¹äºè¿”å›çš„æ¯ä¸€è¡Œï¼Œæ”¾ä¸€ä¸ªæ•°å­—â€œ1â€è¿›å»ï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºnullï¼ŒæŒ‰è¡Œç´¯åŠ ï¼Œæ˜¾ç„¶è¿™æ¯”ä¸Šé¢çš„æ•ˆç‡è¦é«˜ä¸€äº›ã€‚ count(å­—æ®µ)ï¼šå¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€æ˜¯å®šä¹‰ä¸ºnot nullçš„è¯ï¼Œä¸€è¡Œè¡Œåœ°ä»è®°å½•é‡Œé¢è¯»å‡ºè¿™ä¸ªå­—æ®µï¼Œåˆ¤æ–­ä¸èƒ½ä¸ºnullï¼ŒæŒ‰è¡Œç´¯åŠ ï¼›å¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€å®šä¹‰å…è®¸ä¸ºnullï¼Œé‚£ä¹ˆæ‰§è¡Œçš„æ—¶å€™ï¼Œåˆ¤æ–­åˆ°æœ‰å¯èƒ½æ˜¯nullï¼Œè¿˜è¦æŠŠå€¼å–å‡ºæ¥å†åˆ¤æ–­ä¸€ä¸‹ï¼Œä¸æ˜¯nullæ‰ç´¯åŠ ã€‚ count()ï¼šæ˜¯ä¾‹å¤–ï¼Œå¹¶ä¸ä¼šæŠŠå…¨éƒ¨å­—æ®µå–å‡ºæ¥ï¼Œè€Œæ˜¯ä¸“é—¨åšäº†ä¼˜åŒ–ï¼Œä¸å–å€¼ã€‚count()è‚¯å®šä¸æ˜¯nullï¼ŒæŒ‰è¡Œç´¯åŠ ã€‚ æŒ‰ç…§æ•ˆç‡æ’åºçš„è¯ï¼Œcount(å­—æ®µ)&lt;count(ä¸»é”®id)&lt;count(1)â‰ˆcount(*)ï¼Œæ‰€ä»¥æˆ‘å»ºè®®ä½ ï¼Œå°½é‡ä½¿ç”¨count(*)ã€‚","categories":[{"name":"MySQL","slug":"MySQL","permalink":"https://github.13sai.com/categories/MySQL/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"MySQLçš„é”","slug":"MySQLçš„é”","date":"2020-03-14T13:52:16.000Z","updated":"2022-03-19T15:35:12.805Z","comments":true,"path":"2020/03/14/MySQL-lock/","link":"","permalink":"https://github.13sai.com/2020/03/14/MySQL-lock/","excerpt":"","text":"æœ¬æ–‡ä¸ºæå®¢æ—¶é—´ä¸“æ ã€ŠMySQLå®æˆ˜45è®²ã€‹ç¬”è®°ï¼Œæ–‡ä¸­éƒ¨åˆ†å›¾æ–‡æ¥è‡ªè¯¥ä¸“æ ã€‚ é”æ˜¯MySQLä¸­ç»å¸¸ç”¨åˆ°çš„ï¼Œæ ¹æ®åŠ é”çš„èŒƒå›´ï¼ŒMySQLé‡Œé¢çš„é”å¤§è‡´å¯ä»¥åˆ†æˆå…¨å±€é”ã€è¡¨çº§é”å’Œè¡Œé”ä¸‰ç±»ã€‚ å…¨å±€é”é¡¾åæ€ä¹‰ï¼Œå…¨å±€é”å°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ã€‚ MySQLæä¾›äº†ä¸€ä¸ªåŠ å…¨å±€è¯»é”çš„æ–¹æ³•ï¼Œå‘½ä»¤æ˜¯ Flush tables with read lock (FTWRL)ã€‚ å½“ä½ éœ€è¦è®©æ•´ä¸ªåº“å¤„äºåªè¯»çŠ¶æ€çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œä¹‹åå…¶ä»–çº¿ç¨‹çš„ä»¥ä¸‹è¯­å¥ä¼šè¢«é˜»å¡ï¼šæ•°æ®æ›´æ–°è¯­å¥ï¼ˆæ•°æ®çš„å¢åˆ æ”¹ï¼‰ã€æ•°æ®å®šä¹‰è¯­å¥ï¼ˆåŒ…æ‹¬å»ºè¡¨ã€ä¿®æ”¹è¡¨ç»“æ„ç­‰ï¼‰å’Œæ›´æ–°ç±»äº‹åŠ¡çš„æäº¤è¯­å¥ã€‚ å…¸å‹ä½¿ç”¨åœºæ™¯æ˜¯ï¼Œåšå…¨åº“é€»è¾‘å¤‡ä»½ã€‚ å®˜æ–¹è‡ªå¸¦çš„é€»è¾‘å¤‡ä»½å·¥å…·æ˜¯mysqldumpã€‚å½“mysqldumpä½¿ç”¨å‚æ•°â€“single-transactionçš„æ—¶å€™ï¼Œå¯¼æ•°æ®ä¹‹å‰å°±ä¼šå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œæ¥ç¡®ä¿æ‹¿åˆ°ä¸€è‡´æ€§è§†å›¾ã€‚è€Œç”±äºMVCCçš„æ”¯æŒï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­æ•°æ®æ˜¯å¯ä»¥æ­£å¸¸æ›´æ–°çš„ã€‚ è¡¨é”MySQLé‡Œé¢è¡¨çº§åˆ«çš„é”æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯è¡¨é”ï¼Œä¸€ç§æ˜¯å…ƒæ•°æ®é”ï¼ˆmeta data lockï¼ŒMDL)ã€‚ è¡¨é”çš„è¯­æ³•æ˜¯ lock tables â€¦ read/writeã€‚ ä¸FTWRLç±»ä¼¼ï¼Œå¯ä»¥ç”¨unlock tablesä¸»åŠ¨é‡Šæ”¾é”ï¼Œä¹Ÿå¯ä»¥åœ¨å®¢æˆ·ç«¯æ–­å¼€çš„æ—¶å€™è‡ªåŠ¨é‡Šæ”¾ã€‚éœ€è¦æ³¨æ„ï¼Œlock tablesè¯­æ³•é™¤äº†ä¼šé™åˆ¶åˆ«çš„çº¿ç¨‹çš„è¯»å†™å¤–ï¼Œä¹Ÿé™å®šäº†æœ¬çº¿ç¨‹æ¥ä¸‹æ¥çš„æ“ä½œå¯¹è±¡ã€‚ ä¸¾ä¸ªä¾‹å­, å¦‚æœåœ¨æŸä¸ªçº¿ç¨‹Aä¸­æ‰§è¡Œ lock tables t1 read, t2 write è¿™ä¸ªè¯­å¥ï¼Œåˆ™å…¶ä»–çº¿ç¨‹å†™t1ã€è¯»å†™t2çš„è¯­å¥éƒ½ä¼šè¢«é˜»å¡ã€‚åŒæ—¶ï¼Œçº¿ç¨‹Aåœ¨æ‰§è¡Œunlock tablesä¹‹å‰ï¼Œä¹Ÿåªèƒ½æ‰§è¡Œè¯»t1ã€è¯»å†™t2çš„æ“ä½œã€‚è¿å†™t1éƒ½ä¸å…è®¸ï¼Œè‡ªç„¶ä¹Ÿä¸èƒ½è®¿é—®å…¶ä»–è¡¨ã€‚ åœ¨è¿˜æ²¡æœ‰å‡ºç°æ›´ç»†ç²’åº¦çš„é”çš„æ—¶å€™ï¼Œè¡¨é”æ˜¯æœ€å¸¸ç”¨çš„å¤„ç†å¹¶å‘çš„æ–¹å¼ã€‚è€Œå¯¹äºInnoDBè¿™ç§æ”¯æŒè¡Œé”çš„å¼•æ“ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨lock tableså‘½ä»¤æ¥æ§åˆ¶å¹¶å‘ï¼Œæ¯•ç«Ÿé”ä½æ•´ä¸ªè¡¨çš„å½±å“é¢è¿˜æ˜¯å¤ªå¤§ã€‚ å¦ä¸€ç±»è¡¨çº§çš„é”æ˜¯MDLï¼ˆmetadata lock)ã€‚ MDLä¸éœ€è¦æ˜¾å¼ä½¿ç”¨ï¼Œåœ¨è®¿é—®ä¸€ä¸ªè¡¨çš„æ—¶å€™ä¼šè¢«è‡ªåŠ¨åŠ ä¸Šã€‚ MDLçš„ä½œç”¨æ˜¯ï¼Œä¿è¯è¯»å†™çš„æ­£ç¡®æ€§ã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªæŸ¥è¯¢æ­£åœ¨éå†ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œè€Œæ‰§è¡ŒæœŸé—´å¦ä¸€ä¸ªçº¿ç¨‹å¯¹è¿™ä¸ªè¡¨ç»“æ„åšå˜æ›´ï¼Œåˆ äº†ä¸€åˆ—ï¼Œé‚£ä¹ˆæŸ¥è¯¢çº¿ç¨‹æ‹¿åˆ°çš„ç»“æœè·Ÿè¡¨ç»“æ„å¯¹ä¸ä¸Šï¼Œè‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚ å› æ­¤ï¼Œåœ¨MySQL 5.5ç‰ˆæœ¬ä¸­å¼•å…¥äº†MDLï¼Œå½“å¯¹ä¸€ä¸ªè¡¨åšå¢åˆ æ”¹æŸ¥æ“ä½œçš„æ—¶å€™ï¼ŒåŠ MDLè¯»é”ï¼›å½“è¦å¯¹è¡¨åšç»“æ„å˜æ›´æ“ä½œçš„æ—¶å€™ï¼ŒåŠ MDLå†™é”ã€‚ è¯»é”ä¹‹é—´ä¸äº’æ–¥ï¼Œå› æ­¤ä½ å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹ä¸€å¼ è¡¨å¢åˆ æ”¹æŸ¥ã€‚ è¯»å†™é”ä¹‹é—´ã€å†™é”ä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œç”¨æ¥ä¿è¯å˜æ›´è¡¨ç»“æ„æ“ä½œçš„å®‰å…¨æ€§ã€‚å› æ­¤ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹è¦åŒæ—¶ç»™ä¸€ä¸ªè¡¨åŠ å­—æ®µï¼Œå…¶ä¸­ä¸€ä¸ªè¦ç­‰å¦ä¸€ä¸ªæ‰§è¡Œå®Œæ‰èƒ½å¼€å§‹æ‰§è¡Œã€‚ è™½ç„¶MDLé”æ˜¯ç³»ç»Ÿé»˜è®¤ä¼šåŠ çš„ï¼Œä½†å´æ˜¯ä½ ä¸èƒ½å¿½ç•¥çš„ä¸€ä¸ªæœºåˆ¶ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ç»å¸¸çœ‹åˆ°æœ‰äººæ‰åˆ°è¿™ä¸ªå‘é‡Œï¼šç»™ä¸€ä¸ªå°è¡¨åŠ ä¸ªå­—æ®µï¼Œå¯¼è‡´æ•´ä¸ªåº“æŒ‚äº†ã€‚ è¡Œé”MySQLçš„è¡Œé”æ˜¯åœ¨å¼•æ“å±‚ç”±å„ä¸ªå¼•æ“è‡ªå·±å®ç°çš„ã€‚ä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„å¼•æ“éƒ½æ”¯æŒè¡Œé”ï¼Œæ¯”å¦‚MyISAMå¼•æ“å°±ä¸æ”¯æŒè¡Œé”ã€‚ä¸æ”¯æŒè¡Œé”æ„å‘³ç€å¹¶å‘æ§åˆ¶åªèƒ½ä½¿ç”¨è¡¨é”ï¼Œå¯¹äºè¿™ç§å¼•æ“çš„è¡¨ï¼ŒåŒä¸€å¼ è¡¨ä¸Šä»»ä½•æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªæ›´æ–°åœ¨æ‰§è¡Œï¼Œè¿™å°±ä¼šå½±å“åˆ°ä¸šåŠ¡å¹¶å‘åº¦ã€‚InnoDBæ˜¯æ”¯æŒè¡Œé”çš„ï¼Œè¿™ä¹Ÿæ˜¯MyISAMè¢«InnoDBæ›¿ä»£çš„é‡è¦åŸå› ä¹‹ä¸€ã€‚ åœ¨InnoDBäº‹åŠ¡ä¸­ï¼Œè¡Œé”æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰åŠ ä¸Šçš„ï¼Œä½†å¹¶ä¸æ˜¯ä¸éœ€è¦äº†å°±ç«‹åˆ»é‡Šæ”¾ï¼Œè€Œæ˜¯è¦ç­‰åˆ°äº‹åŠ¡ç»“æŸæ—¶æ‰é‡Šæ”¾ã€‚è¿™ä¸ªå°±æ˜¯ä¸¤é˜¶æ®µé”åè®®ã€‚ æ­»é” æ‰€è°“æ­»é”: æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­,å› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡,è‹¥æ— å¤–åŠ›ä½œç”¨,å®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å».æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”,è¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰ç«ºçš„è¿›ç¨‹ç§°ä¸ºæ­»é”è¿›ç¨‹.è¡¨çº§é”ä¸ä¼šäº§ç”Ÿæ­»é”.æ‰€ä»¥è§£å†³æ­»é”ä¸»è¦è¿˜æ˜¯é’ˆå¯¹äºæœ€å¸¸ç”¨çš„InnoDB. å½“å‡ºç°æ­»é”ä»¥åï¼Œæœ‰ä¸¤ç§ç­–ç•¥ï¼š ä¸€ç§ç­–ç•¥æ˜¯ï¼Œç›´æ¥è¿›å…¥ç­‰å¾…ï¼Œç›´åˆ°è¶…æ—¶ã€‚è¿™ä¸ªè¶…æ—¶æ—¶é—´å¯ä»¥é€šè¿‡å‚æ•°innodb_lock_wait_timeoutæ¥è®¾ç½®ã€‚å¦ä¸€ç§ç­–ç•¥æ˜¯ï¼Œå‘èµ·æ­»é”æ£€æµ‹ï¼Œå‘ç°æ­»é”åï¼Œä¸»åŠ¨å›æ»šæ­»é”é“¾æ¡ä¸­çš„æŸä¸€ä¸ªäº‹åŠ¡ï¼Œè®©å…¶ä»–äº‹åŠ¡å¾—ä»¥ç»§ç»­æ‰§è¡Œã€‚å°†å‚æ•°innodb_deadlock_detectè®¾ç½®ä¸ºonï¼Œè¡¨ç¤ºå¼€å¯è¿™ä¸ªé€»è¾‘ã€‚ åŠ é”è§„åˆ™åŠ é”è§„åˆ™é‡Œé¢ï¼ŒåŒ…å«äº†ä¸¤ä¸ªâ€œåŸåˆ™â€ã€ä¸¤ä¸ªâ€œä¼˜åŒ–â€å’Œä¸€ä¸ªâ€œbugâ€ã€‚ åŸåˆ™1ï¼šåŠ é”çš„åŸºæœ¬å•ä½æ˜¯next-key lockï¼Œlockæ˜¯å‰å¼€åé—­åŒºé—´ã€‚ åŸåˆ™2ï¼šæŸ¥æ‰¾è¿‡ç¨‹ä¸­è®¿é—®åˆ°çš„å¯¹è±¡æ‰ä¼šåŠ é”ã€‚ ä¼˜åŒ–1ï¼šç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢ï¼Œç»™å”¯ä¸€ç´¢å¼•åŠ é”çš„æ—¶å€™ï¼Œnext-key locké€€åŒ–ä¸ºè¡Œé”ã€‚ ä¼˜åŒ–2ï¼šç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢ï¼Œå‘å³éå†æ—¶ä¸”æœ€åä¸€ä¸ªå€¼ä¸æ»¡è¶³ç­‰å€¼æ¡ä»¶çš„æ—¶å€™ï¼Œnext-key locké€€åŒ–ä¸ºé—´éš™é”ã€‚ ä¸€ä¸ªbugï¼šå”¯ä¸€ç´¢å¼•ä¸Šçš„èŒƒå›´æŸ¥è¯¢ä¼šè®¿é—®åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå€¼ä¸ºæ­¢ã€‚","categories":[{"name":"MySQL","slug":"MySQL","permalink":"https://github.13sai.com/categories/MySQL/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"MySQLäº‹åŠ¡éš”ç¦»","slug":"MySQLäº‹åŠ¡éš”ç¦»","date":"2020-03-13T14:32:23.000Z","updated":"2022-03-19T15:35:43.459Z","comments":true,"path":"2020/03/13/MySQL-Isolation/","link":"","permalink":"https://github.13sai.com/2020/03/13/MySQL-Isolation/","excerpt":"","text":"æœ¬æ–‡ä¸ºæå®¢æ—¶é—´ä¸“æ ã€ŠMySQLå®æˆ˜45è®²ã€‹ç¬”è®°ï¼Œæ–‡ä¸­éƒ¨åˆ†å›¾æ–‡æ¥è‡ªè¯¥ä¸“æ ã€‚ æåˆ°äº‹åŠ¡ï¼Œä½ è‚¯å®šä¼šæƒ³åˆ°ACIDï¼ˆAtomicityã€Consistencyã€Isolationã€Durabilityï¼Œå³åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥è¯´è¯´å…¶ä¸­Iï¼Œä¹Ÿå°±æ˜¯â€œéš”ç¦»æ€§â€ã€‚ SQLæ ‡å‡†çš„äº‹åŠ¡éš”ç¦»çº§åˆ«åŒ…æ‹¬ï¼šè¯»æœªæäº¤ï¼ˆread uncommittedï¼‰ã€è¯»æäº¤ï¼ˆread committedï¼‰ã€å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆserializable ï¼‰ã€‚ è¯»æœªæäº¤æ˜¯æŒ‡ï¼Œä¸€ä¸ªäº‹åŠ¡è¿˜æ²¡æäº¤æ—¶ï¼Œå®ƒåšçš„å˜æ›´å°±èƒ½è¢«åˆ«çš„äº‹åŠ¡çœ‹åˆ°ã€‚ è¯»æäº¤æ˜¯æŒ‡ï¼Œä¸€ä¸ªäº‹åŠ¡æäº¤ä¹‹åï¼Œå®ƒåšçš„å˜æ›´æ‰ä¼šè¢«å…¶ä»–äº‹åŠ¡çœ‹åˆ°ã€‚ å¯é‡å¤è¯»æ˜¯æŒ‡ï¼Œä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çœ‹åˆ°çš„æ•°æ®ï¼Œæ€»æ˜¯è·Ÿè¿™ä¸ªäº‹åŠ¡åœ¨å¯åŠ¨æ—¶çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚å½“ç„¶åœ¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹ï¼Œæœªæäº¤å˜æ›´å¯¹å…¶ä»–äº‹åŠ¡ä¹Ÿæ˜¯ä¸å¯è§çš„ã€‚ ä¸²è¡ŒåŒ–ï¼Œé¡¾åæ€ä¹‰æ˜¯å¯¹äºåŒä¸€è¡Œè®°å½•ï¼Œâ€œå†™â€ä¼šåŠ â€œå†™é”â€ï¼Œâ€œè¯»â€ä¼šåŠ â€œè¯»é”â€ã€‚å½“å‡ºç°è¯»å†™é”å†²çªçš„æ—¶å€™ï¼Œåè®¿é—®çš„äº‹åŠ¡å¿…é¡»ç­‰å‰ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œæˆï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨ä¸åŒçš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œäº‹åŠ¡Aä¼šæœ‰å“ªäº›ä¸åŒçš„è¿”å›ç»“æœï¼Œä¹Ÿå°±æ˜¯å›¾é‡Œé¢V1ã€V2ã€V3çš„è¿”å›å€¼åˆ†åˆ«æ˜¯ä»€ä¹ˆã€‚ è‹¥éš”ç¦»çº§åˆ«æ˜¯â€œè¯»æœªæäº¤â€ï¼Œ åˆ™V1çš„å€¼å°±æ˜¯2ã€‚è¿™æ—¶å€™äº‹åŠ¡Bè™½ç„¶è¿˜æ²¡æœ‰æäº¤ï¼Œä½†æ˜¯ç»“æœå·²ç»è¢«Açœ‹åˆ°äº†ã€‚å› æ­¤ï¼ŒV2ã€V3ä¹Ÿéƒ½æ˜¯2ã€‚ è‹¥éš”ç¦»çº§åˆ«æ˜¯â€œè¯»æäº¤â€ï¼Œåˆ™V1æ˜¯1ï¼ŒV2çš„å€¼æ˜¯2ã€‚äº‹åŠ¡Bçš„æ›´æ–°åœ¨æäº¤åæ‰èƒ½è¢«Açœ‹åˆ°ã€‚æ‰€ä»¥ï¼Œ V3çš„å€¼ä¹Ÿæ˜¯2ã€‚ è‹¥éš”ç¦»çº§åˆ«æ˜¯â€œå¯é‡å¤è¯»â€ï¼Œåˆ™V1ã€V2æ˜¯1ï¼ŒV3æ˜¯2ã€‚ä¹‹æ‰€ä»¥V2è¿˜æ˜¯1ï¼Œéµå¾ªçš„å°±æ˜¯è¿™ä¸ªè¦æ±‚ï¼šäº‹åŠ¡åœ¨æ‰§è¡ŒæœŸé—´çœ‹åˆ°çš„æ•°æ®å‰åå¿…é¡»æ˜¯ä¸€è‡´çš„ã€‚ è‹¥éš”ç¦»çº§åˆ«æ˜¯â€œä¸²è¡ŒåŒ–â€ï¼Œåˆ™åœ¨äº‹åŠ¡Bæ‰§è¡Œâ€œå°†1æ”¹æˆ2â€çš„æ—¶å€™ï¼Œä¼šè¢«é”ä½ã€‚ç›´åˆ°äº‹åŠ¡Aæäº¤åï¼Œäº‹åŠ¡Bæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚æ‰€ä»¥ä»Açš„è§’åº¦çœ‹ï¼Œ V1ã€V2å€¼æ˜¯1ï¼ŒV3çš„å€¼æ˜¯2ã€‚ æŸ¥çœ‹éš”ç¦»çº§åˆ«ï¼š show variables like â€˜transaction_isolationâ€™; äº‹åŠ¡å¯åŠ¨ æ˜¾å¼å¯åŠ¨äº‹åŠ¡è¯­å¥ï¼Œ begin æˆ– start transactionã€‚é…å¥—çš„æäº¤è¯­å¥æ˜¯commitï¼Œå›æ»šè¯­å¥æ˜¯rollbackã€‚ å»ºè®®ä½ æ€»æ˜¯ä½¿ç”¨set autocommit=1, é€šè¿‡æ˜¾å¼è¯­å¥çš„æ–¹å¼æ¥å¯åŠ¨äº‹åŠ¡ã€‚ äº‹åŠ¡éš”ç¦»çš„å®ç°ç†è§£äº†äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹äº‹åŠ¡éš”ç¦»å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„ã€‚è¿™é‡Œæˆ‘ä»¬å±•å¼€è¯´æ˜â€œå¯é‡å¤è¯»â€ã€‚ åœ¨MySQLä¸­ï¼Œå®é™…ä¸Šæ¯æ¡è®°å½•åœ¨æ›´æ–°çš„æ—¶å€™éƒ½ä¼šåŒæ—¶è®°å½•ä¸€æ¡å›æ»šæ“ä½œã€‚è®°å½•ä¸Šçš„æœ€æ–°å€¼ï¼Œé€šè¿‡å›æ»šæ“ä½œï¼Œéƒ½å¯ä»¥å¾—åˆ°å‰ä¸€ä¸ªçŠ¶æ€çš„å€¼ã€‚ å‡è®¾ä¸€ä¸ªå€¼ä»1è¢«æŒ‰é¡ºåºæ”¹æˆäº†2ã€3ã€4ï¼Œåœ¨å›æ»šæ—¥å¿—é‡Œé¢å°±ä¼šæœ‰ç±»ä¼¼ä¸‹é¢çš„è®°å½•ã€‚ å½“å‰å€¼æ˜¯4ï¼Œä½†æ˜¯åœ¨æŸ¥è¯¢è¿™æ¡è®°å½•çš„æ—¶å€™ï¼Œä¸åŒæ—¶åˆ»å¯åŠ¨çš„äº‹åŠ¡ä¼šæœ‰ä¸åŒçš„read-viewã€‚å¦‚å›¾ä¸­çœ‹åˆ°çš„ï¼Œåœ¨è§†å›¾Aã€Bã€Cé‡Œé¢ï¼Œè¿™ä¸€ä¸ªè®°å½•çš„å€¼åˆ†åˆ«æ˜¯1ã€2ã€4ï¼ŒåŒä¸€æ¡è®°å½•åœ¨ç³»ç»Ÿä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªç‰ˆæœ¬ï¼Œå°±æ˜¯æ•°æ®åº“çš„å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰ã€‚å¯¹äºread-view Aï¼Œè¦å¾—åˆ°1ï¼Œå°±å¿…é¡»å°†å½“å‰å€¼ä¾æ¬¡æ‰§è¡Œå›¾ä¸­æ‰€æœ‰çš„å›æ»šæ“ä½œå¾—åˆ°ã€‚ åŒæ—¶ä½ ä¼šå‘ç°ï¼Œå³ä½¿ç°åœ¨æœ‰å¦å¤–ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å°†4æ”¹æˆ5ï¼Œè¿™ä¸ªäº‹åŠ¡è·Ÿread-view Aã€Bã€Cå¯¹åº”çš„äº‹åŠ¡æ˜¯ä¸ä¼šå†²çªçš„ã€‚ ä½ ä¸€å®šä¼šé—®ï¼Œå›æ»šæ—¥å¿—æ€»ä¸èƒ½ä¸€ç›´ä¿ç•™å§ï¼Œä»€ä¹ˆæ—¶å€™åˆ é™¤å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œåœ¨ä¸éœ€è¦çš„æ—¶å€™æ‰åˆ é™¤ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç³»ç»Ÿä¼šåˆ¤æ–­ï¼Œå½“æ²¡æœ‰äº‹åŠ¡å†éœ€è¦ç”¨åˆ°è¿™äº›å›æ»šæ—¥å¿—æ—¶ï¼Œå›æ»šæ—¥å¿—ä¼šè¢«åˆ é™¤ã€‚ ä»€ä¹ˆæ—¶å€™æ‰ä¸éœ€è¦äº†å‘¢ï¼Ÿå°±æ˜¯å½“ç³»ç»Ÿé‡Œæ²¡æœ‰æ¯”è¿™ä¸ªå›æ»šæ—¥å¿—æ›´æ—©çš„read-viewçš„æ—¶å€™ã€‚ åŸºäºä¸Šé¢çš„è¯´æ˜ï¼Œæˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹ä¸ºä»€ä¹ˆå»ºè®®ä½ å°½é‡ä¸è¦ä½¿ç”¨é•¿äº‹åŠ¡ã€‚ é•¿äº‹åŠ¡æ„å‘³ç€ç³»ç»Ÿé‡Œé¢ä¼šå­˜åœ¨å¾ˆè€çš„äº‹åŠ¡è§†å›¾ã€‚ç”±äºè¿™äº›äº‹åŠ¡éšæ—¶å¯èƒ½è®¿é—®æ•°æ®åº“é‡Œé¢çš„ä»»ä½•æ•°æ®ï¼Œæ‰€ä»¥è¿™ä¸ªäº‹åŠ¡æäº¤ä¹‹å‰ï¼Œæ•°æ®åº“é‡Œé¢å®ƒå¯èƒ½ç”¨åˆ°çš„å›æ»šè®°å½•éƒ½å¿…é¡»ä¿ç•™ï¼Œè¿™å°±ä¼šå¯¼è‡´å¤§é‡å ç”¨å­˜å‚¨ç©ºé—´ã€‚ åœ¨MySQL 5.5åŠä»¥å‰çš„ç‰ˆæœ¬ï¼Œå›æ»šæ—¥å¿—æ˜¯è·Ÿæ•°æ®å­—å…¸ä¸€èµ·æ”¾åœ¨ibdataæ–‡ä»¶é‡Œçš„ï¼Œå³ä½¿é•¿äº‹åŠ¡æœ€ç»ˆæäº¤ï¼Œå›æ»šæ®µè¢«æ¸…ç†ï¼Œæ–‡ä»¶ä¹Ÿä¸ä¼šå˜å°ã€‚æˆ‘è§è¿‡æ•°æ®åªæœ‰20GBï¼Œè€Œå›æ»šæ®µæœ‰200GBçš„åº“ã€‚æœ€ç»ˆåªå¥½ä¸ºäº†æ¸…ç†å›æ»šæ®µï¼Œé‡å»ºæ•´ä¸ªåº“ã€‚ é™¤äº†å¯¹å›æ»šæ®µçš„å½±å“ï¼Œé•¿äº‹åŠ¡è¿˜å ç”¨é”èµ„æºï¼Œä¹Ÿå¯èƒ½æ‹–å®æ•´ä¸ªåº“ï¼Œè¿™äº‹éœ€è¦æ³¨æ„çš„ã€‚ ç›¸å…³è¯­æ³•START TRANSACTION [transaction_characteristic [, transaction_characteristic] ...] transaction_characteristic: &#123; WITH CONSISTENT SNAPSHOT | READ WRITE | READ ONLY &#125; BEGIN [WORK] COMMIT [WORK] [AND [NO] CHAIN] [[NO] RELEASE] ROLLBACK [WORK] [AND [NO] CHAIN] [[NO] RELEASE] SET autocommit = &#123;0 | 1&#125; è¿™äº›è¯­å¥æä¾›å¯¹äº‹åŠ¡ä½¿ç”¨çš„æ§åˆ¶ ï¼š START TRANSACTIONæˆ– BEGINå¼€å§‹æ–°äº¤æ˜“ã€‚ COMMIT æäº¤å½“å‰äº‹åŠ¡ï¼Œä½¿å…¶æ›´æ”¹æ°¸ä¹…ç”Ÿæ•ˆã€‚ ROLLBACK å›æ»šå½“å‰äº‹åŠ¡ï¼Œå–æ¶ˆå…¶æ›´æ”¹ã€‚ SET autocommit ç¦ç”¨æˆ–å¯ç”¨å½“å‰ä¼šè¯çš„é»˜è®¤è‡ªåŠ¨æäº¤æ¨¡å¼ã€‚","categories":[{"name":"MySQL","slug":"MySQL","permalink":"https://github.13sai.com/categories/MySQL/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"MySQLä¸­å‡ ä¸ªé‡è¦çš„æ—¥å¿—","slug":"MySQLä¸­å‡ ä¸ªé‡è¦çš„æ—¥å¿—","date":"2020-03-12T07:24:48.000Z","updated":"2022-03-19T15:36:08.515Z","comments":true,"path":"2020/03/12/MySQL-log/","link":"","permalink":"https://github.13sai.com/2020/03/12/MySQL-log/","excerpt":"","text":"æœ¬æ–‡ä¸ºæå®¢æ—¶é—´ä¸“æ ã€ŠMySQLå®æˆ˜45è®²ã€‹ç¬”è®°ï¼Œæ–‡ä¸­éƒ¨åˆ†å›¾æ–‡æ¥è‡ªè¯¥ä¸“æ ã€‚ å‡ ä¸ªæ—¥å¿—çš„ä½œç”¨ é‡åšæ—¥å¿—ï¼ˆredo logï¼‰ï¼šç¡®ä¿äº‹åŠ¡çš„æŒä¹…æ€§ã€‚é˜²æ­¢åœ¨å‘ç”Ÿæ•…éšœçš„æ—¶é—´ç‚¹ï¼Œå°šæœ‰è„é¡µæœªå†™å…¥ç£ç›˜ï¼Œåœ¨é‡å¯mysqlæœåŠ¡çš„æ—¶å€™ï¼Œæ ¹æ®redo logè¿›è¡Œé‡åšï¼Œä»è€Œè¾¾åˆ°äº‹åŠ¡çš„æŒä¹…æ€§è¿™ä¸€ç‰¹æ€§ã€‚ å›æ»šæ—¥å¿—ï¼ˆundo logï¼‰ï¼šä¿å­˜äº†äº‹åŠ¡å‘ç”Ÿä¹‹å‰çš„æ•°æ®çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨äºå›æ»šï¼ŒåŒæ—¶å¯ä»¥æä¾›å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ä¸‹çš„è¯»ï¼ˆMVCCï¼‰ï¼Œå³éé”å®šè¯» äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinlogï¼‰ï¼šç”¨äºå¤åˆ¶å’Œå¤‡ä»½ï¼Œåœ¨ä¸»ä»å¤åˆ¶ä¸­ï¼Œä»åº“åˆ©ç”¨ä¸»åº“ä¸Šçš„binlogè¿›è¡Œé‡æ’­ï¼Œå®ç°ä¸»ä»åŒæ­¥ã€‚ ä¹Ÿå¯åŸºäºæ—¶é—´ç‚¹åšæ•°æ®åº“çš„çš„è¿˜åŸã€‚ redo logåœ¨MySQLé‡Œï¼Œå¦‚æœæ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦å†™è¿›ç£ç›˜ï¼Œç„¶åç£ç›˜ä¹Ÿè¦æ‰¾åˆ°å¯¹åº”çš„é‚£æ¡è®°å½•ï¼Œç„¶åå†æ›´æ–°ï¼Œæ•´ä¸ªè¿‡ç¨‹IOæˆæœ¬ã€æŸ¥æ‰¾æˆæœ¬éƒ½å¾ˆé«˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMySQLçš„è®¾è®¡è€…å°±ç”¨äº†WALæŠ€æœ¯ï¼ŒWALçš„å…¨ç§°æ˜¯Write-Ahead Loggingï¼Œå®ƒçš„å…³é”®ç‚¹å°±æ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜ã€‚ å…·ä½“æ¥è¯´ï¼Œå½“æœ‰ä¸€æ¡è®°å½•éœ€è¦æ›´æ–°çš„æ—¶å€™ï¼ŒInnoDBå¼•æ“å°±ä¼šå…ˆæŠŠè®°å½•å†™åˆ°redo logé‡Œé¢ï¼Œå¹¶æ›´æ–°å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚åŒæ—¶ï¼ŒInnoDBå¼•æ“ä¼šåœ¨é€‚å½“çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªæ“ä½œè®°å½•æ›´æ–°åˆ°ç£ç›˜é‡Œé¢ï¼Œè€Œè¿™ä¸ªæ›´æ–°å¾€å¾€æ˜¯åœ¨ç³»ç»Ÿæ¯”è¾ƒç©ºé—²çš„æ—¶å€™åšã€‚ å¦å¤–ï¼ŒInnoDBçš„redo logæ˜¯å›ºå®šå¤§å°çš„ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸ºä¸€ç»„4ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯1GBï¼Œé‚£ä¹ˆè¿™å—â€œç²‰æ¿â€æ€»å…±å°±å¯ä»¥è®°å½•4GBçš„æ“ä½œã€‚ä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾å°±åˆå›åˆ°å¼€å¤´å¾ªç¯å†™ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªå›¾æ‰€ç¤ºã€‚ write posæ˜¯å½“å‰è®°å½•çš„ä½ç½®ï¼Œä¸€è¾¹å†™ä¸€è¾¹åç§»ï¼Œå†™åˆ°ç¬¬3å·æ–‡ä»¶æœ«å°¾åå°±å›åˆ°0å·æ–‡ä»¶å¼€å¤´ã€‚checkpointæ˜¯å½“å‰è¦æ“¦é™¤çš„ä½ç½®ï¼Œä¹Ÿæ˜¯å¾€åæ¨ç§»å¹¶ä¸”å¾ªç¯çš„ï¼Œæ“¦é™¤è®°å½•å‰è¦æŠŠè®°å½•æ›´æ–°åˆ°æ•°æ®æ–‡ä»¶ã€‚ write poså’Œcheckpointä¹‹é—´çš„æ˜¯ç©ºç€çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨æ¥è®°å½•æ–°çš„æ“ä½œã€‚å¦‚æœwrite posè¿½ä¸Šcheckpointï¼Œè¡¨ç¤ºæ»¡äº†ï¼Œè¿™æ—¶å€™ä¸èƒ½å†æ‰§è¡Œæ–°çš„æ›´æ–°ï¼Œå¾—åœä¸‹æ¥å…ˆæ“¦æ‰ä¸€äº›è®°å½•ï¼ŒæŠŠcheckpointæ¨è¿›ä¸€ä¸‹ã€‚ æœ‰äº†redo logï¼ŒInnoDBå°±å¯ä»¥ä¿è¯å³ä½¿æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¹‹å‰æäº¤çš„è®°å½•éƒ½ä¸ä¼šä¸¢å¤±ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸ºcrash-safeã€‚ undo logåœ¨æ•°æ®ä¿®æ”¹çš„æ—¶å€™ï¼Œä¸ä»…è®°å½•äº†redo logï¼Œè¿˜è®°å½•äº†ç›¸å¯¹åº”çš„undo logï¼Œå¦‚æœå› ä¸ºæŸäº›åŸå› å¯¼è‡´äº‹åŠ¡å¤±è´¥æˆ–å›æ»šäº†ï¼Œå¯ä»¥å€ŸåŠ©undo logè¿›è¡Œå›æ»šã€‚ undo logå’Œredo logè®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯é€»è¾‘æ—¥å¿—ã€‚å¯ä»¥è®¤ä¸ºå½“deleteä¸€æ¡è®°å½•æ—¶ï¼Œundo logä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„insertè®°å½•ï¼Œåä¹‹äº¦ç„¶ï¼Œå½“updateä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„updateè®°å½•ã€‚ å½“æ‰§è¡Œrollbackæ—¶ï¼Œå°±å¯ä»¥ä»undo logä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å†…å®¹å¹¶è¿›è¡Œå›æ»šã€‚æœ‰æ—¶å€™åº”ç”¨åˆ°è¡Œç‰ˆæœ¬æ§åˆ¶çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯é€šè¿‡undo logæ¥å®ç°çš„ï¼šå½“è¯»å–çš„æŸä¸€è¡Œè¢«å…¶ä»–äº‹åŠ¡é”å®šæ—¶ï¼Œå®ƒå¯ä»¥ä»undo logä¸­åˆ†æå‡ºè¯¥è¡Œè®°å½•ä»¥å‰çš„æ•°æ®æ˜¯ä»€ä¹ˆï¼Œä»è€Œæä¾›è¯¥è¡Œç‰ˆæœ¬ä¿¡æ¯ï¼Œè®©ç”¨æˆ·å®ç°éé”å®šä¸€è‡´æ€§è¯»å–ã€‚ undo logæ˜¯é‡‡ç”¨æ®µ(segment)çš„æ–¹å¼æ¥è®°å½•çš„ï¼Œæ¯ä¸ªundoæ“ä½œåœ¨è®°å½•çš„æ—¶å€™å ç”¨ä¸€ä¸ªundo log segmentã€‚ å¦å¤–ï¼Œundo logä¹Ÿä¼šäº§ç”Ÿredo logï¼Œå› ä¸ºundo logä¹Ÿè¦å®ç°æŒä¹…æ€§ä¿æŠ¤ã€‚ binlogMySQLæ•´ä½“æ¥çœ‹ï¼Œå…¶å®å°±æœ‰ä¸¤å—ï¼šä¸€å—æ˜¯Serverå±‚ï¼Œå®ƒä¸»è¦åšçš„æ˜¯MySQLåŠŸèƒ½å±‚é¢çš„äº‹æƒ…ï¼›è¿˜æœ‰ä¸€å—æ˜¯å¼•æ“å±‚ï¼Œè´Ÿè´£å­˜å‚¨ç›¸å…³çš„å…·ä½“äº‹å®œã€‚ä¸Šé¢æˆ‘ä»¬èŠåˆ°çš„redo logæ˜¯InnoDBå¼•æ“ç‰¹æœ‰çš„æ—¥å¿—ï¼Œè€ŒServerå±‚ä¹Ÿæœ‰è‡ªå·±çš„æ—¥å¿—ï¼Œç§°ä¸ºbinlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰ã€‚ æˆ‘æƒ³ä½ è‚¯å®šä¼šé—®ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä»½æ—¥å¿—å‘¢ï¼Ÿ å› ä¸ºæœ€å¼€å§‹MySQLé‡Œå¹¶æ²¡æœ‰InnoDBå¼•æ“ã€‚MySQLè‡ªå¸¦çš„å¼•æ“æ˜¯MyISAMï¼Œä½†æ˜¯MyISAMæ²¡æœ‰crash-safeçš„èƒ½åŠ›ï¼Œbinlogæ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€ŒInnoDBæ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥MySQLçš„ï¼Œæ—¢ç„¶åªä¾é binlogæ˜¯æ²¡æœ‰crash-safeèƒ½åŠ›çš„ï¼Œæ‰€ä»¥InnoDBä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿâ€”â€”ä¹Ÿå°±æ˜¯redo logæ¥å®ç°crash-safeèƒ½åŠ›ã€‚ è¿™ä¸¤ç§æ—¥å¿—æœ‰ä»¥ä¸‹ä¸‰ç‚¹ä¸åŒã€‚ redo logæ˜¯InnoDBå¼•æ“ç‰¹æœ‰çš„ï¼›binlogæ˜¯MySQLçš„Serverå±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚ redo logæ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ï¼›binlogæ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ID=2è¿™ä¸€è¡Œçš„cå­—æ®µåŠ 1 â€ã€‚ redo logæ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlogæ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡binlogæ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚ æœ‰äº†å¯¹è¿™ä¸¤ä¸ªæ—¥å¿—çš„æ¦‚å¿µæ€§ç†è§£ï¼Œæˆ‘ä»¬å†æ¥çœ‹æ‰§è¡Œå™¨å’ŒInnoDBå¼•æ“åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„updateè¯­å¥æ—¶çš„å†…éƒ¨æµç¨‹ã€‚ æ‰§è¡Œå™¨å…ˆæ‰¾å¼•æ“å–ID=2è¿™ä¸€è¡Œã€‚IDæ˜¯ä¸»é”®ï¼Œå¼•æ“ç›´æ¥ç”¨æ ‘æœç´¢æ‰¾åˆ°è¿™ä¸€è¡Œã€‚å¦‚æœID=2è¿™ä¸€è¡Œæ‰€åœ¨çš„æ•°æ®é¡µæœ¬æ¥å°±åœ¨å†…å­˜ä¸­ï¼Œå°±ç›´æ¥è¿”å›ç»™æ‰§è¡Œå™¨ï¼›å¦åˆ™ï¼Œéœ€è¦å…ˆä»ç£ç›˜è¯»å…¥å†…å­˜ï¼Œç„¶åå†è¿”å›ã€‚ æ‰§è¡Œå™¨æ‹¿åˆ°å¼•æ“ç»™çš„è¡Œæ•°æ®ï¼ŒæŠŠè¿™ä¸ªå€¼åŠ ä¸Š1ï¼Œæ¯”å¦‚åŸæ¥æ˜¯Nï¼Œç°åœ¨å°±æ˜¯N+1ï¼Œå¾—åˆ°æ–°çš„ä¸€è¡Œæ•°æ®ï¼Œå†è°ƒç”¨å¼•æ“æ¥å£å†™å…¥è¿™è¡Œæ–°æ•°æ®ã€‚ å¼•æ“å°†è¿™è¡Œæ–°æ•°æ®æ›´æ–°åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶å°†è¿™ä¸ªæ›´æ–°æ“ä½œè®°å½•åˆ°redo logé‡Œé¢ï¼Œæ­¤æ—¶redo logå¤„äºprepareçŠ¶æ€ã€‚ç„¶åå‘ŠçŸ¥æ‰§è¡Œå™¨æ‰§è¡Œå®Œæˆäº†ï¼Œéšæ—¶å¯ä»¥æäº¤äº‹åŠ¡ã€‚ æ‰§è¡Œå™¨ç”Ÿæˆè¿™ä¸ªæ“ä½œçš„binlogï¼Œå¹¶æŠŠbinlogå†™å…¥ç£ç›˜ã€‚ æ‰§è¡Œå™¨è°ƒç”¨å¼•æ“çš„æäº¤äº‹åŠ¡æ¥å£ï¼Œå¼•æ“æŠŠåˆšåˆšå†™å…¥çš„redo logæ”¹æˆæäº¤ï¼ˆcommitï¼‰çŠ¶æ€ï¼Œæ›´æ–°å®Œæˆã€‚ è¿™é‡Œæˆ‘ç»™å‡ºè¿™ä¸ªupdateè¯­å¥çš„æ‰§è¡Œæµç¨‹å›¾ï¼Œå›¾ä¸­æµ…è‰²æ¡†è¡¨ç¤ºæ˜¯åœ¨InnoDBå†…éƒ¨æ‰§è¡Œçš„ï¼Œæ·±è‰²æ¡†è¡¨ç¤ºæ˜¯åœ¨æ‰§è¡Œå™¨ä¸­æ‰§è¡Œçš„ã€‚ å‚è€ƒæ–‡ç« ï¼šè¯¦ç»†åˆ†æMySQLäº‹åŠ¡æ—¥å¿—(redo logå’Œundo log)-https://www.cnblogs.com/f-ck-need-u/archive/2018/05/08/9010872.html#auto_id_14","categories":[{"name":"MySQL","slug":"MySQL","permalink":"https://github.13sai.com/categories/MySQL/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"MySQLæ‰§è¡Œæµç¨‹è¯´æ˜","slug":"MySQLæ‰§è¡Œæµç¨‹è¯´æ˜","date":"2020-03-11T07:24:48.000Z","updated":"2022-03-19T15:36:03.226Z","comments":true,"path":"2020/03/11/MySQL-workon/","link":"","permalink":"https://github.13sai.com/2020/03/11/MySQL-workon/","excerpt":"","text":"MySQLçš„æ‰§è¡Œæµç¨‹ç¤ºæ„å›¾ï¼š å¤§ä½“æ¥è¯´ï¼ŒMySQLå¯ä»¥åˆ†ä¸ºServerå±‚å’Œå­˜å‚¨å¼•æ“å±‚ä¸¤éƒ¨åˆ†ã€‚ Serverå±‚åŒ…æ‹¬è¿æ¥å™¨ã€æŸ¥è¯¢ç¼“å­˜ã€åˆ†æå™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨ç­‰ï¼Œæ¶µç›–MySQLçš„å¤§å¤šæ•°æ ¸å¿ƒæœåŠ¡åŠŸèƒ½ï¼Œä»¥åŠæ‰€æœ‰çš„å†…ç½®å‡½æ•°ï¼ˆå¦‚æ—¥æœŸã€æ—¶é—´ã€æ•°å­¦å’ŒåŠ å¯†å‡½æ•°ç­‰ï¼‰ï¼Œæ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½éƒ½åœ¨è¿™ä¸€å±‚å®ç°ï¼Œæ¯”å¦‚å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ã€è§†å›¾ç­‰ã€‚ è€Œå­˜å‚¨å¼•æ“å±‚è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œæå–ï¼Œå¸¸è§çš„æœ‰InnoDBã€MyISAMã€Memoryç­‰å¤šä¸ªå­˜å‚¨å¼•æ“ã€‚ç°åœ¨æœ€å¸¸ç”¨çš„å­˜å‚¨å¼•æ“æ˜¯InnoDBï¼Œä»MySQL 5.5.5ç‰ˆæœ¬å¼€å§‹å®ƒæˆä¸ºäº†é»˜è®¤å­˜å‚¨å¼•æ“ã€‚ ä»å›¾ä¸­ä¸éš¾çœ‹å‡ºï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“å…±ç”¨ä¸€ä¸ªServerå±‚ï¼Œä¹Ÿå°±æ˜¯ä»è¿æ¥å™¨åˆ°æ‰§è¡Œå™¨çš„éƒ¨åˆ†ã€‚ æˆ‘ä»¬ä¾æ¬¡çœ‹ä¸‹æ¯ä¸ªç»„ä»¶çš„ä½œç”¨ã€‚ è¿æ¥å™¨è¿æ¥å™¨è´Ÿè´£è·Ÿå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ã€è·å–æƒé™ã€ç»´æŒå’Œç®¡ç†è¿æ¥ã€‚è¿æ¥å‘½ä»¤ä¸€èˆ¬æ˜¯è¿™ä¹ˆå†™çš„ï¼š mysql -h $ip -P $port -u $user -p è¾“å®Œå‘½ä»¤ä¹‹åï¼Œä½ å°±éœ€è¦åœ¨äº¤äº’å¯¹è¯é‡Œé¢è¾“å…¥å¯†ç ã€‚ è¿æ¥å®Œæˆåï¼Œå¦‚æœä½ æ²¡æœ‰åç»­çš„åŠ¨ä½œï¼Œè¿™ä¸ªè¿æ¥å°±å¤„äºç©ºé—²çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨show processlistå‘½ä»¤ä¸­çœ‹åˆ°å®ƒã€‚ å¦‚æœç”¨æˆ·åæˆ–å¯†ç ä¸å¯¹ï¼Œä½ å°±ä¼šæ”¶åˆ°ä¸€ä¸ªâ€Access denied for userâ€çš„é”™è¯¯ï¼Œç„¶åå®¢æˆ·ç«¯ç¨‹åºç»“æŸæ‰§è¡Œã€‚å¦‚æœç”¨æˆ·åå¯†ç è®¤è¯é€šè¿‡ï¼Œè¿æ¥å™¨ä¼šåˆ°æƒé™è¡¨é‡Œé¢æŸ¥å‡ºä½ æ‹¥æœ‰çš„æƒé™ã€‚ä¹‹åï¼Œè¿™ä¸ªè¿æ¥é‡Œé¢çš„æƒé™åˆ¤æ–­é€»è¾‘ï¼Œéƒ½å°†ä¾èµ–äºæ­¤æ—¶è¯»åˆ°çš„æƒé™ã€‚ è¿™å°±æ„å‘³ç€ï¼Œä¸€ä¸ªç”¨æˆ·æˆåŠŸå»ºç«‹è¿æ¥åï¼Œå³ä½¿ä½ ç”¨ç®¡ç†å‘˜è´¦å·å¯¹è¿™ä¸ªç”¨æˆ·çš„æƒé™åšäº†ä¿®æ”¹ï¼Œä¹Ÿä¸ä¼šå½±å“å·²ç»å­˜åœ¨è¿æ¥çš„æƒé™ã€‚ä¿®æ”¹å®Œæˆåï¼Œåªæœ‰å†æ–°å»ºçš„è¿æ¥æ‰ä¼šä½¿ç”¨æ–°çš„æƒé™è®¾ç½®ã€‚ å®¢æˆ·ç«¯å¦‚æœå¤ªé•¿æ—¶é—´æ²¡åŠ¨é™ï¼Œè¿æ¥å™¨å°±ä¼šè‡ªåŠ¨å°†å®ƒæ–­å¼€ã€‚è¿™ä¸ªæ—¶é—´æ˜¯ç”±å‚æ•°wait_timeoutæ§åˆ¶çš„ï¼Œé»˜è®¤å€¼æ˜¯8å°æ—¶ã€‚ å¦‚æœåœ¨è¿æ¥è¢«æ–­å¼€ä¹‹åï¼Œå®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚çš„è¯ï¼Œå°±ä¼šæ”¶åˆ°ä¸€ä¸ªé”™è¯¯æé†’ï¼š Lost connection to MySQL server during queryã€‚è¿™æ—¶å€™å¦‚æœä½ è¦ç»§ç»­ï¼Œå°±éœ€è¦è¿›è¡Œé‡è¿æ“ä½œï¼Œç„¶åå†æ‰§è¡Œè¯·æ±‚ã€‚ è¿æ¥æ³¨æ„ç‚¹ï¼š é•¿è¿æ¥æ˜¯æŒ‡è¿æ¥æˆåŠŸåï¼Œå¦‚æœå®¢æˆ·ç«¯æŒç»­æœ‰è¯·æ±‚ï¼Œåˆ™ä¸€ç›´ä½¿ç”¨åŒä¸€ä¸ªè¿æ¥ã€‚ çŸ­è¿æ¥åˆ™æ˜¯æŒ‡æ¯æ¬¡æ‰§è¡Œå®Œå¾ˆå°‘çš„å‡ æ¬¡æŸ¥è¯¢å°±æ–­å¼€è¿æ¥ï¼Œä¸‹æ¬¡æŸ¥è¯¢å†é‡æ–°å»ºç«‹ä¸€ä¸ªã€‚ å»ºç«‹è¿æ¥çš„è¿‡ç¨‹é€šå¸¸æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œæ‰€ä»¥æˆ‘å»ºè®®ä½ åœ¨ä½¿ç”¨ä¸­è¦å°½é‡å‡å°‘å»ºç«‹è¿æ¥çš„åŠ¨ä½œï¼Œä¹Ÿå°±æ˜¯å°½é‡ä½¿ç”¨é•¿è¿æ¥ã€‚ ä½†æ˜¯å…¨éƒ¨ä½¿ç”¨é•¿è¿æ¥åï¼Œä½ å¯èƒ½ä¼šå‘ç°ï¼Œæœ‰äº›æ—¶å€™MySQLå ç”¨å†…å­˜æ¶¨å¾—ç‰¹åˆ«å¿«ï¼Œè¿™æ˜¯å› ä¸ºMySQLåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸´æ—¶ä½¿ç”¨çš„å†…å­˜æ˜¯ç®¡ç†åœ¨è¿æ¥å¯¹è±¡é‡Œé¢çš„ã€‚è¿™äº›èµ„æºä¼šåœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰é‡Šæ”¾ã€‚æ‰€ä»¥å¦‚æœé•¿è¿æ¥ç´¯ç§¯ä¸‹æ¥ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜å ç”¨å¤ªå¤§ï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œæ€æ‰ï¼ˆOOMï¼‰ï¼Œä»ç°è±¡çœ‹å°±æ˜¯MySQLå¼‚å¸¸é‡å¯äº†ã€‚ æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿä½ å¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆã€‚ å®šæœŸä¸»åŠ¨æ–­å¼€é•¿è¿æ¥ã€‚ä½¿ç”¨ä¸€æ®µæ—¶é—´ï¼Œæˆ–è€…ç¨‹åºé‡Œé¢åˆ¤æ–­æ‰§è¡Œè¿‡ä¸€ä¸ªå ç”¨å†…å­˜çš„å¤§æŸ¥è¯¢åï¼Œæ–­å¼€è¿æ¥ï¼Œä¹‹åè¦æŸ¥è¯¢å†é‡è¿ã€‚ å¦‚æœä½ ç”¨çš„æ˜¯MySQL 5.7æˆ–æ›´æ–°ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ“ä½œåï¼Œé€šè¿‡æ‰§è¡Œ mysql_reset_connectionæ¥é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºã€‚è¿™ä¸ªè¿‡ç¨‹ä¸éœ€è¦é‡è¿å’Œé‡æ–°åšæƒé™éªŒè¯ï¼Œä½†æ˜¯ä¼šå°†è¿æ¥æ¢å¤åˆ°åˆšåˆšåˆ›å»ºå®Œæ—¶çš„çŠ¶æ€ã€‚ æŸ¥è¯¢ç¼“å­˜è¿æ¥å»ºç«‹å®Œæˆåï¼Œä½ å°±å¯ä»¥æ‰§è¡Œselectè¯­å¥äº†ã€‚æ‰§è¡Œé€»è¾‘å°±ä¼šæ¥åˆ°ç¬¬äºŒæ­¥ï¼šæŸ¥è¯¢ç¼“å­˜ã€‚ MySQLæ‹¿åˆ°ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚åï¼Œä¼šå…ˆåˆ°æŸ¥è¯¢ç¼“å­˜çœ‹çœ‹ï¼Œä¹‹å‰æ˜¯ä¸æ˜¯æ‰§è¡Œè¿‡è¿™æ¡è¯­å¥ã€‚ä¹‹å‰æ‰§è¡Œè¿‡çš„è¯­å¥åŠå…¶ç»“æœå¯èƒ½ä¼šä»¥key-valueå¯¹çš„å½¢å¼ï¼Œè¢«ç›´æ¥ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚keyæ˜¯æŸ¥è¯¢çš„è¯­å¥ï¼Œvalueæ˜¯æŸ¥è¯¢çš„ç»“æœã€‚å¦‚æœä½ çš„æŸ¥è¯¢èƒ½å¤Ÿç›´æ¥åœ¨è¿™ä¸ªç¼“å­˜ä¸­æ‰¾åˆ°keyï¼Œé‚£ä¹ˆè¿™ä¸ªvalueå°±ä¼šè¢«ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ å¦‚æœè¯­å¥ä¸åœ¨æŸ¥è¯¢ç¼“å­˜ä¸­ï¼Œå°±ä¼šç»§ç»­åé¢çš„æ‰§è¡Œé˜¶æ®µã€‚æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œç»“æœä¼šè¢«å­˜å…¥æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæŸ¥è¯¢å‘½ä¸­ç¼“å­˜ï¼ŒMySQLä¸éœ€è¦æ‰§è¡Œåé¢çš„å¤æ‚æ“ä½œï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›ç»“æœï¼Œè¿™ä¸ªæ•ˆç‡ä¼šå¾ˆé«˜ã€‚ ä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä¼šå»ºè®®ä½ ä¸è¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæŸ¥è¯¢ç¼“å­˜å¾€å¾€å¼Šå¤§äºåˆ©ã€‚ æŸ¥è¯¢ç¼“å­˜çš„å¤±æ•ˆéå¸¸é¢‘ç¹ï¼Œåªè¦æœ‰å¯¹ä¸€ä¸ªè¡¨çš„æ›´æ–°ï¼Œè¿™ä¸ªè¡¨ä¸Šæ‰€æœ‰çš„æŸ¥è¯¢ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºã€‚å› æ­¤å¾ˆå¯èƒ½ä½ è´¹åŠ²åœ°æŠŠç»“æœå­˜èµ·æ¥ï¼Œè¿˜æ²¡ä½¿ç”¨å‘¢ï¼Œå°±è¢«ä¸€ä¸ªæ›´æ–°å…¨æ¸…ç©ºäº†ã€‚å¯¹äºæ›´æ–°å‹åŠ›å¤§çš„æ•°æ®åº“æ¥è¯´ï¼ŒæŸ¥è¯¢ç¼“å­˜çš„å‘½ä¸­ç‡ä¼šéå¸¸ä½ã€‚é™¤éä½ çš„ä¸šåŠ¡å°±æ˜¯æœ‰ä¸€å¼ é™æ€è¡¨ï¼Œå¾ˆé•¿æ—¶é—´æ‰ä¼šæ›´æ–°ä¸€æ¬¡ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªç³»ç»Ÿé…ç½®è¡¨ï¼Œé‚£è¿™å¼ è¡¨ä¸Šçš„æŸ¥è¯¢æ‰é€‚åˆä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚ å¥½åœ¨MySQLä¹Ÿæä¾›äº†è¿™ç§â€œæŒ‰éœ€ä½¿ç”¨â€çš„æ–¹å¼ã€‚ä½ å¯ä»¥å°†å‚æ•°query_cache_typeè®¾ç½®æˆDEMANDï¼Œè¿™æ ·å¯¹äºé»˜è®¤çš„SQLè¯­å¥éƒ½ä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚è€Œå¯¹äºä½ ç¡®å®šè¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„è¯­å¥ï¼Œå¯ä»¥ç”¨SQL_CACHEæ˜¾å¼æŒ‡å®šï¼Œåƒä¸‹é¢è¿™ä¸ªè¯­å¥ä¸€æ ·ï¼š mysql&gt; select SQL_CACHE * from T where ID=10ï¼› éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMySQL 8.0ç‰ˆæœ¬ç›´æ¥å°†æŸ¥è¯¢ç¼“å­˜çš„æ•´å—åŠŸèƒ½åˆ æ‰äº†ï¼Œä¹Ÿå°±æ˜¯è¯´8.0å¼€å§‹å½»åº•æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½äº†ã€‚ åˆ†æå™¨å¦‚æœæ²¡æœ‰å‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼Œå°±è¦å¼€å§‹çœŸæ­£æ‰§è¡Œè¯­å¥äº†ã€‚é¦–å…ˆï¼ŒMySQLéœ€è¦çŸ¥é“ä½ è¦åšä»€ä¹ˆï¼Œå› æ­¤éœ€è¦å¯¹SQLè¯­å¥åšè§£æã€‚ åˆ†æå™¨å…ˆä¼šåšâ€œè¯æ³•åˆ†æâ€ã€‚ä½ è¾“å…¥çš„æ˜¯ç”±å¤šä¸ªå­—ç¬¦ä¸²å’Œç©ºæ ¼ç»„æˆçš„ä¸€æ¡SQLè¯­å¥ï¼ŒMySQLéœ€è¦è¯†åˆ«å‡ºé‡Œé¢çš„å­—ç¬¦ä¸²åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆã€‚ MySQLä»ä½ è¾“å…¥çš„â€selectâ€è¿™ä¸ªå…³é”®å­—è¯†åˆ«å‡ºæ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å®ƒä¹Ÿè¦æŠŠå­—ç¬¦ä¸²â€œTâ€è¯†åˆ«æˆâ€œè¡¨åTâ€ï¼ŒæŠŠå­—ç¬¦ä¸²â€œIDâ€è¯†åˆ«æˆâ€œåˆ—IDâ€ã€‚ åšå®Œäº†è¿™äº›è¯†åˆ«ä»¥åï¼Œå°±è¦åšâ€œè¯­æ³•åˆ†æâ€ã€‚æ ¹æ®è¯æ³•åˆ†æçš„ç»“æœï¼Œè¯­æ³•åˆ†æå™¨ä¼šæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ªSQLè¯­å¥æ˜¯å¦æ»¡è¶³MySQLè¯­æ³•ã€‚ å¦‚æœä½ çš„è¯­å¥ä¸å¯¹ï¼Œå°±ä¼šæ”¶åˆ°â€œYou have an error in your SQL syntaxâ€çš„é”™è¯¯æé†’ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªè¯­å¥selectå°‘æ‰“äº†å¼€å¤´çš„å­—æ¯â€œsâ€ã€‚ mysql&gt; elect * from t where id=1; ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;elect * from t where ID=1&#x27; at line 1 ä¸€èˆ¬è¯­æ³•é”™è¯¯ä¼šæç¤ºç¬¬ä¸€ä¸ªå‡ºç°é”™è¯¯çš„ä½ç½®ï¼Œæ‰€ä»¥ä½ è¦å…³æ³¨çš„æ˜¯ç´§æ¥â€œuse nearâ€çš„å†…å®¹ã€‚ ä¼˜åŒ–å™¨ç»è¿‡äº†åˆ†æå™¨ï¼ŒMySQLå°±çŸ¥é“ä½ è¦åšä»€ä¹ˆäº†ã€‚åœ¨å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼Œè¿˜è¦å…ˆç»è¿‡ä¼˜åŒ–å™¨çš„å¤„ç†ã€‚ ä¼˜åŒ–å™¨æ˜¯åœ¨è¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªç´¢å¼•ï¼›æˆ–è€…åœ¨ä¸€ä¸ªè¯­å¥æœ‰å¤šè¡¨å…³è”ï¼ˆjoinï¼‰çš„æ—¶å€™ï¼Œå†³å®šå„ä¸ªè¡¨çš„è¿æ¥é¡ºåºã€‚ ä¼˜åŒ–å™¨é˜¶æ®µå®Œæˆåï¼Œè¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæ–¹æ¡ˆå°±ç¡®å®šä¸‹æ¥äº†ï¼Œç„¶åè¿›å…¥æ‰§è¡Œå™¨é˜¶æ®µã€‚å¦‚æœä½ è¿˜æœ‰ä¸€äº›ç–‘é—®ï¼Œæ¯”å¦‚ä¼˜åŒ–å™¨æ˜¯æ€ä¹ˆé€‰æ‹©ç´¢å¼•çš„ï¼Œæœ‰æ²¡æœ‰å¯èƒ½é€‰æ‹©é”™ç­‰ç­‰ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­å•ç‹¬å±•å¼€è¯´æ˜ä¼˜åŒ–å™¨çš„å†…å®¹ã€‚ æ‰§è¡Œå™¨MySQLé€šè¿‡åˆ†æå™¨çŸ¥é“äº†ä½ è¦åšä»€ä¹ˆï¼Œé€šè¿‡ä¼˜åŒ–å™¨çŸ¥é“äº†è¯¥æ€ä¹ˆåšï¼Œäºæ˜¯å°±è¿›å…¥äº†æ‰§è¡Œå™¨é˜¶æ®µï¼Œå¼€å§‹æ‰§è¡Œè¯­å¥ã€‚ å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œè¦å…ˆåˆ¤æ–­ä¸€ä¸‹ä½ å¯¹è¿™ä¸ªè¡¨Tæœ‰æ²¡æœ‰æ‰§è¡ŒæŸ¥è¯¢çš„æƒé™ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šè¿”å›æ²¡æœ‰æƒé™çš„é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤º(åœ¨å·¥ç¨‹å®ç°ä¸Šï¼Œå¦‚æœå‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼Œä¼šåœ¨æŸ¥è¯¢ç¼“å­˜è¿”å›ç»“æœçš„æ—¶å€™ï¼Œåšæƒé™éªŒè¯ã€‚æŸ¥è¯¢ä¹Ÿä¼šåœ¨ä¼˜åŒ–å™¨ä¹‹å‰è°ƒç”¨precheckéªŒè¯æƒé™)ã€‚ mysql&gt; select * from T where ID=10; ERROR 1142 (42000): SELECT command denied to user &#x27;b&#x27;@&#x27;localhost&#x27; for table &#x27;T&#x27; å¦‚æœæœ‰æƒé™ï¼Œå°±æ‰“å¼€è¡¨ç»§ç»­æ‰§è¡Œã€‚æ‰“å¼€è¡¨çš„æ—¶å€™ï¼Œæ‰§è¡Œå™¨å°±ä¼šæ ¹æ®è¡¨çš„å¼•æ“å®šä¹‰ï¼Œå»ä½¿ç”¨è¿™ä¸ªå¼•æ“æä¾›çš„æ¥å£ã€‚ æ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­çš„è¡¨Tä¸­ï¼ŒIDå­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆæ‰§è¡Œå™¨çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š è°ƒç”¨InnoDBå¼•æ“æ¥å£å–è¿™ä¸ªè¡¨çš„ç¬¬ä¸€è¡Œï¼Œåˆ¤æ–­IDå€¼æ˜¯ä¸æ˜¯10ï¼Œå¦‚æœä¸æ˜¯åˆ™è·³è¿‡ï¼Œå¦‚æœæ˜¯åˆ™å°†è¿™è¡Œå­˜åœ¨ç»“æœé›†ä¸­ï¼› è°ƒç”¨å¼•æ“æ¥å£å–â€œä¸‹ä¸€è¡Œâ€ï¼Œé‡å¤ç›¸åŒçš„åˆ¤æ–­é€»è¾‘ï¼Œç›´åˆ°å–åˆ°è¿™ä¸ªè¡¨çš„æœ€åä¸€è¡Œã€‚ æ‰§è¡Œå™¨å°†ä¸Šè¿°éå†è¿‡ç¨‹ä¸­æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œç»„æˆçš„è®°å½•é›†ä½œä¸ºç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ è‡³æ­¤ï¼Œè¿™ä¸ªè¯­å¥å°±æ‰§è¡Œå®Œæˆäº†ã€‚ å¯¹äºæœ‰ç´¢å¼•çš„è¡¨ï¼Œæ‰§è¡Œçš„é€»è¾‘ä¹Ÿå·®ä¸å¤šã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ˜¯â€œå–æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€è¡Œâ€è¿™ä¸ªæ¥å£ï¼Œä¹‹åå¾ªç¯å–â€œæ»¡è¶³æ¡ä»¶çš„ä¸‹ä¸€è¡Œâ€è¿™ä¸ªæ¥å£ï¼Œè¿™äº›æ¥å£éƒ½æ˜¯å¼•æ“ä¸­å·²ç»å®šä¹‰å¥½çš„ã€‚","categories":[{"name":"MySQL","slug":"MySQL","permalink":"https://github.13sai.com/categories/MySQL/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"ElementUIå¤šå›¾æ‹–æ‹½","slug":"ElementUIå¤šå›¾æ‹–æ‹½","date":"2020-02-27T01:33:48.000Z","updated":"2022-03-19T14:35:21.582Z","comments":true,"path":"2020/02/27/228/","link":"","permalink":"https://github.13sai.com/2020/02/27/228/","excerpt":"","text":"å‡†å¤‡ yarn add vuedraggableornpm i -S vuedraggable ä»£ç ç¤ºä¾‹&lt;template&gt; &lt;div&gt; &lt;el-row style=&quot;margin-top: 20px;&quot;&gt; &lt;el-col :span=&quot;20&quot; :offset=&quot;2&quot;&gt; &lt;el-form-item label=&quot;é¢„è§ˆ&quot; prop=&quot;desc&quot;&gt; &lt;div class=&quot;image-list&quot;&gt; &lt;draggable v-model=&quot;showImgList&quot; @change=&quot;dragChange&quot;&gt; &lt;div v-for=&quot;(image, index) in showImgList&quot; :key=&quot;index&quot; class=&quot;image-wrap&quot;&gt; &lt;img :src=&quot;image&quot; :style=&quot;imgStyle&quot; /&gt; &lt;div class=&quot;icon-wrap&quot; @click.stop=&quot;removeFile(index)&quot;&gt; &lt;i class=&quot;el-icon-delete&quot;&gt;&lt;/i&gt; &lt;/div&gt; &lt;/div&gt; &lt;el-upload ref=&quot;imageListUpload&quot; :action=&quot;$uploadPicUrl&quot; :headers=&quot;header&quot; :before-upload=&quot;beforeUpload&quot; :on-success=&quot;uploadSuccess&quot; class=&quot;image-uploader&quot; :on-error=&quot;onError&quot; multiple :show-file-list=&quot;false&quot; accept=&quot;image/*&quot;&gt; &lt;i :class=&quot;loading ? &#x27;el-icon-loading&#x27; : &#x27;el-icon-plus&#x27;&quot; :style=&quot;imgStyle&quot;&gt;&lt;/i&gt; &lt;/el-upload&gt; &lt;/draggable&gt; &lt;/div&gt; &lt;/el-form-item&gt; &lt;/el-col&gt; &lt;/el-row&gt; &lt;/div&gt; &lt;/template&gt; &lt;style&gt; .ql-container .ql-editor&#123; height:400px; &#125; .avatar-uploader .el-upload &#123; height: 180px; width: 180px; overflow: hidden; &#125; .avatar-uploader img &#123; height: 180px; width: 180px; &#125; .avatar-uploader .avatar-uploader-icon &#123; border: 1px dashed #d9d9d9; border-radius: 6px; cursor: pointer; font-size: 28px; color: #8c939d; width: 178px; height: 178px; line-height: 178px; text-align: center; &#125; #video .video &#123; max-width: 300px; max-height: 200px; &#125; .avatar &#123; width: 178px; height: 178px; display: block; &#125; .avatar-uploader img &#123; height: 180px; width: 180px; &#125; .ql-editor&#123; height:400px; &#125; .ql-snow .ql-picker &#123; height: auto; &#125; .image-list, .image-item &#123; display: flex; &#125; .image-list .image-wrap, .image-item .image-wrap &#123; position: relative; display: inline-block; box-sizing: content-box; margin: 0 8px 8px 0; vertical-align: top; &#125; .image-list .image-wrap:hover .icon-wrap, .image-item .image-wrap:hover .icon-wrap &#123; opacity: 1; &#125; .image-list .image-wrap .icon-wrap, .image-item .image-wrap .icon-wrap &#123; position: absolute; left: 0; bottom: 0; width: 100%; height: 30px; cursor: default; text-align: center; color: #fff; opacity: 0; font-size: 20px; background-color: rgba(0, 0, 0, 0.7); transition: opacity .3s; &#125; .image-list .image-wrap .icon-wrap .el-icon-zoom-in, .image-item .image-wrap .icon-wrap .el-icon-zoom-in &#123; cursor: pointer; margin-right: 8px; &#125; .image-list .image-wrap .icon-wrap .el-icon-delete, .image-item .image-wrap .icon-wrap .el-icon-delete &#123; cursor: pointer; &#125; .image-item &#123; display: inline-flex; &#125; .image-uploader &#123; display: inline-block; &#125; .image-uploader .el-upload &#123; border: 1px dashed #d9d9d9; border-radius: 6px; cursor: pointer; position: relative; overflow: hidden; &#125; .image-uploader .el-upload [class^=&quot;el-icon&quot;] &#123; font-size: 28px; color: #8c939d; text-align: center; &#125; .image-uploader .el-upload:hover &#123; border-color: #409EFF; &#125; &lt;/style&gt; &lt;script&gt; import draggable from &#x27;vuedraggable&#x27; export default &#123; components: &#123; draggable, &#125;, data() &#123; return &#123; showImgList: [], loading: false, &#125; &#125;, created() &#123; if (this.$route.params.id &gt; 0) &#123; this.getInfo(this.$route.params.id) this.goodsForm.id = this.$route.params.id; &#125; else &#123; this.responseVisible = false; &#125; &#125;, computed: &#123; imgStyle() &#123; return &#123; width: &#x27;180px&#x27;, height: &#x27;180px&#x27;, lineHeight: &#x27;180px&#x27;, &#125; &#125; &#125;, mounted() &#123; // ä¸ºå›¾ç‰‡ICONç»‘å®šäº‹ä»¶ getModule ä¸ºç¼–è¾‘å™¨çš„å†…éƒ¨å±æ€§ // this.$refs.myQuillEditor.quill.getModule(&#x27;toolbar&#x27;).addHandler(&#x27;image&#x27;, this.imgHandler) // this.$refs.myQuillEditor.quill.getModule(&#x27;toolbar&#x27;).addHandler(&#x27;video&#x27;, this.insertVideo) // ä¸ºè§†é¢‘ICONç»‘å®šäº‹ä»¶ &#125;, methods: &#123; beforeUpload(file) &#123; if (file.type.split(&#x27;/&#x27;)[0] === &#x27;image&#x27;) &#123; let tempSize = file.size / 1024 / 1024 / 2; if (tempSize &gt; 1) &#123; this.$message.error(&#x27;å›¾ç‰‡å°ºå¯¸ä¸å¾—å¤§äº2Mï¼&#x27;); return false; &#125; &#125; else &#123; this.$message.error(&#x27;è¯·ä¸Šä¼ å›¾ç‰‡æ ¼å¼ï¼ˆjpgã€pngã€gifï¼‰&#x27;); return false; &#125; &#125;, getInfo(id) &#123; var _self = this; projectInfo(id).then(function(res)&#123; _self.goodsForm = res.data.data; _self.goodsForm.start_time = timestampToDate(_self.goodsForm.start_time); _self.goodsForm.over_time = timestampToDate(_self.goodsForm.over_time); _self.showImgList = _self.goodsForm.desc.split(&quot;|&quot;); _self.responseVisible = false; &#125;).catch(function(error)&#123; console.log(error); &#125;) &#125;, handleRemove(file, fileList) &#123; console.log(file, fileList); &#125;, uploadSuccess(response, file, fileList) &#123; try &#123; for (let fileInfo of fileList) &#123; if (this.type === &#x27;image&#x27;) &#123; this.imgUrl = response.key this.$emit(&#x27;update:data&#x27;, response.key) &#125; else &#123; if (this.showImgList.length &gt;= this.limit) &#123; // é™åˆ¶å›¾ç‰‡å¼ æ•° this.showImgList.length = this.limit throw(new Error(`æœ€å¤šä¸Šä¼  $&#123;this.limit&#125; å¼ å›¾ç‰‡`)) &#125; this.showImgList.push(response.data.filepath) this.$emit(&#x27;update:data&#x27;, this.showImgList) &#125; &#125; &#125; catch (error) &#123; this.$message.error(error.message) &#125; finally &#123; this.loading = false this.$refs.imageListUpload &amp;&amp; this.$refs.imageListUpload.clearFiles() this.$refs.imageUpload &amp;&amp; this.$refs.imageUpload.clearFiles() &#125; &#125;, removeFile(index) &#123; this.$confirm(&#x27;ç¡®å®šåˆ é™¤è¯¥å›¾ç‰‡å—?&#x27;, &#x27;æç¤º&#x27;, &#123; confirmButtonText: &#x27;ç¡®å®š&#x27;, cancelButtonText: &#x27;å–æ¶ˆ&#x27;, type: &#x27;warning&#x27; &#125;).then(() =&gt; &#123; if (this.type === &#x27;image&#x27;) &#123; this.$emit(&#x27;update:data&#x27;, typeof this.data === &#x27;object&#x27; ? &#123;&#125; : &#x27;&#x27;) &#125; else &#123; this.showImgList.splice(index, 1) this.$emit(&#x27;update:data&#x27;, this.showImgList) &#125; &#125;) &#125;, onError() &#123; this.$message.error(&#x27;ä¸Šä¼ æ–‡ä»¶å¤±è´¥&#x27;) &#125;, dragChange(ele) &#123; console(ele.moved) &#125;, handleRemove(file, fileList) &#123; let imgList = fileList.map(item =&gt; &#123; return item.response.key &#125;) this.$emit(&#x27;update:data&#x27;, imgList) &#125;, &#125; &#125; &lt;/script&gt; æ³¨æ„åŠ¡å¿…æ³¨å†Œå¼•å…¥ç»„ä»¶ import draggable from &#x27;vuedraggable&#x27; export default &#123; ... components: &#123; draggable, &#125;, ...","categories":[{"name":"vue","slug":"vue","permalink":"https://github.13sai.com/categories/vue/"}],"tags":[{"name":"ElementUI","slug":"ElementUI","permalink":"https://github.13sai.com/tags/ElementUI/"}]},{"title":"åº”ç”¨ç¯‡ï¼š2.å»¶æ—¶ä»»åŠ¡","slug":"phpframe14","date":"2020-02-22T06:35:57.000Z","updated":"2022-03-19T15:25:58.839Z","comments":true,"path":"2020/02/22/phpframe14/","link":"","permalink":"https://github.13sai.com/2020/02/22/phpframe14/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ å»¶æ—¶ä»»åŠ¡æœ‰åˆ«äºå®šæ—¶ä»»åŠ¡ï¼Œå®šæ—¶ä»»åŠ¡å¾€å¾€æ˜¯å›ºå®šå‘¨æœŸçš„ï¼Œæœ‰æ˜ç¡®çš„è§¦å‘æ—¶é—´ã€‚è€Œå»¶æ—¶ä»»åŠ¡ä¸€èˆ¬æ²¡æœ‰å›ºå®šçš„å¼€å§‹æ—¶é—´ï¼Œå®ƒå¸¸å¸¸æ˜¯ç”±ä¸€ä¸ªäº‹ä»¶è§¦å‘çš„ï¼Œè€Œåœ¨è¿™ä¸ªäº‹ä»¶è§¦å‘ä¹‹åçš„ä¸€æ®µæ—¶é—´å†…è§¦å‘å¦ä¸€ä¸ªäº‹ä»¶ã€‚ æˆ‘ä»¬ä¸å¦¨æ¥è®¾å®šä¸€ä¸ªå®é™…çš„åœºæ™¯ï¼Œç”µå•†ç³»ç»Ÿä¸‹å•æˆåŠŸä¹‹åå¦‚æœ15åˆ†é’Ÿæœªæ”¯ä»˜æˆåŠŸï¼Œå°±ç³»ç»Ÿè‡ªåŠ¨å–æ¶ˆè®¢å•ã€‚ æˆ‘ä»¬å…ˆæ¥å®ç°ä»£ç ï¼Œç„¶åå†æ¥è¯¦ç»†è¯´æ˜ï¼š // æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªabstractï¼Œå®šä¹‰ä¸¤ä¸ªæ–¹æ³•ï¼ŒstartAfterå’ŒstartAt &lt;?php abstract class DelayTask &#123; const DELAY_TASK = &#x27;delayTask&#x27;; /** * å»¶æ—¶æ—¶é—´ï¼Œåœ¨è§¦å‘æ—¶é—´åå¤šä¹…æ‰§è¡Œ * @param $pushDelayTime */ public function startAfter(int $pushDelayTime) &#123; RedisManager::getRedis()-&gt;zAdd(self::DELAY_TASK, time() + $pushDelayTime, serialize($this)); &#125; /** * å®šæ—¶æ—¶é—´ï¼Œåœ¨æœªæ¥æŸæ—¶åˆ»æ‰§è¡Œ * @param $pushDelayAt */ public function startAt(int $pushDelayAt) &#123; RedisManager::getRedis()-&gt;zAdd(self::DELAY_TASK, $pushDelayAt, serialize($this)); &#125; abstract function run(); &#125; class TestDelayTask extends DelayTask &#123; public function __construct($id) &#123; $this-&gt;id = $id; &#125; public function run() &#123; $file = &#x27;text.txt&#x27;;//è¦å†™å…¥æ–‡ä»¶çš„æ–‡ä»¶åï¼ˆå¯ä»¥æ˜¯ä»»æ„æ–‡ä»¶åï¼‰ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ª $content = &quot;å†™å…¥çš„å†…å®¹&quot;.time().&quot;\\n&quot;; if($f = file_put_contents($file, $content,FILE_APPEND))&#123;// è¿™ä¸ªå‡½æ•°æ”¯æŒç‰ˆæœ¬(PHP 5) echo &quot;å†™å…¥æˆåŠŸã€‚&lt;br /&gt;&quot;; &#125; &#125; &#125; RedisManageræ˜¯å°è£…çš„ä¸€ä¸ªå•ä¾‹æ¨¡å¼å®ç°çš„redisç±»ï¼Œæˆ‘ä»¬ä¹Ÿè´´å‡ºä»£ç ï¼Œç„¶åå†å¯¹ä¸Šé¢çš„ä»£ç åšä¸€äº›è¯´æ˜ã€‚ &lt;?php class RedisManager &#123; private static $instance = null; private function __construct() &#123; self::$instance = new \\Redis(); $config = require &#x27;redis.config.php&#x27;; self::$instance-&gt;connect($config[&#x27;host&#x27;], $config[&#x27;port&#x27;], $config[&#x27;timeout&#x27;]); if (isset($config[&#x27;password&#x27;])) &#123; self::$instance-&gt;auth($config[&#x27;password&#x27;]); &#125; &#125; /** * è·å–é™æ€å®ä¾‹ */ public static function getRedis() &#123; if (!self::$instance) &#123; new self; &#125; return self::$instance; &#125; /** * ç¦æ­¢clone */ private function __clone() &#123; &#125; &#125; æœ‰åºé›†åˆredis 127.0.0.1:6379&gt; ZADD saif 1 redis (integer) 1 redis 127.0.0.1:6379&gt; ZADD saif 2 mongodb (integer) 1 redis 127.0.0.1:6379&gt; ZADD saif 4 mysql (integer) 0 redis 127.0.0.1:6379&gt; ZRANGE saif 0 10 WITHSCORES 1) &quot;redis&quot; 2) &quot;1&quot; 3) &quot;mongodb&quot; 4) &quot;2&quot; 5) &quot;mysql&quot; 6) &quot;4&quot; å¦‚æœä½ æœ‰rediså¯è§†åŒ–å·¥å…·ï¼Œä½ ä¼šå‘ç°æœ‰åºé›†åˆå­˜å‚¨çš„ç»“æ„æ˜¯è¿™æ ·ï¼š row value score 1 redis 1 2 mongodb 2 3 mysql 4 æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ä»£ç ï¼Œæˆ‘ä»¬ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºåˆ†å€¼ï¼Œä½¿ç”¨å¯¹è±¡ä½œä¸ºå€¼ï¼Œå­˜å‚¨åˆ°Redisæœ‰åºé›†åˆã€‚ file_put_contents ( string $filename , mixed $data [, int $flags = 0 [, resource $context ]] ) : int â€” å°†ä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ æ‰§è¡Œæˆ‘ä»¬å…ˆå°è¯•å†™å…¥ä»»åŠ¡ï¼š (new TestDelayTask(4))-&gt;startAfter(900); (new TestDelayTask(4))-&gt;startAfter(120); (new TestDelayTask(4))-&gt;startAfter(600); (new TestDelayTask(3))-&gt;startAt(158120384); (new TestDelayTask(3))-&gt;startAt(158420380); (new TestDelayTask(3))-&gt;startAt(158120900); æ‰§è¡Œä»£ç ï¼š class DelayTaskTask &#123; const QueneName = &#x27;delayTask&#x27;; private $currentTime; private $once = 5; public function run() &#123; $this-&gt;currentTime = time(); error_reporting(error_reporting() &amp; ~E_WARNING); while (true) &#123; // æ¯æ¬¡å–å‡º5æ¡ $list = RedisManager::getRedis()-&gt;zRange(self::QueneName, 0, $this-&gt;once, true); if (!empty($list)) &#123; foreach ($list as $val=&gt;$score) &#123; if ($score &lt; $this-&gt;currentTime) &#123; unserialize($val)-&gt;run(); RedisManager::getRedis()-&gt;zDelete(self::QueneName, $val); &#125; else &#123; break 2; &#125; &#125; &#125; else &#123; break; &#125; &#125; &#125; &#125; (new DelayTaskTask())-&gt;run(); æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ä¸Šè¿°ä»£ç ã€‚ æˆ‘ä»¬æ‰§è¡Œä¹‹åï¼Œä¼šå‘ç°ä¸€æ—¦è¿‡äº†æˆ‘ä»¬è®¾å®šçš„æ—¶é—´ï¼Œtext.txtå°±ä¸æ–­æœ‰æ–‡å­—å†™å…¥äº†ã€‚ ä»£ç æ¯”è¾ƒæ‚ï¼Œæˆ‘æœ‰ä¸€ä¸ªdemoä»£ç ï¼Œå¤§å®¶å¯ä»¥æŸ¥çœ‹ã€‚ DelayTask-åŸºäºredisçš„å»¶æ—¶ä»»åŠ¡ è¿™æ ·ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨Redisæœ‰åºé›†åˆï¼Œå®Œæˆäº†ä¸€ä¸ªå¾ˆåŸºç¡€çš„å»¶æ—¶ä»»åŠ¡ã€‚ é—®é¢˜ åŠ å…¥runæ–¹æ³•ä»£ç æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œé—´éš”æœ‰ç‚¹é•¿ï¼Œèƒ½ä¸èƒ½ä¼˜åŒ–å‘¢ï¼Ÿ","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"åº”ç”¨ç¯‡ï¼š1.åˆ†å¸ƒå¼é”","slug":"phpframe13","date":"2020-02-22T02:35:57.000Z","updated":"2022-03-19T15:25:54.305Z","comments":true,"path":"2020/02/22/phpframe13/","link":"","permalink":"https://github.13sai.com/2020/02/22/phpframe13/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ å«ä¹‰ ä¸ºäº†é˜²æ­¢åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤šä¸ªè¿›ç¨‹ä¹‹é—´ç›¸äº’å¹²æ‰°ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§åˆ†å¸ƒå¼åè°ƒæŠ€æœ¯æ¥å¯¹è¿™äº›è¿›ç¨‹è¿›è¡Œè°ƒåº¦ã€‚è€Œè¿™ä¸ªåˆ†å¸ƒå¼åè°ƒæŠ€æœ¯çš„æ ¸å¿ƒå°±æ˜¯æ¥å®ç°è¿™ä¸ªåˆ†å¸ƒå¼é”ã€‚ åˆ†æ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œä¸€ä¸ªæ–¹æ³•åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªæœºå™¨çš„ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ é«˜å¯ç”¨çš„è·å–é”ä¸é‡Šæ”¾é” é«˜æ€§èƒ½çš„è·å–é”ä¸é‡Šæ”¾é” å…·å¤‡å¯é‡å…¥ç‰¹æ€§ï¼ˆå¯ç†è§£ä¸ºé‡æ–°è¿›å…¥ï¼Œç”±å¤šäºä¸€ä¸ªä»»åŠ¡å¹¶å‘ä½¿ç”¨ï¼Œè€Œä¸å¿…æ‹…å¿ƒæ•°æ®é”™è¯¯ï¼‰ å…·å¤‡é”å¤±æ•ˆæœºåˆ¶ï¼Œé˜²æ­¢æ­»é” å…·å¤‡éé˜»å¡é”ç‰¹æ€§ï¼Œå³æ²¡æœ‰è·å–åˆ°é”å°†ç›´æ¥è¿”å›è·å–é”å¤±è´¥ å®ç°æ–¹å¼å¸¸è§çš„æœ‰ï¼š åŸºäºRedis åŸºäºmysql åŸºäºZookeeper å…·ä½“å®ç°è€ƒè™‘åˆ°æˆ‘ä»¬ä½¿ç”¨çš„PHPè¯­è¨€ï¼Œç®€å•ç»“åˆRedisæ¥å®ç°ä¸€ä¸‹åˆ†å¸ƒå¼é”ã€‚ æˆ‘ä»¬æ¥ç”»ä¸ªç®€å•çš„åŸç†å›¾ï¼š åŸç†ååˆ†ç®€å•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å®ç°å‘¢ï¼Ÿ è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š Redisçš„setnxæ–¹æ³• phpçš„register function processLock($redis, $key, $ttl = 5) &#123; $ret = $redis-&gt;setnx($key, 1); if ($ret) &#123; $redis-&gt;expire($key, $ttl); register_shutdown_function(function () use ($redis, $key)&#123; $redis-&gt;del($key); &#125;); &#125; return $ret; &#125; demoé‡Œçš„$redisæ˜¯ä¸€ä¸ªrediså®ä¾‹ï¼Œæˆ‘ä»¬åœ¨å‰é¢å·²ç»å®ç°è¿‡ï¼Œä¸å¤šè¯´æ˜ã€‚ åŠ é”æˆ‘ä»¬ä½¿ç”¨çš„setnxå‘½ä»¤ï¼Œsenxè¡¨ç¤ºâ€œSET if Not eXistsâ€ï¼Œå¦‚æœkeyä¸å­˜åœ¨ï¼Œåˆ™setï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¸set redis&gt; SETNX mykey &quot;Hello&quot; (integer) 1 redis&gt; SETNX mykey &quot;World&quot; (integer) 0 redis&gt; GET mykey &quot;Hello&quot; è§£é”ä½¿ç”¨çš„æ˜¯delï¼Œå³åˆ é™¤è¿™ä¸ªkeyã€‚è¿™é‡Œç»“åˆäº† register_shutdown_function â€” æ³¨å†Œä¸€ä¸ªä¼šåœ¨phpä¸­æ­¢æ—¶æ‰§è¡Œçš„å‡½æ•°ï¼Œè®¾ç½®äº†ä¹‹åæˆ‘ä»¬å°±å¯ä»¥ä¸å¿…æ‰‹åŠ¨å»è§£é” é”è¶…æ—¶è¿™é‡Œç»™é”åŠ äº†ä¸€ä¸ªexpireè¿‡æœŸæ—¶é—´5ç§’ï¼Œç›®çš„æ˜¯é˜²æ­¢ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¹‹åçš„æ‰§è¡Œäº†â€œç¥å¥‡â€ä»£ç æŠ›å‡ºäº†è¯­æ³•é”™è¯¯ï¼Œå¯¼è‡´register_shutdown_functioné‡Œçš„ä»£ç æ²¡æœ‰æ‰§è¡Œï¼Œè™½ç„¶è¯·æ±‚ç»“æŸï¼Œä½†æ˜¯åŠ é”åï¼Œæ²¡æœ‰è§£é”ï¼Œå½±å“äº†åç»­è¯·æ±‚ã€‚ é—®é¢˜ åŠ å…¥setnxä¹‹åexpireä¹‹å‰ç¨‹åºå¼‚å¸¸äº†æ€ä¹ˆåŠï¼Ÿ","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"RedisæŒä¹…åŒ–aofå’Œrdb","slug":"RedisæŒä¹…åŒ–aofå’Œrdb","date":"2020-02-16T13:46:51.000Z","updated":"2022-03-30T11:20:47.109Z","comments":true,"path":"2020/02/16/aof/","link":"","permalink":"https://github.13sai.com/2020/02/16/aof/","excerpt":"","text":"RedisæŒä¹…æŒä¹…åŒ–çš„åŠŸèƒ½:Redisæ˜¯å†…å­˜æ•°æ®åº“ï¼Œæ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸ºäº†é¿å…è¿›ç¨‹é€€å‡ºå¯¼è‡´æ•°æ®çš„æ°¸ä¹…ä¸¢å¤±ï¼Œéœ€è¦å®šæœŸå°†Redisä¸­çš„æ•°æ®ä»¥æŸç§å½¢å¼(æ•°æ®æˆ–å‘½ä»¤) ä»å†…å­˜ä¿å­˜åˆ°ç¡¬ç›˜ã€‚ å½“ä¸‹æ¬¡Redisé‡å¯æ—¶ï¼Œåˆ©ç”¨æŒä¹…åŒ–æ–‡ä»¶å®ç°æ•°æ®æ¢å¤ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸ºäº†è¿›è¡Œç¾éš¾å¤‡ä»½ï¼Œå¯ä»¥å°†æŒä¹…åŒ–æ–‡ä»¶æ‹·è´åˆ°ä¸€ä¸ªè¿œç¨‹ä½ç½®ã€‚ RedisæŒä¹…åŒ–åˆ†ä¸ºRDBæŒä¹…åŒ–å’ŒAOFæŒä¹…åŒ–ï¼Œå‰è€…å°†å½“å‰æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ï¼Œåè€…åˆ™æ˜¯å°†æ¯æ¬¡æ‰§è¡Œçš„å†™å‘½ä»¤ä¿å­˜åˆ°ç¡¬ç›˜ã€‚ RDB RDBæ˜¯ä¸€ç§å¿«ç…§å­˜å‚¨æŒä¹…åŒ–æ–¹å¼ï¼Œå…·ä½“å°±æ˜¯å°†RedisæŸä¸€æ—¶åˆ»çš„å†…å­˜æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜çš„æ–‡ä»¶å½“ä¸­ï¼Œé»˜è®¤ä¿å­˜çš„æ–‡ä»¶åä¸ºdump.rdbï¼Œè€Œåœ¨RedisæœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œä¼šé‡æ–°åŠ è½½dump.rdbæ–‡ä»¶çš„æ•°æ®åˆ°å†…å­˜å½“ä¸­æ¢å¤æ•°æ®ã€‚ ï¼Œè§¦å‘ RDB æŒä¹…åŒ–è¿‡ç¨‹åˆ†ä¸ºæ‰‹åŠ¨è§¦å‘å’Œè‡ªåŠ¨è§¦å‘ã€‚ è§¦å‘æœºåˆ¶save å‘½ä»¤:é˜»å¡å½“å‰ Redis æœåŠ¡å™¨ï¼Œç›´åˆ° RDB è¿‡ç¨‹å®Œæˆä¸ºæ­¢ï¼Œå¯¹äºå†…å­˜æ¯”è¾ƒå¤§çš„å®ä¾‹ä¼šé€ æˆé•¿æ—¶é—´é˜»å¡ï¼Œçº¿ä¸Šç¯å¢ƒä¸å»ºè®®ä½¿ç”¨ã€‚ bgsave å‘½ä»¤:Redis è¿›ç¨‹æ‰§è¡Œ fork æ“ä½œåˆ›å»ºå­è¿›ç¨‹ï¼ŒRDB æŒä¹…åŒ–è¿‡ç¨‹ç”±å­è¿›ç¨‹è´Ÿè´£ï¼Œå®Œæˆåè‡ªåŠ¨ç»“æŸã€‚é˜»å¡åªå‘ç”Ÿåœ¨ fork é˜¶æ®µï¼Œä¸€èˆ¬æ—¶é—´å¾ˆçŸ­ã€‚ æ˜¾ç„¶ bgsave å‘½ä»¤æ˜¯é’ˆå¯¹ saveé˜»å¡é—®é¢˜åšçš„ä¼˜åŒ–ã€‚å› æ­¤ Redis å†…éƒ¨æ‰€æœ‰çš„æ¶‰åŠ RDB çš„æ“ä½œéƒ½é‡‡ç”¨ bgsave çš„æ–¹å¼ã€‚ é™¤äº†æ‰§è¡Œå‘½ä»¤æ‰‹åŠ¨è§¦å‘ä¹‹å¤–ï¼ŒRedis å†…éƒ¨è¿˜å­˜åœ¨è‡ªåŠ¨è§¦å‘ RDB çš„æŒä¹…åŒ–æœºåˆ¶ï¼Œä¾‹å¦‚ä»¥ä¸‹åœºæ™¯: ä½¿ç”¨ save ç›¸å…³é…ç½®ï¼Œå¦‚â€œsave m nâ€ã€‚è¡¨ç¤º m ç§’å†…æ•°æ®é›†å­˜åœ¨ n æ¬¡ä¿®æ”¹æ—¶ï¼Œè‡ªåŠ¨è§¦å‘ bgsaveã€‚ å¦‚æœä»èŠ‚ç‚¹æ‰§è¡Œå…¨é‡å¤åˆ¶æ“ä½œï¼Œä¸»èŠ‚ç‚¹è‡ªåŠ¨æ‰§è¡Œ bgsave ç”Ÿæˆ RDB æ–‡ä»¶å¹¶å‘é€ç»™ä»èŠ‚ç‚¹ã€‚ æ‰§è¡Œ debug reload å‘½ä»¤é‡æ–°åŠ è½½ Redis æ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨è§¦å‘ save æ“ä½œã€‚ é»˜è®¤æƒ…å†µä¸‹æ‰§è¡Œ shutdown å‘½ä»¤æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¼€å¯ AOF æŒä¹…åŒ–åŠŸèƒ½åˆ™è‡ªåŠ¨æ‰§è¡Œ bgsaveã€‚ bgsaveæµç¨‹ æ‰§è¡Œ bgsave å‘½ä»¤ï¼ŒRedis çˆ¶è¿›ç¨‹åˆ¤æ–­å½“å‰æ˜¯å¦å­˜åœ¨æ­£åœ¨æ‰§è¡Œçš„å­è¿›ç¨‹ï¼Œå¦‚ RDB/AOF å­è¿›ç¨‹ï¼Œå¦‚æœå­˜åœ¨ bgsave å‘½ä»¤ç›´æ¥è¿”å›ã€‚ çˆ¶è¿›ç¨‹æ‰§è¡Œ fork æ“ä½œåˆ›å»ºå­è¿›ç¨‹ï¼Œforkæ“ä½œè¿‡ç¨‹ä¸­çˆ¶è¿›ç¨‹ä¼šé˜»å¡ã€‚ çˆ¶è¿›ç¨‹ fork å®Œæˆåï¼Œbgsave å‘½ä»¤è¿”å›â€œBackground saving startedâ€ä¿¡æ¯å¹¶ä¸å†é˜»å¡çˆ¶è¿›ç¨‹ï¼Œå¯ä»¥ç»§ç»­å“åº”å…¶ä»–å‘½ä»¤ã€‚ å­è¿›ç¨‹ä¼šå…±äº«ä¸€éƒ¨åˆ†ä¸»è¿›ç¨‹çš„æ•°æ®ç©ºé—´ï¼Œå¹¶ä¸”æŠŠå…±äº«çš„æ•°æ®ç½®ä¸ºread-onlyçš„çŠ¶æ€ï¼Œå­è¿›ç¨‹åˆ›å»º RDB æ–‡ä»¶ï¼Œæ ¹æ®çˆ¶è¿›ç¨‹å†…å­˜ç”Ÿæˆä¸´æ—¶å¿«ç…§æ–‡ä»¶ï¼Œå®Œæˆåå¯¹åŸæœ‰æ–‡ä»¶è¿›è¡ŒåŸå­æ›¿æ¢ã€‚åœ¨æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­æ˜¯é¿å…ä¸äº†æœ‰æ–°çš„æ•°æ®å†™å…¥çš„ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ä¸€éƒ¨åˆ†çš„æ•°æ®æ˜¯å…±äº«çš„ï¼Œä¸¤ä¸ªè¿›ç¨‹åŒæ—¶æ‹¥æœ‰ä¸€å—æ•°æ®ï¼Œè‚¯å®šä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œ ä½†æ˜¯ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„forkæœºåˆ¶ï¼Œåœ¨ä¿®æ”¹çš„æ—¶å€™ä¸€å®šæ˜¯ä¿®æ”¹éƒ¨åˆ†å†…å­˜é¡µçš„æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™ä¼šè§¦å‘å¯¹åº”å†…å­˜é¡µçš„copyonwriteçš„æ“ä½œ è¿›ç¨‹å‘é€ä¿¡å·ç»™çˆ¶è¿›ç¨‹è¡¨ç¤ºå®Œæˆï¼Œçˆ¶è¿›ç¨‹æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ã€‚ é…ç½®æ–‡ä»¶ï¼ˆæµç¨‹ç±»ä¼¼bgsaveï¼‰# 900så†…è‡³å°‘è¾¾åˆ°ä¸€æ¡å†™å‘½ä»¤ save 900 1 # 300så†…è‡³å°‘è¾¾è‡³10æ¡å†™å‘½ä»¤ save 300 10 # 60så†…è‡³å°‘è¾¾åˆ°10000æ¡å†™å‘½ä»¤ save 60 10000 RDB æ–‡ä»¶çš„å¤„ç†1. ä¿å­˜:RDB æ–‡ä»¶ä¿å­˜åœ¨ dir é…ç½®æŒ‡å®šçš„ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åé€šè¿‡ dbfilename é…ç½®æŒ‡å®šã€‚å¯ä»¥é€šè¿‡æ‰§è¡Œ config set dir{newDir}å’Œ config setdbfilename{newFileName}è¿è¡ŒæœŸåŠ¨æ€æ‰§è¡Œï¼Œå½“ä¸‹æ¬¡è¿è¡Œæ—¶ RDB æ–‡ä»¶ä¼šä¿å­˜åˆ°æ–°ç›®å½•ã€‚å½“é‡åˆ°åç›˜æˆ–ç£ç›˜å†™æ»¡ç­‰æƒ…å†µæ—¶ï¼Œå¯ä»¥é€šè¿‡ config set dir{newDir}åœ¨çº¿ä¿®æ”¹æ–‡ä»¶è·¯å¾„åˆ°å¯ç”¨çš„ç£ç›˜è·¯å¾„ï¼Œä¹‹åæ‰§è¡Œ bgsave è¿›è¡Œç£ç›˜åˆ‡æ¢ï¼ŒåŒæ ·é€‚ç”¨äº AOF æŒä¹…åŒ–æ–‡ä»¶ã€‚ 2. å‹ç¼©:Redis é»˜è®¤é‡‡ç”¨ LZF ç®—æ³•å¯¹ç”Ÿæˆçš„ RDB æ–‡ä»¶åšå‹ç¼©å¤„ç†ï¼Œå‹ç¼©åçš„æ–‡ä»¶è¿œè¿œå°äºå†…å­˜å¤§å°ï¼Œé»˜è®¤å¼€å¯ï¼Œå¯ä»¥é€šè¿‡å‚æ•° config set rdbcompression{yes|no}åŠ¨æ€ä¿®æ”¹ã€‚è™½ç„¶å‹ç¼© RDB ä¼šæ¶ˆè€— CPUï¼Œä½†å¯å¤§å¹…é™ä½æ–‡ä»¶çš„ä½“ç§¯ï¼Œæ–¹ä¾¿ä¿å­˜åˆ°ç¡¬ç›˜æˆ–é€šè¿‡ç½‘ç»œå‘é€ç»™ä»èŠ‚ç‚¹ï¼Œå› æ­¤çº¿ä¸Šå»ºè®®å¼€å¯ã€‚ RDBæ–¹å¼çš„ä¼˜ç‚¹ RDB æ˜¯ä¸€ä¸ªéå¸¸ç´§å‡‘çš„æ–‡ä»¶ï¼Œå®ƒä¿å­˜äº† Redis åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„æ•°æ®é›†ã€‚è¿™ç§æ–‡ä»¶éå¸¸é€‚åˆç”¨äºè¿›è¡Œå¤‡ä»½: æ¯”å¦‚è¯´ï¼Œä½ å¯ä»¥åœ¨æœ€è¿‘çš„ 24å°æ—¶å†…ï¼Œæ¯å°æ—¶å¤‡ä»½ä¸€æ¬¡ RDBæ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªæœˆçš„æ¯ä¸€å¤©ï¼Œä¹Ÿå¤‡ä»½ä¸€ä¸ª RDB æ–‡ä»¶ã€‚ è¿™æ ·çš„è¯ï¼Œå³ä½¿é‡ä¸Šé—®é¢˜ï¼Œä¹Ÿå¯ä»¥éšæ—¶å°†æ•°æ®é›†è¿˜åŸåˆ°ä¸åŒçš„ç‰ˆæœ¬ã€‚ RDB å¯ä»¥æœ€å¤§åŒ– Redis çš„æ€§èƒ½:çˆ¶è¿›ç¨‹åœ¨ä¿å­˜ RDB æ–‡ä»¶æ—¶å”¯ä¸€è¦åšçš„å°±æ˜¯ fork å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶åè¿™ä¸ªå­è¿›ç¨‹å°±ä¼šå¤„ç†æ¥ä¸‹æ¥çš„æ‰€æœ‰ä¿å­˜ å·¥ä½œï¼Œçˆ¶è¿›ç¨‹æ— é¡»æ‰§è¡Œä»»ä½•ç£ç›˜ I/O æ“ä½œã€‚ RDB åœ¨æ¢å¤å¤§æ•°æ®é›†æ—¶çš„é€Ÿåº¦æ¯” AOF çš„æ¢å¤é€Ÿåº¦è¦å¿«ã€‚ RDBæ–¹å¼çš„ç¼ºç‚¹ RDB æ–¹å¼æ•°æ®æ²¡åŠæ³•åšåˆ°å®æ—¶æŒä¹…åŒ–/ç§’çº§æŒä¹…åŒ–ã€‚ å¦‚æœæœåŠ¡å™¨å®•æœºçš„è¯ï¼Œé‡‡ç”¨RDBçš„æ–¹å¼ä¼šé€ æˆæŸä¸ªæ—¶æ®µå†…æ•°æ®çš„ä¸¢å¤±ï¼Œæ¯”å¦‚æˆ‘ä»¬è®¾ç½®10åˆ†é’ŸåŒæ­¥ä¸€æ¬¡æˆ–5åˆ†é’Ÿè¾¾åˆ°1000æ¬¡å†™å…¥å°±åŒæ­¥ä¸€æ¬¡ï¼Œé‚£ä¹ˆå¦‚æœè¿˜æ²¡è¾¾åˆ°è§¦å‘æ¡ä»¶æœåŠ¡å™¨å°±æ­»æœºäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶é—´æ®µçš„æ•°æ®ä¼šä¸¢å¤±ã€‚ ä½¿ç”¨bgsaveå‘½ä»¤åœ¨forkså­è¿›ç¨‹æ—¶ï¼Œå¦‚æœæ•°æ®é‡å¤ªå¤§ï¼Œforksçš„è¿‡ç¨‹ä¹Ÿä¼šå‘ç”Ÿé˜»å¡ï¼Œå¦å¤–ï¼Œforkså­è¿›ç¨‹ä¼šè€—è´¹å†…å­˜ã€‚ AOF AOF(append only file)æŒä¹…åŒ–:ä¸RDBå­˜å‚¨æŸä¸ªæ—¶åˆ»çš„å¿«ç…§ä¸åŒï¼ŒAOFæŒä¹…åŒ–æ–¹å¼ä¼šè®°å½•å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨çš„æ¯ä¸€æ¬¡å†™æ“ä½œå‘½ä»¤åˆ°æ—¥å¿—å½“ä¸­ï¼Œå¹¶å°†è¿™äº›å†™æ“ä½œä»¥Redisåè®®è¿½åŠ ä¿å­˜åˆ°ä»¥åç¼€ä¸ºaofæ–‡ä»¶æœ«å°¾ é…ç½®redis.conf appendonly yes #å¯ç”¨aofæŒä¹…åŒ–æ–¹å¼ appendfsync always/no/everysec è®¾ç½®ä¸ºalwaysæ—¶ï¼Œä¼šæå¤§æ¶ˆå¼±Redisçš„æ€§èƒ½ï¼Œå› ä¸ºè¿™ç§æ¨¡å¼ä¸‹æ¯æ¬¡writeåéƒ½ä¼šè°ƒç”¨fsyncï¼ˆLinuxä¸ºè°ƒç”¨fdatasyncï¼‰ã€‚ å¦‚æœè®¾ç½®ä¸ºnoï¼Œåˆ™writeåä¸ä¼šæœ‰fsyncè°ƒç”¨ï¼Œç”±æ“ä½œç³»ç»Ÿè‡ªåŠ¨è°ƒåº¦åˆ·ç£ç›˜ï¼Œæ€§èƒ½æ˜¯æœ€å¥½çš„ã€‚ everysecä¸ºæœ€å¤šæ¯ç§’è°ƒç”¨ä¸€æ¬¡fsyncï¼Œè¿™ç§æ¨¡å¼æ€§èƒ½å¹¶ä¸æ˜¯å¾ˆç³Ÿç³•ï¼Œä¸€èˆ¬ä¹Ÿä¸ä¼šäº§ç”Ÿæ¯›åˆºï¼Œè¿™å½’åŠŸäºRediså¼•å…¥äº†BIOçº¿ç¨‹ï¼Œæ‰€æœ‰fsyncæ“ä½œéƒ½å¼‚æ­¥äº¤ç»™äº†BIOçº¿ç¨‹ã€‚ æµç¨‹ æ‰€æœ‰çš„å†™å…¥å‘½ä»¤ä¼šè¿½åŠ åˆ° aof_buf(ç¼“å†²åŒº)ä¸­ã€‚ï¼ˆRedisä½¿ç”¨å•çº¿ç¨‹å“åº”å‘½ä»¤ï¼Œå¦‚æœæ¯æ¬¡AOFæ–‡ä»¶å‘½ä»¤éƒ½è¿½åŠ åˆ°ç£ç›˜ï¼Œä¼šæå¤§çš„å½±å“å¤„ç†æ€§èƒ½ï¼‰ AOF ç¼“å†²åŒºæ ¹æ®å¯¹åº”çš„ç­–ç•¥å‘ç¡¬ç›˜åšåŒæ­¥æ“ä½œã€‚ éšç€ AOF æ–‡ä»¶è¶Šæ¥è¶Šå¤§ï¼Œéœ€è¦å®šæœŸå¯¹ AOF æ–‡ä»¶è¿›è¡Œé‡å†™ï¼Œè¾¾åˆ°å‹ç¼©çš„ç›®çš„ã€‚ å½“ Redis æœåŠ¡å™¨é‡å¯æ—¶ï¼Œå¯ä»¥åŠ è½½ AOF æ–‡ä»¶è¿›è¡Œæ•°æ®æ¢å¤ã€‚ é‡å†™æœºåˆ¶ AOFå°†å®¢æˆ·ç«¯çš„æ¯ä¸€ä¸ªå†™æ“ä½œéƒ½è¿½åŠ åˆ°aofæ–‡ä»¶æœ«å°¾ï¼Œéšç€å‘½ä»¤ä¸æ–­å†™å…¥ AOFï¼Œæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒRedis å¼•å…¥äº†AOF é‡å†™æœºåˆ¶å‹ç¼©æ–‡ä»¶ä½“ç§¯ã€‚AOF æ–‡ä»¶é‡å†™æ˜¯æŠŠ Redis è¿›ç¨‹å†…çš„æ•°æ®è½¬åŒ–ä¸ºå†™å‘½ä»¤åŒæ­¥åˆ°æ–° AOF æ–‡ä»¶çš„è¿‡ç¨‹ã€‚ æ¯”å¦‚:å¤šæ¡å†™å‘½ä»¤å¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªï¼Œå¦‚:lpush list aã€lpush list bã€lpush list c å¯ä»¥è½¬åŒ–ä¸º:lpush list a b cã€‚ AOF é‡å†™é™ä½äº†æ–‡ä»¶å ç”¨ç©ºé—´ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå¦ä¸€ä¸ªç›®çš„æ˜¯:æ›´å°çš„ AOF æ–‡ä»¶å¯ä»¥æ›´å¿«åœ°è¢« Redis åŠ è½½ã€‚ é‡å†™æµç¨‹ æ‰§è¡Œ AOF é‡å†™è¯·æ±‚ã€‚ å¦‚æœå½“å‰è¿›ç¨‹æ­£åœ¨æ‰§è¡Œ AOF é‡å†™ï¼Œè¯·æ±‚ä¸æ‰§è¡Œå¹¶è¿”å›å¦‚ä¸‹å“åº”: ERR Background append only file rewriting already in progress çˆ¶è¿›ç¨‹æ‰§è¡Œ fork åˆ›å»ºå­è¿›ç¨‹ï¼Œå¹¶æ‹¿åˆ°forkæ—¶çš„AOFæ–‡ä»¶æ•°æ®å†™åˆ°ä¸€ä¸ªä¸´æ—¶AOFæ–‡ä»¶ä¸­ã€‚ ä¸»è¿›ç¨‹ fork æ“ä½œå®Œæˆåï¼Œç»§ç»­å“åº”å…¶ä»–å‘½ä»¤ã€‚æ‰€æœ‰ä¿®æ”¹å‘½ä»¤ä¾ç„¶å†™å…¥ AOF ç¼“å†²åŒºå¹¶æ ¹æ® appendfsync ç­–ç•¥åŒæ­¥åˆ°ç¡¬ç›˜ï¼Œä¿è¯åŸæœ‰ AOF æœºåˆ¶æ­£ç¡® æ€§ã€‚ ç”±äº fork æ“ä½œè¿ç”¨å†™æ—¶å¤åˆ¶æŠ€æœ¯ï¼Œå­è¿›ç¨‹åªèƒ½å…±äº« fork æ“ä½œæ—¶çš„å†…å­˜æ•°æ®ã€‚ç”±äºçˆ¶è¿›ç¨‹ä¾ç„¶å“åº”å‘½ä»¤ï¼ŒRedis ä½¿ç”¨â€œAOF é‡å†™ç¼“å†²åŒºâ€ä¿å­˜è¿™éƒ¨åˆ†æ–°æ•°æ®ï¼Œé˜²æ­¢æ–° AOF æ–‡ä»¶ç”ŸæˆæœŸé—´ä¸¢å¤±è¿™éƒ¨åˆ†æ•°æ®ã€‚ å­è¿›ç¨‹æ ¹æ®å†…å­˜å¿«ç…§ï¼ŒæŒ‰ç…§å‘½ä»¤åˆå¹¶è§„åˆ™å†™å…¥åˆ°æ–°çš„ AOF æ–‡ä»¶ã€‚æ¯æ¬¡æ‰¹é‡å†™å…¥ç¡¬ç›˜æ•°æ®é‡ç”±é…ç½® aof-rewrite-incremental-fsync æ§åˆ¶ï¼Œé»˜è®¤ä¸º 32MBï¼Œé˜²æ­¢å• æ¬¡åˆ·ç›˜æ•°æ®è¿‡å¤šé€ æˆç¡¬ç›˜é˜»å¡ã€‚ 5.1) æ–° AOF æ–‡ä»¶å†™å…¥å®Œæˆåï¼Œå­è¿›ç¨‹å‘é€ä¿¡å·ç»™çˆ¶è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ã€‚5.2) çˆ¶è¿›ç¨‹æŠŠ AOF é‡å†™ç¼“å†²åŒºçš„æ•°æ®å†™å…¥åˆ°æ–°çš„ AOF æ–‡ä»¶ã€‚5.3) ä½¿ç”¨æ–° AOF æ–‡ä»¶æ›¿æ¢è€æ–‡ä»¶ï¼Œå®Œæˆ AOF é‡å†™ã€‚ è§¦å‘é‡å†™ æ‰‹åŠ¨è§¦å‘:ç›´æ¥è°ƒç”¨ bgrewriteaof å‘½ä»¤ã€‚ è‡ªåŠ¨è§¦å‘:æ ¹æ® auto-aof-rewrite-min-sizeå’Œauto-aof-rewrite-percentage å‚æ•°ç¡®å®šè‡ªåŠ¨è§¦å‘æ—¶æœºã€‚ auto-aof-rewrite-min-size:è¡¨ç¤ºè¿è¡Œ AOF é‡å†™æ—¶æ–‡ä»¶æœ€å°ä½“ç§¯ï¼Œé»˜è®¤ä¸º 64MBã€‚ auto-aof-rewrite-percentage:ä»£è¡¨å½“å‰ AOF æ–‡ä»¶ç©ºé—´(aof_current_size)å’Œä¸Šä¸€æ¬¡é‡å†™å AOF æ–‡ä»¶ç©ºé—´(aof_base_size)çš„æ¯”å€¼ã€‚ ç¤ºä¾‹: auto-aof-rewrite-percentage:100 auto-aof-rewrite-min-size:64mb é»˜è®¤é…ç½®æ˜¯å½“AOFæ–‡ä»¶å¤§å°æ˜¯ä¸Šæ¬¡rewriteåå¤§å°çš„ä¸€å€ä¸”æ–‡ä»¶å¤§äº64Mæ—¶è§¦å‘ å¼‚å¸¸å¤„ç†AOFæ–‡ä»¶æŸååœ¨å†™å…¥aofæ—¥å¿—æ–‡ä»¶æ—¶ï¼Œå¦‚æœRedisæœåŠ¡å™¨å®•æœºï¼Œåˆ™aofæ—¥å¿—æ–‡ä»¶æ–‡ä»¶ä¼šå‡ºæ ¼å¼é”™è¯¯ï¼Œåœ¨é‡å¯RedisæœåŠ¡å™¨æ—¶ï¼ŒRedisæœåŠ¡å™¨ä¼šæ‹’ç»è½½å…¥è¿™ä¸ªaofæ–‡ä»¶ï¼Œ å¯ä»¥é€šè¿‡å‘½ä»¤ä¿®å¤aofå¹¶æ¢å¤æ•°æ® redis-check-aof -fix file.aof AOFçš„ä¼˜ç‚¹ AOFå¯ä»¥è®¾ç½® å®Œå…¨ä¸åŒæ­¥ã€æ¯ç§’åŒæ­¥ã€æ¯æ¬¡æ“ä½œåŒï¼Œé»˜è®¤æ˜¯æ¯ç§’åŒæ­¥ã€‚å› ä¸ºAOFæ˜¯æ“ä½œæŒ‡ä»¤çš„è¿½åŠ ï¼Œæ‰€ä»¥å¯ä»¥é¢‘ç¹çš„å¤§é‡çš„åŒæ­¥ã€‚ AOFæ–‡ä»¶æ˜¯ä¸€ä¸ªå€¼è¿½åŠ æ—¥å¿—çš„æ–‡ä»¶ï¼Œå³ä½¿æœåŠ¡å®•æœºä¸ºå†™å…¥å®Œæ•´çš„å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥é€šè¿‡redis-check-aofå·¥å…·ä¿®å¤è¿™äº›é—®é¢˜ã€‚ å¦‚æœAOFæ–‡ä»¶è¿‡å¤§ï¼ŒRedisä¼šåœ¨åå°è‡ªåŠ¨åœ°é‡å†™AOFæ–‡ä»¶ã€‚é‡å†™åä¼šä½¿AOFæ–‡ä»¶å‹ç¼©åˆ°æœ€å°æ‰€éœ€çš„æŒ‡ä»¤é›†ã€‚ AOFæ–‡ä»¶æ˜¯æœ‰åºä¿å­˜æ•°æ®åº“çš„æ‰€æœ‰å†™å…¥æ“ä½œï¼Œæ˜“è¯»ï¼Œæ˜“åˆ†æã€‚å³ä½¿å¦‚æœä¸å°å¿ƒè¯¯æ“ä½œæ•°æ®åº“ï¼Œä¹Ÿå¾ˆå®¹æ˜“æ‰¾å‡ºé”™è¯¯æŒ‡ä»¤ï¼Œæ¢å¤åˆ°æŸä¸ªæ•°æ®èŠ‚ç‚¹ã€‚ä¾‹å¦‚ä¸å°å¿ƒFLUSHALLï¼Œå¯ä»¥éå¸¸å®¹æ˜“æ¢å¤åˆ°æ‰§è¡Œå‘½ä»¤ä¹‹å‰ã€‚ AOFçš„ç¼ºç‚¹ ç›¸åŒæ•°æ®é‡ä¸‹ï¼ŒAOFçš„æ–‡ä»¶é€šå¸¸ä½“ç§¯ä¼šæ¯”RDBå¤§ã€‚å› ä¸ºAOFæ˜¯å­˜æŒ‡ä»¤çš„ï¼Œè€ŒRDBæ˜¯æ‰€æœ‰æŒ‡ä»¤çš„ç»“æœå¿«ç…§ã€‚ä½†AOFåœ¨æ—¥å¿—é‡å†™åä¼šå‹ç¼©ä¸€äº›ç©ºé—´ã€‚ åœ¨å¤§é‡å†™å…¥å’Œè½½å…¥çš„æ—¶å€™ï¼ŒAOFçš„æ•ˆç‡ä¼šæ¯”RDBä½ã€‚å› ä¸ºå¤§é‡å†™å…¥ï¼ŒAOFä¼šæ‰§è¡Œæ›´å¤šçš„ä¿å­˜å‘½ä»¤ï¼Œè½½å…¥çš„æ—¶å€™ä¹Ÿéœ€è¦å¤§é‡çš„é‡æ‰§è¡Œå‘½ä»¤æ¥å¾—åˆ°æœ€åçš„ç»“æœã€‚RDBå¯¹æ­¤æ›´æœ‰ä¼˜åŠ¿ã€‚ é…ç½®æ±‡æ€»save 60 1000:60så†…è‡³å°‘è¾¾åˆ°1000æ¡å†™å‘½ä»¤ appendonly no:æ˜¯å¦å¼€å¯AOF appendfilename &quot;appendonly.aof&quot;:AOFæ–‡ä»¶å dir ./:RDBæ–‡ä»¶å’ŒAOFæ–‡ä»¶æ‰€åœ¨ç›®å½• appendfsync everysec:fsyncæŒä¹…åŒ–ç­–ç•¥ no-appendfsync-on-rewrite no:AOFé‡å†™æœŸé—´æ˜¯å¦ç¦æ­¢fsync;å¦‚æœå¼€å¯è¯¥é€‰é¡¹ï¼Œå¯ä»¥å‡è½»æ–‡ä»¶é‡å†™æ—¶CPUå’Œç¡¬ç›˜çš„è´Ÿè½½(å°¤å…¶æ˜¯ç¡¬ç›˜)ï¼Œä½†æ˜¯å¯èƒ½ä¼šä¸¢ å¤±AOFé‡å†™æœŸé—´çš„æ•°æ®;éœ€è¦åœ¨è´Ÿè½½å’Œå®‰å…¨æ€§ä¹‹é—´è¿›è¡Œå¹³è¡¡ auto-aof-rewrite-percentage 100:æ–‡ä»¶é‡å†™è§¦å‘æ¡ä»¶ä¹‹ä¸€ auto-aof-rewrite-min-size 64mb:æ–‡ä»¶é‡å†™è§¦å‘æäº¤ä¹‹ä¸€ aof-load-truncated yes:å¦‚æœAOFæ–‡ä»¶ç»“å°¾æŸåï¼ŒRediså¯åŠ¨æ—¶æ˜¯å¦ä»è½½å…¥AOFæ–‡ä»¶","categories":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/categories/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/tags/Redis/"}]},{"title":"æ¡†æ¶ç¯‡ï¼š9.è®¾è®¡æ¨¡å¼","slug":"phpframe12","date":"2020-02-16T07:35:57.000Z","updated":"2022-03-19T15:25:48.145Z","comments":true,"path":"2020/02/16/phpframe12/","link":"","permalink":"https://github.13sai.com/2020/02/16/phpframe12/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ æ¡†æ¶çš„å¼€å‘åŸºæœ¬ç»“æŸäº†ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬æ¥æ¢è®¨ä¸€ä¸‹è®¾è®¡æ¨¡å¼ã€‚ è°ˆè®¾è®¡æ¨¡å¼ï¼Œé¦–å…ˆè¦æ¥ç®€å•èŠèŠé¢å‘å¯¹è±¡ã€‚ é¢å‘å¯¹è±¡ é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼ˆObject-Oriented Programming, OOPï¼‰æ˜¯ä¸€ç§ç¨‹åºè®¾è®¡èŒƒå‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§ç¨‹åºå¼€å‘æ–¹æ³•ã€‚å®ƒå°†å¯¹è±¡ä½œä¸ºç¨‹åºçš„åŸºæœ¬å•å…ƒï¼Œå°†ç¨‹åºå’Œæ•°æ®å°è£…å…¶ä¸­ï¼Œä»¥æé«˜è½¯ä»¶çš„é‡ç”¨æ€§ã€çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚å®ƒå’Œé¢å‘è¿‡ç¨‹ã€å‡½æ•°å¼ç¼–ç¨‹è¢«ç§°ä¸ºç¼–ç¨‹è¯­è¨€ä¸­çš„ä¸‰å¤§èŒƒå¼ã€‚ æ¦‚å¿µçŸ¥è¯† é¢å‘å¯¹è±¡çš„æ ¸å¿ƒæ€æƒ³æ˜¯å¯¹è±¡ã€å°è£…ã€å¯é‡ç”¨æ€§ã€å¯æ‰©å±•æ€§ã€‚ é¢å‘å¯¹è±¡ä¸‰è¦ç´ ï¼šå°è£…ã€ç»§æ‰¿å’Œå¤šæ€ã€‚ é¢å‘å¯¹è±¡è®¾è®¡çš„äº”å¤§åŸåˆ™ï¼šå•ä¸€èŒè´£åŸåˆ™ã€æ¥å£éš”ç¦»åŸåˆ™ã€å¼€æ”¾å°é—­åŸåˆ™ã€æ›¿æ¢åŸåˆ™ã€ä¾èµ–å€’ç½®åŸåˆ™ã€‚ å…³äºè¿™äº›æ¦‚å¿µçš„æ›´è¯¦ç»†è§£é‡Šï¼Œæˆ‘æ¨èå¤§å®¶é˜…è¯»ã€ŠPHPæ ¸å¿ƒæŠ€æœ¯ä¸æœ€ä½³å®è·µã€‹è¿™æœ¬ä¹¦å…³äºå…³äºé¢å‘å¯¹è±¡çš„éƒ¨åˆ†ã€‚ è®¾è®¡æ¨¡å¼ä¸Šè¿°æ‰€è¿°çš„é¢å‘å¯¹è±¡çŸ¥è¯†ï¼Œå°¤å…¶æ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„äº”å¤§åŸåˆ™ï¼Œæ˜¯è¯¸å¤šè®¾è®¡æ¨¡å¼çš„åŸºç¡€ã€‚ è®¾è®¡æ¨¡å¼æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åˆ—å‡ºæ¥ï¼š æœ‰å¼ºè°ƒå®ä¾‹åŒ–è¿‡ç¨‹çš„åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ æŠ½è±¡å·¥å‚ ç”Ÿæˆå™¨ å·¥å‚æ–¹æ³• åŸå‹ å•ä¾‹ åˆæœ‰ç»„åˆå¯¹è±¡å’Œç±»æ„æˆæ›´å¤§ç»“æ„çš„ç»“æ„å‹è®¾è®¡æ¨¡å¼ é€‚é…å™¨æ¨¡å¼ æ¡¥æ¥æ¨¡å¼ ç»„åˆæ¨¡å¼ è£…é¥°å™¨æ¨¡å¼ å¤–è§‚æ¨¡å¼ äº«å…ƒæ¨¡å¼ ä»£ç†æ¨¡å¼ è¿˜æœ‰è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ èŒè´£é“¾æ¨¡å¼ å‘½ä»¤æ¨¡å¼ è§£é‡Šå™¨æ¨¡å¼ è¿­ä»£å™¨æ¨¡å¼ ä¸­ä»‹è€…æ¨¡å¼ å¤‡å¿˜å½•æ¨¡å¼ è§‚å¯Ÿè€…æ¨¡å¼ çŠ¶æ€æ¨¡å¼ ç­–ç•¥æ¨¡å¼ æ¨¡æ¿æˆæƒæ¨¡å¼ è®¿é—®è€…æ¨¡å¼ è¯´åˆ°è¿™é‡Œä½ æœ‰æ²¡æœ‰è’™åœˆï¼Ÿ å…¶å®æˆ‘ä»¬æ— éœ€ä¸€ä¸‹å­å»äº†è§£é‚£ä¹ˆå¤šè®¾è®¡æ¨¡å¼ï¼Œåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯èƒ½ä¹Ÿæ˜¯æ··åˆä½¿ç”¨è®¾è®¡æ¨¡å¼çš„ã€‚æˆ‘ä»¬ä¸å¦¨å¯ä»¥å°±æ¡†æ¶é‡Œç”¨åˆ°çš„å‡ ä¸ªå…¸å‹çš„è®¾è®¡æ¨¡å¼åšä¸€äº›åˆ†æã€‚ å•ä¾‹æ¨¡å¼æ˜¯å¦è¿˜è®°å¾—æˆ‘ä»¬ä½¿ç”¨Redisä»£æ›¿Sessioné‚£ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°±ç”¨åˆ°äº†å•ä¾‹æ¨¡å¼ã€‚ æˆ‘ä»¬æ¥ç®€åŒ–ä¸€ä¸‹ä»£ç ï¼š class RedisSession &#123; private $redis; private function getRedisInstance() &#123; if (empty($this-&gt;redis)) &#123; $redis = new \\Redis(); $redis-&gt;connect($this-&gt;_config[&#x27;host&#x27;], $this-&gt;_config[&#x27;port&#x27;], $this-&gt;_config[&#x27;timeout&#x27;]); if (!$this-&gt;_config[&#x27;auth&#x27;]) &#123; $redis-&gt;auth($this-&gt;_config[&#x27;auth&#x27;]); &#125; $this-&gt;redis = $redis; &#125; return $this-&gt;redis; &#125; &#125; ä¸€èˆ¬æˆ‘ä»¬è¿˜ä¼šåœ¨ç±»é‡Œé¢åŠ å…¥ä¸€ä¸ªé­”æœ¯æ–¹æ³•__cloneï¼Œé˜²æ­¢å®ä¾‹åˆ›å»ºåè¢«clone å•ä¾‹æ¨¡å¼æœ‰æ˜¾è€Œæ˜“è§çš„ä¼˜ç‚¹ï¼šæé«˜å¯é‡ç”¨æ€§ï¼Œå‡å°‘å¼€é”€ã€‚æ¡†æ¶é‡Œä½¿ç”¨Redisæ—¶éƒ½å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•æ¥è·å–redisï¼Œä¹Ÿå‡å°‘redisçš„è¿æ¥æ•°å’Œå¤šæ¬¡è¿æ¥æ—¶é—´ã€‚ ç­–ç•¥æ¨¡å¼è¿˜è®°å¾—ä¾èµ–æ³¨å…¥é‚£ä¸€èŠ‚ä¹ˆï¼Œæˆ‘ä»¬ä¸¾ä¾‹çš„é‚£ä¸ªTravelå°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç­–ç•¥æ¨¡å¼Demoï¼š interface Travel &#123; public function travelAlgorithm(); &#125; /** *å…·ä½“ç­–ç•¥ç±»(ConcreteStrategy) *1ï¼šä¹˜åé£æœº */ class AirPlanelStrategy implements Travel &#123; public function travelAlgorithm() &#123; echo&quot;travelbyAirPlain\\r\\n&quot;; &#125; &#125; /** *å…·ä½“ç­–ç•¥ç±»(ConcreteStrategy) *2ï¼šä¹˜åç«è½¦ */ class TrainStrategy implements Travel &#123; public function travelAlgorithm() &#123; echo&quot;travelbyTrain\\r\\n&quot;; &#125; &#125; /** * *ç¯å¢ƒç±»(Context): *ç”¨ä¸€ä¸ªConcreteStrategyå¯¹è±¡æ¥é…ç½®ã€‚ *ç»´æŠ¤ä¸€ä¸ªå¯¹Travelå¯¹è±¡çš„å¼•ç”¨ã€‚å¯å®šä¹‰ä¸€ä¸ªæ¥å£æ¥è®©Strategyè®¿é—®å®ƒçš„æ•°æ®ã€‚ *ç®—æ³•è§£å†³ç±»ï¼Œä»¥æä¾›å®¢æˆ·é€‰æ‹©ä½¿ç”¨ä½•ç§è§£å†³æ–¹æ¡ˆï¼š */ class PersonContext &#123; private $strategy = null; public function __construct(Travel $travel) &#123; $this-&gt;strategy=$travel; &#125; /** *æ—…è¡Œ */ public function travel() &#123; return$this-&gt;strategy-&gt;travelAlgorithm(); &#125; &#125; // ä¹˜åç«è½¦æ—…è¡Œ $person = new PersonContext(new TrainStrategy()); $person-&gt;travel(); // æ”¹ä¹˜é£æœº $person =PersonContext(new AirPlanelStrategy()); $person-&gt;travel(); ç­–ç•¥æ¨¡å¼é™ä½äº†ä»£ç è€¦åˆåº¦ï¼Œå¯ä»¥ä½¿å¾—æˆ‘ä»¬ä¸‹å±‚ä»£ç ä¾èµ–ä¸Šå±‚ï¼Œæ›¿æ¢ä¸‹å±‚ä»£ç å³å¯ç®€å•å®ç°åŠŸèƒ½çš„æ›¿æ¢ã€‚ å·¥å‚æ–¹æ³•æˆ‘ä»¬åœ¨è·¯ç”±è§£æåˆ›å»ºæ§åˆ¶å™¨é‚£é‡Œä½¿ç”¨äº†å·¥å‚æ–¹æ³•ï¼Œåªä¸è¿‡ä¸è·¯ç”±è§£æä»£ç ç³…åˆåœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬ç®€åŒ–ä¸€ä¸‹ï¼š class Factory &#123; public function createController($controllerName) &#123; $controllerName = rtrim($controllerName,&#x27;\\\\&#x27;).&#x27;Controller&#x27;; if (!class_exists($controllerName)) &#123; throw new NotFoundException(&quot;æœªæ‰¾åˆ°æ§åˆ¶å™¨&quot;); &#125; return new $controllerName; &#125; Â·Â·Â· &#125; å·¥å‚æ–¹æ³•æ˜¯å¾ˆå¸¸è§çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼ŒåƒModelç»å¸¸èƒ½ç”¨åˆ°ã€‚","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"æ¡†æ¶ç¯‡ï¼š8.ä¾èµ–æ³¨å…¥ä¸æ§åˆ¶åè½¬","slug":"phpframe11","date":"2020-02-15T04:35:57.000Z","updated":"2022-03-19T15:25:44.242Z","comments":true,"path":"2020/02/15/phpframe11/","link":"","permalink":"https://github.13sai.com/2020/02/15/phpframe11/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependence Inversion Principleï¼‰DIPæ˜¯é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ä¹‹ä¸€ã€‚ä¼ ç»Ÿè½¯ä»¶è®¾è®¡ä¸­ï¼Œä¸Šå±‚ä»£ç ä¾èµ–äºä¸‹å±‚ä»£ç ï¼Œå½“ä¸‹å±‚å‡ºç°å˜åŠ¨æ—¶ï¼Œ ä¸Šå±‚ä»£ç ä¹Ÿè¦ç›¸åº”å˜åŒ–ï¼Œç»´æŠ¤æˆæœ¬è¾ƒé«˜ã€‚è€ŒDIPçš„æ ¸å¿ƒæ€æƒ³æ˜¯ä¸Šå±‚å®šä¹‰æ¥å£ï¼Œä¸‹å±‚å®ç°è¿™ä¸ªæ¥å£ï¼Œ ä»è€Œä½¿å¾—ä¸‹å±‚ä¾èµ–äºä¸Šå±‚ï¼Œé™ä½è€¦åˆåº¦ï¼Œæé«˜æ•´ä¸ªç³»ç»Ÿçš„å¼¹æ€§ã€‚è¿™æ˜¯ä¸€ç§ç»å®è·µè¯æ˜çš„æœ‰æ•ˆç­–ç•¥ã€‚ æ§åˆ¶åè½¬ï¼ˆInversion of Controlï¼‰IoCåˆ™æ˜¯DIPçš„ä¸€ç§å…·ä½“æ€è·¯ï¼ŒDIPåªæ˜¯ä¸€ç§ç†å¿µã€æ€æƒ³ï¼Œè€ŒIoCæ˜¯ä¸€ç§å®ç°DIPçš„æ–¹æ³•ã€‚ IoCçš„æ ¸å¿ƒæ˜¯å°†ç±»ï¼ˆä¸Šå±‚ï¼‰æ‰€ä¾èµ–çš„å•å…ƒï¼ˆä¸‹å±‚ï¼‰çš„å®ä¾‹åŒ–è¿‡ç¨‹äº¤ç”±ç¬¬ä¸‰æ–¹æ¥å®ç°ã€‚ å½“è°ƒç”¨è€…éœ€è¦è¢«è°ƒç”¨è€…çš„ååŠ©æ—¶ï¼Œåœ¨ä¼ ç»Ÿçš„ç¨‹åºè®¾è®¡è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸ç”±è°ƒç”¨è€…æ¥åˆ›å»ºè¢«è°ƒç”¨è€…çš„å®ä¾‹ï¼Œä½†åœ¨è¿™é‡Œï¼Œåˆ›å»ºè¢«è°ƒç”¨è€…çš„å·¥ä½œä¸å†ç”±è°ƒç”¨è€…æ¥å®Œæˆï¼Œè€Œæ˜¯å°†è¢«è°ƒç”¨è€…çš„åˆ›å»ºç§»åˆ°è°ƒç”¨è€…çš„å¤–éƒ¨ï¼Œä»è€Œåè½¬è¢«è°ƒç”¨è€…çš„åˆ›å»ºï¼Œæ¶ˆé™¤äº†è°ƒç”¨è€…å¯¹è¢«è°ƒç”¨è€…åˆ›å»ºçš„æ§åˆ¶ï¼Œå› æ­¤ç§°ä¸ºæ§åˆ¶åè½¬ã€‚ ä¾èµ–æ³¨å…¥ï¼ˆDependence Injectionï¼‰DIæ˜¯IoCçš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼ŒæŒ‰ç…§DIçš„æ¨¡å¼ï¼Œå°±å¯ä»¥å®ç°IoCã€‚ DIçš„å®è´¨å°±æ˜¯æŠŠä¸€ä¸ªç±»ä¸å¯èƒ½æ›´æ¢çš„éƒ¨åˆ†å’Œå¯æ›´æ¢çš„éƒ¨åˆ†åˆ†ç¦»å¼€æ¥ï¼Œé€šè¿‡æ³¨å…¥çš„æ–¹å¼æ¥ä½¿ç”¨ï¼Œä»è€Œè¾¾åˆ°è§£è€¦çš„ç›®çš„ã€‚ è¿™é‡Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼ˆæ—…è¡Œçš„æ¥å£ï¼‰è¯´æ˜ä¸€ä¸‹ï¼š interface Travel &#123; public function travelAlgorithm(); &#125; /** *ä¹˜åé£æœº */ class AirPlanelStrategy implements Travel &#123; public function travelAlgorithm() &#123; echo&quot;travelbyAirPlain\\r\\n&quot;; &#125; &#125; /** *ä¹˜åç«è½¦ */ class TrainStrategy implements Travel &#123; public function travelAlgorithm() &#123; echo&quot;travelbyTrain\\r\\n&quot;; &#125; &#125; /** * *ç®—æ³•è§£å†³ç±»ï¼Œä»¥æä¾›å®¢æˆ·é€‰æ‹©ä½¿ç”¨ä½•ç§è§£å†³æ–¹æ¡ˆï¼š */ class PersonContext &#123; private $strategy = null; public function __construct(Travel $travel) &#123; $this-&gt;strategy=$travel; &#125; /** *æ—…è¡Œ */ public function travel() &#123; return$this-&gt;strategy-&gt;travelAlgorithm(); &#125; &#125; // ä¹˜åç«è½¦æ—…è¡Œ $person = new PersonContext(new TrainStrategy()); $person-&gt;travel(); // æ”¹ä¹˜é£æœº $person =PersonContext(new AirPlanelStrategy()); $person-&gt;travel(); å½“æˆ‘ä»¬æ›´æ¢äº¤é€šå·¥å…·æ—¶ï¼Œåªéœ€è¦å»å¢åŠ Travelæ¥å£çš„å®ç°ï¼Œä¿®æ”¹ä¸‹å®ç°çš„ä»£ç æ¥å£ï¼Œæ— éœ€å»æ”¹åŠ¨æ ¸å¿ƒä»£ç ã€‚ æ§åˆ¶åè½¬å®¹å™¨ï¼ˆIoC Containerï¼‰å½“é¡¹ç›®æ¯”è¾ƒå¤§æ—¶ï¼Œä¾èµ–å…³ç³»å¯èƒ½ä¼šååˆ†å¤æ‚ã€‚ è€ŒIoC Containeræä¾›äº†åŠ¨æ€åœ°åˆ›å»ºã€æ³¨å…¥ä¾èµ–å•å…ƒï¼Œæ˜ å°„ä¾èµ–å…³ç³»ç­‰åŠŸèƒ½ï¼Œæ–¹ä¾¿å¼€å‘è€…ä½¿ç”¨ï¼Œå¹¶å¤§å¤§ç¼©å‡äº†è®¸å¤šä»£ç é‡ã€‚ å› ä¸ºæˆ‘ä»¬çš„æ¡†æ¶æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ä¸å¦¨å®ç°ä¸‹Iocå®¹å™¨(ä¸»è¦å‚è€ƒäº†Yiiçš„diå®¹å™¨)ã€‚ ä»£ç å®ç°ç”¨åˆ°äº†PHPçš„åå°„Apiï¼Œæœ‰ç–‘é—®çš„ä¸å¦¨å…ˆçœ‹çœ‹æ‰‹å†Œï¼š PHPåå°„ è¿˜è®°å¾—PSRå—ï¼ŸPSR11æ˜¯å…³äºä¾èµ–æ³¨å…¥å®¹å™¨æ¥å£è§„èŒƒï¼š ç„¶åæˆ‘ä»¬åˆ©ç”¨composeræ‰§è¡Œ composer require psr/container æˆ‘ä»¬åœ¨library/Componentsæ–°å»ºContainerå®ç°ContainerInterfaceï¼Œåœ¨library/Exceptionsä¸‹æ–°å»ºContainerExceptionå®ç°Psr\\Container\\ContainerExceptionInterfaceï¼Œæ–°å»ºContainerNotFoundExceptionå®ç°Psr\\Container\\NotFoundExceptionInterfaceã€‚ æˆ‘ä»¬ä¸»è¦æ¥å®ç°ä¸€ä¸‹Containerä»£ç ï¼Œæˆ‘ä»¬é¢„å…ˆå®šä¹‰ä¸‰ä¸ªå±æ€§ï¼Œç”¨ä»¥ä¿å­˜å¯¹è±¡ã€ä¾èµ–åŠä¾èµ–çš„å®šä¹‰ä¿¡æ¯ã€‚ &lt;?php namespace Library\\Components; use Library\\Exceptions\\ContainerException; use Library\\Exceptions\\ContainerNotFoundException; use Psr\\Container\\ContainerInterface; use ReflectionClass; class Container implements ContainerInterface &#123; // ç”¨äºä¿å­˜ä¾èµ–çš„å®šä¹‰ï¼Œä»¥å¯¹è±¡åç§°ä¸ºé”® private $definitions = []; // ç”¨äºç¼“å­˜ReflectionClasså¯¹è±¡ï¼Œä»¥å¯¹è±¡åç§°ä¸ºé”® private $reflections = []; // ç”¨äºç¼“å­˜ä¾èµ–ä¿¡æ¯ï¼Œä»¥å¯¹è±¡åç§°ä¸ºé”® private $dependencies = []; public function has($class) &#123; return isset($this-&gt;definitions[$class]); &#125; public function get($class) &#123; ... &#125; &#125; æˆ‘ä»¬å…ˆæ·»åŠ ä¸€ä¸ªsetæ–¹æ³•ï¼Œç”¨ä»¥å®šä¹‰ï¼Œ public function set($class, $definition = []) &#123; $this-&gt;definitions[$class] = $this-&gt;normalizeDefinition($class, $definition); return $this; &#125; protected function normalizeDefinition($class, $definition) &#123; // $definition æ˜¯ç©ºçš„è½¬æ¢æˆ [&#x27;class&#x27; =&gt; $class] å½¢å¼ if (empty($definition)) &#123; return [&#x27;class&#x27; =&gt; $class]; // $definition æ˜¯å­—ç¬¦ä¸²ï¼Œè½¬æ¢æˆ [&#x27;class&#x27; =&gt; $definition] å½¢å¼ &#125; elseif (is_string($definition)) &#123; return [&#x27;class&#x27; =&gt; $definition]; // $definition æ˜¯å¯¹è±¡ï¼Œåˆ™ç›´æ¥å°†å…¶ä½œä¸ºä¾èµ–çš„å®šä¹‰ &#125; elseif (is_object($definition)) &#123; return $definition; // $definition æ˜¯æ•°ç»„åˆ™ç¡®ä¿è¯¥æ•°ç»„å®šä¹‰äº† class å…ƒç´  &#125; elseif (is_array($definition)) &#123; if (!isset($definition[&#x27;class&#x27;])) &#123; $definition[&#x27;class&#x27;] = $class; &#125; return $definition; // è¿™ä¹Ÿä¸æ˜¯ï¼Œé‚£ä¹Ÿä¸æ˜¯ï¼Œé‚£å°±æŠ›å‡ºå¼‚å¸¸ç®—äº† &#125; else &#123; throw new ContainerException( &quot;ä¸æ”¯æŒçš„ç±»å‹ï¼š \\&quot;$class\\&quot;: &quot; . gettype($definition)); &#125; &#125; çŸ¥è¯†ç‚¹ï¼š gettype â€” è·å–å˜é‡çš„ç±»å‹ ç„¶åæˆ‘ä»¬é‡ç‚¹å®ç°getæ–¹æ³•ï¼š public function get($class) &#123; // åŠ å…¥æœªä½œsetæ“ä½œï¼Œæˆ‘ä»¬ä¾æ—§å¯ä»¥æ„å»º if (!isset($this-&gt;definitions[$class])) &#123; return $this-&gt;build($class); &#125; $definition = $this-&gt;definitions[$class]; if (is_array($definition)) &#123; $concrete = $definition[&#x27;class&#x27;]; unset($definition[&#x27;class&#x27;]); if ($concrete === $class) &#123; $object = $this-&gt;build($class, $definition); &#125; else &#123; $object = $this-&gt;get($concrete); &#125; &#125; elseif (is_object($definition)) &#123; return $this-&gt;_singletons[$class] = $definition; &#125; else &#123; throw new ContainerNotFoundException(&#x27;ä¸èƒ½è¯†åˆ«çš„å¯¹è±¡ç±»å‹: &#x27; . gettype($definition)); &#125; return $object; &#125; buildæ–¹æ³•å¦‚ä¸‹ï¼Œä¸»è¦æ˜¯æ„å»ºå‡ºå¯¹è±¡å¹¶å®ç°æ³¨å…¥ï¼Œ public function build($class, $params = []) &#123; try &#123; // é€šè¿‡åå°„apiè·å–å¯¹è±¡ $reflector = $this-&gt;getReflectionClass($class); // è·å–ä¾èµ–å…³ç³»æ•°ç»„ $dependencies = $this-&gt;getDependencies($class, $reflector); // åˆ›å»ºä¸€ä¸ªç±»çš„æ–°å®ä¾‹,ç»™å‡ºçš„å‚æ•°å°†ä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°. $reflector = $reflector-&gt;newInstanceArgs($dependencies); return $reflector; &#125; catch (\\Throwable $t) &#123; throw new ContainerException(&#x27;åå°„å‡ºé”™&#x27;); &#125; &#125; è·å–å¯¹è±¡ï¼š public function getReflectionClass($class) &#123; if (isset($this-&gt;reflections[$class])) &#123; return $this-&gt;reflections[$class]; &#125; $reflector = new ReflectionClass($class); if (!$reflector-&gt;isInstantiable()) &#123; throw new ContainerException(&quot;ä¸èƒ½å®ä¾‹åŒ–&quot;.$class); &#125; return $this-&gt;reflections[$class] = $reflector; &#125; è·å–ä¾èµ–å…³ç³»ï¼š public function getDependencies($class, $reflector) &#123; // åˆ¤æ–­æ˜¯å¦æœ‰ç¼“å­˜ä¾èµ–å…³ç³» if (isset($this-&gt;dependencies[$class])) &#123; return $this-&gt;dependencies[$class]; &#125; $constructor = $reflector-&gt;getConstructor(); #å¦‚æœæ²¡æœ‰æ„é€ å‡½æ•°ï¼Œ ç›´æ¥å®ä¾‹åŒ–å¹¶è¿”å› if (is_null($constructor)) &#123; return $this-&gt;dependencies[$class] = []; &#125; $parameters = $constructor-&gt;getParameters(); $dependencies = []; foreach ($parameters as $className) &#123; $dependency = $className-&gt;getClass(); if (is_null($dependency)) &#123; $dependencies[] = $this-&gt;resolveNoneClass($className); &#125; else &#123; // å…ˆå–å‡ºå®¹å™¨ä¸­ç»‘å®šçš„ç±» å¦åˆ™è‡ªåŠ¨ç»‘å®š $dependencies[] = $this-&gt;get($dependency-&gt;getName()); &#125; &#125; $this-&gt;dependencies[$class] = $dependencies; return $dependencies; &#125; public function resolveNoneClass($class) &#123; // æœ‰é»˜è®¤å€¼åˆ™è¿”å›é»˜è®¤å€¼ if ($class-&gt;isDefaultValueAvailable()) &#123; return $class-&gt;getDefaultValue(); &#125; throw new ContainerException(&#x27;ä¸èƒ½è§£æå‚æ•°&#x27;); &#125; åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åŸºæœ¬å°±å®Œæˆäº†ä¸€ä¸ªå®Œæ•´çš„IOC Containerçš„ä»£ç ã€‚ æˆ‘ä»¬æ¥å†™ä¸€ä¸ªdemoï¼š &lt;?php namespace App\\Https\\Controllers; class C &#123; &#125; &lt;?php namespace App\\Https\\Controllers; class B &#123; public function __construct(C $c) &#123; $this-&gt;ccc = $c; &#125; &#125; &lt;?php namespace App\\Https\\Controllers; class A &#123; public function __construct(B $b, C $c) &#123; $this-&gt;bbb = $b; $this-&gt;ccc = $c; &#125; &#125; &lt;?php namespace App\\Https\\Controllers; use Library\\Components\\Container; use Library\\Https\\Controller; class IndexController extends Controller &#123; public function index() &#123; $contain = new Container(); $contain-&gt;set(&#x27;App\\\\Https\\\\Controllers\\\\A&#x27;); p($contain-&gt;get(&#x27;App\\\\Https\\\\Controllers\\\\A&#x27;)); &#125; &#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°çš„ç»“æœï¼š æ˜¯ä¸æ˜¯ä»£ç ç®€æ´å¾ˆå¤šäº†ï¼Œä¸æ„¿å› ä¸ºéœ€è¦åˆ›å»ºä¸€ä¸ªAå¯¹è±¡ï¼Œè€Œå…ˆå»å®ä¾‹åŒ–Bå’ŒCï¼Œè¿™äº›éƒ½æ˜¯ç”±æˆ‘ä»¬å®Œæˆçš„IOC Containerå»å®ç°äº†ã€‚ æ€»ç»“è¿™ä¸€èŠ‚æˆ‘ä»¬å®ç°äº†IOCå®¹å™¨ï¼Œç„¶è€Œä½ å¦‚æœä»”ç»†å»æƒ³ï¼Œæˆ‘ä»¬ä¼šå‘ç°æˆ‘ä»¬å¯ä»¥è®©å®¹å™¨æ›´åŠ å¼ºå¤§ï¼Œæ¯”å¦‚å•ä¾‹å¯¹è±¡çš„å®ç°ï¼Œæ¯”å¦‚ä¾èµ–çš„æ‰©å±•ï¼ˆå…¼å®¹å¯¹è±¡å‚æ•°æ³¨å…¥ï¼Œæ•°ç»„å‚æ•°æ³¨å…¥ç­‰ï¼‰ã€‚è¿™äº›ä½ å¯ä»¥è‡ªè¡Œå®ç°ï¼Œæˆ‘ä¹Ÿåœ¨æºä»£ç åšäº†ç®€å•çš„æ‰©å±•ï¼Œå¤§å®¶å¯ä»¥æ€è€ƒè¯•ç€å®ç°ä¸€ä¸‹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥çœ‹çœ‹å¼€æºæ¡†æ¶Laravelã€Yiiçš„æœåŠ¡å®¹å™¨çš„å®ç°ã€‚","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"æ¡†æ¶ç¯‡ï¼š7.ä½¿ç”¨redisåŠ é€Ÿsessionè¯»å†™","slug":"phpframe10","date":"2020-02-15T03:15:52.000Z","updated":"2022-03-19T15:25:39.962Z","comments":true,"path":"2020/02/15/phpframe10/","link":"","permalink":"https://github.13sai.com/2020/02/15/phpframe10/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ å¤§å®¶éƒ½çŸ¥é“ï¼Œé»˜è®¤çš„sessionæ˜¯å­˜å‚¨åœ¨æ–‡ä»¶é‡Œçš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜çš„ï¼Œç„¶è€Œä¸€æ—¦è®¿é—®å¾ˆå¤šï¼Œsessionçš„ä½¿ç”¨å°±ä¼šé¢‘ç¹è¯»å†™æ–‡ä»¶ï¼Œå¿…ç„¶ä¼šå½±å“åº”ç”¨çš„æ€§èƒ½ã€‚å¦å¤–ï¼Œå‡å¦‚æ˜¯å¤šæœºéƒ¨ç½²ï¼Œsessionçš„å…±äº«ä¹Ÿæ˜¯ä¸ªé—®é¢˜ã€‚ æ—¢ç„¶æˆ‘ä»¬çŸ¥é“æœ‰Redisè¿™ä¸ªåˆ©å™¨ï¼Œè€ŒPHPä¹Ÿæ˜¯æ”¯æŒsessionè‡ªå®šä¹‰çš„ï¼Œé‚£ä¹ˆä¸ºä½•ä¸è¦æ€§èƒ½æ›´å¥½åˆèƒ½å®ç°å…±äº«sessionçš„Rediså‘¢ï¼Ÿ Redisæ˜¯ä»€ä¹ˆï¼ŸRedis æ˜¯å®Œå…¨å¼€æºå…è´¹çš„ï¼Œéµå®ˆ BSD åè®®ï¼Œæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ key - value æ•°æ®åº“ Redisæ•°æ®ç»“æ„ string hash set sorted set pub/sub list å¦å¤–è¿˜æœ‰HyperLogLogï¼Œgeoâ€¦. Redisçš„ä¼˜åŠ¿ æ€§èƒ½æä½³ï¼Œå®˜ç½‘æ˜¾ç¤ºQPSèƒ½è¾¾åˆ°100k/s æ•°æ®ç»“æ„ä¸°å¯Œï¼Œä¸æ­¢äºå­—ç¬¦ä¸²ï¼Œhash ç¨³å®šæ€§ä¸é”™ï¼ŒæŒä¹…åŒ– æ”¯æŒé›†ç¾¤ ç¤¾åŒºä¸é”™ï¼Œä½¿ç”¨ç‡é«˜ï¼Œå¯¹äºPHPç¨‹åºå‘˜ï¼Œé™¤äº†LNMP/LAMPï¼Œç„¶ååº”è¯¥å°±æ˜¯Redisäº† Redisåº”ç”¨ ç¼“å­˜ åˆ†å¸ƒå¼é” è®¡æ•°å™¨ é˜Ÿåˆ— geo â€¦â€¦ Rediså‘½ä»¤ ç‚¹å‡»æŸ¥çœ‹Rediså‘½ä»¤ ä½¿ç”¨rediså­˜å‚¨sessionæˆ‘ä»‹ç»ä¸¤ç§æ–¹æ³•ç»™å¤§å®¶ï¼š session_startå¸¦å‚ session_set_save_handleræ‰˜ç®¡session ä¸‹é¢æˆ‘ä»¬é‡Œä¸€ä¸€è¯´æ˜ï¼š session_startsession_start ([ array $options = array() ] ) : bool â€”â€” å¯åŠ¨æ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯ï¼ˆç‚¹å‡»æŸ¥çœ‹æ›´å¤šå‚æ•°ï¼‰ æ¥çœ‹demoï¼š session_start([ &#x27;save_path&#x27; =&gt; &#x27;tcp://127.0.0.1:6379&#x27;, &#x27;save_handler&#x27; =&gt; &#x27;redis&#x27;, ]); $_SESSION[&#x27;user_id&#x27;] = 10001; $_SESSION[&#x27;userInfo&#x27;] = [&#x27;name&#x27; =&gt; &#x27;sai&#x27;]; p($_SESSION[&#x27;user_id&#x27;]); p($_SESSION[&#x27;userInfo&#x27;]); è¾“å‡ºå¦‚ä¸‹ï¼š 10001 Array ( [name] => sai ) æˆ‘ä»¬å¯ä»¥ä½¿ç”¨redis-cliè¿æ¥æŸ¥çœ‹ï¼š redis-cli -h 127.0.0.1 -p 6379// å¦‚è®¾ç½®å¯†ç å†è¾“å…¥ï¼ˆauth ä½ è®¾ç½®çš„å¯†ç ï¼‰å³å¯ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°redisé‡Œæœ‰äº†PHPREDIS_SESSION:nmo65igogqnq8ur2gia94jt15uï¼Œé‡Œé¢å­˜å‚¨äº†æˆ‘ä»¬çš„sessionä¿¡æ¯ã€‚ session_set_save_handlerå»ºè®®session.serialize_handler = php_serializeï¼Œé»˜è®¤phpå†™å…¥å’Œè¯»å–ç•¥å¾®ç¹çã€‚ è¿™é‡Œè¯´æ˜æˆ‘ä»¬æˆåŠŸäº†å°†sessionä¿¡æ¯é€šè¿‡Redisè¿›è¡Œäº†è¯»å†™ã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨session_set_save_handleræ¥å®ç°ï¼š &lt;?php namespace Library\\Sessions; use SessionHandler; class RedisSession extends SessionHandler &#123; private $redis; private $lifeTime = 7200; private $config; private $prefix = &#x27;PHPREDIS_SESSION:&#x27;; public function __construct($config) &#123; $this-&gt;config = $config; &#125; private function getRedisInstance() &#123; if (empty($this-&gt;redis)) &#123; $redis = new \\Redis(); $redis-&gt;connect($this-&gt;config[&#x27;host&#x27;], $this-&gt;config[&#x27;port&#x27;], $this-&gt;config[&#x27;timeout&#x27;]); if (!$this-&gt;config[&#x27;auth&#x27;]) &#123; $redis-&gt;auth($this-&gt;config[&#x27;auth&#x27;]); &#125; $this-&gt;redis = $redis; &#125; return $this-&gt;redis; &#125; public function read($id) &#123; return $this-&gt;getRedisInstance()-&gt;get($this-&gt;prefix.$id); &#125; public function write($id, $data) &#123; if ($this-&gt;getRedisInstance()-&gt;setex($this-&gt;prefix.$id, $this-&gt;lifeTime, $data)) &#123; return true; &#125; return false; &#125; public function destroy($id) &#123; if($this-&gt;getRedisInstance()-&gt;delete($id))&#123;//åˆ é™¤redisä¸­çš„æŒ‡å®šè®°å½• return true; &#125; return false; &#125; public function gc($maxlifetime) &#123; return true; &#125; public function __destruct() &#123; session_write_close(); &#125; &#125; $handler = new RedisSession([ &#x27;host&#x27; =&gt; &#x27;127.0.0.1&#x27;, &#x27;port&#x27; =&gt; 6379, &#x27;auth&#x27; =&gt; null, &#x27;timeout&#x27; =&gt; 5, ]); session_set_save_handler($handler, true); session_start(); $_SESSION[&#x27;user_id&#x27;] = 10001; $_SESSION[&#x27;userInfo&#x27;] = [&#x27;name&#x27; =&gt; &#x27;sai&#x27;]; p($_SESSION[&#x27;user_id&#x27;]); p($_SESSION[&#x27;userInfo&#x27;]); çŸ¥è¯†ç‚¹ï¼š è¿™é‡Œéœ€è¦æ³¨æ„ä¸‹readæ–¹æ³•ï¼Œé‡Œé¢éœ€è¦åŠ ä¸€ä¸‹serializeï¼Œä»¥ä¾¿äºæˆ‘ä»¬å­˜å‚¨å¤æ‚çš„sessionç»“æ„ã€‚å¦‚æœä¸åŠ ä¼šæŠ¥é”™ï¼ˆWarning: session_start(): Failed to read session data: user (path: )ï¼‰è¿™æ˜¯å› ä¸ºRedisæ— æ³•ç›´æ¥å­˜å‚¨arrayç»“æ„ï¼Œéœ€è¦è½¬åŒ–ä¸ºstringç±»å‹å­˜å‚¨ã€‚ æˆ‘ä»¬ä¹Ÿæ¥çœ‹çœ‹Rediså®¢æˆ·ç«¯å­˜å‚¨æƒ…å†µï¼š é€šç”¨æˆ‘ä»¬ä¹Ÿçœ‹åˆ°rediså­˜å‚¨äº†sessionï¼Œä¸å‰é¢ç•¥æœ‰ä¸åŒçš„åªæ˜¯å­˜å‚¨çš„keyä¸ä¸€æ ·ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªç§æœ‰å±æ€§ï¼š private $prefix = â€˜PHPREDIS_SESSION:â€™; ç„¶ååšä¸€ä¸‹è°ƒæ•´å³å¯ï¼š public function read($id) &#123; return serialize($this-&gt;getRedisInstance()-&gt;get($this-&gt;prefix.$id)); &#125; public function write($id,$data) &#123; if ($this-&gt;getRedisInstance()-&gt;setex($this-&gt;prefix.$id, $this-&gt;lifeTime, $data)) &#123; return true; &#125; return false; &#125; è¿è¡Œåä¼šå‘ç°æŠŠä¹‹å‰ç¬¬ä¸€ç§è®¾ç½®çš„sessionè¦†ç›–æ‰ã€‚ å½“ç„¶æˆ‘æ¯”è¾ƒå»ºè®®ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œä¾¿äºæˆ‘ä»¬å®šåˆ¶åŒ–ç¼–ç ã€‚ æ€»ç»“æ€»çš„æ¥è¯´ï¼Œä¸¤ç§æ–¹æ³•é…ç½®éƒ½æ¯”è¾ƒç®€å•ï¼Œä¸ªäººå»ºè®®ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼å®ç°ï¼Œè¿™æ ·ä¹Ÿæ¯”è¾ƒé€‚åˆé›†æˆåˆ°æ¡†æ¶ï¼ŒåæœŸæˆ‘ä»¬å¯ä»¥åœ¨è¿›è¡Œæ‰©å±•ã€‚","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"æ¡†æ¶ç¯‡ï¼š6.ç®€å•æµ‹è¯•","slug":"phpframe9","date":"2020-02-13T11:15:59.000Z","updated":"2022-03-19T15:32:32.914Z","comments":true,"path":"2020/02/13/phpframe09/","link":"","permalink":"https://github.13sai.com/2020/02/13/phpframe09/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ è™½ç„¶æ¡†æ¶åŸºæœ¬å®Œæˆï¼Œä½†æˆ‘ä»¬è¿˜æ²¡æœ‰æµ‹è¯•è¿‡ã€‚ æˆ‘ä»¬ä½¿ç”¨postmanä½œä¸ºæ¥å£æµ‹è¯•å·¥å…·ï¼ˆhttp://saif.com/testï¼‰ã€‚ // è‡ªå®šä¹‰è·¯ç”± return [ &#x27;debug&#x27; =&gt; false, &#x27;route&#x27; =&gt; [ &#x27;&#x27; =&gt; &#x27;demo/welcome&#x27;, &#x27;test&#x27; =&gt; &#x27;demo/test&#x27;, ], ]; class DemoController extends Controller &#123; public function welcome($params) &#123; return $this-&gt;response-&gt;json([&#x27;hello&#x27; =&gt; &#x27;welcome&#x27;]); &#125; public function test($params) &#123; return $this-&gt;response-&gt;json($params); &#125; &#125; æˆ‘ä»¬æµ‹è¯•ä¸‹ï¼š æˆ‘ä»¬å‘ç°èƒ½æ­£å¸¸è·å–è·å–GETå‚æ•°ï¼Œä½†æ²¡æœ‰è·å–åˆ°POSTå‚æ•°ã€‚ debugï¼š æˆ‘ä»¬å‘ç°Content-Typeè¾“å‡ºæ˜¯ï¼š multipart/form-data; boundary=--------------------------498010462598077868347660 æˆ‘ä»¬ä¼˜åŒ–ä¸€ä¸‹ä»£ç ï¼š public function getBodyParams() &#123; $contentType = strtolower($this-&gt;getHeader(&#x27;Content-Type&#x27;)); // p($contentType); if (strpos($contentType, &#x27;multipart/form-data&#x27;) === false) &#123; $this-&gt;_bodyParams = \\json_decode(file_get_contents(&quot;php://input&quot;), true); &#125; else &#123; $this-&gt;_bodyParams = $_POST; &#125; return $this-&gt;_bodyParams?? []; &#125; å¦å¤–æˆ‘ä»¬å‘ç°getHeaderæ–¹æ³•æœ‰ç‚¹é—®é¢˜ï¼š public function getHeader($name, $defaultValue = null) &#123; $name = ucfirst($name); if (function_exists(&#x27;apache_request_headers&#x27;)) &#123; $headers = apache_request_headers(); p($headers); return $headers[$name]?? $defaultValue; &#125; // $_SERVERä½¿ç”¨ä¸‹åˆ’çº¿ $name = strtoupper(str_replace(&#x27;-&#x27;, &#x27;_&#x27;, $name)); // éƒ¨åˆ†è‡ªå®šä¹‰å‚æ•°éœ€è¦åŠ ä¸ŠHTTP_ return $_SERVER[$name]?? ($_SERVER[&#x27;HTTP_&#x27;.$name] ?? $defaultValue); &#125; æµ‹è¯•æ­£å¸¸ã€‚ å¦å¤–ï¼Œåšä¸€ä¸‹è¯´æ˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨public function test($params)ï¼Œæ˜¯æºäºæˆ‘ä»¬Requestï¼Œå°†å‚æ•°æ³¨å…¥åˆ°æ–¹æ³•é‡Œã€‚ public function runAction($route) &#123; ... çœç•¥ä»£ç  return $controller-&gt;$action(array_merge($this-&gt;getQueryParams(), $this-&gt;getBodyParams())); &#125; æ€§èƒ½æµ‹è¯• æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯wrkå‹æµ‹ wrk &gt; git clone https://github.com/wg/wrk &gt; cd wrk &gt; make &gt; ln -s ./wrk /usr/bin/wrk wrkå‚æ•°ï¼š -c, --connectionsï¼ˆè¿æ¥æ•°ï¼‰: total number of HTTP connections to keep open with each thread handling N = connections/threads -d, --durationï¼ˆæµ‹è¯•æŒç»­æ—¶é—´ï¼‰: duration of the test, e.g. 2s, 2m, 2h -t, --threadsï¼ˆçº¿ç¨‹ï¼‰: total number of threads to use -s, --scriptï¼ˆè„šæœ¬ï¼‰: LuaJIT script, see SCRIPTING -H, --headerï¼ˆå¤´ä¿¡æ¯ï¼‰: HTTP header to add to request, e.g. &quot;User-Agent: wrk&quot; --latencyï¼ˆå“åº”ä¿¡æ¯ï¼‰: print detailed latency statistics --timeoutï¼ˆè¶…æ—¶æ—¶é—´ï¼‰: record a timeout if a response is not received within this amount of time. -v, --versionï¼ˆç‰ˆæœ¬ä¿¡æ¯ï¼‰ Print version details æˆ‘ä»¬ä»…ä»…åœ¨æ§åˆ¶è¿”å›ç©ºä¿¡æ¯ï¼Œç„¶åå¯¹æ¯”yii2ï¼ˆè¿”å›å­—ç¬¦ä¸²â€œyii2â€ï¼‰ï¼Œlaravel5.5ï¼ˆè¿”å›å­—ç¬¦ä¸²â€œlaravel5.5â€ï¼‰ã€‚ å› ä¸ºæˆ‘ä»¬çš„æ¡†æ¶æ²¡æœ‰ä¸­é—´ä»¶ã€ç»„ä»¶ä¹‹ç±»çš„ï¼Œæ‰€ä»¥æ€§èƒ½å¯¹æ¯”yii2ã€laravelï¼ŒQPSè¦é«˜å¾ˆå¤šã€‚","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"æ¡†æ¶ç¯‡ï¼š5.è‡ªå®šä¹‰é…ç½®ä¸è·¯ç”±","slug":"phpframe8","date":"2020-02-09T00:31:50.000Z","updated":"2022-03-19T15:32:29.247Z","comments":true,"path":"2020/02/09/phpframe08/","link":"","permalink":"https://github.13sai.com/2020/02/09/phpframe08/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ æˆ‘ä»¬å·²ç»å¼€å‘å®Œæˆï¼Œä½†æˆ‘ä»¬è¿˜éœ€è¦æ›´å¤šã€‚æ¯”å¦‚è‡ªå®šä¹‰é…ç½®å’Œè·¯ç”±ã€‚ appæ–‡ä»¶å¤¹ä¸‹æ–°å»ºConfig.php &lt;?php /** *è‡ªå®šä¹‰é…ç½® */ return [ &#x27;debug&#x27; =&gt; false, &#x27;route&#x27; =&gt; [ &#x27;&#x27; =&gt; &#x27;demo/welcome&#x27;, &#x27;test&#x27; =&gt; &#x27;demo/test&#x27;, ], ]; æ–°å»ºDemoControllerï¼ˆapp/Https/Controllersç›®å½•ä¸‹ï¼‰ &lt;?php /** * Demoæ§åˆ¶å™¨ */ namespace App\\Https\\Controllers; use Library\\Https\\Controller; class DemoController extends Controller &#123; public function welcome($params) &#123; return $this-&gt;response-&gt;json([&#x27;hello&#x27; =&gt; &#x27;welcome&#x27;]); &#125; public function test($params) &#123; return $this-&gt;response-&gt;json($params); &#125; &#125; ä¿®æ”¹å…¥å£æ–‡ä»¶index.php,åŠ å…¥åŠ è½½é…ç½®ä»£ç ï¼š ... çœç•¥ä»£ç  // åŠ è½½é…ç½® $config = require SF_LIBRARY_PATH.&#x27;Config.php&#x27;; $appConfig = file_exists($appConfigPath = SF_APP_PATH.&#x27;Config.php&#x27;) ? require $appConfigPath : []; $config = array_merge($config, $appConfig); $config[&#x27;debug&#x27;] = ($config[&#x27;debug&#x27;]?? SF_DEBUG); ...çœç•¥ä»£ç  è§£æè·¯ç”±éƒ¨åˆ†ä¹ŸåŠ å…¥è‡ªå®šä¹‰è·¯ç”±å¤„ç†ï¼š // Application ...çœç•¥ä»£ç  public function handleRequest(Request $request) &#123; $route = $request-&gt;resolve($this-&gt;_config[&#x27;route&#x27;]??[]); $response = $request-&gt;runAction($route); /** * æ‰§è¡Œç»“æœèµ‹å€¼ç»™$response-&gt;dataï¼Œå¹¶è¿”å›ç»™responseå¯¹è±¡ */ if ($response instanceof Response) &#123; return $response; &#125; throw new SaiException(&#x27;Content format error&#x27;); &#125; ...çœç•¥ä»£ç  // Request ...çœç•¥ä»£ç  public function runAction($route) &#123; if (array_key_exists($route, $this-&gt;_route)) &#123; $route = $this-&gt;_route[$route]; &#125; $match = explode(&#x27;/&#x27;, $route); $match = array_filter($match); ...çœç•¥ä»£ç  ä¿å­˜åæ‰“å¼€æµè§ˆå™¨çœ‹çœ‹æ•ˆæœï¼š è¿™é‡Œè™½ç„¶æœ‰è‡ªå®šä¹‰è·¯ç”±ï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦ç¦æ­¢é»˜è®¤è·¯ç”±ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¦¨å¢åŠ é…ç½®å‚æ•°defaultRouteï¼Œç”¨æ¥æ§åˆ¶æ˜¯å¦å¼€å¯é»˜è®¤è·¯ç”±ã€‚ æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹è·¯ç”±è§£æçš„ä»£ç ï¼š //Application ...çœç•¥ä»£ç  public function handleRequest(Request $request) &#123; $route = $request-&gt;resolve($this-&gt;_config[&#x27;route&#x27;]??[]); $response = $request-&gt;runAction($route, $this-&gt;_config[&#x27;defaultRoute&#x27;]??true); /** * æ‰§è¡Œç»“æœèµ‹å€¼ç»™$response-&gt;dataï¼Œå¹¶è¿”å›ç»™responseå¯¹è±¡ */ if ($response instanceof Response) &#123; return $response; &#125; throw new SaiException(&#x27;Content format error&#x27;); &#125; ...çœç•¥ä»£ç  ...çœç•¥ä»£ç  public function runAction($route, $defaultRoute) &#123; if (array_key_exists($route, $this-&gt;_route)) &#123; $route = $this-&gt;_route[$route]; &#125; elseif (!$defaultRoute) &#123; throw new NotFoundException(&quot;route not found:&quot;.$route); &#125; ...çœç•¥ä»£ç  æˆ‘ä»¬åœ¨appä¸‹é¢çš„Configï¼ŒåŠ å…¥ï¼š return [ &#x27;debug&#x27; =&gt; false, &#x27;route&#x27; =&gt; [ &#x27;&#x27; =&gt; &#x27;demo/welcome&#x27;, &#x27;test&#x27; =&gt; &#x27;demo/test&#x27;, ], &#x27;defaultRoute&#x27; =&gt; false, ]; æˆ‘ä»¬æ‰“å¼€æµè§ˆå™¨è¾“å…¥http://saif.com/login æŠ¥é”™å¦‚ä¸‹ï¼š Array ( [line] =&gt; 137 [msg] =&gt; route not found:login [code] =&gt; 404 [file] =&gt; library/Https/Request.php )","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"æ¡†æ¶ç¯‡ï¼š4.å…¥å£æ–‡ä»¶","slug":"phpframe7","date":"2020-02-08T05:31:08.000Z","updated":"2022-03-19T15:32:24.808Z","comments":true,"path":"2020/02/08/phpframe07/","link":"","permalink":"https://github.13sai.com/2020/02/08/phpframe07/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ å›é¡¾ä¸Šä¸€èŠ‚æˆ‘ä»¬å®Œæˆäº†ä»è·¯ç”±è§£æåˆ°æ•°æ®è¾“å‡ºçš„è¿‡ç¨‹ï¼Œå¹¶ä¸”ä¹‹å‰å·²ç»å®Œæˆäº†Requestçš„ç¼–å†™ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬å†™å®Œå…¥å£æ–‡ä»¶ï¼ŒçœŸæ­£çš„å°†æˆ‘ä»¬çš„webåº”ç”¨è·‘èµ·æ¥äº†ã€‚ å…¥å£æ–‡ä»¶é‡Œéœ€è¦åšäº›ä»€ä¹ˆå‘¢ï¼Ÿ è¿˜è®°å¾—é‚£ä¸ªæµç¨‹å›¾å—ï¼Ÿ æˆ‘ä»¬éœ€è¦åŠ è½½é…ç½®ï¼Œå®ä¾‹åŒ–Applicationå¹¶è¿è¡Œï¼Œå¹¶ä¸”å¼•å…¥åé¢å¯èƒ½é‡åˆ°çš„ä¸€äº›å¸¸é‡ã€‚ &lt;?php require __DIR__.DIRECTORY_SEPARATOR.&#x27;..&#x27;.DIRECTORY_SEPARATOR.&#x27;library&#x27;.DIRECTORY_SEPARATOR.&#x27;System.php&#x27;; // åŠ è½½é…ç½® $config = require SF_LIBRARY_PATH.&#x27;Config.php&#x27;; $config[&#x27;debug&#x27;] = ($config[&#x27;debug&#x27;]?? SF_DEBUG); if ($config[&#x27;debug&#x27;]) &#123; ini_set(&quot;display_errors&quot;, &quot;On&quot;); error_reporting(E_ALL); &#125; // composerè‡ªåŠ¨åŠ è½½ require __DIR__ . &#x27;/../vendor/autoload.php&#x27;; // å®ä¾‹åŒ–åº”ç”¨å¹¶è¿è¡Œ $app = new Library\\Application(new Library\\Https\\Request() ,$config); $app-&gt;run(); çŸ¥è¯†ç‚¹ï¼š __DIR__æ˜¯PHPçš„ä¸€ä¸ªé­”æœ¯å¸¸é‡ï¼Œå¯ä»¥ç†è§£æˆå½“å‰æ–‡ä»¶æ‰€åœ¨è·¯å¾„ã€‚DIRECTORY_SEPARATORæ˜¯ä¸€ä¸ªæ˜¾ç¤ºç³»ç»Ÿåˆ†éš”ç¬¦çš„å‘½ä»¤ï¼ŒDIRECTORY_SEPARATORæ˜¯PHPçš„å†…éƒ¨å¸¸é‡ï¼Œä¸éœ€è¦ä»»ä½•å®šä¹‰ä¸åŒ…å«å³å¯ç›´æ¥ä½¿ç”¨ã€‚ ini_set â€” ä¸ºä¸€ä¸ªé…ç½®é€‰é¡¹è®¾ç½®å€¼ error_reporting â€” è®¾ç½®åº”è¯¥æŠ¥å‘Šä½•ç§ PHP é”™è¯¯ &lt;?php // Turn off all error reporting error_reporting(0); // Report simple running errors error_reporting(E_ERROR | E_WARNING | E_PARSE); // Reporting E_NOTICE can be good too (to report uninitialized // variables or catch variable name misspellings ...) error_reporting(E_ERROR | E_WARNING | E_PARSE | E_NOTICE); // Report all errors except E_NOTICE error_reporting(E_ALL &amp; ~E_NOTICE); // Report all PHP errors (see changelog) error_reporting(E_ALL); // Report all PHP errors error_reporting(-1); // Same as error_reporting(E_ALL); ini_set(&#x27;error_reporting&#x27;, E_ALL); ?&gt; System.php&lt;?php // debugé»˜è®¤å¼€å¯ defined(&#x27;SF_DEBUG&#x27;) or define(&#x27;SF_DEBUG&#x27;, true); // æ¡†æ¶å¼€å§‹è¿è¡Œæ—¶é—´ defined(&#x27;SF_START_TIME&#x27;) or define(&#x27;SF_START_TIME&#x27;, microtime(true)); // æ ¸å¿ƒæ–‡ä»¶ç›®å½• defined(&#x27;SF_LIBRARY_PATH&#x27;) or define(&#x27;SF_LIBRARY_PATH&#x27;, __DIR__.DIRECTORY_SEPARATOR); // åº”ç”¨ç›®å½• defined(&#x27;SF_APP_PATH&#x27;) or define(&#x27;SF_APP_PATH&#x27;, __DIR__.DIRECTORY_SEPARATOR.&#x27;..&#x27;.DIRECTORY_SEPARATOR.&#x27;app&#x27;.DIRECTORY_SEPARATOR); // å…¥å£ç›®å½• defined(&#x27;SF_PUBLIC_PATH&#x27;) or define(&#x27;SF_PUBLIC_PATH&#x27;, __DIR__.DIRECTORY_SEPARATOR.&#x27;..&#x27;.DIRECTORY_SEPARATOR.&#x27;public&#x27;.DIRECTORY_SEPARATOR); Config.php&lt;?php /** * ç³»ç»Ÿé…ç½® */ return [ &#x27;debug&#x27; =&gt; true, // å»ºè®®å¼€å‘è¿‡ç¨‹ä¸­å¼€å¯ ]; åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„æ¡†æ¶å·²ç»å¯ä»¥è¿è¡Œèµ·æ¥äº†ã€‚ è¿è¡Œåº”ç”¨é…ç½®Nginx server &#123; listen 80; server_name saif.com; # æ¡†æ¶æ ¹ç›®å½• root /Users/sai/Work/www/saif/public; location / &#123; index index.html index.htm index.php; try_files $uri $uri/ /index.php?$query_string; &#125; error_page 500 502 503 504 /50x.html; location = /50x.html &#123; &#125; location ~ \\.php$ &#123; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; &#125; &#125; æµè§ˆå™¨è¾“å…¥http://saif.comã€‚ ä½ ä¼šçœ‹åˆ°è¿”å›çš„jsonæ•°ç»„ï¼š å¤‡æ³¨ï¼šå‰é¢3è¡Œè¯·å¿½ç•¥ï¼Œæ˜¯æˆ‘æµè§ˆå™¨çš„æ’ä»¶è‡ªåŠ¨åŠ å…¥çš„ã€‚ åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†åŸºç¡€APIæ¡†æ¶çš„å¼€å‘ã€‚","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"æ¡†æ¶ç¯‡ï¼š3.è·¯ç”±è§£æ","slug":"phpframe6","date":"2020-02-08T02:35:57.000Z","updated":"2022-03-19T15:32:21.892Z","comments":true,"path":"2020/02/08/phpframe06/","link":"","permalink":"https://github.13sai.com/2020/02/08/phpframe06/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ å›é¡¾ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†ç¼–å†™äº†å¦‚ä½•å¤„ç†è¯·æ±‚ä¸è¾“å‡ºæ•°æ®ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬å¼€å§‹ç¼–å†™è·¯ç”±æ¨¡å—ã€‚ æ­£æ–‡è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰å»ºç«‹çš„Applicationåœ¨å“ªé‡Œå—ï¼Ÿ æˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸‹Applicationåº”è¯¥å…·å¤‡å“ªäº›åŠŸèƒ½ï¼Ÿ é¦–å…ˆå¾ˆé‡è¦çš„ï¼Œæˆ‘ä»¬è¦è®©åº”ç”¨è¿è¡Œèµ·æ¥ï¼Œå§‘ä¸”å°±å…ˆå®šä¹‰runæ–¹æ³•ã€‚å¦å¤–æˆ‘ä»¬éœ€è¦å¤„ç†è¯·æ±‚å¹¶ä¸”è¾“å‡ºæ•°æ®ï¼Œæˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªhandleRequestæ–¹æ³•ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬çš„åº”ç”¨æ˜¯æœ‰ä¸€äº›é…ç½®ä¿¡æ¯ï¼ˆconfigï¼‰çš„ã€‚ å› ä¸ºï¼Œæˆ‘ä»¬ä¸éš¾ç¼–å†™å‡ºä»¥ä¸‹ä»£ç ï¼š &lt;?php namespace Library; use Library\\Exceptions\\SaiException; use Library\\Https\\Request; use Library\\Https\\Response; class Application &#123; private $config; private $request; public function __construct(Request $request, $config = []) &#123; $this-&gt;config = $config; $this-&gt;request = $request; &#125; /** * è¿è¡Œåº”ç”¨å¹¶è¾“å‡ºæ•°æ® * @return bool */ public function run() &#123; try &#123; $response = $this-&gt;handleRequest($this-&gt;request); $response-&gt;send(); return $response-&gt;exitStatus; &#125; catch (SaiException $e) &#123; $e-&gt;response($e-&gt;getCode(), [ &#x27;line&#x27; =&gt; $e-&gt;getLine(), &#x27;msg&#x27; =&gt; $e-&gt;getMessage(), &#x27;code&#x27; =&gt; $e-&gt;getCode(), &#x27;file&#x27; =&gt; $e-&gt;getFile(), ]); return false; &#125; &#125; /** * å¤„ç†è¯·æ±‚ * @param Request $request * @return mixed * @throws SaiException */ public function handleRequest(Request $request) &#123; // todo // è¿”å›Responseå¯¹è±¡ return $response; &#125; &#125; è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°handleRequestæ–¹æ³•è¿˜æœ‰ä¸€éƒ¨åˆ†ä»£ç ä¸ºå®Œæˆï¼Œå›æƒ³ä»¥ä¸‹æµç¨‹å›¾ï¼Œè¿™é‡Œå°±æ˜¯æˆ‘ä»¬æ¯”è¾ƒæ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œè·¯ç”±å¤„ç†æ¨¡å—ã€‚ è·¯ç”±è§£æè·¯ç”±è§£ææˆ‘ä»¬ä½¿ç”¨éå¸¸ç®€å•è€Œå¸¸è§çš„å¤„ç†æ–¹å¼ï¼Œä¸å¦¨çœ‹å‡ ä¸ªurlä¾‹å­æ¥ç†è§£ä¸€ä¸‹ï¼š route controller method http://blog.13sai.com/ IndexController index http://blog.13sai.com/admin AdminController index http://blog.13sai.com/admin/test AdminController test http://blog.13sai.com/admin/index/test Admin\\IndexController test æœ‰æ²¡æœ‰çœ‹å‡ºè§„å¾‹ï¼Œæˆ‘ä»¬ä¼šä»¥æ–œæ /åˆ†å‰²è·¯ç”±ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼Œæœ€åä¸¤éƒ¨åˆ†åˆ†åˆ«æ˜¯å¯¹åº”çš„æ§åˆ¶å™¨åç§°å’Œæ–¹æ³•åç§°ï¼Œå°‘äºä¸¤éƒ¨åˆ†é»˜è®¤ç”¨indexï¼Œå¤šä½™ä¸¤éƒ¨åˆ†çš„ä½œä¸ºæ§åˆ¶å™¨çš„å‘½åç©ºé—´ã€‚ç„¶åæˆ‘ä»¬è¦æ ¹æ®è·¯ç”±æ‰¾åˆ°æ§åˆ¶å™¨æ„å»ºå‡ºæ§åˆ¶å™¨ã€‚ /** * æ§åˆ¶å™¨å¤„ç† * @param $route * @return mixed * @throws NotFoundException */ public function runAction($route) &#123; $match = explode(&#x27;/&#x27;, $route); $match = array_filter($match); // å¤„ç†$route=/ if (empty($match)) &#123; $match = [&#x27;index&#x27;]; $controller = $this-&gt;createController($match); $action = &#x27;index&#x27;; // å¤„ç†$route=index &#125; elseif (count($match) &lt; 2) &#123; $controller = $this-&gt;createController($match); $action = &#x27;index&#x27;; &#125; else &#123; $action = array_pop($match); $controller = $this-&gt;createController($match); if (!method_exists($controller, $action)) &#123; throw new NotFoundException(&quot;method not found:&quot;.$action); &#125; &#125; // å°†getå’Œpostæ³¨å…¥æ§åˆ¶å™¨æ–¹æ³•ä¸­ return $controller-&gt;$action(array_merge($this-&gt;getQueryParams(), $this-&gt;getBodyParams())); &#125; // appåº”ç”¨æ§åˆ¶å™¨å‘½åç©ºé—´ private $controllerNameSpace = &#x27;App\\\\Https\\\\Controllers\\\\&#x27;; // ä¹‹å‰å®šä¹‰çš„åŸºç±»æ§åˆ¶å™¨ private $baseController = &#x27;Library\\\\Https\\\\Controller&#x27;; public function createController($match) &#123; $controllerName = $this-&gt;controllerNameSpace; foreach ($match as $namespace) &#123; $controllerName .= ucfirst($namespace).&#x27;\\\\&#x27;; &#125; $controllerName = rtrim($controllerName,&#x27;\\\\&#x27;).&#x27;Controller&#x27;; if (!class_exists($controllerName)) &#123; if ($controllerName == $this-&gt;controllerNameSpace.&#x27;IndexController&#x27;) &#123; return new $this-&gt;baseController; &#125; throw new NotFoundException(&quot;controller not found:&quot;.$controllerName); &#125; return new $controllerName; &#125; ä¸Šé¢æ˜¯å¯»æ‰¾æ§åˆ¶å™¨å’Œæ–¹æ³•çš„è¿‡ç¨‹ï¼Œä½†æˆ‘ä»¬éœ€è¦æå‰è·å¾—é¡µé¢åœ°å€ä»¥è§£æè·¯ç”±ã€‚ çŸ¥è¯†ç‚¹ï¼š åæ–œæ ï¼šåæ–œçº¿æœ‰å¤šç§ç”¨æ³•ã€‚é¦–å…ˆï¼Œå¦‚æœç´§æ¥ç€æ˜¯ä¸€ä¸ªéå­—æ¯æ•°å­—å­—ç¬¦ï¼Œè¡¨æ˜å–æ¶ˆ è¯¥å­—ç¬¦æ‰€ä»£è¡¨çš„ç‰¹æ®Šæ¶µä¹‰ã€‚è¿™ç§å°†åæ–œçº¿ä½œä¸ºè½¬ä¹‰å­—ç¬¦çš„ç”¨æ³•åœ¨å­—ç¬¦ç±» å†…éƒ¨å’Œå¤–éƒ¨éƒ½å¯ç”¨ã€‚ array_filter ( array $array [, callable $callback [, int $flag = 0 ]] ) : arrayâ€”â€”ä¾æ¬¡å°† array æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’åˆ° callback å‡½æ•°ã€‚å¦‚æœ callback å‡½æ•°è¿”å› trueï¼Œåˆ™ array æ•°ç»„çš„å½“å‰å€¼ä¼šè¢«åŒ…å«åœ¨è¿”å›çš„ç»“æœæ•°ç»„ä¸­ã€‚æ•°ç»„çš„é”®åä¿ç•™ä¸å˜ã€‚ä»£ç ä¸­æ˜¯è¿‡æ»¤valueä¸ºç©ºçš„å•å…ƒã€‚ è·å–é¡µé¢åœ°å€/** * è¿”å›ä¸å«å‚æ•°çš„REQUEST_URIåœ°å€ */ public function resolve() &#123; return $this-&gt;getPathUrl(); &#125; private $pathUrl; /** * è·å–è¯·æ±‚åœ°å€ * @return bool|mixed|string */ public function getPathUrl() &#123; if (is_null($this-&gt;pathUrl)) &#123; $url = trim($_SERVER[&#x27;REQUEST_URI&#x27;], &#x27;/&#x27;); $index = strpos($url, &#x27;?&#x27;); $this-&gt;pathUrl = ($index &gt; -1) ? substr($url, 0, $index) : $url; &#125; return $this-&gt;pathUrl; &#125; æˆ‘ä»¬å°½é‡è®©Applicationå˜å¾—ç®€æ´ï¼Œè€Œè·¯ç”±è§£æåˆå’ŒRequestå…³è”åº¦è¾ƒé«˜ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¦¨æŠŠè¿™äº›æ–¹æ³•æŠ›å‡ºåˆ°Requestå¯¹è±¡ã€‚ çŸ¥è¯†ç‚¹ï¼š strpos ( string $haystack , mixed $needle [, int $offset = 0 ] ) : intâ€”â€”è¿”å› needle åœ¨ haystack ä¸­é¦–æ¬¡å‡ºç°çš„æ•°å­—ä½ç½®ï¼Œå¦‚æœæ²¡æ‰¾åˆ° needleï¼Œå°†è¿”å› FALSEã€‚ ä¸Šé¢å·²ç»è§£æå¥½è·¯ç”±å¹¶ä¸”æ‰¾åˆ°äº†æ§åˆ¶å™¨å’Œæ–¹æ³•ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å®Œå–„Applicationçš„ä»£ç äº†ã€‚ å¤„ç†è¯·æ±‚public function handleRequest(Request $request) &#123; $route = $request-&gt;resolve(); $response = $request-&gt;runAction($route); /** * æ‰§è¡Œç»“æœèµ‹å€¼ç»™$response-&gt;dataï¼Œå¹¶è¿”å›ç»™responseå¯¹è±¡ */ if ($response instanceof Response) &#123; return $response; &#125; throw new SaiException(&#x27;è¾“å‡ºçš„å†…å®¹æ ¼å¼é”™è¯¯&#x27;); &#125; å†æ¬¡éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä»…åšäº†jsonæ ¼å¼è¾“å‡ºï¼Œå¦‚æœæœ‰å…´è¶£ï¼Œä½ å¯ä»¥è‡ªå·±åŠ¨æ‰‹æ‹“å±•ä¸€ä¸‹ã€‚ å¦ï¼šNotFoundExceptionç»§æ‰¿è‡ªSaiExceptionï¼Œä»£ç ï¼š &lt;?php namespace Library\\Exceptions; class NotFoundException extends SaiException &#123; protected $code = 404; &#125;","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"æ¡†æ¶ç¯‡ï¼š2.è¯·æ±‚ä¸è¾“å‡º","slug":"phpframe5","date":"2020-02-04T06:05:41.000Z","updated":"2022-03-19T15:32:19.003Z","comments":true,"path":"2020/02/04/phpframe05/","link":"","permalink":"https://github.13sai.com/2020/02/04/phpframe05/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ æˆ‘ä»¬åœ¨library\\Httpsç›®å½•ä¸‹æ–°å»ºRequestã€Responseï¼Œå¼€å§‹ç¼–å†™è¯·æ±‚å’Œè¾“å‡ºçš„ä»£ç ã€‚ Requestæˆ‘ä»¬å®ç°å‡ ä¸ªå¸¸ç”¨çš„æ–¹æ³•ï¼Œgetã€postã€methodç­‰ï¼Œè¿™é‡Œä¸»è¦ç”¨$_SERVERå®ç°ï¼Œä¸ºäº†å¤ç”¨æˆ‘ä»¬å®šä¹‰äº†ä¸‰ä¸ªç§æœ‰å±æ€§å­˜å‚¨getå‚æ•°ã€postå‚æ•°å’Œmethodã€‚ &lt;?php /** * å¤„ç†è¯·æ±‚ */ namespace Library\\Https; use Library\\Components\\Base; class Request extends Base &#123; /** * è·å–è¯·æ±‚æ–¹æ³• * @return string */ public function getMethod() &#123; if (isset($_SERVER[&#x27;REQUEST_METHOD&#x27;])) &#123; return strtoupper($_SERVER[&#x27;REQUEST_METHOD&#x27;]); &#125; return &#x27;GET&#x27;; &#125; /** * è¯·æ±‚å¤´ * @param $name * @param null $defaultValue * @return mixed|null */ public function getHeader($name, $defaultValue = null) &#123; $name = ucfirst($name); if (function_exists(&#x27;apache_request_headers&#x27;)) &#123; $headers = apache_request_headers(); return $headers[$name]?? $defaultValue; &#125; $name = strtoupper($name); return $_SERVER[$name]?? $defaultValue; &#125; /** * è·å–getå‚æ•° * @param null $name * @param null $defaultValue * @return |null */ public function get($name = null, $defaultValue = null) &#123; if ($name === null) &#123; return $this-&gt;getQueryParams(); &#125; return $this-&gt;getQueryParam($name, $defaultValue); &#125; public function getQueryParam($name, $defaultValue = null) &#123; $params = $this-&gt;getQueryParams(); return isset($params[$name]) ? $params[$name] : $defaultValue; &#125; public function getQueryParams() &#123; if (empty($this-&gt;queryParams)) &#123; return $this-&gt;queryParams = $_GET; &#125; return $this-&gt;queryParams; &#125; /** * è·å–postå‚æ•° * @param null $name * @param null $defaultValue * @return array|mixed|null */ public function post($name = null, $defaultValue = null) &#123; if ($name === null) &#123; return $this-&gt;getBodyParams(); &#125; return $this-&gt;getBodyParam($name, $defaultValue); &#125; public function getBodyParam($name, $defaultValue = null) &#123; $params = $this-&gt;getBodyParams(); if (is_object($params)) &#123; try &#123; return $params-&gt;&#123;$name&#125;; &#125; catch (\\Exception $e) &#123; return $defaultValue; &#125; &#125; return isset($params[$name]) ? $params[$name] : $defaultValue; &#125; public function getBodyParams() &#123; $contentType = strtolower($this-&gt;getHeader(&#x27;Content-Type&#x27;)); if ($contentType == &#x27;multipart/form-data&#x27;) &#123; $this-&gt;bodyParams = $_POST; &#125; else &#123; $this-&gt;bodyParams = \\json_decode(file_get_contents(&quot;php://input&quot;), true); &#125; return $this-&gt;bodyParams?? []; &#125; /** * getå‚æ•°æ•°ç»„ */ private $queryParams = []; /** * postå‚æ•°æ•°ç»„ */ private $bodyParams = []; private $method; &#125; çŸ¥è¯†ç‚¹ï¼š è·å–è¯·æ±‚å¤´éƒ¨ä¿¡æ¯çš„æ–¹å¼nginxå’Œapacheä¸åŒ apacheå¯ä»¥ä½¿ç”¨apache_request_headers nginxä½¿ç”¨$_SERVERï¼Œå¹¶ä¸”éœ€è¦æ³¨æ„çš„æ˜¯çš„æ˜¯è‡ªå®šä¹‰ä¿¡æ¯ç­‰å‚æ•°ä¼šåœ¨å‰é¢è‡ªåŠ¨åŠ ä¸Šhttp_ï¼Œå¹¶ä¸”ä¼šè½¬æ¢ä¸ºå¤§å†™ postå‚æ•°è·å–çš„æ–¹å¼ å½“Content-Typeæ˜¯application/x-www-data-urlencodedæˆ–multipart/form-dataæ—¶ï¼Œæ•°æ®ä¼šæ”¾è¿›$_POSTä¸­ï¼› é™¤äº†Coentent-Typeä¸ºmultipart/form-dataçš„æƒ…å†µï¼Œæ•°æ®éƒ½å¯ä»¥é€šè¿‡file_get_contents(â€œphp://inputâ€)å–åˆ°ï¼› ä¸å»ºè®®ä½¿ç”¨$GLOBALS[â€˜HTTP_RAW_POST_DATAâ€™] ResponseResponseé»˜è®¤ä»¥ä½¿ç”¨å¹¿æ³›çš„jsonè¾“å‡ºï¼Œæš‚æ—¶ä¹Ÿåªè€ƒè™‘jsonæ ¼å¼è¾“å‡ºçš„æƒ…å†µã€‚ &lt;?php /** * æ•°æ®è¾“å‡º */ namespace Library\\Https; use Library\\Components\\Base; class Response extends Base &#123; public $code = 0; public $result = []; public $msg = &quot;success&quot;; public function send() &#123; header(&#x27;Content-Type:application/json; charset=utf-8&#x27;); echo \\json_encode([ &#x27;data&#x27; =&gt; $this-&gt;result, &#x27;msg&#x27; =&gt; $this-&gt;msg, &#x27;code&#x27; =&gt; $this-&gt;code, &#x27;timestamp&#x27; =&gt; time() ]); &#125; public function json($data = []) &#123; $this-&gt;result = array_merge($this-&gt;result, $data); return $this; &#125; &#125; çŸ¥è¯†ç‚¹ï¼š header() ç”¨äºå‘é€åŸç”Ÿçš„ HTTP å¤´ã€‚ json_encode ( mixed $value [, int $options = 0 [, int $depth = 512 ]] ) : string â€” å¯¹å˜é‡è¿›è¡Œ JSON ç¼–ç ï¼Œoptionså¯ä»¥é¢„å®šä¹‰å¸¸é‡ï¼Œå¦‚ JSON_UNESCAPED_UNICODEï¼ŒJSON_UNESCAPED_SLASHESã€‚ Controllerç»“åˆè¾“å‡ºå¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºä¸€ä¸ªåŸºç±»æ§åˆ¶å™¨ï¼Œä¹Ÿæ”¾åœ¨ç›¸åŒçš„Httpsç›®å½•ï¼Œæˆ‘ä»¬æ§åˆ¶åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ä¾‹åŒ–ä¸€ä¸ªResponseï¼Œå¹¶å®ç°ä¸€ä¸ªé€šç”¨çš„jsonï¼š &lt;?php /** * åŸºç±»æ§åˆ¶å™¨ * é¢„å®šä¹‰jsonæ–¹æ³•ï¼Œä¾¿äºå…¶ä»–æ§åˆ¶å™¨ä½¿ç”¨ * è¿”å›æ ¼å¼ &#123; &quot;data&quot;: [], &quot;msg&quot;: &quot;success&quot;, &quot;code&quot;: 0, &quot;timestamp&quot;: 1572231957 &#125; */ namespace Library\\Https; class Controller &#123; protected $response; protected $code = 200; public function __construct() &#123; $this-&gt;response = new Response(); &#125; public function json($data = []) &#123; return $this-&gt;response-&gt;json($data); &#125; public function index($params) &#123; return $this-&gt;response-&gt;json([&#x27;hello&#x27; =&gt; &#x27;saif&#x27;]); &#125; &#125; appåº”ç”¨é‡Œçš„æ§åˆ¶å™¨éƒ½å¿…é¡»ç»§æ‰¿è¿™ä¸ªåŸºç±»æ§åˆ¶å™¨ã€‚","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"æ¡†æ¶ç¯‡ï¼š1.æ¡†æ¶ç›®å½•ä¸è¾…åŠ©","slug":"phpframe4","date":"2020-02-02T02:55:21.000Z","updated":"2022-03-19T15:32:15.733Z","comments":true,"path":"2020/02/02/phpframe04/","link":"","permalink":"https://github.13sai.com/2020/02/02/phpframe04/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ é‚£ä¹ˆå°±åˆ©ç”¨composeræ¥å¼€å§‹æˆ‘ä»¬çš„é¡¹ç›®å§ã€‚ æ–°å»ºç›®å½•å¹¶è¿›å…¥ç›®å½•ï¼Œè¾“å…¥å‘½ä»¤ï¼š composer init å‘½ä»¤è¡Œä¼šè·Ÿä½ ç¡®è®¤ä»¥ä¸‹ä¿¡æ¯ï¼ˆä»¥ä¸‹ä¿¡æ¯å¯ä»¥è‡ªè¡ŒDIYï¼‰ # 1. è¾“å…¥é¡¹ç›®å‘½åç©ºé—´ # æ³¨æ„&lt;vendor&gt;/&lt;name&gt; å¿…é¡»è¦ç¬¦åˆ [a-z0-9_.-]+/[a-z0-9_.-]+ Package name (&lt;vendor&gt;/&lt;name&gt;) yourname/projectname # 2. é¡¹ç›®æè¿° Description []:è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•composer init é¡¹ç›® # 3. è¾“å…¥ä½œè€…ä¿¡æ¯ Author [13sai &lt;sai0556@qq.com&gt;, n to skip]: # 4. è¾“å…¥æœ€ä½ç¨³å®šç‰ˆæœ¬ï¼Œstable, RC, beta, alpha, dev Minimum Stability []:dev # 5. è¾“å…¥é¡¹ç›®ç±»å‹ Package Type (e.g. library, project, metapackage, composer-plugin) []:project # 6. è¾“å…¥æˆæƒç±»å‹ License []:MIT Define your dependencies. # 7. è¾“å…¥ä¾èµ–ä¿¡æ¯ Would you like to define your dependencies (require) interactively [yes]? # 7.1. å¦‚æœéœ€è¦ä¾èµ–ï¼Œåˆ™è¾“å…¥è¦å®‰è£…çš„ä¾èµ– Search for a package:php # 7.2. è¾“å…¥ç‰ˆæœ¬å· Enter the version constraint to require (or leave blank to use the latest version): &gt;=5.4.0 # å¦‚éœ€å¤šä¸ªä¾èµ–ï¼Œåˆ™é‡å¤ä»¥ä¸Šä¸¤ä¸ªæ­¥éª¤(7.1/7.2) Search for a package: # 8. æ˜¯å¦éœ€è¦require-devï¼Œ Would you like to define your dev dependencies (require-dev) interactively [yes]? &#123; &quot;name&quot;: &quot;sai/saif&quot;, &quot;description&quot;: &quot;php framework&quot;, &quot;type&quot;: &quot;project&quot;, &quot;require&quot;: &#123; &#125;, &quot;license&quot;: &quot;MIT&quot;, &quot;authors&quot;: [ &#123; &quot;name&quot;: &quot;13sai&quot;, &quot;email&quot;: &quot;sai0556@qq.com&quot; &#125; ], &quot;minimum-stability&quot;: &quot;dev&quot; &#125; # 9. æ˜¯å¦ç”Ÿæˆcomposer.json Do you confirm generation [yes]? # ç°åœ¨å®‰è£…ä¾èµ–é¡¹å— Would you like to install dependencies now [yes]? æˆ‘ä»¬çš„ç›®å½•ä¸‹ä¼šç”Ÿæˆcomposer.jsonã€‚ ç„¶åæˆ‘ä»¬æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼š ä½ è§‰å¾—ä¸€ä¸ªåŸºç¡€çš„APIæ¡†æ¶éœ€è¦ä»€ä¹ˆæ¨¡å—å‘¢ï¼Ÿ ä¸‹é¢æ˜¯æˆ‘çš„æ€è€ƒç»“æœï¼š è·¯ç”± è¯·æ±‚ æ•°æ®å“åº” å¼‚å¸¸å¤„ç† æ—¥å¿—ç³»ç»Ÿâ€¦ å½“ç„¶ï¼Œä½ å¯èƒ½è§‰å¾—è¿˜åº”è¯¥æœ‰ï¼š é…ç½® session ç¼“å­˜ éªŒè¯ æ¨¡å‹ æœåŠ¡å±‚ æ–‡ä»¶ä¸Šä¼ â€¦ ä¹Ÿè®¸ä½ æƒ³åˆ°æ›´å¤šï¼š ä»»åŠ¡è°ƒåº¦ é˜Ÿåˆ— ç”¨æˆ·éªŒè¯ é” â€¦ é‚£ä¹ˆè¿™ä¹ˆäº›æˆ‘ä»¬å¦‚ä½•å–èˆå‘¢ï¼Ÿæ‰‹å¿ƒæ‰‹èƒŒéƒ½æ˜¯è‚‰å•Šã€‚ è¿™é‡Œéœ€è¦åšä¸€ä¸‹è¯´æ˜ï¼Œæˆ‘ä»¬æ‰€åšçš„æ¡†æ¶æ— éœ€è€ƒè™‘å¤ªå¤šçš„åŠŸèƒ½ï¼Œæ˜¯åšä¸€ä¸ªç®€å•å¯ç”¨çš„APIæ¥å£æ¡†æ¶ï¼Œæˆ‘ä»¬æ¥å—get/postè¯·æ±‚ï¼Œè¿”å›jsonæ•°æ®ï¼Œå¹¶ä¸”è·¯ç”±å¥½ç”¨ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„åˆè¡·ï¼Œå…¶ä»–çš„æš‚ä¸”å°±â€œæ–­èˆç¦»â€å§ã€‚ æˆ‘ä»¬å…ˆç”»ä¸€ä¸ªæç®€çš„æµç¨‹å›¾ã€‚ æˆ‘ä»¬ä¸€åˆ‡ä»ç®€ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š è·¯ç”± æ§åˆ¶å™¨ è¯·æ±‚ æ•°æ®å“åº” é…ç½® å¼‚å¸¸å¤„ç† â€¦ åŸºäºè¿™äº›ï¼Œæˆ‘ä»¬æ–°å»ºç›®å½•ï¼Œappå’Œlibraryï¼Œpublic app webåº”ç”¨ library æ ¸å¿ƒä»£ç  public å…¥å£ç›®å½• å‡ºäºç®€å•å®‰å…¨è€ƒè™‘ï¼Œæˆ‘ä»¬çš„å…¥å£å•ç‹¬æ”¾åœ¨publicç›®å½•ï¼Œå¹¶åœ¨ç›®å½•ä¸‹æ–°å»ºindex.phpä½œä¸ºæˆ‘ä»¬çš„å…¥å£æ–‡ä»¶ã€‚ libraryä¸‹é¢æ–°å»ºå‡ ä¸ªç›®å½•å’Œæ–‡ä»¶ Components å¸¸ç”¨ç»„ä»¶ Exceptions å¼‚å¸¸æ¨¡å— Https httpåº”ç”¨æ¨¡å— Sessions sessionæ¨¡å— Application.php åº”ç”¨æ–‡ä»¶ Config.php é…ç½®æ–‡ä»¶ Functions.php å¸¸ç”¨å‡½æ•° System.php æ¡†æ¶è‡ªå®šä¹‰å¸¸é‡ å¯¹åº”çš„æˆ‘ä»¬åœ¨composer.jsonä¸­åŠ å…¥ä¸€äº›autoloadé…ç½®ï¼Œç”¨ä»¥è‡ªåŠ¨åŠ è½½ï¼Œçœå»æˆ‘ä»¬å®ç°è‡ªåŠ¨åŠ è½½ã€‚ &quot;autoload&quot;: &#123; &quot;psr-4&quot;: &#123; &quot;Library\\\\&quot;: &quot;library/&quot;, &quot;App\\\\&quot;: &quot;app/&quot; &#125;, &quot;files&quot;: [ &quot;library/Functions.php&quot; ] &#125; æ‰§è¡Œä¸€ä¸‹ï¼Œcomposer installæˆ–è€…composer dump-autoloadå³å¯ã€‚ è¿™é‡Œç®€å•è¯´æ˜ä¸€ä¸‹autoloadçš„å››ç§æ–¹å¼ï¼š autoloadçš„å››ç§æ–¹å¼ PSR-4 åœ¨psr-4é”®ä¸‹ï¼Œå®šä¹‰äº†ç›¸å¯¹äºåŒ…æ ¹ç›®å½•ä»åç§°ç©ºé—´åˆ°è·¯å¾„çš„æ˜ å°„ã€‚å½“è‡ªåŠ¨åŠ è½½ä¸€ä¸ªç±»ï¼ˆå¦‚foo\\bar\\bazï¼‰æ—¶ï¼ŒæŒ‡å‘src/ç›®å½•çš„åç§°ç©ºé—´å‰ç¼€foo\\ï¼Œæ„å‘³ç€è‡ªåŠ¨åŠ è½½ç¨‹åºå°†æŸ¥æ‰¾ä¸€ä¸ªåä¸ºsrc/bar/baz.phpçš„æ–‡ä»¶ï¼Œå¹¶åŒ…æ‹¬å®ƒï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚æ³¨æ„ï¼Œä¸æ—§çš„psr-0æ ·å¼ç›¸åï¼Œå‰ç¼€ï¼ˆfoo\\ï¼‰ä¸åœ¨æ–‡ä»¶è·¯å¾„ä¸­ã€‚ å‘½åç©ºé—´å‰ç¼€å¿…é¡»ä»¥â€œ\\â€ç»“å°¾ï¼Œä»¥é¿å…ç±»ä¼¼å‰ç¼€ä¹‹é—´çš„å†²çªã€‚ä¾‹å¦‚ï¼Œfooå°†åŒ¹é…foobaråç§°ç©ºé—´ä¸­çš„ç±»ï¼Œå› æ­¤åé¢çš„åæ–œæ å¯ä»¥è§£å†³é—®é¢˜ï¼šfoo\\ï¼Œfoobar\\ã€‚ è¯¥æ•°ç»„å¯ä»¥åœ¨ç”Ÿæˆçš„æ–‡ä»¶vendor/composer/autoload_psr4.phpä¸­æ‰¾åˆ°ã€‚ PSR-0 åœ¨ psr-0 key ä¸‹ä½ å®šä¹‰äº†ä¸€ä¸ªå‘½åç©ºé—´åˆ°å®é™…è·¯å¾„çš„æ˜ å°„ï¼ˆç›¸å¯¹äºåŒ…çš„æ ¹ç›®å½•ï¼‰ã€‚æ³¨æ„ï¼Œè¿™é‡ŒåŒæ ·æ”¯æŒ PEAR-style æ–¹å¼çš„çº¦å®šï¼ˆä¸å‘½åç©ºé—´ä¸åŒï¼ŒPEAR ç±»åº“åœ¨ç±»åä¸Šé‡‡ç”¨äº†ä¸‹åˆ’çº¿åˆ†éš”ï¼‰ã€‚ è¯·æ³¨æ„ï¼Œå‘½åç©ºé—´çš„ç”³æ˜åº”è¯¥ä»¥ \\ ç»“æŸï¼Œä»¥ç¡®ä¿ autoloader èƒ½å¤Ÿå‡†ç¡®å“åº”ã€‚ä¾‹ï¼š Foo å°†ä¼šä¸ FooBar åŒ¹é…ï¼Œç„¶è€Œä»¥åæ–œæ ç»“æŸå°±å¯ä»¥è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œ Foo\\ å’Œ FooBar\\ å°†ä¼šè¢«åŒºåˆ†å¼€æ¥ã€‚ PSR-0 å¼•ç”¨éƒ½å°†è¢«ç»“åˆä¸ºä¸€ä¸ªå•ä¸€çš„é”®å€¼å¯¹æ•°ç»„ï¼Œå­˜å‚¨è‡³ vendor/composer/autoload_namespaces.php æ–‡ä»¶ä¸­ã€‚ classmap ä½ å¯ä»¥ç”¨ classmap ç”Ÿæˆæ”¯æŒæ”¯æŒè‡ªå®šä¹‰åŠ è½½çš„ä¸éµå¾ª PSR-0/4 è§„èŒƒçš„ç±»åº“ã€‚è¦é…ç½®å®ƒæŒ‡å‘éœ€è¦çš„ç›®å½•ï¼Œä»¥ä¾¿èƒ½å¤Ÿå‡†ç¡®æœç´¢åˆ°ç±»æ–‡ä»¶ã€‚ classmap å¼•ç”¨çš„æ‰€æœ‰ç»„åˆä¼šå­˜å‚¨åˆ° vendor/composer/autoload_classmap.php æ–‡ä»¶ä¸­ã€‚è¿™ä¸ª map æ˜¯ç»è¿‡æ‰«ææŒ‡å®šç›®å½•ï¼ˆåŒæ ·æ”¯æŒç›´æ¥ç²¾ç¡®åˆ°æ–‡ä»¶ï¼‰ä¸­æ‰€æœ‰çš„ .php å’Œ .inc æ–‡ä»¶é‡Œå†…ç½®çš„ç±»è€Œå¾—åˆ°çš„ã€‚ files å¦‚æœä½ æƒ³è¦æ˜ç¡®çš„æŒ‡å®šï¼Œåœ¨æ¯æ¬¡è¯·æ±‚æ—¶éƒ½è¦è½½å…¥æŸäº›æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ â€˜filesâ€™ autoloadingã€‚é€šå¸¸ä½œä¸ºå‡½æ•°åº“çš„è½½å…¥æ–¹å¼ï¼ˆè€Œéç±»åº“ï¼‰ã€‚files å¼•ç”¨çš„æ–‡ä»¶ä¼šå­˜å‚¨åˆ° vendor/composer/autoload_files.php æ–‡ä»¶ä¸­ ç‚¹å‡»æŸ¥çœ‹autoloadè¯´æ˜ä¸å®ä¾‹ æˆ‘ä»¬å…ˆä¸ç€æ€¥è¿›è¡Œæ ¸å¿ƒä»£ç ç¼–å†™ï¼Œä¸å¦¨å…ˆåšä¸€ä¸‹è¾…åŠ©å·¥ä½œï¼Œå¸¸ç”¨æ–¹æ³•ï¼Œå¼‚å¸¸å¤„ç†ç­‰ã€‚ å¸¸ç”¨å‡½æ•°Functionsç¼–å†™å¸¸ç”¨å‡½æ•° &lt;?php /** * å¸¸ç”¨å‡½æ•° */ if (!function_exists(&quot;p&quot;)) &#123; function p($var) &#123; if (is_bool($var)) &#123; var_dump($var); &#125; elseif (is_null($var)) &#123; var_dump(null); &#125; else &#123; die(&quot;&lt;meta charset=&#x27;utf-8&#x27;/&gt; &lt;pre style=&#x27;position:relative; z-index:999; padding:10px; border-radius:5px; background:#f5f5f5; border:1px solid #aaa; font-size:14px; line-height:18px; opacity:0.8;&#x27;&gt;&quot;.print_r($var, true).&quot;&lt;/pre&gt;&quot;); &#125; &#125; &#125; Â·Â·Â·Â·Â·Â· å¼‚å¸¸å¤„ç†åœ¨Exceptionsç›®å½•ä¸‹ï¼Œå®šä¹‰ä¸€ä¸ªæœ€åŸºç¡€çš„å¼‚å¸¸SaiExceptionï¼š &lt;?php namespace Library\\Exceptions; class SaiException extends \\Exception &#123; const CODE_MAPPING = [ 100 =&gt; &#x27;Continue&#x27;, 101 =&gt; &#x27;Switching Protocols&#x27;, 102 =&gt; &#x27;Processing&#x27;, 200 =&gt; &#x27;OK&#x27;, 201 =&gt; &#x27;Created&#x27;, 202 =&gt; &#x27;Accepted&#x27;, 203 =&gt; &#x27;Non-Authoritative Information&#x27;, 204 =&gt; &#x27;No Content&#x27;, 205 =&gt; &#x27;Reset Content&#x27;, 206 =&gt; &#x27;Partial Content&#x27;, 207 =&gt; &#x27;Multi-Status&#x27;, 226 =&gt; &#x27;IM Used&#x27;, 300 =&gt; &#x27;Multiple Choices&#x27;, 301 =&gt; &#x27;Moved Permanently&#x27;, 302 =&gt; &#x27;Found&#x27;, 303 =&gt; &#x27;See Other&#x27;, 304 =&gt; &#x27;Not Modified&#x27;, 305 =&gt; &#x27;Use Proxy&#x27;, 306 =&gt; &#x27;Reserved&#x27;, 307 =&gt; &#x27;Temporary Redirect&#x27;, 400 =&gt; &#x27;Bad Request&#x27;, 401 =&gt; &#x27;Unauthorized&#x27;, 402 =&gt; &#x27;Payment Required&#x27;, 403 =&gt; &#x27;Forbidden&#x27;, 404 =&gt; &#x27;Not Found&#x27;, 405 =&gt; &#x27;Method Not Allowed&#x27;, 406 =&gt; &#x27;Not Acceptable&#x27;, 407 =&gt; &#x27;Proxy Authentication Required&#x27;, 408 =&gt; &#x27;Request Timeout&#x27;, 409 =&gt; &#x27;Conflict&#x27;, 410 =&gt; &#x27;Gone&#x27;, 411 =&gt; &#x27;Length Required&#x27;, 412 =&gt; &#x27;Precondition Failed&#x27;, 413 =&gt; &#x27;Request Entity Too Large&#x27;, 414 =&gt; &#x27;Request-URI Too Long&#x27;, 415 =&gt; &#x27;Unsupported Media Type&#x27;, 416 =&gt; &#x27;Requested Range Not Satisfiable&#x27;, 417 =&gt; &#x27;Expectation Failed&#x27;, 422 =&gt; &#x27;Unprocessable Entity&#x27;, 423 =&gt; &#x27;Locked&#x27;, 424 =&gt; &#x27;Failed Dependency&#x27;, 426 =&gt; &#x27;Upgrade Required&#x27;, 429 =&gt; &#x27;Too Many Request&#x27;, 500 =&gt; &#x27;Internal Server Error&#x27;, 501 =&gt; &#x27;Not Implemented&#x27;, 502 =&gt; &#x27;Bad Gateway&#x27;, 503 =&gt; &#x27;Service Unavailable&#x27;, 504 =&gt; &#x27;Gateway Timeout&#x27;, 505 =&gt; &#x27;HTTP Version Not Supported&#x27;, 506 =&gt; &#x27;Variant Also Negotiates&#x27;, 507 =&gt; &#x27;Insufficient Storage&#x27;, 510 =&gt; &#x27;Not Extended&#x27;, 1001 =&gt; &#x27;LACK PARAMS&#x27;, 1002 =&gt; &#x27;RETRY TOO MANY&#x27;, ]; /** * è¾“å‡ºæŒ‡å®šHTTPçŠ¶æ€ç çš„å“åº”å¤´ä¿¡æ¯ * @param int $code * @param $data * @return void */ public function response($code, $data)&#123; $code = array_key_exists($code, self::CODE_MAPPING)? $code : 500; $desc = self::CODE_MAPPING[$code]; $protocol = $_SERVER[&#x27;SERVER_PROTOCOL&#x27;]; if ( &#x27;HTTP/1.1&#x27; != $protocol &amp;&amp; &#x27;HTTP/1.0&#x27; != $protocol ) $protocol = &#x27;HTTP/1.0&#x27;; $header = &quot;$protocol $code $desc&quot;; header($header); p($data); &#125; &#125; å‡ ä¹åé¢æ‰€æœ‰Exceptionçš„ç±»éƒ½ä¼šç»§æ‰¿è¿™ä¸ªå¼‚å¸¸ç±»ã€‚ åœ¨Componentsç›®å½•ä¸‹æ–°å»ºåŸºç¡€çš„ç±»Baseï¼š &lt;?php namespace Library\\Components; class Base implements \\ArrayAccess &#123; private $_container; public function __get($name) &#123; if (method_exists($this, $method = &#x27;get&#x27;.ucfirst($name))) &#123; return $this-&gt;$method($name); &#125; return null; &#125; public function __set($name, $value) &#123; if (method_exists($this, $method = &#x27;set&#x27;.ucfirst($name))) &#123; return $this-&gt;$method($name, $value); &#125; &#125; public function offsetSet($offset, $value) &#123; if (is_null($offset)) &#123; $this-&gt;_container[] = $value; &#125; else &#123; $this-&gt;_container[$offset] = $value; &#125; &#125; public function offsetExists($offset) &#123; return isset($this-&gt;_container[$offset]); &#125; public function offsetUnset($offset) &#123; unset($this-&gt;_container[$offset]); &#125; public function offsetGet($offset) &#123; return isset($this-&gt;_container[$offset]) ? $this-&gt;_container[$offset] : null; &#125; &#125; è¿™é‡Œæœ‰ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š ArrayAccessæ•°ç»„å¼è®¿é—®æ¥å£ï¼ˆæä¾›åƒè®¿é—®æ•°ç»„ä¸€æ ·è®¿é—®å¯¹è±¡çš„èƒ½åŠ›çš„æ¥å£ã€‚ï¼‰ é­”æœ¯æ–¹æ³•__setå’Œ__getï¼ˆåœ¨ç»™ä¸å¯è®¿é—®å±æ€§èµ‹å€¼æ—¶__set() ä¼šè¢«è°ƒç”¨;è¯»å–ä¸å¯è®¿é—®å±æ€§çš„å€¼æ—¶__get() ä¼šè¢«è°ƒç”¨ã€‚ï¼‰ å¦‚æœæƒ³äº†è§£æ›´å¤šï¼Œå¯çœ‹å®˜æ–¹æ–‡æ¡£ï¼š ArrayAccessæ¥å£ é­”æœ¯æ–¹æ³•","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"åŸºç¡€ç¯‡ï¼š3.åå°„","slug":"phpframe3","date":"2020-02-01T10:14:31.000Z","updated":"2022-03-19T15:32:12.814Z","comments":true,"path":"2020/02/01/phpframe03/","link":"","permalink":"https://github.13sai.com/2020/02/01/phpframe03/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ åå°„ï¼Œç›´è§‚ç†è§£å°±æ˜¯æ ¹æ®åˆ°è¾¾åœ°æ‰¾åˆ°å‡ºå‘åœ°å’Œæ¥æºã€‚ åå°„æŒ‡åœ¨PHPè¿è¡ŒçŠ¶æ€ä¸­ï¼Œæ‰©å±•åˆ†æPHPç¨‹åºï¼Œå¯¼å‡ºæˆ–æå‡ºå…³äºç±»ã€æ–¹æ³•ã€å±æ€§ã€å‚æ•°ç­‰çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ³¨é‡Šã€‚è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºåå°„APIã€‚ ä¸å¦¨å…ˆæ¥çœ‹ä¸€ä¸ªdemoï¼š &lt;?php /** * Author: sai * Date: 2019/10/21 * Time: 10:59 */ function p($msg, $var) &#123; echo(&quot;&lt;pre style=&#x27;position:relative; z-index:999; padding:10px; border-radius:5px; background:#f5f5f5; border:1px solid #aaa; font-size:14px; line-height:18px; opacity:0.8;&#x27;&gt;&quot;.$msg.&quot;:&quot;.print_r($var, true).&quot;&lt;/pre&gt;&quot;); &#125; class Demo &#123; private $id; protected $name; public $skills = []; public function __construct($id, $name, $skills = []) &#123; $this-&gt;id = $id; $this-&gt;name = $name; $this-&gt;skills = $skills; &#125; public function getName() &#123; return $this-&gt;name; &#125; public function getSkill() &#123; p(&#x27;skill&#x27;, $this-&gt;skills); &#125; &#125; $ref = new ReflectionClass(&#x27;Demo&#x27;); if ($ref-&gt;isInstantiable()) &#123; p(&#x27;æ£€æŸ¥ç±»æ˜¯å¦å¯å®ä¾‹åŒ–isInstantiable&#x27;, null ); &#125; $constructor = $ref-&gt;getConstructor(); p(&#x27;è·å–æ„é€ å‡½æ•°getConstructor&#x27;, $constructor); $parameters = $constructor-&gt;getParameters(); foreach ($parameters as $param) &#123; p(&#x27;è·å–å‚æ•°getParameters&#x27;, $param); &#125; if ($ref-&gt;hasProperty(&#x27;name&#x27;)) &#123; $attr = $ref-&gt;getProperty(&#x27;name&#x27;); p(&#x27;è·å–å±æ€§getProperty&#x27;, $attr); &#125; $attributes = $ref-&gt;getProperties(); foreach ($attributes as $row) &#123; p(&#x27;è·å–å±æ€§åˆ—è¡¨getProperties&#x27;, $row-&gt;getName() ); &#125; if ($ref-&gt;hasMethod(&#x27;getSkill&#x27;)) &#123; $method = $ref-&gt;getMethod(&#x27;getSkill&#x27;); p(&#x27;è·å–æ–¹æ³•getMethod&#x27;, $method); &#125; $methods = $ref-&gt;getMethods(); foreach ($methods as $row) &#123; p(&#x27;è·å–æ–¹æ³•åˆ—è¡¨getMethods&#x27;, $row-&gt;getName()); &#125; $instance = $ref-&gt;newInstanceArgs([1, &#x27;sai&#x27;, [&#x27;php&#x27;, &#x27;js&#x27;]]); p(&#x27;newInstanceArgs&#x27;, $instance); è¾“å‡ºï¼š æ£€æŸ¥ç±»æ˜¯å¦å¯å®ä¾‹åŒ–isInstantiable: è·å–æ„é€ å‡½æ•°getConstructor:ReflectionMethod Object ( [name] => __construct [class] => Demo ) è·å–å‚æ•°getParameters:ReflectionParameter Object( [name] => id)è·å–å‚æ•°getParameters:ReflectionParameter Object( [name] => name)è·å–å‚æ•°getParameters:ReflectionParameter Object( [name] => skills)è·å–å±æ€§getProperty:ReflectionProperty Object( [name] => name [class] => Demo)è·å–å±æ€§åˆ—è¡¨getProperties:idè·å–å±æ€§åˆ—è¡¨getProperties:nameè·å–å±æ€§åˆ—è¡¨getProperties:skillsè·å–æ–¹æ³•getMethod:ReflectionMethod Object( [name] => getSkill [class] => Demo)è·å–æ–¹æ³•åˆ—è¡¨getMethods:__constructè·å–æ–¹æ³•åˆ—è¡¨getMethods:getNameè·å–æ–¹æ³•åˆ—è¡¨getMethods:getSkillnewInstanceArgs:Demo Object( [id:Demo:private] => 1 [name:protected] => sai [skills] => Array ( [0] => php [1] => js ) ) demoé‡Œé¢å°±æœ‰ä½¿ç”¨äº†ReflectionClassç±»ï¼Œå½“ç„¶ReflectionClassç±»ä¸æ­¢äºè¿™äº›æ–¹æ³•ã€‚ æ›´å¤šæ–¹æ³•ReflectionClassç±»è¿˜æœ‰æ›´å¤šæ–¹æ³•ï¼š æ–¹æ³• è¯´æ˜ ReflectionClass::__construct åˆå§‹åŒ– ReflectionClass ç±» ReflectionClass::export å¯¼å‡ºä¸€ä¸ªç±» ReflectionClass::getConstant è·å–å®šä¹‰è¿‡çš„ä¸€ä¸ªå¸¸é‡ ReflectionClass::getConstants è·å–ä¸€ç»„å¸¸é‡ ReflectionClass::getConstructor è·å–ç±»çš„æ„é€ å‡½æ•° ReflectionClass::getDefaultProperties è·å–é»˜è®¤å±æ€§ ReflectionClass::getDocComment è·å–æ–‡æ¡£æ³¨é‡Š ReflectionClass::getEndLine è·å–æœ€åä¸€è¡Œçš„è¡Œæ•° ReflectionClass::getExtension æ ¹æ®å·²å®šä¹‰çš„ç±»è·å–æ‰€åœ¨æ‰©å±•çš„ ReflectionExtension å¯¹è±¡ ReflectionClass::getExtensionName è·å–å®šä¹‰çš„ç±»æ‰€åœ¨çš„æ‰©å±•çš„åç§° ReflectionClass::getFileName è·å–å®šä¹‰ç±»çš„æ–‡ä»¶å ReflectionClass::getInterfaceNames è·å–æ¥å£ï¼ˆinterfaceï¼‰åç§° ReflectionClass::getInterfaces è·å–æ¥å£ ReflectionClass::getMethod è·å–ä¸€ä¸ªç±»æ–¹æ³•çš„ ReflectionMethodã€‚ ReflectionClass::getMethods è·å–æ–¹æ³•çš„æ•°ç»„ ReflectionClass::getModifiers è·å–ç±»çš„ä¿®é¥°ç¬¦ ReflectionClass::getName è·å–ç±»å ReflectionClass::getNamespaceName è·å–å‘½åç©ºé—´çš„åç§° ReflectionClass::getParentClass è·å–çˆ¶ç±» ReflectionClass::getProperties è·å–ä¸€ç»„å±æ€§ ReflectionClass::getProperty è·å–ç±»çš„ä¸€ä¸ªå±æ€§çš„ ReflectionProperty ReflectionClass::getReflectionConstant Gets a ReflectionClassConstant for a classâ€™s constant ReflectionClass::getReflectionConstants Gets class constants ReflectionClass::getShortName è·å–çŸ­å ReflectionClass::getStartLine è·å–èµ·å§‹è¡Œå· ReflectionClass::getStaticProperties è·å–é™æ€ï¼ˆstaticï¼‰å±æ€§ ReflectionClass::getStaticPropertyValue è·å–é™æ€ï¼ˆstaticï¼‰å±æ€§çš„å€¼ ReflectionClass::getTraitAliases è¿”å› trait åˆ«åçš„ä¸€ä¸ªæ•°ç»„ ReflectionClass::getTraitNames è¿”å›è¿™ä¸ªç±»æ‰€ä½¿ç”¨ traits çš„åç§°çš„æ•°ç»„ ReflectionClass::getTraits è¿”å›è¿™ä¸ªç±»æ‰€ä½¿ç”¨çš„ traits æ•°ç»„ ReflectionClass::hasConstant æ£€æŸ¥å¸¸é‡æ˜¯å¦å·²ç»å®šä¹‰ ReflectionClass::hasMethod æ£€æŸ¥æ–¹æ³•æ˜¯å¦å·²å®šä¹‰ ReflectionClass::hasProperty æ£€æŸ¥å±æ€§æ˜¯å¦å·²å®šä¹‰ ReflectionClass::implementsInterface æ¥å£çš„å®ç° ReflectionClass::inNamespace æ£€æŸ¥æ˜¯å¦ä½äºå‘½åç©ºé—´ä¸­ ReflectionClass::isAbstract æ£€æŸ¥ç±»æ˜¯å¦æ˜¯æŠ½è±¡ç±»ï¼ˆabstractï¼‰ ReflectionClass::isAnonymous æ£€æŸ¥ç±»æ˜¯å¦æ˜¯åŒ¿åç±» ReflectionClass::isCloneable è¿”å›äº†ä¸€ä¸ªç±»æ˜¯å¦å¯å¤åˆ¶ ReflectionClass::isFinal æ£€æŸ¥ç±»æ˜¯å¦å£°æ˜ä¸º final ReflectionClass::isInstance æ£€æŸ¥ç±»çš„å®ä¾‹ ReflectionClass::isInstantiable æ£€æŸ¥ç±»æ˜¯å¦å¯å®ä¾‹åŒ– ReflectionClass::isInterface æ£€æŸ¥ç±»æ˜¯å¦æ˜¯ä¸€ä¸ªæ¥å£ï¼ˆinterfaceï¼‰ ReflectionClass::isInternal æ£€æŸ¥ç±»æ˜¯å¦ç”±æ‰©å±•æˆ–æ ¸å¿ƒåœ¨å†…éƒ¨å®šä¹‰ ReflectionClass::isIterable Check whether this class is iterable ReflectionClass::isIterateable æ£€æŸ¥æ˜¯å¦å¯è¿­ä»£ï¼ˆiterateableï¼‰ ReflectionClass::isSubclassOf æ£€æŸ¥æ˜¯å¦ä¸ºä¸€ä¸ªå­ç±» ReflectionClass::isTrait è¿”å›äº†æ˜¯å¦ä¸ºä¸€ä¸ª trait ReflectionClass::isUserDefined æ£€æŸ¥æ˜¯å¦ç”±ç”¨æˆ·å®šä¹‰çš„ ReflectionClass::newInstance ä»æŒ‡å®šçš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹ ReflectionClass::newInstanceArgs ä»ç»™å‡ºçš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹ã€‚ ReflectionClass::newInstanceWithoutConstructor åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹è€Œä¸è°ƒç”¨å®ƒçš„æ„é€ å‡½æ•° ReflectionClass::setStaticPropertyValue è®¾ç½®é™æ€å±æ€§çš„å€¼ ReflectionClass::__toString è¿”å› ReflectionClass å¯¹è±¡å­—ç¬¦ä¸²çš„è¡¨ç¤ºå½¢å¼ã€‚ é™¤å»å¼ºå¤§çš„ReflectionClassï¼Œè¿˜æœ‰Reflectionã€ReflectionClassConstant ã€ReflectionMethod ã€ReflectionFunctionAbstractç­‰ç­‰ã€‚å»ºè®®æŸ¥çœ‹æ‰‹å†Œï¼š PHPåå°„ åå°„çš„å®é™…åº”ç”¨ åå°„å¯ä»¥ç”¨äºæ–‡æ¡£ã€æ–‡ä»¶ç”Ÿæˆã€‚å¯ä»¥ç”¨å®ƒå¯¹æ–‡ä»¶é‡Œçš„ç±»è¿›è¡Œæ‰«æï¼Œé€ä¸ªç”Ÿæˆæè¿°æ–‡æ¡£; æ—¢ç„¶åå°„å¯ä»¥æ¢çŸ¥ç±»çš„å†…éƒ¨ç»“æ„ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨å®ƒåšhookå®ç°æ’ä»¶åŠŸèƒ½ï¼› å¯ä»¥ç”¨äºåšåŠ¨æ€ä»£ç†ï¼Œåœ¨æœªçŸ¥æˆ–è€…ä¸ç¡®å®šç±»åçš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€ç”Ÿæˆå’Œå®ä¾‹åŒ–ä¸€äº›ç±»å’Œæ‰§è¡Œæ–¹æ³•ï¼› ä¾èµ–æ³¨å…¥ã€‚å¯¹äºå¤šæ¬¡ç»§æ‰¿çš„ç±»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šæ¬¡åå°„æ¢ç´¢åˆ°åŸºç±»çš„ç»“æ„ï¼Œæˆ–è€…é‡‡ç”¨é€’å½’çš„å½¢å¼åå°„ï¼Œå®ç°å®ä¾‹åŒ–æ‰€æœ‰ç»§æ‰¿ç±»ï¼Œè¿™ä¹Ÿæ˜¯PHPä¾èµ–æ³¨å…¥çš„åŸç†ã€‚ åå°„çš„ä¼˜ç‚¹ æ”¯æŒåå°„çš„è¯­è¨€æä¾›äº†ä¸€äº›åœ¨ä½çº§è¯­è¨€ä¸­éš¾ä»¥å®ç°çš„è¿è¡Œæ—¶ç‰¹æ€§ã€‚ å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å…ç¡¬ç¼–ç ï¼Œæä¾›çµæ´»æ€§å’Œé€šç”¨æ€§ã€‚ å¯ä»¥ä½œä¸ºä¸€ä¸ªç¬¬ä¸€ç±»å¯¹è±¡å‘ç°å¹¶ä¿®æ”¹æºä»£ç çš„ç»“æ„ï¼ˆå¦‚ä»£ç å—ã€ç±»ã€æ–¹æ³•ã€åè®®ç­‰ï¼‰ã€‚ å¯ä»¥åœ¨è¿è¡Œæ—¶åƒå¯¹å¾…æºä»£ç è¯­å¥ä¸€æ ·è®¡ç®—ç¬¦å·è¯­æ³•çš„å­—ç¬¦ä¸²ï¼ˆç±»ä¼¼JavaScriptçš„eval()å‡½æ•°ï¼‰ï¼Œè¿›è€Œå¯å°†è·Ÿclassæˆ–functionåŒ¹é…çš„å­—ç¬¦ä¸²è½¬æ¢æˆclassæˆ–functionçš„è°ƒç”¨æˆ–å¼•ç”¨ã€‚ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„è¯­è¨€å­—èŠ‚ç è§£é‡Šå™¨æ¥ç»™ç¼–ç¨‹ç»“æ„ä¸€ä¸ªæ–°çš„æ„ä¹‰æˆ–ç”¨é€”ã€‚ åå°„çš„ç¼ºç‚¹ å­¦ä¹ æˆæœ¬é«˜ã€‚é¢å‘åå°„çš„ç¼–ç¨‹éœ€è¦è¾ƒå¤šçš„é«˜çº§çŸ¥è¯†ï¼ŒåŒ…æ‹¬æ¡†æ¶ã€å…³ç³»æ˜ å°„å’Œå¯¹è±¡äº¤äº’ï¼Œä»¥åˆ©ç”¨æ›´é€šç”¨çš„ä»£ç æ‰§è¡Œ åŒæ ·å› ä¸ºåå°„çš„æ¦‚å¿µå’Œè¯­æ³•éƒ½æ¯”è¾ƒæŠ½è±¡ï¼Œè¿‡å¤šåœ°æ»¥ç”¨åå°„æŠ€æœ¯ä¼šä½¿å¾—ä»£ç éš¾ä»¥è¢«å…¶ä»–äººè¯»æ‡‚ï¼Œä¸åˆ©äºåˆä½œä¸äº¤æµ åå°„åœ¨æé«˜äº†ä»£ç çµæ´»æ€§çš„åŒæ—¶ï¼Œç‰ºç‰²äº†ä¸€ç‚¹ç‚¹è¿è¡Œæ•ˆç‡ï¼Œæœ‰ä¸€å®šçš„æ¶ˆè€— åå°„ä¹Ÿä¼šç ´åç±»çš„å°è£…æ€§ï¼ŒæŠŠæœ¬ä¸è¯¥æš´éœ²çš„æ–¹æ³•æˆ–å±æ€§æš´éœ²äº†å‡ºæ¥ åœ¨å¹³æ—¶çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°åå°„å…¶å®ä¸å¤šï¼Œä¸ºä»€ä¹ˆæŠŠå®ƒæ‹¿åˆ°è¿™é‡Œæ¥è¯´å‘¢ï¼Ÿä¸€æ¥æ˜¯æˆ‘ä»¬åé¢ä¼šä½¿ç”¨åˆ°åå°„å»å®ç°Iocå®¹å™¨ï¼ŒäºŒæ¥åå°„ä¹Ÿæ˜¯PHPæ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œåœ¨æˆ‘ä»¬æµè¡Œçš„æ¡†æ¶ä¸­ååˆ†å¸¸è§ï¼Œç†è§£å®ƒæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"åŸºç¡€ç¯‡ï¼š2.composer","slug":"phpframe2","date":"2020-02-01T03:04:31.000Z","updated":"2022-03-19T15:32:09.922Z","comments":true,"path":"2020/02/01/phpframe02/","link":"","permalink":"https://github.13sai.com/2020/02/01/phpframe02/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ ä¸Šä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†æˆ‘ä»¬éœ€è¦éµå¾ªçš„è§„èŒƒï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹æˆ‘ä»¬çš„é¡¹ç›®ä¸­éœ€è¦ç”¨åˆ°çš„ä¸€ä¸ªä¾èµ–ç®¡ç†å·¥å…·â€”â€”Composerã€‚ Composer æ˜¯ PHP çš„ä¸€ä¸ªä¾èµ–ç®¡ç†å·¥å…·ã€‚å®ƒå…è®¸ä½ ç”³æ˜é¡¹ç›®æ‰€ä¾èµ–çš„ä»£ç åº“ï¼Œå®ƒä¼šåœ¨ä½ çš„é¡¹ç›®ä¸­ä¸ºä½ å®‰è£…ä»–ä»¬ã€‚ å¦‚æœä½ æ˜¯å‰ç«¯å·¥ç¨‹å¸ˆï¼Œä½ åº”è¯¥ç”¨è¿‡npmï¼›å¦‚æœä½ æ˜¯pyhtonå¼€å‘è€…ï¼Œä½ åº”è¯¥ç”¨è¿‡pipï¼Œç®€å•è¯´ä½ å¯ä»¥è¿™æ ·ç†è§£composerã€‚ composeråœ¨å°å†Œä¸­å¯èƒ½ç»å¸¸ä¼šè¢«æåŠï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹å®‰è£…å’Œå¸¸ç”¨å‘½ä»¤ã€‚ å®‰è£… Linux composerçš„å®‰è£…æ¯”è¾ƒç®€å•ï¼Œä¸å»ºè®®ä½¿ç”¨yumç­‰ç®¡ç†åŒ…ç›´æ¥installï¼Œå› ä¸ºæœ‰å¯èƒ½ä¼šä¿®æ”¹ä½ çš„é»˜è®¤phpç‰ˆæœ¬ã€‚æˆ‘ä»¬å¯ä»¥è·³è¿‡ä»¥ä¸‹æ–¹å¼å®‰è£…ï¼š curl -sS https://getcomposer.org/installer | php mv composer.phar /usr/local/bin/composer Windows ä¸‹è½½å¹¶ä¸”è¿è¡Œ Composer-Setup.exeï¼Œå®ƒå°†å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Composer ï¼Œå»ºè®®åŠ å…¥ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨ä»»ä½•ç›®å½•ä¸‹ç›´æ¥ä½¿ç”¨ composer å‘½ä»¤ã€‚ ä¿®æ”¹é•œåƒæºé»˜è®¤é•œåƒæºå›½å†…ä¸‹è½½æ¯”è¾ƒæ…¢ï¼Œå»ºè®®æ›´æ¢é•œåƒæº composer config -g repo.packagist composer https://packagist.phpcomposer.com ä¹Ÿå¯ä»¥ä½¿ç”¨é˜¿é‡Œçš„é•œåƒæº(æ¨è) composer config -g repo.packagist composer https://mirrors.aliyun.com/composer/ config -g/â€“global è¡¨ç¤ºå…¨å±€é…ç½® composerå¸¸ç”¨å‘½ä»¤initåˆå§‹åŒ–å‚æ•°ï¼š --name: åŒ…çš„åç§°ã€‚ --description: åŒ…çš„æè¿°ã€‚ --author: åŒ…çš„ä½œè€…ã€‚ --homepage: åŒ…çš„ä¸»é¡µã€‚ --require: éœ€è¦ä¾èµ–çš„å…¶å®ƒåŒ…ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªç‰ˆæœ¬çº¦æŸã€‚å¹¶ä¸”åº”è¯¥éµå¾ª foo/bar:1.0.0 è¿™æ ·çš„æ ¼å¼ã€‚ --require-dev: å¼€å‘ç‰ˆçš„ä¾èµ–åŒ…ï¼Œå†…å®¹æ ¼å¼ä¸ --require ç›¸åŒã€‚ --stability (-s): minimum-stability å­—æ®µçš„å€¼ã€‚ requireå¢åŠ require å‘½ä»¤å¢åŠ æ–°çš„ä¾èµ–åŒ…åˆ°å½“å‰ç›®å½•çš„ composer.json æ–‡ä»¶ä¸­ï¼Œå¹¶å¯ä»¥æŒ‡å®šç‰ˆæœ¬ã€‚ composer require vendor/package:2.* vendor/package2:dev-master installå®‰è£…install å‘½ä»¤ä»å½“å‰ç›®å½•è¯»å– composer.json æ–‡ä»¶ï¼Œå¤„ç†äº†ä¾èµ–å…³ç³»ï¼Œå¹¶æŠŠå…¶å®‰è£…åˆ° vendor ç›®å½•ä¸‹ã€‚ å¦‚æœå½“å‰ç›®å½•ä¸‹å­˜åœ¨ composer.lock æ–‡ä»¶ï¼Œå®ƒä¼šä»æ­¤æ–‡ä»¶è¯»å–ä¾èµ–ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯æ ¹æ® composer.json æ–‡ä»¶å»è·å–ä¾èµ–ã€‚è¿™ç¡®ä¿äº†è¯¥åº“çš„æ¯ä¸ªä½¿ç”¨è€…éƒ½èƒ½å¾—åˆ°ç›¸åŒçš„ä¾èµ–ç‰ˆæœ¬ã€‚ å¦‚æœæ²¡æœ‰ composer.lock æ–‡ä»¶ï¼Œcomposer å°†åœ¨å¤„ç†å®Œä¾èµ–å…³ç³»ååˆ›å»ºå®ƒã€‚ ä½ å¯ä»¥ç®€å•æŠŠcomposer.lockç†è§£ä¸ºæ‰©å±•åº“çš„ç¼“å­˜ã€‚ updateæ›´æ–°ä¸ºäº†è·å–ä¾èµ–çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ›´æ–° composer.lock æ–‡ä»¶ï¼Œä½ åº”è¯¥ä½¿ç”¨ update å‘½ä»¤ã€‚ composer update è¿™å°†è§£å†³é¡¹ç›®çš„æ‰€æœ‰ä¾èµ–ï¼Œå¹¶å°†ç¡®åˆ‡çš„ç‰ˆæœ¬å·å†™å…¥ composer.lockã€‚ å¦‚æœä½ åªæ˜¯æƒ³æ›´æ–°å‡ ä¸ªåŒ…ï¼Œä½ å¯ä»¥åƒè¿™æ ·åˆ†åˆ«åˆ—å‡ºå®ƒä»¬ï¼š composer update vendor/package vendor/package2 ==æ³¨æ„==ï¼šupdateå‘½ä»¤ä¼šæ›´æ–°composer.jsoné‡Œé™å®šç‰ˆæœ¬çš„æœ€æ–°ä¾èµ–ã€‚æ¯”å¦‚ä½ å†™çš„æ˜¯â€monolog/monologâ€: â€œ1.*â€,updateå‘½ä»¤å¯èƒ½ä¼šæŠŠ1.0æ›´æ–°ä¸º1.2ç‰ˆæœ¬ï¼Œä½†ä¸ä¼šå°†1.0æ›´æ–°ä¸º2.0ã€‚æ‰€ä»¥ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ã€‚ searchsearch å‘½ä»¤å…è®¸ä½ ä¸ºå½“å‰é¡¹ç›®æœç´¢ä¾èµ–åŒ…ï¼Œé€šå¸¸å®ƒåªæœç´¢ packagist.org ä¸Šçš„åŒ…ï¼Œä½ å¯ä»¥ç®€å•çš„è¾“å…¥ä½ çš„æœç´¢æ¡ä»¶ã€‚ showåˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„è½¯ä»¶åŒ…ï¼Œä½ å¯ä»¥ä½¿ç”¨ show å‘½ä»¤ã€‚ ä¹Ÿå¯ä»¥ç‚¹å‡»æŸ¥çœ‹æ›´å¤šcomposeråŒ… dump-autoloadæ‰“å°è‡ªåŠ¨åŠ è½½ç´¢å¼•ï¼ŒæŸäº›æƒ…å†µä¸‹ä½ éœ€è¦æ›´æ–° autoloaderï¼Œä¾‹å¦‚åœ¨ä½ çš„åŒ…ä¸­åŠ å…¥äº†ä¸€ä¸ªæ–°çš„ç±»ã€‚ä½ å¯ä»¥ä½¿ç”¨ dump-autoload æ¥å®Œæˆï¼Œè€Œä¸å¿…æ‰§è¡Œ install æˆ– update å‘½ä»¤ã€‚ æ­¤å¤–ï¼Œå®ƒå¯ä»¥æ‰“å°ä¸€ä¸ªä¼˜åŒ–è¿‡çš„ï¼Œç¬¦åˆ PSR-0/4 è§„èŒƒçš„ç±»çš„ç´¢å¼•ï¼Œè¿™ä¹Ÿæ˜¯å‡ºäºå¯¹æ€§èƒ½çš„å¯è€ƒè™‘ã€‚åœ¨å¤§å‹çš„åº”ç”¨ä¸­ä¼šæœ‰è®¸å¤šç±»æ–‡ä»¶ï¼Œè€Œ autoloader ä¼šå ç”¨æ¯ä¸ªè¯·æ±‚çš„å¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´ï¼Œä½¿ç”¨ classmaps æˆ–è®¸åœ¨å¼€å‘æ—¶ä¸å¤ªæ–¹ä¾¿ï¼Œä½†å®ƒåœ¨ä¿è¯æ€§èƒ½çš„å‰æä¸‹ï¼Œä»ç„¶å¯ä»¥è·å¾— PSR-0/4 è§„èŒƒå¸¦æ¥çš„ä¾¿åˆ©ã€‚ æ›´composerå¤šå‘½ä»¤è¯·ç‚¹å‡»æŸ¥çœ‹ å¥½äº†ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†composerçš„å®‰è£…å’Œå¸¸ç”¨å‘½ä»¤ã€‚æˆ‘ä»¬åé¢å¯ä»¥å°†æ¡†æ¶é›†æˆåˆ°ä¸€ä¸ªcomposeråŒ…ï¼Œåˆ†äº«ç»™å…¶ä»–å¼€å‘åŒå­¦ä½¿ç”¨ã€‚","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"åŸºç¡€ç¯‡ï¼š1.PSR","slug":"phpframe1","date":"2020-02-01T02:54:13.000Z","updated":"2022-03-19T15:32:07.239Z","comments":true,"path":"2020/02/01/phpframe01/","link":"","permalink":"https://github.13sai.com/2020/02/01/phpframe01/","excerpt":"","text":"PHP DIYç³»åˆ—â€“ä¸€èµ·æ‰‹å†™ä¸€ä¸ªapiæ¡†æ¶ åˆ›ä½œåˆè¡· æœ‰æ²¡æœ‰ç”¨çƒ¦äº†CURDï¼Ÿ å„ç§æ¡†æ¶æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤´å¤§ï¼Ÿ æœ‰æ²¡æœ‰å°è¯•è‡ªå·±è®¾è®¡ä¸€ä¸ªæ¡†æ¶ï¼Ÿ å­¦äº†PHPè¯­æ³•ï¼Œæ²¡æœ‰é¡¹ç›®å»å®æˆ˜ï¼Œå¤¯å®åŸºç¡€ å¸Œæœ›èƒ½å¸®åŠ©èƒ½è®©ä½ å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ªè‡ªå·±çš„æ¡†æ¶ï¼Œèƒ½ç»™ä½ çš„å·¥ä½œæˆ–è€…å­¦ä¹ ä¸­å¸¦æ¥ä¸€å®šçš„å¸®åŠ©ä¸å¯å‘ã€‚ ä½ èƒ½å­¦åˆ°ä»€ä¹ˆ PSRè§„èŒƒ composerçš„ä½¿ç”¨ å¿«é€Ÿæ­å»ºä¸€ä¸ªAPIæ¥å£æ¡†æ¶ Rediså„ç§æ•°æ®ç±»å‹çš„åº”ç”¨ ç¼“å­˜åº”ç”¨åˆ†æ åœ¨å¼€å‘æ¡†æ¶ä¹‹å‰ï¼Œæˆ‘æ¥ä»‹ç»æ¡†æ¶å¼€å‘éµå¾ªçš„è§„èŒƒã€‚ å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—ç¼–ç è§„èŒƒï¼Œä½œä¸ºâ€œä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€â€ï¼ŒPHPå½“ç„¶ä¹Ÿæœ‰è‡ªå·±çš„ç¼–ç è§„èŒƒã€‚è¿™ä¸ªè§„èŒƒå°±æ˜¯PHP Standard Recommendationï¼ˆç®€ç§°PSRï¼‰ã€‚ å½“ç„¶ï¼Œä»æˆ‘è‡ªå·±çš„å·¥ä½œä¸­ï¼Œæˆ‘å‘ç°å¾ˆå¤šPHPç¨‹åºå‘˜å°¤å…¶æ˜¯åˆçº§ç¨‹åºå‘˜ï¼Œæ˜¯ä¸çŸ¥é“PHPæ˜¯æœ‰è¿™ä¹ˆä¸€ä¸ªè§„èŒƒçš„ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸ç§‘å­¦çš„ã€‚ ä»€ä¹ˆæ˜¯PSRï¼Ÿä»‹ç»PSRä¹‹å‰éœ€è¦ä»‹ç»ä¸€ä¸‹åˆ¶å®šæ­¤è§„èŒƒçš„ç»„ç»‡â€”â€“PHP-FIGï¼Œå…¨ç§°æ˜¯PHP Framework Interoperabilityã€‚ ç»„ç»‡æˆå‘˜åˆ¶å®šè§„èŒƒï¼Œå¹¶ä¸”è½å®åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œè™½ç„¶ä¸æ˜¯å®˜æ–¹ç»„ç»‡ï¼Œä½†ä¹Ÿä»£è¡¨äº†å¤§éƒ¨åˆ†PHPç¤¾åŒºé¡¹ç›®ï¼Œå¦‚CakePHPï¼ŒComposerï¼ŒDrupalï¼ŒPEARï¼ŒSlimï¼ŒYii frameworkï¼ŒZend Frameworkç­‰ã€‚å¹¶ä¸”æœ‰è¶Šæ¥è¶Šå¤šçš„é¡¹ç›®åŠ å…¥å¹¶éµå¾ªæ­¤æ ‡å‡†ã€‚ PSRé¡¹ç›®çš„ç›®çš„åœ¨äºï¼šé€šè¿‡æ¡†æ¶ä½œè€…æˆ–è€…æ¡†æ¶çš„ä»£è¡¨ä¹‹é—´è®¨è®ºï¼Œä»¥æœ€ä½ç¨‹åº¦çš„é™åˆ¶ï¼Œåˆ¶å®šä¸€ä¸ªåä½œæ ‡å‡†ï¼Œå„ä¸ªæ¡†æ¶éµå¾ªç»Ÿä¸€çš„ç¼–ç è§„èŒƒï¼Œè®©å·¥ç¨‹å¸ˆä¸€èµ·æ›´å¥½ååŒå·¥ä½œã€‚ æˆªæ­¢ç›®å‰ï¼Œå·²ç»å®˜ç½‘å·²æœ‰20æ¡åˆ—å‡ºï¼Œé™¤å»èµ·è‰ä¸­å’Œèˆå¼ƒçš„ï¼Œæœ‰ä»¥ä¸‹13æ¡ã€‚ æˆ‘ä»¬ä¸å¦¨æ¥çœ‹çœ‹è¿™äº›è§„èŒƒï¼š PSR-1 åŸºç¡€ç¼–ç è§„èŒƒ PHP ä»£ç æ–‡ä»¶å¿…é¡»ä»¥ &lt;?php æˆ– &lt;?= æ ‡ç­¾å¼€å§‹ PHP ä»£ç æ–‡ä»¶å¿…é¡»ä»¥ä¸å¸¦BOMçš„UTF-8ç¼–ç  PHP ä»£ç ä¸­ åº”è¯¥ åªå®šä¹‰ç±»ã€å‡½æ•°ã€å¸¸é‡ç­‰å£°æ˜ï¼Œæˆ–å…¶ä»–ä¼šäº§ç”Ÿ å‰¯ä½œç”¨ çš„æ“ä½œï¼ˆå¦‚ï¼šç”Ÿæˆæ–‡ä»¶è¾“å‡ºä»¥åŠä¿®æ”¹ .ini é…ç½®æ–‡ä»¶ç­‰ï¼‰ï¼ŒäºŒè€…åªèƒ½é€‰å…¶ä¸€ å‘½åç©ºé—´ä»¥åŠç±»å¿…é¡»ç¬¦åˆ PSR çš„è‡ªåŠ¨åŠ è½½è§„èŒƒPSR-4 ç±»çš„å‘½åå¿…é¡»éµå¾ª StudlyCaps å¼å¤§å†™å¼€å¤´çš„é©¼å³°å‘½åè§„èŒƒ ç±»ä¸­çš„å¸¸é‡æ‰€æœ‰å­—æ¯éƒ½å¿…é¡» å¤§å†™ï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿åˆ†éš” æ–¹æ³•åç§°å¿…é¡»ç¬¦åˆ camelCase å¼çš„å°å†™å¼€å¤´é©¼å³°å‘½åè§„èŒƒ PSR-12 ä»£ç é£æ ¼è§„èŒƒPSR-12çš„è§„èŒƒå¾ˆç»†è‡´ï¼ŒåŒ…å«äº†å£°æ˜ã€å‘½åç©ºé—´ã€ç±»åŠç»§æ‰¿ä»¥åŠæ§åˆ¶ç»“æ„ç­‰è¯´æ˜ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªdemoï¼š &lt;?php declare(strict_types=1); namespace Vendor\\Package; use Vendor\\Package\\&#123;ClassA as A, ClassB, ClassC as C&#125;; use Vendor\\Package\\SomeNamespace\\ClassD as D; use function Vendor\\Package\\&#123;functionA, functionB, functionC&#125;; use const Vendor\\Package\\&#123;ConstantA, ConstantB, ConstantC&#125;; class Foo extends Bar implements FooInterface &#123; public function sampleFunction(int $a, int $b = null): array &#123; if ($a === $b) &#123; bar(); &#125; elseif ($a &gt; $b) &#123; $foo-&gt;bar($arg1); &#125; else &#123; BazClass::bar($arg2, $arg3); &#125; &#125; final public static function bar() &#123; // method body &#125; &#125; ä»£ç  å¿…é¡» éµå¾ª [PSR-1] ä¸­çš„ç¼–ç è§„èŒƒ æ‰€æœ‰PHPæ–‡ä»¶å¿…é¡»ä½¿ç”¨Unix LF (linefeed)ä½œä¸ºè¡Œçš„ç»“æŸç¬¦ï¼› æ‰€æœ‰PHPæ–‡ä»¶å¿…é¡»ä»¥ä¸€ä¸ªç©ºç™½è¡Œä½œä¸ºç»“æŸï¼› çº¯PHPä»£ç æ–‡ä»¶å¿…é¡»çœç•¥æœ€åçš„ ?&gt; ç»“æŸæ ‡ç­¾ æ¯è¡Œçš„å­—ç¬¦æ•° åº”è¯¥è½¯æ€§ä¿æŒåœ¨ 80 ä¸ªä¹‹å†…ï¼Œç†è®ºä¸Š ä¸€å®šä¸å¯ å¤šäº 120 ä¸ªï¼Œä½†ä¸€å®šä¸å¯æœ‰ç¡¬æ€§é™åˆ¶ï¼›éç©ºè¡Œåä¸€å®šä¸èƒ½æœ‰å¤šä½™çš„ç©ºæ ¼ç¬¦ï¼› ç©ºè¡Œå¯ä»¥ä½¿å¾—é˜…è¯»ä»£ç æ›´åŠ æ–¹ä¾¿ä»¥åŠæœ‰åŠ©äºä»£ç çš„åˆ†å—ã€‚ æ¯è¡Œä¸€å®šä¸èƒ½å­˜åœ¨å¤šäºä¸€æ¡è¯­å¥ ä»£ç å¿…é¡»ä½¿ç”¨4ä¸ªç©ºæ ¼ç¬¦çš„ç¼©è¿›ï¼Œä¸€å®šä¸èƒ½ç”¨ tabé”® PHPæ‰€æœ‰å…³é”®å­—å¿…é¡»å…¨éƒ¨å°å†™ æ§åˆ¶ç»“æ„çš„åŸºæœ¬è§„èŒƒå¦‚ä¸‹ï¼šæ§åˆ¶ç»“æ„å…³é”®è¯åå¿…é¡»æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚ å·¦æ‹¬å· ( åä¸€å®šä¸èƒ½æœ‰ç©ºæ ¼ã€‚ å³æ‹¬å· ) å‰ä¹Ÿä¸€å®šä¸èƒ½æœ‰ç©ºæ ¼ã€‚ å³æ‹¬å· ) ä¸å¼€å§‹èŠ±æ‹¬å· &#123; é—´ä¸€å®šæœ‰ä¸€ä¸ªç©ºæ ¼ã€‚ ç»“æ„ä½“ä¸»ä½“ä¸€å®šè¦æœ‰ä¸€æ¬¡ç¼©è¿›ã€‚ ç»“æŸèŠ±æ‹¬å· &#125; ä¸€å®šåœ¨ç»“æ„ä½“ä¸»ä½“åå•ç‹¬æˆè¡Œã€‚ ä»£ç é£æ ¼è§„èŒƒå†…å®¹å¾ˆå¤šï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€è¯´æ˜äº†ï¼Œå¤§å®¶å¯è‡ªè¡Œé˜…è¯» PSR-4 è‡ªåŠ¨åŠ è½½å…³äºç”±æ–‡ä»¶è·¯å¾„ è‡ªåŠ¨è½½å…¥ å¯¹åº”ç±»çš„ç›¸å…³è§„èŒƒï¼Œ æœ¬è§„èŒƒæ˜¯å¯äº’æ“ä½œçš„ï¼Œå¯ä»¥ä½œä¸ºä»»ä¸€è‡ªåŠ¨è½½å…¥è§„èŒƒçš„è¡¥å……ï¼Œå…¶ä¸­åŒ…æ‹¬ PSR-0ï¼Œæ­¤å¤–ï¼Œ æœ¬ PSR è¿˜åŒ…æ‹¬è‡ªåŠ¨è½½å…¥çš„ç±»å¯¹åº”çš„æ–‡ä»¶å­˜æ”¾è·¯å¾„è§„èŒƒã€‚ æ­¤å¤„çš„â€œç±»â€æ³›æŒ‡æ‰€æœ‰çš„classç±»ã€æ¥å£ã€traitså¯å¤ç”¨ä»£ç å—ä»¥åŠå…¶å®ƒç±»ä¼¼ç»“æ„ã€‚ ä¸€ä¸ªå®Œæ•´çš„ç±»åéœ€å…·æœ‰ä»¥ä¸‹ç»“æ„: \\&lt;å‘½åç©ºé—´&gt;(\\&lt;å­å‘½åç©ºé—´&gt;)*\\&lt;ç±»å&gt; å®Œæ•´çš„ç±»åå¿…é¡»è¦æœ‰ä¸€ä¸ªé¡¶çº§å‘½åç©ºé—´ï¼Œè¢«ç§°ä¸º â€œvendor namespaceâ€ï¼› å®Œæ•´çš„ç±»åå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­å‘½åç©ºé—´ï¼› å®Œæ•´çš„ç±»åå¿…é¡»æœ‰ä¸€ä¸ªæœ€ç»ˆçš„ç±»åï¼› å®Œæ•´çš„ç±»åä¸­ä»»æ„ä¸€éƒ¨åˆ†ä¸­çš„ä¸‹åˆ’çº¿éƒ½æ˜¯æ²¡æœ‰ç‰¹æ®Šå«ä¹‰çš„ï¼› å®Œæ•´çš„ç±»åå¯ä»¥ç”±ä»»æ„å¤§å°å†™å­—æ¯ç»„æˆï¼› æ‰€æœ‰ç±»åéƒ½å¿…é¡»æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚ å½“æ ¹æ®å®Œæ•´çš„ç±»åè½½å…¥ç›¸åº”çš„æ–‡ä»¶â€¦â€¦ å®Œæ•´çš„ç±»åä¸­ï¼Œå»æ‰æœ€å‰é¢çš„å‘½åç©ºé—´åˆ†éš”ç¬¦ï¼Œå‰é¢è¿ç»­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå‘½åç©ºé—´å’Œå­å‘½åç©ºé—´ï¼Œä½œä¸ºâ€œå‘½åç©ºé—´å‰ç¼€â€ï¼Œå…¶å¿…é¡»ä¸è‡³å°‘ä¸€ä¸ªâ€œæ–‡ä»¶åŸºç›®å½•â€ç›¸å¯¹åº”ï¼› ç´§æ¥å‘½åç©ºé—´å‰ç¼€åçš„å­å‘½åç©ºé—´å¿…é¡»ä¸ç›¸åº”çš„â€æ–‡ä»¶åŸºç›®å½•â€œç›¸åŒ¹é…ï¼Œå…¶ä¸­çš„å‘½åç©ºé—´åˆ†éš”ç¬¦å°†ä½œä¸ºç›®å½•åˆ†éš”ç¬¦ã€‚ æœ«å°¾çš„ç±»åå¿…é¡»ä¸å¯¹åº”çš„ä»¥ .php ä¸ºåç¼€çš„æ–‡ä»¶åŒåã€‚ è‡ªåŠ¨åŠ è½½å™¨ï¼ˆautoloaderï¼‰çš„å®ç°ä¸€å®šä¸èƒ½æŠ›å‡ºå¼‚å¸¸ã€ä¸€å®šä¸èƒ½è§¦å‘ä»»ä¸€çº§åˆ«çš„é”™è¯¯ä¿¡æ¯ä»¥åŠä¸åº”è¯¥æœ‰è¿”å›å€¼ã€‚ ä¾‹å­ä¸‹è¡¨å±•ç¤ºäº†ç¬¦åˆè§„èŒƒå®Œæ•´ç±»åã€å‘½åç©ºé—´å‰ç¼€å’Œæ–‡ä»¶åŸºç›®å½•æ‰€å¯¹åº”çš„æ–‡ä»¶è·¯å¾„ã€‚ å®Œæ•´ç±»å å‘½åç©ºé—´å‰ç¼€ æ–‡ä»¶åŸºç›®å½• æ–‡ä»¶è·¯å¾„ \\Acme\\Log\\Writer\\File_Writer Acme\\Log\\Writer ./acme-log-writer/lib/ ./acme-log-writer/lib/File_Writer.php \\Aura\\Web\\Response\\Status Aura\\Web /path/to/aura-web/src/ /path/to/aura-web/src/Response/Status.php \\Symfony\\Core\\Request Symfony\\Core ./vendor/Symfony/Core/ ./vendor/Symfony/Core/Request.php \\Zend\\Acl Zend /usr/includes/Zend/ /usr/includes/Zend/Acl.php æš‚ä¸”åªä»‹ç»è¿™æ¯”è¾ƒå¸¸ç”¨çš„ä¸‰ä¸ªè§„èŒƒã€‚ æ›´å¤šæœ€æ–°è§„èŒƒå»ºè®®ç‚¹å‡»æŸ¥çœ‹ æœ¬èŠ‚ä¸»è¦ä»‹ç»äº†PHPçš„ç¼–ç è§„èŒƒPSRï¼Œå»ºè®®å¤§å®¶åœ¨å¼€å‘ä¸­å°½é‡éµå¾ªæ­¤è§„èŒƒï¼Œç‰¹åˆ«æ˜¯å›¢é˜Ÿå¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸åº”è¯¥å„è‡ªæœ‰ç€å„è‡ªçš„ç¼–ç é£æ ¼ï¼Œåº”è¯¥å°½å¯èƒ½ç»Ÿä¸€é£æ ¼ã€‚æ­£å¦‚PHP-FIGç»„ç»‡çš„åˆè¡·æ‰€è¯´ï¼Œä»–ä»¬å»ºç«‹çš„è§„èŒƒä¸æ˜¯é™åˆ¶å¤§å®¶çš„ç¼–ç è‡ªç”±ï¼Œåªæ˜¯å¯»æ‰¾å…±æ€§ï¼Œä¸ºäº†æˆ‘ä»¬ä¸€èµ·æ›´å¥½çš„ååŒå·¥ä½œã€‚","categories":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"}],"tags":[{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"}]},{"title":"å¸¸è§æ’åºç®—æ³•","slug":"å¸¸è§æ’åºç®—æ³•","date":"2020-01-31T02:10:09.000Z","updated":"2022-03-31T08:53:17.570Z","comments":true,"path":"2020/01/31/226/","link":"","permalink":"https://github.13sai.com/2020/01/31/226/","excerpt":"","text":"&lt;?php /** * æ’åºç®—æ³•phpå®ç° */ run(); function run() &#123; $array = [31, 54, 6, 15, 76, 8, 35, 3, 100, 31, 45]; //01 å†’æ³¡æ’åº $bubbleSortArray = bubbleSort($array); //02 æ’å…¥æ’åº $insertSortArray = insertSort($array); //03 é€‰æ‹©æ’åº $selectSortArray = selectSort($array); //04 å¸Œå°”æ’åº $shellSortArray = shellSort($array); //05 å †æ’åº $heapSortArray = heapSort($array); //06 å½’å¹¶æ’åº $mergeSortArray = mergeSort($array); //07 å¿«é€Ÿæ’åº $quickSortArray = quickSort($array); echo PHP_EOL.&quot;å†’æ³¡æ’åºï¼š&quot;; var_export($bubbleSortArray); echo PHP_EOL.&quot;æ’å…¥æ’åºï¼š&quot;; var_export($insertSortArray); echo PHP_EOL.&quot;é€‰æ‹©æ’åºï¼š&quot;; var_export($selectSortArray); echo PHP_EOL.&quot;å¸Œå°”æ’åºï¼š&quot;; var_export($shellSortArray); echo PHP_EOL.&quot;å †æ’åºï¼š&quot;; var_export($heapSortArray); echo PHP_EOL.&quot;å½’å¹¶æ’åºï¼š&quot;; var_export($mergeSortArray); echo PHP_EOL.&quot;å¿«é€Ÿæ’åºï¼š&quot;; var_export($quickSortArray); return; &#125; function bubbleSort($array) &#123; /** * 01 å†’æ³¡æ’åº * è¯´æ˜ï¼šå°±æ˜¯ç¬¬ä¸€ä¸ªä½ç½®ä¸Šçš„æ•°ä¸ä»–ç›¸é‚»ç¬¬äºŒä¸ªä½ç½®ä¸Šçš„æ•°æ¯”è¾ƒï¼Œ * å¦‚æœæ¯”ä»–ç›¸é‚»çš„æ•°å°ï¼Œåˆ™ä¸¤è€…äº¤æ¢ä½ç½®ï¼Œå¦åˆ™ä¸äº¤æ¢ã€‚ * æ¥ç€ç¬¬ä¸€ä¸ªä½ç½®ä¸Šçš„æ•°ä¸ç¬¬ä¸‰ä¸ªä½ç½®ä¸Šçš„æ•°æ¯”è¾ƒå¤§å°ï¼Œä¹Ÿæ˜¯å°åˆ™äº¤æ¢ï¼Œ * ä¸€ç›´åˆ°å’Œæœ€åä¸€ä¸ªä½ç½®çš„æ•°æ¯”è¾ƒäº¤æ¢å®Œæ¯•ã€‚ * ç„¶åï¼Œæ˜¯ä¸‹ä¸€ä¸ªå¾ªç¯ï¼Œå°±æ˜¯ç¬¬äºŒä¸ªä½ç½®ä¸Šçš„æ•°é‡å¤ä¸Šé¢çš„æ¯”è¾ƒäº¤æ¢æ“ä½œï¼Œ * ç›´åˆ°æŠŠæ•´ä¸ªæ•°åˆ—å˜æˆæ˜¯ä¸€ä¸ªä»å°åˆ°å¤§çš„æœ‰åºåºåˆ—ã€‚ */ $count = count($array); for ($i = 0; $i &lt; $count; $i++) &#123; for ($j=$i+1; $j&lt;$count; $j++) &#123; if ($array[$i] &gt; $array[$j]) &#123; list($array[$i], $array[$j]) = [$array[$j],$array[$i]]; &#125; &#125; &#125; return $array; &#125; function insertSort($array) &#123; /** * 02 æ’å…¥æ’åº * è¯´æ˜ï¼šä»ä¸€å †å¾…æ’åºçš„æ•°åˆ—ä¸­é€‰å‡ºæ¥ä¸€ä¸ªæœ€å°å€¼(å¯ä»¥è®¤ä¸ºç¬¬ä¸€ä¸ªæ•°å°±æ˜¯å·²æ’åºçš„æ•°åˆ—)ï¼Œ * ç„¶åä»å‰©ä½™çš„å¸¦æ’åºçš„æ•°åˆ—ä¸­é€‰å‡ºæ¥æœ€å°å€¼æœ‰åºæ”¾åˆ°å·²æ’åºçš„æ•°åˆ—ä¸­ï¼Œ * ä¾æ¬¡æ“ä½œï¼Œç›´åˆ°æœ€åçš„æ•°åˆ—éƒ½æ˜¯ä¸€ä¸ªä»å°åˆ°å¤§çš„æœ‰åºæ•°åˆ—ä¸ºæ­¢ */ $count = count($array); for ($i = 1; $i &lt; $count; $i++) &#123; $min = $i; //æ‹¿å‡ºå¾…æ’åºä¸­çš„æœ€å°å€¼ for ($j = $i + 1; $j &lt; $count; $j++) &#123; if ($array[$min] &gt; $array[$j]) &#123; $min = $j; &#125; &#125; //äº¤æ¢ï¼Œè€Œä¸æ˜¯ç›´æ¥èµ‹å€¼ï¼Œå¦åˆ™ä¼šæœ‰æ•°æ®ä¸¢å¤± swap($array[$i], $array[$min]); //æ‹¿å‡ºçš„å€¼æ’å…¥åˆ°å·²æ’åºçš„æ•°åˆ—ä¸­ for ($k=$i-1; $k&gt;=0; $k--) &#123; if ($array[$i] &lt; $array[$k]) &#123; swap($array[$i], $array[$k]); &#125; break; &#125; &#125; return $array; &#125; function selectSort($array) &#123; /** * 03 é€‰æ‹©æ’åº * è¯´æ˜ï¼šä»ä¸€å †å¾…æ’åºçš„æ•°åˆ—ä¸­é€‰å‡ºæ¥ä¸€ä¸ªæœ€å°å€¼ï¼Œæ”¾åˆ°æ–°çš„æ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œ * ç»§ç»­ä»å‰©ä½™çš„æ•°åˆ—ä¸­é€‰å–æœ€å°å€¼æ”¾å…¥åˆ°æ•°ç»„ä¸­ï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œå°†æ•°å­—éƒ½å–å‡ºæ¥æ’æˆæ–°çš„æœ‰åºæ•°åˆ— */ $count = count($array); $newArr = array(); for ($i=0; $i&lt; $count; $i++) &#123; $min = selectSortChild($array); // var_dump($min); $newArr[$i] = $array[$min]; unset($array[$min]); //unsetåº•å±‚æºç åªæ˜¯å°†minå…ƒç´ æŒ‡é’ˆæŒ‡å‘äº†nullï¼Œæ‰€ä»¥éœ€è¦ä¸‹é¢çš„æ“ä½œï¼Œå¦åˆ™æ’åºç»“æœåå‡ é¡¹éƒ½æ˜¯NULL $array = array_merge($array, []); &#125; return $newArr; &#125; //é€‰æ‹©æ’åºå­å‡½æ•° function selectSortChild($array) &#123; $count = count($array); $min = 0; //æ‹¿å‡ºå¸¦æ’åºä¸­çš„æœ€å°å€¼ for($j = 1; $j &lt; $count; $j++) &#123; if($array[$min] &gt; $array[$j]) &#123; $min = $j; &#125; &#125; return $min; &#125; //04 å¸Œå°”æ’åº function shellSort($array) &#123; /** * 04 å¸Œå°”æ’åº * è¯´æ˜ï¼šæ’å…¥æ’åºçš„ä¸€ç§æ”¹è¿›ï¼Œ * å…ˆæ¯”è¾ƒä¸€å®šè·ç¦»çš„å…ƒç´ æˆä¸ºæœ‰åºæ•°åˆ—ï¼Œå†æ¯”è¾ƒç¼©å°å¢é‡è·ç¦»çš„å…ƒç´ (å¯ä¸ºå…ƒç´ çš„æ•°é‡çš„ä¸€åŠ)ï¼Œ * ä¸€ç›´åˆ°æ¯”è¾ƒçš„æ˜¯ç›¸é‚»å…ƒç´ çš„æ—¶å€™ï¼Œå°±æˆä¸ºäº†æ’å…¥æ’åºã€‚ */ //ä¸‰å±‚å¾ª $count = count($array); for ($loop = floor($count); $loop &gt; 0; $loop = floor($loop/2)) &#123; for ($i=$loop; $i&lt;$count; $i++) &#123; for ($j=$i-$loop; $j&gt;=0 &amp;&amp; $array[$j] &gt; $array[$j+$loop]; $j = $j-$loop) &#123; swap($array[$j], $array[$j+$loop]); &#125; &#125; &#125; return $array; &#125; //05 å †æ’åº function heapSort($array) &#123; /** * 05 å †æ’åº è¯´æ˜ï¼š * 1) æ„é€ å¤§é¡¶å † * 2ï¼‰äº¤æ¢å †é¡¶å’Œå †åº• * 3)é‡å¤å‰é¢çš„æ­¥éª¤å‡åºæ’åˆ—å®Œæˆ */ $count = count($array); //1. æ„é€ å¤§é¡¶å † for ($i=floor($count/2) - 1; $i&gt;=0; $i--) &#123; adjustHeap($array, $i, $count); &#125; //2. æ’åº for ($j=$count-1; $j&gt;=0; $j--) &#123; swap($array[0], $array[$j]); adjustHeap($array, 0, $j); &#125; return $array; &#125; //å †æ’åºå­å‡½æ•° function adjustHeap(&amp;$array, $i, $length) &#123; if($i&lt;0) return false; $tmp = $array[$i]; for ($j=$i*2+1; $j&lt;$length; $j=$j*2+1) &#123; if ($j+1&lt; $length &amp;&amp; $array[$j] &lt; $array[$j+1])//å³å­èŠ‚ç‚¹æ¯”å·¦å­èŠ‚ç‚¹å¤§ï¼Œåˆ™jæŒ‡å‘å³å­èŠ‚ç‚¹ $j++; if ($array[$j] &gt; $tmp) &#123; //å­èŠ‚ç‚¹æ¯”çˆ¶èŠ‚ç‚¹å¤§ï¼Œåˆ™å°†å­èŠ‚ç‚¹çš„å€¼èµ‹ç»™çˆ¶èŠ‚ç‚¹(ä¸ç”¨äº¤æ¢) $array[$i] = $array[$j]; $i = $j; &#125; else &#123; break; &#125; &#125; $array[$i] = $tmp;//å®ç°äº¤æ¢(iæœ‰å˜åŒ–æ—¶) &#125; //06 å½’å¹¶æ’åº function mergeSort($array) &#123; /** * 06 å½’å¹¶æ’åº * è¯´æ˜ï¼šå°†å¾…æ’åºçš„æ•°åˆ—çœ‹æˆæ˜¯å•ä¸ªçš„æœ‰åºçš„æ•°åˆ—ï¼Œ * ç„¶åè¿›è¡Œåˆå¹¶ï¼Œç›´åˆ°åˆå¹¶æˆæœ€åçš„å®Œæ•´æœ‰åºçš„æ•°åˆ— */ //1.è¿›è¡Œå½’å¹¶ $length = count($array); for ($gap = 1; $gap&lt;$length; $gap = $gap*2) &#123; mergePass($array, $gap, $length); &#125; return $array; &#125; //å½’å¹¶æ’åºå­å‡½æ•°1--åˆå¹¶ function mergePass (&amp;$array, $gap, $length) &#123; //1. å½’å¹¶é•¿åº¦æ˜¯gapçš„ç›¸é‚»ä¸¤ä¸ªå­è¡¨ for ($i=0; $i+2*$gap-1&lt;$length; $i=$i+2*$gap) &#123; merge($array, $i, $i+$gap-1, $i+2*$gap-1); &#125; //2. ä½™ä¸‹çš„ä¸¤ä¸ªå­—è¡¨åˆå¹¶ï¼Œåè€…çš„é•¿åº¦å°äºgap if ($i+$gap-1 &lt; $length) &#123; merge($array, $i, $i+$gap-1, $length-1); &#125; &#125; //å½’å¹¶æ’åºå­å‡½æ•°2--åˆå¹¶ä¸¤ä¸ªæœ‰åºåºåˆ— function merge(&amp;$array, $low, $mid, $high) &#123; $i = $low;//ç¬¬ä¸€æ®µåºåˆ—çš„ä¸‹æ ‡ $j = $mid + 1;//ç¬¬äºŒæ®µåºåˆ—çš„ä¸‹æ ‡ $k = 0; $arrayNew = array();//æ–°çš„ä¸´æ—¶åˆå¹¶æ•°ç»„ //æ‰«æç¬¬ä¸€æ®µåºåˆ—å’Œç¬¬äºŒæ®µåºåˆ—ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªåºåˆ—æ‰«æå®Œæ¯• while ($i&lt;=$mid &amp;&amp; $j&lt;=$high) &#123; //æ¯”è¾ƒä¸¤ä¸ªåˆå¹¶çš„æ•°ç»„ï¼Œå°çš„æ”¾åˆ°æ–°çš„ä¸´æ—¶åˆå¹¶æ•°ç»„ä¸­ if ($array[$i] &gt; $array[$j]) &#123; $arrayNew[$k] = $array[$j]; $k++; $j++; &#125; else &#123; $arrayNew[$k] = $array[$i]; $k++; $i++; &#125; &#125; //æ•°ç»„1ä¸­æœ‰æ²¡æ‰«æçš„å…ƒç´ ï¼Œç›´æ¥å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ while ($i &lt;= $mid) &#123; $arrayNew[$k] = $array[$i]; $k++; $i++; &#125; //æ•°ç»„2ä¸­æœ‰æ²¡æ‰«æçš„å…ƒç´ ï¼Œç›´æ¥å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ while ($j &lt;= $high) &#123; $arrayNew[$k] = $array[$j]; $k++; $j++; &#125; //å°†åˆå¹¶æ–°æ•°ç»„å¤åˆ¶åˆ°åŸæ•°ç»„ä¸­ for ($i=$low,$k=0; $i&lt;=$high; $i++,$k++) &#123; $array[$i] = $arrayNew[$k]; &#125; &#125; //äº¤æ¢æ•°æ® function swap (&amp;$a, &amp;$b) &#123; $res = $a; $a = $b; $b = $res; &#125; function quickSort($array) &#123; // åˆ¤æ–­æ˜¯å¦éœ€è¦è¿è¡Œï¼Œå› ä¸‹é¢å·²æ‹¿å‡ºä¸€ä¸ªä¸­é—´å€¼ï¼Œè¿™é‡Œ&lt;=1 if (count($array) &lt;= 1) &#123; return $array; &#125; $middle = $array[0]; // ä¸­é—´å€¼ $left = []; // æ¥æ”¶å°äºä¸­é—´å€¼ $right = [];// æ¥æ”¶å¤§äºä¸­é—´å€¼ $equal = []; $equal[] = $middle; // å¾ªç¯æ¯”è¾ƒ for ($i=1; $i &lt; count($array); $i++) &#123; if ($middle == $array[$i]) &#123; $equal[] = $array[$i]; &#125; elseif ($middle &lt; $array[$i]) &#123; $right[] = $array[$i]; &#125; else &#123; $left[] = $array[$i]; &#125; &#125; // é€’å½’æ’åºåˆ’åˆ†å¥½çš„2è¾¹ $left = quickSort($left); $right = quickSort($right); // åˆå¹¶æ’åºåçš„æ•°æ®ï¼Œåˆ«å¿˜äº†åˆå¹¶ä¸­é—´å€¼ return array_merge($left, $equal, $right); &#125;","categories":[{"name":"algorithm","slug":"algorithm","permalink":"https://github.13sai.com/categories/algorithm/"}],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://github.13sai.com/tags/algorithm/"}]},{"title":"Redisä½¿ç”¨scanæ›¿æ¢keys","slug":"Redisä½¿ç”¨scanæ›¿æ¢keys","date":"2020-01-26T06:49:45.000Z","updated":"2022-03-19T14:35:21.638Z","comments":true,"path":"2020/01/26/225/","link":"","permalink":"https://github.13sai.com/2020/01/26/225/","excerpt":"","text":"æˆ‘ä»¬éƒ½çŸ¥é“æŸ¥æ‰¾Redisçš„é”®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨keys patternï¼Œä½†å½“keyå¤ªå¤šæ—¶ï¼Œkeyså‘½ä»¤çš„æ•ˆç‡å°±å¾ˆä½ï¼Œå¦‚æœåœ¨çº¿ä¸Šç›´æ¥ä½¿ç”¨ï¼Œç”šè‡³å¯èƒ½å‘ç”Ÿç”Ÿäº§äº‹æ•…ï¼Œè¿™æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å¦¨ä½¿ç”¨scanå‘½ä»¤ã€‚ SCAN å‘½ä»¤æ˜¯ä¸€ä¸ªåŸºäºæ¸¸æ ‡çš„è¿­ä»£å™¨ï¼ˆcursor based iteratorï¼‰ï¼š SCAN å‘½ä»¤æ¯æ¬¡è¢«è°ƒç”¨ä¹‹åï¼Œ éƒ½ä¼šå‘ç”¨æˆ·è¿”å›ä¸€ä¸ªæ–°çš„æ¸¸æ ‡ï¼Œ ç”¨æˆ·åœ¨ä¸‹æ¬¡è¿­ä»£æ—¶éœ€è¦ä½¿ç”¨è¿™ä¸ªæ–°æ¸¸æ ‡ä½œä¸º SCAN å‘½ä»¤çš„æ¸¸æ ‡å‚æ•°ï¼Œ ä»¥æ­¤æ¥å»¶ç»­ä¹‹å‰çš„è¿­ä»£è¿‡ç¨‹ã€‚å½“ SCAN å‘½ä»¤çš„æ¸¸æ ‡å‚æ•°è¢«è®¾ç½®ä¸º 0 æ—¶ï¼Œ æœåŠ¡å™¨å°†å¼€å§‹ä¸€æ¬¡æ–°çš„è¿­ä»£ï¼Œ è€Œå½“æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›å€¼ä¸º 0 çš„æ¸¸æ ‡æ—¶ï¼Œ è¡¨ç¤ºè¿­ä»£å·²ç»“æŸã€‚ ç”Ÿæˆkey&lt;?php // ç”Ÿæˆ1000ä¸ª $redis = new \\Redis(); $redis-&gt;connect(&#x27;127.0.0.1&#x27;, 6379, 10); $redis-&gt;select(2); $arr = [ &#x27;rwer&#x27;, &#x27;24erw&#x27;, &#x27;rterq4&#x27;, &#x27;sdgfd5&#x27;, &#x27;dgsdg&#x27;, &#x27;sfst&#x27;, ]; for ($i=0; $i&lt;1000; $i++) &#123; $redis-&gt;set(md5($i.$arr[$i%6]), md5($arr[$i%6].&#x27;sdfsd&#x27;)); &#125; echo &quot;OK&quot;.PHP_EOL; keysæŸ¥çœ‹ä¸ªæ•°keys c* scanéå†&lt;?php $redis = new \\Redis(); $redis-&gt;connect(&#x27;127.0.0.1&#x27;, 6379, 10); $redis-&gt;select(2); $iterator = null; // éå†å‰ç¼€ $pattern = &#x27;c*&#x27;; $count = 100; // åŠ¡å¿…è®¾ç½®ï¼Œå¦‚æœæ²¡æ‰«æåˆ°ï¼Œç»§ç»­æ‰«æï¼Œè€Œä¸æ˜¯è¿”å›ç©ºï¼Œå¦åˆ™whileç›´æ¥é€€å‡ºï¼Œéå†å°±ä¼šä¸å‡†ç¡® $redis-&gt;setOption(\\Redis::OPT_SCAN, \\Redis::SCAN_RETRY); $total = []; $i = 0; // $countå¯ä»¥ä¸è®¾ç½®ï¼Œéå¿…éœ€å‚æ•° while($arr = $redis-&gt;scan($iterator, $pattern, $count)) &#123; $arrVal = $redis-&gt;mget($arr); $ret = array_combine($arr, $arrVal); $total = array_merge($total, $ret); $i++; &#125; // var_dump($total); var_dump($i); echo count($total).PHP_EOL; å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨\\Redis::OPT_SCAN, \\Redis::SCAN_RETRYè¿™ä¸¤ä¸ªå‚æ•°ï¼Œè‡ªè¡Œå¾ªç¯ï¼Œåˆ¤æ–­è¿”å›å€¼æ˜¯ä¸æ˜¯falseï¼Œä¹Ÿèƒ½éå†æˆåŠŸã€‚","categories":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/categories/redis/"}],"tags":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/tags/redis/"}]},{"title":"Laravelé…åˆJWT","slug":"Laravelé…åˆJWT","date":"2020-01-20T10:07:42.000Z","updated":"2022-07-05T08:54:33.400Z","comments":true,"path":"2020/01/20/224/","link":"","permalink":"https://github.13sai.com/2020/01/20/224/","excerpt":"","text":"æµ‹è¯•ä½¿ç”¨çš„æ˜¯Laravel5.5ç‰ˆæœ¬ã€‚ å®‰è£…composer require tymon/jwt-auth=1.0.0-rc.5 é…ç½®ç”Ÿæˆé…ç½®php artisan vendor:publish --provider=&quot;Tymon\\JWTAuth\\Providers\\LaravelServiceProvider&quot; php artisan jwt:secret authé…ç½®&lt;?php return [ ... &#x27;defaults&#x27; =&gt; [ &#x27;guard&#x27; =&gt; &#x27;web&#x27;, &#x27;passwords&#x27; =&gt; &#x27;users&#x27;, ], &#x27;guards&#x27; =&gt; [ &#x27;web&#x27; =&gt; [ &#x27;driver&#x27; =&gt; &#x27;session&#x27;, &#x27;provider&#x27; =&gt; &#x27;users&#x27;, ], // ä½¿ç”¨jwt &#x27;api&#x27; =&gt; [ &#x27;driver&#x27; =&gt; &#x27;jwt&#x27;, &#x27;provider&#x27; =&gt; &#x27;apiUser&#x27;, ], ], &#x27;providers&#x27; =&gt; [ ... // æŒ‡å®šmodel &#x27;apiUser&#x27; =&gt; [ &#x27;driver&#x27; =&gt; &#x27;eloquent&#x27;, &#x27;model&#x27; =&gt; App\\ApiUser::class, ], ], ]; ç¼–ç æ§åˆ¶å™¨ï¼š &lt;?php namespace App\\Http\\Controllers\\Api; use App\\ApiUser; use App\\Http\\Controllers\\Controller; use Illuminate\\Http\\Request; use Tymon\\JWTAuth\\Facades\\JWTAuth; class AuthController extends Controller &#123; /** * ä¸­é—´ä»¶å»é™¤loginå’Œrefresh * * @return void */ public function __construct() &#123; $this-&gt;middleware(&#x27;auth:api&#x27;, [&#x27;except&#x27; =&gt; [&#x27;login&#x27;,&#x27;refresh&#x27;]]); &#125; /** * Get a JWT via given credentials. * * @return \\Illuminate\\Http\\JsonResponse */ public function login(Request $request) &#123; $credentials = $request-&gt;only(&#x27;phone&#x27;, &#x27;password&#x27;); if (count($credentials) &lt; 2) &#123; return response()-&gt;json([&#x27;error&#x27; =&gt; &#x27;Unauthorized&#x27;], 401); &#125; $user = ApiUser::where(&#x27;phone&#x27;, $credentials[&#x27;phone&#x27;]) -&gt;where(&#x27;password&#x27;, md5($credentials[&#x27;password&#x27;])) -&gt;first(); if (empty($user) || !$token = JWTAuth::fromUser($user)) &#123; return response()-&gt;json([&#x27;error&#x27; =&gt; &#x27;Unauthorized&#x27;], 401); &#125; // dd($token); return $this-&gt;respondWithToken($token); &#125; /** * Get the authenticated User. * * @return \\Illuminate\\Http\\JsonResponse */ public function me() &#123; return response()-&gt;json(auth(&#x27;api&#x27;)-&gt;user()); &#125; /** * Log the user out (Invalidate the token). * * @return \\Illuminate\\Http\\JsonResponse */ public function logout() &#123; auth()-&gt;logout(); return response()-&gt;json([&#x27;message&#x27; =&gt; &#x27;Successfully logged out&#x27;]); &#125; /** * Refresh a token. * * @return \\Illuminate\\Http\\JsonResponse */ public function refresh() &#123; return $this-&gt;respondWithToken(auth(&#x27;api&#x27;)-&gt;refresh()); &#125; /** * Get the token array structure. * * @param string $token * * @return \\Illuminate\\Http\\JsonResponse */ protected function respondWithToken($token) &#123; return response()-&gt;json([ &#x27;access_token&#x27; =&gt; $token, &#x27;token_type&#x27; =&gt; &#x27;bearer&#x27;, &#x27;expires_in&#x27; =&gt; auth(&#x27;api&#x27;)-&gt;factory()-&gt;getTTL() * 60 ]); &#125; &#125; è·¯ç”±ï¼š æ­¤å¤„æ³¨æ„ï¼Œæˆ‘ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œä½¿ç”¨äº†getæ–¹æ³•ï¼Œç”Ÿäº§ç¯å¢ƒä¸å»ºè®®ä½¿ç”¨getã€‚ // routes/api.php Route::middleware(&#x27;api&#x27;)-&gt;prefix(&#x27;auth&#x27;)-&gt;namespace(&#x27;Api&#x27;)-&gt;group(function () &#123; Route::get(&#x27;login&#x27;, &#x27;AuthController@login&#x27;); Route::post(&#x27;logout&#x27;, &#x27;AuthController@logout&#x27;); Route::get(&#x27;refresh&#x27;, &#x27;AuthController@refresh&#x27;); Route::get(&#x27;me&#x27;, &#x27;AuthController@me&#x27;); &#125;); æµ‹è¯•ä¸€ä¸‹: unauthenticatedå¤„ç†è¿™é‡Œéœ€è¦æ³¨æ„ä¸‹ï¼Œunauthenticatedå¤„ç†ä¸€ä¸‹æ¯”è¾ƒå¥½ï¼Œå¦åˆ™ä¼šé»˜è®¤è·³è½¬loginç™»å½•é¡µé¢ã€‚ &lt;?php namespace App\\Exceptions; use Exception; use Illuminate\\Foundation\\Exceptions\\Handler as ExceptionHandler; use Illuminate\\Auth\\AuthenticationException; class Handler extends ExceptionHandler &#123; ... protected function unauthenticated($request, AuthenticationException $exception) &#123; return response()-&gt;json([&#x27;message&#x27; =&gt; &#x27;Unauthenticated.&#x27;], 401); /*éapiå¯ä»¥è¿™ä¹ˆå¤„ç† return $request-&gt;expectsJson() ? response()-&gt;json([&#x27;message&#x27; =&gt; &#x27;Unauthenticated.&#x27;], 401) : redirect()-&gt;guest(route(&#x27;login&#x27;)); */ &#125; &#125; åŠ å…¥token refreshåŠ å…¥ä¸­é—´ä»¶ä»£ç ï¼š &lt;?php namespace App\\Http\\Middleware; use Closure; use Tymon\\JWTAuth\\Facades\\JWTAuth; use Tymon\\JWTAuth\\Exceptions\\JWTException; use Illuminate\\Auth\\AuthenticationException; use Tymon\\JWTAuth\\Exceptions\\TokenExpiredException; use Illuminate\\Http\\Exceptions\\HttpResponseException; use Tymon\\JWTAuth\\Http\\Middleware\\BaseMiddleware; class RefreshToken extends BaseMiddleware &#123; /** * Handle an incoming request. * * @param \\Illuminate\\Http\\Request $request * @param \\Closure $next * @return mixed */ public function handle($request, Closure $next) &#123; try&#123; //æ£€æŸ¥è¯·æ±‚ä¸­æ˜¯å¦å¸¦æœ‰token å¦‚æœæ²¡æœ‰tokenå€¼åˆ™æŠ›å‡ºå¼‚å¸¸ $this-&gt;checkForToken($request); if ($request-&gt;user = JWTAuth::parseToken()-&gt;authenticate()) &#123; return $next($request); &#125; throw new AuthenticationException(&#x27;Unauthorized&#x27;, []); &#125;catch (TokenExpiredException $exception)&#123; //è¿”å›ç‰¹æ®Šçš„code throw new HttpResponseException(response()-&gt;json([ &#x27;message&#x27; =&gt; &#x27;token expired&#x27; ])); &#125; catch (\\Exception $exception) &#123; throw new AuthenticationException(&#x27;Unauthorized&#x27;, []); &#125; &#125; &#125; æ³¨å†Œï¼š &lt;?php namespace App\\Http; use Illuminate\\Foundation\\Http\\Kernel as HttpKernel; class Kernel extends HttpKernel &#123; ... protected $routeMiddleware = [ &#x27;token.refresh&#x27; =&gt; \\App\\Http\\Middleware\\RefreshToken::class, &#x27;auth.basic&#x27; =&gt; \\Illuminate\\Auth\\Middleware\\AuthenticateWithBasicAuth::class, &#x27;bindings&#x27; =&gt; \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class, &#x27;can&#x27; =&gt; \\Illuminate\\Auth\\Middleware\\Authorize::class, &#x27;guest&#x27; =&gt; \\App\\Http\\Middleware\\RedirectIfAuthenticated::class, &#x27;throttle&#x27; =&gt; \\Illuminate\\Routing\\Middleware\\ThrottleRequests::class, ]; &#125; ç›¸åº”çš„æ§åˆ¶å™¨æ„é€ å‡½æ•°ä¿®æ”¹ï¼š public function __construct() &#123; $this-&gt;middleware(&#x27;token.refresh&#x27;, [&#x27;except&#x27; =&gt; [&#x27;login&#x27;,&#x27;refresh&#x27;]]); &#125; æŠŠtokenæ—¶é—´è®¾ç½®æˆ1åˆ†é’Ÿï¼Œæµ‹è¯•ä¸€ä¸‹ã€‚ å¯ä»¥æ ¹æ®apiè¿”å›ï¼Œå»è°ƒç”¨åˆ·æ–°æ¥å£ã€‚ ç®€å•ä½¿ç”¨å°±æ˜¯è¿™æ ·å•¦ã€‚æ›´å¤šä½¿ç”¨å¯ä»¥çœ‹ä¸‹ç«™å†…å…¶ä»–æ–‡ç« ï¼šJWT å®Œæ•´ä½¿ç”¨è¯¦è§£jwt-authæ–‡æ¡£","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"},{"name":"jwt","slug":"jwt","permalink":"https://github.13sai.com/tags/jwt/"}]},{"title":"Laravelç»Ÿä¸€é”™è¯¯å¤„ç†","slug":"Laravelç»Ÿä¸€é”™è¯¯å¤„ç†","date":"2020-01-20T05:54:24.000Z","updated":"2022-03-19T14:35:21.602Z","comments":true,"path":"2020/01/20/223/","link":"","permalink":"https://github.13sai.com/2020/01/20/223/","excerpt":"","text":"Laravelä¸­çš„App\\Exceptions\\Handler ç±»è´Ÿè´£è®°å½•åº”ç”¨ç¨‹åºè§¦å‘çš„æ‰€æœ‰å¼‚å¸¸ï¼Œè¿™åœ¨æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­ååˆ†æ–¹ä¾¿ï¼Œæ€»æ˜¯tryâ€¦catchä½¿ä»£ç å¤ªè¿‡ç¹çä¸”å¯è¯»æ€§å¤§å¤§é™ä½ï¼Œé‚£ä¹ˆæ€ä¹ˆä½¿ç”¨å®ƒå¤„ç†å¼‚å¸¸ä¸ºjsonå‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªclassï¼Œç”¨æ¥å¤„ç†å¼‚å¸¸è¿”å›ã€‚ &lt;?php /** * Author: sai * Date: 2020/1/15 * Time: 14:31 */ namespace App\\Exceptions; class ApiException extends \\Exception &#123; const ERROR_CODE = 1001; const ERROR_MSG = &#x27;ApiException&#x27;; private $data = []; /** * BusinessException constructor. * * @param string $message * @param string $code * @param array $data */ public function __construct(string $message, string $code, $data = []) &#123; $this-&gt;code = $code ? : self::ERROR_CODE; $this-&gt;message = $message ? : self::ERROR_MSG; $this-&gt;data = $data; &#125; /** * @return array */ public function getData() &#123; return $this-&gt;data; &#125; /** * å¼‚å¸¸è¾“å‡º */ public function render($request) &#123; return response()-&gt;json([ &#x27;data&#x27; =&gt; $this-&gt;getData(), &#x27;code&#x27; =&gt; $this-&gt;getCode(), &#x27;messgae&#x27; =&gt; $this-&gt;getMessage(), ], 200); &#125; &#125; ç„¶åæˆ‘ä»¬åœ¨HandleråŠ å…¥ï¼ŒåŠ å…¥$dontReportï¼Œä¾¿ä¸ä¼šä½¿ç”¨è‡ªå¸¦çš„é”™è¯¯å¤„ç†ï¼Œè€Œä½¿ç”¨è‡ªå®šä¹‰çš„å¤„ç†ã€‚ &lt;?php namespace App\\Exceptions; use Exception; use Illuminate\\Foundation\\Exceptions\\Handler as ExceptionHandler; class Handler extends ExceptionHandler &#123; /** * ä¸€äº›ä¸éœ€ç®¡æˆ–ä¸éœ€è¦æŠ›å‡ºçš„å¼‚å¸¸ */ protected $dontReport = [ ApiException::class, ]; ... &#125; æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ï¼š &lt;?php namespace App\\Http\\Controllers; use App\\Exceptions\\ApiException; use Illuminate\\Http\\Request; class HomeController extends Controller &#123; public function index(Request $request) &#123; throw new ApiException(&#x27;error&#x27;, 10001, [&#x27;oh&#x27; =&gt; &#x27;no&#x27;]); return 1; &#125; &#125; æŸ¥çœ‹è¾“å‡ºï¼š æµ‹è¯•okï¼Œæˆ‘ä»¬å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨å•¦ã€‚å½“ç„¶ï¼Œå…¶ä»–å½¢å¼çš„é”™è¯¯è¾“å‡ºå¯ä»¥è‡ªè¡Œæ‰©å±•ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"}]},{"title":"ElementUIæ•´åˆç¼–è¾‘å™¨vue-quill-editor","slug":"ElementUIæ•´åˆç¼–è¾‘å™¨vue-quill-editor","date":"2020-01-08T10:13:38.000Z","updated":"2022-03-19T14:35:21.584Z","comments":true,"path":"2020/01/08/222/","link":"","permalink":"https://github.13sai.com/2020/01/08/222/","excerpt":"","text":"ç›´æ¥ä¸Šä»£ç ï¼š main.js import VueQuillEditor from &#x27;vue-quill-editor&#x27; import &#x27;quill/dist/quill.core.css&#x27; import &#x27;quill/dist/quill.snow.css&#x27; import &#x27;quill/dist/quill.bubble.css&#x27; Vue.use(VueQuillEditor) template: ... &lt;el-form-item label=&quot;è¯¦æƒ…&quot; prop=&quot;content&quot;&gt; &lt;quill-editor v-model=&quot;form.remark&quot; ref=&quot;myQuillEditor&quot; :options=&quot;editorOption&quot; @blur=&quot;onEditorBlur($event)&quot; @focus=&quot;onEditorFocus($event)&quot; @change=&quot;onEditorChange($event)&quot;&gt; &lt;/quill-editor&gt; &lt;/el-form-item&gt; &lt;div style=&quot;display:none;&quot;&gt; &lt;el-upload class=&quot;edit-uploader&quot; :action=&quot;uploadPicUrl&quot; :show-file-list=&quot;false&quot; :headers=&quot;header&quot; :on-success=&quot;editorUploadSuccess&quot; :on-error=&quot;editorUploadError&quot; :before-upload=&quot;beforeEditorUpload&quot; &gt; &lt;i class=&quot;el-icon-plus avatar-uploader-icon&quot; ref=&quot;aUpload&quot;&gt;&lt;/i&gt; &lt;/el-upload&gt; &lt;/div&gt; ... &lt;script&gt; export default &#123; data() &#123; return &#123; editorOption: &#123; modules: &#123; toolbar: &#123;container:[ [&#x27;bold&#x27;, &#x27;italic&#x27;, &#x27;underline&#x27;, &#x27;strike&#x27;], [&#x27;blockquote&#x27;, &#x27;code-block&#x27;], [&#123; &#x27;header&#x27;: 1 &#125;, &#123; &#x27;header&#x27;: 2 &#125;], [&#123; &#x27;list&#x27;: &#x27;ordered&#x27; &#125;, &#123; &#x27;list&#x27;: &#x27;bullet&#x27; &#125;], [&#123; &#x27;script&#x27;: &#x27;sub&#x27; &#125;, &#123; &#x27;script&#x27;: &#x27;super&#x27; &#125;], [&#123; &#x27;indent&#x27;: &#x27;-1&#x27; &#125;, &#123; &#x27;indent&#x27;: &#x27;+1&#x27; &#125;], [&#123; &#x27;direction&#x27;: &#x27;rtl&#x27; &#125;], [&#123; &#x27;size&#x27;: [&#x27;small&#x27;, false, &#x27;large&#x27;, &#x27;huge&#x27;] &#125;], [&#123; &#x27;header&#x27;: [1, 2, 3, 4, 5, 6, false] &#125;], [&#123; &#x27;font&#x27;: [] &#125;], [&#123; &#x27;color&#x27;: [] &#125;, &#123; &#x27;background&#x27;: [] &#125;], [&#123; &#x27;align&#x27;: [] &#125;], [&#x27;clean&#x27;], [&#x27;link&#x27;, &#x27;image&#x27;] ], handlers: &#123; &#x27;image&#x27;: function(value) &#123; if (value) &#123; document.querySelector(&#x27;.edit-uploader input&#x27;).click() &#125; else &#123; this.quill.format(&#x27;image&#x27;, false); &#125; // this.$refs.aUpload.click() //è‡ªå®šä¹‰å›¾ç‰‡ä¸Šä¼ å›è°ƒ &#125; &#125; &#125;, syntax: &#123; highlight: text =&gt; hljs.highlightAuto(text).value &#125; &#125;, &#125; &#125; &#125;, methods: &#123; onEditorReady(editor) &#123; // å‡†å¤‡ç¼–è¾‘å™¨ &#125;, onEditorBlur()&#123;&#125;, // å¤±å»ç„¦ç‚¹äº‹ä»¶ onEditorFocus()&#123;&#125;, // è·å¾—ç„¦ç‚¹äº‹ä»¶ onEditorChange()&#123;&#125;, // å†…å®¹æ”¹å˜äº‹ä»¶ beforeEditorUpload() &#123; // æ˜¾ç¤ºloadingåŠ¨ç”» this.quillUpdateImg = true &#125;, editorUploadSuccess(res, file) &#123; // è·å–å¯Œæ–‡æœ¬ç»„ä»¶å®ä¾‹ let quill = this.$refs.myQuillEditor.quill // å¦‚æœä¸Šä¼ æˆåŠŸ if (res.code === 0) &#123; // è·å–å…‰æ ‡æ‰€åœ¨ä½ç½® let length = quill.getSelection().index; // æ’å…¥å›¾ç‰‡ res.infoä¸ºæœåŠ¡å™¨è¿”å›çš„å›¾ç‰‡åœ°å€ quill.insertEmbed(length, &#x27;image&#x27;, res.data.filepath) // è°ƒæ•´å…‰æ ‡åˆ°æœ€å quill.setSelection(length + 1) &#125; else &#123; this.$message.error(&#x27;å›¾ç‰‡æ’å…¥å¤±è´¥&#x27;) &#125; // loadingåŠ¨ç”»æ¶ˆå¤± this.quillUpdateImg = false &#125;, // å¯Œæ–‡æœ¬å›¾ç‰‡ä¸Šä¼ å¤±è´¥ editorUploadError() &#123; // loadingåŠ¨ç”»æ¶ˆå¤± this.quillUpdateImg = false this.$message.error(&#x27;å›¾ç‰‡æ’å…¥å¤±è´¥&#x27;) &#125; &#125; &#125; &lt;/script&gt; è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¼–è¾‘å™¨é»˜è®¤ä½¿ç”¨base64ä¸Šä¼ ï¼Œæˆ‘ä»¬ä½¿ç”¨elementuiçš„ä¸Šä¼ ç»„ä»¶æ›¿æ¢æ‰åŸæ¥çš„å›¾ç‰‡ä¸Šä¼ ã€‚","categories":[{"name":"vue","slug":"vue","permalink":"https://github.13sai.com/categories/vue/"}],"tags":[{"name":"ElementUI","slug":"ElementUI","permalink":"https://github.13sai.com/tags/ElementUI/"}]},{"title":"javascriptç­¾åç›´ä¼ OSS","slug":"javascriptç­¾åç›´ä¼ OSS","date":"2020-01-08T10:13:07.000Z","updated":"2022-07-05T08:51:15.451Z","comments":true,"path":"2020/01/08/221/","link":"","permalink":"https://github.13sai.com/2020/01/08/221/","excerpt":"","text":"æœ€è¿‘åœ¨å†™åå°ä»£ç ï¼Œä½¿ç”¨çš„æ˜¯VUE+ElementUIï¼Œè¸©äº†ä¸€äº›å‘åˆ†äº«ä¸€ä¸‹ã€‚ åŸç†ï¼šä»æœåŠ¡ç«¯è·å–ç­¾åï¼Œjsç›´æ¥ä¸Šä¼ é˜¿é‡Œäº‘OSSæœåŠ¡å™¨ã€‚ elementuiä¸»è¦ä»£ç  template: &lt;el-form-item label=&quot;ä¸Šä¼ å›¾ç‰‡&quot; prop=&quot;video&quot;&gt; &lt;el-upload id=&quot;video&quot; action :data=&quot;aliyunOssToken&quot; :http-request=&quot;uploadVideo&quot; :headers=&quot;header&quot;&gt; &lt;img v-if=&quot;form.cover&quot; :src=&quot;form.cover&quot;&gt; &lt;el-button class=&quot;avatar-uploader-icon&quot; type=&quot;primary&quot;&gt;ä¸Šä¼ &lt;/el-button&gt; &lt;/el-upload&gt; &lt;/el-form-item&gt; scriptï¼š upload(file)&#123; var _self = this; let imgType = file.file.type.split(&quot;/&quot;)[1].toLowerCase(); if (imgType != &#x27;jpg&#x27; &amp;&amp; imgType != &#x27;png&#x27;) &#123; this.$message.error(&#x27;è¯·ä¸Šä¼ å›¾ç‰‡ç±»å‹&#x27;); return; &#125; getOSSToken().then(function(res)&#123; _self.aliyunOssToken = res.data; var ossData = &#123;&#125;; //keyå°±ä»£è¡¨æ–‡ä»¶å±‚çº§å’Œé˜¿é‡Œäº‘ä¸Šçš„æ–‡ä»¶å let imgType = file.file.type.split(&quot;/&quot;)[1]; let filename = file.file.name + file.file.size; //md5å¯¹å›¾ç‰‡åç§°è¿›è¡ŒåŠ å¯† let keyValue = &quot;images/&quot; + md5(new Date() + filename) + &quot;.&quot; + imgType; // ç»„è£…formdata let formdata = new FormData(); formdata.append(&#x27;name&#x27;, file.file.name) formdata.append(&#x27;key&#x27;, keyValue) formdata.append(&#x27;policy&#x27;, _self.aliyunOssToken.policy) formdata.append(&#x27;OSSAccessKeyId&#x27;, _self.aliyunOssToken.accessid) formdata.append(&#x27;success_action_status&#x27;, 200) formdata.append(&#x27;signature&#x27;, _self.aliyunOssToken.signature) formdata.append(&#x27;file&#x27;, file.file) _self.uploadOSS(formdata, _self.aliyunOssToken.host).then(function(res)&#123; _self.form.cover = _self.aliyunOssToken.host + &#x27;/&#x27; + keyValue; _self.$message.success(&#x27;ä¸Šä¼ æˆåŠŸ&#x27;); &#125;).catch(function(error)&#123; _self.$message.error(&#x27;ä¸Šä¼ å¤±è´¥&#x27;); console.log(error); &#125;) &#125;).catch(function(error)&#123; console.log(error); &#125;) &#125;, uploadOSS(formData, url) &#123; const config = &#123; headers: &#123; &quot;Content-Type&quot;: &quot;multipart/form-data;boundary=&quot;+new Date().getTime() &#125; &#125;; return axios.post(url,formData,config); &#125; å…¶ä¸­ï¼šåŠ¡å¿…ä½¿ç”¨è¡¨å•æäº¤æ–¹å¼ï¼ŒaliyunOssTokenæ ¼å¼å¦‚ä¸‹ &#123; &quot;accessid&quot;: &quot;LToofXWKudxfoAlI&quot;, &quot;host&quot;: &quot;https:\\/\\/xxx.oss-cn-hangzhou.aliyuncs.com&quot;, &quot;policy&quot;: &quot;eyJleHBpcmF0eretaW9uIjoiQxODowNzowMFoiLCJjb25kaXRpb25zIjpbWyJjb250ZW50LWxlbmd0aC17ewreMDQ4NTc2MDAwXSxbInN0YXJ0cy13aXRoIiwiJGtleSIsInZpZGVvXC8iXV19&quot;, &quot;signature&quot;: &quot;HRFJ4345VIvRhrsMa44546=&quot;, &quot;expire&quot;: 1578478020, &quot;dir&quot;: &quot;images\\/&quot; &#125; è®°å¾—è®¾ç½®é˜¿é‡Œäº‘OSSè·¨åŸŸè§„åˆ™ï¼š æ–‡æ¡£ï¼š javascriptç­¾åç›´ä¼ ","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"},{"name":"api","slug":"web/api","permalink":"https://github.13sai.com/categories/web/api/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"wrkå‹æµ‹ä½¿ç”¨","slug":"wrkå‹æµ‹ä½¿ç”¨","date":"2019-12-30T10:12:46.000Z","updated":"2022-03-19T14:35:21.836Z","comments":true,"path":"2019/12/30/220/","link":"","permalink":"https://github.13sai.com/2019/12/30/220/","excerpt":"","text":"æœ€è¿‘æœ‰éœ€è¦åšä¸€äº›å‹åŠ›æµ‹è¯•ï¼Œä¹‹å‰ä¸€ç›´ç”¨abï¼Œç”¨èµ·æ¥ä¸æ˜¯å¾ˆèˆ’æœï¼Œæœ€è¿‘æœ‰ä½¿ç”¨wrkï¼Œè½»é‡å¥½ç”¨ã€‚ å®‰è£…git clone https://github.com/wg/wrk.git wrk cd wrk make # move the executable to somewhere in your PATH sudo cp wrk /somewhere/in/your/PATH é»˜è®¤æƒ…å†µä¸‹wrkä¼šä½¿ç”¨è‡ªå¸¦çš„LuaJITå’ŒOpenSSLï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ç³»ç»Ÿå·²å®‰è£…çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨WITH_LUAJITå’ŒWITH_OPENSSLè¿™ä¸¤ä¸ªé€‰é¡¹æ¥æŒ‡å®šå®ƒä»¬çš„è·¯å¾„ã€‚æ¯”å¦‚ï¼š make WITH_LUAJIT=/usr WITH_OPENSSL=/usr ä½¿ç”¨è¯´æ˜wrk &lt;é€‰é¡¹&gt; &lt;è¢«æµ‹HTTPæœåŠ¡çš„URL&gt; Options: -c, --connections &lt;N&gt; è·ŸæœåŠ¡å™¨å»ºç«‹å¹¶ä¿æŒçš„TCPè¿æ¥æ•°é‡ -d, --duration &lt;T&gt; å‹æµ‹æ—¶é—´ -t, --threads &lt;N&gt; ä½¿ç”¨å¤šå°‘ä¸ªçº¿ç¨‹è¿›è¡Œå‹æµ‹ -s, --script &lt;S&gt; æŒ‡å®šLuaè„šæœ¬è·¯å¾„ -H, --header &lt;H&gt; ä¸ºæ¯ä¸€ä¸ªHTTPè¯·æ±‚æ·»åŠ HTTPå¤´ --latency åœ¨å‹æµ‹ç»“æŸåï¼Œæ‰“å°å»¶è¿Ÿç»Ÿè®¡ä¿¡æ¯ --timeout &lt;T&gt; è¶…æ—¶æ—¶é—´ -v, --version æ‰“å°æ­£åœ¨ä½¿ç”¨çš„wrkçš„è¯¦ç»†ç‰ˆæœ¬ä¿¡æ¯ &lt;N&gt;ä»£è¡¨æ•°å­—å‚æ•°ï¼Œæ”¯æŒå›½é™…å•ä½ (1k, 1M, 1G) &lt;T&gt;ä»£è¡¨æ—¶é—´å‚æ•°ï¼Œæ”¯æŒæ—¶é—´å•ä½ (2s, 2m, 2h) æµ‹è¯•wrk -t8 -c200 -d30s --latency &quot;http://www.bing.com&quot; è¾“å‡ºï¼š Running 30s test @ http://www.bing.com 8 threads and 200 connections Thread Stats Avg Stdev Max +/- Stdev Latency 46.67ms 215.38ms 1.67s 95.59% Req/Sec 7.91k 1.15k 10.26k 70.77% Latency Distribution 50% 2.93ms 75% 3.78ms 90% 4.73ms 99% 1.35s 1790465 requests in 30.01s, 684.08MB read Requests/sec: 59658.29 Running 30s test @ http://www.bing.com ï¼ˆå‹æµ‹æ—¶é—´30sï¼‰ 8 threads and 200 connections ï¼ˆå…±8ä¸ªæµ‹è¯•çº¿ç¨‹ï¼Œ200ä¸ªè¿æ¥ï¼‰ Thread Stats Avg Stdev Max +/- Stdev ï¼ˆå¹³å‡å€¼ï¼‰ ï¼ˆæ ‡å‡†å·®ï¼‰ï¼ˆæœ€å¤§å€¼ï¼‰ï¼ˆæ­£è´Ÿä¸€ä¸ªæ ‡å‡†å·®æ‰€å æ¯”ä¾‹ï¼‰ Latency 46.67ms 215.38ms 1.67s 95.59% ï¼ˆå»¶è¿Ÿï¼‰ Req/Sec 7.91k 1.15k 10.26k 70.77% ï¼ˆå¤„ç†ä¸­çš„è¯·æ±‚æ•°ï¼‰ Latency Distribution ï¼ˆå»¶è¿Ÿåˆ†å¸ƒï¼‰ 50% 2.93ms 75% 3.78ms 90% 4.73ms 99% 1.35s ï¼ˆ99åˆ†ä½çš„å»¶è¿Ÿï¼‰ 1790465 requests in 30.01s, 684.08MB read ï¼ˆ30.01ç§’å†…å…±å¤„ç†å®Œæˆäº†1790465ä¸ªè¯·æ±‚ï¼Œè¯»å–äº†684.08MBæ•°æ®ï¼‰ Requests/sec: 59658.29 ï¼ˆå¹³å‡æ¯ç§’å¤„ç†å®Œæˆ59658.29ä¸ªè¯·æ±‚ï¼‰ Transfer/sec: 22.79MB ï¼ˆå¹³å‡æ¯ç§’è¯»å–æ•°æ®22.79MBï¼‰ luaè„šæœ¬ä½¿ç”¨--data.lua local data= &quot;&#123;.count.:1&#125;&quot; wrk.headers[&quot;Content-Type&quot;] = &quot;application/jason&quot; wrk.method = &quot;POST&quot; function request() return wrk.format(&#x27;POST&#x27;, nil, nil, data) end æµ‹è¯•ï¼š wrk -t500 -c1000 -d1s --script=data.lua --latency https://github.13sai.com/ ä¸ªäººç”¨äº†å‡ æ¬¡ï¼Œæ„Ÿè§‰æ¯”abå¥½ç”¨ï¼Œæ¨èä¸€ä¸‹ã€‚ å‚è€ƒï¼šHttpå‹æµ‹å·¥å…·wrkä½¿ç”¨æŒ‡å—wrk","categories":[{"name":"test","slug":"test","permalink":"https://github.13sai.com/categories/test/"}],"tags":[{"name":"wrk","slug":"wrk","permalink":"https://github.13sai.com/tags/wrk/"}]},{"title":"gomodules","slug":"gomodules","date":"2019-12-27T10:32:26.000Z","updated":"2022-03-19T14:35:21.693Z","comments":true,"path":"2019/12/27/219/","link":"","permalink":"https://github.13sai.com/2019/12/27/219/","excerpt":"","text":"modulesmodulesåœ¨goçš„1.11ç‰ˆæœ¬ä¸­åŠ å…¥ï¼Œå¹¶åœ¨æœ€æ–°çš„Go 1.13ä¸­å¯¹æ¨¡å—è¿›è¡Œäº†é‡å¤§æ”¹è¿›å’Œæ›´æ”¹ã€‚ 1.13ç‰ˆæœ¬å‰è¯·åŠ¡å¿…å¼€å¯æ¨¡å— export GO111MODULE=auto åˆå§‹åŒ–åœ¨ä½ çš„é¡¹ç›®ç›®å½•ä¸­æ‰§è¡Œï¼š go mod init 13sai/game ä¼šç”Ÿæˆgo.mod module 13sai/game go 1.12 ç„¶åä½ å¯ä»¥å°½æƒ…ç¼–å†™ä½ çš„é¡¹ç›®ä»£ç ï¼Œåœ¨ä½ æ¯æ¬¡go getçš„æ—¶å€™ï¼Œmodulesä¹Ÿä¼šå°†ä½ çš„å®‰è£…çš„packageåŠ å…¥go.mod module 13sai/game go 1.12 require github.com/gin-gonic/gin v1.5.0 // indirect å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åƒæˆ‘ä¸€æ ·ï¼Œå…ˆå»å†™ä»£ç ï¼Œä¸å»åˆå§‹åŒ–modulesï¼Œå†™å®Œä»£ç ä¹‹åï¼Œåˆå§‹åŒ–ï¼Œç„¶åæ‰§è¡Œï¼š go run main.go å½“ç„¶ï¼Œå¦‚æœä½ æ²¡æœ‰ç¿»å¢™ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨å›½å†…é•œåƒï¼Œå¾ˆå¯èƒ½å¾ˆå¤šåŒ…éƒ½ä¸‹è½½å¤±è´¥ã€‚ Goproxy ä¸­å›½Go 1.13 åŠä»¥ä¸Šï¼ˆæ¨èï¼‰æ‰“å¼€ä½ çš„ç»ˆç«¯å¹¶æ‰§è¡Œï¼š $ go env -w GOPROXY=https://goproxy.cn,direct å®Œæˆã€‚ macOS æˆ– Linuxæ‰“å¼€ä½ çš„ç»ˆç«¯å¹¶æ‰§è¡Œï¼š $ export GOPROXY=https://goproxy.cn æˆ–è€… $ echo &quot;export GOPROXY=https://goproxy.cn&quot; &gt;&gt; ~/.profile &amp;&amp; source ~/.profile å®Œæˆã€‚ Windowsæ‰“å¼€ä½ çš„ PowerShell å¹¶æ‰§è¡Œï¼š C:\\&gt; $env:GOPROXY = &quot;https://goproxy.cn&quot; æˆ–è€… 1. æ‰“å¼€â€œå¼€å§‹â€å¹¶æœç´¢â€œenvâ€ 2. é€‰æ‹©â€œç¼–è¾‘ç³»ç»Ÿç¯å¢ƒå˜é‡â€ 3. ç‚¹å‡»â€œç¯å¢ƒå˜é‡â€¦â€æŒ‰é’® 4. åœ¨â€œ&lt;ä½ çš„ç”¨æˆ·å&gt; çš„ç”¨æˆ·å˜é‡â€ç« èŠ‚ä¸‹ï¼ˆä¸ŠåŠéƒ¨åˆ†ï¼‰ 5. ç‚¹å‡»â€œæ–°å»ºâ€¦â€æŒ‰é’® 6. é€‰æ‹©â€œå˜é‡åâ€è¾“å…¥æ¡†å¹¶è¾“å…¥â€œGOPROXYâ€ 7. é€‰æ‹©â€œå˜é‡å€¼â€è¾“å…¥æ¡†å¹¶è¾“å…¥â€œhttps://goproxy.cnâ€ 8. ç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’® å®Œæˆã€‚ æœ¬åœ°åŒ…å¤„ç†æœ¬åœ°å®ä½¿ç”¨è¿™æ ·çš„æ–¹å¼å¼•å…¥ï¼ˆlocal.com/13sai/gameï¼‰ ç„¶åæ‰§è¡Œï¼š $ go mod edit -require=local.com/13sai/game@v1.0.0 $ go mod edit -replace=local.com/13sai/game@v1.0.0=$PWD vendorå¤‡ä»½ go mod vendor å¯ä»¥å°†modulesä¸‹è½½åˆ°æœ¬åœ°vendorç›®å½•ï¼Œå…¶ä¸­ä¹ŸåŒ…å«ä¸Šé¢çš„æœ¬åœ°åŒ…ã€‚ å…¶ä»–go mod tidy //æ•´ç†æ¨¡å—ï¼ˆæ‹‰å–ç¼ºå°‘çš„æ¨¡å—ï¼Œç§»é™¤ä¸ç”¨çš„æ¨¡å—ï¼‰ go mod download//ä¸‹è½½ä¾èµ–åŒ…åˆ°æœ¬åœ°ç¼“å­˜ go mod graph //æ‰“å°ç°æœ‰ä¾èµ–ç»“æ„ go mod verify //æ ¡éªŒä¾èµ– go mod why //è§£é‡Šä¸ºä»€ä¹ˆéœ€è¦æ­¤æ¨¡å— Modulesçš„wiki","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"Nginxè´Ÿè½½å‡è¡¡","slug":"Nginxè´Ÿè½½å‡è¡¡","date":"2019-12-21T08:10:56.000Z","updated":"2022-03-20T04:08:08.398Z","comments":true,"path":"2019/12/21/Nginx2/","link":"","permalink":"https://github.13sai.com/2019/12/21/Nginx2/","excerpt":"","text":"è´Ÿè½½å‡è¡¡ç­–ç•¥1.è½®è¯¢(é»˜è®¤)ï¼šæ¯ä¸€ä¸ªæ¥è‡ªç½‘ç»œä¸­çš„è¯·æ±‚ï¼Œè½®æµåˆ†é…ç»™å†…éƒ¨çš„æœåŠ¡å™¨ï¼Œä»1åˆ°Nç„¶åé‡æ–°å¼€å§‹ã€‚æ­¤ç§è´Ÿè½½å‡è¡¡ç®—æ³•é€‚åˆæœåŠ¡å™¨ç»„å†…éƒ¨çš„æœåŠ¡å™¨éƒ½å…·æœ‰ç›¸åŒçš„é…ç½®å¹¶ä¸”å¹³å‡æœåŠ¡è¯·æ±‚ ç›¸å¯¹å‡è¡¡çš„æƒ…å†µã€‚2.åŠ æƒè½®è¯¢ï¼ˆweightï¼‰ï¼šæ ¹æ®æœåŠ¡å™¨çš„ä¸åŒå¤„ç†èƒ½åŠ›ï¼Œç»™æ¯ä¸ªæœåŠ¡å™¨åˆ†é…ä¸åŒçš„æƒå€¼ï¼Œä½¿å…¶èƒ½å¤Ÿæ¥å—ç›¸åº”æƒå€¼æ•°çš„æœåŠ¡è¯·æ±‚ã€‚ä¾‹å¦‚:æœåŠ¡å™¨Açš„æƒå€¼è¢«è®¾è®¡æˆ1ï¼ŒBçš„æƒå€¼æ˜¯3ï¼ŒCçš„æƒå€¼æ˜¯6ï¼Œåˆ™æœåŠ¡å™¨Aã€Bã€Cå°†åˆ†åˆ«æ¥å—åˆ°10%ã€30%ã€60%çš„æœåŠ¡è¯·æ±‚ã€‚æ­¤ç§å‡è¡¡ç®—æ³•èƒ½ç¡®ä¿é«˜æ€§èƒ½çš„æœåŠ¡å™¨å¾—åˆ°æ›´å¤šçš„ä½¿ç”¨ç‡ï¼Œé¿å…ä½æ€§èƒ½çš„æœåŠ¡å™¨è´Ÿè½½è¿‡é‡ã€‚3.ip-hashï¼ˆip_hashï¼‰ï¼šnginxå°†ä¼šæ ¹æ®ç›¸åº”çš„hashå‡½æ•°ï¼Œå¯¹æ¯ä¸ªè¯·æ±‚çš„ipä½œä¸ºå…³é”®å­—ï¼Œå¾—åˆ°çš„hashå€¼å°†ä¼šå†³å®šå°†è¯·æ±‚åˆ†å‘ç»™ç›¸åº”Serverè¿›è¡Œå¤„ç†ã€‚4.æœ€å°‘è¿æ¥æ•°ï¼ˆleast_connï¼‰ï¼šnginxä¼šåˆ¤æ–­åç«¯é›†ç¾¤æœåŠ¡å™¨ä¸­å“ªä¸ªServerå½“å‰çš„ Active Connection æ•°æ˜¯æœ€å°‘çš„ï¼Œå¯¹äºæ¯ä¸ªæ–°è¿›æ¥çš„è¯·æ±‚ï¼Œnginxå°†è¯¥å…¶åˆ†å‘ç»™å¯¹åº”çš„Serverã€‚ è¯­æ³•è¯­æ³•: upstream name &#123; ... &#125; é»˜è®¤å€¼: â€” ä¸Šä¸‹æ–‡: http upstream æŒ‡ä»¤å½“ä¸­åŒ…å«serveræŒ‡ä»¤ è¯­æ³•: server address [parameters]; ä¸Šä¸‹æ–‡: upstream demo: upstream backend &#123; server backend1.example.com:8081 weight=4 max_fails=2 fail_timeout=30s; server backend2.example.com:8080 weight=1; &#125; server &#123; location / &#123; proxy_pass http://backend; &#125; &#125; å‚æ•°è¯´æ˜: weight=number è®¾å®šæœåŠ¡å™¨çš„æƒé‡ï¼Œé»˜è®¤æ˜¯1ï¼Œæƒé‡è¶Šå¤§è¢«è®¿é—®æœºä¼šè¶Šå¤§ï¼Œå¯ä»¥æ ¹æ®æœºå™¨çš„é…ç½®æƒ…å†µæ¥é…ç½®ã€‚ max_fails=number è®¾å®šNginxä¸æœåŠ¡å™¨é€šä¿¡çš„å°è¯•å¤±è´¥çš„æ¬¡æ•°ã€‚åœ¨fail_timeoutå‚æ•°å®šä¹‰çš„æ—¶é—´æ®µå†…ï¼Œå¦‚æœå¤±è´¥çš„æ¬¡æ•°è¾¾åˆ°æ­¤å€¼ï¼ŒNginxå°±è®¤ä¸ºæœåŠ¡å™¨ä¸ å¯ç”¨ã€‚åœ¨ä¸‹ä¸€ä¸ªfail_timeoutæ—¶é—´æ®µï¼ŒæœåŠ¡å™¨ä¸ä¼šå†è¢«å°è¯•ã€‚ å¤±è´¥çš„å°è¯•æ¬¡æ•°é»˜è®¤æ˜¯1ã€‚é»˜è®¤é…ç½®æ—¶ï¼Œhttp_404çŠ¶æ€ä¸è¢«è®¤ä¸ºæ˜¯å¤±è´¥çš„å°è¯•ã€‚ å¯ä»¥é€šè¿‡æŒ‡ä»¤proxy_next_upstream å’Œ memcached_next_upstream æ¥é…ç½®ä»€ä¹ˆæ˜¯å¤±è´¥çš„å°è¯•ã€‚ fail_timeout=time,ç»Ÿè®¡å¤±è´¥å°è¯•æ¬¡æ•°çš„æ—¶é—´æ®µã€‚åœ¨è¿™æ®µæ—¶é—´ä¸­ï¼ŒæœåŠ¡å™¨å¤±è´¥æ¬¡æ•°è¾¾åˆ°æŒ‡å®šçš„å°è¯•æ¬¡æ•°ï¼ŒæœåŠ¡å™¨å°±è¢«è®¤ä¸ºä¸å¯ç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥è¶…æ—¶æ—¶é—´æ˜¯10ç§’ã€‚ backup,æ ‡è®°ä¸ºå¤‡ç”¨æœåŠ¡å™¨ã€‚å½“ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ä»¥åï¼Œè¯·æ±‚ä¼šè¢«ä¼ ç»™è¿™äº›æœåŠ¡å™¨ï¼Œé…ç½®è¿™ä¸ªæŒ‡ä»¤å¯ä»¥å®ç°æ•…éšœè½¬ç§»ã€‚ down,æ ‡è®°æœåŠ¡å™¨æ°¸ä¹…ä¸å¯ç”¨ï¼Œå¯ä»¥è·Ÿip_hashæŒ‡ä»¤ä¸€èµ·ä½¿ç”¨ã€‚ proxy_next_upstream æŒ‡ä»¤åœ¨nginxçš„é…ç½®æ–‡ä»¶ä¸­ï¼Œ proxy_next_upstream é¡¹å®šä¹‰äº†ä»€ä¹ˆæƒ…å†µä¸‹è¿›è¡Œé‡è¯• è¯­æ³•: proxy_next_upstream error | timeout | invalid_header | http_500 | http_502 | http_503 | http_504 | http_403 | http_404 | http_429 | non_idempotent | off ...; é»˜è®¤å€¼: proxy_next_upstream error timeout; ä¸Šä¸‹æ–‡: http, server, location å‚æ•°è¯´æ˜: error è¡¨ç¤ºå’Œåç«¯æœåŠ¡å™¨å»ºç«‹è¿æ¥æ—¶ï¼Œæˆ–è€…å‘åç«¯æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œæˆ–è€…ä»åç«¯æœåŠ¡å™¨æ¥æ”¶å“åº”å¤´æ—¶ï¼Œå‡ºç°é”™è¯¯ã€‚ timeout è¡¨ç¤ºå’Œåç«¯æœåŠ¡å™¨å»ºç«‹è¿æ¥æ—¶ï¼Œæˆ–è€…å‘åç«¯æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œæˆ–è€…ä»åç«¯æœåŠ¡å™¨æ¥æ”¶å“åº”å¤´æ—¶ï¼Œå‡ºç°è¶…æ—¶ã€‚ invalid_header è¡¨ç¤ºåç«¯æœåŠ¡å™¨è¿”å›ç©ºå“åº”æˆ–è€…éæ³•å“åº”å¤´ http_500 è¡¨ç¤ºåç«¯æœåŠ¡å™¨è¿”å›çš„å“åº”çŠ¶æ€ç ä¸º500 non_idempotent é€šå¸¸ï¼Œå¦‚æœè¯·æ±‚å·²å‘é€åˆ°ä¸Šæ¸¸æœåŠ¡å™¨ï¼Œåˆ™å…·æœ‰éç­‰å¹‚æ–¹æ³•ï¼ˆPOSTã€LOCKã€PATCHï¼‰çš„è¯·æ±‚ä¸ä¼šä¼ é€’åˆ°ä¸‹ä¸€ä¸ªæœåŠ¡å™¨ï¼›å¯ç”¨æ­¤é€‰é¡¹å¯æ˜¾å¼å…è®¸é‡è¯•æ­¤ç±»è¯·æ±‚ï¼› off è¡¨ç¤ºåœæ­¢å°†è¯·æ±‚å‘é€ç»™ä¸‹ä¸€å°åç«¯æœåŠ¡å™¨ PS: non_idempotentå‚æ•°ï¼Œproxy_next_upstreamé…ç½®é»˜è®¤è½¬å‘getè¯·æ±‚ï¼Œä½†å¯¹äºpostç­‰è¯·æ±‚å¹¶æ— æ•ˆæœï¼Œå»ºè®®é…ç½®è¿™ä¸€é¡¹ã€‚ ç›¸å…³ proxy_next_upstream_tries:è®¾ç½®é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤0è¡¨ç¤ºä¸é™åˆ¶ï¼Œæ³¨æ„æ­¤é‡è¯•æ¬¡æ•°æŒ‡çš„æ˜¯æ‰€æœ‰è¯·æ±‚æ¬¡æ•°(åŒ…æ‹¬ç¬¬ä¸€æ¬¡å’Œä¹‹åçš„é‡è¯•æ¬¡æ•°ä¹‹å’Œ)ã€‚ proxy_next_upstream_timeout: è®¾ç½®é‡è¯•æœ€å¤§è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤0è¡¨ç¤ºä¸é™åˆ¶ã€‚å³åœ¨ proxy_next_upstream_timeout æ—¶é—´å†…å…è®¸ proxy_next_upstream_tries æ¬¡é‡è¯•ã€‚å¦‚æœè¶…è¿‡äº†å…¶ä¸­ä¸€ä¸ªè®¾ç½®ï¼Œåˆ™ Nginx ä¹Ÿä¼šç»“æŸé‡è¯•å¹¶è¿”å›å®¢æˆ·ç«¯å“åº”(å¯èƒ½æ˜¯é”™è¯¯ç )ã€‚ proxy_send_timeout:åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶æ—¶é—´) proxy_read_timeout:è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶æ—¶é—´) proxy_connect_timeout:nginxè¿æ¥åç«¯çš„è¶…æ—¶æ—¶é—´ï¼Œä¸€èˆ¬ä¸è¶…è¿‡75s demo: location / &#123; proxy_pass http://app-proxy; proxy_next_upstream error timeout http_500 http_502 http_503 http_504; proxy_next_upstream_tries 3; proxy_connect_timeout 60s; proxy_read_timeout 60s; proxy_send_timeout 60s; proxy_pass_request_headers on; proxy_set_header Host $host:$server_port; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; &#125; å»ºè®®è‡ªå·±åŠ¨æ‰‹ä½¿ç”¨è¿™äº›å‚æ•°ï¼Œè¯•éªŒä¸€ä¸‹ï¼ŒåŠ æ·±å°è±¡å’Œç†è§£ã€‚","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"Nginxå·¥ä½œæ¨¡å¼å’Œè¿›ç¨‹æ¨¡å‹","slug":"Nginxå·¥ä½œæ¨¡å¼å’Œè¿›ç¨‹æ¨¡å‹","date":"2019-12-20T10:10:56.000Z","updated":"2022-03-19T15:27:38.319Z","comments":true,"path":"2019/12/20/Nginx3/","link":"","permalink":"https://github.13sai.com/2019/12/20/Nginx3/","excerpt":"","text":"å·¥ä½œæ¨¡å¼ Nginxå¯åŠ¨åï¼Œä¼šäº§ç”Ÿä¸€ä¸ªmasterä¸»è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹æ‰§è¡Œä¸€ç³»åˆ—çš„å·¥ä½œåä¼šäº§ç”Ÿä¸€ä¸ªæˆ–è€…å¤šä¸ªå·¥ä½œè¿›ç¨‹worker åœ¨å®¢æˆ·ç«¯è¯·æ±‚åŠ¨æ€ç«™ç‚¹çš„è¿‡ç¨‹ä¸­ï¼ŒNginxæœåŠ¡å™¨è¿˜æ¶‰åŠå’Œåç«¯æœåŠ¡å™¨çš„é€šä¿¡ã€‚Nginxå°†æ¥æ”¶åˆ°çš„Webè¯·æ±‚é€šè¿‡ä»£ç†è½¬å‘åˆ°åç«¯æœåŠ¡å™¨ï¼Œç”±åç«¯æœåŠ¡å™¨è¿›è¡Œæ•°æ®å¤„ç†å’Œç»„ç»‡; Nginxä¸ºäº†æé«˜å¯¹è¯·æ±‚çš„å“åº”æ•ˆç‡ï¼Œé™ä½ç½‘ç»œå‹åŠ›ï¼Œé‡‡ç”¨äº†ç¼“å­˜æœºåˆ¶ï¼Œå°†å†å²åº”ç­”æ•°æ®ç¼“å­˜åˆ°æœ¬åœ°ã€‚ä¿éšœå¯¹ç¼“å­˜æ–‡ä»¶çš„å¿«é€Ÿè®¿é—® è¿›ç¨‹æ¨¡å‹nginxçš„è¿›ç¨‹æ¨¡å‹ï¼Œå¯ä»¥ç”±ä¸‹å›¾æ¥è¡¨ç¤ºï¼š masterè¿›ç¨‹ä¸»è¦ç”¨æ¥ç®¡ç† worker è¿›ç¨‹ï¼Œmasterè¿›ç¨‹ä¼šæ¥æ”¶æ¥è‡ªå¤–ç•Œå‘æ¥çš„ä¿¡å·ï¼Œå†æ ¹æ®ä¿¡å·åšä¸åŒçš„äº‹æƒ…ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æ§åˆ¶nginxï¼Œåªéœ€è¦é€šè¿‡killå‘masterè¿›ç¨‹å‘é€ä¿¡å·å°±è¡Œäº†ã€‚ å…·ä½“åŒ…æ‹¬ä»¥ä¸‹ä¸»è¦åŠŸèƒ½: æ¥æ”¶æ¥è‡ªå¤–ç•Œçš„ä¿¡å· å‘å„workerè¿›ç¨‹å‘é€ä¿¡å· ç›‘æ§workerè¿›ç¨‹çš„è¿è¡ŒçŠ¶æ€ï¼Œå½“workerè¿›ç¨‹é€€å‡ºå(å¼‚å¸¸æƒ…å†µä¸‹)ï¼Œä¼šè‡ªåŠ¨é‡æ–°å¯åŠ¨æ–°çš„workerè¿›ç¨‹ é‡å¯è¯´æ˜ï¼ˆç¤ºä¾‹ï¼‰æ¯”å¦‚kill -HUP pidï¼Œåˆ™æ˜¯å‘Šè¯‰nginxï¼Œé‡å¯nginxï¼Œæ—©æœŸç‰ˆæœ¬å¯ä»¥ç”¨è¿™ä¸ªä¿¡å·æ¥é‡å¯nginxï¼Œå› ä¸ºæ˜¯ä»å®¹åœ°é‡å¯ï¼Œå› æ­¤æœåŠ¡æ˜¯ä¸ä¸­æ–­çš„ã€‚ï¼ˆç°åœ¨ä¸€èˆ¬ä½¿ç”¨nginx -s reloadï¼‰ masterè¿›ç¨‹åœ¨æ¥æ”¶åˆ°HUPä¿¡å·åï¼Œä¼šå…ˆé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œç„¶åå†å¯åŠ¨æ–°çš„workerè¿›ç¨‹ï¼Œå¹¶å‘æ‰€æœ‰è€çš„workerè¿›ç¨‹å‘é€ä¿¡å·ï¼Œå‘Šè¯‰ä»–ä»¬å¯ä»¥å…‰è£é€€ä¼‘äº†ã€‚æ–°çš„workeråœ¨å¯åŠ¨åï¼Œå°±å¼€å§‹æ¥æ”¶æ–°çš„è¯·æ±‚ï¼Œè€Œè€çš„workeråœ¨æ”¶åˆ°æ¥è‡ªmasterçš„ä¿¡å·åï¼Œå°±ä¸å†æ¥æ”¶æ–°çš„è¯·æ±‚ï¼Œå¹¶ä¸”åœ¨å½“å‰è¿›ç¨‹ä¸­çš„æ‰€æœ‰æœªå¤„ç†å®Œçš„è¯·æ±‚å¤„ç†å®Œæˆåï¼Œå†é€€å‡ºã€‚ ï¼ˆmasterä¸éœ€è¦å¤„ç†ç½‘ç»œäº‹ä»¶ï¼Œä¸è´Ÿè´£ä¸šåŠ¡çš„æ‰§è¡Œï¼‰ workerè¿›ç¨‹ä¸»è¦ä»»åŠ¡æ˜¯å®Œæˆå…·ä½“çš„ä»»åŠ¡é€»è¾‘ã€‚å…¶ä¸»è¦å…³æ³¨ç‚¹æ˜¯ä¸å®¢æˆ·ç«¯æˆ–åç«¯çœŸå®æœåŠ¡å™¨(æ­¤æ—¶ worker ä½œä¸ºä¸­é—´ä»£ç†)ä¹‹é—´çš„æ•°æ®å¯è¯»/å¯å†™ç­‰I/Oäº¤äº’äº‹ä»¶ã€‚å…·ä½“åŒ…æ‹¬ä»¥ä¸‹ä¸»è¦åŠŸèƒ½: æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚; å°†è¯·æ±‚ä¸€æ¬¡é€å…¥å„ä¸ªåŠŸèƒ½æ¨¡å—è¿›è¡Œè¿‡æ»¤å¤„ç†; ä¸åç«¯æœåŠ¡å™¨é€šä¿¡ï¼Œæ¥æ”¶åç«¯æœåŠ¡å™¨å¤„ç†ç»“æœ; æ•°æ®ç¼“å­˜proxy_cacheæ¨¡å— å“åº”å®¢æˆ·ç«¯è¯·æ±‚ ï¼ˆä¸€ä¸ªè¯·æ±‚ï¼Œå®Œå…¨ç”±workerè¿›ç¨‹æ¥å¤„ç†ï¼Œè€Œä¸”åªåœ¨ä¸€ä¸ªworkerè¿›ç¨‹ä¸­å¤„ç†ã€‚ï¼‰ workerè¿›ç¨‹æ˜¯å¦‚ä½•å¤„ç†è¯·æ±‚çš„ï¼Ÿé¦–å…ˆï¼Œworkerè¿›ç¨‹ä¹‹é—´æ˜¯å¹³ç­‰çš„ï¼Œæ¯ä¸ªworkerè¿›ç¨‹éƒ½æ˜¯ä»masterè¿›ç¨‹forkè¿‡æ¥ï¼Œåœ¨masterè¿›ç¨‹é‡Œé¢ï¼Œå…ˆå»ºç«‹å¥½éœ€è¦listençš„socketï¼ˆlistenfdï¼‰ä¹‹åï¼Œç„¶åå†forkå‡ºå¤šä¸ªworkerè¿›ç¨‹ã€‚æ¯ä¸ªworkerè¿›ç¨‹ï¼Œå¤„ç†è¯·æ±‚çš„æœºä¼šä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚å½“ä¸€ä¸ªè¿æ¥è¯·æ±‚è¿‡æ¥ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å¯èƒ½å¤„ç†è¿™ä¸ªè¿æ¥ï¼Œæ€ä¹ˆåšçš„å‘¢ï¼Ÿ æ‰€æœ‰workerè¿›ç¨‹çš„listenfdä¼šåœ¨æ–°è¿æ¥åˆ°æ¥æ—¶å˜å¾—å¯è¯»ï¼Œä¸ºä¿è¯åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¤„ç†è¯¥è¿æ¥ï¼Œæ‰€æœ‰workerè¿›ç¨‹åœ¨æ³¨å†Œlistenfdè¯»äº‹ä»¶å‰æŠ¢accept_mutexï¼ŒæŠ¢åˆ°äº’æ–¥é”çš„é‚£ä¸ªworkerè¿›ç¨‹æ³¨å†Œlistenfdè¯»äº‹ä»¶ï¼Œåœ¨è¯»äº‹ä»¶é‡Œè°ƒç”¨acceptæ¥å—è¯¥è¿æ¥ã€‚ å½“ä¸€ä¸ªworkerè¿›ç¨‹åœ¨acceptè¿™ä¸ªè¿æ¥ä¹‹åï¼Œå°±å¼€å§‹è¯»å–è¯·æ±‚ï¼Œè§£æè¯·æ±‚ï¼Œå¤„ç†è¯·æ±‚ï¼Œäº§ç”Ÿæ•°æ®åï¼Œå†è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæœ€åæ–­å¼€è¿æ¥ï¼Œè¿™æ ·å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚å°±æ˜¯è¿™æ ·çš„äº†ã€‚ æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œå®Œå…¨ç”±workerè¿›ç¨‹æ¥å¤„ç†ï¼Œä¸”åªåœ¨ä¸€ä¸ªworkerè¿›ç¨‹ä¸­å¤„ç†ã€‚ Nginxé‡‡ç”¨çš„IOå¤šè·¯å¤ç”¨æ¨¡å‹ IOå¤šè·¯å¤ç”¨æ˜¯æŒ‡å†…æ ¸ä¸€æ—¦å‘ç°è¿›ç¨‹æŒ‡å®šçš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªIOæ¡ä»¶å‡†å¤‡è¯»å–ï¼Œå®ƒå°±é€šçŸ¥è¯¥è¿›ç¨‹ï¼Œç›®å‰æ”¯æŒI/Oå¤šè·¯å¤ç”¨çš„ç³»ç»Ÿè°ƒç”¨æœ‰ select ï¼Œ poll ï¼Œ epoll ï¼ŒI/Oå¤šè·¯å¤ç”¨å°±æ˜¯é€šè¿‡ä¸€ç§æœºåˆ¶ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç›‘è§†å¤šä¸ªæè¿°ç¬¦(socket)ï¼Œä¸€æ—¦æŸä¸ªæè¿°ç¬¦å°±ç»ª(ä¸€èˆ¬æ˜¯è¯»å°±ç»ªæˆ–è€…å†™å°±ç»ª)ï¼Œèƒ½å¤Ÿé€šçŸ¥ç¨‹åºè¿›è¡Œç›¸åº”çš„è¯» å†™æ“ä½œã€‚ selectåŸºæœ¬åŸç†select å‡½æ•°ç›‘è§†çš„æ–‡ä»¶æè¿°ç¬¦åˆ†3ç±»ï¼Œåˆ†åˆ«æ˜¯writefdsã€readfdsã€å’Œexceptfdsã€‚è°ƒç”¨åselectå‡½æ•°ä¼šé˜»å¡ï¼Œç›´åˆ°æœ‰æè¿°ç¬¦å°±ç»ªï¼ˆæœ‰æ•°æ® å¯è¯»ã€å¯å†™ã€æˆ–è€…æœ‰exceptï¼‰ï¼Œæˆ–è€…è¶…æ—¶ï¼ˆtimeoutæŒ‡å®šç­‰å¾…æ—¶é—´ï¼Œå¦‚æœç«‹å³è¿”å›è®¾ä¸ºnullå³å¯ï¼‰ï¼Œå‡½æ•°è¿”å›ã€‚å½“selectå‡½æ•°è¿”å›åï¼Œå¯ä»¥é€šè¿‡éå†fdsetï¼Œæ¥æ‰¾åˆ°å°±ç»ªçš„æè¿°ç¬¦ã€‚ ä¼˜ç‚¹ ç›®å‰å‡ ä¹åœ¨æ‰€æœ‰çš„å¹³å°ä¸Šæ”¯æŒ ç¼ºç‚¹ selectæœ¬è´¨ä¸Šæ˜¯é€šè¿‡è®¾ç½®æˆ–è€…æ£€æŸ¥å­˜æ”¾fdæ ‡å¿—ä½çš„æ•°æ®ç»“æ„æ¥è¿›è¡Œä¸‹ä¸€æ­¥å¤„ç†ã€‚è¿™æ ·æ‰€å¸¦æ¥çš„ç¼ºç‚¹æ˜¯ï¼š selectæœ€å¤§çš„ç¼ºé™·å°±æ˜¯å•ä¸ªè¿›ç¨‹æ‰€æ‰“å¼€çš„FDæ˜¯æœ‰ä¸€å®šé™åˆ¶çš„ï¼Œå®ƒç”±FD_SETSIZEè®¾ç½®ï¼Œé»˜è®¤å€¼æ˜¯1024ã€‚ï¼ˆä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ•°ç›®å’Œç³»ç»Ÿå†…å­˜å…³ç³»å¾ˆå¤§ï¼Œå…·ä½“æ•°ç›®å¯ä»¥cat /proc/sys/fs/file-maxæŸ¥çœ‹ã€‚32ä½æœºé»˜è®¤æ˜¯1024ä¸ªã€‚64ä½æœºé»˜è®¤æ˜¯2048ï¼‰ å¯¹socketè¿›è¡Œæ‰«ææ—¶æ˜¯çº¿æ€§æ‰«æï¼Œå³é‡‡ç”¨è½®è¯¢çš„æ–¹æ³•ï¼Œæ•ˆç‡è¾ƒä½ã€‚ï¼ˆå½“å¥—æ¥å­—æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œæ¯æ¬¡select()éƒ½è¦é€šè¿‡éå†FD_SETSIZEä¸ªSocketæ¥å®Œæˆè°ƒåº¦ï¼Œä¸ç®¡å“ªä¸ªSocketæ˜¯æ´»è·ƒçš„ï¼Œéƒ½éå†ä¸€éã€‚è¿™ä¼šæµªè´¹å¾ˆå¤šCPUæ—¶é—´ã€‚å¦‚æœèƒ½ç»™å¥—æ¥å­—æ³¨å†ŒæŸä¸ªå›è°ƒå‡½æ•°ï¼Œå½“ä»–ä»¬æ´»è·ƒæ—¶ï¼Œè‡ªåŠ¨å®Œæˆç›¸å…³æ“ä½œï¼Œé‚£å°±é¿å…äº†è½®è¯¢ï¼Œè¿™æ­£æ˜¯epollä¸kqueueåšçš„ï¼‰ éœ€è¦ç»´æŠ¤ä¸€ä¸ªç”¨æ¥å­˜æ”¾å¤§é‡fdçš„æ•°æ®ç»“æ„ï¼Œè¿™æ ·ä¼šä½¿å¾—ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´åœ¨ä¼ é€’è¯¥ç»“æ„æ—¶å¤åˆ¶å¼€é”€å¤§ã€‚ pollåŸºæœ¬åŸç†pollæœ¬è´¨ä¸Šå’Œselectæ²¡æœ‰åŒºåˆ«ï¼Œå®ƒå°†ç”¨æˆ·ä¼ å…¥çš„æ•°ç»„æ‹·è´åˆ°å†…æ ¸ç©ºé—´ï¼Œç„¶åæŸ¥è¯¢æ¯ä¸ªfdå¯¹åº”çš„è®¾å¤‡çŠ¶æ€ï¼Œå¦‚æœè®¾å¤‡å°±ç»ªåˆ™åœ¨è®¾å¤‡ç­‰å¾…é˜Ÿåˆ—ä¸­åŠ å…¥ä¸€é¡¹å¹¶ç»§ç»­éå†ï¼Œå¦‚æœéå†å®Œæ‰€æœ‰fdåæ²¡æœ‰å‘ç°å°±ç»ªè®¾å¤‡ï¼Œåˆ™æŒ‚èµ·å½“å‰è¿›ç¨‹ï¼Œç›´åˆ°è®¾å¤‡å°±ç»ªæˆ–è€…ä¸»åŠ¨è¶…æ—¶ï¼Œè¢«å”¤é†’åå®ƒåˆè¦å†æ¬¡éå†fdã€‚è¿™ä¸ªè¿‡ç¨‹ç»å†äº†å¤šæ¬¡æ— è°“çš„éå†ã€‚ ä¼˜ç‚¹ å®ƒæ²¡æœ‰æœ€å¤§è¿æ¥æ•°çš„é™åˆ¶ï¼ŒåŸå› æ˜¯å®ƒæ˜¯åŸºäºé“¾è¡¨æ¥å­˜å‚¨çš„ã€‚ ç¼ºç‚¹ å¤§é‡çš„fdçš„æ•°ç»„è¢«æ•´ä½“å¤åˆ¶äºç”¨æˆ·æ€å’Œå†…æ ¸åœ°å€ç©ºé—´ä¹‹é—´ï¼Œè€Œä¸ç®¡è¿™æ ·çš„å¤åˆ¶æ˜¯ä¸æ˜¯æœ‰æ„ä¹‰ã€‚ pollè¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹æ˜¯â€œæ°´å¹³è§¦å‘â€ï¼Œå¦‚æœæŠ¥å‘Šäº†fdåï¼Œæ²¡æœ‰è¢«å¤„ç†ï¼Œé‚£ä¹ˆä¸‹æ¬¡pollæ—¶ä¼šå†æ¬¡æŠ¥å‘Šè¯¥fdã€‚ æ³¨æ„ï¼šä»ä¸Šé¢çœ‹ï¼Œselectå’Œpolléƒ½éœ€è¦åœ¨è¿”å›åï¼Œé€šè¿‡éå†æ–‡ä»¶æè¿°ç¬¦æ¥è·å–å·²ç»å°±ç»ªçš„socketã€‚äº‹å®ä¸Šï¼ŒåŒæ—¶è¿æ¥çš„å¤§é‡å®¢æˆ·ç«¯åœ¨ä¸€æ—¶åˆ»å¯èƒ½åªæœ‰å¾ˆå°‘çš„å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå› æ­¤éšç€ç›‘è§†çš„æè¿°ç¬¦æ•°é‡çš„å¢é•¿ï¼Œå…¶æ•ˆç‡ä¹Ÿä¼šçº¿æ€§ä¸‹é™ã€‚ epollepollæ˜¯åœ¨2.6å†…æ ¸ä¸­æå‡ºçš„ï¼Œæ˜¯ä¹‹å‰çš„selectå’Œpollçš„å¢å¼ºç‰ˆæœ¬ã€‚ç›¸å¯¹äºselectå’Œpollæ¥è¯´ï¼Œepollæ›´åŠ çµæ´»ï¼Œæ²¡æœ‰æè¿°ç¬¦é™åˆ¶ã€‚epollä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ç®¡ç†å¤šä¸ªæè¿°ç¬¦ï¼Œå°†ç”¨æˆ·å…³ç³»çš„æ–‡ä»¶æè¿°ç¬¦çš„äº‹ä»¶å­˜æ”¾åˆ°å†…æ ¸çš„ä¸€ä¸ªäº‹ä»¶è¡¨ä¸­ï¼Œè¿™æ ·åœ¨ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„copyåªéœ€ä¸€æ¬¡ã€‚ åŸºæœ¬åŸç†epollæ”¯æŒæ°´å¹³è§¦å‘å’Œè¾¹ç¼˜è§¦å‘ï¼Œæœ€å¤§çš„ç‰¹ç‚¹åœ¨äºè¾¹ç¼˜è§¦å‘ï¼Œå®ƒåªå‘Šè¯‰è¿›ç¨‹å“ªäº›fdåˆšåˆšå˜ä¸ºå°±ç»ªæ€ï¼Œå¹¶ä¸”åªä¼šé€šçŸ¥ä¸€æ¬¡ã€‚è¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼Œepollä½¿ç”¨â€œäº‹ä»¶â€çš„å°±ç»ªé€šçŸ¥æ–¹å¼ï¼Œé€šè¿‡epoll_ctlæ³¨å†Œfdï¼Œä¸€æ—¦è¯¥fdå°±ç»ªï¼Œå†…æ ¸å°±ä¼šé‡‡ç”¨ç±»ä¼¼callbackçš„å›è°ƒæœºåˆ¶æ¥æ¿€æ´»è¯¥fdï¼Œepoll_waitä¾¿å¯ä»¥æ”¶åˆ°é€šçŸ¥ã€‚ epollå¯¹æ–‡ä»¶æè¿°ç¬¦çš„æ“ä½œæœ‰ä¸¤ç§æ¨¡å¼LTï¼ˆlevel triggerï¼‰å’ŒETï¼ˆedge triggerï¼‰ã€‚LTæ¨¡å¼æ˜¯é»˜è®¤æ¨¡å¼ï¼Œä¸¤è€…åŒºåˆ«å¦‚ä¸‹ï¼š LTæ¨¡å¼ï¼šå½“epoll_waitæ£€æµ‹åˆ°æè¿°ç¬¦äº‹ä»¶å‘ç”Ÿå¹¶å°†æ­¤äº‹ä»¶é€šçŸ¥åº”ç”¨ç¨‹åºï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ä¸ç«‹å³å¤„ç†è¯¥äº‹ä»¶ã€‚ä¸‹æ¬¡è°ƒç”¨epoll_waitæ—¶ï¼Œä¼šå†æ¬¡å“åº”åº”ç”¨ç¨‹åºå¹¶é€šçŸ¥æ­¤äº‹ä»¶ã€‚ ETæ¨¡å¼ï¼šå½“epoll_waitæ£€æµ‹åˆ°æè¿°ç¬¦äº‹ä»¶å‘ç”Ÿå¹¶å°†æ­¤äº‹ä»¶é€šçŸ¥åº”ç”¨ç¨‹åºï¼Œåº”ç”¨ç¨‹åºå¿…é¡»ç«‹å³å¤„ç†è¯¥äº‹ä»¶ã€‚å¦‚æœä¸å¤„ç†ï¼Œä¸‹æ¬¡è°ƒç”¨epoll_waitæ—¶ï¼Œä¸ä¼šå†æ¬¡å“åº”åº”ç”¨ç¨‹åºå¹¶é€šçŸ¥æ­¤äº‹ä»¶ã€‚ ä¼˜ç‚¹ æ²¡æœ‰æœ€å¤§å¹¶å‘è¿æ¥çš„é™åˆ¶ï¼Œèƒ½æ‰“å¼€çš„FDçš„ä¸Šé™è¿œå¤§äº1024ï¼ˆ1Gçš„å†…å­˜ä¸Šèƒ½ç›‘å¬çº¦10ä¸‡ä¸ªç«¯å£ï¼‰ã€‚ æ•ˆç‡æå‡ï¼Œä¸æ˜¯è½®è¯¢çš„æ–¹å¼ï¼Œä¸ä¼šéšç€FDæ•°ç›®çš„å¢åŠ æ•ˆç‡ä¸‹é™ã€‚ åªæœ‰æ´»è·ƒå¯ç”¨çš„FDæ‰ä¼šè°ƒç”¨callbackå‡½æ•°ï¼›å³Epollæœ€å¤§çš„ä¼˜ç‚¹å°±åœ¨äºå®ƒåªç®¡ä½ â€œæ´»è·ƒâ€çš„è¿æ¥ï¼Œè€Œè·Ÿè¿æ¥æ€»æ•°æ— å…³ï¼Œå› æ­¤åœ¨å®é™…çš„ç½‘ç»œç¯å¢ƒä¸­ï¼ŒEpollçš„æ•ˆç‡å°±ä¼šè¿œè¿œé«˜äºselectå’Œpollã€‚ å†…å­˜æ‹·è´ï¼Œåˆ©ç”¨mmap()æ–‡ä»¶æ˜ å°„å†…å­˜åŠ é€Ÿä¸å†…æ ¸ç©ºé—´çš„æ¶ˆæ¯ä¼ é€’ï¼›å³epollä½¿ç”¨mmapå‡å°‘å¤åˆ¶å¼€é”€ã€‚ kqueuekqueueä¸epolléå¸¸ç›¸ä¼¼ï¼Œæœ€åˆæ˜¯2000å¹´Jonathan Lemonåœ¨FreeBSDç³»ç»Ÿä¸Šå¼€å‘çš„ä¸€ä¸ªé«˜æ€§èƒ½çš„äº‹ä»¶é€šçŸ¥æ¥å£ã€‚æ³¨å†Œä¸€æ‰¹socketæè¿°ç¬¦åˆ° kqueue ä»¥åï¼Œå½“å…¶ä¸­çš„æè¿°ç¬¦çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œkqueue å°†ä¸€æ¬¡æ€§é€šçŸ¥åº”ç”¨ç¨‹åºå“ªäº›æè¿°ç¬¦å¯è¯»ã€å¯å†™æˆ–å‡ºé”™äº†ã€‚åªæ˜¯é€‚åº”å¹³å°ä¸å¤šã€‚ å‚è€ƒï¼š ç½‘ç»œé€šä¿¡ â€“&gt; IOå¤šè·¯å¤ç”¨ä¹‹selectã€pollã€epollè¯¦è§£ nginxå¹³å°åˆæ¢ è¿™åº”è¯¥æ˜¯Nginxç³»åˆ—æœ€åä¸€ç¯‡æ–‡ç« äº†ï¼Œå¦‚æœä½ æœ‰ç–‘é—®ï¼Œæ¬¢è¿äº¤æµï¼Œæ°´å¹³æœ‰é™ï¼Œé”™è¯¯æ¬¢è¿æŒ‡æ­£ã€‚ æŠ€æœ¯æ–‡ç« ä¹Ÿå‘å¸ƒåœ¨è‡ªå·±çš„å…¬ä¼—å·ã€çˆ±å¥½å†å²çš„ç¨‹åºå‘˜ã€‘ï¼Œæ¬¢è¿æ‰«ç å…³æ³¨ï¼Œè°¢è°¢ï¼","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"gRPCåˆä½“éªŒ","slug":"gRPCåˆä½“éªŒ","date":"2019-12-20T03:12:47.000Z","updated":"2022-07-05T08:50:14.043Z","comments":true,"path":"2019/12/20/215/","link":"","permalink":"https://github.13sai.com/2019/12/20/215/","excerpt":"","text":"gRPCæ˜¯å¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒä¸­è¿è¡Œçš„ç°ä»£å¼€æºé«˜æ€§èƒ½RPCæ¡†æ¶ã€‚å®ƒå¯ä»¥é€šè¿‡å¯æ’æ‹”çš„æ”¯æŒæ¥æœ‰æ•ˆåœ°è¿æ¥æ•°æ®ä¸­å¿ƒå†…å’Œè·¨æ•°æ®ä¸­å¿ƒçš„æœåŠ¡ï¼Œä»¥å®ç°è´Ÿè½½å¹³è¡¡ï¼Œè·Ÿè¸ªï¼Œè¿è¡ŒçŠ¶å†µæ£€æŸ¥å’Œèº«ä»½éªŒè¯ã€‚å®ƒä¹Ÿé€‚ç”¨äºåˆ†å¸ƒå¼è®¡ç®—çš„æœ€åä¸€è‹±é‡Œï¼Œä»¥å°†è®¾å¤‡ï¼Œç§»åŠ¨åº”ç”¨ç¨‹åºå’Œæµè§ˆå™¨è¿æ¥åˆ°åç«¯æœåŠ¡ã€‚ å®‰è£…protocol buffer ç¼–è¯‘å™¨macï¼š brew install protobuf å…¶ä»–ç³»ç»Ÿå¯ä»¥å°è¯•ç¼–è¯‘å®‰è£… protocolbuffers/protobuf å®‰è£…gprcgo get -u google.golang.org/grpc å®‰è£…protoc-gen-goæ’ä»¶go get -u github.com/golang/protobuf/protoc-gen-go ä½¿ç”¨æ–°å»ºhelloç›®å½•ï¼Œè¿›å…¥åæ‰§è¡Œï¼š protoc --proto_path hello/ --go_out=plugins=grpc:hello hello.proto ä¼šçœ‹åˆ°helloç›®å½•ä¸‹ç”Ÿæˆäº†hello.pb.goæ–‡ä»¶ã€‚ å½“ç„¶ï¼Œå…¶ä¸­çš„ hello.proto æ˜¯é¢„å…ˆè‡ªå®šä¹‰åœ¨helloæ–‡ä»¶å¤¹ä¸‹çš„ï¼Œå¦‚ï¼š syntax = &quot;proto3&quot;; //è¯­æ³•å£°æ˜ package hello; //åŒ…å // å®šä¹‰æœåŠ¡ service Greeter &#123; rpc SayHello (HelloRequest) returns (HelloReply) &#123;&#125; &#125; // è¯·æ±‚æ•°æ®æ ¼å¼ message HelloRequest &#123; string name = 1; &#125; // å“åº”æ•°æ®æ ¼å¼ message HelloReply &#123; string message = 1; &#125; serveræ–°å»ºserverç›®å½•ï¼Œgolangä¾‹å­ä»£ç æ¥è‡ªï¼šhttps://github.com/grpc/grpc-go/tree/master/examples/helloworld // main.go package main import ( &quot;context&quot; &quot;log&quot; &quot;net&quot; &quot;google.golang.org/grpc&quot; pb &quot;local.com/sai/game/grpc/hello&quot; ) const ( port = &quot;:50051&quot; ) // server is used to implement helloworld.GreeterServer. type server struct &#123; pb.UnimplementedGreeterServer &#125; // SayHello implements helloworld.GreeterServer func (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) &#123; log.Printf(&quot;Received: %v&quot;, in.GetName()) return &amp;pb.HelloReply&#123;Message: &quot;Hello &quot; + in.GetName()&#125;, nil &#125; func main() &#123; lis, err := net.Listen(&quot;tcp&quot;, port) if err != nil &#123; log.Fatalf(&quot;failed to listen: %v&quot;, err) &#125; s := grpc.NewServer() pb.RegisterGreeterServer(s, &amp;server&#123;&#125;) if err := s.Serve(lis); err != nil &#123; log.Fatalf(&quot;failed to serve: %v&quot;, err) &#125; &#125; clientgo client// client.go package main import ( &quot;context&quot; &quot;log&quot; &quot;os&quot; &quot;time&quot; &quot;google.golang.org/grpc&quot; pb &quot;local.com/sai/game/grpc/hello&quot; ) const ( address = &quot;127.0.0.1:50051&quot; defaultName = &quot;13sai&quot; ) func main() &#123; // Set up a connection to the server. conn, err := grpc.Dial(address, grpc.WithInsecure(), grpc.WithBlock()) if err != nil &#123; log.Fatalf(&quot;did not connect: %v&quot;, err) &#125; defer conn.Close() c := pb.NewGreeterClient(conn) // Contact the server and print out its response. name := defaultName if len(os.Args) &gt; 1 &#123; name = os.Args[1] &#125; ctx, cancel := context.WithTimeout(context.Background(), time.Second) defer cancel() r, err := c.SayHello(ctx, &amp;pb.HelloRequest&#123;Name: name&#125;) if err != nil &#123; log.Fatalf(&quot;could not greet: %v&quot;, err) &#125; log.Printf(&quot;Greeting: %s&quot;, r.GetMessage()) &#125;` php clientæ‰©å±•å®‰è£… grpcæ‰©å±•ä¸‹è½½ profo ä¸‹è½½å®‰è£…åˆé€‚ç‰ˆæœ¬çš„æ‰©å±•å³å¯ï¼Œè®°å¾—åˆ«å¿˜è®°åœ¨php.iniä¸­åŠ å…¥ï¼š extension=grpc.so extension=protobuf.so è‡ªåŠ¨ç”Ÿæˆä»£ç protoc --php_out=client hello/hello.proto ä¼šçœ‹åˆ°clientç›®å½•ä¸‹ç”Ÿæˆäº†GPBMetadataå’ŒHelloä¸¤ä¸ªç›®å½•ã€‚ å¦‚æœä½ å¯¹grpcç›¸å¯¹è¾ƒç†Ÿç»ƒï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œä»£ç ç¼–å†™ï¼š &lt;?php require __DIR__ . &#x27;/vendor/autoload.php&#x27;; class Client extends \\Grpc\\BaseStub&#123; public function __construct($hostname, $opts, $channel = null) &#123; parent::__construct($hostname, $opts, $channel); &#125; /** * rpc SayHello(HelloRequest) returns (HelloReply) &#123;&#125; * æ–¹æ³•åå°½é‡å’Œ (gprc å®šä¹‰ Greeter æœåŠ¡)çš„æ–¹æ³•ä¸€æ · * ç”¨äºè¯·æ±‚å’Œå“åº”è¯¥æœåŠ¡ */ public function SayHello(\\Hello\\HelloRequest $argument)&#123; // (/hello.Greeter/SayHello) æ˜¯è¯·æ±‚æœåŠ¡ç«¯é‚£ä¸ªæœåŠ¡å’Œæ–¹æ³•ï¼ŒåŸºæœ¬å’Œ proto æ–‡ä»¶å®šä¹‰ä¸€æ · return $this-&gt;_simpleRequest(&#x27;/hello.Greeter/SayHello&#x27;, $argument, [&#x27;\\Hello\\HelloReply&#x27;, &#x27;decode&#x27;] ); &#125; &#125; //ç”¨äºè¿æ¥ æœåŠ¡ç«¯ $client = new \\Client(&#x27;127.0.0.1:50051&#x27;, [ &#x27;credentials&#x27; =&gt; Grpc\\ChannelCredentials::createInsecure() ]); //å®ä¾‹åŒ– TestRequest è¯·æ±‚ç±» $request = new \\Hello\\HelloRequest(); $request-&gt;setName(&quot;fairy&quot;); //è°ƒç”¨è¿œç¨‹æœåŠ¡ $get = $client-&gt;SayHello($request)-&gt;wait(); //è¿”å›æ•°ç»„ //$reply æ˜¯ TestReply å¯¹è±¡ //$status æ˜¯æ•°ç»„ list($reply, $status) = $get; echo $reply-&gt;getMessage().PHP_EOL; // print_r($client-&gt;SayHello($request)); å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨grpc_php_pluginæ’ä»¶ç”Ÿæˆã€‚ grpc-php grpc_php_pluginæ’ä»¶cloneå¤ªæ…¢å¯ä»¥ä½¿ç”¨ç äº‘ git clone -b $(curl -L https://grpc.io/release) https://github.com/grpc/grpc cd grpc #è¿™ä¸€æ­¥å¾ˆæ…¢ï¼Œæš‚æœªæ‰¾åˆ°ä»€ä¹ˆå¥½æ–¹æ³• git submodule update --init make grpc_php_plugin æ–°å»ºphp-clientï¼Œå†æ¥è‡ªåŠ¨ç”Ÿæˆï¼š protoc -I=./hello hello.proto --php_out=./php-client/ --grpc_out=php-client/ --plugin=protoc-gen-grpc=/Users/wangzetao/www/grpc1/bins/opt/grpc_php_plugin ä¼šå‘ç°æ¯”ä¸Šé¢è‡ªåŠ¨ç”Ÿæˆå¤šäº†ä¸€ä¸ªGreeterClient.php &lt;?php // client.php require __DIR__ . &#x27;/vendor/autoload.php&#x27;; //ç”¨äºè¿æ¥ æœåŠ¡ç«¯ $client = new \\Hello\\GreeterClient(&#x27;127.0.0.1:50051&#x27;, [ &#x27;credentials&#x27; =&gt; Grpc\\ChannelCredentials::createInsecure() ]); //å®ä¾‹åŒ– TestRequest è¯·æ±‚ç±» $request = new \\Hello\\HelloRequest(); $request-&gt;setName(&quot;world&quot;); //è°ƒç”¨è¿œç¨‹æœåŠ¡ $get = $client-&gt;SayHello($request)-&gt;wait(); //è¿”å›æ•°ç»„ //$status æ˜¯æ•°ç»„ list($reply, $status) = $get; echo $reply-&gt;getMessage().PHP_EOL; // print_r($client-&gt;SayHello($request)); è¿è¡Œæµ‹è¯• go run grpc/server/main.go go run grpc/client/main.go go run grpc/client/client.php go run grpc/client/php-client.php grpcåˆä½“éªŒå®Œæˆäº†ï¼Œæœ¬æ¬¡åªæ˜¯å°å°çš„ä½¿ç”¨äº†ä¸€ä¸‹å­ï¼Œåç»­æ„Ÿå…´è¶£çš„è¯å¯ä»¥æ·±å…¥å­¦ä¹ ä¸€ä¸‹ã€‚æ–‡ä¸­å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡å‡ºäº¤æµã€‚ æŠ€æœ¯æ–‡ç« ä¹Ÿå‘å¸ƒåœ¨è‡ªå·±çš„å…¬ä¼—å·ã€çˆ±å¥½å†å²çš„ç¨‹åºå‘˜ã€‘ï¼Œæ¬¢è¿æ‰«ç å…³æ³¨ï¼Œè°¢è°¢ï¼","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"gRPC","slug":"gRPC","permalink":"https://github.13sai.com/tags/gRPC/"}]},{"title":"dockerå®‰è£…gogs","slug":"dockerå®‰è£…gogs","date":"2019-12-08T13:19:39.000Z","updated":"2022-03-19T14:35:21.684Z","comments":true,"path":"2019/12/08/214/","link":"","permalink":"https://github.13sai.com/2019/12/08/214/","excerpt":"","text":"docker pull gogs/gogs docker run -itd â€“name=gogs1 -p 10022:22 -p 10023:3000 gogs/gogs æµè§ˆå™¨è¾“å…¥http://127.0.0.1:10023/ ä¸»è¦ä¿®æ”¹çš„å‚æ•°æ˜¯ åº”ç”¨ URL æ•°æ®åº“ç”¨æˆ·å¯†ç  ç®¡ç†å‘˜ä¿¡æ¯ å¦‚æœä½ æœ‰å…¶ä»–ä¿®æ”¹ï¼Œè‡ªè¡Œä¿®æ”¹å³å¯ã€‚ ç‚¹å‡»ç«‹å³å®‰è£…æŒ‰é’®ï¼ŒæŒ‰ç†è¯´ä¼šè·³åˆ°3000ç«¯å£åœ°å€ï¼Œä½ æ¢æˆ10023å°±å¥½äº†ã€‚ ç„¶åä½ å°±å¯ä»¥è‡ªè¡Œåˆ›å»ºï¼Œå¼€å§‹gogsä¹‹æ—…äº†ã€‚ å¦å¤–ï¼Œé…ç½®æ–‡ä»¶åœ¨å®¹å™¨çš„/data/gogs/conf/app.iniã€‚ è¯¦ç»†é…ç½®æ–‡ä»¶æ‰‹å†Œï¼ˆæ¥è‡ªgithubï¼‰æ¦‚è§ˆ åç§° æè¿° APP_NAME åº”ç”¨åç§°ï¼Œå¯ä»¥æ”¹æˆæ‚¨çš„ç»„ç»‡æˆ–å…¬å¸åç§° RUN_USER è¿è¡Œåº”ç”¨çš„ç”¨æˆ·åç§°ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨ä½¿ç”¨ gitï¼Œä½†å¦‚æœæ‚¨åœ¨ä¸ªäººè®¡ç®—æœºä¸Šè¿è¡Œ Gogsï¼Œè¯·ä¿®æ”¹ä¸ºæ‚¨çš„ç³»ç»Ÿç”¨æˆ·åç§°ã€‚å¦‚æœæ²¡æœ‰æ­£ç¡®è®¾ç½®è¿™ä¸ªå€¼ï¼Œå¾ˆå¯èƒ½å¯¼è‡´æ‚¨çš„åº”ç”¨å´©æºƒ RUN_MODE é‰´äºæ€§èƒ½å’Œå…¶å®ƒè€ƒè™‘ï¼Œå»ºè®®åœ¨éƒ¨ç½²ç¯å¢ƒä¸‹ä¿®æ”¹ä¸º prod æ¨¡å¼ã€‚åœ¨æ‚¨å®Œæˆå®‰è£…æ“ä½œæ—¶ï¼Œè¯¥å€¼ä¹Ÿä¼šè¢«è®¾ç½®ä¸º prod æœåŠ¡å™¨ (server) åç§° æè¿° PROTOCOL http æˆ– https DOMAIN æœåŠ¡å™¨åŸŸå ROOT_URL å…¬å¼€çš„å®Œæ•´ URL è·¯å¾„ HTTP_ADDR åº”ç”¨ HTTP ç›‘å¬åœ°å€ HTTP_PORT åº”ç”¨ HTTP ç›‘å¬ç«¯å£å· UNIX_SOCKET_PERMISSION Unix å¥—æ¥å­—æ–‡ä»¶çš„æƒé™ LOCAL_ROOT_URL ç”¨äº Gogs å·¥ä½œè¿›ç¨‹ï¼ˆå¦‚ï¼šSSHï¼‰å›è®¿åº”ç”¨çš„æœ¬åœ°ï¼ˆDMZï¼‰URLï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¯·ä¿æŒé»˜è®¤å€¼ï¼Œé™¤éæ‚¨çš„ SSH æœåŠ¡å™¨èŠ‚ç‚¹ä¸ HTTP å¹¶ä¸æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹å…¥å£ DISABLE_SSH å½“ SSH åŠŸèƒ½ä¸å¯ç”¨æ—¶å¯ä»¥ç¦ç”¨ START_SSH_SERVER å¯ç”¨è¯¥é€‰é¡¹æ¥å¯åŠ¨å†…ç½® SSH æœåŠ¡å™¨ SSH_DOMAIN å…è®¸å…¬ç”¨ç½‘ç»œè®¿é—® SSH çš„åŸŸå SSH_PORT SSH ç«¯å£å·ï¼Œå¦‚æœä¸ä¸º 22 çš„è¯å¯ä»¥åœ¨æ­¤ä¿®æ”¹ SSH_LISTEN_HOST å†…ç½® SSH æœåŠ¡å™¨ç›‘å¬çš„åœ°å€ SSH_LISTEN_PORT å†…ç½® SSH æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£ SSH_ROOT_PATH SSH æ ¹ç›®å½•ï¼Œä¸€èˆ¬ä¸º ~/.sshï¼Œä½†å¿…é¡»å¡«å†™ä¸º /home/git/.ssh REWRITE_AUTHORIZED_KEYS_AT_START æ¿€æ´»è¯¥é€‰é¡¹ä»¥åœ¨åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨é‡å†™ authorized_keys æ–‡ä»¶ï¼Œè¯¥é€‰é¡¹åœ¨ä½¿ç”¨å†…ç½® SSH æœåŠ¡å™¨æ—¶å°†ä¼šè¢«è‡ªåŠ¨ç¦ç”¨ SSH_KEY_TEST_PATH ç”¨äºæµ‹è¯• SSH å…¬é’¥çš„ä¸´æ—¶ç›®å½• SSH_KEYGEN_PATH ssh-keygen ç¨‹åºçš„è·¯å¾„ï¼Œé»˜è®¤ä¸º ssh-keygen å³é€šè¿‡ç³»ç»Ÿè·¯å¾„æŸ¥æ‰¾ MINIMUM_KEY_SIZE_CHECK æŒ‡å®šä¸åŒç±»å‹çš„å…¬é’¥çš„æœ€å°å¯†é’¥å¤§å° OFFLINE_MODE æ¿€æ´»è¯¥é€‰é¡¹æ¥ç¦æ­¢ä» CDN è·å–é™æ€èµ„æºï¼ŒåŒæ—¶ Gravatar æœåŠ¡ä¹Ÿå°†è¢«è‡ªåŠ¨ç¦ç”¨ DISABLE_ROUTER_LOG æ¿€æ´»è¯¥é€‰é¡¹æ¥ç¦æ­¢æ‰“å°è·¯ç”±æ—¥å¿— CERT_FILE HTTPS æˆæƒæ–‡ä»¶è·¯å¾„ KEY_FILE HTTPS çš„å¯†é’¥æ–‡ä»¶è·¯å¾„ STATIC_ROOT_PATH æ¨¡æ¿æ–‡ä»¶å’Œé™æ€æ–‡ä»¶çš„ä¸Šçº§ç›®å½•ï¼Œé»˜è®¤ä¸ºåº”ç”¨äºŒè¿›åˆ¶æ‰€åœ¨çš„ä½ç½® APP_DATA_PATH åº”ç”¨å†…éƒ¨æ•°æ®çš„å­˜æ”¾ç›®å½• ENABLE_GZIP æ¿€æ´»è¯¥é€‰é¡¹æ¥å¯ç”¨åº”ç”¨çº§åˆ« GZIP æ”¯æŒ LANDING_PAGE æœªç™»å½•ç”¨æˆ·çš„é»˜è®¤é¦–é¡µï¼Œå¯ä»¥æ˜¯ home æˆ– exploreï¼ˆæ¢ç´¢é¡µï¼‰ ä»“åº“ (repository) åç§° æè¿° ROOT ç”¨æˆ·ä»“åº“å­˜å‚¨æ ¹ç›®å½•ï¼Œå¿…é¡»ä¸ºç»å¯¹è·¯å¾„ï¼Œé»˜è®¤ä¸º ~/&lt;user name&gt;/gogs-repositories SCRIPT_TYPE ç³»ç»Ÿè„šæœ¬ç±»å‹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å‡ä¸º bashï¼Œä½†æœ‰äº›ç”¨æˆ·ååº”åªèƒ½ä½¿ç”¨ sh ANSI_CHARSET å½“é‡åˆ°æ— æ³•è¯†åˆ«çš„å­—ç¬¦é›†æ—¶ä½¿ç”¨çš„é»˜è®¤å­—ç¬¦é›† FORCE_PRIVATE å¼ºåˆ¶è¦æ±‚æ‰€æœ‰æ–°å»ºçš„ä»“åº“éƒ½æ˜¯ç§æœ‰çš„ MAX_CREATION_LIMIT å…¨å±€é»˜è®¤çš„æ¯ä¸ªç”¨æˆ·å¯åˆ›å»ºåˆ›å»ºä»“åº“ä¸Šé™ï¼Œ-1 è¡¨ç¤ºæ— é™åˆ¶ PREFERRED_LICENSES å»ºè®®ç”¨æˆ·é¦–é€‰çš„æˆæƒç±»å‹ DISABLE_HTTP_GIT æ¿€æ´»è¯¥é€‰é¡¹æ¥ç¦æ­¢ç”¨æˆ·é€šè¿‡ HTTP å¯¹ Git ä»“åº“è¿›è¡Œäº¤äº’æ“ä½œï¼Œå³ç”¨æˆ·åªèƒ½é€šè¿‡ SSH æ“ä½œ ENABLE_LOCAL_PATH_MIGRATION æ¿€æ´»è¯¥é€‰é¡¹æ¥å¯ç”¨æœ¬åœ°è·¯å¾„è¿ç§»ä»“åº“åŠŸèƒ½ã€‚å¯åŠ¨åé»˜è®¤åªæœ‰ç®¡ç†å‘˜å¯ä»¥ä½¿ç”¨ï¼Œæ™®é€šç”¨æˆ·å¿…é¡»ç»ç”±ç®¡ç†å‘˜æˆæƒ ENABLE_RAW_FILE_RENDER_MODE æ¿€æ´»è¯¥é€‰é¡¹æ¥å¯ç”¨åœ¨æŸ¥çœ‹åŸå§‹æ•°æ®æ—¶å¯¹é¡µé¢è¿›è¡ŒçœŸå®æ¸²æŸ“ï¼Œä¾‹å¦‚æ¸²æŸ“å®é™…çš„ HTML é¡µé¢ï¼Œæœ‰æ½œåœ¨å®‰å…¨éšæ‚£ ä»“åº“ - ç¼–è¾‘å™¨ (repository.editor) åç§° æè¿° LINE_WRAP_EXTENSIONS éœ€è¦æ˜¾ç¤ºä¸ºè¡ŒåŒ…è£…çš„æ–‡ä»¶ååç¼€ï¼Œé€šè¿‡é€—å·åˆ†éš”ã€‚å¦‚æœæ˜¯æ— åç¼€åçš„æ–‡ä»¶ï¼Œåˆ™å•ç‹¬æ”¾ç½®ä¸€ä¸ªé€—å·ï¼Œä¾‹å¦‚ï¼š.txt, ä»“åº“ - æ–‡ä»¶ä¸Šä¼  (repository.upload) åç§° æè¿° ENABLED æ¿€æ´»è¯¥é€‰é¡¹æ¥å¯ç”¨ä»“åº“æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ TEMP_PATH æ–‡ä»¶ä¸Šä¼ çš„ä¸´æ—¶å­˜æ”¾ç›®å½• ALLOWED_TYPES å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ï¼ˆä¾‹å¦‚ï¼šâ€image/jpeg|image/pngâ€ï¼‰ï¼Œç•™ç©ºè¡¨ç¤ºå…è®¸ä¸Šä¼ ä»»æ„ç±»å‹çš„æ–‡ä»¶ FILE_MAX_SIZE å•ä¸ªä¸Šä¼ çš„æ–‡ä»¶çš„æœ€å¤§ä½“ç§¯ï¼Œä»¥ MB ä¸ºå•ä½ MAX_FILES å•æ¬¡åŒæ—¶ä¸Šä¼ çš„æœ€å¤šæ–‡ä»¶ä¸ªæ•° ç‰ˆæœ¬å‘å¸ƒ - é™„ä»¶ (release.attachment) åç§° æè¿° ENABLED æ¿€æ´»è¯¥é€‰é¡¹æ¥å¯ç”¨ç‰ˆæœ¬å‘å¸ƒé™„ä»¶åŠŸèƒ½ PATH å­˜æ”¾é™„ä»¶çš„è·¯å¾„ ALLOWED_TYPES å…è®¸ä¸Šä¼ çš„ MIME ç±»å‹ï¼Œä¾‹å¦‚ â€œimage/jpeg|image/pngâ€ï¼Œä½¿ç”¨ */* å…è®¸æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶ MAX_SIZE æœ€å¤§å…è®¸ä¸Šä¼ çš„é™„ä»¶ä½“ç§¯ï¼Œå•ä½ä¸º MBï¼Œä¾‹å¦‚ 32 MAX_FILES æœ€å¤§å…è®¸ä¸€æ¬¡æ€§ä¸Šä¼ çš„é™„ä»¶ä¸ªæ•°ï¼Œä¾‹å¦‚ 10 Markdown (markdown) åç§° æè¿° ENABLE_HARD_LINE_BREAK æŒ‡ç¤ºæ˜¯å¦å¯ç”¨ç¡¬æ€§æ¢è¡Œæ‰©å±• CUSTOM_URL_SCHEMES å…è®¸è¢«è§£æä¸ºé“¾æ¥çš„è‡ªå®šä¹‰ URL æ–¹æ¡ˆï¼Œä¾‹å¦‚ gitï¼ˆç”¨äº git://ï¼‰å’Œmagnetï¼ˆç”¨äº magnet://ï¼‰ FILE_EXTENSIONS éœ€è¦è¢«æ¸²æŸ“ä¸º Markdown æ ¼å¼çš„æ–‡ä»¶ååç¼€ï¼Œé€šè¿‡é€—å·åˆ†éš”ã€‚å¦‚æœæ˜¯æ— åç¼€åçš„æ–‡ä»¶ï¼Œåˆ™å•ç‹¬æ”¾ç½®ä¸€ä¸ªé€—å·ï¼Œä¾‹å¦‚ï¼š.markdown, Smartypants (smartypants) åç§° æè¿° ENABLED æŒ‡ç¤ºæ˜¯å¦å¯ç”¨ Smartypants æ‰©å±• HTTP (http) åç§° æè¿° ACCESS_CONTROL_ALLOW_ORIGIN å¤´ä¿¡æ¯ Access-Control-Allow-Origin çš„è‡ªå®šä¹‰å€¼ï¼Œé»˜è®¤ä¸ºç©ºï¼Œå³ä¸å“åº”æ­¤å¤´ä¿¡æ¯ æ•°æ®åº“ (database) åç§° æè¿° DB_TYPE æ•°æ®åº“ç±»å‹ï¼Œå¯ä»¥æ˜¯ mysqlã€postgresã€mssql æˆ– sqlite3 HOST æ•°æ®åº“ä¸»æœºåœ°å€ä¸ç«¯å£ NAME æ•°æ®åº“åç§° USER æ•°æ®åº“ç”¨æˆ·å PASSWD æ•°æ®åº“ç”¨æˆ·å¯†ç  SSL_MODE ä»…é™ PostgreSQL ä½¿ç”¨ PATH ä»…é™ SQLite3 ä½¿ç”¨ï¼Œæ•°æ®åº“æ–‡ä»¶è·¯å¾„ åº”ç”¨ç®¡ç† (admin) åç§° æè¿° DISABLE_REGULAR_ORG_CREATION æ¿€æ´»è¯¥é€‰é¡¹æ¥ç¦æ­¢æ™®é€šç”¨æˆ·ï¼ˆéç®¡ç†å‘˜ï¼‰åˆ›å»ºç»„ç»‡ å®‰å…¨ (security) åç§° æè¿° INSTALL_LOCK ç”¨äºæŒ‡ç¤ºæ˜¯å¦å…è®¸è®¿é—®å®‰è£…é¡µé¢ï¼ˆè¯¥é¡µé¢å¯ä»¥è®¾ç½®ç®¡ç†å‘˜å¸å·ï¼Œå› æ­¤è¯¥é€‰é¡¹éå¸¸é‡è¦ï¼‰ SECRET_KEY å…¨å±€çš„åŠ å¯†å¯†é’¥ï¼ŒåŠ¡å¿…ä¿®æ”¹è¯¥å€¼ä»¥ç¡®ä¿æ‚¨çš„æœåŠ¡å™¨å®‰å…¨ï¼ˆä¼šåœ¨æ¯æ¬¡å®‰è£…æ—¶è‡ªåŠ¨ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ï¼‰ LOGIN_REMEMBER_DAYS è®°ä½ç™»å½•çš„å¤©æ•° COOKIE_USERNAME è®°å½•ç”¨æˆ·åçš„ Cookie åç§° COOKIE_REMEMBER_NAME è®°å½•ç”¨æˆ·è‡ªåŠ¨ç™»å½•ä¿¡æ¯çš„ Cookie åç§° REVERSE_PROXY_AUTHENTICATION_USER åå‘ä»£ç†è®¤è¯ç”¨æˆ·çš„ Header å­—æ®µå æœåŠ¡ (service) åç§° æè¿° ACTIVE_CODE_LIVE_MINUTES æ¿€æ´»ç çš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºåˆ†é’Ÿ RESET_PASSWD_CODE_LIVE_MINUTES é‡ç½®å¯†ç çš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºåˆ†é’Ÿ REGISTER_EMAIL_CONFIRM æ¿€æ´»è¯¥é€‰é¡¹æ¥è¦æ±‚æ³¨å†Œç”¨æˆ·å¿…é¡»éªŒè¯é‚®ç®±ï¼Œè¦æ±‚å·²å¯ç”¨ Mailer DISABLE_REGISTRATION æ¿€æ´»è¯¥é€‰é¡¹æ¥ç¦æ­¢ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ï¼Œåªèƒ½ç”±ç®¡ç†å‘˜åˆ›å»ºå¸å· SHOW_REGISTRATION_BUTTON ç”¨äºæŒ‡ç¤ºæ˜¯å¦æ˜¾ç¤ºæ³¨å†ŒæŒ‰é’® REQUIRE_SIGNIN_VIEW æ¿€æ´»è¯¥é€‰é¡¹æ¥è¦æ±‚ç”¨æˆ·å¿…é¡»ç™»å½•æ‰èƒ½æµè§ˆä»»ä½•é¡µé¢ ENABLE_CACHE_AVATAR æ¿€æ´»è¯¥é€‰é¡¹æ¥ç¼“å­˜ Gravatar çš„å¤´åƒ ENABLE_NOTIFY_MAIL æ¿€æ´»è¯¥é€‰é¡¹æ¥å‘é€é€šçŸ¥é‚®ä»¶ç»™å…³æ³¨è€…ï¼Œä¾‹å¦‚åˆ›å»º issue æ—¶ï¼Œè¦æ±‚å·²å¯ç”¨ Mailer ENABLE_REVERSE_PROXY_AUTHENTICATION æ¿€æ´»è¯¥é€‰é¡¹æ¥å¼€å¯åå‘ä»£ç†ç”¨æˆ·è®¤è¯ï¼Œè¯·ä» #165 äº†è§£æ›´å¤šä¿¡æ¯ ENABLE_REVERSE_PROXY_AUTO_REGISTRATION æ¿€æ´»è¯¥é€‰é¡¹æ¥å¼€å¯åå‘ä»£ç†ç”¨æˆ·è®¤è¯çš„è‡ªåŠ¨æ³¨å†ŒåŠŸèƒ½ DISABLE_MINIMUM_KEY_SIZE_CHECK æ¿€æ´»è¯¥é€‰é¡¹æ¥ç¦æ­¢æ£€æŸ¥å“åº”ç±»å‹çš„å¯†é’¥æœ€å°é•¿åº¦ ENABLE_CAPTCHA æ¿€æ´»è¯¥é€‰é¡¹ä»¥åœ¨ç”¨æˆ·æ³¨å†Œæ—¶è¦æ±‚è¾“å…¥éªŒè¯ç  Web é’©å­ (webhook) åç§° æè¿° TYPES å¯åŠ¨çš„ Web é’©å­ç±»å‹ï¼Œå¯ä»¥æ˜¯ gogsã€slackã€discordæˆ–dingtalk QUEUE_LENGTH Webé’©å­é˜Ÿåˆ—é•¿åº¦ï¼Œå¦‚æœå‘ç°éƒ¨åˆ†Webhookæœªèƒ½æˆåŠŸè§¦å‘ï¼Œå¯è€ƒè™‘å¢åŠ è¯¥å€¼ DELIVER_TIMEOUT å‘é€é€šçŸ¥çš„è¶…æ—¶æ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ SKIP_TLS_VERIFY æŒ‡ç¤ºæ˜¯å¦å…è®¸å‘å…·æœ‰éä¿¡ä»»è¯ä¹¦çš„åœ°å€å‘é€é€šçŸ¥ PAGING_NUM Web é’©å­å†å²é¡µé¢æ¯é¡µæ˜¾ç¤ºè®°å½•æ¡æ•° é‚®ä»¶ (mailer) åç§° æè¿° ENABLED å¯ç”¨è¯¥é€‰é¡¹ä»¥æ¿€æ´»é‚®ä»¶æœåŠ¡ SUBJECT_PREFIX é‚®ä»¶æ ‡é¢˜çš„å‰ç¼€ HOST SMTP ä¸»æœºåœ°å€ä¸ç«¯å£ DISABLE_HELO ç¦ç”¨ HELO æ“ä½œ HELO_HOSTNAME HELO æ“ä½œçš„è‡ªå®šä¹‰ä¸»æœºå SKIP_VERIFY ä¸éªŒè¯è‡ªç­¾å‘è¯ä¹¦çš„æœ‰æ•ˆæ€§ FROM é‚®ç®±çš„æ¥è‡ªåœ°å€ï¼Œéµå¾ª RFC 5322è§„èŒƒï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå•çº¯çš„é‚®ç®±åœ°å€æˆ–è€… &quot;åå­—&quot; &lt;email@example.com&gt; çš„å½¢å¼ USER é‚®ç®±ç”¨æˆ·å PASSWD é‚®ç®±å¯†ç  USE_PLAIN_TEXT ä½¿ç”¨ text/plain ä½œä¸ºé‚®ä»¶å†…å®¹æ ¼å¼ å¤‡æ³¨ï¼šGogs ä»…æ”¯æŒä½¿ç”¨ STARTTLS çš„ SMTP åè®® ç¼“å­˜ (cache) åç§° æè¿° ADAPTER ç¼“å­˜å¼•æ“é€‚é…å™¨ï¼Œå¯ä»¥ä¸º memoryã€redis æˆ– memcacheã€‚å¦‚æœæ‚¨ä½¿ç”¨ redis æˆ– memcacheï¼Œè¯·ç¡®ä¿ä½¿ç”¨ -tags é€‰é¡¹é‡æ–°æ„å»ºæ‰€æœ‰ä¾èµ–ï¼Œä¾‹å¦‚ï¼šgo build -tags=&#39;redis&#39; INTERVAL ä»…é™å†…å­˜ç¼“å­˜ä½¿ç”¨ï¼ŒGC å‘¨æœŸï¼Œå•ä½ä¸ºç§’ HOST ä»…é™ redis å’Œ memcache ä½¿ç”¨ï¼Œä¸»æœºåœ°å€å’Œç«¯å£å· - Redisï¼šnetwork=tcp,addr=127.0.0.1:6379,password=macaron,db=0,pool_size=100,idle_timeout=180 - Memacheï¼š127.0.0.1:9090;127.0.0.1:9091 ä¼šè¯ (session) åç§° æè¿° PROVIDER Session å¼•æ“æä¾›è€…ï¼Œå¯ä»¥æ˜¯ memoryã€fileã€redis æˆ– mysql PROVIDER_CONFIG å¦‚æœæä¾›è€…ä¸º fileï¼Œåˆ™ä¸ºæ–‡ä»¶æ ¹ç›®å½•ï¼›å¦‚æœä¸ºå…¶å®ƒæä¾›è€…ï¼Œåˆ™ä¸ºä¸»æœºåœ°å€å’Œç«¯å£å· COOKIE_SECURE æ¿€æ´»è¯¥é€‰é¡¹ä»¥è¦æ±‚æ‰€æœ‰ session æ“ä½œå‡é€šè¿‡ HTTPS GC_INTERVAL_TIME GC å‘¨æœŸï¼Œå•ä½ä¸ºç§’ å›¾ç‰‡ (picture) åç§° æè¿° AVATAR_UPLOAD_PATH å­˜æ”¾ç”¨æˆ·ä¸Šä¼ å¤´åƒçš„ç›®å½• GRAVATAR_SOURCE å¯ä»¥æ˜¯ gravatarã€duoshuo æˆ–ä»»ä½• URLï¼Œä¾‹å¦‚ï¼šhttp://cn.gravatar.com/avatar/ DISABLE_GRAVATAR æ¿€æ´»è¯¥é€‰é¡¹æ¥ä»…ä½¿ç”¨æœ¬åœ°å¤´åƒ ENABLE_FEDERATED_AVATAR æ¿€æ´»è¯¥é€‰é¡¹æ¥å¯ç”¨ Federated å¤´åƒæœåŠ¡ï¼ˆhttp://www.libravatar.orgï¼‰ï¼Œå½“ Gravatar è¢«ç¦ç”¨æ—¶æ­¤é€‰é¡¹æ— æ³•ç”Ÿæ•ˆ é™„ä»¶ (attachment) åç§° æè¿° ENABLED æ¿€æ´»è¯¥é€‰é¡¹ä»¥å…è®¸ç”¨æˆ·ä¸Šä¼ é™„ä»¶ PATH å­˜æ”¾é™„ä»¶çš„è·¯å¾„ ALLOWED_TYPES å…è®¸ä¸Šä¼ çš„ MIME ç±»å‹ï¼Œä¾‹å¦‚ â€œimage/jpeg|image/pngâ€ï¼Œä½¿ç”¨ */* å…è®¸æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶ MAX_SIZE æœ€å¤§å…è®¸ä¸Šä¼ çš„é™„ä»¶ä½“ç§¯ï¼Œå•ä½ä¸º MBï¼Œä¾‹å¦‚ 4 MAX_FILES æœ€å¤§å…è®¸ä¸€æ¬¡æ€§ä¸Šä¼ çš„é™„ä»¶ä¸ªæ•°ï¼Œä¾‹å¦‚ 5 æ—¶é—´ (time) åç§° æè¿° FORMAT æŒ‡å®šæ—¥æœŸçš„è¾“å‡ºæ ¼å¼ï¼Œé»˜è®¤ä¸º RFC1123ï¼Œå…¶å®ƒå¯é€‰çš„æ ¼å¼ä¸º ANSICã€UnixDateã€RubyDateã€RFC822ã€RFC822Zã€RFC850ã€RFC1123ã€RFC1123Zã€RFC3339ã€RFC3339Nanoã€Kitchenã€Stampã€StampMilliã€StampMicro å’Œ StampNanoã€‚è®¿é—® http://golang.org/pkg/time/#pkg-constants æŸ¥çœ‹è¯¦æƒ… æ—¥å¿— (log) åç§° æè¿° ROOT_PATH æ—¥å¿—æ–‡ä»¶çš„æ ¹ç›®å½• MODE æ—¥å¿—è®°å½•æ¨¡å¼ï¼Œé»˜è®¤ä¸º consoleã€‚å¦‚æœæƒ³è¦å¼€å¯å¤šæ¨¡å¼ï¼Œè¯·ä½¿ç”¨é€—å·åˆ†å‰²ï¼Œä¾‹å¦‚ï¼š&quot;console, file&quot; LEVEL åŸºæœ¬æ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤ä¸º Trace æ—¥å¿— - æ§åˆ¶å° (log.console) åç§° æè¿° LEVEL æ§åˆ¶å°æ—¥å¿—çº§åˆ«ï¼Œç•™ç©ºåˆ™ç»§æ‰¿çˆ¶å€¼ æ—¥å¿— - æ–‡ä»¶ (log.file) åç§° æè¿° LEVEL æ–‡ä»¶æ—¥å¿—çº§åˆ«ï¼Œç•™ç©ºåˆ™ç»§æ‰¿çˆ¶å€¼ LOG_ROTATE æ¿€æ´»è¯¥é€‰é¡¹ä»¥å¯ç”¨æ—¥å¿—æ–‡ä»¶è‡ªè½¬ DAILY_ROTATE æ¿€æ´»è¯¥é€‰é¡¹ä»¥è¿›è¡Œæ—¥å¸¸è‡ªè½¬ MAX_SIZE_SHIFT è‡ªè½¬éœ€è¦è¾¾åˆ°çš„æœ€å¤§æ–‡ä»¶ä½“ç§¯ï¼Œä½¿ç”¨ä½å·¦ç§»ï¼Œé»˜è®¤ä¸º 28 å³ 1 &lt;&lt; 28ï¼Œè¡¨ç¤º 256MB MAX_LINES è‡ªè½¬éœ€è¦è¾¾åˆ°çš„æœ€å¤§æ–‡ä»¶è¡Œæ•°ï¼Œé»˜è®¤ä¸º 1000000 MAX_DAYS ä¿ç•™è‡ªè½¬æ–‡ä»¶çš„æœ€é•¿æœŸé™ï¼Œé»˜è®¤ä¸º 7 å¤©ååˆ é™¤ æ—¥å¿— - Slack (log.slack) åç§° æè¿° LEVEL Slack æ—¥å¿—çº§åˆ«ï¼Œç•™ç©ºåˆ™ç»§æ‰¿çˆ¶å€¼ URL Slack Web é’©å­ URL æ—¥å¿— - Discord (log.discord) åç§° æè¿° LEVEL Discord æ—¥å¿—çº§åˆ«ï¼Œç•™ç©ºåˆ™ç»§æ‰¿çˆ¶å€¼ URL Discord Web é’©å­ URL USERNAME åœ¨ Web é’©å­ä¸­æ˜¾ç¤ºçš„ç”¨æˆ·å Cron (cron) åç§° æè¿° ENABLED æ¿€æ´»è¯¥é€‰é¡¹ä»¥å…è®¸å‘¨æœŸæ€§è¿è¡Œ Cron ä»»åŠ¡ RUN_AT_START æ¿€æ´»è¯¥é€‰é¡¹ä»¥å…è®¸åœ¨å¯åŠ¨æ—¶æ‰§è¡Œ Cron ä»»åŠ¡ Cron - æ›´æ–°é•œåƒ (cron.update_mirrors) åç§° æè¿° SCHEDULE å®šæ—¶æ›´æ–°ä»“åº“é•œåƒçš„ Cron è¯­æ³•ï¼Œä¾‹å¦‚ï¼š@every 1h Cron - ä»“åº“å¥åº·æ£€æŸ¥ (cron.repo_health_check) åç§° æè¿° SCHEDULE å®šæ—¶è¿›è¡Œä»“åº“å¥åº·æ£€æŸ¥çš„ Cron è¯­æ³•ï¼Œä¾‹å¦‚ï¼š@every 24h TIMEOUT ä»“åº“å¥åº·æ£€æŸ¥è¶…æ—¶çš„å®šä¹‰è¯­æ³•ï¼Œä¾‹å¦‚ï¼š60s ARGS git fsck å‘½ä»¤çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š--unreachable --tags Cron - ä»“åº“ç»Ÿè®¡æ£€æŸ¥ (cron.check_repo_stats) åç§° æè¿° RUN_AT_START æ¿€æ´»è¯¥é€‰é¡¹ä»¥åœ¨å¯åŠ¨æ—¶æ‰§è¡Œä»“åº“ç»Ÿè®¡æ£€æŸ¥ SCHEDULE å®šæ—¶è¿›è¡Œä»“åº“ç»Ÿè®¡æ£€æŸ¥çš„ Cron è¯­æ³•ï¼Œä¾‹å¦‚ï¼š@every 24h Cron - ä»“åº“å½’æ¡£æ¸…ç† (cron.repo_archive_cleanup) åç§° æè¿° RUN_AT_START æ¿€æ´»è¯¥é€‰é¡¹ä»¥åœ¨å¯åŠ¨æ—¶æ‰§è¡Œä»“åº“å½’æ¡£æ¸…ç† SCHEDULE å®šæ—¶è¿›è¡Œä»“åº“å½’æ¡£æ¸…ç†çš„ Cron è¯­æ³•ï¼Œä¾‹å¦‚ï¼š@every 24h OLDER_THAN ä»“åº“å½’æ¡£çš„æ–‡ä»¶æœ‰æ•ˆæœŸï¼Œè¿‡æœŸçš„å½’æ¡£å°†è¢«æ¸…ç†ï¼Œä¾‹å¦‚ï¼š24h Git (git) åç§° æè¿° DISABLE_DIFF_HIGHLIGHT æ¿€æ´»è¯¥é€‰é¡¹ä»¥ç¦ç”¨è¡Œå†…å·®å¼‚é«˜äº® MAX_GIT_DIFF_LINES å·®å¼‚å¯¹æ¯”é¡µé¢å•ä¸ªæ–‡ä»¶æ˜¾ç¤ºçš„æœ€å¤§è¡Œæ•° MAX_GIT_DIFF_LINE_CHARACTERS å·®å¼‚å¯¹æ¯”é¡µé¢å•è¡Œæ˜¾ç¤ºçš„æœ€å¤§å­—ç¬¦æ•° MAX_GIT_DIFF_FILES å·®å¼‚å¯¹æ¯”é¡µé¢æ–‡ä»¶æ˜¾ç¤ºçš„æœ€å¤šä¸ªæ•° GC_ARGS git gc å‘½ä»¤çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š--aggressive --auto Git - è¶…æ—¶ (git.timeout) åç§° æè¿° MIGRATE ä»“åº“è¿ç§»æ“ä½œè¶…æ—¶ï¼Œé»˜è®¤ä¸º 600 ç§’ MIRROR ä»“åº“é•œåƒåŒæ­¥æ“ä½œè¶…æ—¶ï¼Œé»˜è®¤ä¸º 300 ç§’ CLONE ä»“åº“å…‹éš†æ“ä½œè¶…æ—¶ï¼Œé»˜è®¤ä¸º 300 ç§’ PULL ä»“åº“æ‹‰å–æ“ä½œè¶…æ—¶ï¼Œé»˜è®¤ä¸º 300 ç§’ GC ä»“åº“åƒåœ¾å›æ”¶æ“ä½œè¶…æ—¶ï¼Œé»˜è®¤ä¸º 60 ç§’ UI (ui) åç§° æè¿° EXPLORE_PAGING_NUM æ¢ç´¢é¡µé¢æ¯é¡µæ˜¾ç¤ºä»“åº“çš„æ•°é‡ ISSUE_PAGING_NUM æ¯é¡µæ˜¾ç¤ºå·¥å•ï¼ˆIssueï¼‰çš„æ•°é‡ï¼ˆåº”ç”¨åˆ°æ‰€æœ‰ä»¥åˆ—è¡¨å½¢å¼æ˜¾ç¤ºå·¥å•çš„é¡µé¢ï¼‰ FEED_MAX_COMMIT_NUM ä¸€æ¡æœ€æ–°æ´»åŠ¨ä¸­æ˜¾ç¤ºä»£ç æäº¤ï¼ˆCommitï¼‰çš„æœ€å¤§æ•°é‡ THEME_COLOR_META_TAG è¢«ç”¨äº Android &gt;= 5.0 ç‰ˆæœ¬ â€œtheme-colorâ€ æ ‡è®°çš„å€¼ï¼Œæ— æ•ˆçš„å€¼å°†è¢«å¿½ç•¥å¹¶ä½¿ç”¨é»˜è®¤å€¼ï¼ˆæŸ¥çœ‹è¯¦æƒ…ï¼‰ MAX_DISPLAY_FILE_SIZE æ˜¾ç¤ºåˆ°é¡µé¢çš„æœ€å¤§æ–‡ä»¶ä½“ç§¯ï¼ˆByteï¼‰ UI - Admin (ui.admin) åç§° æè¿° USER_PAGING_NUM ç”¨æˆ·ç®¡ç†é¡µé¢æ¯é¡µæ˜¾ç¤ºè®°å½•æ¡æ•° REPO_PAGING_NUM ä»“åº“ç®¡ç†é¡µé¢æ¯é¡µæ˜¾ç¤ºè®°å½•æ¡æ•° NOTICE_PAGING_NUM ç³»ç»Ÿæç¤ºç®¡ç†é¡µé¢æ¯é¡µæ˜¾ç¤ºè®°å½•æ¡æ•° ORG_PAGING_NUM ç»„ç»‡ç®¡ç†é¡µé¢æ¯é¡µæ˜¾ç¤ºè®°å½•æ¡æ•° Prometheus (prometheus) åç§° æè¿° ENABLED æ¿€æ´»è¯¥é€‰é¡¹ä»¥å¯ç”¨ Prometheus ç›‘æ§ä¿¡æ¯ï¼Œé»˜è®¤ä¸º true ENABLE_BASIC_AUTH æ¿€æ´»è¯¥é€‰é¡¹ä»¥å¯ç”¨ HTTP åŸºæœ¬è®¤è¯ä¿æŠ¤ç›‘æ§ä¿¡æ¯æ•°æ®ï¼Œé»˜è®¤ä¸º false BASIC_AUTH_USERNAME HTTP åŸºæœ¬è®¤è¯çš„ç”¨æˆ·å BASIC_AUTH_PASSWORD HTTP åŸºæœ¬è®¤è¯çš„å¯†ç  å…¶ä»– (other) åç§° æè¿° SHOW_FOOTER_BRANDING æ¿€æ´»è¯¥é€‰é¡¹ä»¥åœ¨é¡µè„šæ˜¾ç¤º Gogs æ¨å¹¿ä¿¡æ¯ SHOW_FOOTER_VERSION æ¿€æ´»è¯¥é€‰é¡¹ä»¥åœ¨é¡µè„šæ˜¾ç¤º Gogs ç‰ˆæœ¬ä¿¡æ¯ SHOW_FOOTER_TEMPLATE_LOAD_TIME æ¿€æ´»è¯¥é€‰é¡¹ä»¥åœ¨é¡µè„šæ˜¾ç¤º Gogs æ¨¡æ¿åŠ è½½æ—¶é—´","categories":[{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://github.13sai.com/tags/Docker/"},{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/tags/CI/"},{"name":"gogs","slug":"gogs","permalink":"https://github.13sai.com/tags/gogs/"}]},{"title":"åˆ©ç”¨consul+nginx-upsyncå®ç°åŠ¨æ€è´Ÿè½½","slug":"åˆ©ç”¨consul-nginx-upsyncå®ç°åŠ¨æ€è´Ÿè½½","date":"2019-12-01T01:53:29.000Z","updated":"2022-03-19T14:35:21.884Z","comments":true,"path":"2019/12/01/212/","link":"","permalink":"https://github.13sai.com/2019/12/01/212/","excerpt":"","text":"è¿™æ˜¯å‰ä¸€æ®µæ—¶é—´å­¦ä¹ çš„è¯¾ç¨‹ä¸Šé¢çš„ï¼Œè‡ªå·±å®é™…æ“ä½œäº†ä¸€ä¸‹ï¼Œè¯¦ç»†æ“ä½œåŠè¯´æ˜å¦‚ä¸‹ã€‚ å¦‚æœNginxé‡åˆ°å¤§æµé‡å’Œé«˜è´Ÿè½½ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶é‡å¯å¯èƒ½å¹¶ä¸æ€»æ˜¯é‚£ä¹ˆæ–¹ä¾¿ï¼Œå› ä¸ºæ¢å¤Nginxå¹¶é‡è½½é…ç½®ä¼šè¿›ä¸€æ­¥å¢åŠ ç³»ç»Ÿè´Ÿè½½ï¼Œå¹¶å¾ˆå¯èƒ½æš‚æ—¶é™ä½æ€§èƒ½ã€‚è€Œä¸€ä¸ªä¸ªä¿®æ”¹é…ç½®æ–‡ä»¶ä¹Ÿæ˜¯å¾ˆå®¹æ˜“å‡ºé”™å’Œè´¹æ—¶é—´çš„æ“ä½œã€‚ è¿™æ—¶å€™ä¸å¦¨è¯•è¯•consul+nginx-upsync-moduleå®ç°Nginxçš„åŠ¨æ€è´Ÿè½½ã€‚ nginx-upsync-modulenginx-upsync-module æä¾›äº†åŠ¨æ€çš„è´Ÿè½½å‡è¡¡ï¼Œå®ƒå¯ä»¥ä»consulæˆ–etcdåŒæ­¥upstreamsï¼ŒåŠ¨æ€ä¿®æ”¹åç«¯æœåŠ¡å™¨å±æ€§ï¼ˆweightï¼Œmax_failsï¼Œdownâ€¦ï¼‰ï¼Œè€Œä¸éœ€è¦é‡æ–°åŠ è½½nginxã€‚è¿™æ ·æˆ‘ä»¬é€šè¿‡å®ƒå®ç°å¹³æ»‘ä¼¸ç¼©ï¼Œè€Œä¸ä¸¥é‡åœ°å½±å“æ€§èƒ½ã€‚ åˆ©ç”¨dockerå®‰è£…æˆ‘å·²ç»åŸºäºcentos7æ„å»ºäº†ä¸€ä¸ªé•œåƒ 13sai/nginx-lua-upsync ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨ä¸€ä¸ªå®¹å™¨ docker run -itd â€“name=nginx-upsync -p 8008:80 -p 9501:9501 -p 9502:9502 -p 9503:9503 -p 8500:8500 13sai/nginx-lua-upsync å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨dockerè‡ªè¡Œæ­å»ºï¼Œæ·»åŠ nginx-upsync-moduleæ¨¡å—å¯ä»¥å‚è€ƒnginxæ¨¡å—luaæ¨¡å—ã€‚ nginx-upsync-moduleçš„gitåœ°å€ è¿›å…¥å®¹å™¨é…ç½® docker exec -it nginx-upsync /bin/bash cd /usr/local/nginx/conf echo â€œserver host.docker.internal:9501 weight=1 fail_timeout=10 max_fails=3;â€ &gt;&gt; servers.conf vi nginx.conf #nginx.conf ä¸»è¦é…ç½® ... upstream 13sai&#123; upsync 192.168.65.2:8500/v1/kv/upstreams/test-server upsync_timeout=6m upsync_interval=500ms upsync_type=consul strong_dependency=off; upsync_dump_path /usr/local/nginx/conf/servers.conf; include /usr/local/nginx/conf/servers.conf; &#125; server &#123; listen 80; location / &#123; proxy_pass http://13sai; &#125; ... &#125; ... upsyncè¯­æ³•è¯´æ˜è¯­æ³•ï¼šsyntax: upsync $consul/etcd.api.com:$port/v1/kv/upstreams/$upstream_name/ [upsync_type=consul/etcd] [upsync_interval=second/minutes] [upsync_timeout=second/minutes] [strong_dependency=off/on] é»˜è®¤å€¼ï¼šæ— ï¼Œå¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™é»˜è®¤å‚æ•°ä¸ºupsync_interval = 5s upsync_timeout = 6m strong_dependency = off æè¿°ï¼šä» consul/etcd ä¸­æ‹‰å–upstreams upsync å®šä¹‰ä»consul/etcdæ‹‰å–æœ€æ–°çš„upstreamä¿¡æ¯å¹¶å­˜åˆ°æœ¬åœ°çš„æ“ä½œ upsync_timeout å®šä¹‰ä»consul/etcdæ‹‰å–é…ç½®çš„è¶…æ—¶æ—¶é—´ upsync_interval å®šä¹‰ä»consul/etcæ‹‰å–é…ç½®çš„é—´éš”æ—¶é—´ upsync_type å®šä¹‰ä½¿ç”¨é…ç½®æœåŠ¡ç±»å‹ strong_dependency å¯åŠ¨æ—¶æ˜¯å¦å¼ºåˆ¶ä¾èµ–é…ç½®æœåŠ¡å™¨ï¼Œå¦‚æœé…ç½®ä¸ºon,åˆ™æ‹‰å–å¤±è´¥ï¼ŒnginxåŒæ ·ä¼šå¯ç”¨å¤±è´¥ upsync_dump_path å®šä¹‰ä»consul/etcdæ‹‰å–é…ç½®åæŒä¹…åŒ–åˆ°çš„æœ¬åœ°çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™æ ·å³ä½¿ consul/etcdå‡ºé—®é¢˜äº†ï¼Œæœ¬åœ°åŒæ ·ä¼šæœ‰å¤‡ä»½æ–‡ä»¶ æ³¨æ„ä¸‹é¢è¿™ä¸ªæ–‡ä»¶å¿…é¡»è¦æœ‰ï¼Œæ–‡ä»¶è·¯å¾„å’Œåç§°å¯ä»¥è‡ªå®šä¹‰ï¼Œnginx-upsync-moduleä¼šå°†è´Ÿè½½ä¿¡æ¯ç¼“å­˜åˆ°æ­¤æ–‡ä»¶ï¼Œå¦åˆ™Nginxå¯åŠ¨ä¼šæŠ¥é”™ã€‚ #servers.confï¼Œ192.168.x.xxxæ˜¯æˆ‘çš„å®¿ä¸»æœºip server 192.168.x.xxx:9501 weight=20 max_fails=1 fail_timeout=5s; é‡å¯nginx /usr/local/nginx/sbin/nginx -t /usr/local/nginx/sbin/nginx -s reload è¿™é‡Œè™½ç„¶æˆ‘ä»¬è¿˜æœªå¯åŠ¨consulï¼Œä½†æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œupsyncä¼šå»æ‹‰å–ï¼Œä¹Ÿå¿…ç„¶ä¼šå¤±è´¥ï¼Œservers.confå°±ä¸ä¼šæ›´æ–°ï¼ŒNginxçš„erroræ—¥å¿—ä¼šæœ‰ä¿¡æ¯ã€‚ åˆ©ç”¨swooleå¯åŠ¨3ä¸ªhttpæœåŠ¡// å¯å¯åŠ¨3ä¸ªserverï¼Œç«¯å£åˆ†åˆ«ä¸º9501ï¼Œ9502ï¼Œ9503ï¼Œè¾“å‡ºä¹Ÿåšå¯¹åº”ä¿®æ”¹ $http = new Swoole\\Http\\Server(&quot;127.0.0.1&quot;, 9501); $http-&gt;on(&#x27;request&#x27;, function ($request, $response) &#123; $response-&gt;end(&quot;9501&quot;); &#125;); consulå®‰è£… è¿™é‡Œconsulåªåšä¸€ä¸ªkvå­˜å‚¨ï¼Œæˆ‘è‡ªå·±ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡ç”¨ï¼Œå°±ä¸å»åšè¿‡å¤šä»‹ç»äº†ã€‚ ä¸‹è½½åœ°å€ è§£å‹åˆ°ä½ éœ€è¦çš„ç›®å½•ï¼Œä¸»è¦ä¹Ÿå°±æ˜¯ä¸€ä¸ªconsulå¯æ‰§è¡Œæ–‡ä»¶ã€‚ï¼ˆè¿™é‡Œæˆ‘è£…åœ¨æˆ‘çš„ç”µè„‘ï¼Œè€Œä¸æ˜¯åˆšæ‰çš„dockerå®¹å™¨ï¼‰ å‘½ä»¤å¯çœ‹æ–‡æ¡£ï¼šConsul ç®€ä»‹å’Œå¿«é€Ÿå…¥é—¨ å¯åŠ¨ï¼š nohup ./consul agent -dev &amp; ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰å¯åŠ¨é›†ç¾¤ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨consulé›†ç¾¤ã€‚ UIæŸ¥çœ‹ http://127.0.0.1:8500/ æŸ¥çœ‹èŠ‚ç‚¹ ./consul members curl 127.0.0.1:8500/v1/catalog/nodes æŸ¥çœ‹kvå€¼ curl -v http://127.0.0.1:8500/v1/kv/\\?recurse æ·»åŠ  curl -X PUT -d â€˜{â€œweightâ€:20,â€max_failsâ€:2,â€fail_timeoutâ€:5}â€™ http://127.0.0.1:8500/v1/kv/upstreams/test-server/192.168.x.xxx:9502 æ­¤å¤„192.168.x.xxxæ˜¯å› ä¸ºæˆ‘åˆ›å»ºçš„dockerå®¹å™¨çš„å®¿ä¸»æœºipã€‚ åˆ é™¤ curl -X DELETE http://127.0.0.1:8500/v1/kv/upstreams/test-server/192.168.x.xxx:9502 æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ å’Œåˆ é™¤æ¥æµ‹è¯•ï¼ŒæŸ¥çœ‹http://127.0.0.1:8008/æ¥æŸ¥çœ‹è¾“å‡ºï¼Œä¹Ÿå¯ä»¥çœ‹çœ‹Nginxé‡Œçš„é…ç½®æ–‡ä»¶servers.confï¼Œä½ ä¼šçœ‹åˆ°ä½ æ“ä½œconsulï¼Œä¼šåŠ¨æ€æ”¹å˜Nginxçš„upstreamï¼Œè¿™æ ·å°±å®ç°äº†Nginxçš„åŠ¨æ€æ‰©å®¹ã€‚ å¯¹consulå’Œdockerçš„å­¦ä¹ è¿˜ä¸å¤Ÿæ·±å…¥ï¼Œæ–‡ä¸­å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£äº¤æµã€‚","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"consul","slug":"consul","permalink":"https://github.13sai.com/tags/consul/"},{"name":"SLB","slug":"SLB","permalink":"https://github.13sai.com/tags/SLB/"}]},{"title":"Nginxé…ç½®å¸¸ç”¨å‚æ•°","slug":"Nginxé…ç½®å¸¸ç”¨å‚æ•°","date":"2019-11-22T02:25:01.000Z","updated":"2022-03-19T15:27:50.385Z","comments":true,"path":"2019/11/22/Nginx6/","link":"","permalink":"https://github.13sai.com/2019/11/22/Nginx6/","excerpt":"","text":"æœ€è¿‘åœ¨å…¨é¢å­¦ä¹ Nginxï¼Œå½“ä½œç¬”è®°äº†ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡å‡ºæˆ–æ·±å…¥äº¤æµã€‚ ä¸»æ¨¡å—# é…ç½®ç”¨æˆ·æˆ–è€…ç»„ï¼Œé»˜è®¤ä¸ºnobody nobodyã€‚ #user www www; #Nginxå¼€å¯çš„workerè¿›ç¨‹æ•°ï¼Œå»ºè®®ä¸ºCPUçš„æ ¸æ•° #worker_processes 2; #æŒ‡å®šnginxè¿›ç¨‹è¿è¡Œæ–‡ä»¶å­˜æ”¾åœ°å€ #pid /nginx/pid/nginx.pid; #æŒ‡å®šæ—¥å¿—è·¯å¾„ï¼Œçº§åˆ«ã€‚è¿™ä¸ªè®¾ç½®å¯ä»¥æ”¾å…¥å…¨å±€å—ã€httpå—ã€serverå—ï¼Œçº§åˆ«ä»¥æ­¤ä¸ºï¼šdebug|info|notice|warn|error|crit|alert|emerg error_log log/error.log debug; #å¯ä»¥åœ¨ä»»æ„åœ°æ–¹ä½¿ç”¨includeæŒ‡ä»¤å®ç°é…ç½®æ–‡ä»¶çš„åŒ…å«ï¼Œç±»ä¼¼äºapacheä¸­çš„includeæ–¹æ³•ï¼Œå¯å‡å°‘ä¸»é…ç½®æ–‡ä»¶é•¿åº¦ã€‚ include vhosts/*.conf; äº‹ä»¶æ¨¡å—events &#123; #è®¾ç½®ç½‘è·¯è¿æ¥åºåˆ—åŒ–ï¼Œé˜²æ­¢æƒŠç¾¤ç°è±¡å‘ç”Ÿï¼Œé»˜è®¤ä¸ºon accept_mutex on; #é»˜è®¤: 500ms å¦‚æœä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰äº’æ–¥é”ï¼Œå®ƒå°†å»¶è¿Ÿè‡³å°‘å¤šé•¿æ—¶é—´ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå»¶è¿Ÿæ˜¯500ms ã€‚ accept_mutex_delay 100ms; #è®¾ç½®ä¸€ä¸ªè¿›ç¨‹æ˜¯å¦åŒæ—¶æ¥å—å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œé»˜è®¤ä¸ºoff multi_accept on; #äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œselect|poll|kqueue|epoll|resig|/dev/poll|eventportï¼Œä¸å»ºè®®è®¾ç½®ï¼Œnginxä¼šè‡ªè¡Œé€‰æ‹© #use epoll; #æœ€å¤§è¿æ¥æ•°ï¼Œé»˜è®¤ä¸º512 worker_connections 1024; &#125; httpéƒ¨åˆ†http &#123; #æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨ include mime.types; # é»˜è®¤æ–‡ä»¶ç±»å‹ï¼Œé»˜è®¤ä¸ºtext/plain default_type application/octet-stream; #å–æ¶ˆæœåŠ¡æ—¥å¿— #access_log off; #å…è®¸sendfileæ–¹å¼ä¼ è¾“æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºoffï¼Œå¯ä»¥åœ¨httpå—ï¼Œserverå—ï¼Œlocationå—ã€‚ sendfile on; #æ¯ä¸ªè¿›ç¨‹æ¯æ¬¡è°ƒç”¨ä¼ è¾“æ•°é‡ä¸èƒ½å¤§äºè®¾å®šçš„å€¼ï¼Œé»˜è®¤ä¸º0ï¼Œå³ä¸è®¾ä¸Šé™ã€‚ sendfile_max_chunk 100k; #è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º75sï¼Œå¯ä»¥åœ¨httpï¼Œserverï¼Œlocationå—ã€‚ keepalive_timeout 65; #å¼€å¯gzipèµ„æºå‹ç¼© gzip on; # è´Ÿè½½å‡è¡¡ï¼Œè¯¦ç»†å¯çœ‹äº†ä¸€ç¯‡æ–‡ç« ï¼šhttps://learnku.com/articles/36737 upstream blog &#123; server 192.167.20.19:8081; server 192.168.10.121:8080 weight=5; &#125; #è®¾å®šè¯·æ±‚ç¼“å†² client_header_buffer_size 128k; large_client_header_buffers 4 128k; #ä¸Šä¼ æ–‡ä»¶çš„å¤§å°é™åˆ¶ é»˜è®¤1m client_max_body_size 8m; server &#123; #å•è¿æ¥è¯·æ±‚ä¸Šé™æ¬¡æ•°ã€‚ keepalive_requests 120; #ç›‘å¬ç«¯å£ listen 80; #ç›‘å¬åœ°å€ server_name blog.13sai.com; #è®¾å®šæ—¥å¿—æ ¼å¼ log_format main &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27; &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27; &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;; access_log /data/logs/access.log main; # æ ¹ç›®å½• root /www/web/public; # å®šä¹‰é”™è¯¯æç¤ºé¡µé¢ error_page 500 502 503 504 /50x.html; location /static/ &#123; #rootä¸aliasä¸»è¦åŒºåˆ«åœ¨äºnginxå¦‚ä½•è§£é‡Šlocationåé¢çš„uriï¼Œè¿™ä¼šä½¿ä¸¤è€…åˆ†åˆ«ä»¥ä¸åŒçš„æ–¹å¼å°†è¯·æ±‚æ˜ å°„åˆ°æœåŠ¡å™¨æ–‡ä»¶ä¸Šã€‚ #rootçš„å¤„ç†ç»“æœæ˜¯ï¼šrootè·¯å¾„ï¼‹locationè·¯å¾„ #aliasçš„å¤„ç†ç»“æœæ˜¯ï¼šä½¿ç”¨aliasè·¯å¾„æ›¿æ¢locationè·¯å¾„ alias /www/static/; #è¿‡æœŸ30å¤©ï¼Œé™æ€æ–‡ä»¶ä¸æ€ä¹ˆæ›´æ–°ï¼Œè¿‡æœŸå¯ä»¥è®¾å¤§ä¸€ç‚¹,å¦‚æœé¢‘ç¹æ›´æ–°ï¼Œåˆ™å¯ä»¥è®¾ç½®å¾—å°ä¸€ç‚¹ã€‚ expires 30d; &#125; # å¤„ç†phpè¯·æ±‚åˆ°fpmç«¯å£ location ~ \\.php$ &#123; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; &#125; location / &#123; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_pass http://blog; #è¯·æ±‚è½¬å‘blog å®šä¹‰çš„æœåŠ¡å™¨åˆ—è¡¨ &#125; #ç¦æ­¢è®¿é—®æ–‡ä»¶ location ~ /.git &#123; deny all; allow 127.0.0.1; #å…è®¸çš„ip &#125; &#125; &#125; éƒ¨åˆ†å‚æ•°è¯¦ç»†è¯´æ˜server_name1.é¦–å…ˆé€‰æ‹©æ‰€æœ‰å­—ç¬¦ä¸²å®Œå…¨åŒ¹é…çš„server_nameï¼Œå¦‚ blog.13sai.com ã€‚ 2.å…¶æ¬¡é€‰æ‹©é€šé…ç¬¦åœ¨å‰é¢çš„server_nameï¼Œå¦‚ *.13sai.comã€‚ 3.å†æ¬¡é€‰æ‹©é€šé…ç¬¦åœ¨åé¢çš„server_nameï¼Œå¦‚www.13sai.* ã€‚ 4.æœ€åé€‰æ‹©ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ‰åŒ¹é…çš„server_nameï¼Œå¦‚ ~^\\.sai\\.com$ å¦‚æœéƒ½ä¸åŒ¹é… 1ã€ä¼˜å…ˆé€‰æ‹©listené…ç½®é¡¹åæœ‰defaultæˆ–default_serverçš„ 2ã€æ‰¾åˆ°åŒ¹é…listenç«¯å£çš„ç¬¬ä¸€ä¸ªserverå— locationlocation è¯­æ³•: location[=|~|~*|^~|@]/uri/&#123;...&#125; é…ç½®å—: server locationä¼šå°è¯•æ ¹æ®ç”¨æˆ·è¯·æ±‚ä¸­çš„URIæ¥åŒ¹é…ä¸Šé¢çš„/uriè¡¨è¾¾å¼ï¼Œå¦‚æœå¯ä»¥åŒ¹é…ï¼Œå°±é€‰æ‹© location&#123;&#125;å—ä¸­çš„é…ç½®æ¥å¤„ç†ç”¨æˆ·è¯·æ±‚ã€‚ locationè¡¨è¾¾å¼ç±»å‹ ~ è¡¨ç¤ºæ‰§è¡Œä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼ŒåŒºåˆ†å¤§å°å†™; ~* è¡¨ç¤ºæ‰§è¡Œä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œä¸åŒºåˆ†å¤§å°å†™; ^~ è¡¨ç¤ºæ™®é€šå­—ç¬¦åŒ¹é…ã€‚ä½¿ç”¨å‰ç¼€åŒ¹é…ã€‚å¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™ä¸å†åŒ¹é…å…¶ä»–location; = è¿›è¡Œæ™®é€šå­—ç¬¦ç²¾ç¡®åŒ¹é…ã€‚ä¹Ÿå°±æ˜¯å®Œå…¨åŒ¹é…; @ å®ƒå®šä¹‰ä¸€ä¸ªå‘½åçš„ locationï¼Œä½¿ç”¨åœ¨å†…éƒ¨å®šå‘æ—¶ï¼Œä¾‹å¦‚ error_page, try_files ä¼˜å…ˆçº§: ç­‰å·ç±»å‹(=)çš„ä¼˜å…ˆçº§æœ€é«˜ã€‚ä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œåˆ™ä¸å†æŸ¥æ‰¾å…¶ä»–åŒ¹é…é¡¹ å‰ç¼€æ™®é€šåŒ¹é…(^~)ä¼˜å…ˆçº§æ¬¡ä¹‹ã€‚ä¸æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚ä½¿ç”¨å‰ç¼€åŒ¹é…ï¼Œå¦‚æœæœ‰å¤šä¸ªlocationåŒ¹é…çš„è¯ï¼Œåˆ™ä½¿ç”¨è¡¨è¾¾å¼æœ€é•¿çš„é‚£ä¸ª æ­£åˆ™è¡¨è¾¾å¼ç±»å‹(~ ~*)çš„ä¼˜å…ˆçº§æ¬¡ä¹‹ã€‚ä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œåˆ™ä¸å†æŸ¥æ‰¾å…¶ä»–åŒ¹é…é¡¹ å¸¸è§„å­—ç¬¦ä¸²åŒ¹é…ï¼Œå¦‚æœæœ‰å¤šä¸ªlocationåŒ¹é…çš„è¯ï¼Œåˆ™ä½¿ç”¨è¡¨è¾¾å¼æœ€é•¿çš„é‚£ä¸ª (location =) &gt; (location å®Œæ•´è·¯å¾„) &gt; (location ^~ è·¯å¾„) &gt; (location ,* æ­£åˆ™é¡ºåº) &gt; (location éƒ¨åˆ†èµ·å§‹è·¯å¾„) returnè¯­æ³•:return code [text] return code URL; return URL; é…ç½®å—:serverï¼Œlocationï¼Œif è¯¥æŒ‡ä»¤ç”¨äºç»“æŸè§„åˆ™çš„æ‰§è¡Œå¹¶è¿”å›çŠ¶æ€å—ç»™å®¢æˆ·ç«¯ã€‚ çŠ¶æ€ç åŒ…æ‹¬: 204(No Content)ã€ 400(Bad Request)ã€ 402(Payment Required)ã€ 403(Forbidden) 404(Not Found)ã€ 405(Method Not Allowed)ã€ 406(Not Acceptable)ã€ 408(Request Timeout)ã€ 410(Gone)ã€ 411(Length Required)ã€ 413(Request Entity Too Large)ã€ 416(Requested Range Not Satisfiable)ã€ 500(Internal Server Error)ã€ 501(Not Implemented)ã€ 502(Bad Gateway)ã€ 503(Service Unavailable) 504(Gateway Timeout)ã€‚ ä¾‹å¦‚ï¼Œç¤ºä¾‹ï¼Œå¦‚æœè®¿é—®çš„URLä»¥.sh .bash ç»“å°¾ï¼Œè¿”å›çŠ¶æ€ç 403 location ~ .*\\.(sh|bash)?$ &#123; return 403; &#125; rewrite æ‰§è¡Œé¡ºåºï¼š 1. æ‰§è¡Œserverå—çš„rewriteæŒ‡ä»¤(è¿™é‡Œçš„å—æŒ‡çš„æ˜¯serverå…³é”®å­—å&#123;&#125;åŒ…å›´çš„åŒºåŸŸï¼Œå…¶å®ƒxxå—ç±»ä¼¼) 2. æ‰§è¡ŒlocationåŒ¹é… 3. æ‰§è¡Œé€‰å®šçš„locationä¸­çš„rewriteæŒ‡ä»¤ å¦‚æœå…¶ä¸­æŸæ­¥URIè¢«é‡å†™ï¼Œåˆ™é‡æ–°å¾ªç¯æ‰§è¡Œ1-3ï¼Œç›´åˆ°æ‰¾åˆ°çœŸå®å­˜åœ¨çš„æ–‡ä»¶ å¦‚æœå¾ªç¯è¶…è¿‡10æ¬¡ï¼Œåˆ™è¿”å›500 Internal Server Erroré”™è¯¯ è¯­æ³•:rewrite regex replacement [flag]; é»˜è®¤å€¼:â€” é…ç½®å—:server, location, if rewriteæ˜¯å®ç°URLé‡å†™çš„å…³é”®æŒ‡ä»¤ï¼Œæ ¹æ®regex(æ­£åˆ™è¡¨è¾¾å¼)éƒ¨åˆ†å†…å®¹ï¼Œé‡å®šå‘åˆ°replacementï¼Œç»“å°¾æ˜¯flagæ ‡è®°ã€‚ æ­£åˆ™:perlå…¼å®¹æ­£åˆ™è¡¨è¾¾å¼è¯­å¥è¿›è¡Œè§„åˆ™åŒ¹é… æ›¿ä»£å†…å®¹:å°†æ­£åˆ™åŒ¹é…çš„å†…å®¹æ›¿æ¢æˆreplacement flagæ ‡è®°:rewriteæ”¯æŒçš„flagæ ‡è®° ifæŒ‡ä»¤è¯­æ³•ï¼šif(condition)&#123;...&#125; é»˜è®¤å€¼ï¼šæ—  é…ç½®å—ï¼šserver,location å¯¹ç»™å®šçš„æ¡ä»¶conditionè¿›è¡Œåˆ¤æ–­ã€‚å¦‚æœä¸ºçœŸï¼Œå¤§æ‹¬å·å†…çš„rewriteæŒ‡ä»¤å°†è¢«æ‰§è¡Œã€‚ ifæ¡ä»¶(conditon)å¯ä»¥æ˜¯å¦‚ä¸‹ä»»ä½•å†…å®¹: ä¸€ä¸ªå˜é‡åï¼›falseå¦‚æœè¿™ä¸ªå˜é‡æ˜¯ç©ºå­—ç¬¦ä¸²æˆ–è€…ä»¥0å¼€å§‹çš„å­—ç¬¦ä¸²ï¼› ä½¿ç”¨= ,!= æ¯”è¾ƒçš„ä¸€ä¸ªå˜é‡å’Œå­—ç¬¦ä¸² æ˜¯ç”¨~ï¼Œ ~*ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å˜é‡ï¼Œå¦‚æœè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸­åŒ…å«&#125;ï¼Œ;åˆ™æ•´ä¸ªè¡¨è¾¾å¼éœ€è¦ç”¨&quot; æˆ–&#x27; åŒ…å›´ ä½¿ç”¨-f ï¼Œ!-f æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ ä½¿ç”¨-d, !-d æ£€æŸ¥ä¸€ä¸ªç›®å½•æ˜¯å¦å­˜åœ¨ ä½¿ç”¨-e ï¼Œ!-e æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶ã€ç›®å½•ã€ç¬¦å·é“¾æ¥æ˜¯å¦å­˜åœ¨ ä½¿ç”¨-x ï¼Œ !-x æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œ ifå®ä¾‹if ($http_user_agent~*(mobile|nokia|iphone|ipad|android|samsung|htc|blackberry)) &#123; rewrite ^.+ /mobile last; ï¼ƒè·³è½¬åˆ°æ‰‹æœºç«™ &#125; if ($request_method = POST) &#123; return 405; &#125; if ($slow) &#123; limit_rate 10k; &#125; if ($invalid_referer) &#123; return 403; &#125; last &amp; breakï¼ˆ1ï¼‰last å’Œ break å½“å‡ºç°åœ¨location ä¹‹å¤–æ—¶ï¼Œä¸¤è€…çš„ä½œç”¨æ˜¯ä¸€è‡´çš„æ²¡æœ‰ä»»ä½•å·®å¼‚ã€‚ æ³¨æ„ä¸€ç‚¹å°±æ˜¯ï¼Œä»–ä»¬ä¼šè·³è¿‡æ‰€æœ‰çš„åœ¨ä»–ä»¬ä¹‹åçš„rewrite æ¨¡å—ä¸­çš„æŒ‡ä»¤ï¼Œå»é€‰æ‹©è‡ªå·±åŒ¹é…çš„location ï¼ˆ2ï¼‰last å’Œ break å½“å‡ºç°åœ¨location å†…éƒ¨æ—¶ï¼Œä¸¤è€…å°±å­˜åœ¨äº†å·®å¼‚ -- last: ä½¿ç”¨äº†last æŒ‡ä»¤ï¼Œrewrite åä¼šè·³å‡ºlocation ä½œç”¨åŸŸï¼Œé‡æ–°å¼€å§‹å†èµ°ä¸€æ¬¡åˆšåˆšçš„è¡Œä¸º -- break: ä½¿ç”¨äº†break æŒ‡ä»¤ï¼Œrewriteåä¸ä¼šè·³å‡ºlocation ä½œç”¨åŸŸã€‚å®ƒçš„ç”Ÿå‘½ä¹Ÿåœ¨è¿™ä¸ªlocationä¸­ç»ˆç»“ã€‚ è§£é‡Šé€šä¿—æ˜“æ‡‚ï¼š lastï¼š é‡æ–°å°†rewriteåçš„åœ°å€åœ¨serveræ ‡ç­¾ä¸­æ‰§è¡Œ breakï¼š å°†rewriteåçš„åœ°å€åœ¨å½“å‰locationæ ‡ç­¾ä¸­æ‰§è¡Œ permanent &amp; redirect:permanent: æ°¸ä¹…æ€§é‡å®šå‘ã€‚è¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º301 redirect:ä¸´æ—¶é‡å®šå‘ã€‚è¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º302 ä»å®ç°åŠŸèƒ½çš„è§’åº¦ä¸Šå»çœ‹ï¼Œpermanent å’Œ redirect æ˜¯ä¸€æ ·çš„ã€‚ä¸å­˜åœ¨å¥½åã€‚ä¹Ÿä¸å­˜åœ¨ä»€ä¹ˆæ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚ä½†æ˜¯å¯¹seoä¼šæœ‰å½±å“ï¼Œè¿™é‡Œè¦æ ¹æ®éœ€è¦åšå‡ºé€‰æ‹©åœ¨ permanent å’Œ redirect ä¸­æåˆ°äº† çŠ¶æ€ç  301 å’Œ 302ã€‚ è®°ä½ï¼šlast å’Œ break æƒ³å¯¹äºçš„è®¿é—®æ—¥å¿—çš„è¯·æ±‚çŠ¶æ€ç ä¸º200 å½“ä½ æ‰“å¼€ä¸€ä¸ªç½‘é¡µï¼ŒåŒæ—¶æ‰“å¼€debug æ¨¡å¼æ—¶ï¼Œä¼šå‘ç°301 å’Œ 302 æ—¶çš„è¡Œä¸ºæ˜¯è¿™æ ·çš„ã€‚ ç¬¬ä¸€ä¸ªè¯·æ±‚301 æˆ–è€… 302 åï¼Œæµè§ˆå™¨é‡æ–°è·å–äº†ä¸€ä¸ªæ–°çš„URL ï¼Œç„¶åä¼šå¯¹è¿™ä¸ªæ–°çš„URL é‡æ–°è¿›è¡Œè®¿é—®ã€‚æ‰€ä»¥å½“ä½ é…ç½®çš„æ˜¯permanent å’Œ redirect ,ä½ å¯¹ä¸€ä¸ªURL çš„è®¿é—®è¯·æ±‚ï¼Œè½åˆ°æœåŠ¡å™¨ä¸Šè‡³å°‘ä¸º2æ¬¡ï¼›è€Œå½“ä½ é…ç½®äº†last æˆ–è€…æ˜¯break æ—¶ï¼Œä½ æœ€ç»ˆçš„URL ç¡®å®šä¸‹æ¥åï¼Œä¸ä¼šå°†è¿™ä¸ªURLè¿”å›ç»™æµè§ˆå™¨ï¼Œè€Œæ˜¯å°†å…¶æ‰”ç»™äº†fastcgi_passæˆ–è€…æ˜¯proxy_passæŒ‡ä»¤å»å¤„ç†ã€‚è¯·æ±‚ä¸€ä¸ªURL ï¼Œè½åˆ°æœåŠ¡å™¨ä¸Šçš„æ¬¡æ•°å°±ä¸º1æ¬¡ã€‚ æ³¨æ„ï¼šé…ç½®last åœ¨è·¨åŸŸçš„æ—¶å€™æ•ˆæœå’Œredirectä¸€è‡´ï¼Œéƒ½æ˜¯è¿”å›302çŠ¶æ€ç ï¼Œè¯·æ±‚åœ°å€ä¹Ÿå‘ç”Ÿæ”¹å˜ åº”ç”¨ä¼°ç®—å¹¶å‘nginxä½œä¸ºhttpæœåŠ¡å™¨çš„æ—¶å€™ï¼š max_clients = worker_processes * worker_connections/2 nginxä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨çš„æ—¶å€™ï¼š max_clients = worker_processes * worker_connections/4 é™åˆ¶æ¯ä¸ªIPçš„å¹¶å‘è¿æ¥æ•°demo:å®šä¹‰ä¸€ä¸ªå«â€œtwoâ€çš„è®°å½•åŒºï¼Œæ€»å®¹é‡ä¸º 10Mï¼ˆè¶…è¿‡å¤§å°å°†è¯·æ±‚å¤±è´¥ï¼Œä»¥å˜é‡ $binary_remote_addr ä½œä¸ºä¼šè¯çš„åˆ¤æ–­åŸºå‡†ï¼ˆå³ä¸€ä¸ªåœ°å€ä¸€ä¸ªä¼šè¯ï¼‰ã€‚ é™åˆ¶ /download/ ç›®å½•ä¸‹ï¼Œä¸€ä¸ªä¼šè¯åªèƒ½è¿›è¡Œä¸€ä¸ªè¿æ¥ã€‚ ç®€å•ç‚¹ï¼Œå°±æ˜¯é™åˆ¶ /download/ ç›®å½•ä¸‹ï¼Œä¸€ä¸ªIPåªèƒ½å‘èµ·ä¸€ä¸ªè¿æ¥ï¼Œå¤šè¿‡ä¸€ä¸ªï¼Œä¸€å¾‹503ã€‚ http &#123; ... limit_conn_zone $binary_remote_addr zone=two:10m; server &#123; ... location /download &#123; limit_conn two 1; &#125; &#125; &#125; é™æµdemo:å®šä¹‰ä¸€ä¸ªå«â€œoneâ€çš„è®°å½•åŒºï¼Œå ç”¨ç©ºé—´å¤§å°ä¸º10mï¼ˆè¶…è¿‡å¤§å°å°†è¯·æ±‚å¤±è´¥ï¼‰ï¼Œå¹³å‡å¤„ç†çš„è¯·æ±‚é¢‘ç‡ä¸èƒ½è¶…è¿‡æ¯ç§’ä¸€æ¬¡ï¼Œä¹Ÿå¯ä»¥è®¾ç½®åˆ†é’Ÿé€Ÿç‡ http &#123; ... limit_req_zone $binary_remote_addr zone=one:10m rate=1r/s; server &#123; ... location / &#123; #ç¼“å­˜åŒºé˜Ÿåˆ—burst=5ä¸ª,nodelayè¡¨ç¤ºä¸å»¶æœŸ(è¶…è¿‡çš„è¯·æ±‚å¤±è´¥)ï¼Œå³æ¯ç§’æœ€å¤šå¯å¤„ç†rate+burstä¸ª,åŒæ—¶å¤„ç†rateä¸ªã€‚ limit_req zone=one burst=5 nodelay; &#125; &#125; &#125; ç™½åå•http&#123; ... #åˆ¤æ–­å®¢æˆ·ç«¯çš„ipåœ°å€æ˜¯å¦åœ¨ç™½åå•åˆ—è¡¨å½“ä¸­,å¦‚æœè¿”å›ä¸º0,åˆ™åœ¨ç™½åå•åˆ—è¡¨å½“ä¸­,å¦åˆ™è¿”å›ä¸º1 geo $whiteIpList &#123; default 1; 118.24.109.254 0; 47.98.147.0/24 1; #å¯ä»¥å¼•å…¥ä¸€äº›ç™½åå•é…ç½® include &#x27;whiteIP.conf&#x27; &#125; #å¦‚æœä¸åœ¨ç™½åå•ä¹‹å†…,è¿”å›å®¢æˆ·ç«¯çš„äºŒè¿›åˆ¶çš„ipåœ°å€ map $whiteIpList $limit &#123; default &quot;&quot;; 1 $binary_remote_addr; 0 &quot;&quot;; &#125; #å¦‚æœè¿”å›çš„æ˜¯ç©ºå­—ç¬¦ä¸²é‚£ä¹ˆé€Ÿç‡é™åˆ¶ä¼šå¤±æ•ˆ limit_req_zone $limit zone=test:2m rate=1r/m; ... &#125; é˜²ç›—é“¾http &#123; ... server &#123; ... location ~* \\.(gif|jpg|png|swf|flv)$ &#123; valid_referers none blocked *.13sai.com; if ($invalid_referer) &#123; rewrite ^/ blog.13sai.com &#125; &#125; &#125; &#125;","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"Nginxä»£ç†ç¼“å­˜","slug":"Nginxä»£ç†ç¼“å­˜","date":"2019-11-22T02:24:50.000Z","updated":"2022-03-19T15:27:24.350Z","comments":true,"path":"2019/11/22/Nginx1/","link":"","permalink":"https://github.13sai.com/2019/11/22/Nginx1/","excerpt":"","text":"Nginxçš„ç¼“å­˜å¯ä»¥ç®€å•åˆ†æˆwebç¼“å­˜å’Œä»£ç†ç¼“å­˜ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»ä»£ç†ç¼“å­˜ã€‚ webç¼“å­˜Nginxæä¾›äº†expiresã€etagã€if-modified-sinceæŒ‡ä»¤æ¥å®ç°æµè§ˆå™¨ç¼“å­˜æ§åˆ¶ã€‚ è¿™ä¸ªé…ç½®æ¯”è¾ƒç®€å•ï¼Œä¸€èˆ¬å¯ä»¥ç¼“å­˜ä¸€äº›jsã€cssç­‰é™æ€æ–‡ä»¶ã€‚ å¯¹äºè¿™å‡ ä¸ªä¸æƒ³åšè¿‡å¤šè¯´æ˜ï¼Œå¤§å®¶å¯ä»¥çœ‹ä¸¤å¼ å›¾ï¼Œç®€å•ç†è§£ä¸‹ã€‚ ä»£ç†ç¼“å­˜ä»£ç†ç¼“å­˜ä¸»è¦ç”¨åˆ°proxyæ¨¡å—ä¸­çš„proxy_cacheã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªdemoã€‚ upstream 13sai&#123; server 127.0.0.1:9501 weight=10; &#125; #è‡ªå®šä¹‰ç¼“å­˜ç›®å½•,ç¼“å­˜æ–‡ä»¶å¤§å° proxy_cache_path /usr/local/etc/nginx/cache levels=1:2 keys_zone=sai_cache:10m max_size=200m inactive=10m use_temp_path=off; server &#123; listen 80; server_name nginx-t.com; location / &#123; proxy_next_upstream error http_503; proxy_pass http://13sai; #å¯ç”¨ç¼“å­˜sai_cache proxy_cache sai_cache; #å®šä¹‰å¦‚ä½•ç”Ÿæˆç¼“å­˜çš„é”® proxy_cache_key $scheme$proxy_host$uri$is_args$args; #é’ˆå¯¹å¤šç§è¯·æ±‚æ–¹æ³•ç¼“å­˜ï¼Œé»˜è®¤GET HEAD proxy_cache_methods GET HEAD POST; #ä¸ºä¸åŒçš„å“åº”çŠ¶æ€ç è®¾ç½®ä¸åŒçš„ç¼“å­˜æ—¶é—´ã€‚ proxy_cache_valid 200 302 10m; proxy_cache_valid 404 1m; #è®¾ç½®å“åº”è¢«ç¼“å­˜çš„æœ€å°è¯·æ±‚æ¬¡æ•°,æœ€å°‘2æ¬¡æ‰ä¼šç¼“å­˜ proxy_cache_min_uses 1; #å¼€å¯æ­¤åŠŸèƒ½æ—¶ï¼Œå¯¹äºç›¸åŒçš„è¯·æ±‚ï¼ŒåŒæ—¶åªå…è®¸ä¸€ä¸ªè¯·æ±‚å‘å¾€åç«¯ proxy_cache_lock on; #ä¸ºproxy_cache_lockæŒ‡ä»¤è®¾ç½®é”çš„è¶…æ—¶5s proxy_cache_lock_timeout 5s; #å¿½ç•¥æœåŠ¡å™¨ä¸ç¼“å­˜çš„è¦æ±‚ proxy_ignore_headers Cache-Control; &#125; error_page 500 502 503 504 /50x.html; location = /50x.html &#123; &#125; &#125; æµ‹è¯•æ•ˆæœ// server1.php &lt;?php $http = new Swoole\\Http\\Server(&quot;127.0.0.1&quot;, 9501); $http-&gt;on(&#x27;request&#x27;, function ($request, $response) &#123; echo &quot;no cache&quot;.PHP_EOL; $response-&gt;end(&quot;&lt;h1&gt;9501&lt;/h1&gt;&quot;); &#125;); $http-&gt;start(); php server1.php #æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º å‘é€getå’Œpostè¯·æ±‚ ab -n10 -c10 http://nginx-t.com/v\\=get ab -p â€˜data.jsonâ€™ -n10 -c10 http://nginx-t.com/v\\=post é‡å¤æäº¤å‡ æ¬¡putè¯·æ±‚ curl -X PUT http://nginx-t.com/v\\=put ä¸‹é¢æ˜¯æˆ‘çš„æµ‹è¯•ç»“æœæˆªå›¾ï¼ˆä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹ï¼Œæˆ‘åœ¨getå’Œpostè¯·æ±‚ä¹‹å‰æ•²äº†å‡ ä¸ªç©ºè¡Œï¼‰ ä¸‹é¢è¯´æ˜å‡ ä¸ªå‚æ•°ï¼š proxy_cache_pathè¯­æ³•: proxy_cache_path path [levels=levels] keys_zone=name:size [inactive=time] [max_size=size] [loader_files=number] [loader_sleep=time] [loader_threshold=time]; é»˜è®¤å€¼: â€” ä¸Šä¸‹æ–‡: http pathï¼šç¼“å­˜æ•°æ®æ˜¯ä¿å­˜åœ¨æ–‡ä»¶ä¸­çš„ï¼Œç¼“å­˜çš„é”®å’Œæ–‡ä»¶åéƒ½æ˜¯åœ¨ä»£ç†URLä¸Šæ‰§è¡ŒMD5çš„ç»“æœã€‚ levelsï¼šå®šä¹‰äº†ç¼“å­˜çš„å±‚æ¬¡ç»“æ„ #å½“levels=1:2æ—¶ï¼Œè¡¨ç¤ºæ˜¯ä¸¤çº§ç›®å½•ï¼Œ1å’Œ2è¡¨ç¤ºç”¨1ä½å’Œ2ä½16è¿›åˆ¶æ¥å‘½åç›®å½•åç§°ã€‚åœ¨æ­¤ä¾‹ä¸­ï¼Œç¬¬ä¸€çº§ç›®å½•ç”¨1ä½16è¿›åˆ¶å‘½åï¼Œå¦‚bï¼›ç¬¬äºŒçº§ç›®å½•ç”¨2ä½16è¿›åˆ¶å‘½åï¼Œå¦‚2cã€‚æ‰€ä»¥æ­¤ä¾‹ä¸­ä¸€çº§ç›®å½•æœ‰16ä¸ªï¼ŒäºŒçº§ç›®å½•æœ‰16*16=256ä¸ªï¼š cache/b/2c/c75ad5e343f042f52e875343425e51b key_zone:åœ¨å…±äº«å†…å­˜ä¸­è®¾ç½®ä¸€å—å­˜å‚¨åŒºåŸŸæ¥å­˜æ”¾ç¼“å­˜çš„keyå’Œmetadata(ç±»ä¼¼ä½¿ç”¨æ¬¡æ•°)ï¼Œè¿™æ ·nginxå¯ä»¥å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªrequestæ˜¯å¦å‘½ä¸­æˆ–è€…æœªå‘½ä¸­ç¼“ å­˜ï¼Œ1må¯ä»¥å­˜å‚¨8000ä¸ªkeyï¼Œ10må¯ä»¥å­˜å‚¨80000ä¸ªkeyã€‚ max_size:æœ€å¤§cacheç©ºé—´ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œä¼šä½¿ç”¨æ‰æ‰€æœ‰disk spaceï¼Œå¦‚æœè¶…è¿‡max_sizeå‚æ•°è®¾ç½®çš„æœ€å¤§å€¼ï¼Œä½¿ç”¨LRUç®—æ³•ç§»é™¤ç¼“å­˜æ•°æ® inactive:æœªè¢«è®¿é—®æ–‡ä»¶åœ¨ç¼“å­˜ä¸­ä¿ç•™æ—¶é—´ï¼Œé»˜è®¤æ˜¯10åˆ†é’Ÿã€‚æŒ‡å®šæ—¶é—´å†…æœªè¢«è®¿é—®çš„ç¼“å­˜æ–‡ä»¶å°†è¢«åˆ é™¤ã€‚ loader_files:æ¯æ¬¡æœ€å¤šåŠ è½½çš„æ•°é‡ loader_sleeps:æ¯æ¬¡åŠ è½½çš„å»¶æ—¶ loader_threshold:æŒ‡å®šæ¯æ¬¡åŠ è½½æ‰§è¡Œçš„æ—¶é—´ proxy_cache_lockå¼€å¯æ­¤åŠŸèƒ½æ—¶ï¼Œå¯¹äºç›¸åŒçš„è¯·æ±‚ï¼ŒåŒæ—¶åªå…è®¸ä¸€ä¸ªè¯·æ±‚å‘å¾€åç«¯ï¼Œå¹¶æ ¹æ®proxy_cache_keyæŒ‡ä»¤çš„è®¾ç½®åœ¨ç¼“å­˜ä¸­æ¤å…¥ä¸€ä¸ªæ–°æ¡ç›®ã€‚å…¶ä»–è¯·æ±‚ç›¸åŒæ¡ç›®çš„è¯·æ±‚å°†ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°ç¼“å­˜ä¸­å‡ºç°ç›¸åº”çš„å†…å®¹ï¼Œæˆ–è€…é”åœ¨proxy_cache_lock_timeoutæŒ‡ä»¤è®¾ç½®çš„è¶…æ—¶åè¢«é‡Šæ”¾ã€‚ proxy_cache_validå¦‚æœä»…ä»…æŒ‡å®šäº†timeï¼Œ proxy_cache_valid 5m; é‚£ä¹ˆåªæœ‰çŠ¶æ€ç ä¸º200ã€300å’Œ302çš„å“åº”ä¼šè¢«ç¼“å­˜ã€‚ å¦‚æœä½¿ç”¨äº†anyå‚æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç¼“å­˜ä»»ä½•å“åº”ï¼š proxy_cache_valid any 1m; proxy_ignore_headersè¯­æ³•: proxy_ignore_headers field ...; é»˜è®¤å€¼: â€” ä¸Šä¸‹æ–‡: http, server, location ä¸å¤„ç†åç«¯æœåŠ¡å™¨è¿”å›çš„æŒ‡å®šå“åº”å¤´ã€‚ä¸‹é¢çš„å“åº”å¤´å¯ä»¥è¢«è®¾ç½®ï¼š â€œX-Accel-Redirectâ€ï¼Œâ€œX-Accel-Expiresâ€ï¼Œâ€œX-Accel-Limit-Rateâ€ ï¼Œâ€œX-Accel-Bufferingâ€ ï¼Œ â€œX-Accel-Charsetâ€ï¼Œâ€œExpiresâ€ï¼Œâ€œCache-Controlâ€ï¼Œå’Œâ€œSet-Cookieâ€ ã€‚ æ­¤å‚æ•°ä¸å»ºè®®è®¾ç½®ï¼ŒåŸåˆ™ä¸Šè¿™äº›ç¼“å­˜åº”å½“åç«¯ä»£ç å¤„ç†ã€‚ proxy_cache_use_staleè¯­æ³•: proxy_cache_use_stale error | timeout | invalid_header | updating | http_500 | http_502 | http_503 | http_504 | http_404 | off ...; é»˜è®¤å€¼: proxy_cache_use_stale off; ä¸Šä¸‹æ–‡: http, server, location å¦‚æœåç«¯æœåŠ¡å™¨å‡ºç°çŠ¶å†µï¼Œnginxæ˜¯å¯ä»¥ä½¿ç”¨è¿‡æœŸçš„å“åº”ç¼“å­˜çš„ã€‚è¿™æ¡æŒ‡ä»¤å°±æ˜¯å®šä¹‰ä½•ç§æ¡ä»¶ä¸‹å…è®¸å¼€å¯æ­¤æœºåˆ¶ã€‚è¿™æ¡æŒ‡ä»¤çš„å‚æ•°ä¸proxy_next_upstreamæŒ‡ä»¤çš„å‚æ•°ç›¸åŒã€‚ proxy_cache_bypassä¸proxy_no_cacheè¯­æ³•: proxy_cache_bypass string ...; é»˜è®¤å€¼: â€” ä¸Šä¸‹æ–‡: http, server, location å®šä¹‰nginxä¸ä»ç¼“å­˜å–å“åº”çš„æ¡ä»¶ã€‚å¦‚æœè‡³å°‘ä¸€ä¸ªå­—ç¬¦ä¸²æ¡ä»¶éç©ºè€Œä¸”éâ€œ0â€ï¼Œnginxå°±ä¸ä¼šä»ç¼“å­˜ä¸­å»å–å“åº”ï¼š proxy_cache_bypass $cookie_nocache $arg_nocache$arg_comment; proxy_cache_bypass $http_pragma $http_authorization; æœ¬æŒ‡ä»¤å¯å’Œä¸proxy_no_cacheä¸€èµ·ä½¿ç”¨ã€‚ è¯­æ³•: proxy_no_cache string ...; é»˜è®¤å€¼: â€” ä¸Šä¸‹æ–‡: http, server, location å®šä¹‰nginxä¸å°†å“åº”å†™å…¥ç¼“å­˜çš„æ¡ä»¶ã€‚å¦‚æœè‡³å°‘ä¸€ä¸ªå­—ç¬¦ä¸²æ¡ä»¶éç©ºè€Œä¸”éâ€œ0â€ï¼Œnginxå°±ä¸å°†å“åº”å­˜å…¥ç¼“å­˜ï¼š proxy_no_cache $cookie_nocache $arg_nocache$arg_comment; proxy_no_cache $http_pragma $http_authorization; proxy_cache_methodsè¯¥æŒ‡ä»¤ç”¨äºè®¾ç½®ç¼“å­˜å“ªäº›HTTPæ–¹æ³•,é»˜è®¤ç¼“å­˜HTTP GET/HEADæ–¹æ³•,ä¸ç¼“å­˜HTTP POST æ–¹æ³•ã€‚ æœ‰äº†ä»£ç†ç¼“å­˜ï¼Œé‚£ä¹ˆæ¸…é™¤ç¼“å­˜å¦‚ä½•æ“ä½œå‘¢ï¼Ÿ æ¸…é™¤ç¼“å­˜ åˆ é™¤ç¼“å­˜ç›®å½•çš„æ–‡ä»¶ ä½¿ç”¨ngx_cache_purgeæ¨¡å—ï¼Œå¯æŸ¥çœ‹è¿™ç¯‡æ–‡ç« Nginxç¼“å­˜é…ç½®åŠnginx ngx_cache_purgeæ¨¡å—çš„ä½¿ç”¨ æ¨èç¬¬äºŒç§æ–¹æ³•ã€‚","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"Nginxå†…åµŒå˜é‡","slug":"Nginxå†…åµŒå˜é‡","date":"2019-11-22T02:22:02.000Z","updated":"2022-03-19T15:27:46.095Z","comments":true,"path":"2019/11/22/Nginx5/","link":"","permalink":"https://github.13sai.com/2019/11/22/Nginx5/","excerpt":"","text":"Nginxå†…åµŒå˜é‡æ˜¯éå¸¸å¸¸ç”¨çš„ï¼Œè®°å½•ä¸‹å¤‡æŸ¥ã€‚ Nginxå†…åµŒå˜é‡ç”± ngx_http_core_module æ¨¡å—æ”¯æŒï¼Œå˜é‡åä¸ApacheæœåŠ¡å™¨å¯¹åº”ï¼Œè¿™äº›å˜é‡å¯ä»¥è¡¨ç¤ºå®¢æˆ·ç«¯çš„è¯·æ±‚å¤´å­—æ®µï¼Œè¯¸å¦‚$http_user_agentã€$http_cookieç­‰ç­‰ã€‚ nginxä¹Ÿæ”¯æŒå…¶ä»–å˜é‡ï¼š å‚æ•°åç§° è¯´æ˜ $arg_name è¯·æ±‚ä¸­çš„çš„å‚æ•°åï¼Œå³â€œ?â€åé¢çš„arg_name=arg_valueå½¢å¼çš„arg_nameï¼Œå¦‚/index.php?www=www.13sai.comï¼Œå¯ä»¥ç”¨$arg_wwwå°±æ˜¯www.13sai.com $args è¯·æ±‚ä¸­çš„å‚æ•°å€¼ $binary_remote_addr å®¢æˆ·ç«¯åœ°å€çš„äºŒè¿›åˆ¶å½¢å¼, å›ºå®šé•¿åº¦ä¸º4ä¸ªå­—èŠ‚ $body_bytes_sent ä¼ è¾“ç»™å®¢æˆ·ç«¯çš„å­—èŠ‚æ•°ï¼Œå“åº”å¤´ä¸è®¡ç®—åœ¨å†…ï¼›è¿™ä¸ªå˜é‡å’ŒApacheçš„mod_log_configæ¨¡å—ä¸­çš„â€œ%Bâ€å‚æ•°ä¿æŒå…¼å®¹ $bytes_sent ä¼ è¾“ç»™å®¢æˆ·ç«¯çš„å­—èŠ‚æ•° $connection TCPè¿æ¥çš„åºåˆ—å· $connection_requests TCPè¿æ¥å½“å‰çš„è¯·æ±‚æ•°é‡ $content_length â€œContent-Lengthâ€ è¯·æ±‚å¤´å­—æ®µ $content_type â€œContent-Typeâ€ è¯·æ±‚å¤´å­—æ®µ $cookie_name cookieåç§° $document_root å½“å‰è¯·æ±‚çš„æ–‡æ¡£æ ¹ç›®å½•æˆ–åˆ«å $document_uri åŒ $uri $host ä¼˜å…ˆçº§å¦‚ä¸‹ï¼šHTTPè¯·æ±‚è¡Œçš„ä¸»æœºå&gt;â€HOSTâ€è¯·æ±‚å¤´å­—æ®µ&gt;ç¬¦åˆè¯·æ±‚çš„æœåŠ¡å™¨å $hostname ä¸»æœºå $http_name åŒ¹é…ä»»æ„è¯·æ±‚å¤´å­—æ®µï¼› å˜é‡åä¸­çš„ååŠéƒ¨åˆ†â€œnameâ€å¯ä»¥æ›¿æ¢æˆä»»æ„è¯·æ±‚å¤´å­—æ®µï¼Œå¦‚åœ¨é…ç½®æ–‡ä»¶ä¸­éœ€è¦è·å–httpè¯·æ±‚å¤´ï¼šâ€œAccept-Languageâ€ï¼Œé‚£ä¹ˆå°†â€œï¼â€æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œå¤§å†™å­—æ¯æ›¿æ¢ä¸ºå°å†™ï¼Œå½¢å¦‚ï¼š$http_accept_languageå³å¯ã€‚ $https å¦‚æœå¼€å¯äº†SSLå®‰å…¨æ¨¡å¼ï¼Œå€¼ä¸ºâ€œonâ€ï¼Œå¦åˆ™ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ $is_args å¦‚æœè¯·æ±‚ä¸­æœ‰å‚æ•°ï¼Œå€¼ä¸ºâ€œ?â€ï¼Œå¦åˆ™ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ $limit_rate ç”¨äºè®¾ç½®å“åº”çš„é€Ÿåº¦é™åˆ¶ï¼Œè¯¦è§ limit_rateã€‚ $msec å½“å‰çš„Unixæ—¶é—´æˆ³ (1.3.9, 1.2.6) $nginx_version nginxç‰ˆæœ¬ $pid å·¥ä½œè¿›ç¨‹çš„PID $pipe å¦‚æœè¯·æ±‚æ¥è‡ªç®¡é“é€šä¿¡ï¼Œå€¼ä¸ºâ€œpâ€ï¼Œå¦åˆ™ä¸ºâ€œ.â€ (1.3.12, 1.2.7) $proxy_protocol_addr è·å–ä»£ç†è®¿é—®æœåŠ¡å™¨çš„å®¢æˆ·ç«¯åœ°å€ï¼Œå¦‚æœæ˜¯ç›´æ¥è®¿é—®ï¼Œè¯¥å€¼ä¸ºç©ºå­—ç¬¦ä¸²ã€‚(1.5.12) $query_string åŒ $argsï¼Œç„¶è€Œ $query_stringæ˜¯åªè¯»çš„ä¸ä¼šæ”¹å˜ $realpath_root å½“å‰è¯·æ±‚çš„æ–‡æ¡£æ ¹ç›®å½•æˆ–åˆ«åçš„çœŸå®è·¯å¾„ï¼Œä¼šå°†æ‰€æœ‰ç¬¦å·è¿æ¥è½¬æ¢ä¸ºçœŸå®è·¯å¾„ã€‚ $remote_addr å®¢æˆ·ç«¯åœ°å€ $remote_port å®¢æˆ·ç«¯ç«¯å£ $remote_user ç”¨äºHTTPåŸºç¡€è®¤è¯æœåŠ¡çš„ç”¨æˆ·å $request ä»£è¡¨å®¢æˆ·ç«¯çš„è¯·æ±‚åœ°å€ $request_body å®¢æˆ·ç«¯çš„è¯·æ±‚ä¸»ä½“,æ­¤å˜é‡å¯åœ¨locationä¸­ä½¿ç”¨ï¼Œå°†è¯·æ±‚ä¸»ä½“é€šè¿‡proxy_pass, fastcgi_pass, uwsgi_pass, å’Œ scgi_passä¼ é€’ç»™ä¸‹ä¸€çº§çš„ä»£ç†æœåŠ¡å™¨ã€‚ $request_body_file è¯·æ±‚æ­£æ–‡çš„ä¸´æ—¶æ–‡ä»¶åã€‚å¤„ç†å®Œæˆæ—¶ï¼Œä¸´æ—¶æ–‡ä»¶å°†è¢«åˆ é™¤ã€‚ å¦‚æœå¸Œæœ›æ€»æ˜¯å°†è¯·æ±‚æ­£æ–‡å†™å…¥æ–‡ä»¶ï¼Œéœ€è¦å¼€å¯client_body_in_file_onlyã€‚ å¦‚æœåœ¨è¢«ä»£ç†çš„è¯·æ±‚æˆ–FastCGIè¯·æ±‚ä¸­ä¼ é€’ä¸´æ—¶æ–‡ä»¶åï¼Œå°±åº”è¯¥ç¦æ­¢ä¼ é€’è¯·æ±‚æ­£æ–‡æœ¬èº«ã€‚ ä½¿ç”¨proxy_pass_request_body offæŒ‡ä»¤ å’Œfastcgi_pass_request_body offæŒ‡ä»¤ åˆ†åˆ«ç¦æ­¢åœ¨ä»£ç†å’ŒFastCGIä¸­ä¼ é€’è¯·æ±‚æ­£æ–‡ã€‚ $request_completion å¦‚æœè¯·æ±‚æˆåŠŸï¼Œå€¼ä¸ºâ€OKâ€ï¼Œå¦‚æœè¯·æ±‚æœªå®Œæˆæˆ–è€…è¯·æ±‚ä¸æ˜¯ä¸€ä¸ªèŒƒå›´è¯·æ±‚çš„æœ€åä¸€éƒ¨åˆ†ï¼Œåˆ™ä¸ºç©ºã€‚ $request_filename å½“å‰è¿æ¥è¯·æ±‚çš„æ–‡ä»¶è·¯å¾„ï¼Œç”±rootæˆ–aliasæŒ‡ä»¤ä¸URIè¯·æ±‚ç”Ÿæˆã€‚ $request_length è¯·æ±‚çš„é•¿åº¦ (åŒ…æ‹¬è¯·æ±‚çš„åœ°å€, httpè¯·æ±‚å¤´å’Œè¯·æ±‚ä¸»ä½“) $request_method HTTPè¯·æ±‚æ–¹æ³•ï¼Œé€šå¸¸ä¸ºâ€œGETâ€æˆ–â€œPOSTâ€ $request_time å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ä½¿ç”¨çš„æ—¶é—´; ä»è¯»å–å®¢æˆ·ç«¯çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹è®¡æ—¶ã€‚ $request_uri è¿™ä¸ªå˜é‡ç­‰äºåŒ…å«ä¸€äº›å®¢æˆ·ç«¯è¯·æ±‚å‚æ•°çš„åŸå§‹URIï¼Œå®ƒæ— æ³•ä¿®æ”¹ï¼Œè¯·æŸ¥çœ‹$uriæ›´æ”¹æˆ–é‡å†™URIï¼Œä¸åŒ…å«ä¸»æœºåï¼Œä¾‹å¦‚ï¼šâ€/sai/test.php?arg=wwwâ€ã€‚ $scheme è¯·æ±‚ä½¿ç”¨çš„Webåè®®, â€œhttpâ€ æˆ– â€œhttpsâ€ $sent_http_name å¯ä»¥è®¾ç½®ä»»æ„httpå“åº”å¤´å­—æ®µï¼› å˜é‡åä¸­çš„ååŠéƒ¨åˆ†â€œnameâ€å¯ä»¥æ›¿æ¢æˆä»»æ„å“åº”å¤´å­—æ®µï¼Œå¦‚éœ€è¦è®¾ç½®å“åº”å¤´Content-lengthï¼Œé‚£ä¹ˆå°†â€œï¼â€æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œå¤§å†™å­—æ¯æ›¿æ¢ä¸ºå°å†™ï¼Œå½¢å¦‚ï¼š$sent_http_content_length 4096å³å¯ã€‚ $server_addr æœåŠ¡å™¨ç«¯åœ°å€ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸ºäº†é¿å…è®¿é—®linuxç³»ç»Ÿå†…æ ¸ï¼Œåº”å°†ipåœ°å€æå‰è®¾ç½®åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚ $server_name æœåŠ¡å™¨å $server_port æœåŠ¡å™¨ç«¯å£ $server_protocol æœåŠ¡å™¨çš„HTTPç‰ˆæœ¬, é€šå¸¸ä¸º â€œHTTP/1.0â€ æˆ– â€œHTTP/1.1â€ $status HTTPå“åº”ä»£ç  $time_iso8601 æœåŠ¡å™¨æ—¶é—´çš„ISO 8610æ ¼å¼ $time_local æœåŠ¡å™¨æ—¶é—´ï¼ˆLOG Format æ ¼å¼ï¼‰ ï¼Œnginxå¤„ç†å®Œæˆæ‰“å°æ—¥å¿—çš„æ—¶é—´ï¼Œä¸æ˜¯è¯·æ±‚å‘å‡ºçš„æ—¶é—´ $uri è¯·æ±‚ä¸­çš„å½“å‰URI(ä¸å¸¦è¯·æ±‚å‚æ•°ï¼Œå‚æ•°ä½äº$args)ï¼Œå¯ä»¥ä¸åŒäºæµè§ˆå™¨ä¼ é€’çš„$request_uriçš„å€¼ï¼Œå®ƒå¯ä»¥é€šè¿‡å†…éƒ¨é‡å®šå‘ï¼Œæˆ–è€…ä½¿ç”¨indexæŒ‡ä»¤è¿›è¡Œä¿®æ”¹ï¼Œ$uriä¸åŒ…å«ä¸»æœºåï¼Œå¦‚â€/foo/bar.htmlâ€ã€‚ apacheæœåŠ¡å™¨å˜é‡å¯çœ‹[å¤‡å¿˜] apacheæœåŠ¡ç«¯å˜é‡ å‚è€ƒï¼š ä¸­æ–‡æ–‡æ¡£ Nginx ç›¸å…³æ–‡ç« ï¼š Nginx è´Ÿè½½å‡è¡¡ Nginx æ·»åŠ  lua æ¨¡å— Nginx é…ç½®å¸¸ç”¨å‚æ•°ï¼Œçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº† Nginx ä»£ç†ç¼“å­˜","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"Nginxæ·»åŠ lua-nginxæ¨¡å—","slug":"Nginxæ·»åŠ lua-nginxæ¨¡å—","date":"2019-11-20T05:52:59.000Z","updated":"2022-03-19T15:28:04.032Z","comments":true,"path":"2019/11/20/Nginx9/","link":"","permalink":"https://github.13sai.com/2019/11/20/Nginx9/","excerpt":"","text":"ngx_luaæ˜¯Nginxçš„ä¸€ä¸ªæ¨¡å—ï¼Œå°†LuaåµŒå…¥åˆ°Nginxä¸­ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨Luaæ¥ç¼–å†™è„šæœ¬ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨Luaç¼–å†™åº”ç”¨è„šæœ¬ï¼Œéƒ¨ç½²åˆ°Nginxä¸­è¿è¡Œï¼Œå³Nginxå˜æˆäº†ä¸€ä¸ªWebå®¹å™¨ï¼›è¿™æ ·å¼€å‘äººå‘˜å°±å¯ä»¥ä½¿ç”¨Luaè¯­è¨€å¼€å‘é«˜æ€§èƒ½Webåº”ç”¨äº†ã€‚ å®‰è£…luawget http://luajit.org/download/LuaJIT-2.0.5.tar.gz tar -zxvf LuaJIT-2.0.5.tar.gz cd LuaJIT-2.0.5 make &amp;&amp; make install PREFIX=/usr/local/LuaJIT etc/profileåŠ å…¥# lua export LUAJIT_LIB=/usr/local/LuaJIT/lib export LUAJIT_INC=/usr/local/LuaJIT/include/luajit-2.0 source etc/profile ä¸‹è½½ngx_devel_kitæ¨¡å—wget https://github.com/simpl/ngx_devel_kit/archive/v0.3.0.tar.gz NDK(nginx development kit)æ¨¡å—æ˜¯ä¸€ä¸ªæ‹“å±•nginxæœåŠ¡å™¨æ ¸å¿ƒåŠŸèƒ½çš„æ¨¡å—ï¼Œç¬¬ä¸‰æ–¹æ¨¡å—å¼€å‘å¯ä»¥åŸºäºå®ƒæ¥å¿«é€Ÿå®ç°ã€‚ NDKæä¾›å‡½æ•°å’Œå®å¤„ç†ä¸€äº›åŸºæœ¬ä»»åŠ¡ï¼Œ å‡è½»ç¬¬ä¸‰æ–¹æ¨¡å—å¼€å‘çš„ä»£ç é‡ ä¸‹è½½lua-nginx-moduleæ¨¡å—wget https://github.com/openresty/lua-nginx-module/archive/v0.10.9rc7.tar.gz lua-nginx-module æ¨¡å—ä½¿nginxä¸­èƒ½ç›´æ¥è¿è¡Œlua æŸ¥çœ‹åŸå§‹ç¼–è¯‘ nginx -V å¦‚ï¼š configure arguments: --user=www --group=www --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module --with-http_sub_module --with-http_v2_module è¿›å…¥nginxåŸå§‹ç›®å½•ï¼š ./configure --user=www --group=www --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module --with-http_sub_module --with-http_v2_module --add-module=/root/lua-nginx-module-0.10.9rc7/ --add-module=/root/ngx_devel_kit-0.3.0 åªmakeï¼Œä¸æ‰§è¡Œmake installã€‚ ç¼–è¯‘æŠ¥é”™åº”è¯¥å°±æ˜¯luaç¯å¢ƒå˜é‡ä¸å¯¹ã€‚ nginx -V å‘½ä»¤æŠ¥é”™ ./nginx: error while loading shared libraries: libluajit-5.1.so.2: cannot open shared object file: No such file or directory è§£å†³ï¼š echo &quot;/usr/local/LuaJIT/lib&quot; &gt;&gt; /etc/ld.so.conf ldconfig æˆåŠŸä¹‹åå¯ä»¥nginx -VæŸ¥çœ‹ï¼Œæ— æŠ¥é”™å³å¯ã€‚ æŠŠåŸæ¥çš„nginxå¤‡ä»½ä¸ºnginx_old cp objs/nginxåˆ°åŸæ¥çš„nginxå¹¶è¦†ç›–ã€‚ åœ¨ç¼–è¯‘ç›®å½•æ‰§è¡Œ make upgrade æµ‹è¯•ï¼š server&#123; ... location /lua &#123; default_type &#x27;text/html&#x27;; content_by_lua &#x27; ngx.say(&quot;hello, lua!&quot;) &#x27;; &#125; ... &#125; æµè§ˆå™¨æ‰“å¼€ï¼š http://blog.13sai.com/lua å¯ä»¥çœ‹åˆ°hello, lua! æ­¤å®‰è£…æ–¹æ³•ä¹Ÿé€‚ç”¨äºNginxå…¶ä»–moduleå®‰è£…ã€‚","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"gitå›é€€è¿œç¨‹åˆ†æ”¯ç‰ˆæœ¬","slug":"gitå›é€€è¿œç¨‹åˆ†æ”¯ç‰ˆæœ¬","date":"2019-10-28T18:12:11.000Z","updated":"2022-03-19T14:35:21.686Z","comments":true,"path":"2019/10/29/201/","link":"","permalink":"https://github.13sai.com/2019/10/29/201/","excerpt":"","text":"å¶å°”ä¼šæœ‰ä»£ç æäº¤é”™è¯¯ï¼Œåˆæäº¤åˆ°è¿œç¨‹åˆ†æ”¯äº†ï¼Œæ€ä¹ˆå›é€€å‘¢ï¼Ÿ å¼ºåˆ¶å›é€€# æŸ¥çœ‹æ—¥å¿—ï¼Œæ‰¾åˆ°å¯¹åº”çš„commit id git log git reset --hard å›é€€çš„ç‰ˆæœ¬id git push -f origin åˆ†æ”¯å è¿™æ ·å›é€€æ˜¯æ¸…é™¤äº†å›é€€çš„ç‰ˆæœ¬idä¹‹åçš„æäº¤ï¼Œè¿æ—¥å¿—éƒ½æ²¡æœ‰äº†ã€‚ å›é€€ç‰ˆæœ¬# æŸ¥çœ‹æ—¥å¿—ï¼Œæ‰¾åˆ°å¯¹åº”çš„commit id git log git reset --soft å›é€€çš„ç‰ˆæœ¬id git commit è¿™æ ·å›é€€æ˜¯æ”¹å›å›é€€çš„ç‰ˆæœ¬idä¹‹åçš„æäº¤ï¼Œæ—¥å¿—ä»ç„¶å­˜åœ¨ã€‚","categories":[{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"}],"tags":[{"name":"git","slug":"git","permalink":"https://github.13sai.com/tags/git/"}]},{"title":"php+nginxä¸Šä¼ æ–‡ä»¶413","slug":"php+nginxä¸Šä¼ æ–‡ä»¶413","date":"2019-10-08T17:07:50.000Z","updated":"2022-03-19T14:35:21.774Z","comments":true,"path":"2019/10/09/200/","link":"","permalink":"https://github.13sai.com/2019/10/09/200/","excerpt":"","text":"æœ€è¿‘åœ¨é¡¹ç›®ä¸­ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™ï¼Œä¸Šä¼ å‡ºé”™ï¼Œè¿”å›413 Request Entity Too Large è§£å†³æ–¹æ³•ï¼šï¼ˆå…·ä½“å¤§å°è§†ä¸šåŠ¡è€Œå®šï¼‰ ä»¥ä¸‹ä»£ç åŠ å…¥ nginx.conf æ–‡ä»¶ä¸­çš„ http{ â€¦ } å—ä¸­ client_max_body_size 32M; PHP è®¾ç½®ä¸Šä¼ å¤§å° æ‰“å¼€php.ini æ–‡ä»¶ä¸­ ä¿®æ”¹ä»¥ä¸‹å‡ ä¸ªå‚æ•° memory_limit = 32M upload_max_filesize = 8M post_max_size = 16M é‡å¯nginxï¼Œfpmå³å¯ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"},{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"phpç”Ÿæˆå™¨yield","slug":"phpç”Ÿæˆå™¨yield","date":"2019-09-19T17:28:31.000Z","updated":"2022-03-19T14:35:21.788Z","comments":true,"path":"2019/09/20/199/","link":"","permalink":"https://github.13sai.com/2019/09/20/199/","excerpt":"","text":"ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°çœ‹èµ·æ¥åƒä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œä¸åŒçš„æ˜¯æ™®é€šå‡½æ•°è¿”å›ä¸€ä¸ªå€¼ï¼Œè€Œä¸€ä¸ªç”Ÿæˆå™¨å¯ä»¥yieldç”Ÿæˆè®¸å¤šå®ƒæ‰€éœ€è¦çš„å€¼ã€‚ ç”Ÿæˆå™¨æä¾›äº†ä¸€ç§æ›´å®¹æ˜“çš„æ–¹æ³•æ¥å®ç°ç®€å•çš„å¯¹è±¡è¿­ä»£ï¼Œç›¸æ¯”è¾ƒå®šä¹‰ç±»å®ç° Iterator æ¥å£çš„æ–¹å¼ï¼Œæ€§èƒ½å¼€é”€å’Œå¤æ‚æ€§å¤§å¤§é™ä½ã€‚ &lt;?php function xrange($start, $limit, $step = 1) &#123; if ($start &lt; $limit) &#123; if ($step &lt;= 0) &#123; throw new LogicException(&#x27;Step must be +ve&#x27;); &#125; for ($i = $start; $i &lt;= $limit; $i += $step) &#123; yield $i; &#125; &#125; else &#123; if ($step &gt;= 0) &#123; throw new LogicException(&#x27;Step must be -ve&#x27;); &#125; for ($i = $start; $i &gt;= $limit; $i += $step) &#123; yield $i; &#125; &#125; &#125; /* * æ³¨æ„ä¸‹é¢range()å’Œxrange()è¾“å‡ºçš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ */ echo &#x27;Single digit odd numbers from range(): &#x27;; foreach (range(1, 9, 2) as $number) &#123; echo &quot;$number &quot;; &#125; echo &quot;\\n&quot;; echo &#x27;Single digit odd numbers from xrange(): &#x27;; foreach (xrange(1, 9, 2) as $number) &#123; echo &quot;$number &quot;; &#125; // è¾“å‡ºå†…å®¹ Single digit odd numbers from range(): 1 3 5 7 9 Single digit odd numbers from xrange(): 1 3 5 7 9 é›†åˆlaravelä¸ä¸šåŠ¡ï¼ˆæ›´æ–°uvï¼‰çš„ä¾‹å­ï¼š &lt;?php /** * æ•°æ®ä¿®å¤ * Author: sai * Date: 2019/9/19 */ namespace App\\Console\\Commands; use App\\Models\\StatisticModel; use Illuminate\\Console\\Command; use Illuminate\\Support\\Facades\\DB; use Illuminate\\Support\\Facades\\Redis; class DataStatistic extends Command &#123; /** * The name and signature of the console command. * * @var string */ protected $signature = &#x27;DataStatistic&#x27;; /** * The console command description. * * @var string */ protected $description = &#x27;DataStatistic&#x27;; /** * Create a new command instance. * * @return void */ public function __construct() &#123; parent::__construct(); &#125; public function parseStr(...$param)&#123; $str = &#x27;&#x27;; foreach ($param as $key =&gt; $value) &#123; //å¤„ç†æ•°ç»„ if (is_array($value)) &#123; $value = md5(json_encode($value)); &#125; $str .= $value; &#125; return $str; &#125; public function handle() &#123; // å•ç‹¬è¾“å‡ºåˆ°updateChapter.logæ–‡ä»¶ \\Log::useFiles(storage_path().&#x27;/logs/data.log&#x27;); $iTime = time(); \\Log::info(&#x27;start&#x27;, [&#x27;timestamp&#x27; =&gt; $iTime]); $i = 0; $ret = $this-&gt;traverse(); foreach ($ret as $v) &#123; foreach ($v as $value) &#123; $key = $this-&gt;parseStr(&#x27;wx:&#x27;, $value-&gt;wx_id); $count = (int) Redis::pfcount($key); // redisé‡Œçš„uvæ›´å¤§æ—¶æ›´æ–°ï¼Œå¹¶è®°å½•æ›´æ–°å‰åæ•°æ® if ($count &gt; $value-&gt;uv) &#123; \\Log::info(&#x27;update id:&#x27;.$value-&gt;id, [$value-&gt;uv =&gt; $count]); $i++; (new StatisticModel([&#x27;hash_id&#x27; =&gt; $value-&gt;wx_id]))-&gt;where(&#x27;id&#x27;, $value-&gt;id)-&gt;update([&#x27;uv&#x27; =&gt; $count, &#x27;update_time&#x27; =&gt; $iTime]); &#125; &#125; &#125; // è®°å½•æ›´æ–°æ—¶é—´ä¸æ•°é‡ \\Log::info(&#x27;end&#x27;, [&#x27;timestamp&#x27;=&gt;time(), &#x27;count&#x27; =&gt; $i,&#x27;interval&#x27; =&gt; time() - $iTime]); return true; &#125; private function traverse() &#123; $page = 3000; for ($i = 1; $i &lt; 6; $i++) &#123; $count = DB::table(&#x27;wx_statistics_&#x27;.$i)-&gt;count(); if ($count &lt; 1) &#123; // è®°å½•è¿›åº¦ \\Log::info(&#x27;update schedule&#x27;, [&#x27;table success&#x27; =&gt; $i]); continue; &#125; $num = ceil($count/$page); for ($j = 0; $j &lt; $num; $j++) &#123; $ret = DB::table(&#x27;wx_statistics_&#x27;.$i) -&gt;select([&#x27;id&#x27;, &#x27;wx_id&#x27;, &#x27;uv&#x27;]) -&gt;orderBy(&#x27;id&#x27;, &#x27;asc&#x27;) -&gt;skip($j*$page) -&gt;take($page) -&gt;get() -&gt;toArray(); if (empty($ret)) &#123; continue; &#125; yield $ret; &#125; \\Log::info(&#x27;update schedule&#x27;, [&#x27;table success&#x27; =&gt; $i]); &#125; return true; &#125; &#125;","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"é€šè¿‡mysqlbinlogæ¢å¤è¯¯æ“ä½œæ¸…ç©ºçš„è¡¨","slug":"é€šè¿‡mysqlbinlogæ¢å¤è¯¯æ“ä½œæ¸…ç©ºçš„è¡¨","date":"2019-09-08T13:17:28.000Z","updated":"2022-03-19T14:35:21.952Z","comments":true,"path":"2019/09/08/198/","link":"","permalink":"https://github.13sai.com/2019/09/08/198/","excerpt":"","text":"æ˜¨å¤©æ™šä¸Šæœ‹å‹è¯´æ•°æ®åº“è¯¯åˆ äº†ï¼Œæ²¡æœ‰å¤‡ä»½èƒ½ä¸èƒ½æ¢å¤ï¼Œæˆ‘ä¸€æ„£ï¼Œçªç„¶æƒ³åˆ°ä¹‹å‰æˆ‘ä»¬é‡åˆ°è¿‡çš„é—®é¢˜ï¼Œä¾¿é—®ä»–æ˜¯å¦å¼€å¯äº†binlogã€‚ show variables like log_bin; å¦‚æœç°å®log_binæ˜¯ONï¼Œå°±è¯´æ˜æ‰“å¼€äº†ã€‚ å€¼å¾—åº†å¹¸ï¼Œä»–ä»¬çš„ç”Ÿäº§æ•°æ®åº“å¼€äº†binlogã€‚ç„¶åè·Ÿä»–è¯´äº†ä¸‹è¿™ä¸ªå¯ä»¥æ¢å¤ï¼Œè®©ä»–ä»¬å»æ“ä½œä¸€ä¸‹ã€‚ç»“æœé‚£è¾¹é—®æˆ‘èƒ½ä¸èƒ½æ“ä½œï¼Œæˆ‘è¯´å¯ä»¥ã€‚ æ“ä½œï¼š æ‰¾åˆ°å­˜æ”¾binlogçš„ç›®å½• mysqlbinlog mysql-bin.000011 &gt; bak.log æ‰¾åˆ°åˆ é™¤çš„è¯­å¥æ—¶é—´ å¯¼å‡ºsql mysqlbinlog â€“stop-datetime=â€2019-09-07 17:30:31â€ mysql-bin.000011 &gt;all.sql stop-datetimeåº”è¯¥æ˜¯è¯¯åˆ æ“ä½œå‰ä¸€åˆ»æ—¶é—´ã€‚ ä¸‹è½½all.sqlå€’å…¥æœ¬åœ°æ•°æ®åº“ï¼Œå¯¼å‡ºè¯¯åˆ è¡¨ï¼Œå€’å…¥ç”Ÿäº§æ•°æ®åº“ã€‚ æ£€æµ‹ç”Ÿäº§æ•°æ®åº“ï¼Œæ— å¼‚å¸¸å³å¯ åæ€ï¼š å¯¼å‡ºsqlæ—¶åº”è¯¥æŒ‡å®šæ•°æ®åº“ mysqlbinlog â€“stop-datetime=â€2019-09-07 17:30:31â€ â€“database=test mysql-bin.000893 &gt;all.sql æ•°æ®åº“é‡è¦æ•°æ®å°½é‡ä¸€å¤©ä¸€å¤‡ä»½ï¼Œç„¶åå¼€å¯binlogï¼Œä¸ºäº†å‡å°‘ç¡¬ç›˜ç©ºé—´å ç”¨ï¼Œè®¾ç½®expire_logs_days ç”Ÿäº§æ•°æ®åº“ä¸ä½¿ç”¨rootç”¨æˆ·ï¼Œæ–°å»ºç”¨æˆ·ï¼Œé™åˆ¶dropï¼Œtruncateç­‰å±é™©æ“ä½œæƒé™ mysqlbin","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"mysqlåˆ†é¡µé‡å¤","slug":"mysqlåˆ†é¡µé‡å¤","date":"2019-09-04T15:10:16.000Z","updated":"2022-03-19T14:35:21.770Z","comments":true,"path":"2019/09/04/197/","link":"","permalink":"https://github.13sai.com/2019/09/04/197/","excerpt":"","text":"ä¹‹å‰åœ¨é¡¹ç›®ä¸­åšåˆ†é¡µæ—¶ï¼Œå‘ç°ç¬¬äºŒé¡µå’Œç¬¬ä¸‰é¡µå‡ºç°äº†ç³»ç»Ÿçš„æ•°æ®ï¼ŒæŸ¥äº†ä¸‹æ•°æ®æ€»æ•°æ²¡å˜ï¼Œå‘ç°æ˜¯orderç›¸åŒå¯¼è‡´çš„ã€‚ è§£å†³æ–¹æ¡ˆï¼šåœ¨æ’åºåœ¨æœ€ååŠ å…¥ä¸»é”®æ’åº","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"laravelé»˜è®¤åˆ†é¡µå¸¦å‚","slug":"Laravelé»˜è®¤åˆ†é¡µå¸¦å‚","date":"2019-09-02T11:07:26.000Z","updated":"2022-07-05T08:53:49.923Z","comments":true,"path":"2019/09/02/196/","link":"","permalink":"https://github.13sai.com/2019/09/02/196/","excerpt":"","text":"é»˜è®¤çš„laravelåˆ†é¡µæ˜¯åªå¸¦åˆ†é¡µå‚æ•°çš„ï¼Œé‚£ä¹ˆå¦‚ä½•åŠ å…¥å…¶å®ƒå‚æ•°å‘¢ï¼Ÿæ¯”å¦‚æœç´¢é¡¹ã€‚ åç«¯å¸¦å‚ $list = $model::paginate(2); $list-&gt;appends([ name=&gt;$name, city=&gt;$city, ])-&gt;render(); return view(admin, [ list =&gt; $list ]); // bladeä½¿ç”¨&#123;&#123; $list-&gt;links() &#125;&#125; å‰ç«¯å¸¦å‚ $list = $model::paginate(2); return view(admin.apply.apply, [ list =&gt; $list, name =&gt; $name, city =&gt; $city ]); //å‰ç«¯ &#123;&#123; $list-&gt;appends([name=&gt;$name, city =&gt; $city])-&gt;links() &#125;&#125; ä¸¤ç§æ–¹æ³•å‡å¯ï¼","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"}]},{"title":"å­¦ä¹ goé‡åˆ°çš„ä¸€äº›é—®é¢˜å’Œæ¦‚å¿µæ±‡æ€»","slug":"å­¦ä¹ goé‡åˆ°çš„ä¸€äº›é—®é¢˜å’Œæ¦‚å¿µæ±‡æ€»","date":"2019-08-24T19:36:19.000Z","updated":"2022-03-19T14:35:21.906Z","comments":true,"path":"2019/08/25/195/","link":"","permalink":"https://github.13sai.com/2019/08/25/195/","excerpt":"","text":"go getå®‰è£…x/syså¤±è´¥çš„è§£å†³// $GOPATHè¿™æ®µåœ°å€è¯·è‡ªè¡Œä¿®æ”¹ï¼Œä¸‹è½½åˆ°gorootå’Œgopathå¯¹åº”ä½ç½®å³å¯ï¼Œä¸åŒç³»ç»Ÿç•¥æœ‰ä¸åŒ git clone https://github.com/golang/net.git $GOPATH/src/github.com/golang/net git clone https://github.com/golang/sys.git $GOPATH/src/github.com/golang/sys git clone https://github.com/golang/tools.git $GOPATH/src/github.com/golang/tools ln -s $GOPATH/src/github.com/golang $GOPATH/src/golang.org/x go getå‘½ä»¤å®‰è£…golang.orgæ¯”è¾ƒæ…¢çš„è¯ï¼Œä¸€èˆ¬éƒ½å¯ä»¥åœ¨github.comæ‰¾åˆ°å¯¹åº”çš„packageï¼Œä¸‹è½½åæ”¾åˆ°å¯¹åº”çš„ç›®å½•å³å¯ goçš„ç¯å¢ƒå˜é‡è®¾ç½®åœ¨/etc/profileæœ€ä¸‹é¢åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š # å¯è‡ªè¡Œæ”¹æˆä½ çš„ç›®å½• export GO_INSTALL_DIR=$HOME export GOROOT=$GO_INSTALL_DIR/go export GOPATH=$HOME/mygo export PATH=$GOPATH/bin:$PATH:$GO_INSTALL_DIR/go/bin import import _ æ‰§è¡Œinitå‡½æ•°ï¼Œä½†ä¸éœ€è¦åŒ…æ‰€æœ‰å‡½æ•° import . è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜ &amp;å’Œ* &amp;ç¬¦å·çš„æ„æ€æ˜¯å¯¹å˜é‡å–åœ°å€ï¼Œå¦‚ï¼šå˜é‡açš„åœ°å€æ˜¯&amp;aç¬¦å·çš„æ„æ€æ˜¯å¯¹æŒ‡é’ˆå–å€¼ï¼Œå’Œè½&amp;è½å¯ä»¥äº’ç›¸æŠµæ¶ˆ,åŒæ—¶æ³¨æ„ï¼Œ*&amp;å¯ä»¥æŠµæ¶ˆæ‰ï¼Œä½†&amp;*æ˜¯ä¸å¯ä»¥æŠµæ¶ˆçš„ åˆ‡ç‰‡å®¹é‡ å®¹é‡å½“åšæˆæ€»é•¿åº¦å‡å»å·¦æŒ‡é’ˆèµ°è¿‡çš„å…ƒç´ å€¼ ä¸€æ—¦ä¸€ä¸ªåˆ‡ç‰‡æ— æ³•å®¹çº³æ›´å¤šçš„å…ƒç´ ï¼ŒGoè¯­è¨€å°±ä¼šæƒ³åŠæ³•æ‰©å®¹ã€‚ä½†å®ƒå¹¶ä¸ä¼šæ”¹å˜åŸæ¥çš„åˆ‡ç‰‡ï¼Œè€Œæ˜¯ä¼šç”Ÿæˆä¸€ä¸ªå®¹é‡æ›´å¤§çš„åˆ‡ç‰‡ï¼Œç„¶åå°†æŠŠåŸæœ‰çš„å…ƒç´ å’Œæ–°å…ƒç´ ä¸€å¹¶æ‹·è´åˆ°æ–°åˆ‡ç‰‡ä¸­ã€‚åœ¨ä¸€èˆ¬çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç®€å•åœ°è®¤ä¸ºæ–°åˆ‡ç‰‡çš„å®¹é‡ï¼ˆä»¥ä¸‹ç®€ç§°æ–°å®¹é‡ï¼‰å°†ä¼šæ˜¯åŸåˆ‡ç‰‡å®¹é‡ï¼ˆä»¥ä¸‹ç®€ç§°åŸå®¹é‡ï¼‰çš„2å€ã€‚ ä½†æ˜¯ï¼Œå½“åŸåˆ‡ç‰‡çš„é•¿åº¦ï¼ˆä»¥ä¸‹ç®€ç§°åŸé•¿åº¦ï¼‰å¤§äºæˆ–ç­‰äº1024æ—¶ï¼ŒGoè¯­è¨€å°†ä¼šä»¥åŸå®¹é‡çš„1.25å€ä½œä¸ºæ–°å®¹é‡çš„åŸºå‡†ï¼ˆä»¥ä¸‹æ–°å®¹é‡åŸºå‡†ï¼‰ã€‚æ–°å®¹é‡åŸºå‡†ä¼šè¢«è°ƒæ•´ï¼ˆä¸æ–­åœ°ä¸1.25ç›¸ä¹˜ï¼‰ï¼Œç›´åˆ°ç»“æœä¸å°äºåŸé•¿åº¦ä¸è¦è¿½åŠ çš„å…ƒç´ æ•°é‡ä¹‹å’Œï¼ˆä»¥ä¸‹ç®€ç§°æ–°é•¿åº¦ï¼‰ã€‚æœ€ç»ˆï¼Œæ–°å®¹é‡å¾€å¾€ä¼šæ¯”æ–°é•¿åº¦å¤§ä¸€äº›ï¼Œå½“ç„¶ï¼Œç›¸ç­‰ä¹Ÿæ˜¯å¯èƒ½çš„ã€‚ å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬ä¸€æ¬¡è¿½åŠ çš„å…ƒç´ è¿‡å¤šï¼Œä»¥è‡³äºä½¿æ–°é•¿åº¦æ¯”åŸå®¹é‡çš„2å€è¿˜è¦å¤§ï¼Œé‚£ä¹ˆæ–°å®¹é‡å°±ä¼šä»¥æ–°é•¿åº¦ä¸ºåŸºå‡†ã€‚ å¤§å°å†™ åœ¨Goè¯­è¨€ä¸­ï¼Œæ²¡æœ‰ç‰¹åˆ«çš„å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªæ–¹æ³•ã€å‡½æ•°æˆ–è€…ç±»å‹æ˜¯å¦ä¸ºå…¬å¼€çš„ï¼ŒGoè¯­è¨€æä¾›çš„æ˜¯ä»¥å¤§å°å†™çš„æ–¹å¼è¿›è¡ŒåŒºåˆ†çš„ï¼Œå¦‚æœä¸€ä¸ªç±»å‹çš„åå­—æ˜¯ä»¥å¤§å†™å¼€å¤´ï¼Œé‚£ä¹ˆå…¶ä»–åŒ…å°±å¯ä»¥è®¿é—®ï¼›å¦‚æœä»¥å°å†™å¼€å¤´ï¼Œå…¶ä»–åŒ…å°±ä¸èƒ½è®¿é—®ã€‚ goçš„å¹¶å‘ æ¦‚å¿µ è¯´æ˜ è¿›ç¨‹ ä¸€ä¸ªç¨‹åºå¯¹åº”ä¸€ä¸ªç‹¬ç«‹ç¨‹åºç©ºé—´ çº¿ç¨‹ ä¸€ä¸ªæ‰§è¡Œç©ºé—´ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ é€»è¾‘å¤„ç†å™¨ æ‰§è¡Œåˆ›å»ºçš„goroutineï¼Œç»‘å®šä¸€ä¸ªçº¿ç¨‹ è°ƒåº¦å™¨ Goè¿è¡Œæ—¶ä¸­çš„ï¼Œåˆ†é…goroutineç»™ä¸åŒçš„é€»è¾‘å¤„ç†å™¨ å…¨å±€è¿è¡Œé˜Ÿåˆ— æ‰€æœ‰åˆšåˆ›å»ºçš„goroutineéƒ½ä¼šæ”¾åˆ°è¿™é‡Œ æœ¬åœ°è¿è¡Œé˜Ÿåˆ— é€»è¾‘å¤„ç†å™¨çš„goroutineé˜Ÿåˆ— å¹¶å‘çš„æ¦‚å¿µå’Œå¹¶è¡Œä¸ä¸€æ ·ï¼Œå¹¶è¡ŒæŒ‡çš„æ˜¯åœ¨ä¸åŒçš„ç‰©ç†å¤„ç†å™¨ä¸ŠåŒæ—¶æ‰§è¡Œä¸åŒçš„ä»£ç ç‰‡æ®µï¼Œå¹¶è¡Œå¯ä»¥åŒæ—¶åšå¾ˆå¤šäº‹æƒ…ï¼Œè€Œå¹¶å‘æ˜¯åŒæ—¶ç®¡ç†å¾ˆå¤šäº‹æƒ…ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶çš„æ€»èµ„æºæ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥å¹¶å‘çš„æ•ˆæœè¦æ¯”å¹¶è¡Œå¥½çš„å¤šï¼Œä½¿ç”¨è¾ƒå°‘çš„èµ„æºåšæ›´å¤šçš„äº‹æƒ…ï¼Œä¹Ÿæ˜¯Goè¯­è¨€æå€¡çš„ã€‚ é€šé“h:=make(chan int) é€šé“ç±»å‹å’ŒMapè¿™äº›ç±»å‹ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨å†…ç½®çš„makeå‡½æ•°å£°æ˜åˆå§‹åŒ–ï¼Œè¿™é‡Œæˆ‘ä»¬åˆå§‹åŒ–äº†ä¸€ä¸ªchan intç±»å‹çš„é€šé“ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½å¾€è¿™ä¸ªé€šé“é‡Œå‘é€intç±»å‹çš„æ•°æ®ï¼Œå½“ç„¶æ¥æ”¶ä¹Ÿåªèƒ½æ˜¯intç±»å‹çš„æ•°æ®ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œé€šé“æ˜¯ç”¨äºåœ¨goroutineä¹‹é—´é€šä¿¡çš„ï¼Œå®ƒå…·æœ‰å‘é€å’Œæ¥æ”¶ä¸¤ä¸ªæ“ä½œï¼Œè€Œä¸”è¿™ä¸¤ä¸ªæ“ä½œçš„è¿ç®—ç¬¦éƒ½æ˜¯&lt;-ã€‚ ch &lt;- 2 //å‘é€æ•°å€¼2ç»™è¿™ä¸ªé€šé“ x:=&lt;-ch //ä»é€šé“é‡Œè¯»å–å€¼ï¼Œå¹¶æŠŠè¯»å–çš„å€¼èµ‹å€¼ç»™xå˜é‡ &lt;-ch //ä»é€šé“é‡Œè¯»å–å€¼ï¼Œç„¶åå¿½ç•¥ çœ‹ä¾‹å­ï¼Œæ…¢æ…¢ç†è§£å‘é€å’Œæ¥æ”¶çš„ç”¨æ³•ã€‚å‘é€æ“ä½œ&lt;-åœ¨é€šé“çš„åé¢ï¼Œçœ‹ç®­å¤´æ–¹å‘ï¼Œè¡¨ç¤ºæŠŠæ•°å€¼2å‘é€åˆ°é€šé“ché‡Œï¼›æ¥æ”¶æ“ä½œ&lt;-åœ¨é€šé“çš„å‰é¢ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªä¸€å…ƒæ“ä½œç¬¦ï¼Œçœ‹ç®­å¤´æ–¹å‘ï¼Œè¡¨ç¤ºä»é€šé“ché‡Œè¯»å–æ•°æ®ã€‚è¯»å–çš„æ•°æ®å¯ä»¥èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œä¹Ÿå¯ä»¥å¿½ç•¥ã€‚ é€šé“æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å†…ç½®çš„closeå‡½æ•°å…³é—­ã€‚ close(ch) æ— ç¼“å†²çš„é€šé“æ— ç¼“å†²çš„é€šé“æŒ‡çš„æ˜¯é€šé“çš„å¤§å°ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§ç±»å‹çš„é€šé“åœ¨æ¥æ”¶å‰æ²¡æœ‰èƒ½åŠ›ä¿å­˜ä»»ä½•å€¼ï¼Œå®ƒè¦æ±‚å‘é€goroutineå’Œæ¥æ”¶goroutineåŒæ—¶å‡†å¤‡å¥½ï¼Œæ‰å¯ä»¥å®Œæˆå‘é€å’Œæ¥æ”¶æ“ä½œã€‚ ä»ä¸Šé¢æ— ç¼“å†²çš„é€šé“å®šä¹‰æ¥çœ‹ï¼Œå‘é€goroutineå’Œæ¥æ”¶gouroutineå¿…é¡»æ˜¯åŒæ­¥çš„ï¼ŒåŒæ—¶å‡†å¤‡åï¼Œå¦‚æœæ²¡æœ‰åŒæ—¶å‡†å¤‡å¥½çš„è¯ï¼Œå…ˆæ‰§è¡Œçš„æ“ä½œå°±ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°å¦ä¸€ä¸ªç›¸å¯¹åº”çš„æ“ä½œå‡†å¤‡å¥½ä¸ºæ­¢ã€‚è¿™ç§æ— ç¼“å†²çš„é€šé“æˆ‘ä»¬ä¹Ÿç§°ä¹‹ä¸ºåŒæ­¥é€šé“ã€‚ func main() &#123; ch := make(chan int) go func() &#123; var sum int = 0 for i := 0; i &lt; 10; i++ &#123; sum += i &#125; ch &lt;- sum &#125;() fmt.Println(&lt;-ch) &#125; æœ‰ç¼“å†²çš„é€šé“æœ‰ç¼“å†²é€šé“ï¼Œå…¶å®æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™ä¸ªé˜Ÿåˆ—çš„æœ€å¤§å®¹é‡å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨makeå‡½æ•°åˆ›å»ºé€šé“æ—¶ï¼Œé€šè¿‡ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ã€‚ ch := make(chan int, 3)è¿™é‡Œåˆ›å»ºå®¹é‡ä¸º3çš„ï¼Œæœ‰ç¼“å†²çš„é€šé“ã€‚å¯¹äºæœ‰ç¼“å†²çš„é€šé“ï¼Œå‘å…¶å‘é€æ“ä½œå°±æ˜¯å‘é˜Ÿåˆ—çš„å°¾éƒ¨æ’å…¥å…ƒç´ ï¼Œæ¥æ”¶æ“ä½œåˆ™æ˜¯ä»é˜Ÿåˆ—çš„å¤´éƒ¨åˆ é™¤å…ƒç´ ï¼Œå¹¶è¿”å›è¿™ä¸ªåˆšåˆšåˆ é™¤çš„å…ƒç´ ã€‚ å½“é˜Ÿåˆ—æ»¡çš„æ—¶å€™ï¼Œå‘é€æ“ä½œä¼šé˜»å¡ï¼›å½“é˜Ÿåˆ—ç©ºçš„æ—¶å€™ï¼Œæ¥å—æ“ä½œä¼šé˜»å¡ã€‚æœ‰ç¼“å†²çš„é€šé“ï¼Œä¸è¦æ±‚å‘é€å’Œæ¥æ”¶æ“ä½œæ—¶åŒæ­¥çš„ï¼Œç›¸åå¯ä»¥è§£è€¦å‘é€å’Œæ¥æ”¶æ“ä½œã€‚ æƒ³çŸ¥é“é€šé“çš„å®¹é‡ä»¥åŠé‡Œé¢æœ‰å‡ ä¸ªå…ƒç´ æ•°æ®æ€ä¹ˆåŠï¼Ÿå…¶å®å’Œmapä¸€æ ·ï¼Œä½¿ç”¨capå’Œlenå‡½æ•°å°±å¯ä»¥äº†ã€‚ cap(ch) len(ch) capå‡½æ•°è¿”å›é€šé“çš„æœ€å¤§å®¹é‡ï¼Œlenå‡½æ•°è¿”å›ç°åœ¨é€šé“é‡Œæœ‰å‡ ä¸ªå…ƒç´ ã€‚ func mirroredQuery() string &#123; responses := make(chan string, 3) go func() &#123; responses &lt;- request(&quot;asia.gopl.io&quot;) &#125;() go func() &#123; responses &lt;- request(&quot;europe.gopl.io&quot;) &#125;() go func() &#123; responses &lt;- request(&quot;americas.gopl.io&quot;) &#125;() return &lt;-responses // return the quickest response &#125; func request(hostname string) (response string) &#123; /* ... */ &#125; å•å‘é€šé“æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰ä¸€äº›ç‰¹æ®Šåœºæ™¯ï¼Œæ¯”å¦‚é™åˆ¶ä¸€ä¸ªé€šé“åªå¯ä»¥æ¥æ”¶ï¼Œä½†æ˜¯ä¸èƒ½å‘é€ï¼›æœ‰æ—¶å€™é™åˆ¶ä¸€ä¸ªé€šé“åªèƒ½å‘é€ï¼Œä½†æ˜¯ä¸èƒ½æ¥æ”¶ï¼Œè¿™ç§é€šé“æˆ‘ä»¬ç§°ä¸ºå•å‘é€šé“ã€‚è¿™ä¸ªåœ¨ç”Ÿäº§è€…æ¶ˆè´¹è€…å¾ˆå®ç”¨ã€‚ å®šä¹‰å•å‘é€šé“ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œå¸¦ä¸Š&lt;-å³å¯ã€‚ var send chan&lt;- int //åªèƒ½å‘é€ var receive &lt;-chan int //åªèƒ½æ¥æ”¶","categories":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"}],"tags":[{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"}]},{"title":"åˆ©ç”¨jenkinså‘å¸ƒä»£ç ","slug":"åˆ©ç”¨jenkinså‘å¸ƒä»£ç ","date":"2019-07-30T16:28:48.000Z","updated":"2022-03-19T14:35:21.888Z","comments":true,"path":"2019/07/31/194/","link":"","permalink":"https://github.13sai.com/2019/07/31/194/","excerpt":"","text":"å®‰è£…jenkinsdocker run \\ -u root \\ --rm \\ -d \\ -p 8090:8080 \\ -p 50000:50000 \\ -v jenkins-data:/var/jenkins_home \\ -v /var/run/docker.sock:/var/run/docker.sock \\ jenkinsci/blueocean è¿›å…¥å®¹å™¨æŸ¥çœ‹å¯†ç ï¼š docker exec -it 6d1a7f988069 /bin/bash å¯†ç å­˜å‚¨è·¯å¾„ /var/jenkins_home/secrets/initialAdminPassword jenkinså…³è”gitï¼Œæ‹‰å–æ— éœ€å¯†ç éªŒè¯// äº§ç”Ÿå…¬é’¥ä¸ç§é’¥å¯¹. ssh-keygen // ç”¨ssh-copy-idå°†å…¬é’¥å¤åˆ¶åˆ°è¿œç¨‹æœºå™¨ä¸­(gitlabç­‰) ssh-copy-id -i .ssh/id_rsa.pub git@xxx.com jenkinså…³è”ä»£ç æœåŠ¡å™¨ï¼ŒåŒæ­¥æ— éœ€å¯†ç éªŒè¯// å°½é‡ä½¿ç”¨å†…ç½‘ip scp -p .ssh/id_rsa.pub www@172.17.158.15:/home/www/.ssh/authorized_keys æ–°å»ºé¡¹ç›® é€‰æ‹©è‡ªç”±é£æ ¼é¡¹ç›® Source Code Managementå¡«å†™gitåœ°å€ Buildæ‰§è¡Œshellè„šæœ¬ shell demo #!/bin/bash echo $&#123;BUILD_USER&#125; SOURCE_DIR=/var/jenkins_home/workspace/$&#123;JOB_NAME&#125;/ DEST_DIR=/usr/local/nginx/html/jenkins REMOTE_IP=172.17.158.15 scp -r $SOURCE_DIR www@$REMOTE_IP:$DEST_DIR ä¿å­˜åç‚¹å‡»æ„å»ºã€‚åŸç†ï¼šjenkinsæ‹‰å–gitä»£ç jenkinsæœåŠ¡å™¨ï¼ŒscpåŒæ­¥ä»£ç åˆ°ä»£ç æœåŠ¡å™¨ã€‚ æ˜“å‡ºé”™ç‚¹ï¼š æœåŠ¡å™¨ç›®å½•æƒé™é—®é¢˜ gitæ‹‰å–sshéªŒè¯ ç›®å½• æ„å»ºæ—¶å¯æŸ¥çœ‹Console Outputä¿¡æ¯ï¼Œèƒ½çœ‹å‡ºå“ªä¸€æ­¥é”™è¯¯ï¼Œç„¶åå¤„ç†å³å¯ã€‚","categories":[{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"}],"tags":[{"name":"jenkins","slug":"jenkins","permalink":"https://github.13sai.com/tags/jenkins/"}]},{"title":"nginxæ—¥å¿—æŒ‰æ—¥é…ç½®","slug":"Nginxæ—¥å¿—æŒ‰æ—¥é…ç½®","date":"2019-07-22T18:04:44.000Z","updated":"2022-03-19T15:27:59.969Z","comments":true,"path":"2019/07/23/Nginx8/","link":"","permalink":"https://github.13sai.com/2019/07/23/Nginx8/","excerpt":"","text":"è€å®è¯´ï¼Œæˆ‘è§‰å¾—nginxæ²¡æœ‰æ—¥å¿—æŒ‰æ—¥é…ç½®åŠŸèƒ½ç¼ºå¤±æœ‰ç‚¹è´¹è§£ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç å®ç°ã€‚é…ç½®å¦‚ä¸‹ï¼š if ($time_iso8601 ~ &quot;^(\\d&#123;4&#125;)-(\\d&#123;2&#125;)-(\\d&#123;2&#125;)&quot;) &#123; set $day $1$2$3; &#125; access_log logs/access-$day.log main;","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"lua+nginxå®ç°é»‘åå•ç¦æ­¢è®¿é—®","slug":"lua-nginxå®ç°é»‘åå•ç¦æ­¢è®¿é—®","date":"2019-07-15T17:35:49.000Z","updated":"2022-03-19T14:35:21.764Z","comments":true,"path":"2019/07/16/192/","link":"","permalink":"https://github.13sai.com/2019/07/16/192/","excerpt":"","text":"luaæ˜¯å¯ä»¥å¾ˆå¥½åœ°å’ŒNginxé…åˆä½¿ç”¨çš„ï¼Œå»åœ¨ä»£ç ä¹‹å‰åšä¸€äº›å¤„ç†ï¼Œè¿™é‡Œæˆ‘ä»¬åŠ›æ±‚ç®€å•ï¼Œçœå»å®‰è£…ï¼Œä½¿ç”¨OpenRestyï¼ˆåŸºäº Nginx ä¸ Lua çš„é«˜æ€§èƒ½ Web å¹³å°ï¼‰ OpenRestyåœ°å€ æˆ‘æ˜¯åœ¨windows7ç”µè„‘ä¸Šæµ‹è¯•ä½¿ç”¨ï¼Œä¸»è¦é…ç½®ä»£ç å¦‚ä¸‹ï¼š # åˆ†é…å†…å­˜ï¼Œæ ¹æ®ä¸šåŠ¡é‡ lua_shared_dict ip_blacklist 1m; server &#123; listen 80; server_name localhost; root E:/www/web/test; access_log logs/host.access.log ; error_log logs/host.error.log; location / &#123; access_by_lua_file ../lua/black.lua; index index.html index.htm; &#125; error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root html; &#125; location ~ \\.php$ &#123; # æŒ‡å®šluaæ–‡ä»¶ access_by_lua_file &quot;D:\\openresty-1.15.8.1-win64/lua/black.lua&quot;; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; &#125; &#125; black.lua local redis_host = &quot;127.0.0.1&quot; -- è¿™é‡Œä¸€å®šæ˜¯redisçš„IPåœ°å€ local redis_port = &quot;6379&quot; -- è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½msï¼Œä¸å»ºè®®è®¾ç½®å¤ªé«˜ local redis_connection_timeout = 1000 local redis_key = &quot;ip_blacklist&quot; -- ç¼“å­˜æ—¶é—´ï¼Œå•ä½s local cache_ttl = 100 -- ä»¥ä¸Šæ˜¯é…ç½® local ip = ngx.var.remote_addr local ip_blacklist = ngx.shared.ip_blacklist local last_update_time = ip_blacklist:get(&quot;last_update_time&quot;); -- å½“ç¼“å­˜æ—¶é—´åˆ°æœŸæ›´æ–°blacklist if last_update_time == nil or last_update_time &lt; ( ngx.now() - cache_ttl ) then local redis = require &quot;resty.redis&quot;; local red = redis:new(); red:set_timeout(redis_connect_timeout); local ok, err = red:connect(redis_host, redis_port); if not ok then ngx.say(&quot;redis connect failed: &quot;, err) ngx.log(ngx.DEBUG, &quot;Redis connection error while retrieving ip_blacklist: &quot; .. err); return ngx.exit(ngx.HTTP_INTERNAL_SERVER_ERROR) else -- local res, err = red:auth(&quot;foobared&quot;) -- é…ç½®redisçš„å¯†ç ï¼Œæˆ‘æµ‹è¯•æœªè®¾ç½®å¯†ç ï¼Œä»£ç æ³¨é‡Š --if not res then --ngx.say(&quot;redis auth is error: &quot;, err) --return --end red:select(0) -- è®¾ç½®redisçš„db local new_ip_blacklist, err = red:smembers(redis_key); if err then ngx.log(ngx.DEBUG, &quot;Redis read error while retrieving ip_blacklist: &quot; .. err); else -- æƒ…å†µæœ¬åœ°å­˜å‚¨ ip_blacklist:flush_all(); for index, banned_ip in ipairs(new_ip_blacklist) do ip_blacklist:set(banned_ip, true); end -- æ›´æ–°æ—¶é—´ ip_blacklist:set(&quot;last_update_time&quot;, ngx.now()); end end end if ip_blacklist:get(ip) then --ngx.say(ip) ngx.log(ngx.DEBUG, &quot;Banned IP detected and refused access: &quot; .. ip); return ngx.exit(ngx.HTTP_FORBIDDEN); end å®Œæˆã€‚ å½“ç„¶äº†ï¼Œè¿™åªæ˜¯ä¸ªåŸºç¡€ç‰ˆæœ¬ï¼Œä½ å¯ä»¥è®©è¿™ä¸ªç¦æ­¢è®¿é—®åŠŸèƒ½æ›´å¼ºå¤§ï¼Œæ¯”å¦‚å¢åŠ å¯ç–‘ipå†™å…¥ï¼Œæ¯”å¦‚å¢åŠ ipé™æµç­‰ç­‰ã€‚","categories":[{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/tags/Linux/"}]},{"title":"Laravelç®¡ç†æ—¥å¿—","slug":"Laravelç®¡ç†æ—¥å¿—","date":"2019-07-04T15:50:25.000Z","updated":"2022-07-05T08:53:26.688Z","comments":true,"path":"2019/07/04/191/","link":"","permalink":"https://github.13sai.com/2019/07/04/191/","excerpt":"","text":"æ—¥å¿—æ˜¯å¾ˆé‡è¦çš„ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•é…ç½®èƒ½è®©Laravelæ›´å¥½ç®¡ç†å’ŒæŸ¥çœ‹å‘¢ï¼Ÿ æŒ‰æ—¥æŸ¥çœ‹è®¾ç½®ç®€å•ï¼Œåœ¨.envåŠ å…¥APP_LOG=dailyï¼Œå¦å¤–å¯å®šä¹‰æœ€å¤§æ—¥å¿—ä¿å­˜å¤©æ•°åœ¨é…ç½®æ–‡ä»¶config/app.phpä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼šlog_max_files=&gt;30 æ”¶é›†é‡è¦æ—¥å¿—Log::useFiles(storage_path(logs/important.log)); // æŒ‰æ—¥ï¼Œå­˜å‚¨30å¤©çš„ Log::useDailyFiles(storage_path(logs/importantDaily.log, 30));","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"}]},{"title":"å¿«é€Ÿæ‰¾åˆ°php.iniæ–‡ä»¶ä½ç½®","slug":"å¿«é€Ÿæ‰¾åˆ°php.iniæ–‡ä»¶ä½ç½®","date":"2019-06-26T16:02:04.000Z","updated":"2022-03-19T14:35:21.922Z","comments":true,"path":"2019/06/27/190/","link":"","permalink":"https://github.13sai.com/2019/06/27/190/","excerpt":"","text":"ç°åœ¨æœåŠ¡å™¨è£…å¤šä¸ªç‰ˆæœ¬phpå¾ˆå¸¸è§ï¼Œé‚£ä¹ˆå¦‚ä½•å¿«é€Ÿæ‰¾åˆ°php.iniæ–‡ä»¶ä½ç½®å‘¢ï¼Ÿ phpinfo() php -i | grep php.ini find / -name php.ini php â€“ini","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"Laravelæ¨¡æ¿æ¸²æŸ“çš„é—®é¢˜","slug":"Laravelæ¨¡æ¿æ¸²æŸ“çš„é—®é¢˜","date":"2019-05-22T06:36:12.000Z","updated":"2022-07-05T08:54:09.453Z","comments":true,"path":"2019/05/22/189/","link":"","permalink":"https://github.13sai.com/2019/05/22/189/","excerpt":"","text":"1. laravelæ¨¡æ¿å˜é‡ç¬¦æ›´æ”¹å‰å‡ å¤©æ”¹ç‰ˆæ—¶ï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯ä½¿ç”¨äº†art-templateï¼Œåˆšå¥½æœ‰å’ŒLaravelé»˜è®¤çš„å˜é‡ç¬¦å·ï¼Œå°±å‘ç°äº†ç‚¹é—®é¢˜ã€‚ è§£å†³æ–¹æ³•ï¼š å‰ç«¯ä¿®æ”¹art-templateçš„ç¬¦å·ï¼Œé˜²æ­¢å’ŒLaravelå†²çªï¼› ä¿®æ”¹Laravelæ¨¡æ¿å˜é‡ç¬¦-åŒå¤§æ‹¬å· å¯ä»¥åœ¨æ§åˆ¶å™¨è°ƒç”¨viewæ–¹æ³•ä¹‹å‰åŠ å…¥ Blade::setContentTags([[, ]]); Blade::setEscapedContentTags(&#123;[@, @]&#125;); ä¾¿å¯ä»¥ç”¨{[@, @]}æ›¿ä»£åŸæ¥çš„åŒå¤§æ‹¬å·ã€‚ 2. åŠ è½½htmlä¸ä½¿ç”¨bladeæ¨¡æ¿å¼•æ“é™¤äº†è¿™ä¸ªè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚å‰åç«¯åˆ†ç¦»çš„æ—¶å€™ï¼Œæˆ‘åªæƒ³åŠ è½½htmlï¼Œä¸éœ€è¦æ¸²æŸ“æ›¿æ¢ï¼Œè¿™æ—¶å€™æ€ä¹ˆåŠå‘¢ï¼Ÿ Route::get(/, function () &#123; \\View::addExtension(html, php); return view()-&gt;file(index.html);//æ³¨æ„æ­¤å¤„è·¯å¾„æ˜¯public &#125;); å°±è¿™æ ·åŠ è½½å°±ok äº†ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"}]},{"title":"ç¼“å­˜ç©¿é€ä¸å¸ƒéš†è¿‡æ»¤å™¨","slug":"ä»ç¼“å­˜ç©¿é€èŠåˆ°å¸ƒéš†è¿‡æ»¤å™¨","date":"2019-05-21T07:59:02.000Z","updated":"2022-03-19T14:35:21.851Z","comments":true,"path":"2019/05/21/188/","link":"","permalink":"https://github.13sai.com/2019/05/21/188/","excerpt":"","text":"ç¼“å­˜ç°åœ¨åœ¨webé¢†åŸŸåº”ç”¨å¹¿æ³›ï¼Œç›¸ä¿¡å¤§éƒ¨åˆ†å¼€å‘äººå‘˜éƒ½ä¼šç”¨åˆ°ï¼Œç„¶è€Œä½ é‡è§è¿‡ç¼“å­˜ç©¿é€å—ï¼Ÿ ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€ï¼Ÿ ç¼“å­˜ç©¿é€æ˜¯æŒ‡æŸ¥è¯¢ä¸€ä¸ªæ ¹æœ¬ä¸å­˜åœ¨çš„æ•°æ®ï¼Œç¼“å­˜å±‚å’Œå­˜å‚¨å±‚éƒ½ä¸ä¼šå‘½ä¸­ï¼Œä½†æ˜¯å‡ºäºå®¹é”™çš„è€ƒè™‘ï¼Œå¦‚æœä»å­˜å‚¨å±‚æŸ¥ä¸åˆ°æ•°æ®åˆ™ä¸å†™å…¥ç¼“å­˜å±‚ã€‚ç®€å•è¯´ï¼Œå°±æŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„keyï¼Œå› ä¸ºæ²¡æœ‰ç¼“å­˜ï¼Œå°±ä¼šå»æ•°æ®åº“æŸ¥è¯¢ï¼Œä»è€Œè¾¾åˆ°ç©¿é€ç¼“å­˜ã€‚å¢å¤§æ•°æ®åº“å‹åŠ›çš„é™©æ¶ç›®çš„ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œä¸æ˜¯æ¶æ„æ“ä½œï¼Œæ­£å¸¸æ¥è¯´ï¼Œä¸ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œç„¶è€Œï¼Œæ€•çš„å°±æ˜¯ä¸€äº›é™©æ¶ç”¨å¿ƒçš„æ”»å‡»è€…ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•æœ‰æ•ˆå¤„ç†è¿™ç§é—®é¢˜å‘¢ï¼Ÿ ç®€å•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæœ‰æ•ˆçš„keyé›†åˆèµ·æ¥ï¼ŒæŸ¥è¯¢ä¹‹å‰æˆ‘ä»¬å…ˆåˆ¤æ–­ä¸€ä¸‹æŸ¥è¯¢çš„keyæ˜¯å¦åœ¨é›†åˆä¸­ï¼Œå¦‚æœä¸åœ¨ï¼Œç›´æ¥æ‰“å›å»ï¼Œè®©ä½ è°ƒçš®ã€‚è¿™ä¸ªé—®é¢˜ä¸å°±è§£å†³äº†å—ï¼Ÿ ä½†æ˜¯ï¼Œå¦‚æœçœŸçš„å…ˆæŠŠæ‰€æœ‰keyç»„æˆé›†åˆï¼Œé‚£è¿™ä¸ªå­˜å‚¨å ç”¨çš„å†…å­˜å¤ªå¤§äº†ï¼Œå½“æœ‰1äº¿ä¸ªkeyï¼Œé‚£å­˜å‚¨ç©ºé—´ä¹Ÿæ˜¯ç›¸å½“å¯è§‚çš„ï¼Œæœ‰ç‚¹å¤ªè¿‡æµªè´¹äº†ã€‚ ä¸ºäº†ä¸æµªè´¹ï¼Œæˆ‘è·Ÿä½ è¯´ï¼Œæœ‰ä¸€ä¸ªå°ç©æ„å«â€œå¸ƒéš†è¿‡æ»¤å™¨â€ï¼Œå®ƒèƒ½å¸®ä½ èŠ‚çœç©ºé—´ï¼ŒèŠ‚çœé’±ã€‚ å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰æ˜¯1970å¹´ç”±å¸ƒéš†æå‡ºçš„ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡å’Œä¸€ç³»åˆ—éšæœºæ˜ å°„å‡½æ•°ã€‚å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚æŒ‰ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰çš„keyé€šè¿‡ç‰¹å®šçš„ç®—æ³•ï¼Œå­˜å‚¨åˆ°è¿™ç§äºŒè¿›åˆ¶å‘é‡ä¸­ï¼Œæˆ‘ä»¬æ¥çœ‹ç½‘ä¸Šçš„ä¸€å¼ å›¾ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‰ä¸ªå“ˆå¸Œç®—æ³•å°†wå­˜å‚¨åˆ°äºŒè¿›åˆ¶å‘é‡ï¼Œå½“æŸ¥è¯¢wæ˜¯å¦å­˜åœ¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å†é€šè¿‡è¿™ä¸‰ä¸ªç®—æ³•ï¼Œå¦‚æœç®—æ³•ç®—å‡ºæ¥æ‰€åœ¨çš„ä½ç½®å‡ä¸º1ï¼Œåˆ™è¡¨ç¤ºwå¯èƒ½å­˜åœ¨ï¼ˆæ³¨æ„æ˜¯å¯èƒ½å­˜åœ¨ï¼‰ï¼Œå¦åˆ™ä¸€å®šä¸å­˜åœ¨ã€‚ï¼ˆè¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œæˆ‘å°±ä¸åšè¯´æ˜äº†ï¼‰ è¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬æ¥å°è¯•ä¸‹ä»£ç ã€‚ &lt;?php /** * Author: sai * Date: 2019/5/17 * Time: 14:10 * ä»£ç æ¥è‡ªç½‘ç»œï¼Œæœ‰æ”¹åŠ¨ */ class BloomFilterHash &#123; /** * ç”±Justin Sobelç¼–å†™çš„æŒ‰ä½æ•£åˆ—å‡½æ•° */ public function JSHash($string, $len = null) &#123; $hash = 1315423911; $len || $len = strlen($string); for ($i=0; $i&lt;$len; $i++) &#123; $hash ^= (($hash &lt;&lt; 5) + ord($string[$i]) + ($hash &gt;&gt; 2)); &#125; // var_dump(($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF);die; return ($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF; &#125; /** * è¯¥å“ˆå¸Œç®—æ³•åŸºäºATï¼†Tè´å°”å®éªŒå®¤çš„Peter J. Weinbergerçš„å·¥ä½œã€‚ * Aho Sethiå’ŒUlmanç¼–å†™çš„â€œç¼–è¯‘å™¨ï¼ˆåŸç†ï¼ŒæŠ€æœ¯å’Œå·¥å…·ï¼‰â€ä¸€ä¹¦å»ºè®®ä½¿ç”¨é‡‡ç”¨æ­¤ç‰¹å®šç®—æ³•ä¸­çš„æ•£åˆ—æ–¹æ³•çš„æ•£åˆ—å‡½æ•°ã€‚ */ public function PJWHash($string, $len = null) &#123; $bitsInUnsignedInt = 4 * 8; //ï¼ˆunsigned intï¼‰ï¼ˆsizeofï¼ˆunsigned intï¼‰* 8ï¼‰; $threeQuarters = ($bitsInUnsignedInt * 3) / 4; $oneEighth = $bitsInUnsignedInt / 8; $highBits = 0xFFFFFFFF &lt;&lt; (int) ($bitsInUnsignedInt - $oneEighth); $hash = 0; $test = 0; $len || $len = strlen($string); for($i=0; $i&lt;$len; $i++) &#123; $hash = ($hash &lt;&lt; (int) ($oneEighth)) + ord($string[$i]); &#125; $test = $hash &amp; $highBits; if ($test != 0) &#123; $hash = (($hash ^ ($test &gt;&gt; (int)($threeQuarters))) &amp; (~$highBits)); &#125; // var_dump(($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF);die; return ($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF; &#125; /** * ç±»ä¼¼äºPJW HashåŠŸèƒ½ï¼Œä½†é’ˆå¯¹32ä½å¤„ç†å™¨è¿›è¡Œäº†è°ƒæ•´ã€‚å®ƒæ˜¯åŸºäºUNIXçš„ç³»ç»Ÿä¸Šçš„widleyä½¿ç”¨å“ˆå¸Œå‡½æ•°ã€‚ */ public function ELFHash($string, $len = null) &#123; $hash = 0; $len || $len = strlen($string); for ($i=0; $i&lt;$len; $i++) &#123; $hash = ($hash &lt;&lt; 4) + ord($string[$i]); $x = $hash &amp; 0xF0000000; if ($x != 0) &#123; $hash ^= ($x &gt;&gt; 24); &#125; $hash &amp;= ~$x; &#125; // var_dump(($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF);die; return ($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF; &#125; /** * è¿™ä¸ªå“ˆå¸Œå‡½æ•°æ¥è‡ªBrian Kernighanå’ŒDennis Ritchieçš„ä¹¦â€œThe C Programming Languageâ€ã€‚ * å®ƒæ˜¯ä¸€ä¸ªç®€å•çš„å“ˆå¸Œå‡½æ•°ï¼Œä½¿ç”¨ä¸€ç»„å¥‡æ€ªçš„å¯èƒ½ç§å­ï¼Œå®ƒä»¬éƒ½æ„æˆäº†31 .... 31 ... 31ç­‰æ¨¡å¼ï¼Œå®ƒä¼¼ä¹ä¸DJBå“ˆå¸Œå‡½æ•°éå¸¸ç›¸ä¼¼ã€‚ */ public function BKDRHash($string, $len = null) &#123; $seed = 131; # 31 131 1313 13131 131313 etc.. $hash = 0; $len || $len = strlen($string); for ($i=0; $i&lt;$len; $i++) &#123; $hash = (int) (($hash * $seed) + ord($string[$i])); &#125; // var_dump(($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF);die; return ($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF; &#125; /** * è¿™æ˜¯åœ¨å¼€æºSDBMé¡¹ç›®ä¸­ä½¿ç”¨çš„é¦–é€‰ç®—æ³•ã€‚ * å“ˆå¸Œå‡½æ•°ä¼¼ä¹å¯¹è®¸å¤šä¸åŒçš„æ•°æ®é›†å…·æœ‰è‰¯å¥½çš„æ€»ä½“åˆ†å¸ƒã€‚å®ƒä¼¼ä¹é€‚ç”¨äºæ•°æ®é›†ä¸­å…ƒç´ çš„MSBå­˜åœ¨é«˜å·®å¼‚çš„æƒ…å†µã€‚ */ public function SDBMHash($string, $len = null) &#123; $hash = 0; $len || $len = strlen($string); for ($i=0; $i&lt;$len; $i++) &#123; $hash = (int) (ord($string[$i]) + ($hash &lt;&lt; 6) + ($hash &lt;&lt; 16) - $hash); &#125; // var_dump(($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF);die; return ($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF; &#125; /** * ç”±Daniel J. Bernsteinæ•™æˆåˆ¶ä½œçš„ç®—æ³•ï¼Œé¦–å…ˆåœ¨usenetæ–°é—»ç»„comp.lang.cä¸Šå‘ä¸–ç•Œå±•ç¤ºã€‚ * å®ƒæ˜¯æœ‰å²ä»¥æ¥å‘å¸ƒçš„æœ€æœ‰æ•ˆçš„å“ˆå¸Œå‡½æ•°ä¹‹ä¸€ã€‚ */ public function DJBHash($string, $len = null) &#123; $hash = 5381; $len || $len = strlen($string); for ($i=0; $i&lt;$len; $i++) &#123; $hash = (int) (($hash &lt;&lt; 5) + $hash) + ord($string[$i]); &#125; var_dump(($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF);die; return ($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF; &#125; /** * Donald E. Knuthåœ¨â€œè®¡ç®—æœºç¼–ç¨‹è‰ºæœ¯ç¬¬3å·â€ä¸­æå‡ºçš„ç®—æ³•ï¼Œä¸»é¢˜æ˜¯æ’åºå’Œæœç´¢ç¬¬6.4ç« ã€‚ */ public function DEKHash($string, $len = null) &#123; $len || $len = strlen($string); $hash = $len; for ($i=0; $i&lt;$len; $i++) &#123; $hash = (int) (($hash &lt;&lt; 5) ^ ($hash &gt;&gt; 27)) ^ ord($string[$i]); &#125; // var_dump((int)($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF);die; return ($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF; &#125; /** * å‚è€ƒ http://www.isthe.com/chongo/tech/comp/fnv/ */ public function FNVHash($string, $len = null) &#123; $prime = 16777619; //32ä½çš„prime 2^24 + 2^8 + 0x93 = 16777619 $hash = 2166136261; //32ä½çš„offset $len || $len = strlen($string); for ($i=0; $i&lt;$len; $i++) &#123; $hash = (int) ($hash * $prime) % 0xFFFFFFFF; $hash ^= ord($string[$i]); &#125; // var_dump(($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF);die; return ($hash % 0xFFFFFFFF) &amp; 0xFFFFFFFF; &#125; &#125; /** * ä½¿ç”¨rediså®ç°çš„å¸ƒéš†è¿‡æ»¤å™¨ */ abstract class BloomFilterRedis &#123; /** * éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•æ¥å®šä¹‰bucketçš„åå­— */ protected $bucket; protected $hashFunction; public function __construct() &#123; if (!$this-&gt;bucket || !$this-&gt;hashFunction) &#123; throw new Exception(&quot;éœ€è¦å®šä¹‰bucketå’ŒhashFunction&quot;, 1); &#125; $this-&gt;Hash = new BloomFilterHash; $this-&gt;Redis = self::getRedis(); //å‡è®¾è¿™é‡Œä½ å·²ç»è¿æ¥å¥½äº† &#125; public static function getRedis() &#123; $redis = new Redis(); $redis-&gt;connect(127.0.0.1, 6379); // $redis-&gt;auth(13sai666.); // var_dump($redis-&gt;info(SERVER));die; $redis-&gt;select(7); return $redis; &#125; /** * æ·»åŠ åˆ°é›†åˆä¸­ */ public function add($string) &#123; foreach ($this-&gt;hashFunction as $function) &#123; $hash = $this-&gt;Hash-&gt;$function($string); $this-&gt;Redis-&gt;setBit($this-&gt;bucket, $hash, 1); &#125; return true; &#125; /** * æŸ¥è¯¢æ˜¯å¦å­˜åœ¨, å­˜åœ¨çš„ä¸€å®šä¼šå­˜åœ¨, ä¸å­˜åœ¨æœ‰ä¸€å®šå‡ ç‡ä¼šè¯¯åˆ¤ */ public function exists($string) &#123; $pipe = $this-&gt;Redis-&gt;multi(); $len = strlen($string); foreach ($this-&gt;hashFunction as $function) &#123; $hash = $this-&gt;Hash-&gt;$function($string, $len); $pipe = $pipe-&gt;getBit($this-&gt;bucket, $hash); &#125; $res = $pipe-&gt;exec(); // var_dump($res); foreach ($res as $bit) &#123; if ($bit == 0) &#123; return false; &#125; &#125; return true; &#125; &#125; /** * é‡å¤å†…å®¹è¿‡æ»¤å™¨ * è¯¥å¸ƒéš†è¿‡æ»¤å™¨æ€»ä½æ•°ä¸º2^32ä½, åˆ¤æ–­æ¡æ•°ä¸º2^30æ¡. hashå‡½æ•°æœ€ä¼˜ä¸º3ä¸ª.(èƒ½å¤Ÿå®¹å¿æœ€å¤šçš„hashå‡½æ•°ä¸ªæ•°) * * æ³¨æ„, åœ¨å­˜å‚¨çš„æ•°æ®é‡åˆ°2^30æ¡æ—¶å€™, è¯¯åˆ¤ç‡ä¼šæ€¥å‰§å¢åŠ , å› æ­¤éœ€è¦å®šæ—¶åˆ¤æ–­è¿‡æ»¤å™¨ä¸­çš„ä½ä¸º1çš„çš„æ•°é‡æ˜¯å¦è¶…è¿‡50%, è¶…è¿‡åˆ™éœ€è¦æ¸…ç©º. */ class FilteRepeatedComments extends BloomFilterRedis &#123; /** * è¡¨ç¤ºåˆ¤æ–­é‡å¤å†…å®¹çš„è¿‡æ»¤å™¨ * @var string */ protected $bucket = bulong; protected $hashFunction = [FNVHash, JSHash, ELFHash]; &#125; å¯ä»¥è°ƒç”¨æµ‹è¯•ä¸‹ï¼Œ var_dump((new FilteRepeatedComments())-&gt;add(abc)); //true var_dump((new FilteRepeatedComments())-&gt;add(bcd));//true var_dump((new FilteRepeatedComments())-&gt;add(dfg));//true var_dump((new FilteRepeatedComments())-&gt;exists(dfg));//true var_dump((new FilteRepeatedComments())-&gt;exists(dgg));//false ç®€å•çš„æµ‹è¯•é€šè¿‡ï¼ å½“ç„¶ï¼Œåº”ç”¨æ—¶éœ€è¦è¿›è¡Œæ›´å¤šçš„æµ‹è¯•ã€‚ é‚£ä¹ˆè¿™ä¸ªå«â€œå¸ƒéš†è¿‡æ»¤å™¨â€çš„ä¸œä¸œçœŸæœ‰é‚£ä¹ˆå¥½ç”¨ï¼Ÿ æˆ‘ç›¸ä¿¡ï¼Œä½ åº”è¯¥å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™æ˜¯æœ‰è¯¯åˆ¤ç‡çš„ï¼Œå¦å¤–åˆ é™¤ä¹Ÿæ˜¯å›°éš¾çš„ã€‚ å…·ä½“è¯¯åˆ¤æ¨å¯¼è¿‡ç¨‹ï¼Œå¯ä»¥å‚è€ƒï¼š å¸ƒéš†è¿‡æ»¤å™¨(bloom filter)ä»‹ç»ä»¥åŠphpå’Œrediså®ç°å¸ƒéš†è¿‡æ»¤å™¨å®ç°æ–¹æ³• å¸ƒéš†è¿‡æ»¤å™¨ç®€ä»‹ åº”ç”¨åœºæ™¯ï¼š åƒåœ¾é‚®ä»¶è¿‡æ»¤ çˆ¬è™«çš„urlè¿‡æ»¤ é˜²æ­¢ç¼“å­˜å‡»ç©¿ å¥½äº†ï¼Œå°±ä»‹ç»åˆ°è¿™é‡Œå•¦ï¼","categories":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/categories/redis/"}],"tags":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/tags/redis/"}]},{"title":"ç¬¬ä¸€æ¬¡è¾“å…¥éªŒè¯ç æ€»æ˜¯å¤±è´¥","slug":"ç¬¬ä¸€æ¬¡è¾“å…¥éªŒè¯ç æ€»æ˜¯å¤±è´¥","date":"2019-04-30T09:02:53.000Z","updated":"2022-05-06T08:55:03.559Z","comments":true,"path":"2019/04/30/187/","link":"","permalink":"https://github.13sai.com/2019/04/30/187/","excerpt":"","text":"ä¸Šå‘¨ç½‘ç«™æ”¹ç‰ˆæ—¶ï¼Œè¡¨å•æäº¤é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è¾“å…¥å›¾ç‰‡éªŒè¯ç ï¼Œç¬¬ä¸€æ¬¡æ€»æ˜¯å¤±è´¥ï¼Œå³ä¾¿è¾“å…¥æ— è¯¯ï¼Œç…§æ ·å¤±è´¥ï¼Œç¬¬äºŒæ¬¡å°±èƒ½æ­£å¸¸éªŒè¯äº†ã€‚ åˆ†æåŸå› ï¼š sessionä¸åŒæ­¥ æ¨¡æ¿æ¸²æŸ“çš„é—®é¢˜ éªŒè¯ç å›¾ç‰‡ç”Ÿæˆé—®é¢˜ ç¬¬ä¸€ä¸ªï¼Œå¦‚æœsessionä¸åŒæ­¥ï¼ŒæŒ‰ç†è¯´ï¼Œç‚¹å‡»åˆ·æ–°ååº”è¯¥ä¹Ÿä¼šå¤±è´¥ã€‚ç¬¬äºŒä¸ªï¼ŒåŸæ¥çš„æœªå‡ºç°è¿™ä¸ªé—®é¢˜ï¼ŒæŒ‰ç†è¯´ä¹Ÿä¸ä¼šæ˜¯è¿™ä¸ªåŸå› ã€‚ç¬¬ä¸‰ä¸ªï¼Œä¿®æ”¹ä¸‹jsä»£ç ï¼Œå¾…é¡µé¢æ¸²æŸ“å®Œæˆåå†åŠ è½½å›¾ç‰‡ï¼Œè¯•éªŒæ— æ•ˆã€‚ æ‰“å¼€è°ƒè¯•å™¨ï¼Œå‘ç°æœ‰ä¸¤å¼ å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œæ˜¯è·¯å¾„é—®é¢˜ï¼Œä¿®æ”¹åæäº¤æµ‹è¯•ï¼Œå‘ç°éªŒè¯ç é—®é¢˜æ²¡äº†ã€‚ æ²¡äº†ï¼Ÿï¼Ÿï¼Ÿwhatï¼Ÿï¼Ÿï¼Ÿwhyï¼Ÿï¼Ÿï¼Ÿ","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/tags/web/"}]},{"title":"Linuxçš„topå‘½ä»¤è¯¦è§£","slug":"Linuxçš„topå‘½ä»¤è¯¦è§£","date":"2019-04-26T02:57:12.000Z","updated":"2022-03-19T14:35:21.609Z","comments":true,"path":"2019/04/26/186/","link":"","permalink":"https://github.13sai.com/2019/04/26/186/","excerpt":"","text":"topå‘½ä»¤æ˜¯Linuxä¸‹å¸¸ç”¨çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œèƒ½å¤Ÿå®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶å†µï¼Œå¸¸ç”¨äºæœåŠ¡ç«¯æ€§èƒ½åˆ†æã€‚ ç»Ÿè®¡ä¿¡æ¯åŒºå‰äº”è¡Œæ˜¯ç³»ç»Ÿæ•´ä½“çš„ç»Ÿè®¡ä¿¡æ¯ã€‚å…·ä½“å¦‚ä¸‹ï¼š ç¬¬ä¸€è¡ŒæœåŠ¡å™¨è¿è¡Œä¿¡æ¯ï¼š 09:46:41 å½“å‰æ—¶é—´ up 71daysï¼Œ16:51 ç³»ç»Ÿè¿è¡Œæ—¶é—´ï¼Œæ ¼å¼ä¸ºå¤©ï¼Œæ—¶:åˆ† 2 users å½“å‰ç™»å½•ç”¨æˆ·æ•° load average: 0.00, 0.00, 0.00 ç³»ç»Ÿè´Ÿè½½ï¼Œå³ä»»åŠ¡é˜Ÿåˆ—çš„å¹³å‡é•¿åº¦ã€‚ä¸‰ä¸ªæ•°å€¼åˆ†åˆ«ä¸º 1åˆ†é’Ÿã€5åˆ†é’Ÿã€15åˆ†é’Ÿå‰åˆ°ç°åœ¨çš„å¹³å‡å€¼ã€‚ ç¬¬äºŒè¡Œä¸ºè¿›ç¨‹ä¿¡æ¯Tasks: total è¿›ç¨‹æ€»æ•° running æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ•° sleeping ç¡çœ çš„è¿›ç¨‹æ•° stopped åœæ­¢çš„è¿›ç¨‹æ•° zombie åƒµå°¸è¿›ç¨‹æ•° ç¬¬ä¸‰è¡ŒCPUä¿¡æ¯Cpu(s): 0.5% us ç”¨æˆ·ç©ºé—´å ç”¨CPUç™¾åˆ†æ¯” 0.3% sy å†…æ ¸ç©ºé—´å ç”¨CPUç™¾åˆ†æ¯” 0.0% ni ç”¨æˆ·è¿›ç¨‹ç©ºé—´å†…æ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨CPUç™¾åˆ†æ¯” 99.0% id ç©ºé—²CPUç™¾åˆ†æ¯” 0.0% wa ç­‰å¾…è¾“å…¥è¾“å‡ºçš„CPUæ—¶é—´ç™¾åˆ†æ¯” 0.2%hiï¼šç¡¬ä»¶CPUä¸­æ–­å ç”¨ç™¾åˆ†æ¯” 0.0%siï¼šè½¯ä¸­æ–­å ç”¨ç™¾åˆ†æ¯” 0.0%stï¼šè™šæ‹Ÿæœºå ç”¨ç™¾åˆ†æ¯” ç¬¬å››è¡ŒMemå†…å­˜ä¿¡æ¯: 8189652k total ç‰©ç†å†…å­˜æ€»é‡ 7885740k used ä½¿ç”¨çš„ç‰©ç†å†…å­˜æ€»é‡ 303912k free ç©ºé—²å†…å­˜æ€»é‡ 566272k buffers ç”¨ä½œå†…æ ¸ç¼“å­˜çš„å†…å­˜é‡ ç¬¬äº”è¡Œswapäº¤æ¢åˆ†åŒºä¿¡æ¯: 4194300k total äº¤æ¢åŒºæ€»é‡ 15544k used ä½¿ç”¨çš„äº¤æ¢åŒºæ€»é‡ 4178756k free ç©ºé—²äº¤æ¢åŒºæ€»é‡ 1318852k cached ç¼“å­˜çš„äº¤æ¢åŒºæ€»é‡ï¼Œå³å¯ç”¨äº¤æ¢åŒºå†…å­˜ å½“ç„¶ï¼Œä¹Ÿæ¨èä½¿ç”¨å…¶ä»–è¿è¡Œåˆ†æå¯è§†åŒ–å·¥å…·ï¼Œå¦‚htopï¼ŒåŠŸèƒ½ç›¸æ¯”topæ›´ä¸ºå¼ºå¤§ã€‚","categories":[{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/tags/Linux/"}]},{"title":"é¢è¯•æŠ€æœ¯é—®é¢˜æ±‡æ€»","slug":"é¢è¯•æŠ€æœ¯é—®é¢˜æ±‡æ€»","date":"2019-04-16T08:56:29.000Z","updated":"2022-03-19T14:35:21.958Z","comments":true,"path":"2019/04/16/185/","link":"","permalink":"https://github.13sai.com/2019/04/16/185/","excerpt":"","text":"Linux rpmå’Œyumçš„åŒºåˆ« Linuxå‘½ä»¤å¤§å…¨ redis redisæŒä¹…åŒ– redisæ•°æ®ç±»å‹è¯¦è§£ mysql mysqlæ‰§è¡Œè¿‡ç¨‹ mysqlå­˜å‚¨å¼•æ“ nginx nginxå¥åº·ç›‘æµ‹ PHP é¢å‘å¯¹è±¡ this,selfå’Œparent more å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ¡†æ¶ï¼Ÿ ä½ ç”¨è¿‡çš„æ¡†æ¶å¯¹æ¯”çœ‹çœ‹ä¼˜ç¼ºç‚¹ï¼Ÿ mysqlè¿æ¥æ± æœ‰äº†è§£å—ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ php-fpmé…ç½®pmä¸ºstaticå’Œdynamicçš„åŒºåˆ«ï¼Ÿ è¯´è¯´ä»£ç é‡æ„çš„æ€è·¯ï¼Ÿ å°è±¡æ¯”è¾ƒæ·±åˆ»çš„é¡¹ç›®æˆ–è€…æŠ€æœ¯ç‚¹ï¼Ÿ æœ€è¿‘åœ¨çœ‹çš„æŠ€æœ¯ä¹¦ç±ï¼Ÿ æš‚æ—¶æƒ³åˆ°çš„å°±è¿™äº›ï¼Œåç»­ä¼šè¡¥å……æ€è·¯ç­‰ã€‚","categories":[{"name":"life","slug":"life","permalink":"https://github.13sai.com/categories/life/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://github.13sai.com/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"nginxé…ç½®æ ¹æ®urlæŒ‡å‘ä¸åŒçš„ç›®å½•","slug":"Nginxé…ç½®æ ¹æ®urlæŒ‡å‘ä¸åŒçš„ç›®å½•","date":"2019-04-16T02:07:51.000Z","updated":"2022-03-20T03:51:54.742Z","comments":true,"path":"2019/04/16/Nginx7/","link":"","permalink":"https://github.13sai.com/2019/04/16/Nginx7/","excerpt":"","text":"å‰å‡ æ—¥ï¼ŒæŠŠè€é¡¹ç›®åšå‰åç«¯åˆ†ç¦»çš„æ—¶å€™ï¼Œå› ä¸ºåå°è¿˜æ˜¯ä¿ç•™ï¼Œå‰å°åšæˆå‰åç«¯åˆ†ç¦»ï¼Œé‡åˆ°çš„ä¸€ä¸ªéœ€æ±‚ã€‚ è€é¡¹ç›®phpç‰ˆæœ¬5.6ï¼Œæ–°æ¥å£è€ƒè™‘ä½¿ç”¨php7.0ï¼Œäºæ˜¯è€ƒè™‘æ ¹æ®urlåšnginxé…ç½®ã€‚ æ€è·¯ä¸€ï¼šæ ¹æ®urlåŒºåˆ†phpç‰ˆæœ¬ï¼Œå†æ ¹æ®ç‰ˆæœ¬æŒ‡å‘å¯¹åº”çš„rootç›®å½•ã€‚ä¸»è¦é…ç½®å¦‚ä¸‹ï¼š server &#123; listen 80; server_name old.com; root /data/www/old; location / &#123; index index.html index.htm index.php; try_files $uri $uri/ /index.php?$query_string; &#125; location /api/ &#123; root /data/www/new; index index.html index.htm index.php; try_files $uri $uri/ /index.php?$query_string&amp;php=7; &#125; location ~ \\.php$ &#123; # 9000ç«¯å£å¯¹åº”php-fpm5.6 , 9001ç«¯å£å¯¹åº”php-fpm7.0 fastcgi_pass 127.0.0.1:9000; if ($args ~* &quot;php=7&quot;)&#123; root /data/www/new; fastcgi_pass 127.0.0.1:9001; &#125; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; &#125; ... &#125; è¯•éªŒæˆåŠŸï¼Œåªæ˜¯æ€»æ„Ÿè§‰åˆ«æ‰­ï¼Œå› ä¸ºåœ¨query_stringåé¢åŠ å…¥php=7ä¸é‚£ä¹ˆä¼˜é›…ï¼Œå¯¹å§ï¼Ÿè€Œä¸”å¦‚æœæœ‰äººä¹ æƒ¯è·å–æ‰€æœ‰çš„query_stringè€Œä¸åšå¤„ç†ï¼Œå¾ˆå®¹æ˜“å¼•èµ·é—®é¢˜ã€‚ æ€è·¯äºŒï¼šæ ¹æ®urlè½¬å‘åˆ°å¦ä¸€ä¸ªç«¯å£ï¼Œå¦ä¸€ä¸ªserverç›‘å¬æ­¤ç«¯å£ã€‚ä¸»è¦é…ç½®å¦‚ä¸‹ï¼š server &#123; listen 80; server_name old.com; root /data/www/old; location / &#123; index index.html index.htm index.php; try_files $uri $uri/ /index.php?$query_string; &#125; location /api/ &#123; proxy_pass http://127.0.0.1:8009; &#125; location ~ \\.php$ &#123; # 9000ç«¯å£å¯¹åº”php-fpm5.6 fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; &#125; ... &#125; server &#123; listen 8080; root /data/www/new; location / &#123; index index.html index.htm index.php; try_files $uri $uri/ /index.php?$query_string; &#125; location ~ \\.php$ &#123; # 9001ç«¯å£å¯¹åº”php-fpm7.0 fastcgi_pass 127.0.0.1:9001; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; &#125; ... &#125; ç›¸æ¯”ç¬¬ä¸€ä¸ªè¿™ä¸ªåªä¼šå¤šå ç”¨ä¸ªç«¯å£ï¼Œä½†ä¼˜é›…å¤šäº†ï¼","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"windowsä¸‹çš„elasticsearchå°è¯•","slug":"windowsä¸‹çš„elasticsearchå°è¯•","date":"2019-04-10T06:35:49.000Z","updated":"2022-03-19T14:35:21.831Z","comments":true,"path":"2019/04/10/183/","link":"","permalink":"https://github.13sai.com/2019/04/10/183/","excerpt":"","text":"ç¯å¢ƒï¼šwindows7 64ä½ ElasticSearchï¼ˆåé¢ç®€ç§°esï¼‰åŸºäºjavaï¼Œæ‰€ä»¥åŠ¡å¿…å…ˆå®‰è£…javaï¼Œjavaå®‰è£…çœç•¥ï¼Œå»ºè®®å®‰è£…æœ€æ–°çš„ç¨³å®šç‰ˆã€‚ å®‰è£…esesä¸‹è½½ è§£å‹åè¿›å…¥ç›®å½•ï¼Œå¯åŠ¨bin/elasticsearch.bat è®¿é—®ï¼š http://localhost:9200/ å¯ä»¥çœ‹åˆ°ä¸€äº›ä¿¡æ¯ï¼Œç‰ˆæœ¬ç­‰ï¼Œå°±è¡¨æ˜å·²ç»å®‰è£…ç—…å¯åŠ¨æˆåŠŸï¼ å®‰è£…HEADæ’ä»¶ git clone git://github.com/mobz/elasticsearch-head.gitcd elasticsearch-headnpm installnpm run start æµè§ˆå™¨æ‰“å¼€ï¼Œ http://localhost:9100/ï¼Œå¯ä»¥çœ‹åˆ°åˆšå¼€å¯åŠ¨çš„ESå®ä¾‹ã€‚ ä¼ªé›†ç¾¤æ‰“å¼€configä¸‹å¾—elasticsearch.yml åŠ å…¥ä»¥ä¸‹é…ç½®ï¼š # è‡ªå®šä¹‰é…ç½® cluster.name: sai_es node.name: es0 node.master: true http.port: 9200 å¤åˆ¶esæ–‡ä»¶å¤¹åˆ°es1,es2,ä¿®æ”¹é…ç½®: es1: # è‡ªå®šä¹‰é…ç½® cluster.name: sai_es node.name: es1 node.master: false http.port: 9201 discovery.zen.ping.unicast.hosts: [&quot;127.0.0.1&quot;] es2: # è‡ªå®šä¹‰é…ç½® cluster.name: sai_es node.name: es2 node.master: false http.port: 9202 discovery.zen.ping.unicast.hosts: [&quot;127.0.0.1&quot;] æ³¨æ„ï¼Œæ­¤æ—¶è¦ä¿è¯es1ï¼Œes2ä¸‹é¢dataç›®å½•ä¸ºç©ºï¼Œå¦åˆ™å¯åŠ¨æ—¶ä¼šå› ä¸ºå†²çªidè¿æ¥ä¸ä¸Šes0ã€‚ ç„¶åå¯åŠ¨es1ï¼Œes2ï¼Œé€šè¿‡headæ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é›†ç¾¤æ­å»ºå®Œæˆï¼sai_esé›†ç¾¤ä¸‹æœ‰3ä¸ªå®ä¾‹ï¼šes0ï¼Œes1ï¼Œes2ã€‚ é›†ç¾¤æ­å»ºæˆåŠŸï¼","categories":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://github.13sai.com/categories/ElasticSearch/"}],"tags":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://github.13sai.com/tags/ElasticSearch/"}]},{"title":"redisé›†ç¾¤é…ç½®","slug":"redisé›†ç¾¤é…ç½®","date":"2019-03-29T01:44:15.000Z","updated":"2022-03-19T14:35:21.803Z","comments":true,"path":"2019/03/29/182/","link":"","permalink":"https://github.13sai.com/2019/03/29/182/","excerpt":"","text":"ç¯å¢ƒï¼šcentos7.5ï¼Œredis5.0.0 ä¸‹è½½å®‰è£…åœ¨åˆé€‚çš„ç›®å½•ï¼Œæˆ‘æ˜¯å®‰è£…åœ¨/usr/local/redis-5.0.0ä¸‹ï¼Œè¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œä¸èµ˜è¿°äº†ã€‚ åŒçº§ä¸‹æ–°å»ºclusterï¼Œæ‹·è´redis.confæ–‡ä»¶è¿›æ¥ï¼Œç”Ÿæˆ4ä¸ªæ–‡ä»¶redis_2001.confã€redis_2002.confã€redis_2003.confã€redis_2004.confï¼Œä¿®æ”¹å¯¹åº”é…ç½®ã€‚ ä¸»è¦é…ç½®å¦‚ä¸‹ # ç«¯å£å· port 2001 # åå°å¯åŠ¨ daemonize yes # å¼€å¯é›†ç¾¤ cluster-enabled yes # é›†ç¾¤èŠ‚ç‚¹é…ç½®æ–‡ä»¶ cluster-config-file nodes-2001.conf # è¿›ç¨‹pidçš„æ–‡ä»¶ä½ç½® pidfile /var/run/redis-2001.pid # æŒä¹…åŒ–é…ç½® # å¼€å¯aof appendonly yes # aofæ–‡ä»¶è·¯å¾„ appendfilename &quot;appendonly-2001.aof&quot; # rdbæ–‡ä»¶è·¯å¾„ dbfilename dump-2001.rdb å¯åŠ¨redisï¼Œ redis-server cluster/redis-2001.conf redis-server cluster/redis-2002.conf redis-server cluster/redis-2003.conf redis-server cluster/redis-2004.conf è¿æ¥æ„å»ºredisé›†ç¾¤ ./redis-trib.rb create â€“replicas 1 127.0.0.1:2001 127.0.0.1:2002 127.0.0.1:2003 127.0.0.1:2004 æŠ›å‡ºè­¦å‘Šï¼š WARNING: redis-trib.rb is not longer available! 5.0ç‰ˆæœ¬æŠ›å¼ƒäº†redis-tribã€‚ æŒ‰ç…§æç¤ºæ‰§è¡Œï¼š redis-cli â€“cluster create 127.0.0.1:2001 127.0.0.1:2002 127.0.0.1:2003 127.0.0.1:2004 â€“cluster-replicas 1 é”™è¯¯è¾“å‡ºå¦‚ä¸‹ï¼š *** ERROR: Invalid configuration for cluster creation. *** Redis Cluster requires at least 3 master nodes. *** This is not possible with 4 nodes and 1 replicas per node. *** At least 6 nodes are required. å› ä¸ºæ˜¯å•æœºæµ‹è¯•è€Œå·²ï¼Œå»æ‰å¤åˆ¶ redis-cli â€“cluster create 127.0.0.1:2001 127.0.0.1:2002 127.0.0.1:2003 127.0.0.1:2004 ç„¶åæœ‰ä¸ªä¿å­˜é…ç½®çš„ç¡®è®¤ï¼Œyesä¹‹åæˆåŠŸï¼ [OK] All nodes agree about slots configuration. &gt;&gt;&gt; Check for open slots... &gt;&gt;&gt; Check slots coverage... [OK] All 16384 slots covered. è¿›å…¥å®¢æˆ·ç«¯ redis-cli -p 2001 æŸ¥çœ‹èŠ‚ç‚¹ cluster nodes 90a734c7716a00060584acb82cb3dd7e437a5459 127.0.0.1:2003@12003 master - 0 1541042930063 3 connected 8192-12287 7ac1fab72c275ba9549a9da71245fdd29a3920a6 127.0.0.1:2002@12002 master - 0 1541042930563 2 connected 4096-8191 490035c372472798a224b6d00c249d8b41508b78 127.0.0.1:2001@12001 myself,master - 0 1541042928000 1 connected 0-4095 9101d285b991c6dcb086cf3da4cd0eae7777ece0 127.0.0.1:2004@12004 master - 0 1541042929563 4 connected 12288-16383 å¯ä»¥çœ‹å‡ºé›†ç¾¤å·²æ­å»ºæˆåŠŸï¼ å¯¹åº”çš„phpå¯ä»¥ä½¿ç”¨predisæ“ä½œredisï¼Œå½“ç„¶\\Redisä¹Ÿè¶³å¤Ÿå¥½ç”¨äº†,up to uã€‚","categories":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/categories/redis/"}],"tags":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/tags/redis/"}]},{"title":"phpå°è¯•rabbitmq","slug":"phpå°è¯•rabbitmq","date":"2019-03-29T01:36:57.000Z","updated":"2022-03-19T14:35:21.786Z","comments":true,"path":"2019/03/29/181/","link":"","permalink":"https://github.13sai.com/2019/03/29/181/","excerpt":"","text":"RabbitMQ is lightweight and easy to deploy on premises and in the cloud. It supports multiple messaging protocols. RabbitMQ can be deployed in distributed and federated configurations to meet high-scale, high-availability requirements. 1. å®‰è£…ï¼šwindowså®‰è£…ååˆ†ç®€å•ï¼Œå°è±¡ä¸­è£…çš„è¿‡ç¨‹å‡ ä¹æ— éšœç¢ï¼Œå¿½ç•¥ã€‚ centos7å®‰è£…è¿‡ç¨‹å¦‚ä¸‹ï¼š ä¾èµ–å®‰è£… yum -y install make gcc gcc-c++ kernel-devel m4 ncurses-devel openssl-devel unixODBC-devel socat å®‰è£…erlangï¼ŒåŠ¡å¿…åœ¨ä¸‹é¢çš„åœ°å€ä¸‹è½½ï¼Œä¹‹å‰åœ¨å®˜ç½‘ä¸‹è½½ï¼Œå®‰è£…æ€»æ˜¯æœ‰é—®é¢˜ï¼Œæµªè´¹äº†å¤§æŠŠæ—¶é—´ã€‚ https://dl.bintray.com/rabbitmq/rpm/erlang/20/el/7/ å®˜ç½‘ä¸‹è½½rabiitmqï¼Œrpmå®‰è£… rpm -ivh (rpmåŒ…) 2. é…ç½®å¯åŠ¨rabbitmq /bin/systemctl start rabbitmq-server.service ç‰‡åˆ»ä¹‹åï¼Œå¯ä»¥æŸ¥çœ‹çŠ¶æ€æ˜¯å¦active bin/systemctl status rabbitmq-server.service cp rabbitmq.config.example /etc/rabbitmq/cd /etc/rabbitmq/mv rabbitmq.config.example rabbitmq.config ä¿®æ”¹æˆä½ æƒ³è¦çš„é…ç½®ï¼Œç„¶åé‡å¯ã€‚ 3. UIå¯åŠ¨ rabbitmq-plugins enable rabbitmq_management ç„¶åæ ¹æ®é…ç½®æ‰“å¼€ç•Œé¢ å®‰å…¨æ€§é—®é¢˜ï¼Œå¯ä»¥ç¦æ­¢å¤–éƒ¨guestè®¿é—®ï¼Œæ–°å»ºè´¦æˆ· rabbitmqctl add_user 13sai 12345678rabbitmqctl set_user_tags 13sai administrator å¹¶ä¿®æ”¹é…ç½®ï¼š {loopback_users, [&lt;&lt;â€guestâ€&gt;&gt;]} é‡å¯rabbitmqæœåŠ¡ã€‚ 4. ç®€å•å®ä¾‹ç”Ÿäº§è€…ï¼š &lt;?php /** * Created by PhpStorm. * User: 13sai * Date: 2018/11/5 * Time: 10:39 */ // é…ç½®ä¿¡æ¯ $config = [ host =&gt; localhost, port =&gt; 5672, login =&gt; sai, password =&gt; 123456, vhost=&gt;/ ]; $exName = changes; //äº¤æ¢æœºå $route = key; //è·¯ç”±key // åˆ›å»ºè¿æ¥å’Œchannel $conn = new AMQPConnection($config); if (!$conn-&gt;connect()) &#123; die(&quot;è¿æ¥å¤±è´¥&quot;); &#125; $channel = new AMQPChannel($conn); //æ¶ˆæ¯å†…å®¹ $message = &quot;æ¶ˆæ¯æµ‹è¯•&quot;; //åˆ›å»ºäº¤æ¢æœº $ex = new AMQPExchange($channel); $ex-&gt;setName($exName); //å‘é€æ¶ˆæ¯ï¼Œæ³¨æ„æŒä¹…åŒ–ä¹Ÿè¦è®¾ç½®[delivery_mode =&gt; AMQP_DURABLE] for($i=0; $i&lt;5; $i++)&#123; echo &quot;Send Message:&quot;.$ex-&gt;publish($i.:.$message, $route, AMQP_DURABLE, [delivery_mode =&gt; AMQP_DURABLE]).&quot; &quot;; &#125; $conn-&gt;disconnect(); æ¶ˆè´¹è€…ï¼š &lt;?php /** * Created by PhpStorm. * User: 13sai * Date: 2018/11/5 * Time: 10:39 */ $config = [ host =&gt; localhost, port =&gt; 5672, login =&gt; sai, password =&gt; 123456, vhost=&gt;/ ]; $exName = changes; //äº¤æ¢æœºå $queueMame = queue1; //é˜Ÿåˆ—å $route = key; //è·¯ç”±key // åˆ›å»ºè¿æ¥å’Œchannel $conn = new AMQPConnection($config); if (!$conn-&gt;connect()) &#123; die(&quot;è¿æ¥å¤±è´¥&quot;); &#125; $channel = new AMQPChannel($conn); // åˆ›å»ºäº¤æ¢æœº $ex = new AMQPExchange($channel); $ex-&gt;setName($exName); $ex-&gt;setType(AMQP_EX_TYPE_DIRECT); //directç±»å‹ $ex-&gt;setFlags(AMQP_DURABLE); //æŒä¹…åŒ–ï¼Œå¾ˆé‡è¦ echo &quot;Exchange Status:&quot;.$ex-&gt;declare().&quot; &quot;; // åˆ›å»ºé˜Ÿåˆ— $queue = new AMQPQueue($channel); $queue-&gt;setName($queueMame); $queue-&gt;setFlags(AMQP_DURABLE); //æŒä¹…åŒ– echo &quot;Message Total:&quot;.$queue-&gt;declare().&quot; &quot;; //ç»‘å®šäº¤æ¢æœºä¸é˜Ÿåˆ—ï¼Œå¹¶æŒ‡å®šè·¯ç”±é”® echo Queue Bind: .$queue-&gt;bind($exName, $route).&quot; &quot;; //é˜»å¡æ¨¡å¼æ¥æ”¶æ¶ˆæ¯ echo &quot;Message: &quot;; while(True)&#123; $queue-&gt;consume(processMessage); &#125; $conn-&gt;disconnect(); /** * æ¶ˆè´¹å›è°ƒå‡½æ•° * å¤„ç†æ¶ˆæ¯ */ function processMessage($envelope, $queue) &#123; $msg = $envelope-&gt;getBody(); echo $msg.&quot; &quot;; //å¤„ç†æ¶ˆæ¯ $queue-&gt;ack($envelope-&gt;getDeliveryTag()); //æ‰‹åŠ¨å‘é€ACKåº”ç­” &#125; èŠ±äº†äº›æ—¶é—´ï¼Œä¸è¿‡å¼„å‡ºæ¥è¿˜æ˜¯æ„Ÿè§‰ä¸é”™çš„ã€‚","categories":[{"name":"MQ","slug":"MQ","permalink":"https://github.13sai.com/categories/MQ/"}],"tags":[{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://github.13sai.com/tags/RabbitMQ/"}]},{"title":"LNMPè®¾ç½®å¼€æœºè‡ªå¯åŠ¨","slug":"LNMPè®¾ç½®å¼€æœºè‡ªå¯åŠ¨","date":"2019-03-29T01:33:25.000Z","updated":"2022-03-19T14:35:21.593Z","comments":true,"path":"2019/03/29/180/","link":"","permalink":"https://github.13sai.com/2019/03/29/180/","excerpt":"","text":"æœ‰æ—¶å€™æœåŠ¡å™¨éœ€è¦é‡å¯ï¼Œä½†é‡å¯å„ç§ç¨‹åºéœ€è¦å¯åŠ¨æ˜¯ä¸ªéº»çƒ¦çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å°è¯•é…ç½®å¼€æœºè‡ªå¯åŠ¨ã€‚ ç¯å¢ƒï¼šcentos 7.5 æˆ‘çš„ç‰ˆæœ¬è·Ÿä½ç‰ˆæœ¬æœ‰å¤šä¸åŒï¼Œä¸èƒ½é€šè¿‡chkconfig addå‘½ä»¤åŠ å…¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥ç›®å½• /lib/systemd/system ä¾æ¬¡æ–°å»º // mysqld.service [Unit] Description=mysql After=network.target [Service] Type=forking ExecStart=/usr/bin/mysql.server ExecReload=/bin/systemctl restart mysqld.service ExecStop=/bin/systemctl stop mysqld.service PrivateTmp=true [Install] WantedBy=multi-user.target ---------- //nginx.service [Unit] Description=nginx After=network.target [Service] Type=forking ExecStart=/usr/bin/nginx ExecReload=/usr/bin/nginx -s reload ExecStop=/usr/bin/nginx -s quit PrivateTmp=true [Install] WantedBy=multi-user.target ---------- // php-fpm.service [Unit] Description=php-fpm After=network.target [Service] Type=forking ExecStart=/usr/bin/php-fpm ExecReload=ps -ef|grep php-fpm|awk -F &#123;print &#125;|xargs kill -USR2 ExecStop=ps -ef|grep php-fpm|awk -F &#123;print &#125;|xargs kill -INT PrivateTmp=true [Install] WantedBy=multi-user.target ---------- // redis.service [Unit] Description=redis After=network.target [Service] Type=forking ExecStart=/usr/bin/redis-server /usr/local/redis-5.0.0/redis.conf ExecStop=/usr/local/redis-5.0.0/redis-cli shutdown PrivateTmp=true [Install] WantedBy=multi-user.target ExecStart,ExecStop,ExecReloadå„æœ‰ä¸åŒï¼Œè‡ªè¡Œä¿®æ”¹ å¹¶ä¸”systemctl enableå¯åŠ¨ã€‚ reboot æµ‹è¯•ä¸€ä¸‹ã€‚ è„šæœ¬è¯´æ˜ ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰éƒ¨åˆ† [unit] :å®šä¹‰ä¸Unitç±»å‹æ— å…³çš„é€šç”¨é€‰é¡¹ï¼›ç”¨äºæä¾›unitçš„æè¿°ä¿¡æ¯ã€ unitè¡Œä¸ºåŠä¾èµ–å…³ç³»ç­‰ [Service]ï¼šä¸ç‰¹å®šç±»å‹ç›¸å…³çš„ä¸“ç”¨é€‰é¡¹ï¼›æ­¤å¤„ä¸ºServiceç±»å‹ [Install]ï¼šå®šä¹‰ç”±â€œ systemctl enableâ€ä»¥åŠ&quot;systemctl disableâ€œå‘½ä»¤åœ¨å®ç°æœåŠ¡å¯ç”¨æˆ–ç¦ç”¨æ—¶ç”¨åˆ°çš„ä¸€äº›é€‰é¡¹ ---------- Serviceå‚æ•° EnvironmentFileï¼šç¯å¢ƒé…ç½®æ–‡ä»¶ ExecStartï¼šæŒ‡æ˜å¯åŠ¨unitè¦è¿è¡Œå‘½ä»¤æˆ–è„šæœ¬çš„ç»å¯¹è·¯å¾„ ExecStartPreï¼š ExecStartå‰è¿è¡Œ ExecStartPostï¼š ExecStartåè¿è¡Œ ExecRsload: é‡å¯å½“å‰æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤ ExecStopPostï¼šåœæ­¢å½“å‰æœåŠ¡ä¹‹åæ‰§è¡Œçš„å‘½ä»¤ ExecStartSecï¼šè‡ªåŠ¨é‡å¯å½“å‰æœåŠ¡é—´éš”çš„ç§’æ•° ExecStopï¼šæŒ‡æ˜åœæ­¢unitè¦è¿è¡Œçš„å‘½ä»¤æˆ–è„šæœ¬ Restartï¼šå½“è®¾å®šRestart=1æ—¶ï¼Œåˆ™å½“æ¬¡daemonæœåŠ¡æ„å¤–ç»ˆæ­¢åï¼Œä¼šå†æ¬¡è‡ªåŠ¨å¯åŠ¨æ­¤æœåŠ¡ã€‚ TimeoutSecï¼šå®šä¹‰ Systemd åœæ­¢å½“å‰æœåŠ¡ä¹‹å‰ç­‰å¾…çš„ç§’æ•°ã€‚ Environmentï¼šæŒ‡å®šç¯å¢ƒå˜é‡ã€‚ ---------- Installå‚æ•°ï¼š Aliasï¼šåˆ«åï¼Œå¯ä½¿ç”¨systemctl command Alias.service RequiredByï¼šè¢«å“ªäº›unitsæ‰€ä¾èµ–ï¼Œå¼ºä¾èµ– WantedByï¼šè¢«å“ªäº›unitsæ‰€ä¾èµ–ï¼Œå¼±ä¾èµ– Alsoï¼šå®‰è£…æœ¬æœåŠ¡çš„æ—¶å€™è¿˜è¦å®‰è£…åˆ«çš„ç›¸å…³æœåŠ¡ æ›´å¤šè¯·çœ‹ï¼šåœ¨linuxä¸‹åˆ›å»ºè‡ªå®šä¹‰æœåŠ¡linuxä¸­çš„unitçš„é…ç½®æ–‡ä»¶","categories":[{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/tags/Linux/"}]},{"title":"åŸºäºmycatå®ç°è¯»å†™åˆ†ç¦»","slug":"åŸºäºmycatå®ç°è¯»å†™åˆ†ç¦»","date":"2019-01-11T17:29:53.000Z","updated":"2022-03-19T14:35:21.898Z","comments":true,"path":"2019/01/12/177/","link":"","permalink":"https://github.13sai.com/2019/01/12/177/","excerpt":"","text":"mysqlä¸­é—´ä»¶ï¼Œåˆ†åº“åˆ†è¡¨ï¼Œè¯»å†™åˆ†ç¦»ã€‚ ç¯å¢ƒï¼š centos7.4 mysql5.7 ä¸‹è½½å®‰è£…ä¸‹è½½åœ°å€ è§£å‹åˆ°ä½ å–œæ¬¢çš„ç›®å½•ã€‚ å¯åŠ¨ ./bin/mycat start tips:å»ºè®®ä¿®æ”¹é…ç½®æ–‡ä»¶æ—¶bakä¸‹åŸé…ç½®æ–‡ä»¶ã€‚ ç§’å¯åŠ¨ï¼Œå°è¯•ä¿®æ”¹é…ç½®(conf/wrapper.conf)ï¼Œä¿å­˜åå‘ç°mycatè¿›ç¨‹æ²¡æœ‰äº†ã€‚ çŒœæµ‹æ˜¯OOM killäº†ï¼ŒæŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼Œè²Œä¼¼æ— mycatå¼‚å¸¸ã€‚ dmesg | tail -20 æŸ¥çœ‹logsç›®å½•ä¸‹æ—¥å¿—ï¼Œåº”è¯¥æ˜¯å†…å­˜ä¸è¶³ã€‚ï¼ˆå¿ƒç–¼ecs1cpu1gçš„é…ç½®ï¼‰ ä¿®æ”¹conf/wrapper.conf # Java Additional Parameters #wrapper.java.additional.1= wrapper.java.additional.1=-DMYCAT_HOME=. wrapper.java.additional.2=-server wrapper.java.additional.3=-XX:MaxPermSize=64M wrapper.java.additional.4=-XX:+AggressiveOpts wrapper.java.additional.5=-XX:MaxDirectMemorySize=256M wrapper.java.additional.6=-Dcom.sun.management.jmxremote wrapper.java.additional.7=-Dcom.sun.management.jmxremote.port=1984 wrapper.java.additional.8=-Dcom.sun.management.jmxremote.authenticate=false wrapper.java.additional.9=-Dcom.sun.management.jmxremote.ssl=false wrapper.java.additional.10=-Xmx512M wrapper.java.additional.11=-Xms512M é‡æ–°å¯åŠ¨ï¼ŒæˆåŠŸï¼Œè¿›ç¨‹ä¹Ÿæ²¡æœ‰è¢«killï¼Œä½†å†…å­˜å·²ç»80%å·¦å³äº†ã€‚ å…³é—­ecsäº‘ç›‘æ§ç¼©å‡å†…å­˜å ç”¨ï¼Œè°ƒä½mysqlå ç”¨å†…å­˜ç¼“å†²åŒºã€‚ å¼€å¯3306,3307ç«¯å£çš„mysqlå®ä¾‹ï¼Œå¢åŠ mycatæ•°æ®åº“ï¼Œå¹¶é…ç½®master-slaveï¼Œè®¾ç½®å¥½æ‰€éœ€è´¦å·å¯†ç æƒé™ã€‚ å…³æ³¨ä¸‹å†…å­˜å ç”¨ï¼Œçº¦85%ï¼Œè¿˜èƒ½æ’‘ä½ã€‚ å…³é—­mycatã€‚ server.xmlä¸»è¦ä¿®æ”¹ï¼Œæ•°æ®åº“ï¼Œè´¦å·å¯†ç ã€‚ &lt;user name=&quot;root&quot;&gt; &lt;property name=&quot;password&quot;&gt;123456&lt;/property&gt; &lt;property name=&quot;schemas&quot;&gt;sai&lt;/property&gt; &lt;/user&gt; saiä¸ºé€»è¾‘åº“ï¼Œå¯è‡ªè¡Œé…ç½®ã€‚ schema.xmlä¸»è¦ä¿®æ”¹ // saiå¯¹åº”server.xmlé…ç½® &lt;schema name=&quot;sai&quot; checkSQLschema=&quot;false&quot; sqlMaxLimit=&quot;100&quot;&gt; &lt;table name=&quot;company&quot; primaryKey=&quot;ID&quot; type=&quot;global&quot; dataNode=&quot;dn1&quot; /&gt; &lt;/schema&gt; // localhost3306å¯¹åº”dataHostçš„nameï¼Œdatabaseæ˜¯çœŸå®çš„æ•°æ®åº“ &lt;dataNode name=&quot;dn1&quot; dataHost=&quot;localhost3306&quot; database=&quot;mycat&quot; /&gt; &lt;dataHost name=&quot;localhost3306&quot; maxCon=&quot;100&quot; minCon=&quot;10&quot; balance=&quot;1&quot; writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;native&quot; switchType=&quot;2&quot; slaveThreshold=&quot;30&quot;&gt; &lt;heartbeat&gt;show slave status&lt;/heartbeat&gt; // è¯»ï¼ˆ3307ï¼‰å†™ï¼ˆ3306ï¼‰å®ä¾‹ &lt;writeHost host=&quot;hostM1&quot; url=&quot;127.0.1:3306&quot; user=&quot;mycat&quot; password=&quot;111111&quot;&gt; &lt;!-- can have multi read hosts --&gt; &lt;readHost host=&quot;hostS2&quot; url=&quot;127.0.1:3307&quot; user=&quot;mycat&quot; password=&quot;111111&quot; /&gt; &lt;/writeHost&gt; &lt;/dataHost&gt; balanceæŒ‡çš„è´Ÿè½½å‡è¡¡ç±»å‹ï¼Œç›®å‰çš„å–å€¼æœ‰4ç§ï¼š 0, ä¸å¼€å¯è¯»å†™åˆ†ç¦»æœºåˆ¶ï¼Œæ‰€æœ‰è¯»æ“ä½œéƒ½å‘é€åˆ°å½“å‰å¯ç”¨çš„writeHostä¸Šã€‚ 1ï¼Œå…¨éƒ¨çš„readHostä¸stand by writeHostå‚ä¸selectè¯­å¥çš„è´Ÿè½½å‡è¡¡ï¼Œç®€å•çš„è¯´ï¼Œå½“åŒä¸»åŒä»æ¨¡å¼(M1-&gt;S1ï¼ŒM2-&gt;S2ï¼Œå¹¶ä¸”M1ä¸ M2äº’ä¸ºä¸»å¤‡)ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼ŒM2,S1,S2éƒ½å‚ä¸selectè¯­å¥çš„è´Ÿè½½å‡è¡¡ã€‚ 2ï¼Œæ‰€æœ‰è¯»æ“ä½œéƒ½éšæœºçš„åœ¨writeHostã€readhostä¸Šåˆ†å‘ã€‚ 3ï¼Œæ‰€æœ‰è¯»è¯·æ±‚éšæœºçš„åˆ†å‘åˆ°wiriterHostå¯¹åº”çš„readhostæ‰§è¡Œï¼ŒwriterHostä¸è´Ÿæ‹…è¯»å‹åŠ› switchTypeæŒ‡çš„æ˜¯åˆ‡æ¢çš„æ¨¡å¼ï¼Œç›®å‰çš„å–å€¼ä¹Ÿæœ‰4ç§ï¼š -1ï¼Œ è¡¨ç¤ºä¸è‡ªåŠ¨åˆ‡æ¢ 1ï¼Œ é»˜è®¤å€¼ï¼Œè¡¨ç¤ºè‡ªåŠ¨åˆ‡æ¢ï¼Œ1.5ç‰ˆæœ¬åä¸¢å¼ƒ 2 ï¼ŒåŸºäºMySQLä¸»ä»åŒæ­¥çš„çŠ¶æ€å†³å®šæ˜¯å¦åˆ‡æ¢,å¿ƒè·³è¯­å¥ä¸º show slave status å¯åŠ¨ã€‚ mysql -h127.0.0.1 -uroot -P8066 -p è¾“å…¥å¯†ç è¿›å…¥ï¼Œåˆ‡æ¢sai é»˜è®¤ç«¯å£8066ï¼Œmysqlæ‰§è¡Œä¸‹è¯­å¥ï¼Œ INSERT INTO company VALUES (1, 13sai); select * from company; mysqlå®ä¾‹å·²ç»å¼€å¯äº†æŸ¥è¯¢æ—¥å¿—ï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼Œè¯»å†™åˆ†ç¦»äº†ã€‚ åæ§½ å‡å¦‚è¡¨å¾ˆå¤šï¼Œé…ç½®ä¸æ˜¯å¾—æ™•æ­» æœ€è¿‘å‘ç°å¾ˆå¤šå¥½ç”¨çš„ä¸­é—´ä»¶åº•å±‚éƒ½æ˜¯javaï¼Œè€ƒè™‘è¦ä¸è¦å…¥å‘ã€‚","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"å¦‚ä½•æ¢å¤è¯¯åˆ çš„æ•°æ®åº“","slug":"å¦‚ä½•æ¢å¤è¯¯åˆ çš„æ•°æ®åº“","date":"2019-01-10T17:43:38.000Z","updated":"2022-03-19T14:35:21.905Z","comments":true,"path":"2019/01/11/176/","link":"","permalink":"https://github.13sai.com/2019/01/11/176/","excerpt":"","text":"å‰æ®µæ—¶é—´ï¼ŒæŸå¼€å‘äººå‘˜è¯¯åˆ äº†ä¸€ä¸ªæ•°æ®åº“ï¼Œå¯¼è‡´æˆ‘ä»¬çš„æœåŠ¡ï¼Œæœ€åæ˜¯æ¢å¤äº†ï¼Œè¿‡ç¨‹æˆ‘å¹¶ä¸æ¸…æ¥šï¼Œä½†å¼•èµ·äº†æˆ‘çš„å…´è¶£ã€‚å› ä¸ºè¯¯æ“ä½œçœŸçš„æ˜¯å¾ˆéš¾é¿å…çš„ï¼Œå¼€å‘äººå‘˜é‚£ä¹ˆå¤šï¼Œä¸€ä¸ªä¸å°å¿ƒï¼Œå°±å¯èƒ½å½±å“äº†å…¶ä»–äººçš„ä½¿ç”¨ï¼Œæ‰€ä»¥æ…é‡æ“ä½œï¼Œæœ€å¥½èƒ½ç¦ç”¨ä¸€äº›æ“ä½œï¼Œæ¯”å¦‚dropï¼ é‚£ä¹ˆå¦‚ä½•æ¥æ¢å¤å‘¢ï¼Ÿ å¦‚æœæœ‰å¤‡ä»½çš„è¯ï¼Œå½“ç„¶å»å¯»æ‰¾æœ€æ–°çš„ï¼Œç„¶åæ¢å¤ï¼Œå¦‚æœä¸åœ¨æ„æ–°å¢çš„æ•°æ®ï¼Œé‚£ä¹ˆè¿™æ ·å°±è¶³å¤Ÿäº†ã€‚ æ¥çœ‹ä¸€ä¸‹å¤‡ä»½ï¼Œ // å¤‡ä»½æŸä¸ªæ•°æ®åº“æŸäº›è¡¨ mysqldump [options] db_name [tbl_name ...] &gt; bak.sql // å¤‡ä»½å¤šä¸ªæ•°æ®åº“ mysqldump [options] --databases db_name ...&gt; bak.sql // å¤‡ä»½æ‰€æœ‰æ•°æ®åº“ mysqldump [options] --all-databases&gt; bak.sql ä¸ªäººå»ºè®®å•ä¸ªå¤‡ä»½ï¼Œå¥½ç‹¬ç«‹æ“ä½œã€‚ äº†è§£æ›´å¤šè¯·çœ‹ï¼šmysqldump æ¢å¤æ“ä½œï¼ˆä»¥å•ä¸ªæ•°æ®åº“ä¸ºä¾‹ï¼‰ mysql -h127.0.0.1 -uroot -p del &lt; bak.sql æ“ä½œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿ é‚£ä¹ˆå¦‚æœæ²¡æœ‰å¤‡ä»½æ€ä¹ˆåŠå‘¢ï¼Ÿ ç¬¬äºŒç§æ“ä½œå‰ææ˜¯å¼€å¯äº†binlogï¼Œé€šè¿‡logæ¢å¤ã€‚ è¯¯åˆ åå¯ä»¥ä¿å­˜ä¸‹binlog mysqlbinlog mysql-bin.000011 &gt; del.log æ‰“å¼€æ–‡ä»¶ï¼Œå»æ‰dropæ“ä½œå¹¶ä¿å­˜ã€‚ mysql -h127.0.0.1 -uroot -p &lt;del.log å½“ç„¶ï¼Œæ¯”è¾ƒå»ºè®®é€šè¿‡dumpå…¨å¤‡ä»½æ“ä½œï¼Œç„¶åæ‰¾å‡ºå¤‡ä»½åˆ°dropçš„posã€‚ é€šè¿‡mysqlbinlog çš„start-positionå’Œstop-positionç”Ÿæˆsqlåæ¢å¤ã€‚è¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚ æœ‰å…´è¶£å¯ä»¥çœ‹çœ‹mysqlbinlog å¥½äº†ï¼Œå°±è¯´åˆ°è¿™é‡Œï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"mysqlé«˜å¯ç”¨æ¢è®¨ï¼ˆè¯»å†™åˆ†ç¦»ï¼‰","slug":"mysqlé«˜å¯ç”¨æ¢è®¨ï¼ˆè¯»å†™åˆ†ç¦»ï¼‰","date":"2018-12-30T15:21:36.000Z","updated":"2022-03-19T14:35:21.772Z","comments":true,"path":"2018/12/30/175/","link":"","permalink":"https://github.13sai.com/2018/12/30/175/","excerpt":"","text":"ä¸Šä¸€ç¯‡æˆ‘ä»¬èŠåˆ°TPåšè¯»å†™åˆ†ç¦»çš„åº•å±‚å®ç°ï¼Œç›¸å¯¹æ¥è¯´ï¼Œå…¶å®æ€è·¯æ˜¯æ¸…æ™°ç®€å•çš„ï¼Œä½†è¿™äº›å…¶å®éƒ½æ˜¯åŸºäºæ•°æ®åº“å·²ç»åšåˆ°äº†ä¸»ä»é…ç½®ã€‚ å¦‚æœä½ ä¸çŸ¥é“ï¼Œå¯ä»¥mysqlä¸»ä»å®æˆ˜ å»ºè®®ç»™ä»åº“å•ç‹¬å¼€ä¸ªè´¦å·åªæˆæƒè¯»çš„æƒé™ï¼Œè€Œä¸æ˜¯è®¾ç½®slaveä¸ºread_onlyï¼ˆæˆ‘é…ç½®äº†ï¼Œbutæ²¡å•¥ç”¨ï¼‰ ä½†æˆ‘ä»¬ç¨å¾®æ·±å…¥æ€è€ƒä¸€ä¸‹ï¼ŒPHPæ¡†æ¶é‡Œæœ‰åšåˆ°é«˜å¯ç”¨å—ï¼ŸåŠ å…¥ä»åº“å…¶ä¸­ä¸€ä¸ªæŒ‚äº†ï¼Œç…§ç€TPçš„æ€è·¯ï¼Œä¾æ—§æœ‰å¯èƒ½å»è¿™ä¸ªä»åº“è¯»å–æ•°æ®ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸èƒ½æ¥å—çš„ã€‚ ä¸€ä¸»ä¸€ä»ç”šè‡³ä¸€ä¸»å¤šä»çš„æ¶æ„æ˜¾ç„¶åªèƒ½æ»¡è¶³è¯»å†™æ€§èƒ½ï¼Œè€Œä¸èƒ½ä¿è¯æœåŠ¡çš„é«˜å¯ç”¨ã€‚æˆ‘ä»¬çŸ¥é“ä»»ä½•ä¸€ä¸ªæœåŠ¡æŒ‚æ‰çš„å¯èƒ½æ€§éƒ½æ˜¯å­˜åœ¨çš„ï¼Œæˆ‘ä»¬è¯´çš„é«˜å¯ç”¨åªèƒ½æ˜¯å°½å¯èƒ½å°çš„é¿å…æ•´ä¸ªæœåŠ¡æŒ‚æ‰çš„å¯èƒ½ã€‚ç”±æ­¤ä½ åº”è¯¥èƒ½æƒ³åˆ°å¤šä¸»å¤šä»ï¼Œè¿™ä¸ªä»…ä»…æ–‡ç« é‡Œçš„é…ç½®æ˜¯å®Œæˆä¸äº†çš„ï¼ŒPHPæ¡†æ¶ä¹Ÿæ˜¯æ£€æµ‹ä¸äº†çš„ã€‚ æˆ‘è§‰å¾—PHPæ¡†æ¶æ¥åšè¯»å†™åˆ†ç¦»æ˜¯ä¸ç§‘å­¦çš„ï¼Œå› ä¸ºå¢åŠ äº†ä»£ç çš„å¤æ‚åº¦ï¼Œæˆ‘è®¤ä¸ºè¿™äº›åº”è¯¥äº¤ç»™æ•°æ®åº“æ¥åšï¼Œæˆ–è€…æ•°æ®åº“ä¸­é—´ä»¶æ¥åšï¼Œå„å¸å…¶èŒå—ã€‚ æˆ‘ä¸çŸ¥é“æ˜¯ä¸æ˜¯å¾ˆå¤šäººä¼šæƒ³åˆ°mysql_proxyï¼Œç„¶è€Œå®˜æ–¹å·²ç»ä¸æ¨èä½¿ç”¨äº†ï¼Œæ¨èä½¿ç”¨mysql_routerï¼Œæœ‰åœ¨è‡ªå·±çš„ECSä¸Šå°è¯•äº†ä¸€ä¸‹ï¼Œé…ç½®ç›¸å¯¹è¿˜æ˜¯ç®€å•çš„ï¼Œæ²¡æµ‹è¯•æ€§èƒ½ï¼Œä½†ç¡®å®å®ç°äº†ä¸€å®šç¨‹åº¦çš„é«˜å¯ç”¨ã€‚ å½“ç„¶ä½ ä¹Ÿå¯ä»¥å»ä½¿ç”¨å˜å½¢è™«ç­‰ä¸­é—´ä»¶ï¼Œä»–ä»¬çš„åŠŸèƒ½ç›¸æ¯”mysql_routeræ›´ä¸ºå¼ºå¤§ã€‚ æ­¤ç¯‡æ²¡æœ‰å¹²è´§ï¼Œåªæ˜¯çº¯æŠ€æœ¯æ¢è®¨ï¼Œæˆ‘ä¸è¿‡æ˜¯åœ¨å—äº¬å—ç«™ï¼Œæ²¡äº‹ç ç å­—ç½¢äº†ï¼","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"sql","slug":"sql","permalink":"https://github.13sai.com/tags/sql/"}]},{"title":"ThinkPHPè¯»å†™åˆ†ç¦»çš„å†…éƒ¨å®ç°","slug":"ThinkPHPè¯»å†™åˆ†ç¦»çš„å†…éƒ¨å®ç°","date":"2018-12-17T07:56:21.000Z","updated":"2022-03-19T14:35:21.655Z","comments":true,"path":"2018/12/17/174/","link":"","permalink":"https://github.13sai.com/2018/12/17/174/","excerpt":"","text":"åˆ†æçš„ç‰ˆæœ¬æ˜¯TP3.2.3 æ­¤ç‰ˆæœ¬å·²ç»æ”¯æŒmysqlæ•°æ®åº“è¯»å†™åˆ†ç¦»ï¼Œé…ç½®æ¯”è¾ƒç®€å•ï¼Œå…·ä½“å¯çœ‹åˆ†å¸ƒå¼æ•°æ®åº“æ”¯æŒ æˆ‘ä»¬å°è¯•åˆ†æä¸‹æºç å®ç°ï¼š ä¸å¦¨å…ˆyyä¸€ä¸‹ï¼Œåœ¨å†™æ“ä½œå’Œè¯»æ“ä½œæ—¶åŒºåˆ†å¼€æ•°æ®åº“è¿æ¥åˆ†åˆ«è¿æ¥masterå’Œslaveã€‚ æˆ‘ä»¬å¯ä»¥çœ‹è§Model.class.phpçš„dbåˆå§‹åŒ– public function db($linkNum = , $config = , $force = false) &#123; if ( === $linkNum &amp;&amp; $this-&gt;db) &#123; return $this-&gt;db; &#125; if (! isset ( $this-&gt;_db [$linkNum] ) || $force) &#123; // åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ if (! empty ( $config ) &amp;&amp; is_string ( $config ) &amp;&amp; false === strpos ( $config, / )) &#123; // æ”¯æŒè¯»å–é…ç½®å‚æ•° $config = C ( $config ); &#125; $this-&gt;_db [$linkNum] = Db::getInstance ( $config ); &#125; elseif (NULL === $config) &#123; $this-&gt;_db [$linkNum]-&gt;close (); // å…³é—­æ•°æ®åº“è¿æ¥ unset ( $this-&gt;_db [$linkNum] ); return; &#125; // åˆ‡æ¢æ•°æ®åº“è¿æ¥ $this-&gt;db = $this-&gt;_db [$linkNum]; $this-&gt;_after_db (); // å­—æ®µæ£€æµ‹ if (! empty ( $this-&gt;name ) &amp;&amp; $this-&gt;autoCheckFields) $this-&gt;_checkTableInfo (); return $this; &#125; æ¥ç€çœ‹DBå•ä¾‹ï¼Œ static public function getInstance($config = array()) &#123; $md5 = md5 ( serialize ( $config ) ); if (! isset ( self::$instance [$md5] )) &#123; // è§£æè¿æ¥å‚æ•° æ”¯æŒæ•°ç»„å’Œå­—ç¬¦ä¸² $options = self::parseConfig ( $config ); // å…¼å®¹mysqli if (mysqli == $options [type]) $options [type] = mysql; // å¦‚æœé‡‡ç”¨liteæ–¹å¼ ä»…æ”¯æŒåŸç”ŸSQL åŒ…æ‹¬queryå’Œexecuteæ–¹æ³• $class = $options [lite] ? ThinkDbLite : Think\\Db\\Driver\\ . ucwords ( strtolower ( $options [type] ) ); if (class_exists ( $class )) &#123; self::$instance [$md5] = new $class ( $options ); &#125; else &#123; // ç±»æ²¡æœ‰å®šä¹‰ E ( L ( _NO_DB_DRIVER_ ) . : . $class ); &#125; &#125; self::$_instance = self::$instance [$md5]; return self::$_instance; &#125; æ¥ç€çœ‹è§mysqlé©±åŠ¨ç»§æ‰¿äº†æŠ½è±¡ç±»Driverã€‚ ä¸å¦¨æ‰¾ä¸¤ä¸ªModelæ“ä½œè¯»ï¼ˆfindï¼‰å’Œå†™(add): public function find($options = array()) &#123; ... $resultSet = $this-&gt;db-&gt;select ( $options ); ... &#125; public function add($data = , $options = array(), $replace = false) &#123; ... $result = $this-&gt;db-&gt;insert ( $data, $options, $replace ); ... &#125; æˆ‘ä»¬åªèšç„¦å…³é”®ä»£ç select å’Œinsert ã€‚ç„¶åå»æŸ¥çœ‹æ•°æ®åº“é©±åŠ¨ç±»ä»£ç ï¼š public function select($options = array()) &#123; ... $result = $this-&gt;query ( $sql, ! empty ( $options [fetch_sql] ) ? true : false ); ... &#125; public function insert($data, $options = array(), $replace = false) &#123; ... return $this-&gt;execute ( $sql, ! empty ( $options [fetch_sql] ) ? true : false ); &#125; ç»§ç»­å¯»æ ¹ï¼Œæˆ‘ä»¬çœ‹è§ /** * æ‰§è¡ŒæŸ¥è¯¢ è¿”å›æ•°æ®é›† */ public function query($str, $fetchSql = false) &#123; $this-&gt;initConnect ( false ); ... &#125; /** * æ‰§è¡Œè¯­å¥ */ public function execute($str, $fetchSql = false) &#123; $this-&gt;initConnect ( true ); ... &#125; æˆ‘ä»¬ç»ˆäºæ‰¾åˆ°äº†æ ¹æœ¬ï¼Œ /** * åˆå§‹åŒ–æ•°æ®åº“è¿æ¥ * * @access protected * @param boolean $master * ä¸»æœåŠ¡å™¨ * @return void */ protected function initConnect($master = true) &#123; if (! empty ( $this-&gt;config [deploy] )) // é‡‡ç”¨åˆ†å¸ƒå¼æ•°æ®åº“ $this-&gt;_linkID = $this-&gt;multiConnect ( $master ); else // é»˜è®¤å•æ•°æ®åº“ if (! $this-&gt;_linkID) $this-&gt;_linkID = $this-&gt;connect (); &#125; /** * è¿æ¥åˆ†å¸ƒå¼æœåŠ¡å™¨ * * @access protected * @param boolean $master * ä¸»æœåŠ¡å™¨ * @return void */ protected function multiConnect($master = false) &#123; // åˆ†å¸ƒå¼æ•°æ®åº“é…ç½®è§£æ $_config [username] = explode ( ,, $this-&gt;config [username] ); $_config [password] = explode ( ,, $this-&gt;config [password] ); $_config [hostname] = explode ( ,, $this-&gt;config [hostname] ); $_config [hostport] = explode ( ,, $this-&gt;config [hostport] ); $_config [database] = explode ( ,, $this-&gt;config [database] ); $_config [dsn] = explode ( ,, $this-&gt;config [dsn] ); $_config [charset] = explode ( ,, $this-&gt;config [charset] ); $m = floor ( mt_rand ( 0, $this-&gt;config [master_num] - 1 ) ); // æ•°æ®åº“è¯»å†™æ˜¯å¦åˆ†ç¦» if ($this-&gt;config [rw_separate]) &#123; // ä¸»ä»å¼é‡‡ç”¨è¯»å†™åˆ†ç¦» if ($master) // ä¸»æœåŠ¡å™¨å†™å…¥ $r = $m; else &#123; if (is_numeric ( $this-&gt;config [slave_no] )) &#123; // æŒ‡å®šæœåŠ¡å™¨è¯» $r = $this-&gt;config [slave_no]; &#125; else &#123; // è¯»æ“ä½œè¿æ¥ä»æœåŠ¡å™¨ $r = floor ( mt_rand ( $this-&gt;config [master_num], count ( $_config [hostname] ) - 1 ) ); // æ¯æ¬¡éšæœºè¿æ¥çš„æ•°æ®åº“ &#125; &#125; &#125; else &#123; // è¯»å†™æ“ä½œä¸åŒºåˆ†æœåŠ¡å™¨ $r = floor ( mt_rand ( 0, count ( $_config [hostname] ) - 1 ) ); // æ¯æ¬¡éšæœºè¿æ¥çš„æ•°æ®åº“ &#125; if ($m != $r) &#123; $db_master = array ( username =&gt; isset ( $_config [username] [$m] ) ? $_config [username] [$m] : $_config [username] [0], password =&gt; isset ( $_config [password] [$m] ) ? $_config [password] [$m] : $_config [password] [0], hostname =&gt; isset ( $_config [hostname] [$m] ) ? $_config [hostname] [$m] : $_config [hostname] [0], hostport =&gt; isset ( $_config [hostport] [$m] ) ? $_config [hostport] [$m] : $_config [hostport] [0], database =&gt; isset ( $_config [database] [$m] ) ? $_config [database] [$m] : $_config [database] [0], dsn =&gt; isset ( $_config [dsn] [$m] ) ? $_config [dsn] [$m] : $_config [dsn] [0], charset =&gt; isset ( $_config [charset] [$m] ) ? $_config [charset] [$m] : $_config [charset] [0] ); &#125; $db_config = array ( username =&gt; isset ( $_config [username] [$r] ) ? $_config [username] [$r] : $_config [username] [0], password =&gt; isset ( $_config [password] [$r] ) ? $_config [password] [$r] : $_config [password] [0], hostname =&gt; isset ( $_config [hostname] [$r] ) ? $_config [hostname] [$r] : $_config [hostname] [0], hostport =&gt; isset ( $_config [hostport] [$r] ) ? $_config [hostport] [$r] : $_config [hostport] [0], database =&gt; isset ( $_config [database] [$r] ) ? $_config [database] [$r] : $_config [database] [0], dsn =&gt; isset ( $_config [dsn] [$r] ) ? $_config [dsn] [$r] : $_config [dsn] [0], charset =&gt; isset ( $_config [charset] [$r] ) ? $_config [charset] [$r] : $_config [charset] [0] ); return $this-&gt;connect ( $db_config, $r, $r == $m ? false : $db_master ); &#125; å…¶å®å°±æ˜¯é€šè¿‡ä¼ å…¥initConnectæ¥åŒºåˆ†è¯»å†™æ“ä½œï¼Œå¹¶æ ¹æ®é…ç½®å»è¿æ¥æ“ä½œã€‚ ä»Šå¤©åˆ†æå°±åˆ°è¿™é‡Œäº†ï¼Œå…¶å®ä¸æˆ‘ä»¬yyçš„åŸºæœ¬ä¸€è‡´ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"phpåˆæˆå›¾ç‰‡","slug":"phpåˆæˆå›¾ç‰‡","date":"2018-12-13T14:16:39.000Z","updated":"2022-03-19T14:35:21.782Z","comments":true,"path":"2018/12/13/172/","link":"","permalink":"https://github.13sai.com/2018/12/13/172/","excerpt":"","text":"&lt;?php /** * Created by PhpStorm. * User: 13sai * Date: 2018/12/7 */ header(&quot;Content-type: image/png&quot;); //ob_clean(); // $path_2 = D:workdata/2.png; $path_1 = D:workdata/1.png; $info2 = getimagesize($path_2); $info1 = getimagesize($path_1); function getImage($ext, $img) &#123; switch ($ext) &#123; case png : $ret = imagecreatefrompng($img); break; case jpeg: $ret = imagecreatefromjpeg($img); break; case gif: $ret = imagecreatefromgif($img); break; default: throw new \\Exception(ä¸èƒ½è¯†åˆ«çš„å›¾ç‰‡æ ¼å¼); break; &#125; return $ret??; &#125; //è·å–å›¾ç‰‡æ‰©å±•å $type1 = image_type_to_extension($info1[2],false); $type2 = image_type_to_extension($info2[2],false); $image_1 = getImage($type1, $path_1); $image_2 = getImage($type2, $path_2); imagecopy( $image_1, $image_2, 50, 70, 0, 0, $info2[0], $info2[1] ); // è¾“å‡º imagepng($image_1, D:picscompose.png); imagedestroy($image_1); imagedestroy($image_2);","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"swooleå‘é‚®ä»¶","slug":"swooleå‘é‚®ä»¶","date":"2018-11-29T14:46:31.000Z","updated":"2022-03-19T14:35:21.806Z","comments":true,"path":"2018/11/29/171/","link":"","permalink":"https://github.13sai.com/2018/11/29/171/","excerpt":"","text":"Swooleï¼šé¢å‘ç”Ÿäº§ç¯å¢ƒçš„ PHP å¼‚æ­¥ç½‘ç»œé€šä¿¡å¼•æ“ å¾ˆæ—©å°±çŸ¥é“äº†swooleï¼Œä½†ä¸€ç›´æ²¡æœ‰å®é™…ç”¨åˆ°ç”Ÿäº§ä¸­ï¼Œæœ€è¿‘åœ¨é‡æ„åšå®¢ï¼Œå°±æƒ³ç€åšç‚¹ä¸œè¥¿ï¼Œå…ˆswooleå‘é‚®ä»¶ç»ƒç»ƒæ‰‹ã€‚ å›é¡¾ä¸‹å‘é‚®ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨PHPMaileræ¥å‘é€ã€‚ &lt;?php /** * Created by PhpStorm. * User: 13sai * Date: 2018/11/29 * Time: 11:16 */ require &#x27;../vendor/autoload.php&#x27;; use PHPMailer\\PHPMailer\\PHPMailer; use PHPMailer\\PHPMailer\\Exception; $mail = new PHPMailer(true); try &#123; //Server settings // $mail-&gt;SMTPDebug = 2; // Enable verbose debug output $mail-&gt;isSMTP(); // Set mailer to use SMTP $mail-&gt;Host = &#x27;smtp.163.com&#x27;; // Specify main and backup SMTP servers $mail-&gt;SMTPAuth = true; // Enable SMTP authentication $mail-&gt;Username = &#x27;sai@163.com&#x27;; // SMTP username $mail-&gt;Password = &#x27;*&#x27;; // SMTP password $mail-&gt;SMTPSecure = &#x27;tls&#x27;; // Enable TLS encryption, ssl also accepted $mail-&gt;Port = 25; // TCP port to connect to //æ”¶ä»¶äºº $mail-&gt;setFrom(&#x27;sai@163.com&#x27;, &#x27;13sai&#x27;); $mail-&gt;addAddress(&#x27;957042781@qq.com&#x27;); // Name is optional $mail-&gt;addReplyTo(&#x27;957042781@qq.com&#x27;, &#x27;Information&#x27;); // $mail-&gt;addCC(&#x27;cc@example.com&#x27;); // $mail-&gt;addBCC(&#x27;bcc@example.com&#x27;); //é™„ä»¶ $mail-&gt;addAttachment(&#x27;/var/file.tar.gz&#x27;); // Add attachments $mail-&gt;addAttachment(&#x27;/tmp/image.jpg&#x27;, &#x27;new.jpg&#x27;); // Optional name //html $mail-&gt;isHTML(true); $mail-&gt;Subject = &#x27;Here is the subject&#x27;; $mail-&gt;Body = &#x27;This is the HTML message body &lt;b&gt;in bold!&lt;/b&gt;&#x27;; $mail-&gt;AltBody = &#x27;This is the body in plain text for non-HTML mail clients&#x27;; $mail-&gt;send(); echo &#x27;Message has been sent&#x27;; &#125; catch (Exception $e) &#123; echo &#x27;Message could not be sent.&#x27;; echo &#x27;Mailer Error: &#x27; . $mail-&gt;ErrorInfo; &#125; è¿è¡Œå‘é€ï¼Œæ”¶åˆ°é‚®ä»¶ã€‚ ä¸»ç¨‹åº&lt;?php /** Created by PhpStorm. User: 13sai Date: 2018/11/29 Time: 14:06 / require dirname(DIR).&#x27;/vendor/autoload.php&#x27;; use PHPMailer\\PHPMailer\\PHPMailer; use PHPMailer\\PHPMailer\\Exception; class Mailer &#123; protected $server; protected $host = &#x27;127.0.0.1&#x27;; protected $port = 9502; // è¿›ç¨‹åç§° protected $taskName = &#x27;swooleMailer&#x27;; // PIDè·¯å¾„ protected $pidPath = &#x27;/run/swooleMail.pid&#x27;; // è®¾ç½®è¿è¡Œæ—¶å‚æ•° protected $options = [ &#x27;worker_num&#x27; =&gt; 4, //workerè¿›ç¨‹æ•°,ä¸€èˆ¬è®¾ç½®ä¸ºCPUæ•°çš„1-4å€ &#x27;daemonize&#x27; =&gt; true, //å¯ç”¨å®ˆæŠ¤è¿›ç¨‹ &#x27;log_file&#x27; =&gt; &#x27;/data/logs/swoole.log&#x27;, //æŒ‡å®šswooleé”™è¯¯æ—¥å¿—æ–‡ä»¶ &#x27;log_level&#x27; =&gt; 0, //æ—¥å¿—çº§åˆ« èŒƒå›´æ˜¯0-5ï¼Œ0-DEBUGï¼Œ1-TRACEï¼Œ2-INFOï¼Œ3-NOTICEï¼Œ4-WARNINGï¼Œ5-ERROR &#x27;dispatch_mode&#x27; =&gt; 1, //æ•°æ®åŒ…åˆ†å‘ç­–ç•¥,1-è½®è¯¢æ¨¡å¼ &#x27;task_worker_num&#x27; =&gt; 4, //taskè¿›ç¨‹çš„æ•°é‡ &#x27;task_ipc_mode&#x27; =&gt; 3, //ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—é€šä¿¡ï¼Œå¹¶è®¾ç½®ä¸ºäº‰æŠ¢æ¨¡å¼ //&#x27;heartbeat_idle_time&#x27; =&gt; 600, //ä¸€ä¸ªè¿æ¥å¦‚æœ600ç§’å†…æœªå‘æœåŠ¡å™¨å‘é€ä»»ä½•æ•°æ®ï¼Œæ­¤è¿æ¥å°†è¢«å¼ºåˆ¶å…³é—­ //&#x27;heartbeat_check_interval&#x27; =&gt; 60, //å¯ç”¨å¿ƒè·³æ£€æµ‹ï¼Œæ¯éš”60sè½®å¾ªä¸€æ¬¡ ]; // é‚®ä»¶æœåŠ¡å™¨é…ç½® protected $mailConfig = [ &#x27;smtp_host&#x27; =&gt; &#x27;smtp.163.com&#x27;, &#x27;username&#x27; =&gt; &#x27;sai0556@163.com&#x27;, &#x27;password&#x27; =&gt; &#x27;xmw1015&#x27;,// SMTP å¯†ç /å£ä»¤ &#x27;secure&#x27; =&gt; &#x27;ssl&#x27;, //Enable TLS encryption, ssl also accepted &#x27;port&#x27; =&gt; 465, // tcpé‚®ä»¶æœåŠ¡å™¨ç«¯å£ ]; public function __construct($mailConfig, $options = []) &#123; // æ„å»ºServerå¯¹è±¡ï¼Œç›‘å¬ç«¯å£ $this-&gt;server = new swoole_server($this-&gt;host, $this-&gt;port); if (!empty($options)) &#123; $this-&gt;options = array_merge($this-&gt;options, $options); &#125; $this-&gt;server-&gt;set($this-&gt;options); $this-&gt;mailConfig = $mailConfig; // æ³¨å†Œäº‹ä»¶ $this-&gt;server-&gt;on(&#x27;Start&#x27;, [$this, &#x27;onStart&#x27;]); $this-&gt;server-&gt;on(&#x27;Connect&#x27;, [$this, &#x27;onConnect&#x27;]); $this-&gt;server-&gt;on(&#x27;Receive&#x27;, [$this, &#x27;onReceive&#x27;]); $this-&gt;server-&gt;on(&#x27;Task&#x27;, [$this, &#x27;onTask&#x27;]); $this-&gt;server-&gt;on(&#x27;Finish&#x27;, [$this, &#x27;onFinish&#x27;]); $this-&gt;server-&gt;on(&#x27;Close&#x27;, [$this, &#x27;onClose&#x27;]); // å¯åŠ¨æœåŠ¡ //$this-&gt;server-&gt;start(); &#125; protected function init() &#123; // &#125; public function start() &#123; // Run worker $this-&gt;server-&gt;start(); &#125; public function onStart($server) &#123; // è®¾ç½®è¿›ç¨‹å cli_set_process_title($this-&gt;taskName); //è®°å½•è¿›ç¨‹id,è„šæœ¬å®ç°è‡ªåŠ¨é‡å¯ $pid = &quot;&#123;$server-&gt;master_pid&#125; &#123;$server-&gt;manager_pid&#125;&quot;; file_put_contents($this-&gt;pidPath, $pid); &#125; //ç›‘å¬è¿æ¥è¿›å…¥äº‹ä»¶ public function onConnect($server, $fd, $from_id) &#123; $server-&gt;send($fd, &quot;Hello &#123;$fd&#125;!&quot; ); &#125; // ç›‘å¬æ•°æ®æ¥æ”¶äº‹ä»¶ public function onReceive(swoole_server $server, $fd, $from_id, $data) &#123; $res[&#x27;result&#x27;] = &#x27;success&#x27;; $server-&gt;send($fd, json_encode($res)); // åŒæ­¥è¿”å›æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ $server-&gt;task($data); // æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ &#125; /* @param $server swoole_server swoole_serverå¯¹è±¡ @param $task_id int ä»»åŠ¡id @param $from_id int æŠ•é€’ä»»åŠ¡çš„worker_id @param $data string æŠ•é€’çš„æ•°æ® / public function onTask(swoole_server $server, $task_id, $from_id, $data) &#123; $res[&#x27;result&#x27;] = &#x27;failed&#x27;; $req = json_decode($data, true); $action = $req[&#x27;action&#x27;]; echo date(&#x27;Y-m-d H:i:s&#x27;).&quot; onTask: [&quot;.$action.&quot;]. &quot;; switch ($action) &#123; case &#x27;sendMail&#x27;: //å‘é€å•ä¸ªé‚®ä»¶ $mailData = [ &#x27;emailAddress&#x27; =&gt; $req[&#x27;to&#x27;], //æ¥æ”¶æ–¹ï¼Œæ”¹æˆè‡ªå·±çš„é‚®ç®±å¯ä»¥æµ‹è¯•æ¥æ”¶é‚®ä»¶ &#x27;subject&#x27; =&gt; $req[&#x27;subject&#x27;], &#x27;body&#x27; =&gt; $req[&#x27;body&#x27;], ]; $this-&gt;sendMail($mailData); break; default: break; &#125; &#125; /* @param $server swoole_server swoole_serverå¯¹è±¡ @param $task_id int ä»»åŠ¡id @param $data string ä»»åŠ¡è¿”å›çš„æ•°æ® */ public function onFinish(swoole_server $server, $task_id, $data) &#123; // &#125; // ç›‘å¬è¿æ¥å…³é—­äº‹ä»¶ public function onClose($server, $fd, $from_id) &#123; echo &quot;Client &#123;$fd&#125; close connection &quot;; &#125; public function stop() &#123; $this-&gt;server-&gt;stop(); &#125; private function sendMail($mailData = []) &#123; $mail = new PHPMailer(true); try &#123; $mailConfig = $this-&gt;mailConfig; $mail-&gt;isSMTP(); // TCP port to connect to $mail-&gt;Host = $mailConfig[&#x27;smtp_host&#x27;]; // SMTPæœåŠ¡ $mail-&gt;SMTPAuth = true; // Enable SMTP authentication $mail-&gt;Username = $mailConfig[&#x27;username&#x27;]; // SMTP ç”¨æˆ·å $mail-&gt;Password = $mailConfig[&#x27;password&#x27;]; // SMTP å¯†ç /å£ä»¤ $mail-&gt;SMTPSecure = $mailConfig[&#x27;secure&#x27;]; // Enable TLS encryption, ssl also accepted $mail-&gt;Port = $mailConfig[&#x27;port&#x27;]; // TCP ç«¯å£ //Recipients $mail-&gt;setFrom(&#x27;sai0556@163.com&#x27;, &#x27;13sai&#x27;); $mail-&gt;addAddress(&#x27;957042781@qq.com&#x27;); // Name is optional $mail-&gt;addReplyTo(&#x27;957042781@qq.com&#x27;, &#x27;Information&#x27;); //Content $mail-&gt;isHTML(true); // Set email format to HTML $mail-&gt;Subject = &#x27;Here is the subject&#x27;; $mail-&gt;Body = &#x27;This is the HTML message body &lt;b&gt;in bold!&lt;/b&gt;&#x27;; $mail-&gt;AltBody = &#x27;This is the body in plain text for non-HTML mail clients&#x27;; $mail-&gt;send(); echo &#x27;Message has been sent&#x27;; &#125; catch (Exception $e) &#123; echo &#x27;Message could not be sent.&#x27;; echo &#x27;Mailer Error: &#x27; . $mail-&gt;ErrorInfo; &#125; try &#123; $mailConfig = $this-&gt;mailConfig; $mail-&gt;isSMTP(); // Set mailer to use SMTP $mail-&gt;Host = $mailConfig[&#x27;smtp_host&#x27;]; // SMTPæœåŠ¡ $mail-&gt;SMTPAuth = true; // Enable SMTP authentication $mail-&gt;Username = $mailConfig[&#x27;username&#x27;]; // SMTP ç”¨æˆ·å $mail-&gt;Password = $mailConfig[&#x27;password&#x27;]; // SMTP å¯†ç /å£ä»¤ $mail-&gt;SMTPSecure = $mailConfig[&#x27;secure&#x27;]; // Enable TLS encryption, ssl also accepted $mail-&gt;Port = $mailConfig[&#x27;port&#x27;]; // TCP ç«¯å£ $mail-&gt;CharSet = &quot;UTF-8&quot;; //å­—ç¬¦é›† $mail-&gt;setFrom($mailConfig[&#x27;username&#x27;], &#x27;13sai&#x27;); //å‘ä»¶äººåœ°å€ï¼Œåç§° $mail-&gt;addAddress($mailData[&#x27;emailAddress&#x27;], &#x27;äº²&#x27;); // æ”¶ä»¶äººåœ°å€å’Œåç§° //$mail-&gt;addCC(&#x27;hellowebanet@163.com&#x27;); // æŠ„é€ if (isset($mailData[&#x27;attach&#x27;])) &#123; $mail-&gt;addAttachment($mailData[&#x27;attach&#x27;]); // æ·»åŠ é™„ä»¶ &#125; //$mail-&gt;addAttachment(&#x27;/tmp/image.jpg&#x27;, &#x27;new.jpg&#x27;); // Optional name //Content $mail-&gt;isHTML(true); // Set email format to HTML $mail-&gt;Subject = $mailData[&#x27;subject&#x27;]; $mail-&gt;Body = $mailData[&#x27;body&#x27;]; $mail-&gt;send(); return true; &#125; catch (\\Exception $e) &#123; echo &#x27;Message could not be sent. Mailer Error: &#x27;. $mail-&gt;ErrorInfo; return false; &#125; &#125; &#125; æœåŠ¡ï¼š&lt;?php /* Created by PhpStorm. User: 13sai Date: 2018/11/29 Time: 14:09 / require DIR . &#x27;/Mailer.php&#x27;; $config = [ &#x27;smtp_host&#x27; =&gt; &#x27;smtp.163.com&#x27;, &#x27;username&#x27; =&gt; &#x27;sai@163.com&#x27;, &#x27;password&#x27; =&gt; &#x27;&#x27;, &#x27;secure&#x27; =&gt; &#x27;ssl&#x27;, &#x27;port&#x27; =&gt; 465 ]; $server = new Mailer($config); $server-&gt;start(); å‘é€&lt;?php /** Created by PhpStorm. User: 13sai Date: 2018/11/29 Time: 14:14 / class Client &#123; private $client; public function __construct() &#123; $this-&gt;client = new swoole_client(SWOOLE_SOCK_TCP); &#125; public function send() &#123; if( !$this-&gt;client-&gt;connect(&quot;127.0.0.1&quot;, 9502 , 1) ) &#123; echo &quot;Error: &#123;$this-&gt;client-&gt;errMsg&#125;[&#123;$this-&gt;client-&gt;errCode&#125;] &quot;; &#125; $action = &#x27;sendMail&#x27;; $time = time(); $data = [ &#x27;action&#x27; =&gt; $action, &#x27;to&#x27; =&gt; &#x27;957042781@qq.com&#x27;, &#x27;subject&#x27; =&gt; &#x27;wow&#x27;, &#x27;body&#x27; =&gt; &#x27;hello, 13sai!&#x27; ]; $msg = json_encode($data); $this-&gt;client-&gt;send( $msg ); $message = $this-&gt;client-&gt;recv(); echo &quot;Get Message From Server:&#123;$message&#125; &quot;; &#125; &#125; $client = new Client(); $client-&gt;send(); æµ‹è¯•é€šè¿‡ï¼ æ³¨æ„ï¼š æ­¤å¤„æˆ‘ç”¨äº†25ç«¯å£ï¼Œéƒ¨ç½²åˆ°Linuxæ—¶ä¸Šå‘é€é‚®ä»¶å‘ä¸å‡ºå»ï¼ŒæŠŠPHPMailerçš„é”™è¯¯è¯´æ˜æŸ¥äº†ä¸ªéï¼Œwrongï¼Œç«¯å£æ”¹ä¸º465ï¼Œä½¿ç”¨sslå‘é€ï¼Œokï¼ å¿ƒç´¯ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"swoole","slug":"swoole","permalink":"https://github.13sai.com/tags/swoole/"}]},{"title":"nginxå¥åº·æ£€æŸ¥","slug":"Nginxå¥åº·æ£€æŸ¥","date":"2018-10-19T14:21:15.000Z","updated":"2022-03-19T15:27:42.027Z","comments":true,"path":"2018/10/19/Nginx4/","link":"","permalink":"https://github.13sai.com/2018/10/19/Nginx4/","excerpt":"","text":"é¢è¯•è¢«é—®åˆ°å¥åº·æ£€æµ‹ï¼Œè‡ªå·±ä¸äº†è§£ï¼Œä¾¿æœ‰äº†ä¸‹æ–‡ã€‚ å½“é¡¹ç›®è®¿é—®é‡æ¯”è¾ƒå¤§æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨nginxåšè´Ÿè½½å‡è¡¡ã€‚ å¦‚ä¸‹ï¼š #è®¾å®šhttpæœåŠ¡å™¨ï¼Œåˆ©ç”¨å®ƒçš„åå‘ä»£ç†åŠŸèƒ½æä¾›è´Ÿè½½å‡è¡¡æ”¯æŒ http &#123; #è®¾å®šmimeç±»å‹,ç±»å‹ç”±mime.typeæ–‡ä»¶å®šä¹‰ include /etc/nginx/mime.types; default_type application/octet-stream; #è®¾å®šæ—¥å¿—æ ¼å¼ access_log /var/log/nginx/access.log; #çœç•¥ä¸Šæ–‡æœ‰çš„ä¸€äº›é…ç½®èŠ‚ç‚¹ #ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ #è®¾å®šè´Ÿè½½å‡è¡¡çš„æœåŠ¡å™¨åˆ—è¡¨ upstream sai&#123; #weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§ server 192.168.8.1:3128 weight=5; #æœ¬æœºä¸Šçš„Squidå¼€å¯3128ç«¯å£,ä¸æ˜¯å¿…é¡»è¦squid server 192.168.8.2:80 weight=1; server 192.168.8.3:80 weight=6; &#125; #ç¬¬ä¸€ä¸ªè™šæ‹ŸæœåŠ¡å™¨ server &#123; #ä¾¦å¬192.168.8.xçš„80ç«¯å£ listen 80; server_name www.13sai.com; #å¯¹aspxåç¼€çš„è¿›è¡Œè´Ÿè½½å‡è¡¡è¯·æ±‚ location ~ .*.php$ &#123; #å®šä¹‰æœåŠ¡å™¨çš„é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ä½ç½® root /root; #å®šä¹‰é¦–é¡µç´¢å¼•æ–‡ä»¶çš„åç§° index index.php index.html index.htm; #è¯·æ±‚è½¬å‘mysvr å®šä¹‰çš„æœåŠ¡å™¨åˆ—è¡¨ proxy_pass http://sai; #ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®å¯åˆ é™¤. proxy_redirect off; #åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; #å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•° client_max_body_size 10m; #ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œ client_body_buffer_size 128k; #nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶) proxy_connect_timeout 90; #è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶) proxy_read_timeout 90; #è®¾ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆnginxï¼‰ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å° proxy_buffer_size 4k; #proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è¯ï¼Œè¿™æ ·è®¾ç½® proxy_buffers 4 32k; #é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰ proxy_busy_buffers_size 64k; #è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼  proxy_temp_file_write_size 64k; &#125; &#125; &#125; è¿™æ˜¯nginxä¸­æ–‡ç½‘ä¸Šçš„ä¸€ä¸ªå®ä¾‹ï¼ˆæœ‰åˆ æ”¹ï¼‰ï¼Œè¿™æ ·å¤„ç†åˆ†å‘æœåŠ¡å™¨ï¼Œæˆ‘ä»¬åŠ å…¥äº†ä¸‰å°æœºå™¨ï¼Œä¿è¯äº†é¡¹ç›®çš„è´Ÿè½½é‡ã€‚ ç„¶è€Œï¼Œæˆ‘ä»¬å¸¸å¸¸å¿½ç•¥å¦ä¸€ä»¶äº‹ï¼Œå°±æ˜¯å¥åº·æ£€æŸ¥ã€‚ï¼ˆå¥½å§ï¼Œå…¶å®æˆ‘ä¹Ÿå¿½ç•¥äº†è¿™ä¸ªé—®é¢˜ï¼Œé¢è¯•è¢«é—®åˆ°ï¼Œä¸€è„¸æ‡µï¼ï¼ï¼ï¼‰ ä½•ä¸ºå¥åº·ç›‘æµ‹ï¼Ÿ å‡å¦‚æˆ‘ä»¬åŠ å…¥çš„3å°æœºå™¨ä¸­æœ‰ä¸€å°å› ä¸ºå…¶ä»–åŸå› æŒ‚æ‰äº†ï¼Œä½†åˆ†å‘çš„æœåŠ¡å™¨æ˜¯ä¸çŸ¥é“çš„ï¼Œä¾æ—§æ­£å¸¸åˆ†å‘è¯·æ±‚ï¼Œå¿…ç„¶å°±å¯¼è‡´éƒ¨åˆ†ç”¨æˆ·è®¿é—®å¤±è´¥ï¼Œè¿™æ˜¯å¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°å¥åº·æ£€æŸ¥äº†ã€‚ ä¸‹é¢æˆ‘ä»¬ä»‹ç»ä¸¤ç§å¥åº·æ£€æŸ¥ï¼š è¢«åŠ¨æ£€æŸ¥ï¼š å¦‚æœ Nginx åœ¨ 10 ç§’å†…æœ‰ 2 ä¸ªè¯·æ±‚å‘é€å¤±è´¥æˆ–æ²¡æœ‰æ¥æ”¶åˆ°å“åº”ï¼Œåˆ™æ ‡è®°æœåŠ¡å™¨ä¸ºä¸å¯ç”¨ upstream sai&#123; server 192.168.8.1:3128 max_fails=2 fail_timeout=10s weight=5; server 192.168.8.2:80 max_fails=2 fail_timeout=10s weight=1; server 192.168.8.3:80 max_fails=2 fail_timeout=10s weight=6; &#125;Copy ä¸»åŠ¨æ£€æŸ¥ï¼š éœ€è¦å…ˆå¼€å¯health_check upstream sai&#123; zone sai 64k; server 192.168.8.1:3128 max_fails=2 fail_timeout=10s weight=5; server 192.168.8.2:80 max_fails=2 fail_timeout=10s weight=1; server 192.168.8.3:80 max_fails=2 fail_timeout=10s weight=6; &#125; location ~ .*.php$ &#123; #å…¶ä»–çœç•¥ â€¦ proxy_pass http://sai; health_check interval=10 fails=3 passes=2; # ä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤ç§ï¼ŒæŒ‡å®šç‰¹å®šæ¥å£ health_check uri=/some/path; &#125;Copy é…ç½®èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ proxy_next_upstream# å¼€å¯proxy_next_upstream proxy_next_upstream on upstream proxy_web&#123; server 192.168.1.120:7851 weight=2 max_fails=3 fail_timeout=100s; server 192.168.1.121:7851 weight=2 max_fails=3 fail_timeout=100s; &#125; server &#123; listen 80; server_name blog.13sai.com; root /www; index index.html; location /sys &#123; proxy_pass http://proxy_web; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; // 502,404,errorè‡ªåŠ¨ä»£ç†åˆ°ä¸‹ä¸€ä¸ªserver proxy_next_upstream http_502 http_504 error timeout invalid_header; &#125; &#125; å¦‚è¦äº†è§£æ›´å¤šå¯ä»¥æŸ¥çœ‹nginxæ‰‹å†Œï¼š nginxå¥åº·ç›‘æµ‹","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"}]},{"title":"å°å‹å•†åŸå•†å“æ¨¡å—è®¾è®¡","slug":"å°å‹å•†åŸå•†å“æ¨¡å—è®¾è®¡","date":"2018-08-31T10:07:06.000Z","updated":"2022-03-30T11:21:32.602Z","comments":true,"path":"2018/08/31/168/","link":"","permalink":"https://github.13sai.com/2018/08/31/168/","excerpt":"","text":"æœ€è¿‘æœ‰åšåˆ°ç±»å•†åŸå°å‹é¡¹ç›®ï¼Œä¸»è¦è´Ÿè´£å•†å“æ¨¡å—ï¼Œä¾¿åˆ†äº«ä¸‹å•†å“æ¨¡å—è®¾è®¡æ€è·¯ã€‚ä¸»è¦åˆ†ä¸º5ä¸ªè¡¨ï¼šå•†å“ä½œä¸ºä¸»è¡¨ï¼Œä¸è§„æ ¼è¡¨ã€å±æ€§è¡¨ã€skuè¡¨ç›´æ¥å…³è”ã€‚ERå…³ç³»å›¾å¦‚ä¸‹ï¼šSQLè¯­å¥å¦‚ä¸‹ï¼š--&nbsp;---------------------------- --&nbsp;Table&nbsp;structure&nbsp;for&nbsp;goods --&nbsp;---------------------------- DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;`goods`; CREATE&nbsp;TABLE&nbsp;`goods`&nbsp;&nbsp;( &nbsp;&nbsp;`id`&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;AUTO_INCREMENT, &nbsp;&nbsp;`mid`&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;åº—é“ºid&#39;, &nbsp;&nbsp;`goods_sn`&nbsp;varchar(128)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NULL&nbsp;DEFAULT&nbsp;NULL&nbsp;COMMENT&nbsp;&#39;å•†å“ç¼–ç &#39;, &nbsp;&nbsp;`title`&nbsp;varchar(128)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL, &nbsp;&nbsp;`main_pic`&nbsp;varchar(255)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL&nbsp;COMMENT&nbsp;&#39;å•†å“ä¸»å›¾&#39;, &nbsp;&nbsp;`pics`&nbsp;varchar(1024)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL&nbsp;COMMENT&nbsp;&#39;å›¾é›†&#39;, &nbsp;&nbsp;`cate_id`&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;åˆ†ç±»id&#39;, &nbsp;&nbsp;`outer_price`&nbsp;decimal(10,&nbsp;2)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0.00&nbsp;COMMENT&nbsp;&#39;å¤–éƒ¨ä»·æ ¼&nbsp;å•ä½ï¼šå…ƒ&#39;, &nbsp;&nbsp;`inner_price`&nbsp;decimal(10,&nbsp;2)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0.00&nbsp;COMMENT&nbsp;&#39;ä»·æ ¼&nbsp;å•ä½ï¼šå…ƒ&#39;, &nbsp;&nbsp;`description`&nbsp;text&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NULL, &nbsp;&nbsp;`is_delete`&nbsp;tinyint(1)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;0&nbsp;æ­£å¸¸&nbsp;1&nbsp;åˆ é™¤&#39;, &nbsp;&nbsp;`status`&nbsp;tinyint(2)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;4&nbsp;COMMENT&nbsp;&#39;2å®¡æ ¸ï¼Œ3ä¸Šæ¶ï¼Œ4åº—é“ºä¸‹æ¶ï¼Œ5å¹³å°ä¸‹æ¶ï¼Œ6æ‹’ç»ä¸Šæ¶&#39;, &nbsp;&nbsp;`create_at`&nbsp;timestamp(0)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;CURRENT_TIMESTAMP&nbsp;COMMENT&nbsp;&#39;æ·»åŠ æ—¶é—´&#39;, &nbsp;&nbsp;`update_at`&nbsp;timestamp(0)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;CURRENT_TIMESTAMP&nbsp;ON&nbsp;UPDATE&nbsp;CURRENT_TIMESTAMP(0)&nbsp;COMMENT&nbsp;&#39;æ›´æ–°æ—¶é—´&#39;, &nbsp;&nbsp;`stock_num`&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;åº“å­˜&#39;, &nbsp;&nbsp;`sale_num`&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;é”€é‡&#39;, &nbsp;&nbsp;`sku_type`&nbsp;tinyint(1)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;2&nbsp;COMMENT&nbsp;&#39;1:&nbsp;å•è§„æ ¼&nbsp;2ï¼šå¤šè§„æ ¼&#39;, &nbsp;&nbsp;`item_url`&nbsp;varchar(512)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;&#39;&#39;&nbsp;COMMENT&nbsp;&#39;å•†å“é“¾æ¥&#39;, &nbsp;&nbsp;`sell_out`&nbsp;tinyint(1)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;å·²å–å…‰&#39;, &nbsp;&nbsp;PRIMARY&nbsp;KEY&nbsp;(`id`)&nbsp;USING&nbsp;BTREE, &nbsp;&nbsp;INDEX&nbsp;`shop_id`(`mid`)&nbsp;USING&nbsp;BTREE, &nbsp;&nbsp;INDEX&nbsp;`cate_id`(`cate_id`)&nbsp;USING&nbsp;BTREE, &nbsp;&nbsp;CONSTRAINT&nbsp;`cate_id`&nbsp;FOREIGN&nbsp;KEY&nbsp;(`cate_id`)&nbsp;REFERENCES&nbsp;`goods_category`&nbsp;(`id`)&nbsp;ON&nbsp;DELETE&nbsp;RESTRICT&nbsp;ON&nbsp;UPDATE&nbsp;RESTRICT )&nbsp;ENGINE&nbsp;=&nbsp;InnoDB&nbsp;AUTO_INCREMENT&nbsp;=&nbsp;1&nbsp;CHARACTER&nbsp;SET&nbsp;=&nbsp;utf8&nbsp;COLLATE&nbsp;=&nbsp;utf8_general_ci&nbsp;COMMENT&nbsp;=&nbsp;&#39;å•†å“è¡¨&#39;&nbsp;ROW_FORMAT&nbsp;=&nbsp;Dynamic; â€“&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”-â€“&nbsp;Table&nbsp;structure&nbsp;for&nbsp;goods_attr_keyâ€“&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”-DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;goods_attr_key;CREATE&nbsp;TABLE&nbsp;goods_attr_key&nbsp;&nbsp;(&nbsp;&nbsp;id&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;AUTO_INCREMENT,&nbsp;&nbsp;goods_id&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;å•†å“id&#39;,&nbsp;&nbsp;attr&nbsp;varchar(50)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL,&nbsp;&nbsp;PRIMARY&nbsp;KEY&nbsp;(id)&nbsp;USING&nbsp;BTREE,&nbsp;&nbsp;INDEX&nbsp;goods_id(goods_id)&nbsp;USING&nbsp;BTREE,&nbsp;&nbsp;CONSTRAINT&nbsp;goods_id&nbsp;FOREIGN&nbsp;KEY&nbsp;(goods_id)&nbsp;REFERENCES&nbsp;goods&nbsp;(id)&nbsp;ON&nbsp;DELETE&nbsp;RESTRICT&nbsp;ON&nbsp;UPDATE&nbsp;RESTRICT)&nbsp;ENGINE&nbsp;=&nbsp;InnoDB&nbsp;AUTO_INCREMENT&nbsp;=&nbsp;1&nbsp;CHARACTER&nbsp;SET&nbsp;=&nbsp;utf8&nbsp;COLLATE&nbsp;=&nbsp;utf8_general_ci&nbsp;COMMENT&nbsp;=&nbsp;&#39;å•†å“è§„æ ¼&#39;&nbsp;ROW_FORMAT&nbsp;=&nbsp;Dynamic; â€“&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”-â€“&nbsp;Table&nbsp;structure&nbsp;for&nbsp;goods_attr_valueâ€“&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”-DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;goods_attr_value;CREATE&nbsp;TABLE&nbsp;goods_attr_value&nbsp;&nbsp;(&nbsp;&nbsp;id&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;AUTO_INCREMENT,&nbsp;&nbsp;attr_id&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;COMMENT&nbsp;&#39;å±æ€§é¡¹ç›®id&#39;,&nbsp;&nbsp;attr_name&nbsp;varchar(50)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL,&nbsp;&nbsp;goods_id&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;å•†å“id&#39;,&nbsp;&nbsp;PRIMARY&nbsp;KEY&nbsp;(id)&nbsp;USING&nbsp;BTREE,&nbsp;&nbsp;INDEX&nbsp;goods_id(goods_id)&nbsp;USING&nbsp;BTREE,&nbsp;&nbsp;INDEX&nbsp;attr_id(attr_id)&nbsp;USING&nbsp;BTREE,&nbsp;&nbsp;CONSTRAINT&nbsp;val_goods_id&nbsp;FOREIGN&nbsp;KEY&nbsp;(goods_id)&nbsp;REFERENCES&nbsp;goods&nbsp;(id)&nbsp;ON&nbsp;DELETE&nbsp;RESTRICT&nbsp;ON&nbsp;UPDATE&nbsp;RESTRICT,&nbsp;&nbsp;CONSTRAINT&nbsp;attr_id&nbsp;FOREIGN&nbsp;KEY&nbsp;(attr_id)&nbsp;REFERENCES&nbsp;goods_attr_key&nbsp;(id)&nbsp;ON&nbsp;DELETE&nbsp;RESTRICT&nbsp;ON&nbsp;UPDATE&nbsp;RESTRICT)&nbsp;ENGINE&nbsp;=&nbsp;InnoDB&nbsp;AUTO_INCREMENT&nbsp;=&nbsp;1&nbsp;CHARACTER&nbsp;SET&nbsp;=&nbsp;utf8&nbsp;COLLATE&nbsp;=&nbsp;utf8_general_ci&nbsp;COMMENT&nbsp;=&nbsp;&#39;å•†å“å±æ€§&#39;&nbsp;ROW_FORMAT&nbsp;=&nbsp;Dynamic; â€“&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”-â€“&nbsp;Table&nbsp;structure&nbsp;for&nbsp;goods_categoryâ€“&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”-DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;goods_category;CREATE&nbsp;TABLE&nbsp;goods_category&nbsp;&nbsp;(&nbsp;&nbsp;id&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;AUTO_INCREMENT,&nbsp;&nbsp;parent_id&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;çˆ¶çº§id&#39;,&nbsp;&nbsp;cate_name&nbsp;varchar(128)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL&nbsp;COMMENT&nbsp;&#39;åˆ†ç±»åç§°&#39;,&nbsp;&nbsp;sort&nbsp;tinyint(4)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;æ’åº&#39;,&nbsp;&nbsp;create_at&nbsp;timestamp(0)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;CURRENT_TIMESTAMP&nbsp;COMMENT&nbsp;&#39;åˆ›å»ºæ—¶é—´&#39;,&nbsp;&nbsp;PRIMARY&nbsp;KEY&nbsp;(id)&nbsp;USING&nbsp;BTREE)&nbsp;ENGINE&nbsp;=&nbsp;InnoDB&nbsp;AUTO_INCREMENT&nbsp;=&nbsp;1&nbsp;CHARACTER&nbsp;SET&nbsp;=&nbsp;utf8&nbsp;COLLATE&nbsp;=&nbsp;utf8_general_ci&nbsp;COMMENT&nbsp;=&nbsp;&#39;å•†å“åˆ†ç±»&#39;&nbsp;ROW_FORMAT&nbsp;=&nbsp;Dynamic; â€“&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”-â€“&nbsp;Table&nbsp;structure&nbsp;for&nbsp;goods_skuâ€“&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”-DROP&nbsp;TABLE&nbsp;IF&nbsp;EXISTS&nbsp;goods_sku;CREATE&nbsp;TABLE&nbsp;goods_sku&nbsp;&nbsp;(&nbsp;&nbsp;id&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;AUTO_INCREMENT,&nbsp;&nbsp;goods_id&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;å•†å“id&#39;,&nbsp;&nbsp;mid&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;åº—é“ºid&#39;,&nbsp;&nbsp;attr_ids&nbsp;varchar(512)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;&#39;&#39;&nbsp;COMMENT&nbsp;&#39;è§„æ ¼é›†åˆ&#39;,&nbsp;&nbsp;attr_names&nbsp;varchar(512)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;&#39;&#39;&nbsp;COMMENT&nbsp;&#39;å±æ€§é›†åˆ&#39;,&nbsp;&nbsp;goods_sku_sn&nbsp;varchar(64)&nbsp;CHARACTER&nbsp;SET&nbsp;utf8&nbsp;COLLATE&nbsp;utf8_general_ci&nbsp;NOT&nbsp;NULL&nbsp;COMMENT&nbsp;&#39;å•†å“skuç¼–ç &#39;,&nbsp;&nbsp;outer_price&nbsp;decimal(10,&nbsp;2)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0.00&nbsp;COMMENT&nbsp;&#39;å¤–éƒ¨ä»·æ ¼&nbsp;å•ä½ï¼šå…ƒ&#39;,&nbsp;&nbsp;inner_price&nbsp;decimal(10,&nbsp;2)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0.00&nbsp;COMMENT&nbsp;&#39;ä»·æ ¼&nbsp;å•ä½ï¼šå…ƒ&#39;,&nbsp;&nbsp;stock_num&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;å¯ç”¨åº“å­˜&#39;,&nbsp;&nbsp;dj_stock_num&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;å†»ç»“åº“å­˜&#39;,&nbsp;&nbsp;sale_num&nbsp;int(11)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;0&nbsp;COMMENT&nbsp;&#39;é”€é‡&#39;,&nbsp;&nbsp;create_at&nbsp;timestamp(0)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;CURRENT_TIMESTAMP&nbsp;COMMENT&nbsp;&#39;æ·»åŠ æ—¶é—´&#39;,&nbsp;&nbsp;update_at&nbsp;timestamp(0)&nbsp;NOT&nbsp;NULL&nbsp;DEFAULT&nbsp;CURRENT_TIMESTAMP&nbsp;ON&nbsp;UPDATE&nbsp;CURRENT_TIMESTAMP(0)&nbsp;COMMENT&nbsp;&#39;æ›´æ–°æ—¶é—´&#39;,&nbsp;&nbsp;PRIMARY&nbsp;KEY&nbsp;(id)&nbsp;USING&nbsp;BTREE,&nbsp;&nbsp;INDEX&nbsp;goods_id(goods_id)&nbsp;USING&nbsp;BTREE,&nbsp;&nbsp;CONSTRAINT&nbsp;goods_id_sku&nbsp;FOREIGN&nbsp;KEY&nbsp;(goods_id)&nbsp;REFERENCES&nbsp;goods&nbsp;(id)&nbsp;ON&nbsp;DELETE&nbsp;RESTRICT&nbsp;ON&nbsp;UPDATE&nbsp;RESTRICT)&nbsp;ENGINE&nbsp;=&nbsp;InnoDB&nbsp;AUTO_INCREMENT&nbsp;=&nbsp;1&nbsp;CHARACTER&nbsp;SET&nbsp;=&nbsp;utf8&nbsp;COLLATE&nbsp;=&nbsp;utf8_general_ci&nbsp;COMMENT&nbsp;=&nbsp;&#39;å•†å“sku&#39;&nbsp;ROW_FORMAT&nbsp;=&nbsp;Dynamic;å­—æ®µéƒ½æœ‰å¤‡æ³¨ï¼Œå°±ä¸ä¸€æ ·è¯´æ˜äº†ã€‚","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"åŸºäºredisçš„ç§’æ€","slug":"åŸºäºredisçš„ç§’æ€","date":"2018-08-09T14:43:58.000Z","updated":"2022-03-19T14:35:21.899Z","comments":true,"path":"2018/08/09/165/","link":"","permalink":"https://github.13sai.com/2018/08/09/165/","excerpt":"","text":"éšç€ç”µå•†ä¸šåŠ¡çš„å‘å±•ï¼Œç§’æ€æ˜¯ä¸ªååˆ†å¸¸è§çš„åœºæ™¯ï¼Œä»Šå¤©æˆ‘ä»¬æ¥åˆ©ç”¨rediså®ç°ä¸€ä¸ªç®€å•çš„ç§’æ€ç³»ç»Ÿã€‚ å‡å®šæˆ‘ä»¬æœ‰ä¸€ä¸ªå•†å“idä¸º1ï¼Œç§’æ€æ•°é‡æ˜¯5ã€‚ ä¸€èˆ¬åœºæ™¯ï¼š include &#x27;db.php&#x27;; $db = new db([ &#x27;database_type&#x27; =&gt; &#x27;mysql&#x27;, &#x27;database_name&#x27; =&gt; &#x27;test&#x27;, &#x27;server&#x27; =&gt; &#x27;www.13sai.com&#x27;, &#x27;username&#x27; =&gt; &#x27;13sai&#x27;, &#x27;password&#x27; =&gt; &#x27;*&#x27;, &#x27;charset&#x27; =&gt; &#x27;utf8&#x27; ]); $stock_num= $db-&gt;get(&#x27;goods&#x27;, &#x27;stock_num&#x27;, [&#x27;id&#x27; =&gt; 1]); // æ£€æµ‹åº“å­˜ if ($stock_num&gt; 0) &#123; sleep(1); //æ¨¡æ‹ŸçœŸå®ç¯å¢ƒ $db-&gt;update(&#x27;goods&#x27;, [&quot;stock_num[-]&quot; =&gt; 1], [&#x27;id&#x27; =&gt; 1]); print_r(&#x27;ok&#x27;) &#125; else &#123; print_r(&#x27;sorry&#x27;) &#125; æˆ‘ä»¬å°è¯•æ¨¡æ‹Ÿé«˜å¹¶å‘åœºæ™¯ï¼Œä½¿ç”¨abå‹æµ‹å·¥å…·ï¼Œ ab -n 500 -c 500 http://www.13sai.com/test/miaosha.php è¿è¡Œåå‘ç°åº“å­˜stock_numå¾ˆå¯èƒ½å·²ç»å˜æˆè´Ÿæ•°äº†ï¼Œå‡ºç°äº†è¶…å–é—®é¢˜ã€‚ å¼•å…¥redis //å®ä¾‹åŒ–redis $redis = new Redis(); //è¿æ¥ $redis-&gt;connect(&#x27;127.0.0.1&#x27;, 6379); $key = &#x27;sale&#x27;; //æ£€æµ‹æ˜¯å¦è¿æ¥æˆåŠŸ // echo &quot;Server is running: &quot; . $redis-&gt;ping(); $redis-&gt;setnx($key, 0); $redis-&gt;watch($key); //ç›‘æµ‹ä¸€ä¸ªkeyçš„å€¼æ˜¯å¦è¢«æ›´æ”¹ $sale_num = $redis-&gt;get($key); if ($sale_num &gt; 4) &#123; exit(); &#125; $redis-&gt;multi(); //æ ‡è®°äº‹åŠ¡ $redis-&gt;incr($key); //é”€é‡+1 sleep(1); //æ¨¡æ‹ŸçœŸå®ç¯å¢ƒ $ret = $redis-&gt;exec(); // äº‹åŠ¡å—å†…æ‰€æœ‰å‘½ä»¤çš„è¿”å›å€¼ï¼ŒæŒ‰å‘½ä»¤æ‰§è¡Œçš„å…ˆåé¡ºåºæ’åˆ—ã€‚ if ($ret) &#123; include &#x27;db.php&#x27;; $db = new db([ &#x27;database_type&#x27; =&gt; &#x27;mysql&#x27;, &#x27;database_name&#x27; =&gt; &#x27;test&#x27;, &#x27;server&#x27; =&gt; &#x27;www.13sai.com&amp;#39;, &#x27;username&#x27; =&gt; &#x27;13sai&#x27;, &#x27;password&#x27; =&gt; &#x27;*&#x27;, &#x27;charset&#x27; =&gt; &#x27;utf8&#x27; ]); $db-&gt;update(&#x27;goods&#x27;, [&quot;stock_num[-]&quot; =&gt; 1], [&#x27;id&#x27; =&gt; 1]); &#125; é‡æ–°å¢åŠ åº“å­˜åˆ°5ï¼Œå¤šæ¬¡æµ‹è¯•ï¼Œå‘ç°åº“å­˜å¹¶æ— å‡ºç°è´Ÿæ•°æƒ…å†µï¼Œæµ‹è¯•é€šè¿‡ã€‚","categories":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/categories/redis/"}],"tags":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/tags/redis/"}]},{"title":"LNMPç¯å¢ƒæ­å»º","slug":"LNMPç¯å¢ƒæ­å»º","date":"2018-07-29T12:45:43.000Z","updated":"2022-03-19T14:35:21.592Z","comments":true,"path":"2018/07/29/164/","link":"","permalink":"https://github.13sai.com/2018/07/29/164/","excerpt":"","text":"æœ€è¿‘å…¬å¸æœ‰æ–°é¡¹ç›®ä¸Šçº¿ï¼Œæ–°ä¹°äº†æœåŠ¡å™¨ï¼Œä¾¿éœ€è¦æ­å»ºç¯å¢ƒï¼Œä¾¿å®æ“äº†ä¸€ä¸‹ã€‚ lnmpåŒ…è£…lnmpçš„å®‰è£…æ—¶æ¯”è¾ƒè½»æ¾çš„ï¼Œä¸€è¡Œä»£ç ï¼Œ wget http://soft.vpser.net/lnmp/lnmp1.5.tar.gz -cO lnmp1.5.tar.gz &amp;&amp; tar zxf lnmp1.5.tar.gz &amp;&amp; cd lnmp1.5 &amp;&amp; ./install.sh lnmp ç„¶åä¼šæç¤ºä½ é€‰æ‹©çš„nginxç‰ˆæœ¬ï¼Œè¾“å…¥mysqlå¯†ç ï¼Œphpç‰ˆæœ¬ï¼Œé€‰æ‹©ä¹‹ååç­‰å®‰è£…ï¼Œå¤§æ¦‚éœ€è¦åŠä¸ªå°æ—¶ã€‚ å¦‚æœæ˜¾ç¤ºNginx: OKï¼ŒMySQL: OKï¼ŒPHP: OKã€‚å°±è¡¨ç¤ºå®‰è£…æˆåŠŸäº†ã€‚ æ‰©å±•å®‰è£…ï¼ˆä»¥redisæ‰©å±•ä¸ºä¾‹ï¼‰wget https://codeload.github.com/phpredis/phpredis/zip/develop -O phpredis.zip unzip phpredis.zip cd /phpredis-develop /usr/local/php/bin/phpize./configure --with-php-config=/usr/local/php/bin/php-config make &amp;&amp; make install //ç¼–è¯‘å®‰è£… åœ¨php.iniä¸­åŠ å…¥ extension=redis.so é‡å¯php-fpmï¼Œé€šè¿‡php -må‘½ä»¤æŸ¥çœ‹ æœ€è¿‘å…¬å¸æœ‰æ–°é¡¹ç›®ä¸Šçº¿ï¼Œæ–°ä¹°äº†æœåŠ¡å™¨ï¼Œä¾¿éœ€è¦æ­å»ºç¯å¢ƒï¼Œä¾¿å®æ“äº†ä¸€ä¸‹ã€‚lnmpåŒ…è£…lnmpçš„å®‰è£…æ—¶æ¯”è¾ƒè½»æ¾çš„ï¼Œä¸€è¡Œä»£ç ï¼Œwget&nbsp;http://soft.vpser.net/lnmp/lnmp1.5.tar.gz&nbsp;-cO&nbsp;lnmp1.5.tar.gz&nbsp;&amp;&amp;&nbsp;tar&nbsp;zxf&nbsp;lnmp1.5.tar.gz&nbsp;&amp;&amp;&nbsp;cd&nbsp;lnmp1.5&nbsp;&amp;&amp;&nbsp;./install.sh&nbsp;lnmpç„¶åä¼šæç¤ºä½ é€‰æ‹©çš„nginxç‰ˆæœ¬ï¼Œè¾“å…¥mysqlå¯†ç ï¼Œphpç‰ˆæœ¬ï¼Œé€‰æ‹©ä¹‹ååç­‰å®‰è£…ï¼Œå¤§æ¦‚éœ€è¦åŠä¸ªå°æ—¶ã€‚å¦‚æœæ˜¾ç¤ºNginx: OKï¼ŒMySQL: OKï¼ŒPHP: OKã€‚å°±è¡¨ç¤ºå®‰è£…æˆåŠŸäº†ã€‚2. æ‰©å±•å®‰è£…ï¼ˆä»¥redisæ‰©å±•ä¸ºä¾‹ï¼‰wget&nbsp;https://codeload.github.com/phpredis/phpredis/zip/develop&nbsp;-O&nbsp;phpredis.zip unzip&nbsp;phpredis.zip cd&nbsp;/phpredis-develop /usr/local/php/bin/phpize./configure&nbsp;--with-php-config=/usr/local/php/bin/php-config make&nbsp;&amp;&amp;&nbsp;make&nbsp;install&nbsp;&nbsp;&nbsp;//ç¼–è¯‘å®‰è£…åœ¨php.iniä¸­åŠ å…¥extension=redis.soé‡å¯php-fpmï¼Œé€šè¿‡php -må‘½ä»¤æŸ¥çœ‹ã€‚","categories":[{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"}],"tags":[{"name":"LNMP","slug":"LNMP","permalink":"https://github.13sai.com/tags/LNMP/"}]},{"title":"ä¸¤ä¸ªå…³äºLinuxçš„é—®é¢˜","slug":"ä¸¤ä¸ªå…³äºLinuxçš„é—®é¢˜","date":"2018-07-06T12:57:18.000Z","updated":"2022-05-06T09:00:52.017Z","comments":true,"path":"2018/07/06/163/","link":"","permalink":"https://github.13sai.com/2018/07/06/163/","excerpt":"","text":"æœ€è¿‘æœ‰ç‚¹å¿™ï¼Œä¸€ä¼šä¸‹ç­ï¼Œä¹Ÿä¸æƒ³æ•²ä»£ç äº†ï¼Œå†™å†™å‰æ®µæ—¶é—´é‡åˆ°çš„ä¸¤ä¸ªå…³äºLinuxçš„é—®é¢˜ã€‚è™½ç„¶ä¸¤ä¸ªé—®é¢˜éƒ½æ˜¯åŒäº‹è§£å†³çš„ï¼Œä½†æœ‰å¿…è¦åˆ†äº«ä¸€ä¸‹ã€‚ OOM OOM killerï¼ˆOut-Of-Memory killerï¼‰ï¼Œè¯¥æœºåˆ¶ä¼šç›‘æ§é‚£äº›å ç”¨å†…å­˜è¿‡å¤§ï¼Œå°¤å…¶æ˜¯ç¬é—´å¾ˆå¿«æ¶ˆè€—å¤§é‡å†…å­˜çš„è¿›ç¨‹ï¼Œä¸ºäº†é˜²æ­¢å†…å­˜è€—å°½è€Œå†…æ ¸ä¼šæŠŠè¯¥è¿›ç¨‹æ€æ‰ã€‚ èµ·å› ï¼šå¯¼å‡ºç›¸å½“å¤§çš„æ•°æ®æ—¶å¯¼è‡´å†…å­˜æº¢å‡ºçš„é—®é¢˜ï¼ŒæœåŠ¡å™¨è´Ÿè½½å¾ˆå¤§ï¼Œç„¶åOOMè¿™ä¸ªè¿›ç¨‹æ¯æ¬¡å°±æŠŠæˆ‘å¯¼å‡ºçš„è¿›ç¨‹å¹²è¶´ä¸‹äº†ã€‚ æ–‡ä»¶æœ€å¤§æ‰“å¼€æ•°ulimit -n //æŸ¥çœ‹æ–‡ä»¶æœ€å¤§æ‰“å¼€æ•° lsof |wc -l //å½“å‰æ–‡ä»¶æ‰“å¼€æ•°é‡ èµ·å› ï¼šå®ˆæŠ¤è¿›ç¨‹é‡Œæœ‰ä¸ªç¨‹åºï¼Œä¸€ç›´åœ¨fopenï¼Œå¯¼è‡´æ–‡ä»¶æ‰“å¼€æ•°è¿‡å¤§ï¼ŒæœåŠ¡å™¨æŒ‚æ‰äº†ã€‚ è§£å†³æ–¹æ¡ˆæ¯”è¾ƒç®€å•ï¼Œå°±ä¸èµ˜è¿°äº†ã€‚","categories":[{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/tags/Linux/"}]},{"title":"PHPä¸¤ä¸ªå¥½ç”¨çš„å‡½æ•°å¤„ç†å‡½æ•°","slug":"PHPä¸¤ä¸ªå¥½ç”¨çš„å‡½æ•°å¤„ç†å‡½æ•°","date":"2018-06-13T07:36:49.000Z","updated":"2022-03-19T14:35:21.627Z","comments":true,"path":"2018/06/13/161/","link":"","permalink":"https://github.13sai.com/2018/06/13/161/","excerpt":"","text":"call_user_func â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨demo: function&nbsp;increment($var){&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;hello&nbsp;&#39;.$var;}$a&nbsp;=&nbsp;&#39;13sai&#39;;call_user_func(&#39;increment&#39;,&nbsp;$a); class&nbsp;A{&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;increment($var)&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;hello&nbsp;&#39;.$var;&nbsp;&nbsp;&nbsp;&nbsp;}} $a&nbsp;=&nbsp;&#39;world&#39;;call_user_func([(new&nbsp;A()),&nbsp;&#39;increment&#39;],&nbsp;$a);call_user_func_array â€” è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œå¹¶æŠŠä¸€ä¸ªæ•°ç»„å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°&lt;?phpfunction&nbsp;foobar($arg,&nbsp;$arg2)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;FUNCTION,&nbsp;&quot;&nbsp;got&nbsp;$arg&nbsp;and&nbsp;$arg2&quot;;}class&nbsp;foo&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;bar($arg,&nbsp;$arg2)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;METHOD,&nbsp;&quot;&nbsp;got&nbsp;$arg&nbsp;and&nbsp;$arg2&quot;;&nbsp;&nbsp;&nbsp;&nbsp;}} //&nbsp;Call&nbsp;the&nbsp;foobar()&nbsp;function&nbsp;with&nbsp;2&nbsp;argumentscall_user_func_array(&quot;foobar&quot;,&nbsp;array(&quot;one&quot;,&nbsp;&quot;two&quot;)); //&nbsp;Call&nbsp;the&nbsp;$foo-&gt;bar()&nbsp;method&nbsp;with&nbsp;2&nbsp;arguments$foo&nbsp;=&nbsp;new&nbsp;foo;call_user_func_array(array($foo,&nbsp;&quot;bar&quot;),&nbsp;array(&quot;three&quot;,&nbsp;&quot;four&quot;));è¯´åˆ°è¿™é‡Œï¼Œå¯ä»¥çœ‹çœ‹å¯å˜å‚æ•°å‡½æ•°(5.6+)&lt;?phpfunction&nbsp;sum(...$numbers)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;$acc&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($numbers&nbsp;as&nbsp;$n)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acc&nbsp;+=&nbsp;$n;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$acc;} echo&nbsp;sum(1,&nbsp;2,&nbsp;3,&nbsp;4,&nbsp;5);é‡ç‚¹æ¥äº†ï¼Œå½“å¯å˜å‚æ•°é•¿åº¦å‡½æ•°é‡ä¸Šcall_user_func_arrayè¯•æƒ³ï¼Œæˆ‘ä»¬å¸Œæœ›ä¼ å…¥ä¸å®šé•¿åº¦å‚æ•°ï¼Œè€Œå‚æ•°åˆåªæ˜¯æ•°ç»„ã€‚é‚£ä¹ˆä½ å¯ä»¥è¿™ä¹ˆåšï¼šfunction&nbsp;sum(...$numbers)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;$acc&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($numbers&nbsp;as&nbsp;$n)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$acc&nbsp;+=&nbsp;$n;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$acc;} print_r(call_user_func_array(&quot;sum&quot;,&nbsp;[7,8,9,10]));å¥½äº†ï¼Œthat&#39;s all!","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"å…³äºå¤§è¡¨æŸ¥è¯¢æœ€åå‡ é¡µè¿‡æ…¢çš„åŸå› ","slug":"å…³äºå¤§è¡¨æŸ¥è¯¢æœ€åå‡ é¡µè¿‡æ…¢çš„åŸå› ","date":"2018-05-31T04:09:16.000Z","updated":"2022-03-19T14:35:21.861Z","comments":true,"path":"2018/05/31/157/","link":"","permalink":"https://github.13sai.com/2018/05/31/157/","excerpt":"","text":"mysqlæ•°æ®é‡å¾ˆå¤§ä½¿ç”¨limitæŸ¥è¯¢æœ€åå‡ é¡µå¾ˆæ…¢ï¼Œä½ çŸ¥é“åŸå› ä¹ˆï¼Ÿ æˆ‘ä»¬ä¸å¦¨å…ˆæ¥çœ‹çœ‹å‡ æ¡æŸ¥è¯¢è¯­å¥ä¸ç»“æœã€‚ select * from test_user where id&gt;9900000 limit 0,10; select * from test_user limit 9900000,10; select * from test_user where id in (select b.id from (select id from test_user where id&gt;9900000 limit 0,10) as b); //å­æŸ¥è¯¢ [SQL]select * from test_user where id&gt;9900000 limit 0,10; å—å½±å“çš„è¡Œ: 0 æ—¶é—´: 0.019s [SQL] select * from test_user limit 9900000,10; å—å½±å“çš„è¡Œ: 0 æ—¶é—´: 1.147s [SQL] select * from test_user where id in (select b.id from (select id from test_user where id&gt;9900000 limit 0,10) as b); å—å½±å“çš„è¡Œ: 0 æ—¶é—´: 0.001s å…¶å®ï¼ŒåŸå› å°±åœ¨äºï¼š limit10000,20çš„æ„æ€æ‰«ææ»¡è¶³æ¡ä»¶çš„10020è¡Œï¼Œæ‰”æ‰å‰é¢çš„10000è¡Œï¼Œè¿”å›æœ€åçš„20è¡Œï¼Œé—®é¢˜å°±åœ¨è¿™é‡Œã€‚ è§£å†³æ–¹æ¡ˆï¼š è¿‡ä¸€åŠæ•°æ®é‡‡ç”¨å€’åºæŸ¥è¯¢ è¿ç”¨å­æŸ¥è¯¢","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"ArrayAccessï¼ˆæ•°ç»„å¼è®¿é—®ï¼‰æ¥å£","slug":"ArrayAccessï¼ˆæ•°ç»„å¼è®¿é—®ï¼‰æ¥å£","date":"2018-05-09T08:52:23.000Z","updated":"2022-03-19T14:35:21.568Z","comments":true,"path":"2018/05/09/154/","link":"","permalink":"https://github.13sai.com/2018/05/09/154/","excerpt":"","text":"ArrayAccessæä¾›åƒè®¿é—®æ•°ç»„ä¸€æ ·è®¿é—®å¯¹è±¡çš„èƒ½åŠ›çš„æ¥å£ã€‚å…·ä½“æœ‰ä¸€ä¸‹å‡ ä¸ªæ–¹æ³•ï¼šArrayAccess&nbsp;{ /*&nbsp;æ–¹æ³•&nbsp;*/ abstract&nbsp;public&nbsp;boolean&nbsp;offsetExists&nbsp;(&nbsp;mixed&nbsp;$offset&nbsp;) abstract&nbsp;public&nbsp;mixed&nbsp;offsetGet&nbsp;(&nbsp;mixed&nbsp;$offset&nbsp;) abstract&nbsp;public&nbsp;void&nbsp;offsetSet&nbsp;(&nbsp;mixed&nbsp;$offset&nbsp;,&nbsp;mixed&nbsp;$value&nbsp;) abstract&nbsp;public&nbsp;void&nbsp;offsetUnset&nbsp;(&nbsp;mixed&nbsp;$offset&nbsp;) }æ–‡æ¡£çœ‹æ‰‹å†Œ&nbsp;ArrayAccessï¼ˆæ•°ç»„å¼è®¿é—®ï¼‰æ¥å£è°ƒç”¨æƒ…å†µçœ‹å®ä¾‹ï¼š&lt;?php /** &nbsp;*&nbsp;@author&nbsp;13sai &nbsp;*/ class&nbsp;TestAccess&nbsp;implements&nbsp;ArrayAccess&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$data&nbsp;=&nbsp;[]; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__get($key)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_r(__METHOD__); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;data[$key]; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__set($key,$value)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_r(__METHOD__); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data[$key]&nbsp;=&nbsp;$value; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__isset($key)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_r(__METHOD__); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;isset($this-&gt;data[$key]); &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__unset($key)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_r(__METHOD__); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset($this-&gt;data[$key]); &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;offsetSet($offset,$value)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_r(METHOD);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(is_null($offset))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data[]&nbsp;=&nbsp;$value;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data[$offset]&nbsp;=&nbsp;$value;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;offsetGet($offset)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_r(METHOD);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$this-&gt;offsetExists($offset)&nbsp;?&nbsp;$this-&gt;data[$offset]&nbsp;:&nbsp;null;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;offsetExists($offset)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_r(METHOD);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;isset($this-&gt;data[$offset]);&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;offsetUnset($offset)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_r(METHOD);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($this-&gt;offsetExists($offset))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset($this-&gt;data[$offset]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;} } $animal&nbsp;=&nbsp;new&nbsp;TestAccess();echo(&#39;&lt;br&gt;1.&#39;);var_dump(empty($animal-&gt;dog)); echo(&#39;&lt;br&gt;2.&#39;);var_dump(empty($animal[&#39;pig&#39;])); echo(&#39;&lt;br&gt;3.&#39;);$animal-&gt;dog&nbsp;=&nbsp;&#39;dog&#39;; echo(&#39;&lt;br&gt;4.&#39;);$animal[&#39;pig&#39;]&nbsp;=&nbsp;&#39;pig&#39;; echo(&#39;&lt;br&gt;13.&#39;);var_dump(empty($animal-&gt;dog)); echo(&#39;&lt;br&gt;14.&#39;);var_dump(empty($animal[&#39;pig&#39;])); echo(&#39;&lt;br&gt;5.&#39;);var_dump(isset($animal-&gt;dog)); echo(&#39;&lt;br&gt;6.&#39;);var_dump(isset($animal[&#39;pig&#39;])); echo(&#39;&lt;br&gt;7.&#39;);var_dump($animal-&gt;pig); echo(&#39;&lt;br&gt;8.&#39;);var_dump($animal[&#39;dog&#39;]); echo(&#39;&lt;br&gt;9.&#39;);unset($animal[&#39;dog&#39;]); echo(&#39;&lt;br&gt;10.&#39;);unset($animal-&gt;pig); echo(&#39;&lt;br&gt;11.&#39;);var_dump($animal[&#39;pig&#39;]); echo(&#39;&lt;br&gt;12.&#39;);var_dump($animal-&gt;dog);è¾“å‡ºè°ƒç”¨å¯è¿è¡Œï¼Œä¸€çœ‹ä¾¿çŸ¥ï¼1.TestAccess::__issetD:\\project est\u0007ccess.php:126:boolean&nbsp;true 2.TestAccess::offsetExistsD:\\project est\u0007ccess.php:129:boolean&nbsp;true 3.TestAccess::__set4.TestAccess::offsetSet13.TestAccess::__issetTestAccess::__getD:\\project est\u0007ccess.php:139:boolean&nbsp;false 14.TestAccess::offsetExistsTestAccess::offsetGetTestAccess::offsetExistsD:\\project est\u0007ccess.php:142:boolean&nbsp;false 5.TestAccess::__issetD:\\project est\u0007ccess.php:145:boolean&nbsp;true 6.TestAccess::offsetExistsD:\\project est\u0007ccess.php:148:boolean&nbsp;true 7.TestAccess::__getD:\\project est\u0007ccess.php:151:string&nbsp;&#39;pig&#39;&nbsp;(length=3) 8.TestAccess::offsetGetTestAccess::offsetExistsD:\\project est\u0007ccess.php:154:string&nbsp;&#39;dog&#39;&nbsp;(length=3) 9.TestAccess::offsetUnsetTestAccess::offsetExists10.TestAccess::__unset11.TestAccess::offsetGetTestAccess::offsetExistsD:\\project est\u0007ccess.php:163:null 12.TestAccess::__get(&nbsp;!&nbsp;)&nbsp;Notice:&nbsp;Undefined&nbsp;index:&nbsp;dog&nbsp;in&nbsp;D:\\project est\u0007ccess.php&nbsp;on&nbsp;line&nbsp;26Call&nbsp;Stack Time Memory Function Location1 0.2010 384480 {main}(&nbsp;) â€¦\u0007ccess.php:02 0.2010 385368 TestAccess-&gt;__get(&nbsp;string(3)&nbsp;) â€¦\u0007ccess.php:166&nbsp;D:\\project est\u0007ccess.php:166:null","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"gitè§£å†³æ€»è¦è¾“å…¥å¯†ç çš„é—®é¢˜","slug":"gitè§£å†³æ€»è¦è¾“å…¥å¯†ç çš„é—®é¢˜","date":"2018-05-09T06:56:28.000Z","updated":"2022-03-19T14:35:21.688Z","comments":true,"path":"2018/05/09/153/","link":"","permalink":"https://github.13sai.com/2018/05/09/153/","excerpt":"","text":"ä¹‹å‰æ¯æ¬¡pullå’Œpushæ€»è¦è¾“å…¥å¯†ç ï¼Œç¹çã€‚æ“ä½œä¸¤æ­¥ï¼Œè§£å†³é—®é¢˜ï¼ç”Ÿæˆå…¬é’¥cd&nbsp;~/.ssh ssh-keygen&nbsp;-t&nbsp;rsa&nbsp;-C&nbsp;&quot;æ³¨é‡Š&quot;æ‹·è´å…¬é’¥åˆ°è¿œç¨‹ä¸»æœºssh-copy-id&nbsp;git@xxx.comokï¼","categories":[{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"}],"tags":[{"name":"git","slug":"git","permalink":"https://github.13sai.com/tags/git/"}]},{"title":"mysqlè§¦å‘å™¨","slug":"mysqlè§¦å‘å™¨","date":"2018-04-18T05:40:41.000Z","updated":"2022-03-19T14:35:21.771Z","comments":true,"path":"2018/04/18/152/","link":"","permalink":"https://github.13sai.com/2018/04/18/152/","excerpt":"","text":"å»å¹´å¹´åº•åšæ–°åŠŸèƒ½æ—¶è€ƒè™‘ä½¿ç”¨è§¦å‘å™¨ï¼Œæ¥èŠèŠè§¦å‘å™¨ã€‚ è§¦å‘å™¨æ˜¯ä¸è¡¨æœ‰å…³çš„æ•°æ®åº“å¯¹è±¡ï¼Œåœ¨æ»¡è¶³å®šä¹‰æ¡ä»¶æ—¶è§¦å‘ï¼Œå¹¶æ‰§è¡Œè§¦å‘å™¨ä¸­å®šä¹‰çš„è¯­å¥é›†åˆã€‚è§¦å‘å™¨çš„è¿™ç§ç‰¹æ€§å¯ä»¥ååŠ©åº”ç”¨åœ¨æ•°æ®åº“ç«¯ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€‚ DELIMITER;;//å®šä¹‰ç»“æŸç¬¦ CREATE TRIGGER `updateData` AFTER UPDATE ON `buyer` FOR EACH ROW begin set @phone = right(new.phone,11); // å–æ‰‹æœºå· set @main_id = (select id from main where u_id = new.u_id); // ä»è¡¨mainå–id set @new_last_trade_time = IF( UNIX_TIMESTAMP(new.last_trade_time) &amp;gt; @old_last_trade_time, UNIX_TIMESTAMP(new.last_trade_time), @old_last_trade_time); set @add_trade_count = (new.trade_count - old.trade_count); set @add_trade_amount = (new.trade_amount - old.trade_amount); // æ›´æ–°æ“ä½œ update member set trade_count=trade_count+@add_trade_count, trade_amount=trade_amount+@add_trade_amount, last_trade_time=@new_last_trade_time where main_id = @main_id and phone = @phone; end ;; DELIMITER ; æ€§èƒ½é—®é¢˜ï¼š é€šè¿‡æµ‹è¯•ï¼Œè‹¥æˆ‘æ¯ç§’é’Ÿå‘æ•°æ®åº“ä¸­æ’å…¥700æ¡å·¦å³çš„å‘Šè­¦ä¿¡æ¯ï¼Œæ­¤æ—¶è‹¥ä½¿ç”¨è§¦å‘å™¨ï¼Œæ¯ç§’ä¸­åªä¼šæ’å…¥æ•°æ®åº“ä¸­50å·¦å³ï¼Œè‹¥ä¸å¼€å¯è§¦å‘å™¨ï¼Œé‚£ä¹ˆ700æ¡å…¨éƒ¨å¯ä»¥æ’å…¥æ•°æ®åº“ä¸­ã€‚ï¼ˆæ¥è‡ªç½‘ç»œï¼‰","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"phpçš„redisæ“ä½œ","slug":"phpçš„redisæ“ä½œ","date":"2018-03-22T03:37:19.000Z","updated":"2022-03-19T14:35:21.791Z","comments":true,"path":"2018/03/22/151/","link":"","permalink":"https://github.13sai.com/2018/03/22/151/","excerpt":"","text":"1. è¿æ¥redis&lt;?php&nbsp; &nbsp;&nbsp;&nbsp;$redis&nbsp;=&nbsp;new&nbsp;Redis();&nbsp; &nbsp;&nbsp;&nbsp;$redis-&gt;connect(&#39;127.0.0.1&#39;,&nbsp;6379);&nbsp; &nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Connection&nbsp;to&nbsp;server&nbsp;sucessfully&quot;;&nbsp; &nbsp;&nbsp;&nbsp;echo&nbsp;&quot;Server&nbsp;is&nbsp;running:&nbsp;&quot;.$redis-&gt;ping();&nbsp; ?&gt;2. String ç±»å‹æ“ä½œ$redis-&gt;set(&#39;key&#39;,&#39;TK&#39;); $redis-&gt;set(&#39;number&#39;,&#39;1&#39;); $redis-&gt;setex(&#39;key&#39;,5,&#39;TK&#39;);&nbsp;//è®¾ç½®æœ‰æ•ˆæœŸä¸º5ç§’çš„é”®å€¼ $redis-&gt;psetex(&#39;key&#39;,5000,&#39;TK&#39;);&nbsp;//è®¾ç½®æœ‰æ•ˆæœŸä¸º5000æ¯«ç§’(åŒ5ç§’)çš„é”®å€¼ $redis-&gt;setnx(&#39;key&#39;,&#39;XK&#39;);&nbsp;//è‹¥é”®å€¼å­˜åœ¨è¿”å›false&nbsp;ä¸å­˜åœ¨è¿”å›true $redis-&gt;delete(&#39;key&#39;);&nbsp;åˆ é™¤é”®å€¼&nbsp;å¯ä»¥ä¼ å…¥æ•°ç»„&nbsp;array(&#39;key1&#39;,&#39;key2&#39;)åˆ é™¤å¤šä¸ªé”® $redis-&gt;getSet(&#39;key&#39;,&#39;XK&#39;);&nbsp;//å°†é”®keyçš„å€¼è®¾ç½®ä¸ºXKï¼Œ&nbsp;å¹¶è¿”å›è¿™ä¸ªé”®å€¼åŸæ¥çš„å€¼TK $ret&nbsp;=&nbsp;$redis-&gt;multi()&nbsp;&nbsp;//æ‰¹é‡äº‹åŠ¡å¤„ç†,ä¸ä¿è¯å¤„ç†æ•°æ®çš„åŸå­æ€§&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;set(&#39;key1&#39;,&nbsp;&#39;val1&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;get(&#39;key1&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setnx(&#39;key&#39;,&nbsp;&#39;val2&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;get(&#39;key2&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;exec();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$redis-&gt;watch(&#39;key&#39;);&nbsp;&nbsp;&nbsp;//&nbsp;ç›‘æ§é”®key&nbsp;æ˜¯å¦è¢«å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¦‚æœKEYåœ¨è°ƒç”¨watch()å’Œexec()ä¹‹é—´è¢«ä¿®æ”¹ï¼Œexecå¤±è´¥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $redis-&gt;subscribe(array(&#39;chan-1&#39;,&nbsp;&#39;chan-2&#39;,&nbsp;&#39;chan-3&#39;),&nbsp;&#39;f&#39;);&nbsp;//&nbsp;subscribe&nbsp;to&nbsp;3&nbsp;chans $redis-&gt;publish(&#39;chan-1&#39;,&nbsp;&#39;hello,&nbsp;world!&#39;);&nbsp;//&nbsp;send&nbsp;message.&nbsp;$redis-&gt;exists(&#39;key&#39;);&nbsp;//éªŒè¯é”®æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨è¿”å›true$redis-&gt;incr(&#39;number&#39;);&nbsp;//é”®å€¼åŠ 1$redis-&gt;incrby(&#39;number&#39;,-10);&nbsp;//é”®å€¼åŠ å‡10$redis-&gt;incrByFloat(&#39;number&#39;,&nbsp;+/-&nbsp;1.5);&nbsp;//é”®å€¼åŠ å‡å°æ•°$redis-&gt;decr(&#39;number&#39;);&nbsp;//&nbsp;é”®å€¼å‡1$redis-&gt;decrBy(&#39;number&#39;,10);&nbsp;//&nbsp;é”®å€¼å‡10$mget&nbsp;=&nbsp;$redis-&gt;mget(array(&#39;number&#39;,&#39;key&#39;));&nbsp;//&nbsp;æ‰¹é‡è·å–é”®å€¼,è¿”å›ä¸€ä¸ªæ•°ç»„$redis-&gt;mset(array(&#39;key0&#39;&nbsp;=&gt;&nbsp;&#39;value0&#39;,&nbsp;&#39;key1&#39;&nbsp;=&gt;&nbsp;&#39;value1&#39;));&nbsp;//&nbsp;æ‰¹é‡è®¾ç½®é”®å€¼$redis-&gt;msetnx(array(&#39;key0&#39;&nbsp;=&gt;&nbsp;&#39;value0&#39;,&nbsp;&#39;key1&#39;&nbsp;=&gt;&nbsp;&#39;value1&#39;));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;æ‰¹é‡è®¾ç½®é”®å€¼ï¼Œç±»ä¼¼å°†setnx()æ–¹æ³•æ‰¹é‡æ“ä½œ$redis-&gt;append(&#39;key&#39;,&nbsp;&#39;-Smudge&#39;);&nbsp;//åŸé”®å€¼TKï¼Œå°†å€¼è¿½åŠ åˆ°é”®å€¼åé¢ï¼Œé”®å€¼ä¸ºTK-Smudge$redis-&gt;getRange(&#39;key&#39;,&nbsp;0,&nbsp;5);&nbsp;//&nbsp;é”®å€¼æˆªå–ä»0ä½ç½®å¼€å§‹åˆ°5ä½ç½®ç»“æŸ$redis-&gt;getRange(&#39;key&#39;,&nbsp;-6,&nbsp;-1);&nbsp;//&nbsp;å­—ç¬¦ä¸²æˆªå–ä»-6(å€’æ•°ç¬¬6ä½ç½®)å¼€å§‹åˆ°-1(å€’æ•°ç¬¬1ä½ç½®)ç»“æŸ$redis-&gt;setRange(&#39;key&#39;,&nbsp;0,&nbsp;&#39;Smudge&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;é”®å€¼ä¸­æ›¿æ¢å­—ç¬¦ä¸²ï¼Œ0è¡¨ç¤ºä»0ä½ç½®å¼€å§‹,&nbsp;&nbsp;æœ‰å¤šå°‘ä¸ªå­—ç¬¦æ›¿æ¢å¤šå°‘ä½ç½®ï¼Œå…¶ä¸­æ±‰å­—å 2ä¸ªä½ç½®$redis-&gt;strlen(&#39;key&#39;);&nbsp;//é”®å€¼é•¿åº¦$redis-&gt;getBit(&#39;key&#39;);$redis-&gt;setBit(&#39;key&#39;);3. é“¾è¡¨æ“ä½œ$redis-&gt;delete(&#39;list-key&#39;);&nbsp;//&nbsp;åˆ é™¤é“¾è¡¨$redis-&gt;lPush(&#39;list-key&#39;,&nbsp;&#39;A&#39;);&nbsp;//æ’å…¥é“¾è¡¨å¤´éƒ¨/å·¦ä¾§ï¼Œè¿”å›é“¾è¡¨é•¿åº¦$redis-&gt;rPush(&#39;list-key&#39;,&nbsp;&#39;B&#39;);&nbsp;//æ’å…¥é“¾è¡¨å°¾éƒ¨/å³ä¾§ï¼Œè¿”å›é“¾è¡¨é•¿åº¦$redis-&gt;lPushx(&#39;list-key&#39;,&nbsp;&#39;C&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;æ’å…¥é“¾è¡¨å¤´éƒ¨/å·¦ä¾§,é“¾è¡¨ä¸å­˜åœ¨è¿”å›0ï¼Œå­˜åœ¨å³æ’å…¥æˆåŠŸï¼Œè¿”å›å½“å‰é“¾è¡¨é•¿åº¦$redis-&gt;rPushx(&#39;list-key&#39;,&nbsp;&#39;C&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;æ’å…¥é“¾è¡¨å°¾éƒ¨/å³ä¾§,é“¾è¡¨ä¸å­˜åœ¨è¿”å›0ï¼Œå­˜åœ¨å³æ’å…¥æˆåŠŸï¼Œè¿”å›å½“å‰é“¾è¡¨é•¿åº¦$redis-&gt;lPop(&#39;list-key&#39;);&nbsp;//è¿”å›LISTé¡¶éƒ¨ï¼ˆå·¦ä¾§ï¼‰çš„VALUE&nbsp;,åå…¥å…ˆå‡º(æ ˆ)$redis-&gt;rPop(&#39;list-key&#39;);&nbsp;//è¿”å›LISTå°¾éƒ¨ï¼ˆå³ä¾§ï¼‰çš„VALUE&nbsp;,å…ˆå…¥å…ˆå‡ºï¼ˆé˜Ÿåˆ—ï¼‰$redis-&gt;blPop();$redis-&gt;brPop();$redis-&gt;lSize(&#39;list-key&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;å¦‚æœæ˜¯é“¾è¡¨åˆ™è¿”å›é“¾è¡¨é•¿åº¦ï¼Œç©ºé“¾è¡¨è¿”å›0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;è‹¥ä¸æ˜¯é“¾è¡¨æˆ–è€…ä¸ä¸ºç©ºï¼Œåˆ™è¿”å›false&nbsp;,åˆ¤æ–­éé“¾è¡¨&nbsp;&quot;&nbsp;===&nbsp;false&nbsp;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$redis-&gt;lGet(&#39;list-key&#39;,-1);&nbsp;//&nbsp;é€šè¿‡ç´¢å¼•è·å–é“¾è¡¨å…ƒç´ &nbsp;0è·å–å·¦ä¾§ä¸€ä¸ª&nbsp;&nbsp;-1è·å–æœ€åä¸€ä¸ª$redis-&gt;lSet(&#39;list-key&#39;,&nbsp;0,&nbsp;&#39;X&#39;);&nbsp;//0ä½ç½®å…ƒç´ æ›¿æ¢ä¸º&nbsp;X$redis-&gt;lRange(&#39;list-key&#39;,&nbsp;0,&nbsp;3);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//é“¾è¡¨æˆªå–&nbsp;ä»0å¼€å§‹&nbsp;3ä½ç½®ç»“æŸ&nbsp;ï¼Œç»“æŸä½ç½®ä¸º-1&nbsp;è·å–å¼€å§‹ä½ç½®ä¹‹åçš„å…¨éƒ¨$redis-&gt;lTrim(&#39;list-key&#39;,&nbsp;0,&nbsp;1);&nbsp;//&nbsp;æˆªå–é“¾è¡¨(ä¸å¯é€†)&nbsp;ä»0ç´¢å¼•å¼€å§‹&nbsp;1ç´¢å¼•ç»“æŸ&nbsp;$redis-&gt;lRem(&#39;list-key&#39;,&nbsp;&#39;C&#39;,&nbsp;2);&nbsp;//é“¾è¡¨ä»å·¦å¼€å§‹åˆ é™¤å…ƒç´ 2ä¸ªC$redis-&gt;lInsert(&#39;list-key&#39;,&nbsp;Redis::BEFORE,&nbsp;&#39;C&#39;,&nbsp;&#39;X&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;åœ¨Cå…ƒç´ å‰é¢æ’å…¥X&nbsp;&nbsp;,&nbsp;Redis::AfTER(è¡¨ç¤ºåé¢æ’å…¥)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;é“¾è¡¨ä¸å­˜åœ¨åˆ™æ’å…¥å¤±è´¥&nbsp;è¿”å›0&nbsp;è‹¥å…ƒç´ ä¸å­˜åœ¨è¿”å›-1$redis-&gt;rpoplpush(&#39;list-key&#39;,&nbsp;&#39;list-key2&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//ä»æºLISTçš„æœ€åå¼¹å‡ºä¸€ä¸ªå…ƒç´ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¹¶ä¸”æŠŠè¿™ä¸ªå…ƒç´ ä»ç›®æ ‡LISTçš„é¡¶éƒ¨ï¼ˆå·¦ä¾§ï¼‰å‹å…¥ç›®æ ‡LISTã€‚&nbsp;$redis-&gt;brpoplpush();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//rpoplpushçš„é˜»å¡ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬æœ‰ç¬¬ä¸‰ä¸ªå‚æ•°ç”¨äºè®¾ç½®é˜»å¡æ—¶é—´&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å³å¦‚æœæºLISTä¸ºç©ºï¼Œé‚£ä¹ˆå¯ä»¥é˜»å¡ç›‘å¬timeoutçš„æ—¶é—´ï¼Œå¦‚æœæœ‰å…ƒç´ äº†åˆ™æ‰§è¡Œæ“ä½œã€‚4. æ— åºç±»å‹setæ— åºé›†åˆ&nbsp;ä¸å…è®¸å‡ºç°é‡å¤çš„å…ƒç´ &nbsp;æœåŠ¡ç«¯å¯ä»¥å®ç°å¤šä¸ª&nbsp;é›†åˆæ“ä½œ$redis-&gt;sMembers(&#39;key&#39;);&nbsp;//è·å–å®¹å™¨keyä¸­æ‰€æœ‰å…ƒç´ $redis-&gt;sAdd(&#39;key&#39;&nbsp;,&nbsp;&#39;TK&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;(ä»å·¦ä¾§æ’å…¥,æœ€åæ’å…¥çš„å…ƒç´ åœ¨0ä½ç½®),é›†åˆä¸­å·²ç»å­˜åœ¨TK&nbsp;åˆ™è¿”å›false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ä¸å­˜åœ¨æ·»åŠ æˆåŠŸ&nbsp;è¿”å›true$redis-&gt;sRem(&#39;key&#39;&nbsp;,&nbsp;&#39;TK&#39;);&nbsp;//&nbsp;ç§»é™¤å®¹å™¨ä¸­çš„TK$redis-&gt;sMove(&#39;key&#39;,&#39;key1&#39;,&#39;TK&#39;);&nbsp;//å°†å®¹æ˜“keyä¸­çš„å…ƒç´ TK&nbsp;ç§»åŠ¨åˆ°å®¹å™¨key1&nbsp;&nbsp;æ“ä½œæˆåŠŸè¿”å›TRUE$redis-&gt;sIsMember(&#39;key&#39;,&#39;TK&#39;);&nbsp;//æ£€æŸ¥VALUEæ˜¯å¦æ˜¯SETå®¹å™¨ä¸­çš„æˆå‘˜$redis-&gt;sCard(&#39;key&#39;);&nbsp;//è¿”å›SETå®¹å™¨çš„æˆå‘˜æ•°$redis-&gt;sPop(&#39;key&#39;);&nbsp;//éšæœºè¿”å›å®¹å™¨ä¸­ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ç§»é™¤è¯¥å…ƒç´ $redis-&gt;sRandMember(&#39;key&#39;);//éšæœºè¿”å›å®¹å™¨ä¸­ä¸€ä¸ªå…ƒç´ ï¼Œä¸ç§»é™¤è¯¥å…ƒç´ $redis-&gt;sInter(&#39;key&#39;,&#39;key1&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¿”å›ä¸¤ä¸ªé›†åˆçš„äº¤é›†&nbsp;æ²¡æœ‰äº¤é›†è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ï¼Œè‹¥å‚æ•°åªæœ‰ä¸€ä¸ªé›†åˆï¼Œåˆ™è¿”å›é›†åˆå¯¹åº”çš„å®Œæ•´çš„æ•°ç»„$redis-&gt;sInterStore(&#39;store&#39;,&#39;key&#39;,&#39;key1&#39;);&nbsp;//å°†é›†åˆkeyå’Œé›†åˆkey1çš„äº¤é›†&nbsp;å­˜å…¥å®¹å™¨store&nbsp;æˆåŠŸè¿”å›1$redis-&gt;sUnion(&#39;key&#39;,&#39;key1&#39;);&nbsp;//é›†åˆkeyå’Œé›†åˆkey1çš„å¹¶é›†&nbsp;&nbsp;æ³¨æ„å³ä½¿å¤šä¸ªé›†åˆæœ‰ç›¸åŒå…ƒç´ &nbsp;åªä¿ç•™ä¸€ä¸ª$redis-&gt;sUnionStore(&#39;store&#39;,&#39;key&#39;,&#39;key1&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//é›†åˆkeyå’Œé›†åˆkey1çš„å¹¶é›†ä¿å­˜åœ¨é›†åˆstoreä¸­,&nbsp;&nbsp;æ³¨æ„å³ä½¿å¤šä¸ªé›†åˆæœ‰ç›¸åŒå…ƒç´ &nbsp;åªä¿ç•™ä¸€ä¸ª$redis-&gt;sDiff(&#39;key&#39;,&#39;key1&#39;,&#39;key2&#39;);&nbsp;//è¿”å›æ•°ç»„ï¼Œè¯¥æ•°ç»„å…ƒç´ æ˜¯å­˜åœ¨äºkeyé›†åˆè€Œä¸å­˜åœ¨äºé›†åˆkey1&nbsp;key25. Zsetæ•°æ®ç±»å‹(stored&nbsp;set)&nbsp;å’Œ&nbsp;set&nbsp;ä¸€æ ·æ˜¯å­—ç¬¦ä¸²çš„é›†åˆï¼Œä¸åŒçš„æ˜¯æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ª&nbsp;double&nbsp;ç±»å‹çš„&nbsp;scoreredisçš„listç±»å‹å…¶å®å°±æ˜¯ä¸€ä¸ªæ¯ä¸ªå­å…ƒç´ éƒ½æ˜¯stringç±»å‹çš„åŒå‘é“¾è¡¨ã€‚$redis-&gt;zAdd(&#39;tkey&#39;,&nbsp;1,&nbsp;&#39;A&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;æ’å…¥é›†åˆtkeyä¸­ï¼ŒAå…ƒç´ å…³è”ä¸€ä¸ªåˆ†æ•°ï¼Œæ’å…¥æˆåŠŸè¿”å›1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åŒæ—¶é›†åˆå…ƒç´ ä¸å¯ä»¥é‡å¤,&nbsp;å¦‚æœå…ƒç´ å·²ç»å­˜åœ¨è¿”å›&nbsp;0$redis-&gt;zRange(&#39;tkey&#39;,0,-1);&nbsp;//&nbsp;è·å–é›†åˆå…ƒç´ ï¼Œä»0ä½ç½®&nbsp;åˆ°&nbsp;-1&nbsp;ä½ç½®$redis-&gt;zRange(&#39;tkey&#39;,0,-1,&nbsp;true);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è·å–é›†åˆå…ƒç´ ï¼Œä»0ä½ç½®&nbsp;åˆ°&nbsp;-1&nbsp;ä½ç½®,&nbsp;è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„&nbsp;å¸¦åˆ†æ•°&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array([A]&nbsp;=&gt;&nbsp;0.01,[B]&nbsp;=&gt;&nbsp;0.02,[D]&nbsp;=&gt;&nbsp;0.03)&nbsp;å…¶ä¸­å°æ•°æ¥è‡ªzAddæ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°$redis-&gt;zDelete(&#39;tkey&#39;,&nbsp;&#39;B&#39;);&nbsp;//&nbsp;ç§»é™¤é›†åˆtkeyä¸­å…ƒç´ B&nbsp;&nbsp;æˆåŠŸè¿”å›1&nbsp;å¤±è´¥è¿”å›&nbsp;0$redis-&gt;zRevRange(&#39;tkey&#39;,&nbsp;0,&nbsp;-1);&nbsp;//&nbsp;è·å–é›†åˆå…ƒç´ ï¼Œä»0ä½ç½®&nbsp;åˆ°&nbsp;-1&nbsp;ä½ç½®ï¼Œæ•°ç»„æŒ‰ç…§scoreé™åºå¤„ç†$redis-&gt;zRevRange(&#39;tkey&#39;,&nbsp;0,&nbsp;-1,true);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è·å–é›†åˆå…ƒç´ ï¼Œä»0ä½ç½®&nbsp;åˆ°&nbsp;-1&nbsp;ä½ç½®ï¼Œæ•°ç»„æŒ‰ç…§scoreé™åºå¤„ç†&nbsp;è¿”å›scoreå…³è”æ•°ç»„$redis-&gt;zRangeByScore(&#39;tkey&#39;,&nbsp;0,&nbsp;0.2,array(&#39;withscores&#39;&nbsp;=&gt;&nbsp;true));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//è·å–å‡ ä¸ªtkeyä¸­scoreåœ¨åŒºé—´[0,0.2]å…ƒç´ &nbsp;,scoreç”±ä½åˆ°é«˜æ’åº,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å…ƒç´ å…·æœ‰ç›¸åŒçš„scoreï¼Œé‚£ä¹ˆä¼šæŒ‰ç…§å­—å…¸é¡ºåºæ’åˆ—&nbsp;,&nbsp;withscores&nbsp;æ§åˆ¶è¿”å›å…³è”æ•°ç»„$redis-&gt;zRangeByScore(&#39;tkey&#39;,&nbsp;0.1,&nbsp;0.36,&nbsp;array(&#39;withscores&#39;&nbsp;=&gt;&nbsp;TRUE,&nbsp;&#39;limit&#39;&nbsp;=&gt;&nbsp;array(0,&nbsp;1)));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//å…¶ä¸­limitä¸­&nbsp;0å’Œ1&nbsp;è¡¨ç¤ºå–ç¬¦åˆæ¡ä»¶é›†åˆä¸­&nbsp;ä»0ä½ç½®å¼€å§‹ï¼Œå‘åæ‰«æ1ä¸ª&nbsp;è¿”å›å…³è”æ•°ç»„$redis-&gt;zCount(&#39;tkey&#39;,&nbsp;2,&nbsp;10);&nbsp;//&nbsp;è·å–tkeyä¸­scoreåœ¨åŒºé—´[2,&nbsp;10]å…ƒç´ çš„ä¸ªæ•°$redis-&gt;zRemRangeByScore(&#39;tkey&#39;,&nbsp;1,&nbsp;3);&nbsp;//&nbsp;ç§»é™¤tkeyä¸­scoreåœ¨åŒºé—´1,&nbsp;3çš„å…ƒç´ $redis-&gt;zRemRangeByRank(&#39;tkey&#39;,&nbsp;0,&nbsp;1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//é»˜è®¤å…ƒç´ scoreæ˜¯é€’å¢çš„ï¼Œç§»é™¤tkeyä¸­å…ƒç´ &nbsp;ä»0å¼€å§‹åˆ°-1ä½ç½®ç»“æŸ$redis-&gt;zSize(&#39;tkey&#39;);&nbsp;&nbsp;//è¿”å›å­˜å‚¨åœ¨keyå¯¹åº”çš„æœ‰åºé›†åˆä¸­çš„å…ƒç´ çš„ä¸ªæ•°$redis-&gt;zScore(&#39;tkey&#39;,&nbsp;&#39;A&#39;);&nbsp;//&nbsp;è¿”å›é›†åˆtkeyä¸­å…ƒç´ Açš„scoreå€¼$redis-&gt;zRank(&#39;tkey&#39;,&nbsp;&#39;A&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¿”å›é›†åˆtkeyä¸­å…ƒç´ Açš„ç´¢å¼•å€¼&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zé›†åˆä¸­å…ƒç´ æŒ‰ç…§scoreä»ä½åˆ°é«˜è¿›è¡Œæ’åˆ—&nbsp;ï¼Œå³æœ€ä½çš„score&nbsp;indexç´¢å¼•ä¸º0$redis-&gt;zIncrBy(&#39;tkey&#39;,&nbsp;2.5,&nbsp;&#39;A&#39;);&nbsp;//&nbsp;å°†é›†åˆtkeyä¸­å…ƒç´ Açš„scoreå€¼&nbsp;åŠ &nbsp;2.5$redis-&gt;zUnion(&#39;union&#39;,&nbsp;array(&#39;tkey&#39;,&nbsp;&#39;tkey1&#39;));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;å°†é›†åˆtkeyå’Œé›†åˆtkey1å…ƒç´ åˆå¹¶äºé›†åˆunion&nbsp;,&nbsp;å¹¶ä¸”æ–°é›†åˆä¸­å…ƒç´ ä¸èƒ½é‡å¤&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;è¿”å›æ–°é›†åˆçš„å…ƒç´ ä¸ªæ•°ï¼Œ&nbsp;å¦‚æœå…ƒç´ Aåœ¨tkeyå’Œtkey1éƒ½å­˜åœ¨ï¼Œåˆ™åˆå¹¶åçš„å…ƒç´ Açš„scoreç›¸åŠ $redis-&gt;zUnion(&#39;ko2&#39;,&nbsp;array(&#39;k1&#39;,&nbsp;&#39;k2&#39;),&nbsp;array(5,&nbsp;2));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;é›†åˆk1å’Œé›†åˆk2å¹¶é›†äºk02&nbsp;ï¼Œarray(5,1)ä¸­å…ƒç´ çš„ä¸ªæ•°ä¸å­é›†åˆå¯¹åº”ï¼Œç„¶å&nbsp;5&nbsp;å¯¹åº”k1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k1æ¯ä¸ªå…ƒç´ scoreéƒ½è¦ä¹˜ä»¥5&nbsp;ï¼ŒåŒç†1å¯¹åº”k2ï¼Œk2æ¯ä¸ªå…ƒç´ scoreä¹˜ä»¥1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ç„¶åå…ƒç´ æŒ‰ç…§é€’å¢æ’åºï¼Œé»˜è®¤ç›¸åŒçš„å…ƒç´ score(SUM)ç›¸åŠ $redis-&gt;zUnion(&#39;ko2&#39;,&nbsp;array(&#39;k1&#39;,&nbsp;&#39;k2&#39;),&nbsp;array(10,&nbsp;2),&#39;MAX&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;å„ä¸ªå­é›†ä¹˜ä»¥å› å­ä¹‹åï¼Œå…ƒç´ æŒ‰ç…§é€’å¢æ’åºï¼Œç›¸åŒçš„å…ƒç´ çš„scoreå–æœ€å¤§å€¼(MAX)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ä¹Ÿå¯ä»¥è®¾ç½®MIN&nbsp;å–æœ€å°å€¼$redis-&gt;zInter(&#39;ko1&#39;,&nbsp;array(&#39;k1&#39;,&nbsp;&#39;k2&#39;));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;é›†åˆk1å’Œé›†åˆk2å–äº¤é›†äºk01&nbsp;ï¼Œä¸”æŒ‰ç…§scoreå€¼é€’å¢æ’åº&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¦‚æœé›†åˆå…ƒç´ ç›¸åŒï¼Œåˆ™æ–°é›†åˆä¸­çš„å…ƒç´ çš„scoreå€¼ç›¸åŠ $redis-&gt;zInter(&#39;ko1&#39;,&nbsp;array(&#39;k1&#39;,&nbsp;&#39;k2&#39;),&nbsp;array(5,&nbsp;1));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//é›†åˆk1å’Œé›†åˆk2å–äº¤é›†äºk01&nbsp;ï¼Œarray(5,1)ä¸­å…ƒç´ çš„ä¸ªæ•°ä¸å­é›†åˆå¯¹åº”ï¼Œç„¶å&nbsp;5&nbsp;å¯¹åº”k1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k1æ¯ä¸ªå…ƒç´ scoreéƒ½è¦ä¹˜ä»¥5&nbsp;ï¼ŒåŒç†1å¯¹åº”k2ï¼Œk2æ¯ä¸ªå…ƒç´ scoreä¹˜ä»¥1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ï¼Œç„¶åå…ƒç´ scoreæŒ‰ç…§é€’å¢æ’åºï¼Œé»˜è®¤ç›¸åŒçš„å…ƒç´ score(SUM)ç›¸åŠ $redis-&gt;zInter(&#39;ko1&#39;,&nbsp;array(&#39;k1&#39;,&nbsp;&#39;k2&#39;),&nbsp;array(5,&nbsp;1),&#39;MAX&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;å„ä¸ªå­é›†ä¹˜ä»¥å› å­ä¹‹åï¼Œå…ƒç´ scoreæŒ‰ç…§é€’å¢æ’åºï¼Œç›¸åŒçš„å…ƒç´ scoreå–æœ€å¤§å€¼(MAX)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ä¹Ÿå¯ä»¥è®¾ç½®MIN&nbsp;å–æœ€å°å€¼6. Hashæ•°æ®ç±»å‹redis hashæ˜¯ä¸€ä¸ªstringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨.å®ƒçš„æ·»åŠ ï¼Œåˆ é™¤æ“ä½œéƒ½æ˜¯O(1)ï¼ˆå¹³å‡ï¼‰.hashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚$redis-&gt;hSet(&#39;h&#39;,&nbsp;&#39;name&#39;,&nbsp;&#39;TK&#39;);&nbsp;//&nbsp;åœ¨hè¡¨ä¸­&nbsp;æ·»åŠ nameå­—æ®µ&nbsp;valueä¸ºTK$redis-&gt;hSetNx(&#39;h&#39;,&nbsp;&#39;name&#39;,&nbsp;&#39;TK&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;åœ¨hè¡¨ä¸­&nbsp;æ·»åŠ nameå­—æ®µ&nbsp;valueä¸ºTK&nbsp;å¦‚æœå­—æ®µnameçš„valueå­˜åœ¨è¿”å›false&nbsp;å¦åˆ™è¿”å›&nbsp;true$redis-&gt;hGet(&#39;h&#39;,&nbsp;&#39;name&#39;);&nbsp;//&nbsp;è·å–hè¡¨ä¸­nameå­—æ®µvalue$redis-&gt;hLen(&#39;h&#39;);&nbsp;//&nbsp;è·å–hè¡¨é•¿åº¦å³å­—æ®µçš„ä¸ªæ•°$redis-&gt;hDel(&#39;h&#39;,&#39;email&#39;);&nbsp;//&nbsp;åˆ é™¤hè¡¨ä¸­email&nbsp;å­—æ®µ$redis-&gt;hKeys(&#39;h&#39;);&nbsp;//&nbsp;è·å–hè¡¨ä¸­æ‰€æœ‰å­—æ®µ$redis-&gt;hVals(&#39;h&#39;);&nbsp;//&nbsp;è·å–hè¡¨ä¸­æ‰€æœ‰å­—æ®µvalue$redis-&gt;hGetAll(&#39;h&#39;);&nbsp;//&nbsp;è·å–hè¡¨ä¸­æ‰€æœ‰å­—æ®µå’Œvalue&nbsp;è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„(å­—æ®µä¸ºé”®å€¼)$redis-&gt;hExists(&#39;h&#39;,&nbsp;&#39;email&#39;);&nbsp;//åˆ¤æ–­email&nbsp;å­—æ®µæ˜¯å¦å­˜åœ¨ä¸è¡¨h&nbsp;ä¸å­˜åœ¨è¿”å›false$redis-&gt;hSet(&#39;h&#39;,&nbsp;&#39;age&#39;,&nbsp;28);$redis-&gt;hIncrBy(&#39;h&#39;,&nbsp;&#39;age&#39;,&nbsp;-2);&nbsp;&nbsp;//&nbsp;è®¾ç½®hè¡¨ä¸­ageå­—æ®µvalueåŠ (-2)&nbsp;å¦‚æœvalueæ˜¯ä¸ªéæ•°å€¼&nbsp;åˆ™è¿”å›false&nbsp;å¦åˆ™ï¼Œè¿”å›æ“ä½œåçš„value$redis-&gt;hIncrByFloat(&#39;h&#39;,&nbsp;&#39;age&#39;,&nbsp;-0.33);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è®¾ç½®hè¡¨ä¸­ageå­—æ®µvalueåŠ (-2.6)&nbsp;å¦‚æœvalueæ˜¯ä¸ªéæ•°å€¼&nbsp;åˆ™è¿”å›false&nbsp;å¦åˆ™&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;è¿”å›æ“ä½œåçš„value(å°æ•°ç‚¹ä¿ç•™15ä½)$redis-&gt;hMset(&#39;h&#39;,&nbsp;array(&#39;score&#39;&nbsp;=&gt;&nbsp;&#39;80&#39;,&nbsp;&#39;salary&#39;&nbsp;=&gt;&nbsp;2000));&nbsp;//&nbsp;è¡¨h&nbsp;æ‰¹é‡è®¾ç½®å­—æ®µå’Œvalue$redis-&gt;hMGet(&#39;h&#39;,&nbsp;array(&#39;score&#39;,&#39;salary&#39;));&nbsp;//&nbsp;è¡¨h&nbsp;æ‰¹é‡è·å–å­—æ®µçš„value","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"},{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/tags/redis/"}]},{"title":"å¸¸è§mysql","slug":"å¸¸ç”¨mysqlè¯­å¥","date":"2018-03-19T08:12:50.000Z","updated":"2022-03-19T14:35:21.910Z","comments":true,"path":"2018/03/19/150/","link":"","permalink":"https://github.13sai.com/2018/03/19/150/","excerpt":"","text":"å¸¸ç”¨çš„sqlè¯­å¥ï¼Œæ–¹ä¾¿æŸ¥è¯¢ã€‚ ä¸€ã€ç”¨æˆ·ç®¡ç†ï¼š1ã€æ–°å»ºç”¨æˆ·ï¼šCREATE USER name IDENTIFIED BY &#x27;ssapdrow&#x27;; 2ã€æ›´æ”¹å¯†ç ï¼šSET PASSWORD FOR name=PASSWORD(&#x27;fdddfd&#x27;); 3ã€æƒé™ç®¡ç†# æŸ¥çœ‹nameç”¨æˆ·æƒé™ SHOW GRANTS FOR name; # ç»™nameç”¨æˆ·db_nameæ•°æ®åº“çš„æ‰€æœ‰æƒé™ GRANT SELECT ON db_name.* TO name; # GRANTçš„åæ“ä½œï¼Œå»é™¤æƒé™ REVOKE SELECT ON db_name.* TO name; äºŒã€æ•°æ®åº“æ“ä½œï¼š1ã€æŸ¥çœ‹æ•°æ®åº“ï¼šSHOW DATABASES; 2ã€åˆ›å»ºæ•°æ®åº“ï¼šCREATE DATABASE db_name; 3ã€ä½¿ç”¨æ•°æ®åº“ï¼šUSE db_name; 4ã€åˆ é™¤æ•°æ®åº“ï¼šDROP DATABASE db_name; ä¸‰ã€åˆ›å»ºè¡¨ï¼š1ã€åˆ›å»ºè¡¨ï¼šCREATE TABLE IF NOT EXISTS table_name( id INT UNSIGNED NOT NULL AUTO_INCREMENT, name VARCHAR(60) NOT NULLscore TINYINT UNSIGNED NOT NULL DEFAULT 0, PRIMARY KEY(id) )ENGINE=InnoDB DEFAULT charset=utf8; 2ã€å¤åˆ¶è¡¨ï¼šCREATE TABLE tb_name2 SELECT * FROM tb_name; æˆ–è€…éƒ¨åˆ†å¤åˆ¶ï¼š CREATE TABLE tb_name2 SELECT id,name FROM tb_name; 3ã€åˆ›å»ºä¸´æ—¶è¡¨ï¼šCREATE TEMPORARY TABLE tb_name(è¿™é‡Œå’Œåˆ›å»ºæ™®é€šè¡¨ä¸€æ ·); 4ã€æŸ¥çœ‹æ•°æ®åº“ä¸­å¯ç”¨çš„è¡¨ï¼šSHOW TABLES; 5ã€æŸ¥çœ‹è¡¨çš„ç»“æ„ï¼šDESCRIBE tb_name; ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼š SHOW COLUMNS in tb_name; 6ã€åˆ é™¤è¡¨ï¼šDROP tb_name TABLE IF EXISTS tb_name; å®ä¾‹ï¼š DROP TABLE IF EXISTS tb_name; 7ã€è¡¨é‡å‘½åï¼šRENAME TABLE name_old TO name_new; è¿˜å¯ä»¥ä½¿ç”¨ï¼š ALTER TABLE name_old RENAME name_new; å››ã€ä¿®æ”¹è¡¨ï¼š1ã€æ›´æ”¹è¡¨ç»“æ„ï¼šALTER TABLE tb_name ADD[CHANGE,RENAME,DROP] ...è¦æ›´æ”¹çš„å†…å®¹... å®ä¾‹ï¼š ALTER TABLE tb_name ADD COLUMN address varchar(80) NOT NULL; ALTER TABLE tb_name DROP address; ALTER TABLE tb_name CHANGE score grade SMALLINT(4) NOT NULL; å½“ç„¶ï¼Œå¦‚æœä¸ä¿®æ”¹å­—æ®µåï¼Œæ›´å»ºè®®MODIFYï¼Œè€Œä¸æ˜¯CHANGE ALTER TABLE tb_name MODIFY score INT(10); äº”ã€æ’å…¥æ•°æ®ï¼š1ã€æ’å…¥æ•°æ®ï¼šINSERT INTO tb_name(id,name,score)VALUES(NULL,&#x27;å¼ ä¸‰&#x27;,140),(NULL,&#x27;å¼ å››&#x27;,178),(NULL,&#x27;å¼ äº”&#x27;,134); è¿™é‡Œçš„æ’å…¥å¤šæ¡æ•°æ®ç›´æ¥åœ¨åè¾¹åŠ ä¸Šé€—å·ï¼Œç›´æ¥å†™å…¥æ’å…¥çš„æ•°æ®å³å¯ï¼›ä¸»é”®idæ˜¯è‡ªå¢çš„åˆ—ï¼Œå¯ä»¥ä¸ç”¨å†™ã€‚ 2ã€æ’å…¥æ£€ç´¢å‡ºæ¥çš„æ•°æ®ï¼šINSERT INTO tb_name(name,score) SELECT name,score FROM tb_name2; å…­ã€æ›´æ–°æ•°æ®ï¼š1ã€æŒ‡å®šæ›´æ–°æ•°æ®ï¼šUPDATE tb_name SET score=189 WHERE id=2; UPDATE tablename SET columnName=NewValue [ WHERE condition ] ä¸ƒã€åˆ é™¤æ•°æ®ï¼š1ã€åˆ é™¤æ•°æ®ï¼šDELETE FROM tb_name WHERE id=3; å…«ã€æ¡ä»¶æ§åˆ¶ï¼š1ã€WHERE è¯­å¥ï¼šSELECT * FROM tb_name WHERE id=3; 2ã€HAVING è¯­å¥ï¼šSELECT * FROM tb_name GROUP BY score HAVING count(*)&gt;2 3ã€ç›¸å…³æ¡ä»¶æ§åˆ¶ç¬¦ =ã€&gt;ã€&lt;ã€&lt;&gt;ã€IN(1,2,3â€¦â€¦)ã€BETWEEN a AND bã€NOT AND ã€OR Like()ç”¨æ³•ä¸­ % ä¸ºåŒ¹é…ä»»æ„ã€ _ åŒ¹é…ä¸€ä¸ªå­—ç¬¦ï¼ˆå¯ä»¥æ˜¯æ±‰å­—ï¼‰ IS NULL ç©ºå€¼æ£€æµ‹ ä¹ã€MySQLçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š1ã€Mysqlæ”¯æŒREGEXPçš„æ­£åˆ™è¡¨è¾¾å¼ï¼šSELECT * FROM tb_name WHERE name REGEXP &#x27;[1]&#x27; //æ‰¾å‡ºä»¥A-D ä¸ºå¼€å¤´çš„name 2ã€ç‰¹æ®Šå­—ç¬¦éœ€è¦è½¬ä¹‰ã€‚åã€MySQLçš„ä¸€äº›å‡½æ•°ï¼š1ã€å­—ç¬¦ä¸²é“¾æ¥â€”â€”CONCAT()SELECT CONCAT(name,&#x27;=&gt;&#x27;,score) FROM tb_name 2ã€æ•°å­¦å‡½æ•°ï¼š AVGã€SUMã€MAXã€MINã€COUNTï¼›3ã€æ–‡æœ¬å¤„ç†å‡½æ•°ï¼š TRIMã€LOCATEã€UPPERã€LOWERã€SUBSTRING4ã€è¿ç®—ç¬¦ï¼š +ã€-ã€*ã€5ã€æ—¶é—´å‡½æ•°ï¼š DATE()ã€CURTIME()ã€DAY()ã€YEAR()ã€NOW()â€¦..åä¸€ã€åˆ†ç»„æŸ¥è¯¢ï¼š1ã€åˆ†ç»„æŸ¥è¯¢å¯ä»¥æŒ‰ç…§æŒ‡å®šçš„åˆ—è¿›è¡Œåˆ†ç»„ï¼šSELECT COUNT() FROM tb_name GROUP BY score HAVING COUNT()&gt;1; 2ã€æ¡ä»¶ä½¿ç”¨Havingï¼›3ã€ORDER BY æ’åºORDER BY DESC|ASC =&gt;æŒ‰æ•°æ®çš„é™åºå’Œå‡åºæ’åˆ— åäºŒã€ç´¢å¼•ç›¸å…³1ã€æ·»åŠ PRIMARY KEYï¼ˆä¸»é”®ç´¢å¼•ï¼‰ALTER TABLE table_name ADD PRIMARY KEY ( column ) 2ã€ æ·»åŠ UNIQUE(å”¯ä¸€ç´¢å¼•)ALTER TABLE table_name ADD UNIQUE ( column ) 3ã€æ·»åŠ INDEX(æ™®é€šç´¢å¼•)ALTER TABLE table_name ADD INDEX index_name ( column ) 4ã€æ·»åŠ FULLTEXT(å…¨æ–‡ç´¢å¼•)ALTER TABLE table_name ADD FULLTEXT ( column) 5ã€æ·»åŠ è”åˆç´¢å¼•ALTER TABLE table_name ADD INDEX index_name ( column1, column2, column3 ) 6ã€æŸ¥è¯¢ç´¢å¼•SHOW INDEX FROM table_name; 7ã€åˆ é™¤ç´¢å¼•drop index index_name on table_name ; alter table table_name drop index index_name ; alter table table_name drop primary key ; æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„æ•°æ®åº“å’Œç´¢å¼•å¤§å°select table_schema, concat(truncate(sum(data_length)/1024/1024,2),&#x27; mb&#x27;) as data_size, concat(truncate(sum(index_length)/1024/1024,2),&#x27;mb&#x27;) as index_size from information_schema.tables group by table_schema order by data_length desc; å…¶ä»–æŸ¥çœ‹å½“å‰æŸä¸ªæ•°æ®åº“å’Œæ•°æ®åº“ä¸‹æ‰€æœ‰çš„è¡¨çš„å¤§å°select table_name, concat(truncate(data_length/1024/1024,2),&#x27; mb&#x27;) as data_size, concat(truncate(index_length/1024/1024,2),&#x27; mb&#x27;) as index_size from information_schema.tables where table_schema = &#x27;mysql&#x27; group by table_name order by data_length desc; æŸ¥çœ‹mysqlè¿æ¥æ•°show full processlist; æŒ‰æœˆç»Ÿè®¡select sum(money),LEFT(created_at, 7) from sale GROUP BY LEFT(created_at, 7);","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"iconvçš„å°æ¯›ç—…","slug":"iconvçš„å°æ¯›ç—…","date":"2018-03-08T03:32:22.000Z","updated":"2022-03-19T14:35:21.712Z","comments":true,"path":"2018/03/08/149/","link":"","permalink":"https://github.13sai.com/2018/03/08/149/","excerpt":"","text":"æœ€è¿‘åšcsvå¯¼å‡ºï¼Œæœ¬åœ°æµ‹è¯•okï¼Œå‘å¸ƒåˆ°çº¿ä¸Šæ€»æ˜¯å¯¼å‡ºå¤±è´¥ï¼ŒåŒäº‹è¿½æ ¹æº¯æºï¼Œæ‰¾å‡ºæ˜¯ä¸€å¯¼å‡ºè¿›ç¨‹å°±è¢«Linuxå¹²æ‰äº†ï¼Œç„¶åæ”¹ä»£ç ï¼Œåˆ†ç‰‡å¯¼å‡ºï¼Œçº¿ä¸Šè¿˜æ˜¯å¤±è´¥ã€‚æœ€ååŒäº‹è¯´æ˜¯è½¬ç çš„é—®é¢˜ï¼Œå»æ‰iconvè½¬ç ï¼Œå‘å¸ƒï¼ŒæˆåŠŸï¼ç„¶è€Œï¼Œä¸‹è½½çš„csvç”¨officeæ‰“å¼€å°±å°´å°¬äº†ï¼Œä¸­æ–‡ä¹±ç ï¼Œæœ€åæ®è¯´æ˜¯æ­¤å‡½æ•°æœ‰bugï¼Œæ”¹ä¸ºmb_convert_encoding å‡½æ•°ï¼ŒæˆåŠŸï¼çœ‹çœ‹phpæ‰‹å†Œè¯´æ˜ï¼šiconvå°†å­—ç¬¦ä¸² str ä» in_charset è½¬æ¢ç¼–ç åˆ° out_charsetã€‚string mb_convert_encoding ( string $str , string $to_encoding [, mixed $from_encoding = mb_internal_encoding() ] )å‚æ•°in_charset è¾“å…¥çš„å­—ç¬¦é›†ã€‚out_charset è¾“å‡ºçš„å­—ç¬¦é›†ã€‚å¦‚æœä½ åœ¨ out_charset åæ·»åŠ äº†å­—ç¬¦ä¸² //TRANSLITï¼Œå°†å¯ç”¨è½¬å†™ï¼ˆtransliterationï¼‰åŠŸèƒ½ã€‚è¿™ä¸ªæ„æ€æ˜¯ï¼Œå½“ä¸€ä¸ªå­—ç¬¦ä¸èƒ½è¢«ç›®æ ‡å­—ç¬¦é›†æ‰€è¡¨ç¤ºæ—¶ï¼Œå®ƒå¯ä»¥é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ªå½¢ä¼¼çš„å­—ç¬¦æ¥è¿‘ä¼¼è¡¨è¾¾ã€‚ å¦‚æœä½ æ·»åŠ äº†å­—ç¬¦ä¸² //IGNOREï¼Œä¸èƒ½ä»¥ç›®æ ‡å­—ç¬¦é›†è¡¨è¾¾çš„å­—ç¬¦å°†è¢«é»˜é»˜ä¸¢å¼ƒã€‚ å¦åˆ™ï¼Œä¼šå¯¼è‡´ä¸€ä¸ª E_NOTICEå¹¶è¿”å› FALSEã€‚Caution//TRANSLIT è¿è¡Œç»†èŠ‚é«˜åº¦ä¾èµ–äºç³»ç»Ÿçš„ iconv() å®ç°ï¼ˆå‚è§ ICONV_IMPLï¼‰ã€‚ æ®æ‚‰ï¼ŒæŸäº›ç³»ç»Ÿä¸Šçš„å®ç°ä¼šç›´æ¥å¿½ç•¥ //TRANSLITï¼Œæ‰€ä»¥è½¬æ¢ä¹Ÿæœ‰å¯èƒ½å¤±è´¥ï¼Œout_charset ä¼šæ˜¯ä¸åˆæ ¼çš„ã€‚str è¦è½¬æ¢çš„å­—ç¬¦ä¸²ã€‚è¿”å›å€¼è¿”å›è½¬æ¢åçš„å­—ç¬¦ä¸²ï¼Œ æˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› FALSEã€‚æ›´æ–°æ—¥å¿—5.4.0 è¿™ä¸ªç‰ˆæœ¬èµ·ï¼Œå­—ç¬¦éæ³•æ—¶å€™ä¼šè¿”å› FALSEï¼Œé™¤éåœ¨è¾“å‡ºå­—ç¬¦é‡ŒæŒ‡å®šäº† //IGNORE ã€‚ åœ¨ä¹‹å‰ç‰ˆæœ¬ï¼Œå®ƒä¼šè¿”å›ä¸€éƒ¨åˆ†å­—ç¬¦ä¸²ã€‚&lt;?php $text&nbsp;=&nbsp;&quot;This&nbsp;is&nbsp;the&nbsp;Euro&nbsp;symbol&nbsp;&#39;â‚¬&#39;.&quot;;echo&nbsp;&#39;Original&nbsp;:&nbsp;&#39;,&nbsp;$text,&nbsp;PHP_EOL; echo&nbsp;&#39;TRANSLIT&nbsp;:&nbsp;&#39;,&nbsp;iconv(&quot;UTF-8&quot;,&nbsp;&quot;ISO-8859-1//TRANSLIT&quot;,&nbsp;$text),&nbsp;PHP_EOL; echo&nbsp;&#39;IGNORE&nbsp;&nbsp;&nbsp;:&nbsp;&#39;,&nbsp;iconv(&quot;UTF-8&quot;,&nbsp;&quot;ISO-8859-1//IGNORE&quot;,&nbsp;$text),&nbsp;PHP_EOL; echo&nbsp;&#39;Plain&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&#39;,&nbsp;iconv(&quot;UTF-8&quot;,&nbsp;&quot;ISO-8859-1&quot;,&nbsp;$text),&nbsp;PHP_EOL; ?&gt;Original&nbsp;:&nbsp;This&nbsp;is&nbsp;the&nbsp;Euro&nbsp;symbol&nbsp;&#39;â‚¬&#39;. TRANSLIT&nbsp;:&nbsp;This&nbsp;is&nbsp;the&nbsp;Euro&nbsp;symbol&nbsp;&#39;EUR&#39;. IGNORE&nbsp;&nbsp;&nbsp;:&nbsp;This&nbsp;is&nbsp;the&nbsp;Euro&nbsp;symbol&nbsp;&#39;&#39;. Plain&nbsp;&nbsp;&nbsp;&nbsp;: Notice:&nbsp;iconv():&nbsp;Detected&nbsp;an&nbsp;illegal&nbsp;character&nbsp;in&nbsp;input&nbsp;string&nbsp;in&nbsp;.\\iconv-exa","categories":[{"name":"bug","slug":"bug","permalink":"https://github.13sai.com/categories/bug/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"Linuxä¸‹å„æ–‡ä»¶å¤¹çš„ç»“æ„è¯´æ˜åŠç”¨é€”ä»‹ç»","slug":"Linuxä¸‹å„æ–‡ä»¶å¤¹çš„ç»“æ„è¯´æ˜åŠç”¨é€”ä»‹ç»","date":"2018-02-27T03:50:29.000Z","updated":"2022-03-19T14:35:21.606Z","comments":true,"path":"2018/02/27/147/","link":"","permalink":"https://github.13sai.com/2018/02/27/147/","excerpt":"","text":"linuxä¸‹å„æ–‡ä»¶å¤¹çš„ç»“æ„è¯´æ˜åŠç”¨é€”ä»‹ç»ï¼š /binï¼šäºŒè¿›åˆ¶å¯æ‰§è¡Œå‘½ä»¤ã€‚ /devï¼šè®¾å¤‡ç‰¹æ®Šæ–‡ä»¶ã€‚ /etcï¼šç³»ç»Ÿç®¡ç†å’Œé…ç½®æ–‡ä»¶ã€‚ /etc/rc.dï¼šå¯åŠ¨çš„é… ç½®æ–‡ä»¶å’Œè„šæœ¬ã€‚ /homeï¼šç”¨æˆ·ä¸»ç›®å½•çš„åŸºç‚¹ï¼Œæ¯”å¦‚ç”¨æˆ·userçš„ä¸»ç›®å½•å°±æ˜¯/home/userï¼Œå¯ä»¥ç”¨~userè¡¨ç¤ºã€‚ /libï¼šæ ‡å‡†ç¨‹åºè®¾è®¡åº“ï¼Œåˆ å«åŠ¨æ€é“¾æ¥å…±äº«åº“ï¼Œä½œç”¨ç±»ä¼¼windowsé‡Œçš„.dllæ–‡ä»¶ã€‚ /sbinï¼šç³»ç»Ÿç®¡ç†å‘½ä»¤ï¼Œè¿™ é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç®¡ç†ç¨‹åºã€‚ /tmpï¼šå…¬ç”¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ ç‚¹ã€‚ /rootï¼šç³»ç»Ÿç®¡ç†å‘˜çš„ä¸»ç›® å½•ã€‚ /mntï¼šç³»ç»Ÿæä¾›è¿™ä¸ªç›®å½•æ˜¯ è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½å…¶ä»–çš„æ–‡ä»¶ç³»ç»Ÿã€‚ /lost+foundï¼šè¿™ä¸ª ç›®å½•å¹³æ—¶æ˜¯ç©ºçš„ï¼Œç³»ç»Ÿéæ­£å¸¸å…³æœºè€Œç•™ä¸‹â€œæ— å®¶å¯å½’â€çš„æ–‡ä»¶å°±åœ¨è¿™é‡Œã€‚ /procï¼šè™šæ‹Ÿçš„ç›®å½•ï¼Œæ˜¯ç³» ç»Ÿå†…å­˜çš„æ˜ å°„ã€‚å¯ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ã€‚ /varï¼šæŸäº›å¤§æ–‡ä»¶çš„æº¢å‡º åŒºï¼Œæ¯”æ–¹è¯´å„ç§æœåŠ¡çš„æ—¥å¿—æ–‡ä»¶ã€‚ /usrï¼šæœ€åºå¤§çš„ç›®å½•ï¼Œè¦ç”¨ åˆ°çš„åº”ç”¨ç¨‹åºå’Œæ–‡ä»¶å‡ ä¹éƒ½åœ¨è¿™ä¸ªç›®å½•ã€‚å…¶ä¸­åŒ…å«ï¼š /usr/x11r6ï¼šå­˜æ”¾x windowçš„ç›®å½•ã€‚ /usr/binï¼šä¼—å¤šçš„åº”ç”¨ç¨‹åºã€‚ /usr/sbinï¼šè¶…çº§ç”¨æˆ·çš„ä¸€äº›ç®¡ç†ç¨‹åºã€‚ /usr/docï¼šlinuxæ–‡æ¡£ã€‚ /usr/includeï¼šlinuxä¸‹å¼€å‘å’Œç¼–è¯‘åº”ç”¨ç¨‹åºæ‰€éœ€è¦çš„å¤´æ–‡ä»¶ã€‚ /usr/libï¼šå¸¸ç”¨çš„åŠ¨æ€é“¾æ¥åº“å’Œè½¯ä»¶åŒ…çš„é…ç½®æ–‡ä»¶ã€‚ /usr/manï¼šå¸®åŠ©æ–‡æ¡£ã€‚ /usr/srcï¼šæºä»£ç ï¼Œlinuxå†…æ ¸çš„æºä»£ç å°±æ”¾åœ¨/usr/src/linux é‡Œã€‚ /usr/local/binï¼šæœ¬åœ°å¢åŠ çš„å‘½ä»¤ã€‚ /usr/local/libï¼šæœ¬åœ°å¢åŠ çš„åº“æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œæ ¹æ–‡ä»¶ç³»ç»Ÿæ‰€å ç©ºé—´ä¸€èˆ¬åº”è¯¥æ¯”è¾ƒå°ï¼Œå› ä¸ºå…¶ä¸­çš„ç»å¤§éƒ¨åˆ†æ–‡ä»¶éƒ½ä¸éœ€è¦ç»å¸¸æ”¹åŠ¨ï¼Œè€Œä¸”åŒ…æ‹¬ä¸¥æ ¼çš„æ–‡ä»¶å’Œä¸€ä¸ªå°çš„ ä¸ç»å¸¸æ”¹å˜çš„æ–‡ä»¶ç³»ç»Ÿä¸å®¹æ˜“æŸåã€‚é™¤äº†å¯èƒ½çš„ä¸€ä¸ªå«/vmlinuzæ ‡å‡†çš„ç³»ç»Ÿå¼•å¯¼æ˜ åƒä¹‹å¤–ï¼Œæ ¹ç›®å½•ä¸€èˆ¬ä¸å«ä»»ä½•æ–‡ ä»¶ã€‚æ‰€æœ‰å…¶ä»–æ–‡ä»¶åœ¨æ ¹æ–‡ä»¶ç³»ç»Ÿçš„å­ç›®å½•ä¸­ã€‚ 1. /binç›®å½• /binç›®å½•åŒ…å«äº†å¼•å¯¼å¯åŠ¨æ‰€éœ€çš„å‘½ä»¤æˆ–æ™®é€šç”¨æˆ·å¯èƒ½ç”¨çš„å‘½ä»¤(å¯èƒ½åœ¨å¼•å¯¼å¯åŠ¨å)ã€‚è¿™äº›å‘½ ä»¤éƒ½æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶çš„å¯æ‰§è¡Œç¨‹åº(binæ˜¯binaryçš„ç®€ç§°)ï¼Œå¤šæ˜¯ç³»ç»Ÿä¸­é‡è¦çš„ç³»ç»Ÿæ–‡ä»¶ã€‚ 2. /sbinç›®å½• /sbinç›®å½•ç±»ä¼¼/bin ï¼Œä¹Ÿç”¨äºå­˜å‚¨äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å› ä¸ºå…¶ä¸­çš„å¤§éƒ¨åˆ†æ–‡ä»¶å¤šæ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„åŸºæœ¬çš„ç³»ç»Ÿç¨‹åºï¼Œæ‰€ä»¥è™½ç„¶æ™®é€šç”¨æˆ·å¿…è¦ä¸”å…è®¸æ—¶å¯ä»¥ä½¿ç”¨ï¼Œä½†ä¸€èˆ¬ä¸ç»™æ™®é€šç”¨æˆ·ä½¿ ç”¨ã€‚ 3. /etcç›®å½• /etcç›®å½•å­˜æ”¾ç€å„ç§ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº†ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶/etc/passwdï¼Œ ç³»ç»Ÿåˆå§‹åŒ–æ–‡ä»¶/etc/rcç­‰ã€‚linuxæ­£æ˜¯é è¿™äº›æ–‡ä»¶æ‰å¾—ä»¥æ­£å¸¸åœ°è¿è¡Œã€‚ 4. /rootç›®å½• /rootç›®å½•æ˜¯è¶…çº§ç”¨æˆ·çš„ç›®å½•ã€‚ 5. /libç›®å½• /libç›®å½•æ˜¯æ ¹æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ç¨‹åºæ‰€éœ€çš„å…±äº«åº“ï¼Œå­˜æ”¾äº†æ ¹æ–‡ä»¶ç³»ç»Ÿç¨‹åºè¿è¡Œæ‰€éœ€çš„å…±äº«æ–‡ä»¶ã€‚ è¿™äº›æ–‡ä»¶åŒ…å«äº†å¯è¢«è®¸å¤šç¨‹åºå…±äº«çš„ä»£ç ï¼Œä»¥é¿å…æ¯ä¸ªç¨‹åºéƒ½åŒ…å«æœ‰ç›¸åŒçš„å­ç¨‹åºçš„å‰¯æœ¬ï¼Œæ•…å¯ä»¥ä½¿å¾—å¯æ‰§è¡Œæ–‡ä»¶å˜å¾—æ›´å°ï¼ŒèŠ‚çœç©ºé—´ã€‚ 6. /lib/modulesç›®å½• /lib/modulesç›®å½•åŒ…å«ç³»ç»Ÿæ ¸å¿ƒå¯åŠ è½½å„ç§æ¨¡å—ï¼Œå°¤å…¶æ˜¯é‚£äº›åœ¨æ¢å¤æŸåçš„ç³»ç»Ÿæ—¶é‡ æ–°å¼•å¯¼ç³»ç»Ÿæ‰€éœ€çš„æ¨¡å—(ä¾‹å¦‚ç½‘ç»œå’Œæ–‡ä»¶ç³»ç»Ÿé©±åŠ¨)ã€‚ 7. /devç›®å½• /devç›®å½•å­˜æ”¾äº†è®¾å¤‡æ–‡ä»¶ï¼Œå³è®¾å¤‡é©±åŠ¨ç¨‹åºï¼Œç”¨æˆ·é€šè¿‡è¿™äº›æ–‡ä»¶è®¿é—®å¤–éƒ¨è®¾å¤‡ã€‚æ¯”å¦‚ï¼Œç”¨æˆ·å¯ ä»¥é€šè¿‡è®¿é—®/dev/mouseæ¥è®¿é—®é¼ æ ‡çš„è¾“å…¥ï¼Œå°±åƒè®¿é—®å…¶ä»–æ–‡ä»¶ä¸€æ ·ã€‚ 8. /tmpç›®å½• /tmpç›®å½•å­˜æ”¾ç¨‹åºåœ¨è¿è¡Œæ—¶äº§ç”Ÿçš„ä¿¡æ¯å’Œæ•°æ®ã€‚ä½†åœ¨å¼•å¯¼å¯åŠ¨åï¼Œè¿è¡Œçš„ç¨‹åºæœ€å¥½ä½¿ç”¨/var/tmpæ¥ ä»£æ›¿/tmpï¼Œå› ä¸ºå‰è€…å¯èƒ½æ‹¥æœ‰ä¸€ä¸ªæ›´å¤§çš„ç£ç›˜ç©ºé—´ã€‚ 9. /bootç›®å½• /bootç›®å½•å­˜æ”¾å¼•å¯¼åŠ è½½å™¨(bootstrap loader)ä½¿ç”¨çš„æ–‡ä»¶ï¼Œå¦‚liloï¼Œæ ¸å¿ƒæ˜ åƒä¹Ÿç»å¸¸æ”¾åœ¨è¿™é‡Œï¼Œè€Œä¸æ˜¯æ”¾åœ¨æ ¹ç›®å½•ä¸­ã€‚ä½†æ˜¯å¦‚æœæœ‰è®¸å¤šæ ¸å¿ƒæ˜ åƒï¼Œè¿™ä¸ªç›®å½•å°±å¯èƒ½å˜å¾—å¾ˆå¤§ï¼Œè¿™æ—¶ä½¿ç”¨å•ç‹¬çš„ æ–‡ä»¶ç³»ç»Ÿä¼šæ›´å¥½ä¸€äº›ã€‚è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼Œè¦ç¡®ä¿æ ¸å¿ƒæ˜ åƒå¿…é¡»åœ¨ideç¡¬ç›˜çš„å‰1024æŸ±é¢å†…ã€‚ 10. /mntç›®å½• /mntç›®å½•æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä¸´æ—¶å®‰è£…(mount)æ–‡ä»¶ç³»ç»Ÿçš„å®‰è£…ç‚¹ã€‚ç¨‹åºå¹¶ä¸è‡ªåŠ¨æ”¯æŒå®‰è£…åˆ°/mnt ã€‚/mntä¸‹é¢å¯ä»¥åˆ†ä¸ºè®¸å¤šå­ç›®å½•ï¼Œä¾‹å¦‚/mnt/dosaå¯èƒ½æ˜¯ä½¿ç”¨ msdosæ–‡ä»¶ç³»ç»Ÿçš„è½¯é©±ï¼Œè€Œ/mnt/extaå¯èƒ½æ˜¯ä½¿ç”¨ext2æ–‡ä»¶ç³»ç»Ÿçš„è½¯é©±ï¼Œ/mnt/cdromå…‰ é©±ç­‰ç­‰ã€‚ 11. /proc, /usr, /var, /homeç›®å½• å…¶ä»–æ–‡ä»¶ç³»ç»Ÿçš„å®‰è£…ç‚¹ã€‚ ç›®å½•æ ‘å¯ä»¥åˆ†ä¸ºå°çš„éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†å¯ä»¥åœ¨è‡ªå·±çš„ç£ç›˜æˆ–åˆ†åŒºä¸Šã€‚ä¸»è¦éƒ¨åˆ†æ˜¯æ ¹ã€/usr ã€/var å’Œ /home æ–‡ä»¶ç³»ç»Ÿã€‚æ¯ä¸ªéƒ¨åˆ†æœ‰ä¸åŒçš„ç›®çš„ã€‚ æ¯å°æœºå™¨éƒ½æœ‰æ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒåŒ…å«ç³»ç»Ÿå¼•å¯¼å’Œä½¿å…¶ä»–æ–‡ä»¶ç³»ç»Ÿå¾—ä»¥mountæ‰€å¿…è¦çš„æ–‡ä»¶ï¼Œæ ¹æ–‡ä»¶ç³»ç»Ÿåº”è¯¥æœ‰å•ç”¨æˆ·çŠ¶æ€æ‰€å¿…é¡»çš„è¶³å¤Ÿçš„å†…å®¹ã€‚è¿˜åº”è¯¥åŒ…æ‹¬ä¿®å¤æŸå ç³»ç»Ÿã€æ¢å¤å¤‡ä»½ç­‰çš„å·¥å…·ã€‚ /usr æ–‡ä»¶ç³»ç»ŸåŒ…å«æ‰€æœ‰å‘½ä»¤ã€åº“ã€mané¡µå’Œå…¶ä»–ä¸€èˆ¬æ“ä½œä¸­æ‰€éœ€çš„ä¸æ”¹å˜çš„æ–‡ä»¶ã€‚ /usr ä¸åº”è¯¥æœ‰ ä¸€èˆ¬ä½¿ç”¨ä¸­è¦ä¿®æ”¹çš„æ–‡ä»¶ã€‚è¿™æ ·å…è®¸æ­¤æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶é€šè¿‡ç½‘ç»œå…±äº«ï¼Œè¿™æ ·å¯ä»¥æ›´æœ‰æ•ˆï¼Œå› ä¸ºè¿™æ ·èŠ‚çœäº†ç£ç›˜ç©ºé—´(/usr å¾ˆå®¹æ˜“æ˜¯æ•°ç™¾å…†)ï¼Œä¸”æ˜“äºç®¡ç† (å½“å‡çº§åº”ç”¨æ—¶ï¼Œåªæœ‰ä¸»/usr éœ€è¦æ”¹å˜ï¼Œè€Œæ— é¡»æ”¹å˜æ¯å°æœºå™¨) å³ä½¿æ­¤æ–‡ä»¶ç³»ç»Ÿåœ¨æœ¬åœ°ç›˜ä¸Šï¼Œä¹Ÿå¯ä»¥åªè¯»mountï¼Œä»¥å‡å°‘ç³»ç»Ÿå´©æºƒæ—¶æ–‡ä»¶ç³»ç»Ÿçš„æŸ åã€‚ /var æ–‡ä»¶ç³»ç»ŸåŒ…å«ä¼šæ”¹å˜çš„æ–‡ä»¶ï¼Œæ¯”å¦‚spoolç›®å½•(mailã€newsã€æ‰“å°æœºç­‰ç”¨çš„)ï¼Œ logæ–‡ä»¶ã€ formatted manual pageså’Œæš‚å­˜æ–‡ä»¶ã€‚ä¼ ç»Ÿä¸Š/var çš„æ‰€æœ‰ä¸œè¥¿æ›¾åœ¨ /usr ä¸‹çš„æŸä¸ªåœ°æ–¹ï¼Œä½†è¿™æ ·/usr å°±ä¸å¯èƒ½åªè¯»å®‰è£… äº†ã€‚ /home æ–‡ä»¶ç³»ç»ŸåŒ…å«ç”¨æˆ·å®¶ç›®å½•ï¼Œå³ç³»ç»Ÿä¸Šçš„æ‰€æœ‰å®é™…æ•°æ®ã€‚ä¸€ä¸ªå¤§çš„/home å¯èƒ½è¦åˆ†ä¸ºè‹¥å¹²æ–‡ä»¶ç³»ç»Ÿï¼Œéœ€è¦åœ¨ /home ä¸‹åŠ ä¸€çº§åå­—ï¼Œå¦‚/home/students ã€/home/staff ç­‰ã€‚ ä¸‹é¢è¯¦ç»†ä»‹ç»ï¼š /etcæ–‡ä»¶ç³»ç»Ÿ /etcç›®å½•åŒ…å«å„ç§ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œä¸‹é¢è¯´æ˜å…¶ä¸­çš„ä¸€äº›ã€‚å…¶ä»–çš„ä½ åº”è¯¥çŸ¥é“å®ƒä»¬å±äºå“ªä¸ªç¨‹åºï¼Œ å¹¶é˜…è¯»è¯¥ç¨‹åºçš„mané¡µã€‚è®¸å¤šç½‘ç»œé…ç½®æ–‡ä»¶ä¹Ÿåœ¨/etcä¸­ã€‚ /etc/rcæˆ–/etc/rc.dæˆ–/etc/rc?.dï¼šå¯åŠ¨ã€æˆ–æ”¹å˜è¿è¡Œçº§æ—¶è¿ è¡Œçš„è„šæœ¬æˆ–è„šæœ¬çš„ç›®å½•ã€‚ /etc/passwdï¼šç”¨æˆ·æ•°æ®åº“ï¼Œå…¶ä¸­çš„åŸŸç»™å‡ºäº†ç”¨æˆ·åã€çœŸå®å§“åã€ç”¨æˆ·èµ·å§‹ç›® å½•ã€åŠ å¯†å£ä»¤å’Œç”¨æˆ·çš„å…¶ä»–ä¿¡æ¯ã€‚ /etc/fdprmï¼šè½¯ç›˜å‚æ•°è¡¨ï¼Œç”¨ä»¥è¯´æ˜ä¸åŒçš„è½¯ç›˜æ ¼å¼ã€‚å¯ç”¨setfdprmè¿› è¡Œè®¾ç½®ã€‚æ›´å¤šçš„ä¿¡æ¯è§setfdprmçš„å¸®åŠ©é¡µã€‚ /etc/fstabï¼šæŒ‡å®šå¯åŠ¨æ—¶éœ€è¦è‡ªåŠ¨å®‰è£…çš„æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨ã€‚ä¹ŸåŒ…æ‹¬ç”¨swapon -aå¯ç”¨çš„swapåŒºçš„ä¿¡æ¯ã€‚ /etc/groupï¼šç±»ä¼¼/etc/passwd ï¼Œä½†è¯´æ˜çš„ä¸æ˜¯ç”¨æˆ·ä¿¡æ¯è€Œæ˜¯ç»„çš„ä¿¡æ¯ã€‚åŒ…æ‹¬ç»„çš„å„ç§æ•°æ®ã€‚ /etc/inittabï¼šinit çš„é…ç½®æ–‡ä»¶ã€‚ /etc/issueï¼šåŒ…æ‹¬ç”¨æˆ·åœ¨ç™»å½•æç¤ºç¬¦å‰çš„è¾“å‡ºä¿¡æ¯ã€‚é€šå¸¸åŒ…æ‹¬ç³»ç»Ÿçš„ä¸€æ®µçŸ­è¯´æ˜ æˆ–æ¬¢è¿ä¿¡æ¯ã€‚å…·ä½“å†…å®¹ç”±ç³»ç»Ÿç®¡ç†å‘˜ç¡®å®šã€‚ /etc/magicï¼šâ€œfileâ€çš„é…ç½®æ–‡ä»¶ã€‚åŒ…å«ä¸åŒæ–‡ä»¶æ ¼å¼çš„è¯´ æ˜ï¼Œâ€œfileâ€åŸºäºå®ƒçŒœæµ‹æ–‡ä»¶ç±»å‹ã€‚ /etc/motdï¼šmotdæ˜¯message of the dayçš„ç¼©å†™ï¼Œç”¨æˆ·æˆåŠŸç™»å½•åè‡ªåŠ¨è¾“å‡ºã€‚å†…å®¹ç”±ç³»ç»Ÿç®¡ç†å‘˜ç¡®å®šã€‚ å¸¸ç”¨äºé€šå‘Šä¿¡æ¯ï¼Œå¦‚è®¡åˆ’å…³æœºæ—¶é—´çš„è­¦å‘Šç­‰ã€‚ /etc/mtabï¼šå½“å‰å®‰è£…çš„æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨ã€‚ç”±è„šæœ¬(scritp)åˆå§‹åŒ–ï¼Œå¹¶ç”± mountå‘½ä»¤è‡ªåŠ¨æ›´æ–°ã€‚å½“éœ€è¦ä¸€ä¸ªå½“å‰å®‰è£…çš„æ–‡ä»¶ç³»ç»Ÿçš„åˆ—è¡¨æ—¶ä½¿ç”¨(ä¾‹å¦‚dfå‘½ä»¤)ã€‚ /etc/shadowï¼šåœ¨å®‰è£…äº†å½±å­(shadow)å£ä»¤è½¯ä»¶çš„ç³»ç»Ÿä¸Šçš„å½±å­å£ä»¤ æ–‡ä»¶ã€‚å½±å­å£ä»¤æ–‡ä»¶å°†/etc/passwdæ–‡ä»¶ä¸­çš„åŠ å¯†å£ä»¤ç§»åŠ¨åˆ°/etc/shadowä¸­ï¼Œè€Œåè€…åªå¯¹è¶…çº§ç”¨æˆ·(root)å¯è¯»ã€‚è¿™ä½¿ç ´è¯‘å£ä»¤æ›´å›° éš¾ï¼Œä»¥æ­¤å¢åŠ ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚ /etc/login.defsï¼šloginå‘½ä»¤çš„é…ç½®æ–‡ä»¶ã€‚ /etc/printcapï¼šç±»ä¼¼/etc/termcap ï¼Œä½†é’ˆå¯¹æ‰“å°æœºã€‚è¯­æ³•ä¸åŒã€‚ /etc/profile ã€/etc/csh.loginã€/etc/csh.cshrcï¼šç™» å½•æˆ–å¯åŠ¨æ—¶bourneæˆ–cshellsæ‰§è¡Œçš„æ–‡ä»¶ã€‚è¿™å…è®¸ç³»ç»Ÿç®¡ç†å‘˜ä¸ºæ‰€æœ‰ç”¨æˆ·å»ºç«‹å…¨å±€ç¼ºçœç¯å¢ƒã€‚ /etc/securettyï¼šç¡®è®¤å®‰å…¨ç»ˆç«¯ï¼Œå³å“ªä¸ªç»ˆç«¯å…è®¸è¶…çº§ç”¨æˆ·(root) ç™»å½•ã€‚ä¸€èˆ¬åªåˆ—å‡ºè™šæ‹Ÿæ§åˆ¶å°ï¼Œè¿™æ ·å°±ä¸å¯èƒ½(è‡³å°‘å¾ˆå›°éš¾)é€šè¿‡è°ƒåˆ¶è§£è°ƒå™¨(modem)æˆ–ç½‘ç»œé—¯å…¥ç³»ç»Ÿå¹¶å¾—åˆ°è¶…çº§ç”¨æˆ·ç‰¹æƒã€‚ /etc/shellsï¼šåˆ—å‡ºå¯ä»¥ä½¿ç”¨çš„shellã€‚chshå‘½ä»¤å…è®¸ç”¨æˆ·åœ¨æœ¬æ–‡ä»¶ æŒ‡å®šèŒƒå›´å†…æ”¹å˜ç™»å½•çš„shellã€‚æä¾›ä¸€å°æœºå™¨ftpæœåŠ¡çš„æœåŠ¡è¿›ç¨‹ftpdæ£€æŸ¥ç”¨æˆ·shellæ˜¯å¦åˆ—åœ¨/etc/shellsæ–‡ä»¶ ä¸­ï¼Œå¦‚æœä¸æ˜¯ï¼Œå°†ä¸å…è®¸è¯¥ç”¨æˆ·ç™»å½•ã€‚ /etc/termcapï¼šç»ˆç«¯æ€§èƒ½æ•°æ®åº“ã€‚è¯´æ˜ä¸åŒçš„ç»ˆç«¯ç”¨ä»€ä¹ˆâ€œè½¬ä¹‰åºåˆ—â€æ§ åˆ¶ã€‚å†™ç¨‹åºæ—¶ä¸ç›´æ¥è¾“å‡ºè½¬ä¹‰åºåˆ—(è¿™æ ·åªèƒ½å·¥ä½œäºç‰¹å®šå“ç‰Œçš„ç»ˆç«¯)ï¼Œè€Œæ˜¯ä»/etc/termcapä¸­æŸ¥æ‰¾è¦åšçš„å·¥ä½œçš„ æ­£ç¡®åºåˆ—ã€‚è¿™æ ·ï¼Œå¤šæ•°çš„ç¨‹åºå¯ä»¥åœ¨å¤šæ•°ç»ˆç«¯ä¸Šè¿è¡Œã€‚ /devæ–‡ä»¶ç³»ç»Ÿ /devç›®å½•åŒ…æ‹¬æ‰€æœ‰è®¾å¤‡çš„è®¾å¤‡æ–‡ä»¶ã€‚è®¾å¤‡æ–‡ä»¶ç”¨ç‰¹å®šçš„çº¦å®šå‘½åï¼Œè¿™åœ¨è®¾å¤‡åˆ—è¡¨ä¸­è¯´æ˜ã€‚è®¾å¤‡æ–‡ä»¶åœ¨å®‰è£…æ—¶ç”±ç³» ç»Ÿäº§ç”Ÿï¼Œä»¥åå¯ä»¥ç”¨/dev/makedevæè¿°ã€‚/dev/makedev.local æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä¸ºæœ¬åœ°è®¾å¤‡æ–‡ä»¶(æˆ–è¿æ¥)å†™çš„æè¿°æ–‡ç¨¿(å³å¦‚ä¸€äº›éæ ‡å‡†è®¾å¤‡é©±åŠ¨ä¸æ˜¯æ ‡å‡†makedev çš„ä¸€éƒ¨åˆ†)ã€‚ä¸‹é¢ç®€è¦ä»‹ç»/devä¸‹ ä¸€äº›å¸¸ç”¨æ–‡ä»¶ã€‚ /dev/consoleï¼šç³»ç»Ÿæ§åˆ¶å°ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥å’Œç³»ç»Ÿè¿æ¥çš„ç›‘è§†å™¨ã€‚ /dev/hdï¼šideç¡¬ç›˜é©±åŠ¨ç¨‹åºæ¥å£ã€‚å¦‚ï¼š/dev/hdaæŒ‡çš„æ˜¯ç¬¬ä¸€ä¸ªç¡¬ ç›˜ï¼Œhad1åˆ™æ˜¯æŒ‡/dev/hdaçš„ç¬¬ä¸€ä¸ªåˆ†åŒºã€‚å¦‚ç³»ç»Ÿä¸­æœ‰å…¶ä»–çš„ç¡¬ç›˜ï¼Œåˆ™ä¾æ¬¡ä¸º/dev /hdbã€/dev/hdcã€. . . . . .ï¼›å¦‚æœ‰å¤šä¸ªåˆ†åŒºåˆ™ä¾æ¬¡ä¸ºhda1ã€hda2 . . . . . . /dev/sdï¼šscsiç£ç›˜é©±åŠ¨ç¨‹åºæ¥å£ã€‚å¦‚ç³»ç»Ÿæœ‰scsiç¡¬ç›˜ï¼Œå°±ä¸ä¼šè®¿é—®/dev/hadï¼Œ è€Œä¼šè®¿é—®/dev/sdaã€‚ /dev/fdï¼šè½¯é©±è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚å¦‚ï¼š/dev/fd0æŒ‡ ç³»ç»Ÿçš„ç¬¬ä¸€ä¸ªè½¯ç›˜ï¼Œä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„aç›˜ï¼Œ/dev/fd1æŒ‡ç¬¬äºŒä¸ªè½¯ç›˜ï¼Œ. . . . . .è€Œ/dev/fd1 h1440åˆ™è¡¨ç¤ºè®¿é—®é©±åŠ¨å™¨1ä¸­çš„4.5é«˜å¯†ç›˜ã€‚ /dev/stï¼šscsiç£å¸¦é©±åŠ¨å™¨é©±åŠ¨ç¨‹åºã€‚ /dev/ttyï¼šæä¾›è™šæ‹Ÿæ§åˆ¶å°æ”¯æŒã€‚å¦‚ï¼š/dev/tty1æŒ‡ çš„æ˜¯ç³»ç»Ÿçš„ç¬¬ä¸€ä¸ªè™šæ‹Ÿæ§åˆ¶å°ï¼Œ/dev/tty2åˆ™æ˜¯ç³»ç»Ÿçš„ç¬¬äºŒä¸ªè™šæ‹Ÿæ§åˆ¶å°ã€‚ /dev/ptyï¼šæä¾›è¿œç¨‹ç™»é™†ä¼ªç»ˆç«¯æ”¯æŒã€‚åœ¨è¿›è¡Œtelnetç™»å½•æ—¶å°±è¦ç”¨åˆ°/dev/ptyè®¾ å¤‡ã€‚ /dev/ttysï¼šè®¡ç®—æœºä¸²è¡Œæ¥å£ï¼Œå¯¹äºdosæ¥è¯´å°±æ˜¯â€œcom1â€å£ã€‚ /dev/cuaï¼šè®¡ç®—æœºä¸²è¡Œæ¥å£ï¼Œä¸è°ƒåˆ¶è§£è°ƒå™¨ä¸€èµ·ä½¿ç”¨çš„è®¾å¤‡ã€‚ /dev/nullï¼šâ€œé»‘æ´â€ï¼Œæ‰€æœ‰å†™å…¥è¯¥è®¾å¤‡çš„ä¿¡æ¯éƒ½å°†æ¶ˆå¤±ã€‚ä¾‹å¦‚ï¼šå½“æƒ³è¦å°†å±å¹• ä¸Šçš„è¾“å‡ºä¿¡æ¯éšè—èµ·æ¥æ—¶ï¼Œåªè¦å°†è¾“å‡ºä¿¡æ¯è¾“å…¥åˆ°/dev/nullä¸­å³å¯ã€‚ /usræ–‡ä»¶ç³»ç»Ÿ /usræ˜¯ä¸ªå¾ˆé‡è¦çš„ç›®å½•ï¼Œé€šå¸¸è¿™ä¸€æ–‡ä»¶ç³»ç»Ÿå¾ˆå¤§ï¼Œå› ä¸ºæ‰€æœ‰ç¨‹åºå®‰è£…åœ¨è¿™é‡Œã€‚/usré‡Œ çš„æ‰€æœ‰æ–‡ä»¶ä¸€èˆ¬æ¥è‡ªlinuxå‘è¡Œç‰ˆï¼›æœ¬åœ°å®‰è£…çš„ç¨‹åºå’Œå…¶ä»–ä¸œè¥¿åœ¨/usr/localä¸‹ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥åœ¨å‡çº§æ–°ç‰ˆç³» ç»Ÿæˆ–æ–°å‘è¡Œç‰ˆæ—¶æ— é¡»é‡æ–°å®‰è£…å…¨éƒ¨ç¨‹åºã€‚/usrç›®å½•ä¸‹çš„è®¸å¤šå†…å®¹æ˜¯å¯é€‰çš„ï¼Œä½†è¿™äº›åŠŸèƒ½ä¼šä½¿ç”¨æˆ·ä½¿ç”¨ç³»ç»Ÿæ›´åŠ æœ‰æ•ˆã€‚/usrå¯å®¹çº³è®¸å¤šå¤§å‹çš„è½¯ä»¶åŒ…å’Œå®ƒä»¬çš„ é…ç½®æ–‡ä»¶ã€‚ä¸‹é¢åˆ—å‡ºä¸€äº›é‡è¦çš„ç›®å½•(ä¸€äº›ä¸å¤ªé‡è¦çš„ç›®å½•è¢«çœç•¥äº†)ã€‚ /usr/x11r6ï¼šåŒ…å«x windowç³»ç»Ÿçš„æ‰€æœ‰å¯æ‰§è¡Œç¨‹åºã€é…ç½®æ–‡ä»¶å’Œæ”¯æŒæ–‡ä»¶ã€‚ä¸ºç®€åŒ–xçš„å¼€å‘å’Œå®‰è£…ï¼Œxçš„æ–‡ä»¶æ²¡æœ‰é›†æˆåˆ°ç³»ç»Ÿä¸­ã€‚x windowç³»ç»Ÿæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å›¾å½¢ç¯å¢ƒï¼Œæä¾›äº†å¤§é‡çš„å›¾å½¢å·¥å…·ç¨‹åºã€‚ç”¨æˆ·å¦‚æœå¯¹microsoft windowsæ¯”è¾ƒç†Ÿæ‚‰çš„è¯ï¼Œå°±ä¸ä¼šå¯¹x windowç³»ç»Ÿæ„Ÿåˆ°æŸæ‰‹æ— ç­–äº†ã€‚ /usr/x386ï¼šç±»ä¼¼/usr/x11r6 ï¼Œä½†æ˜¯æ˜¯ä¸“é—¨ç»™x 11 release 5çš„ã€‚ /usr/binï¼šé›†ä¸­äº†å‡ ä¹æ‰€æœ‰ç”¨æˆ·å‘½ä»¤ï¼Œæ˜¯ç³»ç»Ÿçš„è½¯ä»¶åº“ã€‚å¦æœ‰äº›å‘½ä»¤åœ¨/binæˆ–/usr/local/binä¸­ã€‚ /usr/sbinï¼šåŒ…æ‹¬äº†æ ¹æ–‡ä»¶ç³»ç»Ÿä¸å¿…è¦çš„ç³»ç»Ÿç®¡ç†å‘½ä»¤ï¼Œä¾‹å¦‚å¤šæ•°æœåŠ¡ç¨‹åºã€‚ /usr/manã€/usr/infoã€/usr/docï¼šè¿™äº›ç›®å½•åŒ…å«æ‰€æœ‰æ‰‹å†Œé¡µã€ gnuä¿¡æ¯æ–‡æ¡£å’Œå„ç§å…¶ä»–æ–‡æ¡£æ–‡ä»¶ã€‚æ¯ä¸ªè”æœºæ‰‹å†Œçš„â€œèŠ‚â€éƒ½æœ‰ä¸¤ä¸ªå­ç›®å½•ã€‚ä¾‹å¦‚ï¼š/usr/man/man1ä¸­åŒ…å«è”æœºæ‰‹å†Œç¬¬ä¸€èŠ‚çš„æºç (æ²¡æœ‰æ ¼å¼åŒ–çš„åŸ å§‹æ–‡ä»¶)ï¼Œ/usr/man/cat1åŒ…å«ç¬¬ä¸€èŠ‚å·²æ ¼å¼åŒ–çš„å†…å®¹ã€‚è”æœºæ‰‹å†Œåˆ†ä¸ºä»¥ä¸‹ä¹èŠ‚ï¼šå†…éƒ¨å‘½ä»¤ã€ç³»ç»Ÿè°ƒç”¨ã€åº“å‡½æ•°ã€è®¾å¤‡ã€æ–‡ä»¶æ ¼å¼ã€æ¸¸æˆã€å®è½¯ä»¶åŒ…ã€ ç³»ç»Ÿç®¡ç†å’Œæ ¸å¿ƒç¨‹åºã€‚ /usr/includeï¼šåŒ…å«äº†cè¯­è¨€çš„å¤´æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶å¤šä»¥.hç»“å°¾ï¼Œç”¨æ¥æè¿°c è¯­è¨€ç¨‹åºä¸­ç”¨åˆ°çš„æ•°æ®ç»“æ„ã€å­è¿‡ç¨‹å’Œå¸¸é‡ã€‚ä¸ºäº†ä¿æŒä¸€è‡´æ€§ï¼Œè¿™å®é™…ä¸Šåº”è¯¥æ”¾åœ¨/usr/libä¸‹ï¼Œä½†ä¹ æƒ¯ä¸Šä¸€ç›´æ²¿ç”¨äº†è¿™ ä¸ªåå­—ã€‚ /usr/libï¼šåŒ…å«äº†ç¨‹åºæˆ–å­ç³»ç»Ÿçš„ä¸å˜çš„æ•°æ®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›site â€“ wideé…ç½®æ–‡ä»¶ã€‚åå­—libæ¥æºäºåº“(library); ç¼–ç¨‹çš„åŸå§‹åº“ä¹Ÿå­˜åœ¨/usr/lib é‡Œã€‚å½“ç¼–è¯‘ç¨‹åºæ—¶ï¼Œç¨‹åºä¾¿ä¼šå’Œå…¶ä¸­çš„åº“è¿›è¡Œè¿æ¥ã€‚ä¹Ÿæœ‰è®¸å¤šç¨‹åºæŠŠé…ç½®æ–‡ä»¶å­˜å…¥å…¶ä¸­ã€‚ /usr/localï¼šæœ¬åœ°å®‰è£…çš„è½¯ä»¶å’Œå…¶ä»–æ–‡ä»¶æ”¾åœ¨è¿™é‡Œã€‚è¿™ä¸/usrå¾ˆç›¸ä¼¼ã€‚ç”¨æˆ· å¯èƒ½ä¼šåœ¨è¿™å‘ç°ä¸€äº›æ¯”è¾ƒå¤§çš„è½¯ä»¶åŒ…ï¼Œå¦‚texã€emacsç­‰ã€‚ /varæ–‡ä»¶ç³»ç»Ÿ /varåŒ…å«ç³»ç»Ÿä¸€èˆ¬è¿è¡Œæ—¶è¦æ”¹å˜çš„æ•°æ®ã€‚é€šå¸¸è¿™äº›æ•°æ®æ‰€åœ¨çš„ç›®å½•çš„å¤§å°æ˜¯è¦ç»å¸¸å˜åŒ–æˆ–æ‰©å…… çš„ã€‚åŸæ¥/varç›®å½•ä¸­æœ‰äº›å†…å®¹æ˜¯åœ¨/usrä¸­çš„ï¼Œä½†ä¸ºäº†ä¿æŒ/usrç›®å½•çš„ç›¸å¯¹ç¨³å®šï¼Œå°±æŠŠé‚£äº›éœ€è¦ç»å¸¸æ”¹å˜çš„ç›®å½•æ”¾åˆ°/varä¸­äº†ã€‚æ¯ä¸ªç³»ç»Ÿæ˜¯ç‰¹å®šçš„ï¼Œ å³ä¸é€šè¿‡ç½‘ç»œä¸å…¶ä»–è®¡ç®—æœºå…±äº«ã€‚ä¸‹é¢åˆ—å‡ºä¸€äº›é‡è¦çš„ç›®å½•(ä¸€äº›ä¸å¤ªé‡è¦çš„ç›®å½•çœç•¥äº†)ã€‚ /var/catmanï¼šåŒ…æ‹¬äº†æ ¼å¼åŒ–è¿‡çš„å¸®åŠ©(man)é¡µã€‚å¸®åŠ©é¡µçš„æºæ–‡ä»¶ä¸€èˆ¬å­˜åœ¨ /usr/man/catmanä¸­ï¼›æœ‰äº›mané¡µå¯èƒ½æœ‰é¢„æ ¼å¼åŒ–çš„ç‰ˆæœ¬ï¼Œå­˜åœ¨/usr/man/catä¸­ã€‚è€Œå…¶ä»–çš„mané¡µåœ¨ç¬¬ä¸€æ¬¡çœ‹æ—¶éƒ½éœ€è¦æ ¼å¼åŒ–ï¼Œæ ¼ å¼åŒ–å®Œçš„ç‰ˆæœ¬å­˜åœ¨/var/manä¸­ï¼Œè¿™æ ·å…¶ä»–äººå†çœ‹ç›¸åŒçš„é¡µæ—¶å°±æ— é¡»ç­‰å¾…æ ¼å¼åŒ–äº†ã€‚(/var/catmanç»å¸¸è¢« æ¸…é™¤ï¼Œå°±åƒæ¸…é™¤ä¸´æ—¶ç›®å½•ä¸€æ ·ã€‚) /var/libï¼šå­˜æ”¾ç³»ç»Ÿæ­£å¸¸è¿è¡Œæ—¶è¦æ”¹å˜çš„æ–‡ä»¶ã€‚ /var/localï¼šå­˜æ”¾/usr/localä¸­ å®‰è£…çš„ç¨‹åºçš„å¯å˜æ•°æ®(å³ç³»ç»Ÿç®¡ç†å‘˜å®‰è£…çš„ç¨‹åº)ã€‚æ³¨æ„ï¼Œå¦‚æœå¿…è¦ï¼Œå³ä½¿æœ¬åœ°å®‰è£…çš„ç¨‹åºä¹Ÿä¼šä½¿ç”¨å…¶ä»–/varç›®å½•ï¼Œä¾‹å¦‚/var/lock ã€‚ /var/lockï¼šé”å®šæ–‡ä»¶ã€‚è®¸å¤šç¨‹åºéµå¾ªåœ¨/var/lockä¸­ äº§ç”Ÿä¸€ä¸ªé”å®šæ–‡ä»¶çš„çº¦å®šï¼Œä»¥ç”¨æ¥æ”¯æŒä»–ä»¬æ­£åœ¨ä½¿ç”¨æŸä¸ªç‰¹å®šçš„è®¾å¤‡æˆ–æ–‡ä»¶ã€‚å…¶ä»–ç¨‹åºæ³¨æ„åˆ°è¿™ä¸ªé”å®šæ–‡ä»¶æ—¶ï¼Œå°±ä¸ä¼šå†ä½¿ç”¨è¿™ä¸ªè®¾å¤‡æˆ–æ–‡ä»¶ã€‚ /var/logï¼šå„ç§ç¨‹åºçš„æ—¥å¿—(log)æ–‡ä»¶ï¼Œå°¤å…¶æ˜¯login (/var/log/wtmplogçºª å½•æ‰€æœ‰åˆ°ç³»ç»Ÿçš„ç™»å½•å’Œæ³¨é”€) å’Œsyslog (/var/log/messages çºªå½•å­˜å‚¨æ‰€æœ‰æ ¸å¿ƒå’Œç³»ç»Ÿç¨‹åºä¿¡æ¯)ã€‚/var/log é‡Œçš„æ–‡ä»¶ç»å¸¸ä¸ç¡®å®šåœ°å¢é•¿ï¼Œåº”è¯¥å®šæœŸæ¸…é™¤ã€‚ /var/runï¼šä¿å­˜åœ¨ä¸‹ä¸€æ¬¡ç³»ç»Ÿå¼•å¯¼å‰æœ‰æ•ˆçš„å…³äºç³»ç»Ÿçš„ä¿¡æ¯æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œ/var/run/utmpåŒ… å«å½“å‰ç™»å½•çš„ç”¨æˆ·çš„ä¿¡æ¯ã€‚ /var/spoolï¼šæ”¾ç½®â€œå‡è„±æœº(spool)â€ç¨‹åºçš„ç›®å½•ï¼Œå¦‚mailã€ newsã€æ‰“å°é˜Ÿåˆ—å’Œå…¶ä»–é˜Ÿåˆ—å·¥ä½œçš„ç›®å½•ã€‚æ¯ä¸ªä¸åŒçš„spoolåœ¨/var/spoolä¸‹æœ‰è‡ªå·±çš„å­ç›®å½•ï¼Œä¾‹å¦‚ï¼Œç”¨æˆ·çš„é‚®ç®±å°±å­˜æ”¾åœ¨/var/spool/mail ä¸­ã€‚ \\8. /var/tmpï¼šæ¯”/tmpå…è®¸æ›´å¤§çš„æˆ–éœ€è¦å­˜åœ¨è¾ƒé•¿æ—¶é—´çš„ä¸´æ—¶æ–‡ä»¶ã€‚æ³¨æ„ç³»ç»Ÿç®¡ç† å‘˜å¯èƒ½ä¸å…è®¸/var/tmpæœ‰å¾ˆæ—§çš„æ–‡ä»¶ã€‚ /procæ–‡ä»¶ç³»ç»Ÿ /procæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ªçš„æ–‡ä»¶ç³»ç»Ÿï¼Œå°±æ˜¯è¯´å®ƒæ˜¯ä¸€ä¸ªå®é™…ä¸Šä¸å­˜åœ¨çš„ç›®å½•ï¼Œå› è€Œè¿™æ˜¯ä¸€ä¸ªé å¸¸ç‰¹æ®Šçš„ç›®å½•ã€‚å®ƒå¹¶ä¸å­˜åœ¨äºæŸä¸ªç£ç›˜ä¸Šï¼Œè€Œæ˜¯ç”±æ ¸å¿ƒåœ¨å†…å­˜ä¸­äº§ç”Ÿã€‚è¿™ä¸ªç›®å½•ç”¨äºæä¾›å…³äºç³»ç»Ÿçš„ä¿¡æ¯ã€‚ä¸‹é¢è¯´æ˜ä¸€äº›æœ€é‡è¦çš„æ–‡ä»¶å’Œç›®å½•(/procæ–‡ä»¶ç³»ç»Ÿ åœ¨proc mané¡µä¸­æœ‰æ›´è¯¦ç»†çš„è¯´æ˜)ã€‚ /proc/xï¼šå…³äºè¿›ç¨‹xçš„ä¿¡æ¯ç›®å½•ï¼Œè¿™xæ˜¯è¿™ä¸€è¿›ç¨‹çš„æ ‡è¯†å·ã€‚æ¯ä¸ªè¿›ç¨‹åœ¨ /procä¸‹æœ‰ä¸€ä¸ªåä¸ºè‡ªå·±è¿›ç¨‹å·çš„ç›®å½•ã€‚ /proc/cpuinfoï¼šå­˜æ”¾å¤„ç†å™¨(cpu)çš„ä¿¡æ¯ï¼Œå¦‚cpuçš„ç±»å‹ã€åˆ¶é€ å•†ã€ å‹å·å’Œæ€§èƒ½ç­‰ã€‚ /proc/devicesï¼šå½“å‰è¿è¡Œçš„æ ¸å¿ƒé…ç½®çš„è®¾å¤‡é©±åŠ¨çš„åˆ—è¡¨ã€‚ /proc/dmaï¼šæ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„dmaé€šé“ã€‚ /proc/filesystemsï¼šæ ¸å¿ƒé…ç½®çš„æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯ã€‚ /proc/interruptsï¼šæ˜¾ç¤ºè¢«å ç”¨çš„ä¸­æ–­ä¿¡æ¯å’Œå ç”¨è€…çš„ä¿¡æ¯ï¼Œä»¥åŠè¢«å ç”¨ çš„æ•°é‡ã€‚ /proc/ioportsï¼šå½“å‰ä½¿ç”¨çš„i/oç«¯å£ã€‚ /proc/kcoreï¼šç³»ç»Ÿç‰©ç†å†…å­˜æ˜ åƒã€‚ä¸ç‰©ç†å†…å­˜å¤§å°å®Œå…¨ä¸€æ ·ï¼Œç„¶è€Œå®é™…ä¸Šæ²¡æœ‰ å ç”¨è¿™ä¹ˆå¤šå†…å­˜ï¼›å®ƒä»…ä»…æ˜¯åœ¨ç¨‹åºè®¿é—®å®ƒæ—¶æ‰è¢«åˆ›å»ºã€‚(æ³¨æ„ï¼šé™¤éä½ æŠŠå®ƒæ‹·è´åˆ°ä»€ä¹ˆåœ°æ–¹ï¼Œå¦åˆ™/procä¸‹æ²¡æœ‰ä»»ä½•ä¸œè¥¿å ç”¨ä»»ä½•ç£ç›˜ç©ºé—´ã€‚) /proc/kmsgï¼šæ ¸å¿ƒè¾“å‡ºçš„æ¶ˆæ¯ã€‚ä¹Ÿä¼šè¢«é€åˆ°syslogã€‚ /proc/ksymsï¼šæ ¸å¿ƒç¬¦å·è¡¨ã€‚ /proc/loadavgï¼šç³»ç»Ÿâ€œå¹³å‡è´Ÿè½½â€ï¼›3ä¸ªæ²¡æœ‰æ„ä¹‰çš„æŒ‡ç¤ºå™¨æŒ‡å‡ºç³»ç»Ÿå½“å‰ çš„å·¥ä½œé‡ã€‚ /proc/meminfoï¼šå„ç§å­˜å‚¨å™¨ä½¿ç”¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜å’Œäº¤æ¢åˆ†åŒº (swap)ã€‚ /proc/modulesï¼šå­˜æ”¾å½“å‰åŠ è½½äº†å“ªäº›æ ¸å¿ƒæ¨¡å—ä¿¡æ¯ã€‚ /proc/netï¼šç½‘ç»œåè®®çŠ¶æ€ä¿¡æ¯ã€‚ /proc/selfï¼šå­˜æ”¾åˆ°æŸ¥çœ‹/procçš„ ç¨‹åºçš„è¿›ç¨‹ç›®å½•çš„ç¬¦å·è¿æ¥ã€‚å½“2ä¸ªè¿›ç¨‹æŸ¥çœ‹/procæ—¶ï¼Œè¿™å°†ä¼šæ˜¯ä¸åŒçš„è¿æ¥ã€‚è¿™ä¸»è¦ä¾¿äºç¨‹åºå¾—åˆ°å®ƒè‡ªå·±çš„è¿›ç¨‹ç›®å½•ã€‚ /proc/statï¼šç³»ç»Ÿçš„ä¸åŒçŠ¶æ€ï¼Œä¾‹å¦‚ï¼Œç³»ç»Ÿå¯åŠ¨åé¡µé¢å‘ç”Ÿé”™è¯¯çš„æ¬¡æ•°ã€‚ /proc/uptimeï¼šç³»ç»Ÿå¯åŠ¨çš„æ—¶é—´é•¿åº¦ã€‚ /proc/versionï¼šæ ¸å¿ƒç‰ˆæœ¬ã€‚ /usr/localä¸‹ä¸€èˆ¬æ˜¯ä½ å®‰è£…è½¯ä»¶çš„ç›®å½•ï¼Œè¿™ä¸ªç›®å½•å°±ç›¸å½“äºåœ¨windowsä¸‹çš„programefilesè¿™ä¸ªç›®å½• /optè¿™ä¸ªç›®å½•æ˜¯ä¸€äº›å¤§å‹è½¯ä»¶çš„å®‰è£…ç›®å½•ï¼Œæˆ–è€…æ˜¯ä¸€äº›æœåŠ¡ç¨‹åºçš„å®‰è£…ç›®å½• ä¸¾ä¸ªä¾‹å­ï¼šåˆšæ‰è£…çš„æµ‹è¯•ç‰ˆfirefoxï¼Œå°±å¯ä»¥è£…åˆ°/opt/firefox_betaç›®å½•ä¸‹ï¼Œ/opt/firefox_betaç›®å½•ä¸‹é¢å°±åŒ…å«äº†è¿ è¡Œfirefoxæ‰€éœ€è¦çš„æ‰€æœ‰æ–‡ä»¶ã€åº“ã€æ•°æ®ç­‰ç­‰ã€‚è¦åˆ é™¤firefoxçš„æ—¶å€™ï¼Œä½ åªéœ€åˆ é™¤/opt/firefox_betaç›®å½•å³å¯ï¼Œéå¸¸ç®€å•ã€‚ /usr/local è¿™é‡Œä¸»è¦å­˜æ”¾é‚£äº›æ‰‹åŠ¨å®‰è£…çš„è½¯ä»¶ï¼Œå³ ä¸æ˜¯é€šè¿‡â€œæ–°ç«‹å¾—â€æˆ–apt-getå®‰è£…çš„è½¯ä»¶ ã€‚ å®ƒå’Œ/usrç›®å½•å…·æœ‰ç›¸ç±»ä¼¼çš„ç›®å½•ç»“æ„ ã€‚è®©è½¯ä»¶åŒ…ç®¡ç†å™¨æ¥ç®¡ç†/usrç›®å½•ï¼Œè€ŒæŠŠè‡ªå®šä¹‰çš„è„šæœ¬(scripts)æ”¾åˆ°/usr/localç›®å½•ä¸‹é¢ï¼Œæˆ‘æƒ³è¿™åº”è¯¥æ˜¯ä¸ªä¸é”™çš„ä¸»æ„ã€‚","categories":[{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/tags/Linux/"}]},{"title":"xdebugæ–­ç‚¹è°ƒè¯•å®‰è£…","slug":"xdebugæ–­ç‚¹è°ƒè¯•å®‰è£…","date":"2018-01-22T11:16:08.000Z","updated":"2022-03-19T14:35:21.837Z","comments":true,"path":"2018/01/22/146/","link":"","permalink":"https://github.13sai.com/2018/01/22/146/","excerpt":"","text":"å®‰è£…å‡†å¤‡ï¼šPHPç¯å¢ƒï¼ˆæˆ‘ä½¿ç”¨çš„æ˜¯nginx1.12+php7ï¼‰PHPStorm1. ä¸‹è½½dllæ‰©å±•æ”¾åˆ°PHPç›®å½•ä¸‹extä¸­ã€‚2. ä¿®æ”¹php.ini;æ³¨æ„æ˜¯zend_extension zend_extension=php_xdebug.dll ;è¿œç¨‹åœ°å€,æŒ‡çš„æ˜¯è¿æ¥æœ¬phpæ‰€åœ¨æœåŠ¡å™¨çš„å®¢æˆ·ç«¯ip xdebug.remote_host=127.0.0.1 ;è¿œç¨‹ç«¯å£ï¼Œä¸è¦å†²çª xdebug.remote_port=9999 xdebug.remote_handler=dbgp xdebug.collect_vars&nbsp;=&nbsp;On xdebug.collect_return&nbsp;=&nbsp;On xdebug.collect_params&nbsp;=&nbsp;On ;ç¼–è¾‘å™¨åç§° xdebug.idekey=phpstorm xdebug.profiler_output_dir=&quot;D:\\wnmp\\php-7.0.26 mpï¿½bug&quot;&nbsp; ;è®¾å®šå‡½æ•°è°ƒç”¨ç›‘æµ‹ä¿¡æ¯çš„è¾“å‡ºæ–‡ä»¶çš„è·¯å¾„ xdebug.trace_output_dir=&quot;D:\\wnmp\\php-7.0.26 mpï¿½bug&quot; xdebug.remote_enable&nbsp;=1xdebug.remote_mode&nbsp;=&nbsp;req xdebug.profiler_enable&nbsp;=&nbsp;off xdebug.profiler_enable_trigger&nbsp;=&nbsp;off ;å¼€å¯è¿œç¨‹è°ƒè¯•è‡ªåŠ¨ xdebug.remote_autostart&nbsp;=&nbsp;Oné…ç½®æˆåŠŸï¼Œåœ¨phpinfoé¡µé¢ä¼šå‡ºç°xdebugç‰ˆæœ¬å’Œidekeyã€‚3. PHPStormé…ç½®settings:&gt;&nbsp;Languages&nbsp;&amp;&nbsp;Frameworks&nbsp;â†’&nbsp;PHP&nbsp; é…ç½®å¯¹åº”çš„interpreterï¼Œå…¶å®å°±æ˜¯è®¾ç½®ä¸‹PHP&nbsp;executableè·¯å¾„ å¦‚ï¼šD:\\wnmp\\php-7.0.26\\php.exe &gt;&nbsp;Languages&nbsp;&amp;&nbsp;Frameworks&nbsp;â†’&nbsp;PHP&nbsp;â†’&nbsp;Debug&nbsp;ä¿®æ”¹ç«¯å£ &gt;&nbsp;Languages&nbsp;&amp;&nbsp;Frameworks&nbsp;â†’&nbsp;PHP&nbsp;â†’&nbsp;Debug&nbsp;â†’&nbsp;DBGp&nbsp;Proxyå°±æ˜¯ä¸Šé¢phpè®¾ç½®çš„idekeyï¼Œhostï¼Œportã€‚ &gt;&nbsp;Languages&nbsp;&amp;&nbsp;Frameworks&nbsp;â†’&nbsp;PHP&nbsp;â†’&nbsp;Serversæ·»åŠ é€‰æ‹©Xdebugå®ŒæˆåRun&nbsp;â†’&nbsp;Edit&nbsp;Configurationæ·»åŠ ä¸€ä¸ªPHP&nbsp;web&nbsp;applicationé…ç½®ï¼Œé€‰æ‹©åˆšæ‰é…ç½®çš„Serversè¿™æ ·å°±å®Œæˆäº†ï¼runï¼Œdebugéƒ½èƒ½ç›´æ¥ç”¨èµ·æ¥äº†ã€‚","categories":[{"name":"debug","slug":"debug","permalink":"https://github.13sai.com/categories/debug/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"redisçš„windowså°è¯•","slug":"redisçš„windowså°è¯•","date":"2018-01-16T03:37:20.000Z","updated":"2022-03-19T14:35:21.801Z","comments":true,"path":"2018/01/16/145/","link":"","permalink":"https://github.13sai.com/2018/01/16/145/","excerpt":"","text":"Redis???Redis æ˜¯ä¸€ä¸ªå¼€æºï¼ˆBSDè®¸å¯ï¼‰çš„ï¼Œå†…å­˜ä¸­çš„æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå®ƒå¯ä»¥ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ã€‚ å®ƒæ”¯æŒå¤šç§ç±»å‹çš„æ•°æ®ç»“æ„ï¼Œå¦‚ å­—ç¬¦ä¸²ï¼ˆstringsï¼‰ï¼Œ æ•£åˆ—ï¼ˆhashesï¼‰ï¼Œ åˆ—è¡¨ï¼ˆlistsï¼‰ï¼Œ é›†åˆï¼ˆsetsï¼‰ï¼Œ æœ‰åºé›†åˆï¼ˆsorted setsï¼‰ ä¸èŒƒå›´æŸ¥è¯¢ï¼Œ bitmapsï¼Œ hyperloglogs å’Œ åœ°ç†ç©ºé—´ï¼ˆgeospatialï¼‰ ç´¢å¼•åŠå¾„æŸ¥è¯¢ã€‚ Redis å†…ç½®äº† å¤åˆ¶ï¼ˆreplicationï¼‰ï¼ŒLUAè„šæœ¬ï¼ˆLua scriptingï¼‰ï¼Œ LRUé©±åŠ¨äº‹ä»¶ï¼ˆLRU evictionï¼‰ï¼Œäº‹åŠ¡ï¼ˆtransactionsï¼‰ å’Œä¸åŒçº§åˆ«çš„ ç£ç›˜æŒä¹…åŒ–ï¼ˆpersistenceï¼‰ï¼Œ å¹¶é€šè¿‡ Rediså“¨å…µï¼ˆSentinelï¼‰å’Œè‡ªåŠ¨ åˆ†åŒºï¼ˆClusterï¼‰æä¾›é«˜å¯ç”¨æ€§ï¼ˆhigh availabilityï¼‰ã€‚ä¸‹è½½å®‰è£…githubä¸Šä¸‹è½½åˆé€‚ç‰ˆæœ¬ï¼Œå»ºè®®msiæ–‡ä»¶ä¸‹è½½ã€‚https://github.com/MicrosoftArchive/redis/releasesä¸€æ­¥æ­¥å®‰è£…å³å¯ã€‚å¯åŠ¨redisåˆ°è¾¾rediså®‰è£…ç›®å½•ï¼Œæ‰§è¡Œå¯åŠ¨å‘½ä»¤ï¼šredis-server --service-startå¦‚æœå¯åŠ¨å¤±è´¥ï¼ŒæŠ¥1060ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼šredis-server --service-install redis.windows.confæˆåŠŸåå†æ¬¡æ‰§è¡Œå¯åŠ¨å‘½ä»¤å³å¯ã€‚å¸¸ç”¨å‘½ä»¤å¯åŠ¨æœåŠ¡ï¼šredis-server&nbsp;--service-startåœæ­¢æœåŠ¡ï¼šredis-server&nbsp;--service-stopå®‰è£…redis Desktop manageré“¾æ¥ï¼šhttps://pan.baidu.com/s/1dL4oHK&nbsp;å¯†ç ï¼š3v6oå®‰è£…è¿æ¥æœ¬åœ°redis,å¯ä»¥æŸ¥çœ‹redisæ•°æ®ã€‚ä½¿ç”¨redis&lt;?php$redis&nbsp;=&nbsp;new&nbsp;Redis(); $ret&nbsp;=&nbsp;$redis-&gt;connect(&#39;127.0.0.1&#39;,&nbsp;6379); if(!$ret){&nbsp;&nbsp;&nbsp;&nbsp; die(&#39;connect&nbsp;error&#39;); } echo&nbsp;&quot;Connection&nbsp;to&nbsp;server&nbsp;sucessfully!&lt;br&gt;&quot;; //å­˜å‚¨æ•°æ®åˆ°åˆ—è¡¨ä¸­ $a&nbsp;=&nbsp;$redis-&gt;set(&#39;str&#39;,&#39;wow&#39;); $b&nbsp;=&nbsp;$redis-&gt;get(&#39;str&#39;); $c&nbsp;=&nbsp;$redis-&gt;get(&#39;strwww&#39;); $d&nbsp;=&nbsp;$redis-&gt;delete(&#39;str&#39;); var_dump($a);echo(&quot;&lt;br&gt;&quot;); var_dump($b);echo(&quot;&lt;br&gt;&quot;); var_dump($c);echo(&quot;&lt;br&gt;&quot;); var_dump($d); Connection&nbsp;to&nbsp;server&nbsp;sucessfully!bool(true)&nbsp;string(3)&nbsp;&quot;wow&quot;&nbsp;bool(false)&nbsp;int(1)","categories":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/categories/redis/"}],"tags":[{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/tags/redis/"}]},{"title":"ç¥å¥‡çš„è½¯é“¾æ¥","slug":"ç¥å¥‡çš„è½¯é“¾æ¥","date":"2018-01-15T01:47:10.000Z","updated":"2022-03-19T14:35:21.926Z","comments":true,"path":"2018/01/15/144/","link":"","permalink":"https://github.13sai.com/2018/01/15/144/","excerpt":"","text":"ä»€ä¹ˆæ˜¯é“¾æ¥ï¼Ÿé“¾æ¥ç®€å•è¯´å®é™…ä¸Šæ˜¯ä¸€ç§æ–‡ä»¶å…±äº«çš„æ–¹å¼ï¼Œæ˜¯ POSIX ä¸­çš„æ¦‚å¿µï¼Œä¸»æµæ–‡ä»¶ç³»ç»Ÿéƒ½æ”¯æŒé“¾æ¥æ–‡ä»¶ã€‚ é“¾æ¥æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ï¼Ÿä½ å¯ä»¥å°†é“¾æ¥ç®€å•åœ°ç†è§£ä¸º Windows ä¸­å¸¸è§çš„å¿«æ·æ–¹å¼ï¼ˆæˆ–æ˜¯ OS X ä¸­çš„æ›¿èº«ï¼‰ï¼ŒLinux ä¸­å¸¸ç”¨å®ƒæ¥è§£å†³ä¸€äº›åº“ç‰ˆæœ¬çš„é—®é¢˜ï¼Œé€šå¸¸ä¹Ÿä¼šå°†ä¸€äº›ç›®å½•å±‚æ¬¡è¾ƒæ·±çš„æ–‡ä»¶é“¾æ¥åˆ°ä¸€ä¸ªæ›´æ˜“è®¿é—®çš„ç›®å½•ä¸­ã€‚åœ¨è¿™äº›ç”¨é€”ä¸Šï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨åˆ°è½¯é“¾æ¥ï¼ˆä¹Ÿç§°ç¬¦å·é“¾æ¥ï¼‰ã€‚ è½¯é“¾æ¥å’Œç¡¬é“¾æ¥çš„åŒºåˆ« ç¡¬é“¾æ¥ï¼š ä¸æ™®é€šæ–‡ä»¶æ²¡ä»€ä¹ˆä¸åŒï¼Œinode éƒ½æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶åœ¨ç¡¬ç›˜ä¸­çš„åŒºå— è½¯é“¾æ¥ï¼š ä¿å­˜äº†å…¶ä»£è¡¨çš„æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæ˜¯å¦å¤–ä¸€ç§æ–‡ä»¶ï¼Œåœ¨ç¡¬ç›˜ä¸Šæœ‰ç‹¬ç«‹çš„åŒºå—ï¼Œè®¿é—®æ—¶æ›¿æ¢è‡ªèº«è·¯å¾„ã€‚ å…·ä½“åŒºåˆ«å¯çœ‹è¿™ç¯‡æ–‡ç« ï¼š``https://www.jianshu.com/p/dde6a01c4094 ## Linuxåˆ›å»ºå‘½ä»¤ å®ä¾‹ï¼š ln -s /home/test /testlink &gt; ln -s a b ä¸­çš„ a å°±æ˜¯æºæ–‡ä»¶ï¼Œbæ˜¯é“¾æ¥æ–‡ä»¶å,å…¶ä½œç”¨æ˜¯å½“è¿›å…¥bç›®å½•ï¼Œå®é™…ä¸Šæ˜¯é“¾æ¥è¿›å…¥äº†aç›®å½• å¦‚ä¸Šé¢çš„ç¤ºä¾‹ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ ```cd /testlink/```çš„æ—¶å€™ å®é™…ä¸Šæ˜¯è¿›å…¥äº† ```/home/test/``` å€¼å¾—æ³¨æ„çš„æ˜¯æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™,åº”è¯¥æ˜¯aç›®å½•å·²ç»å»ºç«‹ï¼Œç›®å½•bæ²¡æœ‰å»ºç«‹ã€‚æˆ‘æœ€å¼€å§‹æ“ä½œçš„æ˜¯ä¹ŸæŠŠbç›®å½•ç»™å»ºç«‹äº†ï¼Œç»“æœå°±ä¸å¯¹äº† åˆ é™¤è½¯é“¾æ¥ï¼š rm -rf b æ³¨æ„ä¸æ˜¯rm -rf b/ ln a b æ˜¯å»ºç«‹ç¡¬é“¾æ¥ ## windowåˆ›å»ºå‘½ä»¤ MKLINK [[/D] | [/H] | [/J]] Link Target /D åˆ›å»ºç›®å½•ç¬¦å·é“¾æ¥ã€‚é»˜è®¤ä¸ºæ–‡ä»¶ ç¬¦å·é“¾æ¥ã€‚ /H åˆ›å»ºç¡¬é“¾æ¥ï¼Œè€Œä¸æ˜¯ç¬¦å·é“¾æ¥ã€‚ /J åˆ›å»ºç›®å½•è”æ¥ã€‚ Link æŒ‡å®šæ–°çš„ç¬¦å·é“¾æ¥åç§°ã€‚ Target æŒ‡å®šæ–°é“¾æ¥å¼•ç”¨çš„è·¯å¾„ (ç›¸å¯¹æˆ–ç»å¯¹)ã€‚","categories":[{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/tags/Linux/"}]},{"title":"windows7æ­å»ºphp7+nginx+mysqlç¯å¢ƒ","slug":"windows7æ­å»ºphp7+nginx+mysqlç¯å¢ƒ","date":"2017-12-22T07:14:37.000Z","updated":"2022-07-05T08:56:46.020Z","comments":true,"path":"2017/12/22/143/","link":"","permalink":"https://github.13sai.com/2017/12/22/143/","excerpt":"","text":"1. ä¸‹è½½nginxï¼Œphp7ï¼Œmysqlï¼Œå¹¶æ”¾ç½®åˆ°ä½ éœ€è¦çš„æ–‡ä»¶å¤¹2. nginxè¿›å…¥nginxç›®å½•ï¼Œå‘½ä»¤è¡Œstart nginxæµè§ˆå™¨è¿›å…¥localhostï¼Œä¼šçœ‹åˆ°welcome to nginxï¼3. é…ç½®phpphp.iniphp.ini-developmentå¤åˆ¶ä¸ºphp.iniä¿®æ”¹;è¿™é‡Œæ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µè€Œå®š extension_dir&nbsp;=&nbsp;&quot;D:/wnmp/php-7.0.26/ext&quot; ;åŠ å…¥æ‰©å±•ï¼šé€‰æ‹©éœ€è¦è¿è¡Œå“ªäº›æ‰©å±•ï¼Œåªéœ€å°†extensionå‰é¢çš„æ³¨é‡Šå»æ‰ï¼Œä¾‹å¦‚ï¼š extension=php_mbstring.dll extension=php_exif.dll&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;Must&nbsp;be&nbsp;after&nbsp;mbstring&nbsp;as&nbsp;it&nbsp;depends&nbsp;on&nbsp;it extension=php_mysqli.dllCGI è®¾ç½®enable_dl&nbsp;=&nbsp;On cgi.force_redirect&nbsp;=&nbsp;0 cgi.fix_pathinfo&nbsp;=&nbsp;1 fastcgi.impersonate&nbsp;=&nbsp;1 cgi.rfc2616_headers&nbsp;=&nbsp;1ä¿®æ”¹nginxé…ç½®æ‰“å¼€D:\\wnmp ginx-1.12.2","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"windows","slug":"windows","permalink":"https://github.13sai.com/tags/windows/"}]},{"title":"selfå’Œstatic","slug":"selfå’Œstatic","date":"2017-12-07T11:38:59.000Z","updated":"2022-03-19T14:35:21.804Z","comments":true,"path":"2017/12/07/142/","link":"","permalink":"https://github.13sai.com/2017/12/07/142/","excerpt":"","text":"PHPå®˜æ–¹ä¹Ÿè¯´è¿‡ï¼Œå¤§æ¦‚æ˜¯è¯´selfè°ƒç”¨çš„å°±æ˜¯æœ¬èº«ä»£ç ç‰‡æ®µè¿™ä¸ªç±»ï¼Œè€Œstaticè°ƒç”¨çš„æ˜¯ä»å †å†…å­˜ä¸­æå–å‡ºæ¥ï¼Œè®¿é—®çš„æ˜¯å½“å‰å®ä¾‹åŒ–çš„é‚£ä¸ªç±»ï¼Œé‚£ä¹ˆ static ä»£è¡¨çš„å°±æ˜¯é‚£ä¸ªç±»ã€‚ class A &#123; protected static $str = &quot;This is class A&quot;; public static function getStr() &#123; echo self::$str; &#125; &#125; class B extends A &#123; protected static $str = &quot;This is class B&quot;; &#125; B::getStr();// è¾“å‡ºThis is class A class A &#123; protected static $str = &quot;This is class A&quot;; public static function getStr() &#123; echo static::$str; &#125; &#125; class B extends A &#123; protected static $str = &quot;This is class B&quot;; &#125; B::getStr();// è¾“å‡ºThis is class B self - å°±æ˜¯è¿™ä¸ªç±»ï¼Œæ˜¯ä»£ç æ®µé‡Œé¢çš„è¿™ä¸ªç±»ã€‚static - PHP 5.3æ–°ç‰¹æ€§ã€‚å½“å‰è¿™ä¸ªç±»ï¼Œæœ‰ç‚¹åƒ$thisçš„æ„æ€ï¼Œä»å †å†…å­˜ä¸­æå–å‡ºæ¥ï¼Œè®¿é—®çš„æ˜¯å½“å‰å®ä¾‹åŒ–çš„é‚£ä¸ªç±»ï¼Œé‚£ä¹ˆ static ä»£è¡¨çš„å°±æ˜¯é‚£ä¸ªç±»ã€‚ class A &#123; public function getSelf() &#123; return new self(); &#125; public function getStatic() &#123; return new static(); &#125; &#125; $f = new A(); print get_class($f-&gt;getSelf()); print get_class($f-&gt;getStatic()); class B extends A&#123; public function getSelf2() &#123; return new self(); &#125; public function getStatic2() &#123; return new static(); &#125; &#125; $f = new B(); print get_class($f-&gt;getSelf()); print get_class($f-&gt;getStatic()); print get_class($f-&gt;getSelf2()); print get_class($f-&gt;getStatic2());// è¾“å‡ºAAABBB","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"Gitå¸¸ç”¨å‘½ä»¤","slug":"Gitå¸¸ç”¨å‘½ä»¤","date":"2017-11-17T09:23:59.000Z","updated":"2022-03-19T14:35:21.587Z","comments":true,"path":"2017/11/17/141/","link":"","permalink":"https://github.13sai.com/2017/11/17/141/","excerpt":"","text":"ä¹‹å‰æ²¡ç”¨è¿‡gitï¼Œè¿˜åœ¨æŒç»­è¸©å‘ä¸­ï¼Œåç»­ç»§ç»­æ›´æ–°ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ åˆ—å‡ºtag git tag # åœ¨æ§åˆ¶å°æ‰“å°å‡ºå½“å‰ä»“åº“çš„æ‰€æœ‰tag&gt; git tag -l â€˜v0.1.*â€™ # æœç´¢ç¬¦åˆæ¨¡å¼çš„Tag æ‰“tag git tagåˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šè½»é‡tagå’Œé™„æ³¨tagã€‚è½»é‡tagæ˜¯æŒ‡å‘æäº¤å¯¹è±¡çš„å¼•ç”¨ï¼Œé™„æ³¨Tagåˆ™æ˜¯ä»“åº“ä¸­çš„ä¸€ä¸ªç‹¬ç«‹å¯¹è±¡ã€‚å»ºè®®ä½¿ç”¨é™„æ³¨Tagã€‚ åˆ›å»ºè½»é‡Tag git tag v0.1.2-light åˆ›å»ºé™„æ³¨Tag git tag -a v0.1.2 -m â€œ0.1.2ç‰ˆæœ¬â€ åˆ›å»ºè½»é‡Tagä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œç›´æ¥æŒ‡å®šTagåç§°å³å¯ã€‚ åˆ›å»ºé™„æ³¨Tagæ—¶ï¼Œå‚æ•°aå³annotatedçš„ç¼©å†™ï¼ŒæŒ‡å®šTagç±»å‹ï¼Œåé™„Tagåã€‚å‚æ•°mæŒ‡å®šTagè¯´æ˜ï¼Œè¯´æ˜ä¿¡æ¯ä¼šä¿å­˜åœ¨Tagå¯¹è±¡ä¸­ã€‚ åˆ‡æ¢åˆ°Tagä¸åˆ‡æ¢åˆ†æ”¯å‘½ä»¤ç›¸åŒï¼Œç”¨ git checkout [tagname] æŸ¥çœ‹Tagä¿¡æ¯ç”¨git showå‘½ä»¤å¯ä»¥æŸ¥çœ‹Tagçš„ç‰ˆæœ¬ä¿¡æ¯ï¼š git show v0.1.2 åˆ é™¤Tagè¯¯æ‰“æˆ–éœ€è¦ä¿®æ”¹Tagæ—¶ï¼Œéœ€è¦å…ˆå°†Tagåˆ é™¤ï¼Œå†æ‰“æ–°Tagã€‚ git tag -d v0.1.2 # åˆ é™¤Tag å‚æ•°då³deleteçš„ç¼©å†™ï¼Œæ„ä¸ºåˆ é™¤å…¶åæŒ‡å®šçš„Tagã€‚ ç»™æŒ‡å®šçš„commitæ‰“Tag æ‰“Tagä¸å¿…è¦åœ¨headä¹‹ä¸Šï¼Œä¹Ÿå¯åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸Šæ‰“ï¼Œè¿™éœ€è¦ä½ çŸ¥é“æŸä¸ªæäº¤å¯¹è±¡çš„æ ¡éªŒå’Œï¼ˆé€šè¿‡git logè·å–ï¼‰ã€‚ è¡¥æ‰“Tag git tag -a v0.1.1 9fbc3d0 Tagæ¨é€åˆ°æœåŠ¡å™¨ é€šå¸¸çš„git pushä¸ä¼šå°†Tagå¯¹è±¡æäº¤åˆ°gitæœåŠ¡å™¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ˜¾å¼çš„æ“ä½œï¼š git push origin v0.1.2 # å°†v0.1.2 Tagæäº¤åˆ°gitæœåŠ¡å™¨&gt; git push origin â€“-tags # å°†æœ¬åœ°æ‰€æœ‰Tagä¸€æ¬¡æ€§æäº¤åˆ°gitæœåŠ¡å™¨ æ³¨æ„ï¼šå¦‚æœæƒ³çœ‹ä¹‹å‰æŸä¸ªTagçŠ¶æ€ä¸‹çš„æ–‡ä»¶ï¼Œå¯ä»¥è¿™æ ·æ“ä½œ git tag æŸ¥çœ‹å½“å‰åˆ†æ”¯ä¸‹çš„Tag git checkout v0.21 æ­¤æ—¶ä¼šæŒ‡å‘æ‰“v0.21 Tagæ—¶çš„ä»£ç çŠ¶æ€ï¼Œï¼ˆä½†ç°åœ¨å¤„äºä¸€ä¸ªç©ºçš„åˆ†æ”¯ä¸Šï¼‰ åˆ é™¤è¿œç¨‹åˆ†æ”¯å’Œtagåœ¨Git v1.7.0 ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§è¯­æ³•åˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼š git push origin â€“delete åˆ é™¤tagè¿™ä¹ˆç”¨ï¼š git push origin â€“delete tag å¦åˆ™ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§è¯­æ³•ï¼Œæ¨é€ä¸€ä¸ªç©ºåˆ†æ”¯åˆ°è¿œç¨‹åˆ†æ”¯ï¼Œå…¶å®å°±ç›¸å½“äºåˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼š git push origin : è¿™æ˜¯åˆ é™¤tagçš„æ–¹æ³•ï¼Œæ¨é€ä¸€ä¸ªç©ºtagåˆ°è¿œç¨‹tagï¼š git tag -d &gt; git push origin :refs/tags/ é‡å‘½åè¿œç¨‹åˆ†æ”¯åˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼š git push â€“delete origin devel é‡å‘½åæœ¬åœ°åˆ†æ”¯ï¼š git branch -m devel develop æ¨é€æœ¬åœ°åˆ†æ”¯ï¼š git push origin develop æŠŠæœ¬åœ°tagæ¨é€åˆ°è¿œç¨‹ git push â€“tags # æ¨é€æ‰€æœ‰tag&gt; git push origin :tag # æ¨é€tag â€”â€” 2017/12/04 å·¥ä½œåŒºï¼ˆWorking Directoryï¼‰ å°±æ˜¯ä½ åœ¨ç”µè„‘é‡Œèƒ½çœ‹åˆ°çš„ç›®å½•ï¼Œæ¯”å¦‚æˆ‘çš„gitæ–‡ä»¶å¤¹å°±æ˜¯ä¸€ä¸ªå·¥ä½œåŒºã€‚ ç‰ˆæœ¬åº“ï¼ˆRepositoryï¼‰ å·¥ä½œåŒºæœ‰ä¸€ä¸ªéšè—ç›®å½•.gitï¼Œè¿™ä¸ªä¸ç®—å·¥ä½œåŒºï¼Œè€Œæ˜¯Gitçš„ç‰ˆæœ¬åº“ã€‚ æš‚å­˜åŒº Gitçš„ç‰ˆæœ¬åº“é‡Œå­˜äº†å¾ˆå¤šä¸œè¥¿ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ç§°ä¸ºstageï¼ˆæˆ–è€…å«indexï¼‰çš„æš‚å­˜åŒºï¼Œè¿˜æœ‰Gitä¸ºæˆ‘ä»¬è‡ªåŠ¨åˆ›å»ºçš„ç¬¬ä¸€ä¸ªåˆ†æ”¯masterï¼Œä»¥åŠæŒ‡å‘masterçš„ä¸€ä¸ªæŒ‡é’ˆå«HEADã€‚ git addæŠŠæ–‡ä»¶æ·»åŠ è¿›å»ï¼Œå®é™…ä¸Šå°±æ˜¯æŠŠæ–‡ä»¶ä¿®æ”¹æ·»åŠ åˆ°æš‚å­˜åŒºï¼› git commitæäº¤æ›´æ”¹ï¼Œå®é™…ä¸Šå°±æ˜¯æŠŠæš‚å­˜åŒºçš„æ‰€æœ‰å†…å®¹æäº¤åˆ°å½“å‰åˆ†æ”¯ã€‚ å‘½ä»¤è¯´æ˜git cloneå…‹éš†git branch (åˆ†æ”¯å)åˆ›å»ºåˆ†æ”¯ -Dåˆ é™¤åˆ†æ”¯git checkout (åˆ†æ”¯å)åˆ‡æ¢åˆ†æ”¯ -båˆ›å»ºå¹¶åˆ‡æ¢git checkout (æ–‡ä»¶å)æ’¤é”€æ­¤æ–‡ä»¶ä¿®æ”¹git addå°†è¯¥æ–‡ä»¶æ·»åŠ åˆ°ç¼“å­˜git statusæŸ¥çœ‹åœ¨ä½ ä¸Šæ¬¡æäº¤ä¹‹åæ˜¯å¦æœ‰ä¿®æ”¹git commitå°†ç¼“å­˜åŒºå†…å®¹æ·»åŠ åˆ°ä»“åº“ä¸­git diffæ¥æŸ¥çœ‹æ‰§è¡Œ git status çš„ç»“æœçš„è¯¦ç»†ä¿¡æ¯git reset HEADå‘½ä»¤ç”¨äºå–æ¶ˆå·²ç¼“å­˜çš„å†…å®¹git rm æ–‡ä»¶åˆ é™¤æ–‡ä»¶-få¼ºåˆ¶åˆ é™¤git mvç§»åŠ¨æ–‡ä»¶git mergeåˆå¹¶åˆ†æ”¯git fetchä»è¿œç¨‹è·å–æœ€æ–°ç‰ˆæœ¬åˆ°æœ¬åœ°git push :å°†æœ¬åœ°åˆ†æ”¯çš„æ›´æ–°ï¼Œæ¨é€åˆ°è¿œç¨‹ä¸»æœºgit push origin --delete teståˆ é™¤è¿œç¨‹åˆ†æ”¯testgit pull :å°†è¿œç¨‹å­˜å‚¨åº“ä¸­çš„æ›´æ”¹åˆå¹¶åˆ°æœ¬åœ°åˆ†æ”¯ä¸­git rebaseå‘½ä»¤åœ¨å¦ä¸€ä¸ªåˆ†æ”¯åŸºç¡€ä¹‹ä¸Šé‡æ–°åº”ç”¨ï¼Œç”¨äºæŠŠä¸€ä¸ªåˆ†æ”¯çš„ä¿®æ”¹åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€‚git logå‘½ä»¤ç”¨äºæ˜¾ç¤ºæäº¤æ—¥å¿—ä¿¡æ¯ã€‚git reflogæ˜¾ç¤ºæ¯ä¸€æ¬¡å‘½ä»¤git revertç”Ÿæˆä¸€ä¸ªæ–°çš„æäº¤æ¥æ’¤é”€æŸæ¬¡æäº¤ï¼Œæ­¤æ¬¡æäº¤ä¹‹å‰çš„commitéƒ½ä¼šè¢«ä¿ç•™git reset HEAD å¦‚æœå‘ç°é”™è¯¯çš„å°†ä¸æƒ³æš‚å­˜çš„æ–‡ä»¶è¢«git addè¿›å…¥ç´¢å¼•ä¹‹åï¼Œæƒ³å›é€€å–æ¶ˆï¼Œåˆ™å¯ä»¥ä½¿ç”¨ è®¾ç½®ç”¨æˆ·åé‚®ç®±ï¼š git config â€“global user.name â€œ13saiâ€ git config â€“global user.email â€œ&#57;&#x35;&#x37;&#48;&#x34;&#x32;&#55;&#x38;&#49;&#64;&#113;&#113;&#46;&#x63;&#111;&#x6d;â€œ fatal: No configured push destination.è§£å†³ï¼š$ git remote add -f -t master -m master origin git://example.com/git.git/fatal: The current branch test has no upstream branch.è§£å†³ï¼šgit push --set-upstream origin testæ¨¡ä»¿ git cloneï¼Œä½†åªè·Ÿè¸ªé€‰å®šçš„åˆ†æ”¯$ mkdir project.git$ cd project.git$ git init$ git remote add -f -t master -m master origin git://example.com/git.git/ $ git merge originfatalï¼šUnable to create &#x27;E:/project/scrm/.git/index.lock&#x27;: File exists.rm -f ./.git/index.lock git log -p æŸ¥çœ‹å·®å¼‚ -n(nä¸ºæ­£æ•´æ•°) æŸ¥çœ‹æœ€è¿‘næ¬¡çš„æäº¤ --pretty æŒ‰æŒ‡å®šæ ¼å¼æ˜¾ç¤ºæ—¥å¿—ä¿¡æ¯,å¯é€‰é¡¹æœ‰ï¼šoneline,short,medium,full,fuller,email,rawä»¥åŠformat:&lt;string&gt;,é»˜è®¤ä¸ºmediumï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æŒ‡å®šé»˜è®¤çš„æ–¹å¼ã€‚ e.g. git log (--pretty=)oneline --stat åˆ—å‡ºæ–‡ä»¶çš„ä¿®æ”¹è¡Œæ•° --sortstat åªæ˜¾ç¤º--statä¸­æœ€åè¡Œæ•°ä¿®æ”¹æ·»åŠ ç§»é™¤çš„ç»Ÿè®¡ --graph ä»¥ç®€å•çš„å›¾å½¢æ–¹å¼åˆ—å‡ºæäº¤è®°å½• --abbrev-commit ä»…æ˜¾ç¤º SHA-1 çš„å‰å‡ ä¸ªå­—ç¬¦ï¼Œè€Œéæ‰€æœ‰çš„ 40 ä¸ªå­—ç¬¦ã€‚ --relative-date ä½¿ç”¨è¾ƒçŸ­çš„ç›¸å¯¹æ—¶é—´æ˜¾ç¤ºï¼ˆæ¯”å¦‚ï¼Œâ€œ2 weeks agoâ€ï¼‰ã€‚ --name-only ä»…åœ¨æäº¤ä¿¡æ¯åæ˜¾ç¤ºå·²ä¿®æ”¹çš„æ–‡ä»¶æ¸…å•ã€‚ --name-status æ˜¾ç¤ºæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤çš„æ–‡ä»¶æ¸…å•ã€‚ â€”â€”2017/12/01 å‘½ä»¤ è¯´æ˜ git clone å…‹éš† git branch (åˆ†æ”¯å) åˆ›å»ºåˆ†æ”¯ -Dåˆ é™¤åˆ†æ”¯ git checkout (åˆ†æ”¯å) åˆ‡æ¢åˆ†æ”¯ -båˆ›å»ºå¹¶åˆ‡æ¢ git add å°†è¯¥æ–‡ä»¶æ·»åŠ åˆ°ç¼“å­˜ git status æŸ¥çœ‹åœ¨ä½ ä¸Šæ¬¡æäº¤ä¹‹åæ˜¯å¦æœ‰ä¿®æ”¹ git commit å°†ç¼“å­˜åŒºå†…å®¹æ·»åŠ åˆ°ä»“åº“ä¸­ git diff æ¥æŸ¥çœ‹æ‰§è¡Œ git status çš„ç»“æœçš„è¯¦ç»†ä¿¡æ¯ git reset HEAD å‘½ä»¤ç”¨äºå–æ¶ˆå·²ç¼“å­˜çš„å†…å®¹ git rm æ–‡ä»¶ åˆ é™¤æ–‡ä»¶-få¼ºåˆ¶åˆ é™¤ git mv ç§»åŠ¨æ–‡ä»¶ git merge åˆå¹¶åˆ†æ”¯ git fetch ä»è¿œç¨‹è·å–æœ€æ–°ç‰ˆæœ¬åˆ°æœ¬åœ° git push : å°†æœ¬åœ°åˆ†æ”¯çš„æ›´æ–°ï¼Œæ¨é€åˆ°è¿œç¨‹ä¸»æœº git push origin --delete test åˆ é™¤è¿œç¨‹åˆ†æ”¯test git pull : å°†è¿œç¨‹å­˜å‚¨åº“ä¸­çš„æ›´æ”¹åˆå¹¶åˆ°æœ¬åœ°åˆ†æ”¯ä¸­ git rebase å‘½ä»¤åœ¨å¦ä¸€ä¸ªåˆ†æ”¯åŸºç¡€ä¹‹ä¸Šé‡æ–°åº”ç”¨ï¼Œç”¨äºæŠŠä¸€ä¸ªåˆ†æ”¯çš„ä¿®æ”¹åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€‚ fatal: No configured push destination. è§£å†³ï¼š$ git remote add -f -t master -m master origin git://example.com/git.git/ fatal: The current branch test has no upstream branch. è§£å†³ï¼šgit push --set-upstream origin test æ¨¡ä»¿ git cloneï¼Œä½†åªè·Ÿè¸ªé€‰å®šçš„åˆ†æ”¯ $ mkdir project.git $ cd project.git $ git init $ git remote add -f -t master -m master origin git://example.com/git.git/ $ git merge origin","categories":[{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"}],"tags":[{"name":"git","slug":"git","permalink":"https://github.13sai.com/tags/git/"}]},{"title":"åˆè¯†gulp","slug":"åˆè¯†gulp","date":"2017-11-12T13:06:16.000Z","updated":"2022-03-19T14:35:21.866Z","comments":true,"path":"2017/11/12/140/","link":"","permalink":"https://github.13sai.com/2017/11/12/140/","excerpt":"","text":"ä½¿ç”¨ gulp ä¹‹å‰è¯·å®‰è£…å¥½nodeå’Œnpmï¼Œä¸ºäº†é€Ÿåº¦ï¼Œå¯ä»¥ä½¿ç”¨cnpmã€‚ å…¨å±€å®‰è£… cnpm install gulp -g glup -v // è¾“å…¥ç‰ˆæœ¬ï¼Œåˆ™è¯´æ˜å®‰è£…æˆåŠŸã€‚ æ–°å»ºpackage.json&#123; &quot;name&quot;: &quot;sai&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;description&quot;: &quot;gulp css!&quot;, &quot;author&quot;: &#123; &quot;name&quot;: &quot;13sai&quot;, &quot;email&quot;: &quot;95742781@qq.com&quot; &#125;, &quot;license&quot;: &quot;MIT&quot;, &quot;devDependencies&quot;: &#123; &quot;gulp&quot;: &quot;^3.9.1&quot;, &quot;gulp-minify-css&quot;: &quot;^1.2.4&quot; &#125; &#125; æœ¬åœ°å®‰è£…gulpï¼Œgulp-minify-cssã€‚cnpm install gulp --save-dev cnpm install gulp-minify-css --save-dev æ–°å»ºgulpfile.jsvar gulp = require(&#x27;gulp&#x27;), mincss = require(&#x27;gulp-minify-css&#x27;);//å®šä¹‰ä¸€ä¸ªsaiä»»åŠ¡gulp.task(&#x27;sai&#x27;, function () &#123; gulp.src(&#x27;assets/css/*.css&#x27;) //è¯¥ä»»åŠ¡é’ˆå¯¹çš„æ–‡ä»¶ .pipe(mincss()) //è¯¥ä»»åŠ¡è°ƒç”¨çš„æ¨¡å— .pipe(gulp.dest(&#x27;assets/mini&#x27;)); //å°†ä¼šåœ¨assets/miniä¸‹ç”Ÿæˆcss&#125;); gulp.task(&#x27;default&#x27;,[&#x27;sai&#x27;]); //å®šä¹‰é»˜è®¤ä»»åŠ¡ cmdæ‰§è¡Œgulp gulp ä¼šçœ‹åˆ°ä»»åŠ¡saiå¼€å§‹ï¼Œå®Œæˆï¼Œè¿™æ ·å°±å®Œæˆäº†gulpå‹ç¼©cssã€‚ æ­¤å¤–ï¼Œgulpè¿˜å¯ä»¥å‹ç¼©jsï¼Œimgã€‚","categories":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/categories/js/"}],"tags":[{"name":"gulp","slug":"gulp","permalink":"https://github.13sai.com/tags/gulp/"}]},{"title":"windowså®‰è£…redisæ‰©å±•","slug":"windowså®‰è£…redisæ‰©å±•","date":"2017-11-07T14:04:54.000Z","updated":"2022-03-19T14:35:21.835Z","comments":true,"path":"2017/11/07/139/","link":"","permalink":"https://github.13sai.com/2017/11/07/139/","excerpt":"","text":"phpinfoæŸ¥çœ‹phpå¯¹åº”VCç‰ˆæœ¬ä¸‹è½½redis,igbinaryhttp://windows.php.net/downloads/pecl/releases/igbinary/http://windows.php.net/downloads/pecl/releases/redis/æ³¨æ„ä¸‹ç‰ˆæœ¬ä¸tsï¼Œntsåˆ†åˆ«ï¼Œè¿™äº›ä¿¡æ¯éƒ½å¯ä»¥ä»phpinfoçœ‹è§ã€‚ è®²å¯¹åº”dllæ”¾å…¥phpä¸‹é¢extã€‚4.ä¿®æ”¹php.iniï¼Œå¢åŠ extension=php_igbinary.dllextension=php_redis.dllé‡å¯æœåŠ¡å™¨ï¼Œå¹¶å‹¾é€‰æ‰©å±•ï¼Œæå®šï¼","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"windows","slug":"windows","permalink":"https://github.13sai.com/tags/windows/"}]},{"title":"SVNæœåŠ¡å™¨ä¸webç«™ç‚¹ä»£ç åŒæ­¥æ›´æ–°","slug":"SVNæœåŠ¡å™¨ä¸webç«™ç‚¹ä»£ç åŒæ­¥æ›´æ–°","date":"2017-10-09T08:50:04.000Z","updated":"2022-03-19T14:35:21.643Z","comments":true,"path":"2017/10/09/138/","link":"","permalink":"https://github.13sai.com/2017/10/09/138/","excerpt":"","text":"å› ä¸ºSVNæœåŠ¡å™¨ä¸webç«™ç‚¹ä»£ç æ˜¯æ”¾åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•æ¥åšä¸€ä¸ªåŒæ­¥æ›´æ–°ã€‚ ä½†æ˜¯æ–‡ä»¶ä¸Šä¼ åˆ°SVNç‰ˆæœ¬åº“å,ä¸Šä¼ çš„æ–‡ä»¶ä¸å†ä»¥æ–‡ä»¶åŸæ¥çš„æ ¼å¼å­˜å‚¨,è€Œæ˜¯è¢«svnä»¥å®ƒè‡ªå®šä¹‰çš„æ ¼å¼å‹ç¼©æˆç‰ˆæœ¬åº“æ•°æ®,å­˜æ”¾åœ¨ç‰ˆæœ¬åº“ä¸­ã€‚ è¿™æ ·æˆ‘ä»¬å°±é€‰æ‹©ä½¿ç”¨SVNè‡ªå¸¦çš„hooksæ¥åšwebç«™ç‚¹ä»£ç æ›´æ–°ã€‚ è¿›å…¥å¯¹åº”ç‰ˆæœ¬åº“ä¸‹çš„hooksç›®å½•ï¼Œå¤åˆ¶ post-commit.tmplä¸ºpost-commitã€‚ æ‰“å¼€ï¼Œä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š export.UTF-8 REPOS=&quot;$1&quot; REV=&quot;$2&quot; SVN_PATH=/usr/bin/svn #æ³¨æ„ï¼Œæ­¤å¤„æ˜¯svnå‘½ä»¤ç›®å½• WEB_PATH=/web/trunk #ç«™ç‚¹ç›®å½• LOG_PATH=/home/svn/trunk/svn.log echo &quot;##########å¼€å§‹æäº¤ &quot; `date &quot;+%Y-%m-%d %H:%M:%S&quot;` &#x27;##################&#x27; &gt;&gt; $LOG_PATH $SVN_PATH update --username 13sai --password 123456 $WEB_PATH --no-auth-cache &gt;&gt; $LOG_PATH è®°å¾—è¦ä¿®æ”¹ä¸‹post-commitçš„æ‰§è¡Œæƒé™ï¼Œç„¶åæµ‹è¯•ï¼Œå¦‚æœæˆåŠŸäº†ï¼Œé‚£æ­å–œä½ ï¼","categories":[{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"}],"tags":[{"name":"svn","slug":"svn","permalink":"https://github.13sai.com/tags/svn/"}]},{"title":"linuxæ­å»ºsvnæœåŠ¡å™¨","slug":"Linuxæ­å»ºsvnæœåŠ¡å™¨","date":"2017-10-09T08:33:02.000Z","updated":"2022-03-19T14:35:21.608Z","comments":true,"path":"2017/10/09/137/","link":"","permalink":"https://github.13sai.com/2017/10/09/137/","excerpt":"","text":"ç¯å¢ƒï¼šcentos6.3å®‰è£…svn yum install subversion åˆ›å»ºç‰ˆæœ¬åº“ svnadmin create /home/repo //æ–‡ä»¶ç›®å½•è‡ªå·±è®¾ç½® é…ç½® cd /home/repo/conf // è¿›å…¥ç›®å½• é…ç½®ç›®å½•ä¸‹æœ‰ä¸‰ä¸ªæ–‡ä»¶ authz æƒé™ passwd è´¦å·å¯†ç  svnserve.conf ç‰ˆæœ¬åº“é…ç½® ç¼–è¾‘ç”¨æˆ·æ–‡ä»¶passwdï¼Œæ–°å¢ä¸¤ä¸ªç”¨æˆ·ï¼šadminå’Œguestã€‚ [users] admin = 111111 guest = 123456 ç¼–è¾‘æƒé™æ–‡ä»¶authzï¼Œç”¨æˆ·adminè®¾ç½®å¯è¯»å†™æƒé™ï¼Œguestè®¾ç½®åªè¯»æƒé™ã€‚ [/] admin = rw guest = r ç¼–è¾‘svnserve.confï¼š [general] anon-access = none #æ§åˆ¶éé‰´æƒç”¨æˆ·è®¿é—®ç‰ˆæœ¬åº“çš„æƒé™ auth-access = write #æ§åˆ¶é‰´æƒç”¨æˆ·è®¿é—®ç‰ˆæœ¬åº“çš„æƒé™ password-db = passwd #æŒ‡å®šç”¨æˆ·åå£ä»¤æ–‡ä»¶å authz-db = authz #æŒ‡å®šæƒé™é…ç½®æ–‡ä»¶å realm = repo #æŒ‡å®šç‰ˆæœ¬åº“çš„è®¤è¯åŸŸï¼Œå³åœ¨ç™»å½•æ—¶æç¤ºçš„è®¤è¯åŸŸåç§° é…ç½®ipï¼Œæ‰“å¼€3369ç«¯å£å¹¶é‡å¯å¯åŠ¨svn svnserve -d -r /home/repo æœ¬åœ°æµ‹è¯•cmdè¾“å…¥svn checkout svn://***/repoï¼ŒåŠ å…¥æç¤ºè¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œå¹¶èƒ½ç”¨ä¹‹å‰è´¦å·ç™»å½•ï¼Œå°±è¡¨ç¤ºé…ç½®æˆåŠŸã€‚ å¦‚æœæœ¬åœ°è£…äº†ç±»ä¼¼TortoiseSVNè½¯ä»¶ï¼Œå¯ä»¥æ–°å»ºæ–‡ä»¶å¤¹ï¼Œç„¶åcheckoutï¼Œè¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œæµ‹è¯•æˆåŠŸï¼","categories":[{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"}],"tags":[{"name":"SVN","slug":"SVN","permalink":"https://github.13sai.com/tags/SVN/"}]},{"title":"linuxå¸¸ç”¨å‘½ä»¤","slug":"Linuxå¸¸ç”¨å‘½ä»¤","date":"2017-09-30T06:11:16.000Z","updated":"2022-03-19T14:35:21.607Z","comments":true,"path":"2017/09/30/135/","link":"","permalink":"https://github.13sai.com/2017/09/30/135/","excerpt":"","text":"æ–‡ä»¶æ“ä½œ å‘½ä»¤ è¯´æ˜ cat ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚ chmod è®¾å®šæ–‡ä»¶æƒé™ diff æ¯”è¾ƒæ–‡ä»¶çš„å·®å¼‚ file è¾¨è¯†æ–‡ä»¶ç±»å‹ find åœ¨æŒ‡å®šç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶ grep æŸ¥æ‰¾æ–‡ä»¶é‡Œç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸² cd åˆ‡æ¢å½“å‰å·¥ä½œç›®å½• ls æ˜¾ç¤ºæŒ‡å®šå·¥ä½œç›®å½•ä¸‹ä¹‹å†…å®¹ exit é€€å‡ºç›®å‰çš„shell kill åˆ é™¤æ‰§è¡Œä¸­çš„ç¨‹åºæˆ–å·¥ä½œ mv ç”¨æ¥ä¸ºæ–‡ä»¶æˆ–ç›®å½•æ”¹åã€æˆ–å°†æ–‡ä»¶æˆ–ç›®å½•ç§»å…¥å…¶å®ƒä½ç½® rm åˆ é™¤ä¸€ä¸ªæ–‡ä»¶æˆ–è€…ç›®å½• -ré€’å½’åˆ é™¤ -få¼ºåˆ¶åˆ é™¤ cp ç”¨äºå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½• tail è¾“å‡ºæ–‡ä»¶å°¾éƒ¨å†…å®¹ mkdir æ–°å»ºç›®å½• touch æ–°å»ºæ–‡ä»¶ pwd è¾“å‡ºå½“å‰ç›®å½• ç³»ç»Ÿç®¡ç†å‘½ä»¤ å‘½ä»¤ è¯´æ˜ who æ˜¾ç¤ºåœ¨çº¿ç™»é™†ç”¨æˆ· whoami æ˜¾ç¤ºå½“å‰æ“ä½œç”¨æˆ· ps æ˜¾ç¤ºå½“å‰è¿›ç¨‹ (process) çš„çŠ¶æ€ vimä½¿ç”¨ vimä¸‰ç§æ¨¡å¼ï¼šå‘½ä»¤æ¨¡å¼ã€æ’å…¥æ¨¡å¼ã€ç¼–è¾‘æ¨¡å¼ã€‚ä½¿ç”¨ESCæˆ–iæˆ–ï¼šæ¥åˆ‡æ¢æ¨¡å¼ã€‚ å‘½ä»¤ è¯´æ˜ :q é€€å‡º :q! å¼ºåˆ¶é€€å‡º :wq ä¿å­˜å¹¶é€€å‡º :set number æ˜¾ç¤ºè¡Œå· :set nonumber éšè—è¡Œå· /sai åœ¨æ–‡æ¡£ä¸­æŸ¥æ‰¾sai æŒ‰nè·³åˆ°ä¸‹ä¸€ä¸ªï¼Œshift+nä¸Šä¸€ä¸ª u æ’¤é”€ ctrl+r é‡åš yyp å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œï¼Œå¹¶ç²˜è´´ dd å‰ªåˆ‡å½“å‰è¡Œ ndd nè¡¨ç¤ºå¤§äº1çš„æ•°å­—ï¼Œå‰ªåˆ‡nè¡Œ dw ä»å…‰æ ‡å¤„å‰ªåˆ‡è‡³ä¸€ä¸ªå•å­/å•è¯çš„æœ«å°¾ï¼ŒåŒ…æ‹¬ç©ºæ ¼ de ä»å…‰æ ‡å¤„å‰ªåˆ‡è‡³ä¸€ä¸ªå•å­/å•è¯çš„æœ«å°¾ï¼Œä¸åŒ…æ‹¬ç©ºæ ¼ d$ ä»å½“å‰å…‰æ ‡å‰ªåˆ‡åˆ°è¡Œæœ« d0 ä»å½“å‰å…‰æ ‡ä½ç½®ï¼ˆä¸åŒ…æ‹¬å…‰æ ‡ä½ç½®ï¼‰å‰ªåˆ‡ä¹‹è¡Œé¦– d3l ä»å…‰æ ‡ä½ç½®ï¼ˆåŒ…æ‹¬å…‰æ ‡ä½ç½®ï¼‰å‘å³å‰ªåˆ‡3ä¸ªå­—ç¬¦ d5G å°†å½“å‰è¡Œï¼ˆåŒ…æ‹¬å½“å‰è¡Œï¼‰è‡³ç¬¬5è¡Œï¼ˆä¸åŒ…æ‹¬å®ƒï¼‰å‰ªåˆ‡ d3B ä»å½“å‰å…‰æ ‡ä½ç½®ï¼ˆä¸åŒ…æ‹¬å…‰æ ‡ä½ç½®ï¼‰åå‘å‰ªåˆ‡3ä¸ªå•è¯ dH å‰ªåˆ‡ä»å½“å‰è¡Œè‡³æ‰€æ˜¾ç¤ºå±å¹•é¡¶è¡Œçš„å…¨éƒ¨è¡Œ dM å‰ªåˆ‡ä»å½“å‰è¡Œè‡³å‘½ä»¤Mæ‰€æŒ‡å®šè¡Œçš„å…¨éƒ¨è¡Œ dL å‰ªåˆ‡ä»å½“å‰è¡Œè‡³æ‰€æ˜¾ç¤ºå±å¹•åº•çš„å…¨éƒ¨è¡Œ h (å·¦ç§»ä¸€ä¸ªå­—ç¬¦â†) j (ä¸‹ä¸€è¡Œâ†“) k (ä¸Šä¸€è¡Œâ†‘) l (å³ç§»ä¸€ä¸ªå­—ç¬¦â†’) ctrl+f ä¸‹ç¿»ä¸€å±ã€‚ ctrl+b ä¸Šç¿»ä¸€å±ã€‚ ctrl+d ä¸‹ç¿»åŠå±ã€‚ ctrl+u ä¸Šç¿»åŠå±ã€‚ ctrl+e å‘ä¸‹æ»šåŠ¨ä¸€è¡Œã€‚ ctrl+y å‘ä¸Šæ»šåŠ¨ä¸€è¡Œã€‚ n% åˆ°æ–‡ä»¶n%çš„ä½ç½®ã€‚ zz å°†å½“å‰è¡Œç§»åŠ¨åˆ°å±å¹•ä¸­å¤®ã€‚ zt å°†å½“å‰è¡Œç§»åŠ¨åˆ°å±å¹•é¡¶ç«¯ã€‚ zb å°†å½“å‰è¡Œç§»åŠ¨åˆ°å±å¹•åº•ç«¯ã€‚ é™„åŠ  å‘½ä»¤ è¯´æ˜ yy å¤åˆ¶å½“å‰è¡Œ nyy nè¡¨ç¤ºå¤§äº1çš„æ•°å­—ï¼Œå¤åˆ¶nè¡Œ yw ä»å…‰æ ‡å¤„å¤åˆ¶è‡³ä¸€ä¸ªå•å­/å•è¯çš„æœ«å°¾ï¼ŒåŒ…æ‹¬ç©ºæ ¼ ye ä»å…‰æ ‡å¤„å¤åˆ¶è‡³ä¸€ä¸ªå•å­/å•è¯çš„æœ«å°¾ï¼Œä¸åŒ…æ‹¬ç©ºæ ¼ y$ ä»å½“å‰å…‰æ ‡å¤åˆ¶åˆ°è¡Œæœ« y0 ä»å½“å‰å…‰æ ‡ä½ç½®ï¼ˆä¸åŒ…æ‹¬å…‰æ ‡ä½ç½®ï¼‰å¤åˆ¶ä¹‹è¡Œé¦– y3l ä»å…‰æ ‡ä½ç½®ï¼ˆåŒ…æ‹¬å…‰æ ‡ä½ç½®ï¼‰å‘å³å¤åˆ¶3ä¸ªå­—ç¬¦ y5G å°†å½“å‰è¡Œï¼ˆåŒ…æ‹¬å½“å‰è¡Œï¼‰è‡³ç¬¬5è¡Œï¼ˆä¸åŒ…æ‹¬å®ƒï¼‰å¤åˆ¶ y3B ä»å½“å‰å…‰æ ‡ä½ç½®ï¼ˆä¸åŒ…æ‹¬å…‰æ ‡ä½ç½®ï¼‰åå‘å¤åˆ¶3ä¸ªå•è¯ â€”â€”2017/12/26 å‘½ä»¤ è¯´æ˜ cat ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚ chmod è®¾å®šæ–‡ä»¶æƒé™ diff æ¯”è¾ƒæ–‡ä»¶çš„å·®å¼‚ file è¾¨è¯†æ–‡ä»¶ç±»å‹ find åœ¨æŒ‡å®šç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶ grep æŸ¥æ‰¾æ–‡ä»¶é‡Œç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸² cd åˆ‡æ¢å½“å‰å·¥ä½œç›®å½• ls æ˜¾ç¤ºæŒ‡å®šå·¥ä½œç›®å½•ä¸‹ä¹‹å†…å®¹ exit é€€å‡ºç›®å‰çš„shell kill åˆ é™¤æ‰§è¡Œä¸­çš„ç¨‹åºæˆ–å·¥ä½œ ps æ˜¾ç¤ºå½“å‰è¿›ç¨‹ (process) çš„çŠ¶æ€ mv ç”¨æ¥ä¸ºæ–‡ä»¶æˆ–ç›®å½•æ”¹åã€æˆ–å°†æ–‡ä»¶æˆ–ç›®å½•ç§»å…¥å…¶å®ƒä½ç½® rm åˆ é™¤ä¸€ä¸ªæ–‡ä»¶æˆ–è€…ç›®å½• cp ç”¨äºå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½• â€”â€“2017/9/30","categories":[{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/tags/Linux/"}]},{"title":"åˆè¯†memcache","slug":"åˆè¯†memcache","date":"2017-09-19T02:26:04.000Z","updated":"2022-03-19T14:35:21.867Z","comments":true,"path":"2017/09/19/134/","link":"","permalink":"https://github.13sai.com/2017/09/19/134/","excerpt":"","text":"ä»‹ç» Memcachedæ˜¯ä¸€ä¸ªå†…å­˜ç¼“å­˜ç³»ç»Ÿï¼Œè€ŒMemcacheæ˜¯phpçš„ä¸€ä¸ªæ‰©å±•ï¼Œæ˜¯phpç”¨äºæ“ä½œå’Œç®¡ç†Memcachedçš„å·¥å…·ã€‚å¦‚æœå®‰è£…äº†Memcachedä½†æ²¡æœ‰å®‰è£…Memcacheï¼Œphpæ— æ³•æ“æ§Memcachedï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œæ¥æ“æ§Memcachedï¼›å¦‚æœå®‰è£…äº†Memcacheå´æ²¡å®‰è£…Memcachedï¼Œåˆ™æ— æ³•ä½¿ç”¨ã€‚åªæœ‰åŒæ—¶å®‰è£…äº†Memcachedå’ŒMemcacheï¼Œæ‰èƒ½åœ¨PHPä¸­ä½¿ç”¨Memcachedã€‚ Memcacheæ˜¯è¿™ä¸ªé¡¹ç›®çš„åç§°ï¼Œè€Œmemcachedæ˜¯å®ƒæœåŠ¡å™¨ç«¯çš„ä¸»ç¨‹åºæ–‡ä»¶åã€‚ å®‰è£…memcacheå®‰è£…memcacheåˆ†ä¸ºä¸¤ä¸ªè¿‡ç¨‹ï¼š memcacheæœåŠ¡å™¨ç«¯çš„å®‰è£… memcachedå®¢æˆ·ç«¯çš„å®‰è£… æ‰€è°“æœåŠ¡å™¨ç«¯çš„å®‰è£…å°±æ˜¯åœ¨æœåŠ¡å™¨ï¼ˆä¸€èˆ¬éƒ½æ˜¯linuxç³»ç»Ÿï¼‰ä¸Šå®‰è£…Memcacheå®ç°æ•°æ®çš„å­˜å‚¨ æ‰€è°“å®¢æˆ·ç«¯çš„å®‰è£…å°±æ˜¯æŒ‡phpï¼ˆæˆ–è€…å…¶ä»–ç¨‹åºï¼ŒMemcacheè¿˜æœ‰å…¶ä»–ä¸é”™çš„apiæ¥å£æä¾›ï¼‰å»ä½¿ç”¨æœåŠ¡å™¨ç«¯çš„Memcacheæä¾›çš„å‡½æ•°ï¼Œéœ€è¦phpæ·»åŠ æ‰©å±•ã€‚ ä¸‹è½½åœ°å€ï¼ˆè¿™æ˜¯åœ¨ç½‘ä¸Šæ‰¾çš„ä¸‹è½½åœ°å€ï¼Œæˆ‘è¯•è¿‡ï¼Œå¯ä»¥ä¸‹è½½ï¼‰ è§£å‹ä¸‹è½½åçš„æ–‡ä»¶ï¼ŒæŠŠå®ƒæ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸­ï¼Œå¦‚D:\\memcached æ‰“å¼€cmdï¼Œè¿›å…¥memcachedè§£å‹åå­˜æ”¾çš„ç›®å½•ï¼Œè¿è¡Œå‘½ä»¤ï¼š memcached.exe -d install å¦‚æœæ²¡æœ‰æ„å¤–çš„è¯å·²ç»å®‰è£…æˆåŠŸäº†ã€‚ï¼ˆç›®å½•ä¸­åº”è¯¥æœ‰memcached.exeè¿™ä¸ªæ–‡ä»¶ï¼‰ æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼š æ‰“å¼€cmdï¼Œè¿›å…¥memcachedè§£å‹åå­˜æ”¾çš„ç›®å½•ï¼Œè¿è¡Œå‘½ä»¤ï¼š memcached -h è‹¥å®‰è£…æˆåŠŸï¼Œä¼šå‡ºç°å¤šåˆ—æç¤º å¯åŠ¨memcachedï¼š æ‰“å¼€cmdï¼Œè¿›å…¥memcachedè§£å‹åå­˜æ”¾çš„ç›®å½•ï¼Œè¿è¡Œå‘½ä»¤ï¼š memcached.exe -d start å®‰è£…memcacheçš„phpæ‰©å±•ä¸‹è½½åœ°å€ ï¼ˆæ³¨æ„ï¼šè¦ä¸‹è½½å¯¹åº”phpç‰ˆæœ¬å’Œç³»ç»Ÿä½æ•°çš„dllæ–‡ä»¶ï¼Œå¯åœ¨phpinfoé‡ŒæŸ¥çœ‹éœ€è¦çš„ç‰ˆæœ¬ï¼‰ æŠŠphp_memcache.dllæ”¾åˆ°phpçš„extç›®å½•ä¸‹ï¼Œå¦‚ï¼š D:\\wamp\bin\\php\\ext æ‰“å¼€php.iniï¼Œåœ¨extensionå¤„æ·»åŠ ä¸€è¡Œä»£ç ï¼š extension=php_memcache.dll é‡å¯wampã€‚ æŸ¥çœ‹phpçš„extensionsæœåŠ¡ï¼Œphp_memcacheç°åœ¨åº”è¯¥å¯ä»¥ä½¿ç”¨äº†ï¼Œå³å¤„äºæ‰“é’©çŠ¶æ€ï¼Œä¹‹ å‰æ˜¯å¤„äºå¹å·çŠ¶æ€çš„ï¼Œè‹¥è¿˜å¤„äºå¹å·çŠ¶æ€ï¼Œç”¨é¼ æ ‡åœ¨ä¸Šé¢ç‚¹å‡»ä¸€ä¸‹å°±å¥½äº†ã€‚ é€šè¿‡ä»£ç æµ‹è¯•phpæ˜¯å¦å·²ç»å¯ä»¥ä½¿ç”¨memcachedï¼š $memcache = new Memcache; $memcache-&gt;connect(&quot;127.0.0.1&quot;,11211); echo &quot;Memcached&#x27;s version: &quot; . $memcache-&gt;getVersion() . &quot;&lt;br /&gt;&quot;; $data = array( &#x27;url&#x27; =&gt; &quot;http://www.cnblogs.com/wujuntian/&quot;, &#x27;name&#x27; =&gt; &quot;ç¼–ç¨‹äººï¼Œåœ¨å¤©æ¶¯&quot; ); $memcache-&gt;set(&quot;info&quot;,$data,0,10); $info = $memcache-&gt;get(&quot;info&quot;); echo &#x27;&lt;pre&gt;&#x27;; print_r($info); è‹¥èƒ½æ‰“å°å‡ºmemcacheä¸­çš„ä¿¡æ¯ï¼Œåˆ™è¯´æ˜phpçš„memcacheæ‰©å±•å·²å®‰è£…æˆåŠŸä¸”èƒ½ä½¿ç”¨äº†ï¼ æ›´å¤šæ“ä½œå¦‚ä¸‹ï¼š &lt; ?php //è¿æ¥ $mem = new Memcache;$mem-&gt;connect(&quot;127.0.0.1&quot;,11211); //ä¿å­˜æ•°æ® $mem-&gt;set(&#x27;key1&#x27;, &#x27;This is first value&#x27;, 0, 60); $val = $mem-&gt;get(&#x27;key1&#x27;); echo &quot;Get key1 value: &quot; . $val .&quot;&lt;br /&gt;&quot;; //æ›¿æ¢æ•°æ® $mem-&gt;replace(&#x27;key1&#x27;, &#x27;This is replace value&#x27;, 0, 60);$val = $mem-&gt;get(&#x27;key1&#x27;); echo &quot;Get key1 value: &quot; . $val . &quot;&lt;br /&gt;&quot;; //ä¿å­˜æ•°ç»„ $arr = array(&#x27;aaa&#x27;, &#x27;bbb&#x27;, &#x27;ccc&#x27;, &#x27;ddd&#x27;);$mem-&gt;set(&#x27;key2&#x27;, $arr, 0, 60); $val2 = $mem-&gt;get(&#x27;key2&#x27;); echo &quot;Get key2 value: &quot;; print_r($val2); echo &quot;&lt;br /&gt;&quot;; //åˆ é™¤æ•°æ®$mem-&gt;delete(&#x27;key1&#x27;); $val = $mem-&gt;get(&#x27;key1&#x27;); echo &quot;Get key1 value: &quot; . $val . &quot;&lt;br /&gt;&quot;; //æ¸…é™¤æ‰€æœ‰æ•°æ® $mem-&gt;flush(); $val2 = $mem-&gt;get(&#x27;key2&#x27;); echo &quot;Get key2 value: &quot;; print_r($val2); echo &quot;&lt;br /&gt;&quot;; //å…³é—­è¿æ¥ $mem-&gt;close(); å¦‚æœæ­£å¸¸çš„è¯ï¼Œæµè§ˆå™¨å°†è¾“å‡ºï¼š Get key1 value: This is first value Get key1 value: This is replace value Get key2 value: Array ( [0] =&gt; aaa [1] =&gt; bbb [2] =&gt; ccc [3] =&gt; ddd ) Get key1 value: Get key2 value: ç¨‹åºä»£ç åˆ†æåˆå§‹åŒ–ä¸€ä¸ªMemcacheçš„å¯¹è±¡ï¼š $mem = new Memcache; è¿æ¥åˆ°æˆ‘ä»¬çš„MemcacheæœåŠ¡å™¨ç«¯ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æœåŠ¡å™¨çš„IPåœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸»æœºåï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯Memcacheçš„å¼€æ”¾çš„ç«¯å£ï¼š $mem-&gt;connect(&quot;127.0.0.1&quot;,11211); ä¿å­˜ä¸€ä¸ªæ•°æ®åˆ°MemcacheæœåŠ¡å™¨ä¸Šï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®çš„keyï¼Œç”¨æ¥å®šä½ä¸€ä¸ªæ•°æ®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯éœ€è¦ä¿å­˜çš„æ•°æ®å†…å®¹ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œä¸€èˆ¬è®¾ç½®ä¸º0æˆ–è€…MEMCACHE_COMPRESSEDå°±è¡Œäº†ï¼Œç¬¬å››ä¸ªå‚æ•°æ˜¯æ•°æ®çš„æœ‰æ•ˆæœŸï¼Œå°±æ˜¯è¯´æ•°æ®åœ¨è¿™ä¸ªæ—¶é—´å†…æ˜¯æœ‰æ•ˆçš„ï¼Œå¦‚æœè¿‡å»è¿™ä¸ªæ—¶é—´ï¼Œé‚£ä¹ˆä¼šè¢«MemcacheæœåŠ¡å™¨ç«¯æ¸…é™¤æ‰è¿™ä¸ªæ•°æ®ï¼Œå•ä½æ˜¯ç§’ï¼Œå¦‚æœè®¾ç½®ä¸º0ï¼Œåˆ™æ˜¯æ°¸è¿œæœ‰æ•ˆï¼Œæˆ‘ä»¬è¿™é‡Œè®¾ç½®äº†60ï¼Œå°±æ˜¯ä¸€åˆ†é’Ÿæœ‰æ•ˆæ—¶é—´ï¼š $mem-&gt;set(&#39;key1&#39;, &#39;This is first value&#39;, 0, 60); ä»MemcacheæœåŠ¡å™¨ç«¯è·å–ä¸€æ¡æ•°æ®ï¼Œå®ƒåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯éœ€è¦è·å–æ•°æ®çš„keyï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯ä¸Šä¸€æ­¥è®¾ç½®çš„key1ï¼Œç°åœ¨è·å–è¿™ä¸ªæ•°æ®åè¾“å‡ºè¾“å‡ºï¼š $val = $mem-&gt;get(&#x27;key1&#x27;); echo &quot;Get key1 value: &quot; . $val; ç°åœ¨æ˜¯ä½¿ç”¨replaceæ–¹æ³•æ¥æ›¿æ¢æ‰ä¸Šé¢key1çš„å€¼ï¼Œreplaceæ–¹æ³•çš„å‚æ•°è·Ÿsetæ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡ç¬¬ä¸€ä¸ªå‚æ•°key1æ˜¯å¿…é¡»æ˜¯è¦æ›¿æ¢æ•°æ®å†…å®¹çš„keyï¼Œæœ€åè¾“å‡ºäº†ï¼š $mem-&gt;replace(&#x27;key1&#x27;, &#x27;This is replace value&#x27;, 0, 60); $val = $mem-&gt;get(&#x27;key1&#x27;); echo &quot;Get key1 value: &quot; . $val; åŒæ ·çš„ï¼ŒMemcacheä¹Ÿæ˜¯å¯ä»¥ä¿å­˜æ•°ç»„çš„ï¼Œä¸‹é¢æ˜¯åœ¨Memcacheä¸Šé¢ä¿å­˜äº†ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åè·å–å›æ¥å¹¶è¾“å‡º $arr = array(&#x27;aaa&#x27;, &#x27;bbb&#x27;, &#x27;ccc&#x27;, &#x27;ddd&#x27;);$mem-&gt;set(&#x27;key2&#x27;, $arr, 0, 60);$val2 = $mem-&gt;get(&#x27;key2&#x27;); print_r($val2); ç°åœ¨åˆ é™¤ä¸€ä¸ªæ•°æ®ï¼Œä½¿ç”¨delteæ¥å£ï¼Œå‚æ•°å°±æ˜¯ä¸€ä¸ªkeyï¼Œç„¶åå°±èƒ½å¤ŸæŠŠMemcacheæœåŠ¡å™¨è¿™ä¸ªkeyçš„æ•°æ®åˆ é™¤ï¼Œæœ€åè¾“å‡ºçš„æ—¶å€™æ²¡æœ‰ç»“æœ $mem-&gt;delete(&#x27;key1&#x27;); $val = $mem-&gt;get(&#x27;key1&#x27;); echo &quot;Get key1 value: &quot; . $val . &quot;&lt;br&gt;&quot;; æœ€åæˆ‘ä»¬æŠŠæ‰€æœ‰çš„ä¿å­˜åœ¨MemcacheæœåŠ¡å™¨ä¸Šçš„æ•°æ®éƒ½æ¸…é™¤ï¼Œä¼šå‘ç°æ•°æ®éƒ½æ²¡æœ‰äº†ï¼Œæœ€åè¾“å‡ºkey2çš„æ•°æ®ä¸ºç©ºï¼Œæœ€åå…³é—­è¿æ¥ $mem-&gt;flush(); $val2 = $mem-&gt;get(&#x27;key2&#x27;); echo &quot;Get key2 value: &quot;; print_r($val2); echo &quot;&lt;br&gt;&quot;;","categories":[{"name":"cache","slug":"cache","permalink":"https://github.13sai.com/categories/cache/"}],"tags":[{"name":"cache","slug":"cache","permalink":"https://github.13sai.com/tags/cache/"}]},{"title":"phpä¸­é€—å·ä¸ç‚¹å·çš„åŒºåˆ«","slug":"phpä¸­é€—å·ä¸ç‚¹å·çš„åŒºåˆ«","date":"2017-09-15T09:03:39.000Z","updated":"2022-03-19T14:35:21.781Z","comments":true,"path":"2017/09/15/133/","link":"","permalink":"https://github.13sai.com/2017/09/15/133/","excerpt":"","text":"å‰ä¸ä¹…ç¬”è¯•æœ‰æ¶‰åŠé€—å·ä¸ç‚¹å·çš„åŒºåˆ«é—®é¢˜ï¼Œä¸€ç›´æ²¡åœ¨æ„ã€‚ echo â€˜abcâ€™.â€™defâ€™; //ç”¨ç‚¹å·è¿æ¥å­—ç¬¦ä¸²echo â€˜abcâ€™,â€™defâ€™; //ç”¨é€—å·è¿æ¥å­—ç¬¦ä¸²ä¹Ÿè®¸å¾ˆå¤šäººéƒ½çŸ¥é“é€—å·è¦æ¯”ç‚¹å·å¿«ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆ.æ›´ä¸çŸ¥é“è¿™ä¸¤è€…åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«. é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±ä¸¾ä¸€äº›ä¾‹å­ echo â€˜1+5=â€™ . 1+5;çœ‹çœ‹ä¸Šé¢çš„ï¼Œè¾“å‡ºçš„ç»“æœæ˜¯6ï¼Œè€Œä¸æ˜¯1+5=6.æœ‰äº›ç¥å¥‡å§? æ›´ç¥å¥‡çš„æ˜¯ä½ çœ‹ä¸‹é¢çš„ä¾‹å­. echo &quot;1+5=&quot; . 5+1; //è¾“å‡º2 ç»“æœååˆ†å¥‡æ€ªã€‚æˆ‘ä»¬çœ‹åˆ°ï¼Œæˆ‘ä»¬æŠŠ5å’Œ1æ¢ä¸‹ä½ç½®.ç»“æœå°±å˜æˆ2äº†. ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿéš¾é“åœ¨PHPä¸­åŠ æ³•æ˜¯æ²¡æœ‰äº¤æ¢å¾‹çš„?å½“ç„¶ä¸æ˜¯ æˆ‘ä»¬å…ˆä¸å»æƒ³ä¸ºä»€ä¹ˆï¼Œå¦‚æœæˆ‘æŠŠä¸Šé¢çš„ç‚¹å·æ¢æˆé€—å·è¯•ä¸‹. echo &#x27;1+5=&#x27; , 5+1; //è¾“å‡º 1+5=6 echo &#x27;1+5=&#x27; , 1+5; //è¾“å‡º 1+5=6 å¯ä»¥çœ‹å‡ºï¼Œåªæœ‰ä½¿ç”¨é€—å·æˆ‘ä»¬æ‰å¯ä»¥å¾—åˆ°æ„æ–™ä¸­çš„ç»“æœ. é‚£ä¸ºä»€ä¹ˆç‚¹å·å°±ä¸è¡Œå‘¢?é€—å·ä¸ºä»€ä¹ˆå°±è¡Œå‘¢? echo (&#x27;1+5&#x27; . 5)+1; //è¾“å‡º2 æˆ‘ä»¬ç»™å‰é¢çš„åŠ ä¸ªæ‹¬å·åï¼Œå¾—åˆ°çš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œè¯æ˜PHPæ˜¯å…ˆè¿æ¥å­—ç¬¦ä¸²å†è¿›è¡ŒåŠ æ³•è®¡ç®—äº†ï¼ŒæŒ‰ç…§ä»å·¦å‘å³çš„æ–¹å‘è¿›è¡Œçš„. æ—¢ç„¶æ˜¯å…ˆè¿æ¥çš„å­—ç¬¦ä¸².é‚£ä¹ˆå°±åº”è¯¥æ˜¯â€1+55â€äº†ï¼Œç„¶åå†ç”¨è¿™ä¸ªå­—ç¬¦ä¸²åŠ ä¸Š1ï¼Œé‚£ä¸ºä»€ä¹ˆå°±ä¼šè¾“å‡º2å‘¢? è¿™ä¸ªè·ŸPHPä¸­å­—ç¬¦ä¸²å˜æˆæ•°å­—çš„æœºåˆ¶æ˜¯ç›¸å…³çš„.æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚ echo (int)&#x27;abc1&#x27;; //è¾“å‡º0 echo (int)&#x27;1abc&#x27;; //è¾“å‡º1 echo (int)&#x27;2abc&#x27;; //è¾“å‡º2 echo (int)&#x27;22abc&#x27;; //è¾“å‡º22 ä»ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœå°†ä¸€ä¸ªå­—ç¬¦ä¸²å¼ºåˆ¶è½¬æ¢æˆä¸€ä¸ªæ•°å­—ï¼ŒPHPä¼šå»æœç´¢è¿™ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´ï¼Œå¦‚æœå¼€å¤´æ˜¯æ•°å­—å°±è½¬æ¢ï¼Œå¦‚æœä¸æ˜¯å°±ç›´æ¥è¿”å›0ã€‚ å›åˆ°åˆšæ‰çš„1+55ï¼Œæ—¢ç„¶è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯1+55ï¼Œæ‰€ä»¥å¼ºåˆ¶ç±»å‹è½¬æ¢åå°±åº”è¯¥æ˜¯1äº†ï¼Œåœ¨æ­¤åŸºç¡€ä¸ŠåŠ 1ï¼Œå½“ç„¶æ˜¯2äº†ã€‚ ä¸ºäº†è¯æ˜æˆ‘ä»¬çš„çŒœæƒ³ï¼Œæˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹. echo &#x27;5+1=&#x27; . 1+5; //è¾“å‡º10 echo &#x27;5+1=&#x27; . 5+1; //è¾“å‡º6 echo &#x27;1+5=&#x27; . 1+5; //è¾“å‡º6 echo &#x27;1+5=&#x27; . 5+1; //è¾“å‡º2 ç»“æœè¯æ˜ï¼Œæˆ‘ä»¬çš„è®¾æƒ³æ˜¯æ­£ç¡®çš„ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆä½¿ç”¨é€—å·å°±æ²¡æœ‰ä¸Šé¢çš„é—®é¢˜äº†å‘¢? æ‰‹å†Œä¸Šè¯´äº†ï¼Œç”¨é€—å·æ˜¯multiple parameters. ä¹Ÿå°±æ˜¯è¯´æ˜¯å¤šå‚æ•°.æ¢å¥è¯è¯´ï¼Œé€—å·åˆ†éš”å¼€çš„å°±ç›¸å½“äºæ˜¯Nä¸ªå‚æ•°.ä¹Ÿå°±æ˜¯è¯´æŠŠechoå½“ä¸ªå‡½æ•°ç”¨. è¿™æ ·çš„è¯,echoä¼šå¯¹æ¯ä¸ªå‚æ•°å…ˆè¿›è¡Œè®¡ç®—,æœ€åå†è¿›è¡Œè¿æ¥åè¾“å‡º,æ‰€ä»¥æˆ‘ä»¬ç”¨é€—å·å°±ä¸å­˜åœ¨ä¸Šé¢çš„é—®é¢˜äº†ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"PHPæ“ä½œMySQLäº‹åŠ¡å®ä¾‹","slug":"PHPæ“ä½œMySQLäº‹åŠ¡å®ä¾‹","date":"2017-09-15T08:52:34.000Z","updated":"2022-03-19T14:35:21.631Z","comments":true,"path":"2017/09/15/132/","link":"","permalink":"https://github.13sai.com/2017/09/15/132/","excerpt":"","text":"ä¸€èˆ¬æ¥è¯´ï¼Œäº‹åŠ¡éƒ½åº”è¯¥å…·å¤‡ACIDç‰¹å¾ã€‚æ‰€è°“ACIDæ˜¯Atomicï¼ˆåŸå­æ€§ï¼‰ï¼ŒConsistentï¼ˆä¸€è‡´æ€§ï¼‰ï¼ŒIsolatedï¼ˆéš”ç¦»æ€§ï¼‰ï¼ŒDurableï¼ˆæŒç»­æ€§ï¼‰å››ä¸ªè¯çš„é¦–å­—æ¯æ‰€å†™ï¼Œä¸‹é¢ä»¥â€œé“¶è¡Œè½¬å¸â€ä¸ºä¾‹æ¥åˆ†åˆ«è¯´æ˜ä¸€ä¸‹å®ƒä»¬çš„å«ä¹‰ï¼š åŸå­æ€§ï¼šç»„æˆäº‹åŠ¡å¤„ç†çš„è¯­å¥å½¢æˆäº†ä¸€ä¸ªé€»è¾‘å•å…ƒï¼Œä¸èƒ½åªæ‰§è¡Œå…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚æ¢å¥è¯è¯´ï¼Œäº‹åŠ¡æ˜¯ä¸å¯åˆ†å‰²çš„æœ€å°å•å…ƒã€‚æ¯”å¦‚ï¼šé“¶è¡Œè½¬å¸è¿‡ç¨‹ä¸­ï¼Œå¿…é¡»åŒæ—¶ä»ä¸€ä¸ªå¸æˆ·å‡å»è½¬å¸é‡‘é¢ï¼Œå¹¶åŠ åˆ°å¦ä¸€ä¸ªå¸æˆ·ä¸­ï¼Œåªæ”¹å˜ä¸€ä¸ªå¸æˆ·æ˜¯ä¸åˆç†çš„ã€‚ ä¸€è‡´æ€§ï¼šåœ¨äº‹åŠ¡å¤„ç†æ‰§è¡Œå‰åï¼Œæ•°æ®åº“æ˜¯ä¸€è‡´çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œäº‹åŠ¡åº”è¯¥æ­£ç¡®çš„è½¬æ¢ç³»ç»ŸçŠ¶æ€ã€‚æ¯”å¦‚ï¼šé“¶è¡Œè½¬å¸è¿‡ç¨‹ä¸­ï¼Œè¦ä¹ˆè½¬å¸é‡‘é¢ä»ä¸€ä¸ªå¸æˆ·è½¬å…¥å¦ä¸€ä¸ªå¸æˆ·ï¼Œè¦ä¹ˆä¸¤ä¸ªå¸æˆ·éƒ½ä¸å˜ï¼Œæ²¡æœ‰å…¶ä»–çš„æƒ…å†µã€‚ éš”ç¦»æ€§ï¼šä¸€ä¸ªäº‹åŠ¡å¤„ç†å¯¹å¦ä¸€ä¸ªäº‹åŠ¡å¤„ç†æ²¡æœ‰å½±å“ã€‚å°±æ˜¯è¯´ä»»ä½•äº‹åŠ¡éƒ½ä¸å¯èƒ½çœ‹åˆ°ä¸€ä¸ªå¤„åœ¨ä¸å®Œæ•´çŠ¶æ€ä¸‹çš„äº‹åŠ¡ã€‚æ¯”å¦‚è¯´ï¼Œé“¶è¡Œè½¬å¸è¿‡ç¨‹ä¸­ï¼Œåœ¨è½¬å¸äº‹åŠ¡æ²¡æœ‰æäº¤ä¹‹å‰ï¼Œå¦ä¸€ä¸ªè½¬å¸äº‹åŠ¡åªèƒ½å¤„äºç­‰å¾…çŠ¶æ€ã€‚ æŒä¹…æ€§ï¼šäº‹åŠ¡å¤„ç†çš„æ•ˆæœèƒ½å¤Ÿè¢«æ°¸ä¹…ä¿å­˜ä¸‹æ¥ã€‚åè¿‡æ¥è¯´ï¼Œäº‹åŠ¡åº”å½“èƒ½å¤Ÿæ‰¿å—æ‰€æœ‰çš„å¤±è´¥ï¼ŒåŒ…æ‹¬æœåŠ¡å™¨ã€è¿›ç¨‹ã€é€šä¿¡ä»¥åŠåª’ä½“å¤±è´¥ç­‰ç­‰ã€‚æ¯”å¦‚ï¼šé“¶è¡Œè½¬å¸è¿‡ç¨‹ä¸­ï¼Œè½¬å¸åå¸æˆ·çš„çŠ¶æ€è¦èƒ½è¢«ä¿å­˜ä¸‹æ¥ã€‚ &lt;?php $sql1 = &quot;update User set ScoreCount = ScoreCount +10 where ID= &#x27;123456&#x27;&quot;; $sql2 = &quot;update ScoreDetail set FScore = 300 where ID= &#x27;123456&#x27;&quot;; $sql3 = &quot;insert into ScoreDetail ID,Score) values (&#x27;123456&#x27;,60)&quot;; $mysqli = new mysqli(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;&#x27;, &#x27;DB_Lib2Test&#x27;); $mysqli-&gt;autocommit(false); //å¼€å§‹äº‹åŠ¡ $mysqli-&gt;query($sql1); $mysqli-&gt;query($sql2); if (!$mysqli-&gt;errno) &#123; $mysqli-&gt;commit(); echo &#x27;ok&#x27;; &#125; else &#123; echo &#x27;err&#x27;; $mysqli-&gt;rollback(); &#125; $mysqli-&gt;autocommit(true); $sql1 = &quot;update User set ScoreCount = ScoreCount +10 where ID= &#x27;123456&#x27;&quot;; $sql2 = &quot;update ScoreDetail set FScore = 300 where ID= &#x27;123456&#x27;&quot;; $sql3 = &quot;insert into ScoreDetail ID,Score) values (&#x27;123456&#x27;,60)&quot;; $conn = mysql_connect(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;&#x27;); mysql_select_db(&#x27;test2&#x27;); mysql_query(&#x27;start transaction&#x27;); //mysql_query(&#x27;SET autocommit=0&#x27;); mysql_query($sql1); mysql_query($sql2); if (mysql_errno()) &#123; mysql_query(&#x27;rollback&#x27;); echo &#x27;err&#x27;; &#125; else &#123; mysql_query(&#x27;commit&#x27;); echo &#x27;ok&#x27;; &#125; // mysql_query(&#x27;SET autocommit=1&#x27;); // mysql_query($sql3);","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"},{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"å¾®ä¿¡æ¨¡æ¿çŸ­ä¿¡","slug":"å¾®ä¿¡æ¨¡æ¿çŸ­ä¿¡","date":"2017-07-25T10:06:48.000Z","updated":"2022-03-19T14:35:21.918Z","comments":true,"path":"2017/07/25/131/","link":"","permalink":"https://github.13sai.com/2017/07/25/131/","excerpt":"","text":"``` /* &nbsp;*&nbsp;å‘é€å¾®ä¿¡æ¨¡æ¿çŸ­ä¿¡ &nbsp;*&nbsp;$openid&nbsp;&nbsp;å¾®ä¿¡ç”¨æˆ·openid &nbsp;*&nbsp;$href&nbsp;&nbsp;&nbsp;&nbsp;çŸ­ä¿¡é“¾æ¥åˆ°çš„ç½‘å€ &nbsp;*/ function&nbsp;wx_send($openid,&nbsp;$href){ &nbsp;&nbsp;&nbsp;&nbsp;$tpl&nbsp;=&nbsp;array( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//æ¥æ”¶è€…d &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;touser&quot;=&gt;$openid, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//è¿™é‡Œæ˜¯ä½ è¦å‘é€çš„æ¨¡æ¿ç±»å‹id &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;template_id&quot;=&gt;&quot;uWkFcjxKGrMLdZZM3WcFEh9Tkk_Dh2bU1SICF92n-RY&quot;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//è¿™é‡Œæ˜¯ç‚¹å‡»æ¨¡æ¿è·³è½¬çš„é¡µé¢ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;url&quot;&nbsp;=&gt;&nbsp;$href, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//æ ‡é¢˜é¢œè‰² &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;topcolor&quot;&nbsp;=&gt;&nbsp;&quot;#FFAE89&quot;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;data&quot;&nbsp;=&gt;&nbsp;array( //è¿™é‡Œçš„first,keyword&nbsp;éƒ½è¦å¯¹åº”è¿™æ¨¡æ¿é‡Œé¢çš„ä¿¡æ¯å†™&nbsp;é¢œè‰²å¯è‡ªå®šä¹‰ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;first&quot;&nbsp;=&gt;&nbsp;array(&quot;value&quot;&nbsp;=&gt;&nbsp;&quot;è´­è½¦é€šçŸ¥&quot;), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;keyword1&quot;&nbsp;=&gt;&nbsp;array(&quot;value&quot;&nbsp;=&gt;&nbsp;&quot;195800å…ƒ&quot;), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;keyword2&quot;&nbsp;=&gt;&nbsp;array(&quot;value&quot;&nbsp;=&gt;&nbsp;&quot;å¥¥è¿ªA3&nbsp;2017æ¬¾&nbsp;Sportback&nbsp;35&nbsp;TFSI&nbsp;é£å°šå‹&quot;), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;keyword3&quot;&nbsp;=&gt;&nbsp;array(&quot;value&quot;&nbsp;=&gt;&nbsp;&quot;å—äº¬å¸‚é›¨èŠ±å°åŒº&quot;), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;keyword4&quot;&nbsp;=&gt;&nbsp;array(&quot;value&quot;&nbsp;=&gt;&nbsp;&quot;02588888888&quot;), //è¿™é‡Œæ˜¯é€šç”¨çš„&nbsp;å°±ç±»ä¼¼ä¸å¤‡æ³¨çš„å­˜åœ¨ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;remark&quot;&nbsp;=&gt;&nbsp;array(&quot;value&quot;&nbsp;=&gt;&nbsp;&quot;æ”¯ä»˜è´­è½¦æ¬¾åï¼Œè¯·å°½å¿«åŠç†è½¦è¾†è¿‡æˆ·æ‰‹ç»­&quot;,&quot;color&quot;&nbsp;=&gt;&nbsp;&quot;#FF7256&quot;), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;), &nbsp;&nbsp;&nbsp;&nbsp;); &nbsp;&nbsp;&nbsp;&nbsp;$json_template&nbsp;=&nbsp;json_encode($tpl); &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$url&nbsp;=&nbsp;&quot;https://api.weixin.qq.com/cgi-bin/message/template/send?access_token=&quot;.get_access_token(); &nbsp;&nbsp;&nbsp;&nbsp;$res&nbsp;=&nbsp;json_decode(http_request($url,urldecode($json_template)),true); &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($res[&quot;errcode&quot;]&nbsp;==&nbsp;0){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;ok&quot;; &nbsp;&nbsp;&nbsp;&nbsp;}else{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;json_encode($res); &nbsp;&nbsp;&nbsp;&nbsp;} } /* &nbsp;*&nbsp;è·å–access_token &nbsp;*/ function&nbsp;get_access_token(){ &nbsp;&nbsp;&nbsp;&nbsp;$appid&nbsp;=&nbsp;z_get_config(&#39;wechat_appid&#39;); &nbsp;&nbsp;&nbsp;&nbsp;$appsecret&nbsp;=&nbsp;z_get_config(&#39;wechat_appsecret&#39;); &nbsp;&nbsp;&nbsp;&nbsp;$url_get=&#39;https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=&#39;.$appid.&#39;&amp;secret=&#39;.$appsecret; &nbsp;&nbsp;&nbsp;&nbsp;$json=z_get_json($url_get); &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$json[&#39;access_token&#39;]; } function&nbsp;http_request($url,&nbsp;$data&nbsp;=&nbsp;array()) { &nbsp;&nbsp;&nbsp;&nbsp;$ch&nbsp;=&nbsp;curl_init(); &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_URL,&nbsp;$url); &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_RETURNTRANSFER,&nbsp;1); &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_SSL_VERIFYPEER,&nbsp;FALSE); &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_SSL_VERIFYHOST,&nbsp;FALSE); &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;postæ•°æ® &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_POST,&nbsp;1); &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;æŠŠpostçš„å˜é‡åŠ ä¸Š &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_POSTFIELDS,&nbsp;$data); &nbsp;&nbsp;&nbsp;&nbsp;$output&nbsp;=&nbsp;curl_exec($ch); &nbsp;&nbsp;&nbsp;&nbsp;curl_close($ch); &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$output; } function&nbsp;z_get_json($url){ &nbsp;&nbsp;&nbsp;&nbsp;$ch&nbsp;=&nbsp;curl_init(); &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_URL,&nbsp;$url); &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_SSL_VERIFYPEER,&nbsp;FALSE);&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_SSL_VERIFYHOST,&nbsp;FALSE);&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_RETURNTRANSFER,&nbsp;1); &nbsp;&nbsp;&nbsp;&nbsp;$output&nbsp;=&nbsp;curl_exec($ch); &nbsp;&nbsp;&nbsp;&nbsp;curl_close($ch); &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json_decode($output,&nbsp;true); } ```","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"é˜¿é‡Œäº‘èº«ä»½è¯å®åè®¤è¯","slug":"é˜¿é‡Œäº‘èº«ä»½è¯å®åè®¤è¯","date":"2017-07-25T10:03:43.000Z","updated":"2022-03-31T08:49:46.091Z","comments":true,"path":"2017/07/25/130/","link":"","permalink":"https://github.13sai.com/2017/07/25/130/","excerpt":"","text":"ç›´æ¥ä¸Šä»£ç ï¼Œä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„æ¥å£ã€‚ /* * èº«ä»½è¯æ ¡éªŒ * */ function sfz_verify($idcard, $name)&#123; $host = &quot;http://idcard.market.alicloudapi.com&quot;; $path = &quot;/lianzhuo/idcard&quot;; $method = &quot;GET&quot;; $appcode = z_get_config(&#x27;sfz_appcode&#x27;); $headers = array(); array_push($headers, &quot;Authorization:APPCODE &quot; . $appcode); $querys = &quot;cardno=$idcard&amp;name=$name&quot;; $bodys = &quot;&quot;; $url = $host . $path . &quot;?&quot; . $querys; $curl = curl_init(); curl_setopt($curl, CURLOPT_CUSTOMREQUEST, $method); curl_setopt($curl, CURLOPT_URL, $url); curl_setopt($curl, CURLOPT_HTTPHEADER, $headers); curl_setopt($curl, CURLOPT_FAILONERROR, false); curl_setopt($curl, CURLOPT_RETURNTRANSFER, true); curl_setopt($curl, CURLOPT_HEADER, true); if (1 == strpos(&quot;$&quot;.$host, &quot;https://&quot;))&#123; curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false); curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false); &#125; $output = curl_exec($curl); if (curl_getinfo($curl, CURLINFO_HTTP_CODE) == &#x27;200&#x27;) &#123; list($header, $body) = explode(&quot;\\r\\n\\r\\n&quot;, $output, 2); &#125; //dump($output); curl_close($curl); return $body; &#125; æ­£ç¡®è¿”å›å€¼å¦‚ä¸‹ï¼š &#123; &quot;resp&quot;: &#123; &quot;code&quot;: 0, &quot;desc&quot;: &quot;åŒ¹é…&quot; &#125;, &quot;data&quot;: &#123; &quot;sex&quot;: &quot;ç”·&quot;, &quot;address&quot;: &quot;å¹¿ä¸œçœæ¸…è¿œå¸‚æ¸…æ–°å¿&quot;, &quot;birthday&quot;: &quot;1989-05-25&quot; &#125; &#125;","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"è§£å†³åŠ¨æ€æ·»åŠ å…ƒç´ ç»‘å®šäº‹ä»¶åœ¨iosä¸Šé¢å¤±æ•ˆé—®é¢˜","slug":"è§£å†³åŠ¨æ€æ·»åŠ å…ƒç´ ç»‘å®šäº‹ä»¶åœ¨iosä¸Šé¢å¤±æ•ˆé—®é¢˜","date":"2017-07-15T03:41:22.000Z","updated":"2022-03-19T14:35:21.942Z","comments":true,"path":"2017/07/15/128/","link":"","permalink":"https://github.13sai.com/2017/07/15/128/","excerpt":"","text":"å½“ä½ çš„DOMèŠ‚ç‚¹æ˜¯åŠ¨æ€ç”Ÿæˆåœ¨é¡µé¢ä¸Šçš„æ—¶å€™ã€‚ æ™®é€šçš„ç‚¹å‡»$(element).click()ä¼šå› ä¸ºè·å–ä¸åˆ°domå…ƒç´ è€Œè‡´ä½¿ç‚¹å‡»å¤±æ•ˆã€‚ è¿™ç§æƒ…å†µä¸‹ä¸€èˆ¬ä½¿ç”¨æ—¶é—´æ‰˜ç®¡ä¾‹å¦‚jqçš„: $(document).on(element,â€™clickâ€™,fn) è¿™ä¸ªé€šè¿‡äº‹ä»¶æ‰˜ç®¡å¯ä»¥è®©jqueryè·å–åˆ°åŠ¨æ€ç”Ÿæˆçš„domèŠ‚ç‚¹ï¼Œä»¥æ­¤è§£å†³ç‚¹å‡»å¤±æ•ˆçš„é—®é¢˜ã€‚ ç„¶è€Œåœ¨iOSä¸Šè¿™æ ·çš„æ–¹æ³•è§£å†³ä¸äº†è¿™ä¸ªé—®é¢˜,åŸå› æ˜¯: åœ¨iosç³»ç»Ÿä¸­,ä¾‹å¦‚document,div,bodyè¿™äº›æœ¬èº«å¹¶æ²¡æœ‰å¯ä»¥è¢«ç‚¹å‡»çš„å±æ€§çš„å…ƒç´ ä¸èƒ½ä½œä¸ºæ‰˜ç®¡ç‚¹å‡»äº‹ä»¶çš„çˆ¶å…ƒç´ ã€‚æ‰€ä»¥,ç”¨è¿™æ ·çš„æ–¹æ³•è¿›è¡Œäº‹ä»¶æ‰˜ç®¡ï¼Œiosä¼šè·å–ä¸åˆ°ä½ çš„documentçš„ç‚¹å‡»äº‹ä»¶ï¼Œè‡ªç„¶æ— æ³•è·å–åˆ°ä½ æƒ³è¦ç»‘å®šçš„å…ƒç´ èº«ä¸Šã€‚ è§£å†³åŠæ³•å°±æ˜¯æŠŠdocumentæ¢æˆä½ æƒ³è¦ç»‘å®šå…ƒç´ çš„çˆ¶å…ƒç´ ä¸Šå¯ä»¥æ˜¯æœ€å¤§çš„é‚£ä¸ªdivï¼Œç„¶ååœ¨æœ€å¤§å…ƒç´ çš„æ ·å¼ä¸­åŠ å…¥cursor:pointer; è¿™ä¸ªå±æ€§å¯ä»¥è®©çˆ¶å…ƒç´ å˜æˆæ‹¥æœ‰å¯è¢«ç‚¹å‡»å±æ€§çš„ç›’å­ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³åŠ¨æ€æ•°æ®æ— æ³•ç»‘å®šäº‹ä»¶çš„é—®é¢˜ã€‚","categories":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/categories/js/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"ueditorè¿œç¨‹å›¾ç‰‡æœ¬åœ°åŒ–çš„å®ç°","slug":"ueditorè¿œç¨‹å›¾ç‰‡æœ¬åœ°åŒ–çš„å®ç°","date":"2017-07-13T02:02:31.000Z","updated":"2022-03-19T14:35:21.812Z","comments":true,"path":"2017/07/13/127/","link":"","permalink":"https://github.13sai.com/2017/07/13/127/","excerpt":"","text":"å‰ä¸ä¹…å®¢æˆ·åé¦ˆè¯´ï¼Œåœ¨ç§€ç±³ç½‘ä¸Šç¼–è¾‘å¥½æ–‡ç« ï¼Œå‘å¸ƒåˆ°æˆ‘ä»¬åå°ï¼Œå‰å°å›¾ç‰‡æ— æ³•æ˜¾ç¤ºï¼Œæœ€å…ˆæƒ³åˆ°çš„æ˜¯å›¾ç‰‡åŸŸåé™åˆ¶ã€‚å‘é‚®ä»¶ç»™ç§€ç±³ï¼Œç§€ç±³ç»™å‡ºçš„å»ºè®®æ˜¯ç±»ä¼¼å¾®ä¿¡åå°åšå›¾ç‰‡æœ¬åœ°åŒ–ã€‚å¼€å‘ç»„å†…éƒ¨è®¨è®ºåï¼Œçœ‹åˆ°äº†è¿™ç¯‡æ–‡ç« ï¼ŒUEditorç¼–è¾‘å™¨å¦‚ä½•å…³é—­æŠ“å–è¿œç¨‹å›¾ç‰‡æœ¬åœ°åŒ–åŠŸèƒ½ï¼Œso easy?æŒ‰æ–‡ç« è¯´æ˜è®¾ç½®ï¼Œæµ‹è¯•,å¤±è´¥ï¼ç™¾åº¦çœ‹äº†ä¸‹ï¼Œå¤§éƒ½æ˜¯è¿™æ ·è§£ç­”ï¼Œè¯´æ˜åº”è¯¥æ˜¯æœ‰äººå®ç°äº†ï¼Œç§€ç±³ç¼–è¾‘å™¨æ ¸å¿ƒä»£ç ä¹Ÿæ­£æ˜¯ueditoræ ¸å¿ƒä»£ç ï¼Œé‚£å°±åªèƒ½è‡ªå·±æ£é¼“äº†ã€‚å…·ä½“æ£é¼“è¿‡ç¨‹å¦‚ä¸‹ï¼šæ³¨æ„ï¼šæ£é¼“å‰å…ˆå¤‡ä»½ä¸‹ï¼Œä»¥å¤‡ä¿®æ”¹é”™è¯¯å¯¼è‡´å…¶ä»–é—®é¢˜æ‰“å¼€ueditor.config.jsï¼Œåœ¨é…ç½®é¡¹ä¸­åŠ å…¥,catchRemoteImageEnable:trueæ‰“å¼€ueditor.config.jsï¼Œæœç´¢catchremoteimageï¼Œåœ¨åŠ å…¥console.warn(url)ï¼Œçœ‹çœ‹ä¸Šä¼ åœ°å€ã€‚å‰å°æµ‹è¯•åçœ‹åˆ°/Skin/public/ueditor/php/controller.php?action=catchimageæ‰“å¼€php/controller.php å¯ä»¥çœ‹åˆ°case&nbsp;&#39;catchimage&#39;: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result&nbsp;=&nbsp;include(&quot;action_crawler.php&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;æ¥ç€æ‰“å¼€ç»Ÿè®¡ç›®å½•ä¸‹action_crawler.phpinclude(&quot;Uploader.class.php&quot;); $item&nbsp;=&nbsp;new&nbsp;Uploader($imgUrl,&nbsp;$config,&nbsp;&quot;remote&quot;);çœ‹åˆ°è¿™ä¸¤æ®µä»£ç ã€‚ç»§ç»­æ‰“å¼€ç»Ÿè®¡ç›®å½•ä¸‹Uploader.class.php//æ„é€ å‡½æ•°å¦‚ä¸‹ public&nbsp;function&nbsp;__construct($fileField,&nbsp;$config,&nbsp;$type&nbsp;=&nbsp;&quot;upload&quot;) &nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileField&nbsp;=&nbsp;$fileField;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;config&nbsp;=&nbsp;$config;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;type&nbsp;=&nbsp;$type; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($type&nbsp;==&nbsp;&quot;remote&quot;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;saveRemote(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if($type&nbsp;==&nbsp;&quot;base64&quot;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;upBase64(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;upFile(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateMap[&#39;ERROR_TYPE_NOT_ALLOWED&#39;]&nbsp;=&nbsp;iconv(&#39;unicode&#39;,&nbsp;&#39;utf-8&#39;,&nbsp;$this-&gt;stateMap[&#39;ERROR_TYPE_NOT_ALLOWED&#39;]); &nbsp;&nbsp;&nbsp;&nbsp;}æœç´¢saveRemoteï¼Œä¸»è¦ä¿®å¤fileTypeä¸oriNameä¸¤å—ã€‚/** &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;æ‹‰å–è¿œç¨‹å›¾ç‰‡ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;mixed &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/ &nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;saveRemote() &nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$imgUrl&nbsp;=&nbsp;htmlspecialchars($this-&gt;fileField); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$imgUrl&nbsp;=&nbsp;str_replace(&quot;&amp;amp;&quot;,&nbsp;&quot;&amp;&quot;,&nbsp;$imgUrl); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//httpå¼€å¤´éªŒè¯&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strpos($imgUrl,&nbsp;&quot;http&quot;)&nbsp;!==&nbsp;0)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_HTTP_LINK&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preg_match(&#39;/(^https*://[^:/]+)/&#39;,&nbsp;$imgUrl,&nbsp;$matches);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host_with_protocol&nbsp;=&nbsp;count($matches)&nbsp;&gt;&nbsp;1&nbsp;?&nbsp;$matches[1]&nbsp;:&nbsp;&#39;&#39;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;åˆ¤æ–­æ˜¯å¦æ˜¯åˆæ³•&nbsp;url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!filter_var($host_with_protocol,&nbsp;FILTER_VALIDATE_URL))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;INVALID_URL&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preg_match(&#39;/^https*://(.+)/&#39;,&nbsp;$host_with_protocol,&nbsp;$matches);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host_without_protocol&nbsp;=&nbsp;count($matches)&nbsp;&gt;&nbsp;1&nbsp;?&nbsp;$matches[1]&nbsp;:&nbsp;&#39;&#39;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;æ­¤æ—¶æå–å‡ºæ¥çš„å¯èƒ½æ˜¯&nbsp;ip&nbsp;ä¹Ÿæœ‰å¯èƒ½æ˜¯åŸŸåï¼Œå…ˆè·å–&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ip&nbsp;=&nbsp;gethostbyname($host_without_protocol);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;åˆ¤æ–­æ˜¯å¦æ˜¯ç§æœ‰&nbsp;ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!filter_var($ip,&nbsp;FILTER_VALIDATE_IP,&nbsp;FILTER_FLAG_NO_PRIV_RANGE))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;INVALID_IP&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//è·å–è¯·æ±‚å¤´å¹¶æ£€æµ‹æ­»é“¾&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$heads&nbsp;=&nbsp;get_headers($imgUrl,&nbsp;1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!(stristr($heads[0],&nbsp;&quot;200&quot;)&nbsp;&amp;&amp;&nbsp;stristr($heads[0],&nbsp;&quot;OK&quot;)))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_DEAD_LINK&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//æ ¼å¼éªŒè¯(æ‰©å±•åéªŒè¯å’ŒContent-TypeéªŒè¯)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fileType&nbsp;=&nbsp;strtolower(strrchr($imgUrl,&nbsp;&#39;.&#39;));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//13sai&nbsp;20170712&nbsp;&nbsp;ç§€ç±³ç½‘é“¾æ¥æ¥å¦‚ä¸‹http://img.xiumi.us/xmi/ua/h4qG/i/b8f2af6986e8dba51615a9d85cc82f3b-sz_1952250.JPG?x-oss-process=style/xm&nbsp;ï¼Œæˆ‘ä»¬å®Œå–„ä¸‹&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fileType&nbsp;=&nbsp;(strpos($fileType,&nbsp;&#39;?&#39;)&nbsp;&gt;&nbsp;0)?&nbsp;strtolower(substr($fileType,0,strpos($fileType,&#39;?&#39;)))&nbsp;:&nbsp;strtolower($fileType);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$fileType;die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!in_array($fileType,&nbsp;$this-&gt;config[&#39;allowFiles&#39;])&nbsp;||&nbsp;!isset($heads[&#39;Content-Type&#39;])&nbsp;||&nbsp;!stristr($heads[&#39;Content-Type&#39;],&nbsp;&quot;image&quot;))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_HTTP_CONTENTTYPE&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//æ‰“å¼€è¾“å‡ºç¼“å†²åŒºå¹¶è·å–è¿œç¨‹å›¾ç‰‡&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob_start();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$context&nbsp;=&nbsp;stream_context_create(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;http&#39;&nbsp;=&gt;&nbsp;array(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;follow_location&#39;&nbsp;=&gt;&nbsp;false&nbsp;//&nbsp;don&#39;t&nbsp;follow&nbsp;redirects&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readfile($imgUrl,&nbsp;false,&nbsp;$context);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$img&nbsp;=&nbsp;ob_get_contents();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ob_end_clean();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//13sai&nbsp;20170712&nbsp;&nbsp;æ­¤å¤„æ­£åˆ™æœ‰é—®é¢˜ï¼Œä¿®æ”¹å¦‚ä¸‹&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//preg_match(&quot;//[.]?[^./]*$/&quot;,&nbsp;$imgUrl,&nbsp;$m);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preg_match(&quot;//[A-za-z0-9-]+.&quot;.$fileType.&quot;/&quot;,&nbsp;strtolower($imgUrl),&nbsp;$m);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//var_dump($m);die(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;oriName&nbsp;=&nbsp;$m&nbsp;?&nbsp;ltrim($m[0],&#39;/&#39;):&quot;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$this-&gt;oriName&nbsp;=&nbsp;$m&nbsp;?&nbsp;$m[1]:&quot;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$this-&gt;oriName;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileSize&nbsp;=&nbsp;strlen($img);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileType&nbsp;=&nbsp;$this-&gt;getFileExt();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fullName&nbsp;=&nbsp;$this-&gt;getFullName();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;filePath&nbsp;=&nbsp;$this-&gt;getFilePath();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;fileName&nbsp;=&nbsp;$this-&gt;getFileName();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dirname&nbsp;=&nbsp;dirname($this-&gt;filePath); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦è¶…å‡ºé™åˆ¶&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!$this-&gt;checkSize())&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_SIZE_EXCEED&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//åˆ›å»ºç›®å½•å¤±è´¥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!file_exists($dirname)&nbsp;&amp;&amp;&nbsp;!mkdir($dirname,&nbsp;0777,&nbsp;true))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_CREATE_DIR&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(!is_writeable($dirname))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_DIR_NOT_WRITEABLE&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//ç§»åŠ¨æ–‡ä»¶&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!(file_put_contents($this-&gt;filePath,&nbsp;$img)&nbsp;&amp;&amp;&nbsp;file_exists($this-&gt;filePath)))&nbsp;{&nbsp;//ç§»åŠ¨å¤±è´¥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;getStateInfo(&quot;ERROR_WRITE_CONTENT&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;//ç§»åŠ¨æˆåŠŸ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;stateInfo&nbsp;=&nbsp;$this-&gt;stateMap[0];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;}æ‰“å¼€php/config.jsonï¼Œä¿®æ”¹å¤§å°ã€æ ¼å¼ã€å­˜å‚¨è·¯å¾„ç­‰å‚æ•°/&nbsp;æŠ“å–è¿œç¨‹å›¾ç‰‡é…ç½®&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&quot;catcherLocalDomain&quot;:&nbsp;[&quot;127.0.0.1&quot;,&nbsp;&quot;localhost&quot;,&nbsp;&quot;img.baidu.com&quot;],&nbsp;&nbsp;&nbsp;&nbsp;&quot;catcherActionName&quot;:&nbsp;&quot;catchimage&quot;,&nbsp;/&nbsp;æ‰§è¡ŒæŠ“å–è¿œç¨‹å›¾ç‰‡çš„actionåç§°&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&quot;catcherFieldName&quot;:&nbsp;&quot;source&quot;,&nbsp;/&nbsp;æäº¤çš„å›¾ç‰‡åˆ—è¡¨è¡¨å•åç§°&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&quot;catcherPathFormat&quot;:&nbsp;&quot;/Upload/ueditor/image/{yyyy}{mm}{dd}/{time}{rand:6}&quot;,&nbsp;/&nbsp;ä¸Šä¼ ä¿å­˜è·¯å¾„,å¯ä»¥è‡ªå®šä¹‰ä¿å­˜è·¯å¾„å’Œæ–‡ä»¶åæ ¼å¼&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&quot;catcherUrlPrefix&quot;:&nbsp;&quot;&quot;,&nbsp;/&nbsp;å›¾ç‰‡è®¿é—®è·¯å¾„å‰ç¼€&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&quot;catcherMaxSize&quot;:&nbsp;20480000,&nbsp;/&nbsp;ä¸Šä¼ å¤§å°é™åˆ¶ï¼Œå•ä½B&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&quot;catcherAllowFiles&quot;:&nbsp;[&quot;.png&quot;,&nbsp;&quot;.jpg&quot;,&nbsp;&quot;.jpeg&quot;,&nbsp;&quot;.gif&quot;,&nbsp;&quot;.bmp&quot;],&nbsp;/&nbsp;æŠ“å–å›¾ç‰‡æ ¼å¼æ˜¾ç¤º&nbsp;/5.ä¿å­˜ä¿®æ”¹ä¸Šä¼ ï¼Œæµ‹è¯•æˆåŠŸï¼","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"ueditor","slug":"ueditor","permalink":"https://github.13sai.com/tags/ueditor/"}]},{"title":"csvå¯¼å‡ºå¯¼å…¥","slug":"csvå¯¼å‡ºå¯¼å…¥","date":"2017-05-31T03:22:24.000Z","updated":"2022-03-19T14:35:21.679Z","comments":true,"path":"2017/05/31/124/","link":"","permalink":"https://github.13sai.com/2017/05/31/124/","excerpt":"","text":"CSVï¼ˆé€—å·åˆ†éš”å€¼æ–‡ä»¶æ ¼å¼ï¼‰é€—å·åˆ†éš”å€¼ï¼ˆComma-Separated Valuesï¼ŒCSVï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºå­—ç¬¦åˆ†éš”å€¼ï¼Œå› ä¸ºåˆ†éš”å­—ç¬¦ä¹Ÿå¯ä»¥ä¸æ˜¯é€—å·ï¼‰ï¼Œå…¶æ–‡ä»¶ä»¥çº¯æ–‡æœ¬å½¢å¼å­˜å‚¨è¡¨æ ¼æ•°æ®ï¼ˆæ•°å­—å’Œæ–‡æœ¬ï¼‰ã€‚çº¯æ–‡æœ¬æ„å‘³ç€è¯¥æ–‡ä»¶æ˜¯ä¸€ä¸ªå­—ç¬¦åºåˆ—ï¼Œä¸å«å¿…é¡»åƒäºŒè¿›åˆ¶æ•°å­—é‚£æ ·è¢«è§£è¯»çš„æ•°æ®ã€‚CSVæ–‡ä»¶ç”±ä»»æ„æ•°ç›®çš„è®°å½•ç»„æˆï¼Œè®°å½•é—´ä»¥æŸç§æ¢è¡Œç¬¦åˆ†éš”ï¼›æ¯æ¡è®°å½•ç”±å­—æ®µç»„æˆï¼Œå­—æ®µé—´çš„åˆ†éš”ç¬¦æ˜¯å…¶å®ƒå­—ç¬¦æˆ–å­—ç¬¦ä¸²ï¼Œæœ€å¸¸è§çš„æ˜¯é€—å·æˆ–åˆ¶è¡¨ç¬¦ã€‚é€šå¸¸ï¼Œæ‰€æœ‰è®°å½•éƒ½æœ‰å®Œå…¨ç›¸åŒçš„å­—æ®µåºåˆ—ã€‚å¯¹äºå¤§æ•°é‡çš„å¯¼å‡ºï¼Œcsvå¯¼å‡ºçš„é€Ÿåº¦ko excelå¯¼å‡ºé€Ÿåº¦ï¼Œè€Œcsvæ–‡ä»¶ä¹Ÿèƒ½ç”¨excelæ‰“å¼€ï¼Œè¿™å¤§å¤§æé«˜äº†é¡µé¢æ€§èƒ½ã€‚å”¯ä¸€ä¸å¥½çš„å°±æ˜¯csvå¯¼å‡ºä¸æ¯”excelå¯¼å‡ºçµæ´»ï¼ŒåŠ å•å…ƒæ ¼æ ·å¼ã€åˆå¹¶å•å…ƒæ ¼å°±æ˜¾ç¤ºä¸å‡ºä¼˜åŠ¿æ¥äº†ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç ï¼š&lt;?php $data&nbsp;=&nbsp;array&nbsp;( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;å§“å&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;æ€§åˆ«&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;å¹´é¾„&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;åŸå¸‚&#39; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;å¼ ä¸‰&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;ç”·&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;34å²&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;åŒ—äº¬&#39; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;æå››&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;ç”·&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;38å²&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;å¤©æ´¥&#39; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;ç‹äº”&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;ç”·&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;90å²&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;æ¹–åŒ—&#39; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array&nbsp;( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;èµµå…­&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;ç”·&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;12å²&#39;, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;é™•è¥¿&#39; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) ); /* &nbsp;*&nbsp;åŠŸèƒ½æè¿°:å°†æ•°ç»„æ•°æ®å†™å…¥cvsæ–‡ä»¶ &nbsp;* &nbsp;*&nbsp;å‚æ•°: &nbsp;*&nbsp;$data:éœ€è¦å†™å…¥çš„æ•°ç»„æ ¼å¼çš„æ•°æ® &nbsp;*&nbsp;$filename:csvæ–‡ä»¶çš„åç§°,å¦‚æœæ²¡æœ‰ç¡®å®š,é»˜è®¤ä¸ºå½“å‰æ—¶é—´(æ ¼å¼ä¸º:YmdHis) &nbsp;* &nbsp;* &nbsp;*&nbsp;*/ function&nbsp;write_csv($data&nbsp;=&nbsp;null,&nbsp;$filename&nbsp;=&nbsp;null)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!&nbsp;($data&nbsp;||&nbsp;$filename))&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;$fp&nbsp;=&nbsp;fopen&nbsp;(&nbsp;$filename&nbsp;,&nbsp;&#39;w&#39;&nbsp;); &nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(&nbsp;$data&nbsp;as&nbsp;$fields&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fputcsv&nbsp;(&nbsp;$fp,&nbsp;$fields&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;fclose&nbsp;(&nbsp;$fp&nbsp;);}/*&nbsp;&nbsp;åŠŸèƒ½æè¿°:ä¸å†™å…¥cvsæ–‡ä»¶,å¹¶ä¸”è¾“å‡ºçš„åˆ°æµè§ˆå™¨&nbsp;&nbsp;&nbsp;å‚æ•°:&nbsp;&nbsp;$data:éœ€è¦å†™å…¥çš„æ•°ç»„æ ¼å¼çš„æ•°æ®&nbsp;&nbsp;$filename:csvæ–‡ä»¶çš„åç§°,å¦‚æœæ²¡æœ‰ç¡®å®š,é»˜è®¤ä¸ºå½“å‰æ—¶é—´(æ ¼å¼ä¸º:YmdHis)&nbsp;&nbsp;*&nbsp;&nbsp;/function&nbsp;output_csv($data&nbsp;=&nbsp;null,&nbsp;$filename&nbsp;=&nbsp;null)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!&nbsp;($data&nbsp;||&nbsp;$filename))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;header(&#39;Content-Type:application/force-download&#39;);&nbsp;&nbsp;&nbsp;&nbsp;header(&quot;content-Disposition:attachment;filename={$filename}&quot;); &nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(&nbsp;$data&nbsp;as&nbsp;$fields&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($fields&nbsp;as&nbsp;$value){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$value.&#39;,&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;}}/*&nbsp;&nbsp;åŠŸèƒ½æè¿°:è¯»å–cvsæ–‡ä»¶&nbsp;&nbsp;&nbsp;å‚æ•°:&nbsp;&nbsp;$filename:è¦è¯»å–çš„csvæ–‡ä»¶çš„åç§°&nbsp;*&nbsp;*&nbsp;&nbsp;/function&nbsp;read_csv($filename=null)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;if(!$filename){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;$handle=fopen($filename,&#39;r&#39;);&nbsp;&nbsp;&nbsp;&nbsp;if(!$handle){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;meta&nbsp;charset=&#39;utf-8&#39;/&gt;&quot;; &nbsp;&nbsp;&nbsp;&nbsp;$row=1;&nbsp;&nbsp;&nbsp;&nbsp;while($data=fgetcsv($handle,1000,&quot;,&quot;)){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$num=count($data);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;br&gt;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;&quot;&lt;h1&gt;&nbsp;&nbsp;ç¬¬&nbsp;$row&nbsp;è¡Œ&nbsp;,å…±æœ‰&nbsp;$num&nbsp;ä¸ªå­—æ®µ&nbsp;&lt;br&nbsp;/&gt;&lt;/h1&gt;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$row&nbsp;++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;($c=0;$c&lt;$num;$c++){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$data[$c].&quot; &quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;} }/*&nbsp;&nbsp;åŠŸèƒ½æè¿°:è¯»å–cvsæ–‡ä»¶,è¾“å‡ºåˆ°æµè§ˆå™¨,é‡‡ç”¨file_get_contentså¤„ç†&nbsp;&nbsp;&nbsp;å‚æ•°:&nbsp;&nbsp;$filename:è¦è¯»å–çš„csvæ–‡ä»¶çš„åç§°&nbsp;*&nbsp;*&nbsp;&nbsp;/function&nbsp;read_output_file_get_contents($filename=null){&nbsp;&nbsp;&nbsp;&nbsp;if(!$filename){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;header(&#39;Content-Type:application/force-download&#39;);&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;header(&quot;content-Disposition:filename={$filename}&quot;); &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;file_get_contents($filename);}/*&nbsp;&nbsp;åŠŸèƒ½æè¿°:è¯»å–cvsæ–‡ä»¶,è¾“å‡ºåˆ°æµè§ˆå™¨,é‡‡ç”¨fopenå¤„ç†&nbsp;&nbsp;&nbsp;å‚æ•°:&nbsp;&nbsp;$filename:è¦è¯»å–çš„csvæ–‡ä»¶çš„åç§°&nbsp;*&nbsp;*&nbsp;&nbsp;/function&nbsp;read_output_fopen($filename=null){&nbsp;&nbsp;&nbsp;&nbsp;if(!$filename){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;$file_handle&nbsp;=&nbsp;fopen($filename,&nbsp;&quot;r&quot;);&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;meta&nbsp;charset=&#39;utf-8&#39;/&gt;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(!feof($file_handle))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$line&nbsp;=&nbsp;fgets($file_handle);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$line.&#39;&lt;br/&gt;&#39;;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;fclose($file_handle);} //&nbsp;output_csv($data,&#39;ggg.xls&#39;);//output_csv($data,&#39;ggg.csv&#39;); //&nbsp;read_csv(&#39;ggg.csv&#39;); //read_output_file_get_contents(&#39;ggg.csv&#39;); //&nbsp;read_output_fopen(&#39;ggg.csv&#39;);ç®€å•æ˜äº†ï¼Œæ— éœ€å¤šè¨€ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"},{"name":"CSV","slug":"CSV","permalink":"https://github.13sai.com/tags/CSV/"}]},{"title":"jsæµ®ç‚¹æ•°è®¡ç®—è¯¯å·®bug","slug":"jsæµ®ç‚¹æ•°è®¡ç®—è¯¯å·®bug","date":"2017-05-24T06:04:14.000Z","updated":"2022-03-19T14:35:21.746Z","comments":true,"path":"2017/05/24/123/","link":"","permalink":"https://github.13sai.com/2017/05/24/123/","excerpt":"","text":"æœ€è¿‘åœ¨åšé¡¹ç›®æµ‹è¯•æ—¶ï¼Œç”¨åˆ°äº†JSæµ®ç‚¹æ•°è®¡ç®—ï¼Œ0.2+0.1ç»“æœä¸º0.30000000000000004ã€‚å› ä¸ºéƒ½æ˜¯å–ä¸€ä½å°æ•°ï¼Œå°±æŠŠè®¡ç®—åé¢åŠ äº†ä¸ªtoFixed(1).è™½ç„¶è§£å†³äº†é—®é¢˜ï¼Œä½†è¿˜æ˜¯è¯¦ç»†çœ‹äº†ä¸‹å…¶ä¸­ç¼˜ç”±ã€‚è®¡ç®—æœºä¸­çš„æµ®ç‚¹æ•°ï¼šæµ®ç‚¹æŒ‡çš„æ˜¯å¸¦æœ‰å°æ•°çš„æ•°å€¼ï¼Œæµ®ç‚¹è¿ç®—å³æ˜¯å°æ•°çš„å››åˆ™è¿ç®—ï¼Œå¸¸ç”¨æ¥æµ‹é‡ç”µè„‘è¿ç®—é€Ÿåº¦ã€‚å¤§éƒ¨ä»½è®¡ç®—æœºé‡‡ç”¨äºŒé€²åˆ¶ï¼ˆb=2ï¼‰çš„è¡¨ç¤ºæ–¹æ³•ã€‚ä½(bit)æ˜¯è¡¡é‡æµ®ç‚¹æ•°æ‰€éœ€å­˜å‚¨ç©ºé—´çš„å•ä½ï¼Œé€šå¸¸ä¸º32ä½æˆ–64ä½ï¼Œåˆ†åˆ«è¢«å«ä½œå•ç²¾åº¦å’ŒåŒç²¾åº¦ã€‚è¯¯å·®ç°è±¡ï¼š console.log(0.1+0.2);&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.30000000000000004console.log(0.15+0.15);&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.3 console.log(0.7+0.1);&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.7999999999999999console.log(0.6+0.2);&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.8 console.log(0.3*3);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.8999999999999999console.log(3*3/10);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.9ä»ä»¥ä¸Šç°è±¡å¯ä»¥çœ‹å‡ºï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æµ®ç‚¹æ•°è¿ç®—éƒ½ä¼šå‡ºé—®é¢˜ï¼Œåªæ˜¯éƒ¨åˆ†ã€‚0.7+0.1&nbsp;è¾“å‡ºæœ‰åå·®0.6+0.2&nbsp;è¾“å‡ºæ­£ç¡®å…·ä½“æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿè¯¯å·®åŸå› ï¼šä¸ä»…åœ¨ JavaScript ä¸­å­˜åœ¨è¿™ä¸ªã€Œé—®é¢˜ã€ï¼Œæ‰€æœ‰çš„æ”¯æŒäºŒè¿›åˆ¶æµ®ç‚¹æ•°è¿ç®—ï¼ˆç»å¤§éƒ¨åˆ†éƒ½æ˜¯ IEEE 754[1] çš„å®ç°ï¼‰çš„ç³»ç»Ÿéƒ½å­˜åœ¨è¿™ä¸ªç°è±¡ã€‚å…¶åŸå› å°±æ˜¯ï¼Œåœ¨æœ‰é™çš„å­˜å‚¨ç©ºé—´ä¸‹ï¼Œç»å¤§éƒ¨åˆ†çš„åè¿›åˆ¶å°æ•°éƒ½ä¸èƒ½ç”¨äºŒè¿›åˆ¶æµ®ç‚¹æ•°æ¥ç²¾ç¡®è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œ0.1 è¿™ä¸ªç®€å•çš„åè¿›åˆ¶å°æ•°å°±ä¸èƒ½ç”¨äºŒè¿›åˆ¶æµ®ç‚¹æ•°æ¥è¡¨ç¤ºã€‚æ‰€è°“ã€Œè®¡ç®—æœºæµ®ç‚¹æ•°ã€ï¼Œå…¶å®å°±æ˜¯äºŒè¿›åˆ¶çš„ã€Œç§‘å­¦è®¡æ•°æ³•ã€ã€‚åœ¨åè¿›åˆ¶ä¸­ï¼Œç§‘å­¦è®¡æ•°æ³•çš„å½¢å¼æ˜¯ï¼šç›¸åº”çš„ï¼ŒäºŒè¿›åˆ¶çš„ç§‘å­¦è®¡æ•°æ³•å°±æ˜¯ï¼šè€Œåœ¨æœ‰é™çš„å­˜å‚¨ç©ºé—´ä¸‹ï¼Œåè¿›åˆ¶å°æ•° 0.1 æ— è®ºå¦‚ä½•ä¹Ÿä¸èƒ½ç”¨è¿™ç§å½¢å¼æ¥è¡¨ç¤ºï¼Œå› æ­¤ï¼Œè®¡ç®—æœºåœ¨å­˜å‚¨å®ƒæ—¶ï¼Œäº§ç”Ÿäº†ç²¾åº¦ä¸¢å¤±ï¼Œæ‰€ä»¥å°±å‡ºç°äº†é—®é¢˜ä¸­æ‰€æè¿°çš„ç°è±¡ã€‚äºŒè¿›åˆ¶æµ®ç‚¹æ•°å…·ä½“çš„å‚¨å­˜ã€è¿ç®—ç»†èŠ‚ï¼Œå¯ä»¥æŸ¥é˜…ç°åœ¨åº”ç”¨æœ€å¹¿çš„ IEEE 754ã€‚è§£å†³æ–¹æ¡ˆï¼šå¦‚ä½•è§£å†³å‘¢ï¼Ÿçœ‹è¿™ä¸ªä¾‹å­ï¼š console.log(0.3*3);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.8999999999999999console.log(3*3/10);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.9æµ®ç‚¹æ•°è®¡ç®—æœ‰é—®é¢˜ï¼Œæ•´æ•°è®¡ç®—æ˜¯æ²¡é—®é¢˜çš„ï¼Œé‚£ä¹ˆå°†æµ®ç‚¹è½¬åŒ–æˆæ­£æ•°è¿ç®—ï¼Œä¹‹åå†åˆ‡å›æµ®ç‚¹å°±å¯ä»¥ä¿è¯æ²¡æœ‰åå·®äº†æ³¨ï¼šä¸æ¨èjsåšå¤ªå¤šçš„æµ®ç‚¹è¿ç®—ã€‚ä»¥ä¸‹æ–¹æ³•å¯ä»¥å¸®åŠ©ä½ ä¿®æ­£æµ®ç‚¹è¿ç®—çš„åå·®ï¼š//&nbsp;æµ®ç‚¹æ•°æ±‚å’Œfunction&nbsp;add(a,&nbsp;b)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;c,&nbsp;d,&nbsp;e; &nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;a.toString().split(&quot;.&quot;)[1].length; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(f)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;b.toString().split(&quot;.&quot;)[1].length; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(f)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;0; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;e&nbsp;=&nbsp;Math.pow(10,&nbsp;Math.max(c,&nbsp;d)),&nbsp;(mul(a,&nbsp;e)&nbsp;+&nbsp;mul(b,&nbsp;e))&nbsp;/&nbsp;e; }&nbsp; //&nbsp;æµ®ç‚¹æ•°ç›¸å‡function&nbsp;sub(a,&nbsp;b)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;c,&nbsp;d,&nbsp;e; &nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;a.toString().split(&quot;.&quot;)[1].length; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(f)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;b.toString().split(&quot;.&quot;)[1].length; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(f)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;0; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;e&nbsp;=&nbsp;Math.pow(10,&nbsp;Math.max(c,&nbsp;d)),&nbsp;(mul(a,&nbsp;e)&nbsp;-&nbsp;mul(b,&nbsp;e))&nbsp;/&nbsp;e; }&nbsp; //&nbsp;æµ®ç‚¹æ•°ç›¸ä¹˜function&nbsp;mul(a,&nbsp;b)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;c&nbsp;=&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;a.toString(),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;=&nbsp;b.toString(); &nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;+=&nbsp;d.split(&quot;.&quot;)[1].length; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(f)&nbsp;{} &nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;+=&nbsp;e.split(&quot;.&quot;)[1].length; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(f)&nbsp;{}&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Number(d.replace(&quot;.&quot;,&nbsp;&quot;&quot;))&nbsp;*&nbsp;Number(e.replace(&quot;.&quot;,&nbsp;&quot;&quot;))&nbsp;/&nbsp;Math.pow(10,&nbsp;c); }&nbsp; //&nbsp;æµ®ç‚¹æ•°ç›¸é™¤function&nbsp;div(a,&nbsp;b)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;c,&nbsp;d,&nbsp;e&nbsp;=&nbsp;0, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;0; &nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;=&nbsp;a.toString().split(&quot;.&quot;)[1].length; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(g)&nbsp;{} &nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;=&nbsp;b.toString().split(&quot;.&quot;)[1].length; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(g)&nbsp;{}&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;c&nbsp;=&nbsp;Number(a.toString().replace(&quot;.&quot;,&nbsp;&quot;&quot;)),&nbsp;d&nbsp;=&nbsp;Number(b.toString().replace(&quot;.&quot;,&nbsp;&quot;&quot;)),&nbsp;mul(c&nbsp;/&nbsp;d,&nbsp;Math.pow(10,&nbsp;f&nbsp;-&nbsp;e)); }éªŒè¯ï¼šconsole.log(0.1+0.2);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.30000000000000004console.log(add(0.1,&nbsp;0.2));&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.3 console.log(0.7+0.1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.7999999999999999console.log(add(0.7,&nbsp;0.1));&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.8 console.log(0.3*3);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.8999999999999999console.log(mul(0.3,&nbsp;3));&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¾“å‡º&nbsp;0.9é‡‡ç”¨ä¼˜åŒ–æ–¹æ³•åè®¡ç®—çš„ç»“æœéƒ½æ˜¯æ­£ç¡®çš„ã€‚","categories":[{"name":"bug","slug":"bug","permalink":"https://github.13sai.com/categories/bug/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"åˆ©ç”¨formdataæäº¤è¡¨å•","slug":"åˆ©ç”¨formdataæäº¤è¡¨å•","date":"2017-05-11T13:38:44.000Z","updated":"2022-05-06T09:00:13.408Z","comments":true,"path":"2017/05/11/121/","link":"","permalink":"https://github.13sai.com/2017/05/11/121/","excerpt":"","text":"XMLHttpRequest Level 2 æ·»åŠ äº†ä¸€ä¸ªæ–°çš„æ¥å£â€”â€”FormDataã€‚åˆ©ç”¨ FormData å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ JavaScript;ç”¨ä¸€äº›é”®å€¼å¯¹æ¥æ¨¡æ‹Ÿä¸€ç³»åˆ—è¡¨å•æ§ä»¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ XMLHttpRequest çš„ send() æ–¹æ³•æ¥å¼‚æ­¥çš„æäº¤è¡¨å•ã€‚ä¸æ™®é€šçš„ Ajax ç›¸æ¯”ï¼Œä½¿ç”¨ FormData çš„æœ€å¤§ä¼˜ç‚¹å°±æ˜¯æˆ‘ä»¬å¯ä»¥å¼‚æ­¥ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ç›´æ¥ä¸Šå®ä¾‹ï¼š &lt;form id=&quot;artCreateForm&quot; action=&quot;&#123;:U(&#x27;artCreate&#x27;)&#125;&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot; class=&quot;form-horizontal&quot; role=&quot;form&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;column_id&quot; value=&quot;&#123;$artColumn&#125;&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-3 control-label no-padding-right&quot; for=&quot;form-field-1&quot;&gt; æ ‡é¢˜ &lt;/label&gt; &lt;div class=&quot;col-sm-9&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;art_name&quot; placeholder=&quot;æ ‡é¢˜&quot; class=&quot;col-xs-10 col-sm-5 validate[required,maxSize[128]]&quot; /&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-3 control-label no-padding-right&quot; for=&quot;form-field-1&quot;&gt; æ‰€å±åˆ†ç±» &lt;/label&gt; &lt;div class=&quot;col-sm-9&quot;&gt; &lt;select name=&quot;art_category_id&quot; id=&quot;art_category_id&quot; class=&quot;&quot;&gt; &lt;option value=&quot;1&quot;&gt;é»˜è®¤åˆ†ç±»&lt;/option&gt; &lt;volist name=&quot;categoryList&quot; id=&quot;vo&quot;&gt; &lt;option value=&quot;&#123;$vo.cate_id&#125;&quot;&gt;&#123;$vo.cate_name&#125;&lt;/option&gt; &lt;/volist&gt; &lt;/select&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-3 control-label no-padding-right&quot; for=&quot;form-field-1&quot;&gt; æ‘˜è¦ &lt;/label&gt; &lt;div class=&quot;col-sm-9&quot;&gt; &lt;textarea class=&quot;form-control&quot; name=&quot;art_summary&quot; placeholder=&quot;æ‘˜è¦&quot;&gt;&lt;/textarea&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-3 control-label no-padding-right&quot; for=&quot;form-field-1&quot;&gt; ç¼©ç•¥å›¾ &lt;/label&gt; &lt;div class=&quot;col-sm-9&quot;&gt; &lt;input class=&quot;preview&quot; type=&quot;file&quot; name=&quot;art_thumb&quot; value=&quot;&quot;/&gt; &lt;img class=&quot;&quot; /&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-3 control-label no-padding-right&quot; for=&quot;form-field-1&quot;&gt; ç›¸å…³é™„ä»¶ &lt;/label&gt; &lt;div class=&quot;col-sm-9&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;art_upload_file&quot; value=&quot;&quot;/&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-3 control-label no-padding-right&quot; for=&quot;form-field-1&quot;&gt; å†…å®¹ &lt;/label&gt; &lt;div class=&quot;col-sm-9&quot;&gt; &lt;script type=&quot;text/plain&quot; id=&quot;art_content&quot; name=&quot;art_content&quot; style=&quot;width:90%;height:240px;&quot;&gt;&lt;/script&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-3 control-label no-padding-right&quot; for=&quot;form-field-1&quot;&gt; æ’åº &lt;/label&gt; &lt;div class=&quot;col-sm-9&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;art_order&quot; value=&quot;0&quot; placeholder=&quot;æ’åº&quot; class=&quot;col-xs-10 col-sm-5 validate[required,custom[integer]]&quot; /&gt; &lt;span class=&quot;help-inline col-xs-12 col-sm-7&quot;&gt; &lt;span class=&quot;middle&quot;&gt;é»˜è®¤ä¸º0ï¼Œæ•°å€¼è¶Šå¤§è¶Šé å‰&lt;/span&gt; &lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-3 control-label no-padding-right&quot; for=&quot;form-field-1&quot;&gt; ç‚¹å‡»æ¬¡æ•° &lt;/label&gt; &lt;div class=&quot;col-sm-9&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;art_view_number&quot; value=&quot;0&quot; placeholder=&quot;ç‚¹å‡»æ¬¡æ•°&quot; class=&quot;col-xs-10 col-sm-5 validate[required,custom[integer]]&quot; /&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label class=&quot;col-sm-3 control-label no-padding-right&quot; for=&quot;form-field-1&quot;&gt; å‘å¸ƒæ—¶é—´ &lt;/label&gt; &lt;div class=&quot;col-sm-9&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;art_post_time&quot; value=&quot;&lt;?php echo date(&#x27;Y-m-d H:i:s&#x27;,time());?&gt;&quot; onClick=&quot;WdatePicker(&#123;dateFmt:&#x27;yyyy-MM-dd HH:mm:ss&#x27;&#125;)&quot;/&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;clearfix form-actions&quot;&gt; &lt;div class=&quot;col-md-offset-3 col-md-9&quot;&gt; &lt;button class=&quot;btn btn-info&quot; id=&quot;confirm&quot; type=&quot;button&quot;&gt; &lt;i class=&quot;icon-ok bigger-110&quot;&gt;&lt;/i&gt; æäº¤ &lt;/button&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;a class=&quot;btn&quot; id=&quot;backid&quot;&gt; &lt;i class=&quot;icon-undo bigger-110&quot;&gt;&lt;/i&gt; è¿”å›åˆ—è¡¨ &lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/form&gt; &lt;!-- é…ç½®æ–‡ä»¶ --&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;/webui/ueditor/ueditor.config.js&quot;&gt;&lt;/script&gt; &lt;!-- ç¼–è¾‘å™¨æºç æ–‡ä»¶ --&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;/webui/ueditor/ueditor.all.js&quot;&gt;&lt;/script&gt; &lt;script&gt; $(function () &#123; var ue = UE.getEditor(&#x27;art_content&#x27;, &#123;&#125;); /*è¿”å›åˆ—è¡¨*/ $(&quot;#backid&quot;).on(&#x27;click&#x27;,function()&#123; window.location.href=&quot;&#123;:U(&#x27;artList&#x27;,array(&#x27;column_id&#x27;=&gt;$artColumn))&#125;&quot;; &#125;); $(&#x27;#confirm&#x27;).on(&#x27;click&#x27;,function()&#123; if(!$(&#x27;#artCreateForm&#x27;).validationEngine(&#x27;validate&#x27;)) return false; var $This = $(this); $This.attr(&#x27;disabled&#x27;,&#x27;disabled&#x27;); var formData = new FormData($(&quot;#artCreateForm&quot;)[0]); var iUrl = &#x27;&#123;:U(&#x27;artCreate&#x27;)&#125;&#x27;; $.ajax(&#123; url: iUrl, type: &#x27;POST&#x27;, data: formData, dataType: &#x27;JSON&#x27;, cache: false, processData: false, contentType: false &#125;).done(function(ret)&#123; if(ret.code)&#123; sysTips(ret.info,1,function()&#123; location.href=&quot;&#123;:U(&#x27;artList&#x27;,array(&#x27;column_id&#x27;=&gt;$artColumn))&#125;&quot;; &#125;); &#125;else&#123; sysTips(ret.info,2); &#125; &#125;); $This.removeAttr(&#x27;disabled&#x27;); &#125;); &#125;); &lt;/script&gt;","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"html","slug":"html","permalink":"https://github.13sai.com/tags/html/"}]},{"title":"æ•°æ®åº“è®¾è®¡çš„èŒƒå¼ä¸åèŒƒå¼","slug":"æ•°æ®åº“è®¾è®¡çš„èŒƒå¼ä¸åèŒƒå¼","date":"2017-05-02T14:50:44.000Z","updated":"2022-03-19T14:35:21.923Z","comments":true,"path":"2017/05/02/120/","link":"","permalink":"https://github.13sai.com/2017/05/02/120/","excerpt":"","text":"ä¹‹å‰æœ‰äº›è¿‡å…³äºæ•°æ®åº“è®¾è®¡èŒƒå¼çš„æ€»ç»“æ–‡ç« ï¼Œå…¶å®å¾ˆå¤šæ—¶å€™ï¼Œå®é™…æ“ä½œæ—¶å¹¶éå®Œå…¨éµå¾ªèŒƒå¼å»è®¾è®¡æ•°æ®åº“ã€‚é€šå¸¸åœ¨è®¾è®¡æ•°æ®åº“æ—¶éœ€è¦éµå¾ªä»¥ä¸‹åŸåˆ™ï¼šæ ¸å¿ƒä¸šåŠ¡ä½¿ç”¨èŒƒå¼ã€‚åœ¨ç±»ä¼¼äº¤æ˜“æœ‰å…³çš„è¿™ç§æ•æ„Ÿå’Œæ ¸å¿ƒä¸šåŠ¡ä¸­ï¼Œå¼ºè°ƒæ•°æ®å®‰å…¨å’Œä¸€è‡´æ€§ï¼Œéœ€è¦éµå¾ªèŒƒå¼ä¿è¯æœºå¯†æ•°æ®ä¸è¢«ç ´åï¼Œæ ¸å¿ƒä¸šåŠ¡ä¸å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µã€‚ä»€ä¹ˆæ ·çš„ä¸šåŠ¡æ‰èƒ½å«æ ¸å¿ƒä¸šåŠ¡ï¼Œè¿™ä¸ªéœ€è¦æ ¹æ®å®é™…æƒ…å†µè€Œå®šã€‚å¼±ä¸€è‡´æ€§éœ€æ±‚------åACIDã€‚åœ¨å¯¹ä¸€äº›æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä¸é«˜çš„åœºåˆï¼Œä¸å¿…å®Œå…¨éµå¾ªACIDï¼Œå‡ºç°é€‚å½“çš„æ•°æ®ä¸ä¸€è‡´æ—¶å¯ä»¥å®¹å¿çš„ã€‚å¦‚åœ¨çº¿äººæ•°ç»Ÿè®¡ç­‰ã€‚æœ€è¿‘å‡ å¹´æµè¡Œçš„NoSQLæŠ€æœ¯ï¼Œå°±æ˜¯åŸºäºå¼±ä¸€è‡´æ€§éœ€æ±‚ï¼Œé™ä½æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§æ¢å–æ•ˆç‡çš„ã€‚ç©ºé—´æ¢æ—¶é—´ï¼Œå†—ä½™æ¢æ•ˆç‡ã€‚ç”±äºä¸€æ¡å¯è§è®°å½•è¢«æ‹†åˆ†åˆ°äº†å¤šä¸ªè¡¨ä¸­è¿›è¡Œè®°å½•ï¼Œå½“æ•°æ®é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œè”è¡¨æŸ¥è¯¢å°±å˜å¾—æ¯”è¾ƒè´¹æ—¶ï¼ŒSQLè¯­å¥ä¹Ÿå˜å¾—å¤æ‚ï¼Œéš¾äºä¼˜åŒ–ã€‚æ­¤æ—¶å°±éœ€è¦é€‚å½“çš„å†—ä½™äº†ã€‚å°±æ‹¿å‰ä¸ä¹…åšçš„è€ƒè¯•ç³»ç»Ÿå¯¼å‡ºå­¦ç”Ÿä¿¡æ¯ä¸ç­”é¢˜æ˜ç»†æ—¶ï¼Œä¸€å…±éœ€è¦è”æŸ¥6ä¸ªè¡¨ï¼Œè¿™æ˜¯éå¸¸è€—æ—¶çš„ã€‚æˆ‘ä»¬åé¢è¯•ç€åœ¨è€ƒå®Œè¯•ä¹‹åï¼ŒæŠŠè¿™äº›éœ€è¦å¯¼å‡ºçš„ä¿¡æ¯ç»Ÿä¸€æ”¾è¿›ä¸€å¼ æ–°è¡¨ï¼Œå¯¼å‡ºæ—¶çš„æŸ¥è¯¢æ•ˆç‡å¤§å¤§æå‡ã€‚é¿å…ä¸å¿…è¦çš„å†—ä½™ã€‚èŒƒå¼ç†è®ºä¸æ˜¯æƒ³åå°±èƒ½åçš„ï¼ŒåèŒƒå¼ä¸æ˜¯è¯´ä¸è¦èŒƒå¼ï¼Œè€Œæ˜¯åœ¨å¿…è¦çš„æ—¶å€™åˆ›å»ºå†—ä½™è¡¨æˆ–æ€»ç»“è¡¨ã€‚ä¸å¿…è¦çš„å†—ä½™ä»ç„¶æ˜¯è¦é¿å…çš„ã€‚æ‰€æœ‰çš„åŸåˆ™éƒ½æ˜¯æœ‰ä½¿ç”¨åœºæ™¯çš„ï¼Œæˆ‘ä»¬ä¸åº”è¯¥å›ºå®ˆè§„åˆ™ï¼Œåœ¨æŸäº›æƒ…å†µï¼Œè¦æ‡‚å¾—å˜é€šã€‚å°±å¦‚åšäººä¸€æ ·ï¼Œä¸èƒ½å¢¨å®ˆæˆè§„ï¼Œè¦å­¦ä¼šå˜é€šã€‚","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]},{"title":"wampä¸€ç›´æ©™è‰²ï¼Œè€Œ80ç«¯å£åˆæœªè¢«å ç”¨","slug":"wampä¸€ç›´æ©™è‰²ï¼Œè€Œ80ç«¯å£åˆæœªè¢«å ç”¨","date":"2017-04-13T15:12:53.000Z","updated":"2022-03-19T14:35:21.822Z","comments":true,"path":"2017/04/13/119/","link":"","permalink":"https://github.13sai.com/2017/04/13/119/","excerpt":"","text":"å› ä¸ºå‰å‡ å¤©æŠŠç”µè„‘ç³»ç»Ÿç©å´©äº†ï¼Œåˆå¾—é‡è£…wampï¼Œè¿™æ¬¡å‘ç°wampå®‰è£…åä¸€ç›´æ˜¯æ©™è‰²ï¼Œapacheä¸€ç›´æ²¡æœ‰æ­£å¸¸å¯åŠ¨ã€‚ç»æµ‹è¯•ï¼Œ80ç«¯å£æœªè¢«å ç”¨ï¼Œç™¾åº¦å¾ˆå¤šè§£å†³æ–¹æ¡ˆï¼Œéƒ½æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œæœ€ååœ¨è±†ç“£çœ‹åˆ°ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚apache-&gt;services-&gt;å®‰è£…æœåŠ¡ï¼Œå®‰è£…æˆåŠŸåï¼Œé‡å¯ï¼Œä¹…è¿çš„ç»¿ã€‚åæ¥æƒ³äº†æƒ³ï¼Œåº”è¯¥è¿˜æ˜¯ç½‘ç»œè®¾ç½®é—®é¢˜ï¼Œå› ä¸ºå®‰è£…çš„æ—¶å€™è·³å‡ºå¯åŠ¨æœåŠ¡çš„æç¤ºã€‚æ€»ç®—æ˜¯è§£å†³äº†ï¼Œå¿ƒæƒ…èˆ’ç•…ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"wamp","slug":"wamp","permalink":"https://github.13sai.com/tags/wamp/"}]},{"title":"mouseover,mouseout,mouseenter,mouseleaveçš„åŒºåˆ«","slug":"mouseover,mouseout,mouseenter,mouseleaveçš„åŒºåˆ«","date":"2017-04-05T06:00:53.000Z","updated":"2022-03-19T14:35:21.767Z","comments":true,"path":"2017/04/05/117/","link":"","permalink":"https://github.13sai.com/2017/04/05/117/","excerpt":"","text":"mouseoverä¸mouseenter:ä¸è®ºé¼ æ ‡æŒ‡é’ˆç©¿è¿‡è¢«é€‰å…ƒç´ æˆ–å…¶å­å…ƒç´ ï¼Œéƒ½ä¼šè§¦å‘ mouseover äº‹ä»¶ã€‚ åªæœ‰åœ¨é¼ æ ‡æŒ‡é’ˆç©¿è¿‡è¢«é€‰å…ƒç´ æ—¶ï¼Œæ‰ä¼šè§¦å‘ mouseenter äº‹ä»¶ã€‚mouseoutä¸mouseleave:ä¸è®ºé¼ æ ‡æŒ‡é’ˆç¦»å¼€è¢«é€‰å…ƒç´ è¿˜æ˜¯ä»»ä½•å­å…ƒç´ ï¼Œéƒ½ä¼šè§¦å‘ mouseout äº‹ä»¶ã€‚ åªæœ‰åœ¨é¼ æ ‡æŒ‡é’ˆç¦»å¼€è¢«é€‰å…ƒç´ æ—¶ï¼Œæ‰ä¼šè§¦å‘ mouseleave äº‹ä»¶ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"windows7æ­å»ºPHPå¼€å‘ç¯å¢ƒ","slug":"windows7æ­å»ºPHPå¼€å‘ç¯å¢ƒ","date":"2017-03-09T13:38:29.000Z","updated":"2022-03-19T14:35:21.828Z","comments":true,"path":"2017/03/09/111/","link":"","permalink":"https://github.13sai.com/2017/03/09/111/","excerpt":"","text":"ä¸Šä¸ªæœˆç”µè„‘çªç„¶è¿ä¸ä¸Šæ— çº¿ç½‘äº†ï¼Œä¾¿åˆä¸€æ¬¡é‡è£…äº†ç³»ç»Ÿï¼Œæ°å¥½ä¹‹å‰ä¸»ç®¡ä»‹ç»è¿‡windowsæ­å»ºPHPç¯å¢ƒï¼Œä¾¿è€ƒè™‘æ“ä½œä¸€ä¸‹ã€‚ä¸»ç®¡çš„æ–‡æ¡£å¾ˆè¯¦å°½ï¼Œä½†å®‰è£…æ˜¯ç¡®å®é‡åˆ°äº†å…¶ä»–é—®é¢˜ï¼Œä¾¿è®°å½•ä¸‹ã€‚å®‰è£…PHPphp-5.3.29-nts-Win32-VC9-x86.zipè§£æåˆ°E:\\PHP\\PHP5.3.29ä¸‹ï¼Œå¹¶åˆ›å»ºtempå’Œsessionsä¸¤ä¸ªç›®å½•ï¼›&nbsp;ç»™æ–‡ä»¶å¤¹PHP5.2.29åŠ ä¸Šusersç»„çš„è¯»å†™æƒé™ï¼›å°†php_5.3.29.iniæ–‡ä»¶åæ”¹ä¸ºphp.iniå¹¶å¤åˆ¶åˆ°E:\\PHP\\PHP5.3.29ä¸‹ï¼›æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œå³å‡»è®¡ç®—æœºé€‰æ‹©å±æ€§---æ‰“å¼€ç³»ç»Ÿå±æ€§---é«˜çº§---ç¯å¢ƒå˜é‡---åœ¨ç³»ç»Ÿå˜é‡ä¸€æ ä¸­é€‰æ‹©Pathç‚¹å‡»ç¼–è¾‘ï¼ŒåŠ ä¸ŠE:\\PHP\\PHP5.3.29ï¼Œæ³¨æ„æœ‰åˆ†å·ï¼›è€Œååœ¨ç‚¹å‡»æ–°å»ºï¼Œå˜é‡åå¡«å†™PHPRCï¼Œå˜é‡å€¼æ·»åŠ E:\\PHP\\PHP5.3.29å®‰è£…ä¸‹vcredist_x86.exeï¼›ï¼ˆè¿™æ­¥éª¤ä¸€å®šä¸èƒ½çœï¼Œè£…çš„æ˜¯window7æ——èˆ°ç‰ˆï¼Œä¸çŸ¥é“ä¸ºå•¥å®‰è£…ä¸ª*86çš„ï¼‰WIN+Ræ‰“å¼€è¿è¡Œçª—å£ï¼Œè¾“cmdæ‰“å¼€æ‰¹å¤„ç†çª—å£ï¼Œè¾“å…¥php -v&nbsp;å¦‚æœèƒ½æ˜¾ç¤ºç‰ˆæœ¬å·è¯´æ˜ç¯å¢ƒé…ç½®æˆåŠŸã€‚è¿™é‡Œæ·»åŠ æƒé™ä¸é…ç½®ç¯å¢ƒå˜é‡å°±ä¸è¯¦ç»†è¯´æ˜äº†ï¼Œç™¾åº¦ä¸€ä¸‹ä½ å°±çŸ¥é“ã€‚2.é…ç½®IISwindows7æ——èˆ°ç‰ˆè‡ªå¸¦çš„æ˜¯IIS6.0ï¼Œè®°å¾—è¦æ‰“å¼€IISæœåŠ¡ï¼Œå¹¶å‹¾é€‰å¯¹åº”æœåŠ¡ï¼ˆå°¤å…¶æ³¨æ„ä¸‡ç»´ç½‘æœåŠ¡ä¸‹é¢åº”ç”¨ç¨‹åºå¼€å‘åŠŸèƒ½é‡Œçš„CGIåŠ¡å¿…æ‰“å¼€ï¼‰æ·»åŠ PHPæ˜ å°„ï¼Œæ‰“å¼€IISï¼Œæ‰“å¼€å¤„ç†ç¨‹åºæ˜ å°„ï¼›ç‚¹å‡»æ·»åŠ æ¨¡å—æ˜ å°„ï¼Œè¯·æ±‚è·¯å¾„â€è¾“å…¥*.phpï¼Œâ€œæ¨¡å—â€é€‰æ‹©FastCgiModuleï¼Œâ€œå¯æ‰§è¡Œæ–‡ä»¶â€é€‰æ‹©PHPå­˜æ”¾ç›®å½•ä¸‹çš„php-cgi.exeï¼Œæ³¨æ„ï¼Œé€‰æ‹©æ—¶éœ€è¦å°†ç­›é€‰åç¼€ç”±*.dllæ”¹ä¸º*.exeï¼Œâ€œåç§°â€å¤„è¾“å…¥ç›¸åº”çš„æ ‡ç¤ºã€‚3.å®‰è£…MYSQLæ ¹æ®ç³»ç»Ÿç‰ˆæœ¬é€‰æ‹©å¯¹åº”çš„å®‰è£…åŒ…ï¼Œå°†MYSQLå®‰è£…åŒ…è§£å‹åï¼Œå°†my.iniæ–‡ä»¶å¤åˆ¶åˆ°æ ¹ç›®å½•ä¸‹ï¼›è¾“å…¥cmdæ‰“å¼€çª—å£ï¼Œè¿›å…¥mysqlæ–‡ä»¶å¤¹ä¸‹çš„binç›®å½•ä¸‹ã€‚ä¾‹å¦‚æ¼”ç¤ºçš„æ˜¯è§£å‹åœ¨E:PHP\\mysql-5.6.17-winx64ï¼Œå°±å‚è€ƒå¦‚ä¸‹æ“ä½œï¼›è¾“å…¥mysqld.exe&nbsp;install MYSQL&nbsp;--defaults-file=&quot;D:\\mysql-5.6.17-winx64\\my.ini&quot;ï¼Œå›è½¦åä¼šæç¤ºæœ‰successçš„æç¤ºï¼›å®‰è£…æˆåŠŸåç›´æ¥ç”¨å‘½ä»¤å¯åŠ¨å³å¯ï¼Œè¿˜æ˜¯ä¹‹å‰çš„cmdçª—å£ï¼Œè¾“å…¥net start mysqlå¯åŠ¨æœåŠ¡æ­¤å¤„æˆ‘è¾“å…¥å‘½ä»¤æ—¶æç¤ºInstall/Remove of the Service Deniedï¼Œå¦‚æœä½ ä¹Ÿé‡åˆ°ï¼Œè¯·ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œcmdï¼Œç„¶åè¿è¡Œå‘½ä»¤ï¼Œå°±ä¼šçœ‹åˆ°successäº†ã€‚ä¸‰æ­¥æˆ‘ä»¬å°±æ­å»ºå¥½äº†PHPå¼€å‘ç¯å¢ƒï¼šIIS+MYSQL+PHPã€‚æ‰“å¼€æµè§ˆå™¨è¾“å…¥127.0.0.1ä½ å¯ä»¥çœ‹åˆ°What&#39;s wrong?æ‰“å¼€C:\\inetpub\\wwwroot,æ–°å»ºphpæ–‡ä»¶test.phpè¾“å…¥&lt;?php echo(&#39;Good&nbsp;job!&#39;); ?&gt;æµè§ˆå™¨è¾“å…¥127.0.0.0.1/test.phpï¼Œä½ å°±ä¼šçœ‹åˆ°å¹²å¾—ä¸é”™ï¼","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"windows","slug":"windows","permalink":"https://github.13sai.com/tags/windows/"}]},{"title":"phpå›¾ç‰‡ä¸ŠåŠ æ–‡å­—","slug":"phpå›¾ç‰‡ä¸ŠåŠ æ–‡å­—","date":"2017-03-07T01:16:56.000Z","updated":"2022-03-19T14:35:21.783Z","comments":true,"path":"2017/03/07/110/","link":"","permalink":"https://github.13sai.com/2017/03/07/110/","excerpt":"","text":"æœ€è¿‘éœ€è¦ä½¿ç”¨PHPåˆæˆè¯ä¹¦å›¾ç‰‡ï¼Œä¾¿äºç”¨æˆ·ä¿å­˜ï¼Œå°±è€ƒè™‘ä½¿ç”¨çš„phpçš„GDåº“ï¼Œåœ¨å›¾ç‰‡ä¸ŠåŠ æ–‡å­—ã€‚åŸç†æ¯”è¾ƒç®€å•ï¼Œè¯·çœ‹ä»£ç ï¼š&lt;?php //æŒ‡å®šå›¾ç‰‡è·¯å¾„ $src&nbsp;=&nbsp;&#39;time.jpg&#39;; //è·å–å›¾ç‰‡ä¿¡æ¯ $info&nbsp;=&nbsp;getimagesize($src); //è·å–å›¾ç‰‡æ‰©å±•å $type&nbsp;=&nbsp;image_type_to_extension($info[2],false); //åŠ¨æ€çš„æŠŠå›¾ç‰‡å¯¼å…¥å†…å­˜ä¸­$image&nbsp;=&nbsp;imagecreatefromjpeg($src); //æ–‡å­—é¢œè‰²$col2&nbsp;=&nbsp;imagecolorallocate($image,500,100,0); //æŒ‡å®šå­—ä½“å†…å®¹ä¸å­—ä½“$content&nbsp;=&nbsp;&quot;å°æ¸…æ–°&quot;;$font&nbsp;=&nbsp;&#39;C:\\Windows\\Fonts\\simfang.ttf&#39;; //ç»™å›¾ç‰‡æ·»åŠ æ–‡å­—imagefttext($image,24,0,80,180,$col2,$font,$content); //æŒ‡å®šè¾“å…¥ç±»å‹header(&quot;Content-type:&quot;.$info[&#39;mime&#39;]);imagejpeg($image);//ä¿å­˜å›¾ç‰‡&nbsp;&nbsp;imagejpeg($image,&#39;12.jpg&#39;);imagedestroy($image);?&gt;æ³¨æ„ï¼šä¸­æ–‡è¦ç”¨imagefttextï¼Œå¹¶æŒ‡å®šçš„å­—ä½“è¦æ”¯æŒä¸­æ–‡ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"å…³äºThinkPHPçš„å‡ ä¸ªè·¨æ¨¡å—æˆ–é¡¹ç›®çš„é—®é¢˜","slug":"å…³äºThinkPHPçš„å‡ ä¸ªè·¨æ¨¡å—æˆ–é¡¹ç›®çš„é—®é¢˜","date":"2017-03-02T08:32:50.000Z","updated":"2022-03-19T14:35:21.859Z","comments":true,"path":"2017/03/02/100/","link":"","permalink":"https://github.13sai.com/2017/03/02/100/","excerpt":"","text":"æœ€è¿‘åŒäº‹TPå¼€å‘æ—¶é‡åˆ°å¼•å…¥ä¸åŒé¡¹ç›®æ¨¡æ¿æ–‡ä»¶çš„é—®é¢˜ï¼ŒæŸ¥æ‰¾åå‘ç°å¯ä»¥è¿™ä¹ˆç”¨ï¼š &lt;include file=&quot;ä¸»é¢˜å@æ¨¡å—å:æ“ä½œå&quot; /&gt; demo: &lt;include file=&quot;Home@Index:index&quot; /&gt; ç„¶è€Œï¼Œéœ€è¦å¼•ç”¨Tplé‡Œé¢çš„å…¬å…±æ–‡ä»¶ï¼Œè¿™å°±é—¹è…¾äº†ï¼Œåé¢è„‘æ´å¤§å¼€ï¼Œå†™æˆäº†è¿™æ ·ã€‚ &lt;include file=&quot;Home@:header&quot; /&gt; ç›®å½•ç»“æ„å¦‚ä¸‹ï¼šAdmin/Index/indexå¼•å…¥Homeå…¬å…±Tplä¸‹çš„header æ­¤å¤–æƒ³åˆ°ä¸åŒæ¨¡å—æ‰æ–¹æ³•çš„æ–¹æ³•Aï¼Œä¹Ÿæ˜¯ååˆ†å¸¸è§çš„ã€‚ è¯­æ³•ï¼š A(&#x27;[é¡¹ç›®://][åˆ†ç»„/]æ¨¡å—&#x27;,&#x27;æ§åˆ¶å™¨å±‚åç§°&#x27;) ç”¨èµ·æ¥ä¹Ÿå¾ˆå¥½ã€‚ å°±æ˜¯è¿™äº›äº†ï¼Œè¿™å°±æ˜¯ä¸åŒé¡¹ç›®è°ƒç”¨æ¨¡æ¿ä¸è°ƒç”¨æ–¹æ³•çš„æ–¹æ³•ã€‚ æ³¨æ„ï¼šæˆ‘ç”¨çš„æ˜¯3.1ï¼Œå…¶ä»–ç‰ˆæœ¬å¯èƒ½ç•¥æœ‰ä¸åŒã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"ç§»åŠ¨ç«¯å®šä½","slug":"ç§»åŠ¨ç«¯å®šä½","date":"2017-02-16T07:29:18.000Z","updated":"2022-03-19T14:35:21.927Z","comments":true,"path":"2017/02/16/99/","link":"","permalink":"https://github.13sai.com/2017/02/16/99/","excerpt":"","text":"å»å¹´å¹´åº•ï¼Œæœ‰ä¸ªO2Oçš„é¡¹ç›®ï¼Œéœ€è¦æ‰‹æœºå®šä½ï¼Œä¹‹å‰å®šä½éƒ½æ˜¯æ ¹æ®ipå®šä½ï¼Œåªèƒ½ç²¾ç¡®åˆ°åœ°çº§å¸‚ï¼Œå¯å®¢æˆ·æ€ä¹ˆç€ä¹Ÿè¦å®šä½åˆ°åŒºå¿ä¸€çº§ï¼Œä¸å¾—ä¸åšä¸€äº›æ”¹è¿›ã€‚å½“æ—¶æ­£å¥½æœ‰å¦ä¸€ä¸ªç½‘ç«™ï¼Œç”¨åˆ°äº†æ‰‹æœºå®šä½ï¼Œè€Œä¸”ç»åº¦ä¸é”™ï¼Œcopyäº†ä»£ç ï¼Œå¤Ÿæ­¤é¡¹ç›®ä½¿ç”¨äº†ã€‚åé¢ææŠ€æœ¯åˆ†äº«çš„æ—¶å€™å°±è€ƒè™‘è¯´ä¸‹è¿™ä¸ªé—®é¢˜ï¼Œä¾¿æ•´ç†äº†ä¸‹ã€‚æ€è·¯ï¼šè·å–ç»çº¬åº¦ï¼Œè¿›è¡Œé€†å‘åœ°å€è§£æã€‚æ–¹æ³•ï¼šå¾®ä¿¡jssdkã€‚ï¼ˆåªèƒ½ç”¨äºå¾®ä¿¡ï¼‰ä½¿ç”¨æµè§ˆå™¨geolocationè·å–ç»çº¬åº¦ï¼Œç™¾åº¦apié€†åœ°å€è§£æã€‚ï¼ˆioså¯¹geolocationå¹¶ä¸å‹å¥½ï¼‰è…¾è®¯åœ°å›¾æä¾›çš„å‰ç«¯å®šä½apiã€‚baidumap &lt;html&gt;&lt;head&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;name=&quot;viewport&quot;&nbsp;content=&quot;initial-scale=1.0,&nbsp;user-scalable=no&quot;&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&nbsp;type=&quot;text/css&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body,&nbsp;html{width:&nbsp;100%;height:&nbsp;100%;margin:0;font-family:&quot;å¾®è½¯é›…é»‘&quot;;font-size:14px;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#allmap&nbsp;{width:100%;height:500px;}&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;src=&quot;http://api.map.baidu.com/api?v=2.0&amp;ak=NAmyvPsMlhSHds2GfAGEvAB76blt1G4j&quot;&gt;&lt;/script&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;ç™¾åº¦åœ°å›¾â€“é€†åœ°å€è§£æ&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;id=&quot;demo&quot;&gt;&lt;/div&gt;&lt;div&nbsp;id=&quot;detail&quot;&gt;&lt;/div&gt;&lt;button&nbsp;onclick=&quot;getLocation()&quot;&gt;ç‚¹å‡»å®šä½&lt;/button&gt;æ³¨æ„ï¼šios10ä»¥ä¸Šæš‚ä¸æ”¯æŒgeolocation&lt;div&nbsp;id=&quot;allmap&quot;&gt;&lt;/div&gt;&lt;script&gt;var&nbsp;x=document.getElementById(&quot;demo&quot;);var&nbsp;d=document.getElementById(&quot;detail&quot;);function&nbsp;getLocation(){&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(navigator.geolocation){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;navigator.geolocation.getCurrentPosition(showPosition);&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.innerHTML=&quot;Geolocation&nbsp;is&nbsp;not&nbsp;supported&nbsp;by&nbsp;this&nbsp;browser.&quot;;&nbsp;&nbsp;&nbsp;&nbsp;}}function&nbsp;showPosition(pos){&nbsp;&nbsp;x.innerHTML=&quot;Latitude:&nbsp;&quot;&nbsp;+&nbsp;pos.coords.latitude&nbsp;+&nbsp;&nbsp;&nbsp;&quot;&lt;br&nbsp;/&gt;Longitude:&nbsp;&quot;&nbsp;+&nbsp;pos.coords.longitude;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ç™¾åº¦åœ°å›¾APIåŠŸèƒ½&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;map&nbsp;=&nbsp;new&nbsp;BMap.Map(&quot;allmap&quot;);&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;point&nbsp;=&nbsp;new&nbsp;BMap.Point(pos.coords.longitude,pos.coords.latitude);&nbsp;&nbsp;&nbsp;&nbsp;map.centerAndZoom(point,10);&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;geoc&nbsp;=&nbsp;new&nbsp;BMap.Geocoder();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geoc.getLocation(point,&nbsp;function(rs){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;addComp&nbsp;=&nbsp;rs.addressComponents;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.innerHTML&nbsp;=&nbsp;addComp.province&nbsp;+&nbsp;&quot;,&nbsp;&quot;&nbsp;+&nbsp;addComp.city&nbsp;+&nbsp;&quot;,&nbsp;&quot;&nbsp;+&nbsp;addComp.district&nbsp;+&nbsp;&quot;,&nbsp;&quot;&nbsp;+&nbsp;addComp.street&nbsp;+&nbsp;&quot;,&nbsp;&quot;&nbsp;+&nbsp;addComp.streetNumber;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map.addEventListener(&quot;touchend&quot;,&nbsp;function(e){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;pt&nbsp;=&nbsp;e.point;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geoc.getLocation(pt,&nbsp;function(rs){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;addComp&nbsp;=&nbsp;rs.addressComponents;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d.innerHTML&nbsp;=&nbsp;addComp.province&nbsp;+&nbsp;&quot;,&nbsp;&quot;&nbsp;+&nbsp;addComp.city&nbsp;+&nbsp;&quot;,&nbsp;&quot;&nbsp;+&nbsp;addComp.district&nbsp;+&nbsp;&quot;,&nbsp;&quot;&nbsp;+&nbsp;addComp.street&nbsp;+&nbsp;&quot;,&nbsp;&quot;&nbsp;+&nbsp;addComp.streetNumber;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});}&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;qqmap &lt;!DOCTYPE&nbsp;html&gt;&lt;html&gt;&nbsp;&lt;head&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=UTF-8&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;å‰ç«¯å®šä½æ¨¡å—â€“è…¾è®¯åœ°å›¾&lt;/title&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;name=&quot;viewport&quot;&nbsp;content=&quot;width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin:&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border:&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position:&nbsp;absolute;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;100%;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height:&nbsp;100%;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;center;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pos-area&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;background-color:&nbsp;#009DDC;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-top:&nbsp;10px;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;100%;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflow:&nbsp;scroll;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:&nbsp;white;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#demo&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;8px;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:&nbsp;small;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#btn-area&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height:&nbsp;100px;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:&nbsp;10px;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding:&nbsp;12px&nbsp;8px;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;42%;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;border-radius:&nbsp;8px;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;background-color:&nbsp;#009DDC;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:&nbsp;white;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;src=&quot;https://3gimg.qq.com/lightmap/components/geolocation/geolocation.min.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;btn-area&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;onclick=&quot;geolocation.getLocation(showPosition,&nbsp;showErr,&nbsp;options)&quot;&gt;è·å–ç²¾ç¡®å®šä½ä¿¡æ¯&lt;/button&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;onclick=&quot;geolocation.getIpLocation(showPosition,&nbsp;showErr)&quot;&gt;è·å–ç²—ç³™å®šä½ä¿¡æ¯&lt;/button&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;onclick=&quot;showWatchPosition()&quot;&gt;å¼€å§‹ç›‘å¬ä½ç½®&lt;/button&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;onclick=&quot;showClearWatch()&quot;&gt;åœæ­¢ç›‘å¬ä½ç½®&lt;/button&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;pos-area&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;id=&quot;demo&quot;&gt;ç‚¹å‡»ä¸Šé¢çš„æŒ‰é’®ï¼Œè·å¾—å¯¹åº”ä¿¡æ¯ï¼š&lt;br&nbsp;/&gt;&lt;/p&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;script&nbsp;type=&quot;text/JavaScript&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;geolocation&nbsp;=&nbsp;new&nbsp;qq.maps.Geolocation(&quot;OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77&quot;,&nbsp;&quot;myapp&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;pos-area&quot;).style.height&nbsp;=&nbsp;(document.body.clientHeight&nbsp;-&nbsp;110)&nbsp;+&nbsp;&#39;px&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;positionNum&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;options&nbsp;=&nbsp;{timeout:&nbsp;8000};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;showPosition(position)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;positionNum&nbsp;++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;demo&quot;).innerHTML&nbsp;+=&nbsp;&quot;åºå·ï¼š&quot;&nbsp;+&nbsp;positionNum;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;demo&quot;).appendChild(document.createElement(&#39;pre&#39;)).innerHTML&nbsp;=&nbsp;JSON.stringify(position,&nbsp;null,&nbsp;4);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;pos-area&quot;).scrollTop&nbsp;=&nbsp;document.getElementById(&quot;pos-area&quot;).scrollHeight;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;showErr()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;positionNum&nbsp;++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;demo&quot;).innerHTML&nbsp;+=&nbsp;&quot;åºå·ï¼š&quot;&nbsp;+&nbsp;positionNum;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;demo&quot;).appendChild(document.createElement(&#39;p&#39;)).innerHTML&nbsp;=&nbsp;&quot;å®šä½å¤±è´¥ï¼&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;pos-area&quot;).scrollTop&nbsp;=&nbsp;document.getElementById(&quot;pos-area&quot;).scrollHeight;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;showWatchPosition()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;demo&quot;).innerHTML&nbsp;+=&nbsp;&quot;å¼€å§‹ç›‘å¬ä½ç½®ï¼&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geolocation.watchPosition(showPosition);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;pos-area&quot;).scrollTop&nbsp;=&nbsp;document.getElementById(&quot;pos-area&quot;).scrollHeight;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;showClearWatch()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;geolocation.clearWatch();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;demo&quot;).innerHTML&nbsp;+=&nbsp;&quot;åœæ­¢ç›‘å¬ä½ç½®ï¼&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.getElementById(&quot;pos-area&quot;).scrollTop&nbsp;=&nbsp;document.getElementById(&quot;pos-area&quot;).scrollHeight;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;æ›´å¤šè¯·å‚è€ƒï¼šgeolocationï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/API/Geolocation/Using_geolocationhttp://www.w3school.com.cn/html5/html_5_geolocation.aspç™¾åº¦åœ°å›¾apiï¼šhttp://developer.baidu.com/map/jsdemo.htm#i7_2è…¾è®¯åœ°å›¾apiï¼šhttp://lbs.qq.com/tool/component-geolocation.html","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"pythonçˆ¬è™«","slug":"pythonçˆ¬è™«","date":"2017-01-14T01:59:32.000Z","updated":"2022-05-25T12:17:52.770Z","comments":true,"path":"2017/01/14/98/","link":"","permalink":"https://github.13sai.com/2017/01/14/98/","excerpt":"","text":"æœ€è¿‘åœ¨ç©Pythonï¼Œè‡ªå·±å¹³æ—¶å–œæ¬¢å’ŒåŒäº‹çœ‹ç”µå½±ï¼Œå°±å¯»æ€å†™äº†ä¸ªçˆ¬è™«æ¥å®šæ—¶çˆ¬å–ä¼˜æƒ ç”µå½±ã€‚ # author: 13sai # code: utf-8 from urllib.request import urlopen from bs4 import BeautifulSoup import re import datetime now = datetime.datetime.now() week = now.weekday() if week &lt; 5: week = 4 - week else: week = 12 - week delta = datetime.timedelta(days=week) n_days = now + delta nowtime = n_days.strftime(&#x27;%Y-%m-%d&#x27;) # æ¯å‘¨äº” jiage = int(30) #ä»·æ ¼ url_gwl = urlopen(&quot;http://www.gewara.com/cinema/ajax/getOpiItemPage.xhtml?cid=cinemaid&amp;mid=&amp;fyrq=&quot;+nowtime).read().decode(&quot;utf-8&quot;) soupurl_gwl = BeautifulSoup(url_gwl,&quot;html.parser&quot;) ids_gwl = soupurl_gwl.findAll(&quot;a&quot;,attrs =&#123;&quot;href&quot;:&quot;javascript:void(0);&quot;&#125;) str = &#x27;&#x27; str1 = &#x27;&#x27; str2 = &#x27;&#x27; for idattr_gwl in ids_gwl: res_gwl = urlopen(&quot;http://www.gewara.com/movie/ajax/getOpiItemNew.xhtml?movieid=&quot;+idattr_gwl[&#x27;id&#x27;]+&quot;&amp;fyrq=&quot;+nowtime+&quot;&amp;cid=cinemaid&quot;).read().decode(&quot;utf-8&quot;) soup_gwl = BeautifulSoup(res_gwl,&quot;html.parser&quot;) # print(soup) links_gwl = soup_gwl.findAll(&quot;span&quot;,attrs =&#123;&quot;class&quot;:&quot;opiPrice&quot;&#125;) arrtime_gwl = soup_gwl.findAll(&quot;span&quot;,attrs =&#123;&quot;class&quot;:&quot;opitime&quot;&#125;) for i in range(0,len(links_gwl)): if links_gwl[i].find(&quot;b&quot;) != None: if int(links_gwl[i].find(&quot;b&quot;).get_text()) &lt; jiage: str1 = str1+&quot;&lt;p&gt;&quot;+arrtime_gwl[i].get_text()+&quot;ç¥¨ä»·ï¼š&quot;+links_gwl[i].find(&quot;b&quot;).get_text()+idattr_gwl.find(&#x27;img&#x27;)[&#x27;alt&#x27;]+&quot;&lt;a href=&#x27;http://www.gewara.com/movie/ajax/getOpiItemNew.xhtml?movieid=&quot;+idattr_gwl[&#x27;id&#x27;]+&quot;&amp;fyrq=&quot;+nowtime+&quot;&amp;cid=cinemaid&#x27;&gt;ç‚¹å‡»æŸ¥çœ‹&lt;/a&gt;&lt;/p&gt;&quot; url_tb = urlopen(&quot;http://dianying.taobao.com/showList.htm?spm=a1z21.3046609.w2.3.9ilG5t&amp;n_s=new&quot;).read().decode(&quot;utf-8&quot;) soupurl_tb = BeautifulSoup(url_tb,&quot;html.parser&quot;) ids_tb = soupurl_tb.findAll(&quot;a&quot;,attrs =&#123;&quot;class&quot;:&quot;movie-card&quot;&#125;) for idattr_tb in ids_tb: pattern = re.compile(r&quot;showId=(\\d+)&quot;) id_group_tb = pattern.search(idattr_tb[&#x27;href&#x27;]) if id: res_tb = urlopen(&quot;http://dianying.taobao.com/cinemaDetailSchedule.htm?cinemaId=cinemaid&amp;activityId=&amp;fCode=&amp;showId=&quot;+id_group_tb.group(1)+&quot;&amp;showDate=&quot;+nowtime).read().decode(&quot;utf-8&quot;) soup_tb = BeautifulSoup(res_tb,&quot;html.parser&quot;) # print(soup) links_tb = soup_tb.findAll(&quot;td&quot;,attrs =&#123;&quot;class&quot;:&quot;hall-price&quot;&#125;) arrtime_tb = soup_tb.findAll(&quot;td&quot;,attrs =&#123;&quot;class&quot;:&quot;hall-time&quot;&#125;) for i in range(0,len(links_tb)): if links_tb[i].find(&quot;em&quot;) != None: if float(links_tb[i].find(&quot;em&quot;).get_text()) &lt; jiage: name_tb = idattr_tb.find(&#x27;span&#x27;,attrs=&#123;&quot;class&quot;:&quot;bt-l&quot;&#125;) str2 = str2+&quot;&lt;p&gt;&quot;+arrtime_tb[i].get_text()+&quot;ç¥¨ä»·ï¼š&quot;+links_tb[i].find(&quot;em&quot;).get_text()+name_tb.get_text()+&quot;&lt;a href=&#x27;http://dianying.taobao.com/cinemaDetailSchedule.htm?cinemaId=cinemaid&amp;activityId=&amp;fCode=&amp;showId=&quot;+id_group_tb.group(1)+&quot;&amp;showDate=&quot;+nowtime+&quot;&#x27;&gt;ç‚¹å‡»æŸ¥çœ‹&lt;/a&gt;&lt;/p&gt;&quot; str1 = str1.strip() str2 = str2.strip() if str1 != &#x27;&#x27; or str2 != &#x27;&#x27;: from email import encoders from email.header import Header from email.mime.text import MIMEText from email.utils import parseaddr, formataddr import smtplib # ç¬¬ä¸‰æ–¹ SMTP æœåŠ¡ mail_host=&quot;smtp.qq.com&quot; #è®¾ç½®æœåŠ¡å™¨ mail_user=&quot;@&quot; #ç”¨æˆ·å mail_pass=&quot;@&quot; #å£ä»¤,QQé‚®ç®±æ˜¯è¾“å…¥æˆæƒç  sender = &#x27;@&#x27; receivers = [&#x27;@&#x27;] # æ¥æ”¶é‚®ä»¶ï¼Œå¯è®¾ç½®ä¸ºä½ çš„QQé‚®ç®±æˆ–è€…å…¶ä»–é‚®ç®± if str1 != &#x27;&#x27;: str = &quot;æ ¼ç“¦æ‹‰ï¼š&lt;br/&gt;&quot;+str1+&quot;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&quot; if str2 != &#x27;&#x27;: str = str+&quot;æ·˜ç¥¨ç¥¨ï¼š&lt;br/&gt;&quot;+str2+&quot;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&quot; message = MIMEText(str, &#x27;html&#x27;, &#x27;utf-8&#x27;) message[&#x27;From&#x27;] = Header(&quot;@&quot;, &#x27;utf-8&#x27;) message[&#x27;To&#x27;] = Header(&quot;@&quot;, &#x27;utf-8&#x27;) subject = &#x27;ä¼˜æƒ ç”µå½±&#x27; message[&#x27;Subject&#x27;] = Header(subject, &#x27;utf-8&#x27;) try: smtpObj = smtplib.SMTP_SSL(mail_host, 465) smtpObj.login(mail_user,mail_pass) smtpObj.sendmail(sender, receivers, message.as_string()) smtpObj.quit() print(&quot;é‚®ä»¶å‘é€æˆåŠŸ&quot;) except smtplib.SMTPException: print(smtplib.SMTPException) else: print(&quot;æš‚æ— ä¼˜æƒ ç”µå½±&quot;)","categories":[{"name":"python","slug":"python","permalink":"https://github.13sai.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"https://github.13sai.com/tags/python/"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"https://github.13sai.com/tags/%E7%88%AC%E8%99%AB/"}]},{"title":"javascriptå‡½æ•°è®¾ç½®é»˜è®¤å‚æ•°","slug":"javascriptå‡½æ•°è®¾ç½®é»˜è®¤å‚æ•°","date":"2017-01-12T11:10:24.000Z","updated":"2022-03-19T14:35:21.723Z","comments":true,"path":"2017/01/12/97/","link":"","permalink":"https://github.13sai.com/2017/01/12/97/","excerpt":"","text":"PHPå‡½æ•°ä¸­ï¼Œå¯ä»¥ç›´æ¥åœ¨å‚æ•°åé¢åŠ =ï¼Œè®¾ç½®é»˜è®¤å€¼ï¼Œå¦‚ï¼šfunction&nbsp;sum($a,$b,$c=0){ &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;a&nbsp;+&nbsp;b&nbsp;+&nbsp;c; }ä¾‹ï¼šecho&nbsp;sum(1,2)ï¼›&nbsp;//è¾“å‡º3å‡å¦‚ä½ è®¤ä¸ºjavascriptä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼Œä½ å°±å¤§é”™ç‰¹é”™äº†ã€‚åœ¨javascriptä¸­å¦‚ä½•ä¸ºå‡½æ•°è®¾ç½®é»˜è®¤å‚æ•°å€¼ï¼Œä¸‹é¢æä¾›å‡ ç§æ–¹æ³•ä¾›å¤§å®¶å‚è€ƒã€‚ ç¬¬ä¸€ç§æ–¹æ³•ï¼šfunction&nbsp;example(a,b){&nbsp; &nbsp;&nbsp;var&nbsp;a&nbsp;=&nbsp;arguments[0]&nbsp;?&nbsp;arguments[0]&nbsp;:&nbsp;1;//è®¾ç½®å‚æ•°açš„é»˜è®¤å€¼ä¸º1&nbsp; &nbsp;&nbsp;var&nbsp;b&nbsp;=&nbsp;arguments[1]&nbsp;?&nbsp;arguments[1]&nbsp;:&nbsp;2;//è®¾ç½®å‚æ•°bçš„é»˜è®¤å€¼ä¸º2&nbsp; &nbsp;&nbsp;return&nbsp;a+b;&nbsp; }æ³¨æ„ä»¥ä¸Šå‡½æ•°ä¹Ÿå¯å†™ä½œå¦‚ä¸‹ï¼šfunction&nbsp;example(){&nbsp; &nbsp;&nbsp;var&nbsp;a&nbsp;=&nbsp;arguments[0]&nbsp;?&nbsp;arguments[0]&nbsp;:&nbsp;1;//è®¾ç½®ç¬¬ä¸€ä¸ªå‚æ•°çš„é»˜è®¤å€¼ä¸º1&nbsp; &nbsp;&nbsp;var&nbsp;b&nbsp;=&nbsp;arguments[1]&nbsp;?&nbsp;arguments[1]&nbsp;:&nbsp;2;//è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°çš„é»˜è®¤å€¼ä¸º2&nbsp; &nbsp;&nbsp;return&nbsp;a+b;&nbsp; }ä¾‹ï¼šalert(&nbsp;example()&nbsp;);&nbsp;//è¾“å‡º3&nbsp;alert(&nbsp;example(10)&nbsp;);&nbsp;//è¾“å‡º12&nbsp;alert(&nbsp;example(10,20)&nbsp;);&nbsp;//è¾“å‡º30&nbsp;alert(&nbsp;example(null,20)&nbsp;);&nbsp;//è¾“å‡º20ç¬¬äºŒç§æ–¹æ³•ï¼šfunction&nbsp;example(name,age){&nbsp; &nbsp;&nbsp;name=name||&#39;è²‚è‰&#39;;&nbsp; &nbsp;&nbsp;age=age||21;&nbsp; &nbsp;&nbsp;alert(&#39;ä½ å¥½ï¼æˆ‘æ˜¯&#39;+name+&#39;ï¼Œä»Šå¹´&#39;+age+&#39;å²ã€‚&#39;);&nbsp; }è¯¥å‡½æ•°ä¹Ÿå¯ä»¥å†™ä½œå¦‚ä¸‹ï¼šfunction&nbsp;example(name,age){&nbsp; &nbsp;&nbsp;if(!name){name=&#39;è²‚è‰&#39;;}&nbsp; &nbsp;&nbsp;if(!age){age=21;}&nbsp; &nbsp;&nbsp;alert(&#39;ä½ å¥½ï¼æˆ‘æ˜¯&#39;+name+&#39;ï¼Œä»Šå¹´&#39;+age+&#39;å²ã€‚&#39;);&nbsp; }ä¾‹ï¼šexample(&#39;æ¨èƒ–å­&#39;);//è¾“å‡ºï¼šä½ å¥½ï¼æˆ‘æ˜¯æ¨èƒ–å­ï¼Œä»Šå¹´21å²ã€‚&nbsp;&nbsp;example(&#39;è¥¿æ–½&#39;,305);//è¾“å‡ºï¼šä½ å¥½ï¼æˆ‘æ˜¯è¥¿æ–½ï¼Œä»Šå¹´305å²ã€‚&nbsp;&nbsp;example(null,10);//è¾“å‡ºï¼šä½ å¥½ï¼æˆ‘æ˜¯è²‚è‰ï¼Œä»Šå¹´10å²ã€‚ç¬¬ä¸‰ç§æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•é€‚åˆç”¨äºå‚æ•°è¾ƒå¤šçš„æƒ…å†µï¼ŒJqueryæ’ä»¶ä¸­å¾ˆå¸¸è§ï¼šfunction&nbsp;example(setting){&nbsp; &nbsp;&nbsp;var&nbsp;defaultSetting={&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;name:&#39;å°æ˜&#39;,&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;age:&#39;16&#39;,&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;sex:&#39;ç”·&#39;,&nbsp; &nbsp;&nbsp;};&nbsp; &nbsp;&nbsp;$.extend(defaultSetting,settings);&nbsp; &nbsp;&nbsp;var&nbsp;message=&#39;å§“åï¼š&#39;+defaultSetting.name&nbsp; &nbsp;&nbsp;+&#39;ï¼Œå¹´é¾„ï¼š&#39;+defaultSetting.age&nbsp; &nbsp;&nbsp;+&#39;ï¼Œæ€§åˆ«ï¼š&#39;+defaultSetting.sex&nbsp; &nbsp;&nbsp;+&#39;ã€‚&#39;;&nbsp; &nbsp;&nbsp;alert(message);&nbsp; }ä¾‹ï¼šexample({&nbsp; &nbsp;&nbsp;name:&#39;å°çº¢&#39;,&nbsp; &nbsp;&nbsp;sex:&#39;å¥³&#39;});&nbsp; //è¾“å‡ºï¼šå§“åï¼šå°çº¢ï¼Œæ€§åˆ«ï¼šå¥³ï¼Œå¹´é¾„ï¼š16ã€‚ä¸‰ç§æ–¹æ³•éƒ½å¯ä»¥ï¼Œæœ€åä¸€ç§éœ€è¦å¼•ç”¨jqueryåº“ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"ThinkPHPä¸­orderä½¿ç”¨æ–¹æ³•","slug":"ThinkPHPä¸­orderä½¿ç”¨æ–¹æ³•","date":"2017-01-06T06:05:51.000Z","updated":"2022-03-19T14:35:21.645Z","comments":true,"path":"2017/01/06/96/","link":"","permalink":"https://github.13sai.com/2017/01/06/96/","excerpt":"","text":"orderæ–¹æ³•å±äºæ¨¡å‹çš„è¿è´¯æ“ä½œæ–¹æ³•ä¹‹ä¸€ï¼Œç”¨äºå¯¹æ•°æ®åº“æ“ä½œçš„ç»“æœè¿›è¡Œæ’åºï¼Œç›¸å½“äºæ˜¯åœ¨selectè¯­å¥ä¸­ä¸€ä¸ªorder byçš„å­å¥ã€‚ä¾‹ï¼š$Model-&gt;where(&#39;status=1&#39;)-&gt;order(&#39;id&nbsp;desc&#39;)-&gt;limit(5)-&gt;select();æ”¯æŒå¯¹å¤šä¸ªå­—æ®µçš„æ’åºï¼Œä¾‹å¦‚ï¼š$Model-&gt;where(&#39;status=1&#39;)-&gt;order(&#39;id&nbsp;desc,time&nbsp;asc&#39;)-&gt;limit(5)-&gt;select();å¦‚æœæ²¡æœ‰æŒ‡å®šæ’åºè§„åˆ™ï¼Œé»˜è®¤ä¸ºascã€‚å¦‚æœä½ çš„å­—æ®µå’Œmysqlå…³é”®å­—æœ‰å†²çªï¼Œé‚£ä¹ˆå»ºè®®é‡‡ç”¨æ•°ç»„æ–¹å¼è°ƒç”¨ï¼Œä¾‹å¦‚ï¼š$Model-&gt;where(&#39;status=1&#39;)-&gt;order(array(&#39;order&#39;,&#39;id&#39;=&gt;&#39;desc&#39;))-&gt;limit(5)-&gt;select();","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"windows7åˆ›å»ºä»»åŠ¡è®¡åˆ’","slug":"windows7åˆ›å»ºä»»åŠ¡è®¡åˆ’","date":"2017-01-05T05:30:54.000Z","updated":"2022-03-19T14:35:21.827Z","comments":true,"path":"2017/01/05/95/","link":"","permalink":"https://github.13sai.com/2017/01/05/95/","excerpt":"","text":"æœ€è¿‘åœ¨åšä¸ªç¨‹åºï¼Œçˆ¬å–ä¼˜æƒ ç”µå½±ç¥¨çš„ç¨‹åºï¼Œç¨‹åºå­˜åœ¨æœ¬åœ°ï¼Œæ¯æ¬¡éœ€è¦cmdè¿è¡Œä¸‹ï¼Œæœ‰ç‚¹éº»çƒ¦ï¼Œæœ‰æ—¶å€™ä¼šå¿˜è®°ï¼Œå› ä¸ºè€ƒè™‘åˆ›å»ºä»»åŠ¡è®¡åˆ’ã€‚åˆ›å»ºå…¶å®å¾ˆç®€å•ï¼Œç¬¬ä¸€æ­¥ï¼Œè¿›å…¥ä»»åŠ¡è®¡åˆ’ç®¡ç†ï¼ˆæ§åˆ¶é¢æ¿æˆ–è€…ç›´æ¥æœç´¢ç¨‹åºï¼‰ä½ å¯ä»¥çœ‹è§æœ¬æœºçš„ä»»åŠ¡è®¡åˆ’åˆ—è¡¨ã€‚ç‚¹å‡»å³ä¾§åˆ›å»ºåŸºæœ¬ä»»åŠ¡ï¼Œåç§°æè¿°è§¦å‘æ—¶é—´å°±ç”±ä½ å®šï¼Œé€‰æ‹©å¯åŠ¨ç¨‹åºï¼Œç¨‹åºè„šæœ¬å†™åœ¨ä¸Šé¢ï¼Œèµ·å§‹äºå†™å…¥æ”¹ç¨‹åºæ‰€åœ¨ç›®å½•ã€‚ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œç‚¹å‡»å®Œæˆï¼Œè¿™æ ·å°±å®Œæˆäº†ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚","categories":[{"name":"windows","slug":"windows","permalink":"https://github.13sai.com/categories/windows/"}],"tags":[{"name":"windows","slug":"windows","permalink":"https://github.13sai.com/tags/windows/"}]},{"title":"å¾®ä¿¡JSSDKåˆ†äº«","slug":"å¾®ä¿¡JSSDKåˆ†äº«","date":"2016-12-27T07:50:49.000Z","updated":"2022-03-19T14:35:21.915Z","comments":true,"path":"2016/12/27/94/","link":"","permalink":"https://github.13sai.com/2016/12/27/94/","excerpt":"","text":"å¾®ä¿¡JS-SDKæ˜¯å¾®ä¿¡å…¬ä¼—å¹³å°é¢å‘ç½‘é¡µå¼€å‘è€…æä¾›çš„åŸºäºå¾®ä¿¡å†…çš„ç½‘é¡µå¼€å‘å·¥å…·åŒ…ã€‚é€šè¿‡ä½¿ç”¨å¾®ä¿¡JS-SDKï¼Œç½‘é¡µå¼€å‘è€…å¯å€ŸåŠ©å¾®ä¿¡é«˜æ•ˆåœ°ä½¿ç”¨æ‹ç…§ã€é€‰å›¾ã€è¯­éŸ³ã€ä½ç½®ç­‰æ‰‹æœºç³»ç»Ÿçš„èƒ½åŠ›ï¼ŒåŒæ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨å¾®ä¿¡åˆ†äº«ã€æ‰«ä¸€æ‰«ã€å¡åˆ¸ã€æ”¯ä»˜ç­‰å¾®ä¿¡ç‰¹æœ‰çš„èƒ½åŠ›ï¼Œä¸ºå¾®ä¿¡ç”¨æˆ·æä¾›æ›´ä¼˜è´¨çš„ç½‘é¡µä½“éªŒã€‚æ­¤æ–‡æ¡£é¢å‘ç½‘é¡µå¼€å‘è€…ä»‹ç»å¾®ä¿¡JS-SDKå¦‚ä½•ä½¿ç”¨åŠç›¸å…³æ³¨æ„äº‹é¡¹ã€‚JSSDKä½¿ç”¨æ­¥éª¤æ­¥éª¤ä¸€ï¼šç»‘å®šåŸŸåå…ˆç™»å½•å¾®ä¿¡å…¬ä¼—å¹³å°è¿›å…¥â€œå…¬ä¼—å·è®¾ç½®â€çš„â€œåŠŸèƒ½è®¾ç½®â€é‡Œå¡«å†™â€œJSæ¥å£å®‰å…¨åŸŸåâ€ã€‚å¤‡æ³¨ï¼šç™»å½•åå¯åœ¨â€œå¼€å‘è€…ä¸­å¿ƒâ€æŸ¥çœ‹å¯¹åº”çš„æ¥å£æƒé™ã€‚æ­¥éª¤äºŒï¼šå¼•å…¥JSæ–‡ä»¶åœ¨éœ€è¦è°ƒç”¨JSæ¥å£çš„é¡µé¢å¼•å…¥å¦‚ä¸‹JSæ–‡ä»¶ï¼Œï¼ˆæ”¯æŒhttpsï¼‰ï¼šhttp://res.wx.qq.com/open/js/jweixin-1.0.0.jsè¯·æ³¨æ„ï¼Œå¦‚æœä½ çš„é¡µé¢å¯ç”¨äº†httpsï¼ŒåŠ¡å¿…å¼•å…¥ https://res.wx.qq.com/open/js/jweixin-1.0.0.js ï¼Œå¦åˆ™å°†æ— æ³•åœ¨iOS9.0ä»¥ä¸Šç³»ç»Ÿä¸­æˆåŠŸä½¿ç”¨JSSDKå¦‚éœ€ä½¿ç”¨æ‘‡ä¸€æ‘‡å‘¨è¾¹åŠŸèƒ½ï¼Œè¯·å¼•å…¥ jweixin-1.1.0.jså¤‡æ³¨ï¼šæ”¯æŒä½¿ç”¨ AMD/CMD æ ‡å‡†æ¨¡å—åŠ è½½æ–¹æ³•åŠ è½½æ­¥éª¤ä¸‰ï¼šé€šè¿‡configæ¥å£æ³¨å…¥æƒé™éªŒè¯é…ç½®æ‰€æœ‰éœ€è¦ä½¿ç”¨JS-SDKçš„é¡µé¢å¿…é¡»å…ˆæ³¨å…¥é…ç½®ä¿¡æ¯ï¼Œå¦åˆ™å°†æ— æ³•è°ƒç”¨ï¼ˆåŒä¸€ä¸ªurlä»…éœ€è°ƒç”¨ä¸€æ¬¡ï¼Œå¯¹äºå˜åŒ–urlçš„SPAçš„web appå¯åœ¨æ¯æ¬¡urlå˜åŒ–æ—¶è¿›è¡Œè°ƒç”¨,ç›®å‰Androidå¾®ä¿¡å®¢æˆ·ç«¯ä¸æ”¯æŒpushStateçš„H5æ–°ç‰¹æ€§ï¼Œæ‰€ä»¥ä½¿ç”¨pushStateæ¥å®ç°web appçš„é¡µé¢ä¼šå¯¼è‡´ç­¾åå¤±è´¥ï¼Œæ­¤é—®é¢˜ä¼šåœ¨Android6.2ä¸­ä¿®å¤ï¼‰ã€‚wx.config({ &nbsp;&nbsp;&nbsp;&nbsp;debug:&nbsp;true,&nbsp;//&nbsp;å¼€å¯è°ƒè¯•æ¨¡å¼,è°ƒç”¨çš„æ‰€æœ‰apiçš„è¿”å›å€¼ä¼šåœ¨å®¢æˆ·ç«¯alertå‡ºæ¥ï¼Œè‹¥è¦æŸ¥çœ‹ä¼ å…¥çš„å‚æ•°ï¼Œå¯ä»¥åœ¨pcç«¯æ‰“å¼€ï¼Œå‚æ•°ä¿¡æ¯ä¼šé€šè¿‡logæ‰“å‡ºï¼Œä»…åœ¨pcç«¯æ—¶æ‰ä¼šæ‰“å°ã€‚ &nbsp;&nbsp;&nbsp;&nbsp;appId:&nbsp;&#39;&#39;,&nbsp;//&nbsp;å¿…å¡«ï¼Œå…¬ä¼—å·çš„å”¯ä¸€æ ‡è¯† &nbsp;&nbsp;&nbsp;&nbsp;timestamp:&nbsp;,&nbsp;//&nbsp;å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„æ—¶é—´æˆ³ &nbsp;&nbsp;&nbsp;&nbsp;nonceStr:&nbsp;&#39;&#39;,&nbsp;//&nbsp;å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„éšæœºä¸² &nbsp;&nbsp;&nbsp;&nbsp;signature:&nbsp;&#39;&#39;,//&nbsp;å¿…å¡«ï¼Œç­¾åï¼Œè§é™„å½•1 &nbsp;&nbsp;&nbsp;&nbsp;jsApiList:&nbsp;[]&nbsp;//&nbsp;å¿…å¡«ï¼Œéœ€è¦ä½¿ç”¨çš„JSæ¥å£åˆ—è¡¨ï¼Œæ‰€æœ‰JSæ¥å£åˆ—è¡¨è§é™„å½•2 });æ­¥éª¤å››ï¼šé€šè¿‡readyæ¥å£å¤„ç†æˆåŠŸéªŒè¯wx.ready(function(){ &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;configä¿¡æ¯éªŒè¯åä¼šæ‰§è¡Œreadyæ–¹æ³•ï¼Œæ‰€æœ‰æ¥å£è°ƒç”¨éƒ½å¿…é¡»åœ¨configæ¥å£è·å¾—ç»“æœä¹‹åï¼Œconfigæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯çš„å¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥å¦‚æœéœ€è¦åœ¨é¡µé¢åŠ è½½æ—¶å°±è°ƒç”¨ç›¸å…³æ¥å£ï¼Œåˆ™é¡»æŠŠç›¸å…³æ¥å£æ”¾åœ¨readyå‡½æ•°ä¸­è°ƒç”¨æ¥ç¡®ä¿æ­£ç¡®æ‰§è¡Œã€‚å¯¹äºç”¨æˆ·è§¦å‘æ—¶æ‰è°ƒç”¨çš„æ¥å£ï¼Œåˆ™å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä¸éœ€è¦æ”¾åœ¨readyå‡½æ•°ä¸­ã€‚});æ­¥éª¤äº”ï¼šé€šè¿‡erroræ¥å£å¤„ç†å¤±è´¥éªŒè¯wx.error(function(res){ &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;configä¿¡æ¯éªŒè¯å¤±è´¥ä¼šæ‰§è¡Œerrorå‡½æ•°ï¼Œå¦‚ç­¾åè¿‡æœŸå¯¼è‡´éªŒè¯å¤±è´¥ï¼Œå…·ä½“é”™è¯¯ä¿¡æ¯å¯ä»¥æ‰“å¼€configçš„debugæ¨¡å¼æŸ¥çœ‹ï¼Œä¹Ÿå¯ä»¥åœ¨è¿”å›çš„reså‚æ•°ä¸­æŸ¥çœ‹ï¼Œå¯¹äºSPAå¯ä»¥åœ¨è¿™é‡Œæ›´æ–°ç­¾åã€‚ });æ¥å£è°ƒç”¨è¯´æ˜æ‰€æœ‰æ¥å£é€šè¿‡wxå¯¹è±¡(ä¹Ÿå¯ä½¿ç”¨jWeixinå¯¹è±¡)æ¥è°ƒç”¨ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé™¤äº†æ¯ä¸ªæ¥å£æœ¬èº«éœ€è¦ä¼ çš„å‚æ•°ä¹‹å¤–ï¼Œè¿˜æœ‰ä»¥ä¸‹é€šç”¨å‚æ•°ï¼šsuccessï¼šæ¥å£è°ƒç”¨æˆåŠŸæ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚failï¼šæ¥å£è°ƒç”¨å¤±è´¥æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚completeï¼šæ¥å£è°ƒç”¨å®Œæˆæ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥éƒ½ä¼šæ‰§è¡Œã€‚cancelï¼šç”¨æˆ·ç‚¹å‡»å–æ¶ˆæ—¶çš„å›è°ƒå‡½æ•°ï¼Œä»…éƒ¨åˆ†æœ‰ç”¨æˆ·å–æ¶ˆæ“ä½œçš„apiæ‰ä¼šç”¨åˆ°ã€‚trigger: ç›‘å¬Menuä¸­çš„æŒ‰é’®ç‚¹å‡»æ—¶è§¦å‘çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä»…æ”¯æŒMenuä¸­çš„ç›¸å…³æ¥å£ã€‚å¤‡æ³¨ï¼šä¸è¦å°è¯•åœ¨triggerä¸­ä½¿ç”¨ajaxå¼‚æ­¥è¯·æ±‚ä¿®æ”¹æœ¬æ¬¡åˆ†äº«çš„å†…å®¹ï¼Œå› ä¸ºå®¢æˆ·ç«¯åˆ†äº«æ“ä½œæ˜¯ä¸€ä¸ªåŒæ­¥æ“ä½œï¼Œè¿™æ—¶å€™ä½¿ç”¨ajaxçš„å›åŒ…ä¼šè¿˜æ²¡æœ‰è¿”å›ã€‚ä»¥ä¸Šå‡ ä¸ªå‡½æ•°éƒ½å¸¦æœ‰ä¸€ä¸ªå‚æ•°ï¼Œç±»å‹ä¸ºå¯¹è±¡ï¼Œå…¶ä¸­é™¤äº†æ¯ä¸ªæ¥å£æœ¬èº«è¿”å›çš„æ•°æ®ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªé€šç”¨å±æ€§errMsgï¼Œå…¶å€¼æ ¼å¼å¦‚ä¸‹ï¼šè°ƒç”¨æˆåŠŸæ—¶ï¼š&quot;xxx:ok&quot; ï¼Œå…¶ä¸­xxxä¸ºè°ƒç”¨çš„æ¥å£åç”¨æˆ·å–æ¶ˆæ—¶ï¼š&quot;xxx:cancel&quot;ï¼Œå…¶ä¸­xxxä¸ºè°ƒç”¨çš„æ¥å£åè°ƒç”¨å¤±è´¥æ—¶ï¼šå…¶å€¼ä¸ºå…·ä½“é”™è¯¯ä¿¡æ¯æˆ‘ä»¬é‡ç‚¹ä»‹ç»ç”Ÿæˆè¿™äº›é…ç½®ä¿¡æ¯&lt;?phpclass&nbsp;JssdkAction&nbsp;extends&nbsp;AppbaseAction{&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$appId&nbsp;=&nbsp;&quot;@&quot;;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$appSecret&nbsp;=&nbsp;&quot;@&quot;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ç»§æ‰¿çˆ¶ç±»/&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;_initialize()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent::_initialize();&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;getSignPackage()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$jsapiTicket&nbsp;=&nbsp;$this-&gt;getJsApiTicket(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;æ³¨æ„&nbsp;URL&nbsp;ä¸€å®šè¦åŠ¨æ€è·å–ï¼Œä¸èƒ½&nbsp;hardcode.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$protocol&nbsp;=&nbsp;(!empty($_SERVER[&#39;HTTPS&#39;])&nbsp;&amp;&amp;&nbsp;$_SERVER[&#39;HTTPS&#39;]&nbsp;!==&nbsp;&#39;off&#39;&nbsp;||&nbsp;$_SERVER[&#39;SERVER_PORT&#39;]&nbsp;==&nbsp;443)&nbsp;?&nbsp;&quot;https://&quot;&nbsp;:&nbsp;&quot;http://&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url&nbsp;=&nbsp;&quot;$protocol$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]&quot;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$timestamp&nbsp;=&nbsp;time();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nonceStr&nbsp;=&nbsp;$this-&gt;createNonceStr(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¿™é‡Œå‚æ•°çš„é¡ºåºè¦æŒ‰ç…§&nbsp;key&nbsp;å€¼&nbsp;ASCII&nbsp;ç å‡åºæ’åº&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$string&nbsp;=&nbsp;&quot;jsapi_ticket=$jsapiTicket&amp;noncestr=$nonceStr&amp;timestamp=$timestamp&amp;url=$url&quot;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$signature&nbsp;=&nbsp;sha1($string); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$signPackage&nbsp;=&nbsp;array(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;appId&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;$this-&gt;appId,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;nonceStr&quot;&nbsp;&nbsp;=&gt;&nbsp;$nonceStr,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;timestamp&quot;&nbsp;=&gt;&nbsp;$timestamp,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;url&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;$url,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&quot;jsapiTicket&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;$jsapiTicket,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;signature&quot;&nbsp;=&gt;&nbsp;$signature,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;rawString&quot;&nbsp;=&gt;&nbsp;$string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$signPackage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;createNonceStr($length&nbsp;=&nbsp;16)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$chars&nbsp;=&nbsp;&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$str&nbsp;=&nbsp;&quot;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;($i&nbsp;=&nbsp;0;&nbsp;$i&nbsp;&lt;&nbsp;$length;&nbsp;$i++)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$str&nbsp;.=&nbsp;substr($chars,&nbsp;mt_rand(0,&nbsp;strlen($chars)&nbsp;-&nbsp;1),&nbsp;1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$str;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;getJsApiTicket()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;jsapi_ticket&nbsp;åº”è¯¥å…¨å±€å­˜å‚¨ä¸æ›´æ–°ï¼Œä»¥ä¸‹ä»£ç ä»¥å†™å…¥åˆ°æ–‡ä»¶ä¸­åšç¤ºä¾‹&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;json_decode(file_get_contents(&quot;jsapi_ticket.json&quot;),true);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($data-&gt;expire_time&nbsp;&lt;&nbsp;time())&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$accessToken&nbsp;=&nbsp;$this-&gt;getAccessToken();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;å¦‚æœæ˜¯ä¼ä¸šå·ç”¨ä»¥ä¸‹&nbsp;URL&nbsp;è·å–&nbsp;ticket&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$url&nbsp;=&nbsp;&quot;https://qyapi.weixin.qq.com/cgi-bin/get_jsapi_ticket?access_token=$accessToken&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url&nbsp;=&nbsp;&quot;https://api.weixin.qq.com/cgi-bin/ticket/getticket?type=jsapi&amp;access_token=$accessToken&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$res&nbsp;=&nbsp;z_get_json($url);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ticket&nbsp;=&nbsp;$res[&#39;ticket&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($ticket)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data-&gt;expire_time&nbsp;=&nbsp;time()&nbsp;+&nbsp;7200;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data-&gt;jsapi_ticket&nbsp;=&nbsp;$ticket;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fp&nbsp;=&nbsp;fopen(&quot;jsapi_ticket.json&quot;,&nbsp;&quot;w&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fwrite($fp,&nbsp;json_encode($data));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fclose($fp);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$accessToken;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ticket&nbsp;=&nbsp;$data[&#39;jsapi_ticket&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$ticket;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$ticket;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;function&nbsp;getAccessToken()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;access_token&nbsp;åº”è¯¥å…¨å±€å­˜å‚¨ä¸æ›´æ–°ï¼Œä»¥ä¸‹ä»£ç ä»¥å†™å…¥åˆ°æ–‡ä»¶ä¸­åšç¤ºä¾‹&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;json_decode(file_get_contents(&quot;access_token.json&quot;));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($data-&gt;expire_time&nbsp;&lt;&nbsp;time())&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;å¦‚æœæ˜¯ä¼ä¸šå·ç”¨ä»¥ä¸‹URLè·å–access_token&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$url&nbsp;=&nbsp;&quot;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=$this-&gt;appId&amp;corpsecret=$this-&gt;appSecret&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url&nbsp;=&nbsp;&quot;https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=$this-&gt;appId&amp;secret=$this-&gt;appSecret&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$res&nbsp;=&nbsp;z_get_json($url);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$access_token&nbsp;=&nbsp;$res[&#39;access_token&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($access_token)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data-&gt;expire_time&nbsp;=&nbsp;time()&nbsp;+&nbsp;7200;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data-&gt;access_token&nbsp;=&nbsp;$access_token;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fp&nbsp;=&nbsp;fopen(&quot;access_token.json&quot;,&nbsp;&quot;w&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fwrite($fp,&nbsp;json_encode($data));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fclose($fp);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//var_dump($res);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$access_token&nbsp;=&nbsp;$data-&gt;access_token;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$access_token;&nbsp;&nbsp;&nbsp;&nbsp;} }å¦ä¸€ä¸ªç»„çš„è°ƒç”¨&lt;?php class&nbsp;ActivityAction&nbsp;extends&nbsp;BaseAction&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;/ç»§æ‰¿çˆ¶ç±»/&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;_initialize()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent::_initialize();&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;detail(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;navname&nbsp;=&nbsp;&#39;æ´»åŠ¨ä¿¡æ¯&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$a&nbsp;=&nbsp;M(&quot;vw_activity&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;$a-&gt;where(&quot;a_id=&#39;%s&#39;&quot;,$a_id)-&gt;find(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$jssdk&nbsp;=&nbsp;A(&#39;Jssdk&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;signPackage&nbsp;=&nbsp;$jssdk-&gt;getSignPackage();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data&nbsp;=&nbsp;$data;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;display();&nbsp;&nbsp;&nbsp;&nbsp;} }å‰å°tplï¼š&lt;script&nbsp;src=&quot;http://res.wx.qq.com/open/js/jweixin-1.0.0.js&quot;&gt;&lt;/script&gt;&lt;script&gt;$(function(){&nbsp;&nbsp;&nbsp;&nbsp;wx.config({&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug:&nbsp;false,&nbsp;&nbsp;//trueä¸ºè°ƒè¯•æ¨¡å¼ï¼Œè°ƒè¯•æ—¶å¯å¯ç”¨&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appId:&nbsp;&#39;{$signPackage[&quot;appId&quot;]}&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timestamp:&nbsp;&#39;{$signPackage[&quot;timestamp&quot;]}&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonceStr:&nbsp;&#39;{$signPackage[&quot;nonceStr&quot;]}&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signature:&nbsp;&#39;{$signPackage[&quot;signature&quot;]}&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jsApiList:&nbsp;[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;checkJsApi&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;onMenuShareTimeline&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;onMenuShareAppMessage&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;wx.ready(function&nbsp;()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wx.onMenuShareAppMessage({&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title:&nbsp;&#39;{$data[&#39;a_name&#39;]}&#39;,&nbsp;//&nbsp;åˆ†äº«æ ‡é¢˜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desc:&nbsp;&#39;{$data[&#39;a_desc&#39;]}&#39;,&nbsp;//&nbsp;åˆ†äº«æè¿°&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link:&nbsp;&#39;&#39;,&nbsp;//&nbsp;åˆ†äº«é“¾æ¥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imgUrl:&nbsp;&#39;http://{:$_SERVER[&#39;SERVER_NAME&#39;].$data[&#39;a_thumb&#39;]}&#39;,&nbsp;//&nbsp;åˆ†äº«å›¾æ ‡&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//type:&nbsp;&#39;&#39;,&nbsp;//&nbsp;åˆ†äº«ç±»å‹,musicã€videoæˆ–linkï¼Œä¸å¡«é»˜è®¤ä¸ºlink&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//dataUrl:&nbsp;&#39;&#39;,&nbsp;//&nbsp;å¦‚æœtypeæ˜¯musicæˆ–videoï¼Œåˆ™è¦æä¾›æ•°æ®é“¾æ¥ï¼Œé»˜è®¤ä¸ºç©º&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;function&nbsp;()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aideTips(&#39;åˆ†äº«æˆåŠŸï¼&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel:&nbsp;function&nbsp;()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aideTips(&#39;åˆ†äº«å¤±è´¥ï¼&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wx.onMenuShareTimeline({&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title:&nbsp;&#39;{$data[&#39;a_name&#39;]}&#39;,&nbsp;//&nbsp;åˆ†äº«æ ‡é¢˜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//desc:&nbsp;&#39;{$data[&#39;a_desc&#39;]}&#39;,&nbsp;//&nbsp;åˆ†äº«æè¿°&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link:&nbsp;&#39;&#39;,&nbsp;//&nbsp;åˆ†äº«é“¾æ¥&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imgUrl:&nbsp;&#39;http://{:$_SERVER[&#39;SERVER_NAME&#39;].$data[&#39;a_thumb&#39;]}&#39;,&nbsp;//&nbsp;åˆ†äº«å›¾æ ‡ï¼Œæ³¨æ„ä¸è¦ç”¨ç›¸å¯¹åœ°å€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;function&nbsp;()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aideTips(&#39;åˆ†äº«æˆåŠŸï¼&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel:&nbsp;function&nbsp;()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aideTips(&#39;åˆ†äº«å¤±è´¥ï¼&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;})&nbsp;&nbsp;&nbsp;&nbsp;//aideTips(&#39;åˆ†äº«å¤±è´¥ï¼&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})&lt;/script&gt;çœ‹çœ‹æ•ˆæœï¼Œæ›´å¤šæ—¶é—´è¯·çœ‹ å¾®ä¿¡jssdk","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"ç§»åŠ¨ç«¯ç¾è§‚çš„åŸå¸‚åˆ—è¡¨","slug":"ç§»åŠ¨ç«¯ç¾è§‚çš„åŸå¸‚åˆ—è¡¨","date":"2016-12-24T02:12:15.000Z","updated":"2022-03-19T14:35:21.934Z","comments":true,"path":"2016/12/24/92/","link":"","permalink":"https://github.13sai.com/2016/12/24/92/","excerpt":"","text":"æœ€è¿‘é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªéœ€æ±‚æ˜¯è¦å®šä½åˆ°åŸå¸‚çš„ï¼Œå› ä¸ºé£æ ¼å‚ç…§ç¾å›¢ï¼Œæ‰€ä»¥æ‰¾äº†ä¸ªç±»ä¼¼é£æ ¼çš„demoã€‚ç›´æ¥ä¸Šä»£ç å§ï¼šcitylist.zipæ–‡ä»¶ä¸å¤§ï¼Œä½†å¯æƒœçš„æ˜¯ï¼Œåªèƒ½å®šä½åˆ°åœ°çº§å¸‚ï¼Œæ°å¥½é…åˆsinaçš„å¼€æ”¾apié…åˆä½¿ç”¨ã€‚perfectï¼å…·ä½“è·å–åœ°ç†ä½ç½®è¯·çœ‹ï¼šjsè·å–å½“å‰åœ°ç†ä½ç½®ä¸ip","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"jså®ç°ä¸Šä¼ å›¾ç‰‡å‰æœ¬åœ°é¢„è§ˆ","slug":"jså®ç°ä¸Šä¼ å›¾ç‰‡å‰æœ¬åœ°é¢„è§ˆ","date":"2016-12-13T05:32:03.000Z","updated":"2022-03-19T14:35:21.733Z","comments":true,"path":"2016/12/13/91/","link":"","permalink":"https://github.13sai.com/2016/12/13/91/","excerpt":"","text":"ç›´æ¥ä¸Šä»£ç ï¼š &lt;script type=&quot;text/javascript&quot;&gt; /** * ä» file åŸŸè·å– æœ¬åœ°å›¾ç‰‡ url */ function getFileUrl(sourceId) &#123; var url; if (navigator.userAgent.indexOf(&quot;MSIE&quot;)&gt;=1) &#123; // IE url = document.getElementById(sourceId).value; &#125; else &#123; // Chrome url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0)); &#125; return url; &#125; /** * å°†æœ¬åœ°å›¾ç‰‡ æ˜¾ç¤ºåˆ°æµè§ˆå™¨ä¸Š */ function preImg(sourceId, targetId) &#123; var url = getFileUrl(sourceId); var imgPre = document.getElementById(targetId); imgPre.src = url; &#125; &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;form action=&quot;&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;imgOne&quot; id=&quot;imgOne&quot; onchange=&quot;preImg(this.id,&#x27;imgPre&#x27;);&quot; /&gt; &lt;img id=&quot;imgPre&quot; src=&quot;&quot; width=&quot;300px&quot; height=&quot;300px&quot; style=&quot;display: block;&quot; /&gt; &lt;/form&gt;","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"ASPè¿æ¥mysqlæ•°æ®åº“","slug":"ASPè¿æ¥mysqlæ•°æ®åº“","date":"2016-11-30T08:52:47.000Z","updated":"2022-03-19T14:35:21.566Z","comments":true,"path":"2016/11/30/90/","link":"","permalink":"https://github.13sai.com/2016/11/30/90/","excerpt":"","text":"æœ€è¿‘å…¬å¸ä¸»ç«™è¦ä¸Šä¸ªæŠ½å¥–é¡µé¢ï¼Œåå°ä¹Ÿè¦å¢åŠ æŸ¥è¯¢åŠŸèƒ½ï¼Œæˆ‘å°±è´Ÿè´£å¢åŠ åå°åˆ—è¡¨é¡µï¼Œå…¶å®å°±ä¸€ä¸ªé¡µé¢è€Œå·²ã€‚è‡ªå·±ä¹‹å‰ä»æ²¡æ¥è§¦è¿‡aspï¼Œè²Œä¼¼ä¹Ÿoutäº†ï¼Œä½†è¿˜æ˜¯è¯•ç€ç”¨ASPæ¥å†™è¿™ä¸ªé¡µé¢ã€‚ä¹‹å‰ä¸»ç«™çš„æ•°æ®éƒ½æ˜¯å­˜åœ¨sqlserveré‡Œï¼Œè€Œè¿™æ¬¡æˆ‘ä»¬æŠŠæ•°æ®è¡¨æ”¾åœ¨äº†mysqlæ•°æ®åº“é‡Œï¼Œä¸å¾—ä¸å†™ä¸ªè¿æ¥æ•°æ®åº“çš„configï¼Œé‚£ä¹ˆæˆ‘ä»¬å¼€å§‹ï¼šdim&nbsp;myHost,myDB,myUID,myPWD myHost&nbsp;=&nbsp;&quot;localhost&quot; myDB&nbsp;=&nbsp;&quot;db&quot; myUID&nbsp;=&nbsp;&quot;user&quot; myPWD&nbsp;=&nbsp;&quot;pw&quot; myCharSet&nbsp;=&nbsp;&quot;utf8&quot; strconnection=&quot;driver={MySQL&nbsp;ODBC&nbsp;3.51&nbsp;Driver};server=&quot;&nbsp;&amp;&nbsp;myHost&nbsp;&amp;&nbsp;&quot;;database=&quot;&nbsp;&amp;&nbsp;myDB&nbsp;&amp;&nbsp;&quot;;uid=&quot;&nbsp;&amp;&nbsp;myUID&nbsp;&amp;&nbsp;&quot;;password=&quot;&nbsp;&amp;&nbsp;myPWD set&nbsp;conn&nbsp;=&nbsp;Server.CreateObject(&quot;ADODB.Connection&quot;) conn.open&nbsp;strconnection conn.execute(&quot;set&nbsp;names&nbsp;&#39;&quot;&nbsp;&amp;&nbsp;myCharSet&nbsp;&amp;&nbsp;&quot;&#39;&quot;)ç„¶åæŠ¥é”™ï¼šé©±åŠ¨æ²¡è£…ï¼Œè£…å¥½odbcé©±åŠ¨ï¼Œæ³¨æ„ç‰ˆæœ¬ï¼ˆ3.51æˆ–å…¶ä»–ç‰ˆæœ¬ï¼‰è¦ä¸ç¨‹åºå¯¹åº”ã€‚é‡è¯•ï¼ŒæŠ¥é”™æ¶ˆå¤±ã€‚æŸ¥è¯¢name&nbsp;=&nbsp;Request.Form(&quot;name&quot;) mobile&nbsp;=&nbsp;Request.Form(&quot;mobile&quot;) where&nbsp;=&nbsp;&quot;&nbsp;where&nbsp;1=1&quot; If&nbsp;name&lt;&gt;&quot;&quot;&nbsp;Then &nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;=&nbsp;where&nbsp;&amp;&nbsp;&quot;&nbsp;and&nbsp;name&nbsp;like&nbsp;&#39;%&quot;&amp;&nbsp;name&nbsp;&amp;&quot;%&#39;&quot; End&nbsp;If If&nbsp;mobile&lt;&gt;&quot;&quot;&nbsp;Then &nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;=&nbsp;where&nbsp;&amp;&nbsp;&quot;&nbsp;and&nbsp;mobile&nbsp;like&nbsp;&#39;%&quot;&amp;&nbsp;mobile&nbsp;&amp;&quot;%&#39;&quot; End&nbsp;If &lt;table&nbsp;id=&quot;example2&quot;&nbsp;class=&quot;table&nbsp;table-hover&nbsp;table-striped&nbsp;dataTable&nbsp;&quot;&nbsp;&gt; &nbsp;&nbsp;&lt;thead&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&nbsp;role=&quot;row&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;åºå·&lt;/th&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;å§“å&lt;/th&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;æ‰‹æœºå·&lt;/th&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt; &nbsp;&nbsp;&nbsp;&lt;/thead&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;% sql&nbsp;=&nbsp;&quot;select&nbsp;*&nbsp;from&nbsp;activity_customer&nbsp;&quot;&amp;&nbsp;where&nbsp;&amp;&quot;&nbsp;order&nbsp;by&nbsp;ac_id&nbsp;desc&quot; set&nbsp;rs=server.CreateObject(&quot;adodb.recordset&quot;) call&nbsp;manage()&nbsp; sub&nbsp;manage() &nbsp;&nbsp;&nbsp;&nbsp;&#39;å¿…é¡» &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;rs.CursorLocation=3&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;rs.open&nbsp;sql,adodataconn,1,1 &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i=1&nbsp;to&nbsp;rs.recordcount %&amp;gt; &amp;lt;tr&amp;gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;td&amp;gt;&amp;lt;%=rs(&amp;quot;id&amp;quot;)%&amp;gt;&amp;lt;/td&amp;gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;td&amp;gt;&amp;lt;%=rs(&amp;quot;name&amp;quot;)%&amp;gt;&amp;lt;/td&amp;gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;td&amp;gt;&amp;lt;%=rs(&amp;quot;mobile&amp;quot;)%&amp;gt;&amp;lt;/td&amp;gt; &amp;lt;/tr&amp;gt; &amp;lt;% &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;#39;******************ä¸Šé¢æ˜¯ä½ è¦æ˜¾ç¤ºçš„******************&amp;#39; rs.movenext if&amp;nbsp;rs.eof&amp;nbsp;then &amp;nbsp;&amp;nbsp;Exit&amp;nbsp;For End&amp;nbsp;if Next &amp;nbsp;response.write&amp;nbsp;&amp;quot;&amp;lt;/tbody&amp;gt;&amp;quot; &amp;nbsp;response.write&amp;nbsp;&amp;quot;&amp;lt;/table&amp;gt;&amp;quot; rs.close set&amp;nbsp;rs=nothing end&amp;nbsp;sub set&amp;nbsp;conn=nothing&lt;/pre&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;æ³¨æ„ä¸‹&lt;span style=&quot;color: rgb(255, 0, 0);&quot;&gt;rs.CursorLocation=3&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;/upload/ueditor/image/20161130/1480495561126675.png&quot; title=&quot;1480495561126675.png&quot; alt=&quot;blob.png&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;CursorLocation å±æ€§å¯è®¾ç½®æˆ–è¿”å›ä¸€ä¸ª long å€¼ï¼Œè¯¥å€¼æŒ‡ç¤ºæ¸¸æ ‡æœåŠ¡çš„ä½ç½®ã€‚é»˜è®¤å€¼æ˜¯ AdUseServerã€‚&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;white-space: normal;&quot;&gt;è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯æ¯æ¬¡è®°å¾—å…³é—­æ•°æ®åº“ä¸æ•°æ®é›†ã€‚&lt;/p&gt;&lt;p style=&quot;white-space: normal;&quot;&gt;ä¹Ÿå°±æ˜¯&lt;/p&gt;&lt;pre class=&quot;brush:html;toolbar:false&quot;&gt;set&amp;nbsp;rs=nothing set&nbsp;conn=nothingå¥½äº†ï¼Œè¿™æ ·å°±å®ç°äº†æ•°æ®åº“è¿æ¥ä¸æŸ¥è¯¢æœç´¢ã€‚æ‰€ä»¥è¯´ï¼Œé‡åˆ°ä¸ç†Ÿæ‚‰çš„è¯­è¨€ä¸è¦æ€•ï¼Œæœ‰å¼ºå¤§çš„æœç´¢å¼•æ“ä¸ç»“æœå‘¢ã€‚å¤šè¯»ä¹¦ï¼Œå¤šçœ‹æŠ¥ï¼Œå°‘åƒé›¶é£Ÿï¼Œå¤šç¡è§‰ï¼Œæˆ‘è¡Œï¼Œä½ ä¹Ÿè¡Œã€‚å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼","categories":[{"name":"asp","slug":"asp","permalink":"https://github.13sai.com/categories/asp/"}],"tags":[{"name":"asp","slug":"asp","permalink":"https://github.13sai.com/tags/asp/"}]},{"title":"ä¸ƒç‰›äº‘ä¸Šä¼ è§†é¢‘","slug":"ä¸ƒç‰›äº‘ä¸Šä¼ è§†é¢‘","date":"2016-11-28T07:31:00.000Z","updated":"2022-03-19T14:35:21.843Z","comments":true,"path":"2016/11/28/89/","link":"","permalink":"https://github.13sai.com/2016/11/28/89/","excerpt":"","text":"è¿‘æœŸå®¢æˆ·éœ€è¦åšä¸€ä¸ªè§†é¢‘ä¸Šä¼ çš„åŠŸèƒ½ï¼Œåˆå«Œå¼ƒä¼˜é…·ã€è…¾è®¯å¹³å°çš„å¹¿å‘Šï¼Œå®¢æˆ·ä¸å·®é’±ï¼Œå› è€Œé€‰æ‹©äº†ä¸ƒç‰›äº‘ã€‚ä¸ƒç‰›äº‘çš„å¼€å‘è€…æ–‡æ¡£è¿˜æ˜¯å¾ˆè¯¦å°½çš„ï¼Œä¸Šä¼ ã€é‡å‘½åã€è½¬ç ï¼Œä¸€åº”ä¿±å…¨ï¼Œè€Œä¸”PHP,JAVA,PYTHONç­‰å„ç§è¯­è¨€sdkéƒ½å¾ˆè¯¦ç»†ã€‚æˆ‘ç”¨çš„æ˜¯3.1ç‰ˆæœ¬çš„ThinkPHPï¼Œå…ˆå»ä¸ƒç‰›å¼€å‘è€…ä¸­å¿ƒä¸‹è½½PHPçš„sdkåˆ°TPçš„æ‰©å±•åº“Vendorç›®å½•ä¸‹ï¼Œå‘½åä¸ºQiniuã€‚æ¥ç€æ–°å»ºQiniuAction.class.php&lt;?php //&nbsp;å¼•å…¥é‰´æƒç±»&nbsp;å¼•å…¥ä¸Šä¼ ç±» use&nbsp;Qiniu\\Auth; use&nbsp;Qiniu\\Storage\\UploadManager; use&nbsp;Qiniu\\Processing\\PersistentFop; class&nbsp;QiniuAction&nbsp;extends&nbsp;AppbaseAction&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;upload(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//é˜²æ­¢ç›—ç”¨&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(session(&#39;m_id&#39;)&nbsp;==&nbsp;&#39;&#39;){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;å°æ ·ï¼Œä¸ç»™ä½ ä¸Šä¼ ï¼&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return&nbsp;=&nbsp;array();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return[&#39;status&#39;]&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//åˆ¤æ–­æ–‡ä»¶å¤§å°&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$maxSize&nbsp;=&nbsp;z_get_config(&#39;max_upload_video_size&#39;)&nbsp;&nbsp;1024&nbsp;&nbsp;1024; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_FILES[&#39;uploadv&#39;][size]&nbsp;&gt;&nbsp;$maxSize){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return[&#39;info&#39;]&nbsp;=&nbsp;&#39;æ–‡ä»¶è¿‡å¤§ï¼Œä¸èƒ½è¶…è¿‡&#39;.z_get_config(&#39;max_upload_video_size&#39;).&#39;M&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;json_encode($return);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//åˆ¤æ–­ç±»å‹&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arr_type&nbsp;=&nbsp;array(&#39;mp4&#39;,&#39;avi&#39;,&#39;rmvb&#39;,&#39;mp4&#39;,&#39;mpeg&#39;,&#39;wmv&#39;,,&#39;mpv&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fileType&nbsp;=&nbsp;pathinfo($_FILES[&#39;uploadv&#39;][&#39;name&#39;],PATHINFO_EXTENSION);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!in_array($fileType,&nbsp;$arr_type)){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return[&#39;info&#39;]&nbsp;=&nbsp;&#39;ä¸æ”¯æŒæ­¤æ ¼å¼ï¼Œè¯·ä¸Šä¼ &#39;.implode(&#39;,&#39;,$arr_type).&#39;ç±»å‹çš„è§†é¢‘&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;json_encode($return);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//å¼•å…¥åº“&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vendor(&#39;Qiniu.autoload&#39;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;æ„å»ºé‰´æƒå¯¹è±¡&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$accessKey&nbsp;=&nbsp;ak;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$secretKey&nbsp;=&nbsp;sk;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$auth&nbsp;=&nbsp;new&nbsp;Auth($accessKey,&nbsp;$secretKey);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¦ä¸Šä¼ çš„ç©ºé—´&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bucket&nbsp;=&nbsp;&#39;train&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è¦ä¸Šä¼ æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filePath&nbsp;=&nbsp;$_FILES[&#39;uploadv&#39;][&#39;tmp_name&#39;]; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ä¸Šä¼ åˆ°ä¸ƒç‰›åä¿å­˜çš„æ–‡ä»¶å&nbsp;é‡‡ç”¨idåŠ å½“å‰æ—¶é—´&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filename&nbsp;=&nbsp;&#39;qn_&#39;.$mid.&#39;_&#39;.time().&#39;.&#39;.$fileType;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//è¦è¿›è¡Œè½¬ç çš„è½¬ç æ“ä½œ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fops&nbsp;=&nbsp;&quot;avthumb/mp4/s/1280x720/vb/5m&quot;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//å¯ä»¥å¯¹è½¬ç åçš„æ–‡ä»¶è¿›è¡Œä½¿ç”¨saveaså‚æ•°è‡ªå®šä¹‰å‘½åï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸æŒ‡å®šæ–‡ä»¶ä¼šé»˜è®¤å‘½åå¹¶ä¿å­˜åœ¨å½“é—´&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$savekey&nbsp;=&nbsp;Qiniu\base64_urlSafeEncode($bucket.&#39;:&#39;.$filename);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fops&nbsp;=&nbsp;$fops.&#39;|saveas/&#39;.$savekey; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$policy&nbsp;=&nbsp;array(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;persistentOps&#39;&nbsp;=&gt;&nbsp;$fops,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;persistentPipeline&#39;&nbsp;=&gt;&nbsp;$pipeline&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uptoken&nbsp;=&nbsp;$auth-&gt;uploadToken($bucket,&nbsp;null,&nbsp;3600,&nbsp;$policy); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uploadMgr&nbsp;=&nbsp;new&nbsp;UploadManager(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list($ret,&nbsp;$err)&nbsp;=&nbsp;$uploadMgr-&gt;putFile($uptoken,&nbsp;null,&nbsp;$filePath); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//è¿”å›&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($err&nbsp;!==&nbsp;null)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;json_encode($err);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return&nbsp;=&nbsp;$ret;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return[&#39;status&#39;]&nbsp;=&nbsp;1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return[&#39;video&#39;]&nbsp;=&nbsp;$filename;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;json_encode($return);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;}}å‰å°ï¼š&nbsp;&nbsp;&nbsp;&nbsp;&lt;style&nbsp;type=&quot;text/css&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.type2{display:&nbsp;none;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#progress{position:relative;&nbsp;margin-left:150px;&nbsp;&nbsp;width:200px;padding:&nbsp;1px;&nbsp;border-radius:3px;&nbsp;display:none;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#bar&nbsp;{background-color:&nbsp;#D0333A;&nbsp;display:block;&nbsp;width:0%;&nbsp;height:30px;&nbsp;&nbsp;border-radius:3px;&nbsp;color:&nbsp;#666;&nbsp;text-align:&nbsp;center;&nbsp;line-height:&nbsp;30px;}&nbsp;&nbsp;&nbsp;&nbsp;&lt;/style&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;fabu&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;span&nbsp;class=&quot;wd-fr&quot;&gt;&lt;a&nbsp;href=&quot;{:U(&#39;Home/Train/index&#39;)}&quot;&gt;è¿”å›è¯¾ç¨‹åˆ—è¡¨&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;method=&quot;post&quot;&nbsp;action=&quot;{:U(&#39;Home/Train/fabu&#39;)}&quot;&nbsp;&nbsp;id=&quot;fabuForm&quot;&nbsp;enctype=&quot;multipart/form-data&quot;&nbsp;onsubmit=&quot;return&nbsp;jQuery(this).validationEngine(&#39;validate&#39;);&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;value=&quot;{$data_t[&#39;t_id&#39;]}&quot;&nbsp;name=&quot;teacher_id&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;id=&quot;t-video&quot;&nbsp;name=&quot;t_video&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;è¯¾ç¨‹æ ‡é¢˜ï¼š&lt;/label&gt;&lt;input&nbsp;type=&quot;text&quot;&nbsp;name=&quot;t_name&quot;&nbsp;class=&quot;validate[required,maxSize[100]]&quot;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;è¯¾ç¨‹åˆ†ç±»ï¼š&lt;/label&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;volist&nbsp;name=&quot;list_lx&quot;&nbsp;id=&quot;vo&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;radio&quot;&nbsp;name=&quot;t_type&quot;&nbsp;value=&quot;{$vo[&#39;d_value&#39;]}&quot;&nbsp;class=&quot;validate[required,groupRequired[lx]]&quot;&nbsp;&lt;if&nbsp;condition=&quot;$i&nbsp;eq&nbsp;1&quot;&gt;checked&lt;/if&gt;&gt;{$vo[&#39;d_title&#39;]}&amp;nbsp;&amp;nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/volist&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;type2&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;è¯¾ç¨‹åœ°ç‚¹ï¼š&lt;/label&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;text&quot;&nbsp;name=&quot;t_didian&quot;&nbsp;class=&quot;validate[required,maxSize[50]]&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;type2&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;è¯¾ç¨‹æ—¶é—´ï¼š&lt;/label&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;text&quot;&nbsp;name=&quot;t_shijian&quot;&nbsp;class=&quot;validate[required]&quot;&nbsp;onFocus=&quot;WdatePicker({lang:&#39;zh-cn&#39;,dateFmt:&#39;yyyy-M-d&nbsp;HH:mm:ss&#39;})&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;è¯¾ç¨‹æè¿°ï¼š&lt;/label&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;text&quot;&nbsp;name=&quot;t_desc&quot;&nbsp;class=&quot;validate[required,maxSize[500]]&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;type=&quot;submit&quot;&nbsp;class=&quot;tijiao-btn&nbsp;wd-fr&quot;&gt;æäº¤&lt;/button&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;id=&quot;form1&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;label&nbsp;for=&quot;&quot;&gt;ä¸Šä¼ è§†é¢‘åŒºï¼š&lt;/label&gt;&lt;input&nbsp;style=&quot;padding-left:&nbsp;10px;display:&nbsp;inline-block;width:&nbsp;600px;&quot;&nbsp;type=&quot;file&quot;&nbsp;name=&quot;uploadv&quot;&nbsp;id=&quot;uploadvideo&quot;&nbsp;accept=&quot;video/*&quot;&gt;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;progress&quot;&gt;&lt;div&nbsp;id=&quot;bar&quot;&gt;&lt;/div&gt;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;for=&quot;&quot;&gt;&lt;/label&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;type=&quot;button&quot;&nbsp;id=&quot;upload-vb&quot;&nbsp;class=&quot;tijiao-btn&quot;&gt;ä¸Šä¼ &lt;/button&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;am-modal&nbsp;am-modal-alert&quot;&nbsp;tabindex=&quot;-1&quot;&nbsp;id=&quot;my-alert&quot;&gt;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-modal-dialog&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-modal-hd&quot;&gt;çˆ±çš„æ¸©é¦¨æç¤º&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-modal-bd&quot;&nbsp;id=&quot;tips-text&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-modal-footer&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;am-modal-btn&quot;&gt;æˆ‘çŸ¥é“äº†&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&lt;/div&gt;&lt;/div&gt;&lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;src=&quot;/Skin/public/uploadify/jquery.uploadify.min.js&quot;&gt;&lt;/script&gt; &lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;charset=&quot;utf-8&quot;&nbsp;src=&quot;/Skin/public/ueditor/ueditor.config.js&quot;&gt;&lt;/script&gt;&lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;charset=&quot;utf-8&quot;&nbsp;src=&quot;/Skin/public/ueditor/ueditor.all.min.js&quot;&gt;&nbsp;&lt;/script&gt;&lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;charset=&quot;utf-8&quot;&nbsp;src=&quot;/Skin/public/ueditor/lang/zh-cn/zh-cn.js&quot;&gt;&lt;/script&gt;&lt;script&nbsp;type=&quot;text/javascript&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ue&nbsp;=&nbsp;UE.getEditor(&#39;editor&#39;,{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toolbars:[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&#39;bold&#39;,&nbsp;&#39;cleardoc&#39;,&nbsp;&#39;lineheight&#39;,&nbsp;&#39;|&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;customstyle&#39;,&nbsp;&#39;fontfamily&#39;,&nbsp;&#39;fontsize&#39;,&nbsp;&#39;|&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;justifyleft&#39;,&nbsp;&#39;justifycenter&#39;,&nbsp;&#39;justifyright&#39;,&nbsp;&#39;justifyjustify&#39;,&nbsp;&#39;|&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;imagenone&#39;,&nbsp;&#39;imageleft&#39;,&nbsp;&#39;imageright&#39;,&nbsp;&#39;imagecenter&#39;,&nbsp;&#39;insertimage&#39;,&#39;attachment&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;});&lt;/script&gt;&lt;script&nbsp;src=&quot;/Skin/public/My97datepicker/WdatePicker.js&quot;&nbsp;charset=&quot;utf-8&quot;&gt;&lt;/script&gt;&lt;script&gt;&nbsp;&nbsp;&nbsp;&nbsp;$(function(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#uploadvideo&#39;).on(&#39;change&#39;,function(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;filename&nbsp;=&nbsp;$(this).val();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;filetype&nbsp;=&nbsp;filename.substr(filename.lastIndexOf(&quot;.&quot;)).toLowerCase();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr&nbsp;=&nbsp;[&#39;.rmvb&#39;,&#39;.mp4&#39;,&#39;.mpeg&#39;,&#39;.wmv&#39;,&#39;.avi&#39;,&#39;.mov&#39;,&#39;.mpv&#39;,&#39;.png&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//console.log(arr.toString().indexOf(filetype))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(arr.toString().indexOf(filetype)&gt;-1){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#upload-vb&#39;).on(&#39;click&#39;,fsubmit);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#upload-vb&#39;).unbind(&#39;click&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(&#39;ä¸æ”¯æŒæ­¤æ ¼å¼ï¼Œè¯·ä¸Šä¼ &#39;+arr.join(&#39;,&#39;)+&#39;æ ¼å¼è§†é¢‘&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})&lt;script&gt;function&nbsp;fsubmit(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;data&nbsp;=&nbsp;new&nbsp;FormData($(&#39;#form1&#39;)[0]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.ajax({&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:&nbsp;&#39;{:U(&#39;Home/Qiniu/upload&#39;)}&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;&#39;POST&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;data,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataType:&nbsp;&#39;JSON&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cache:&nbsp;false,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processData:&nbsp;false,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contentType:&nbsp;false,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;beforeSend:&nbsp;function(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#progress&#39;).show()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xhr:&nbsp;function(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//è¿›åº¦æ¡&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;xhr&nbsp;=&nbsp;$.ajaxSettings.xhr();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xhr.upload.onprogress&nbsp;=&nbsp;function(progress)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(progress.lengthComputable)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jindu&nbsp;=&nbsp;(progress.loaded&nbsp;/&nbsp;progress.total&nbsp;&nbsp;100).toFixed(1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#bar&#39;).css(&#39;width&#39;,jindu2).html(jindu+&#39;%&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;xhr;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;function(data)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(data.status&nbsp;==&nbsp;1){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#t-video&#39;).val(data.video);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tips(&#39;ä¸Šä¼ æˆåŠŸï¼&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tips(data.info);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error:&nbsp;function(err){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tips(&#39;ä¸Šä¼ å¤±è´¥ï¼&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;&nbsp;}&lt;/script&gt;&lt;include&nbsp;file=&quot;./Tpl/foot&quot;&nbsp;/&gt;è¿™æ ·å°±å®Œæˆäº†ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå°‘èµ°å¼¯è·¯ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"makedown","slug":"makedown","date":"2016-11-08T01:07:08.000Z","updated":"2022-03-19T14:35:21.765Z","comments":true,"path":"2016/11/08/81/","link":"","permalink":"https://github.13sai.com/2016/11/08/81/","excerpt":"","text":"æœ€è¿‘æ£é¼“githubï¼Œå†™æ–‡æ¡£è¦ç”¨åˆ°makedownï¼Œä¾¿ç®€å•åœ°å­¦ä¹ äº†ä¸‹è¯­æ³•ï¼ŒçœŸçš„å¾ˆå¥½ç”¨ï¼Œæ•ˆæœä½³ï¼Œä¸Šæ‰‹å¿«ã€‚1. æ ‡é¢˜è®¾ç½®ï¼ˆè®©å­—ä½“å˜å¤§ï¼Œå’Œwordçš„æ ‡é¢˜æ„æ€ä¸€æ ·ï¼‰ åœ¨Markdownå½“ä¸­è®¾ç½®æ ‡é¢˜ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š ç¬¬ä¸€ç§ï¼šé€šè¿‡åœ¨æ–‡å­—ä¸‹æ–¹æ·»åŠ â€œ=â€å’Œâ€œ-â€ï¼Œä»–ä»¬åˆ†åˆ«è¡¨ç¤ºä¸€çº§æ ‡é¢˜å’ŒäºŒçº§æ ‡é¢˜ã€‚ ç¬¬äºŒç§ï¼šåœ¨æ–‡å­—å¼€å¤´åŠ ä¸Š â€œ#â€ï¼Œé€šè¿‡â€œ#â€æ•°é‡è¡¨ç¤ºå‡ çº§æ ‡é¢˜ã€‚ï¼ˆä¸€å…±åªæœ‰1~6çº§æ ‡é¢˜ï¼Œ1çº§æ ‡é¢˜å­—ä½“æœ€å¤§ï¼‰ 2. å—æ³¨é‡Šï¼ˆblockquoteï¼‰ é€šè¿‡åœ¨æ–‡å­—å¼€å¤´æ·»åŠ â€œ&gt;â€è¡¨ç¤ºå—æ³¨é‡Šã€‚ï¼ˆå½“&gt;å’Œæ–‡å­—ä¹‹é—´æ·»åŠ äº”ä¸ªblankæ—¶ï¼Œå—æ³¨é‡Šçš„æ–‡å­—ä¼šæœ‰å˜åŒ–ã€‚ï¼‰ 3. æ–œä½“ å°†éœ€è¦è®¾ç½®ä¸ºæ–œä½“çš„æ–‡å­—ä¸¤ç«¯ä½¿ç”¨1ä¸ªâ€œ*â€æˆ–è€…â€œ_â€å¤¹èµ·æ¥ 4. ç²—ä½“ å°†éœ€è¦è®¾ç½®ä¸ºæ–œä½“çš„æ–‡å­—ä¸¤ç«¯ä½¿ç”¨2ä¸ªâ€œ*â€æˆ–è€…â€œ_â€å¤¹èµ·æ¥ 5. æ— åºåˆ—è¡¨ åœ¨æ–‡å­—å¼€å¤´æ·»åŠ (*, +, and -)å®ç°æ— åºåˆ—è¡¨ã€‚ä½†æ˜¯è¦æ³¨æ„åœ¨(*, +, and -)å’Œæ–‡å­—ä¹‹é—´éœ€è¦æ·»åŠ ç©ºæ ¼ã€‚ï¼ˆå»ºè®®ï¼šä¸€ä¸ªæ–‡æ¡£ä¸­åªæ˜¯ç”¨ä¸€ç§æ— åºåˆ—è¡¨çš„è¡¨ç¤ºæ–¹å¼ï¼‰ 6. æœ‰åºåˆ—è¡¨ ä½¿ç”¨æ•°å­—åé¢è·Ÿä¸Šå¥å·ã€‚ï¼ˆè¿˜è¦æœ‰ç©ºæ ¼ï¼‰ 7. é“¾æ¥ï¼ˆLinksï¼‰ Markdownä¸­æœ‰ä¸¤ç§æ–¹å¼ï¼Œå®ç°é“¾æ¥ï¼Œåˆ†åˆ«ä¸ºå†…è”æ–¹å¼å’Œå¼•ç”¨æ–¹å¼ã€‚ å†…è”æ–¹å¼ï¼šThis is an [example link](http://example.com/).å¼•ç”¨æ–¹å¼ï¼šI get 10 times more traffic from [Google][1] than from [Yahoo][2] or [MSN][3]. &nbsp;[1]: http://google.com/ &nbsp; &nbsp; &nbsp; &nbsp;&quot;Google&quot; [2]: http://search.yahoo.com/ &nbsp;&quot;Yahoo Search&quot; [3]: http://search.msn.com/ &nbsp; &nbsp;&quot;MSN Search&quot;&nbsp;8. å›¾ç‰‡ï¼ˆImagesï¼‰ å›¾ç‰‡çš„å¤„ç†æ–¹å¼å’Œé“¾æ¥çš„å¤„ç†æ–¹å¼ï¼Œéå¸¸çš„ç±»ä¼¼ã€‚ å†…è”æ–¹å¼ï¼š![alt text](/path/to/img.jpg &quot;Title&quot;) å¼•ç”¨æ–¹å¼ï¼š ![alt text][id] &nbsp; &nbsp; [id]: /path/to/img.jpg &quot;Title&quot; &nbsp; 9. ä»£ç ï¼ˆHTMLä¸­æ‰€è°“çš„Codeï¼‰ å®ç°æ–¹å¼æœ‰ä¸¤ç§ï¼š ç¬¬ä¸€ç§ï¼šç®€å•æ–‡å­—å‡ºç°ä¸€ä¸ªä»£ç æ¡†ã€‚ä½¿ç”¨`&lt;blockquote&gt;`ã€‚ï¼ˆ`ä¸æ˜¯å•å¼•å·è€Œæ˜¯å·¦ä¸Šè§’çš„ESCä¸‹é¢~ä¸­çš„`ï¼‰ ç¬¬äºŒç§ï¼šå¤§ç‰‡æ–‡å­—éœ€è¦å®ç°ä»£ç æ¡†ã€‚ä½¿ç”¨Tabå’Œå››ä¸ªç©ºæ ¼ã€‚ &nbsp; 10. è„šæ³¨ï¼ˆfootnoteï¼‰ å®ç°æ–¹å¼å¦‚ä¸‹ï¼š hello[^hello] &nbsp; &nbsp; [^hello]: hi &nbsp; 11. ä¸‹åˆ’çº¿ åœ¨ç©ºç™½è¡Œä¸‹æ–¹æ·»åŠ ä¸‰æ¡â€œ-â€æ¨ªçº¿ã€‚ï¼ˆå‰é¢è®²è¿‡åœ¨æ–‡å­—ä¸‹æ–¹æ·»åŠ â€œ-â€ï¼Œå®ç°çš„2çº§æ ‡é¢˜ï¼‰12. æ’å…¥æºä»£ç ç”¨```åŒ…å«èµ·æ¥ã€‚æ¯”å¦‚æ’å…¥php```php &lt;?php echo&nbsp;1; ?&gt; ```æ˜¯ä¸æ˜¯å¤Ÿç®€æ´ï¼Œå†™å°è¯´æ–‡æ¡£è›®å¥½çš„ã€‚å¦å¤–æ¨èä¸€æ¬¾ç¼–è¾‘å™¨cmd makedownï¼Œå…¼å®¹å„ç§ç³»ç»Ÿï¼Œè™½ç„¶è§‰å¾—ä¸æ˜¯ç‰¹å¼ºå¤§ï¼Œä½†è¶³å¤Ÿæ—¥å¸¸ä½¿ç”¨ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"makedown","slug":"makedown","permalink":"https://github.13sai.com/tags/makedown/"}]},{"title":"jsä¹‹åŒ¿åå‡½æ•°ä¸é—­åŒ…","slug":"jsä¹‹åŒ¿åå‡½æ•°ä¸é—­åŒ…","date":"2016-10-23T01:47:21.000Z","updated":"2022-03-19T14:35:21.727Z","comments":true,"path":"2016/10/23/79/","link":"","permalink":"https://github.13sai.com/2016/10/23/79/","excerpt":"","text":"1ã€åŒ¿åå‡½æ•°ç®€å•è¯´å°±æ˜¯æ²¡æœ‰å‡½æ•°åçš„å‡½æ•°ã€‚åˆ›å»ºåŒ¿åå‡½æ•°ï¼š(function(x,&nbsp;y){&nbsp;&nbsp;&nbsp;&nbsp;alert(x&nbsp;+&nbsp;y);&nbsp;&nbsp;})(2,&nbsp;3);è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå‡½æ•°(åœ¨ç¬¬ä¸€ä¸ªæ‹¬å·å†…)ï¼Œç¬¬äºŒä¸ªæ‹¬å·ç”¨äºè°ƒç”¨è¯¥åŒ¿åå‡½æ•°ï¼Œå¹¶ä¼ å…¥å‚æ•°ã€‚æ¯”è¾ƒå…¸å‹çš„è¿˜æœ‰jqueryæºç ã€‚(function(&nbsp;window,&nbsp;undefined&nbsp;)&nbsp;{...})(&nbsp;window&nbsp;);æ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯è¿™ä¸¤ç§ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šæ–¹æ³•2ã€é—­åŒ…è¯´åˆ°åŒ¿åå‡½æ•°ï¼Œå°±ä¸å¾—ä¸è¯´è¯´é—­åŒ…ã€‚ä½¿ç”¨é—­åŒ…å¯ä»¥å¤§å¤§å‡å°‘æˆ‘ä»¬çš„ä»£ç é‡ï¼Œä½¿æˆ‘ä»¬çš„ä»£ç çœ‹ä¸Šå»æ›´åŠ æ¸…æ™°ç­‰ç­‰ï¼ŒåŠŸèƒ½ååˆ†å¼ºå¤§ã€‚é—­åŒ…çš„å«ä¹‰ï¼šè¯´ç™½äº†å°±æ˜¯å‡½æ•°çš„åµŒå¥—ï¼Œå†…å±‚çš„å‡½æ•°å¯ä»¥ä½¿ç”¨å¤–å±‚å‡½æ•°çš„æ‰€æœ‰å˜é‡ï¼Œå³ä½¿å¤–å±‚å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚function checkClosure(){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;var&nbsp;str&nbsp;=&nbsp;&#39;rain-man&#39;;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;setTimeout(function(){&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alert(str);&nbsp; &nbsp; &nbsp;}&nbsp;//è¿™æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;,&nbsp;2000);}checkClosure();è¿™ä¸ªä¾‹å­çœ‹ä¸Šå»ååˆ†çš„ç®€å•ï¼Œä»”ç»†åˆ†æä¸‹å®ƒçš„æ‰§è¡Œè¿‡ç¨‹è¿˜æ˜¯æœ‰è®¸å¤šçŸ¥è¯†ç‚¹çš„ï¼šcheckClosureå‡½æ•°çš„æ‰§è¡Œæ˜¯ç¬é—´çš„ï¼Œåœ¨checkClosureçš„å‡½æ•°ä½“å†…åˆ›å»ºäº†ä¸€ä¸ªå˜é‡strï¼Œåœ¨checkClosureæ‰§è¡Œå®Œæ¯•ä¹‹åstrå¹¶æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œè¿™æ˜¯å› ä¸º setTimeoutå†…çš„åŒ¿åå‡½æ•°å­˜åœ¨è¿™å¯¹strçš„å¼•ç”¨ã€‚å¾…åˆ°2ç§’åå‡½æ•°ä½“å†…çš„åŒ¿åå‡½æ•°è¢«æ‰§è¡Œå®Œæ¯•,stræ‰è¢«é‡Šæ”¾ã€‚function&nbsp;forTimeout(x,&nbsp;y){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;alert(x&nbsp;+&nbsp;y);}function&nbsp;delay(x&nbsp;,&nbsp;y&nbsp;&nbsp;,&nbsp;time){&nbsp;&nbsp;&nbsp;&nbsp; setTimeout(&#39;forTimeout(&#39;&nbsp;+&nbsp;&nbsp;x&nbsp;+&nbsp;&#39;,&#39;&nbsp;+&nbsp;&nbsp;y&nbsp;+&nbsp;&#39;)&#39;&nbsp;,&nbsp;time);&nbsp;&nbsp;&nbsp;&nbsp;}/* ä¸Šé¢çš„delayå‡½æ•°ååˆ†éš¾ä»¥é˜…è¯»ï¼Œä¹Ÿä¸å®¹æ˜“ç¼–å†™ï¼Œä½†å¦‚æœä½¿ç”¨é—­åŒ…å°±å¯ä»¥è®©ä»£ç æ›´åŠ æ¸…æ™°&nbsp;* /function&nbsp;delay(x&nbsp;,&nbsp;y&nbsp;,&nbsp;time){ &nbsp;&nbsp;&nbsp;setTimeout( function(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;forTimeout(x&nbsp;,&nbsp;y)&nbsp; &nbsp;&nbsp; },&nbsp;time);&nbsp;&nbsp;&nbsp;&nbsp;}é—­åŒ…çš„ä½œç”¨&nbsp;åœ¨äº†è§£é—­åŒ…çš„ä½œç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ javascriptä¸­çš„GCæœºåˆ¶:åœ¨javascriptä¸­ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ä¸å†è¢«å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±ä¼šè¢«GCå›æ”¶ï¼Œå¦åˆ™è¿™ä¸ªå¯¹è±¡ä¸€ç›´ä¼šä¿å­˜åœ¨å†…å­˜ä¸­ã€‚åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼ŒBå®šä¹‰åœ¨Aä¸­ï¼Œå› æ­¤Bä¾èµ–äºA,è€Œå¤–éƒ¨å˜é‡ c åˆå¼•ç”¨äº†B, æ‰€ä»¥Aé—´æ¥çš„è¢« c å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒAä¸ä¼šè¢«GCå›æ”¶ï¼Œä¼šä¸€ç›´ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚ä¸ºäº†è¯æ˜æˆ‘ä»¬çš„æ¨ç†ï¼Œä¸¾ä¾‹ï¼šfunction&nbsp;A(){&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;count&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;B(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(count);&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;B;}var&nbsp;c&nbsp;=&nbsp;A();c();//&nbsp;1c();//&nbsp;2c();//&nbsp;3countæ˜¯Aä¸­çš„ä¸€ä¸ªå˜é‡ï¼Œå®ƒçš„å€¼åœ¨Bä¸­è¢«æ”¹å˜ï¼Œå‡½æ•°Bæ¯æ‰§è¡Œä¸€æ¬¡ï¼Œcountçš„å€¼å°±åœ¨åŸæ¥çš„åŸºç¡€ä¸Šç´¯åŠ 1ã€‚å› æ­¤ï¼ŒAä¸­çš„countä¸€ç›´ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚è¿™å°±æ˜¯é—­åŒ…çš„ä½œç”¨ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¨¡å—ä¸­å®šä¹‰è¿™æ ·ä¸€ä¸ªå˜é‡ï¼šå¸Œæœ›è¿™ä¸ªå˜é‡ä¸€ç›´ä¿å­˜åœ¨å†…å­˜ä¸­ä½†åˆä¸ä¼šâ€œæ±¡æŸ“â€å…¨å±€çš„å˜é‡ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨é—­åŒ…æ¥å®šä¹‰è¿™ä¸ªæ¨¡å—ã€‚åŒ¿åå‡½æ•°æœ€å¤§çš„ç”¨é€”æ˜¯åˆ›å»ºé—­åŒ…ï¼ˆè¿™æ˜¯JavaScriptè¯­è¨€çš„ç‰¹æ€§ä¹‹ä¸€ï¼‰ï¼Œå¹¶ä¸”è¿˜å¯ä»¥æ„å»ºå‘½åç©ºé—´ï¼Œä»¥å‡å°‘å…¨å±€å˜é‡çš„ä½¿ç”¨ã€‚é«˜ç«¯å†™æ³•ä¸Šé¢çš„å†™æ³•å…¶å®æ˜¯æœ€ç®€å•æœ€åŸå§‹çš„å†™æ³•ï¼Œè€Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ²¡äººè¿™ä¹ˆç©ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸€äº›å¤§å‹JSæ¡†æ¶ä¸­æ›´ä¸ä¼šè¿™ä¹ˆå†™ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„demoç»„ä»¶ï¼š(function(document){ &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;viewport; &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;obj&nbsp;=&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;init:function(id){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;viewport&nbsp;=&nbsp;document.querySelector(&quot;#&quot;+id); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addChild:function(child){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;viewport.appendChild(child); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removeChild:function(child){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;viewport.removeChild(child); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;window.jView&nbsp;=&nbsp;obj; })(document);è¿™ä¸ªç»„ä»¶çš„ä½œç”¨æ˜¯ï¼šåˆå§‹åŒ–ä¸€ä¸ªå®¹å™¨ï¼Œç„¶åå¯ä»¥ç»™è¿™ä¸ªå®¹å™¨æ·»åŠ å­å®¹å™¨ï¼Œä¹Ÿå¯ä»¥ç§»é™¤ä¸€ä¸ªå®¹å™¨ã€‚åŠŸèƒ½å¾ˆç®€å•ï¼Œä½†è¿™é‡Œæ¶‰åŠåˆ°äº†å¦å¤–ä¸€ä¸ªæ¦‚å¿µï¼šç«‹å³æ‰§è¡Œå‡½æ•°ã€‚ ç®€å•äº†è§£ä¸€ä¸‹å°±è¡Œã€‚ä¸»è¦æ˜¯è¦ç†è§£è¿™ç§å†™æ³•æ˜¯æ€ä¹ˆå®ç°é—­åŒ…åŠŸèƒ½çš„ã€‚å¯ä»¥å°†ä¸Šé¢çš„ä»£ç ç»“æ„åˆ†æˆä¸¤éƒ¨åˆ†ï¼š(function(){}) å’Œ () , ç¬¬1ä¸ª()æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè€Œè¿™ä¸ªè¡¨è¾¾å¼æœ¬èº«æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªè¡¨è¾¾å¼åé¢åŠ ()å°±è¡¨ç¤ºæ‰§è¡Œè¿™ä¸ªåŒ¿åå‡½æ•°ã€‚å› æ­¤è¿™æ®µä»£ç æ‰§è¡Œæ‰§è¡Œè¿‡ç¨‹å¯ä»¥åˆ†è§£å¦‚ä¸‹ï¼švar&nbsp;fun =&nbsp;function(document){&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;viewport;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;obj&nbsp;=&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;init:function(id){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;viewport&nbsp;=&nbsp;document.querySelector(&quot;#&quot;+id);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addChild:function(child){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;viewport.appendChild(child);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removeChild:function(child){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;viewport.removeChild(child);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;window.jView&nbsp;=&nbsp;obj;};fun(document);åœ¨è¿™æ®µä»£ç ä¸­ä¼¼ä¹çœ‹åˆ°äº†é—­åŒ…çš„å½±å­ï¼Œä½† fun ä¸­æ²¡æœ‰ä»»ä½•è¿”å›å€¼ï¼Œä¼¼ä¹ä¸å…·å¤‡é—­åŒ…çš„æ¡ä»¶ï¼Œæ³¨æ„è¿™å¥ä»£ç ï¼šwindow.jView&nbsp;=&nbsp;obj;obj æ˜¯åœ¨ fun ä¸­å®šä¹‰çš„ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­å®šä¹‰äº†ä¸€ç³»åˆ—æ–¹æ³•ï¼Œ æ‰§è¡Œwindow.jView = obj å°±æ˜¯åœ¨ window å…¨å±€å¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªå˜é‡ jViewï¼Œå¹¶å°†è¿™ä¸ªå˜é‡æŒ‡å‘ obj å¯¹è±¡ï¼Œå³å…¨å±€å˜é‡ jView å¼•ç”¨äº† obj ã€‚è€Œ obj å¯¹è±¡ä¸­çš„å‡½æ•°åˆå¼•ç”¨äº† fun ä¸­çš„å˜é‡ viewport ,å› æ­¤ fun ä¸­çš„ viewport ä¸ä¼šè¢«GCå›æ”¶ï¼Œä¼šä¸€ç›´ä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥è¿™ç§å†™æ³•æ»¡è¶³é—­åŒ…çš„æ¡ä»¶ã€‚4ã€å†…å­˜æ³„éœ²ä½¿ç”¨é—­åŒ…ååˆ†å®¹æ˜“é€ æˆæµè§ˆå™¨çš„å†…å­˜æ³„éœ²ï¼Œæ‰€ä»¥åˆ‡å‹¿æ»¥ç”¨ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ç›¸å…³æ–‡ç« ï¼Œå¦‚JavaScriptä¹‹è¯¦è¿°é—­åŒ…å¯¼è‡´çš„å†…å­˜æ³„éœ²ã€‚å‚è€ƒï¼šè®©ä½ åˆ†åˆ†é’Ÿå­¦ä¼š javascript é—­åŒ…JavaScriptä¸­çš„åŒ¿åå‡½æ•°åŠå‡½æ•°çš„é—­åŒ…","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"jsæ­£åˆ™å‡½æ•°matchã€execã€testã€searchã€replaceã€split","slug":"jsæ­£åˆ™å‡½æ•°matchã€execã€testã€searchã€replaceã€split","date":"2016-10-19T04:33:20.000Z","updated":"2022-03-19T14:35:21.741Z","comments":true,"path":"2016/10/19/78/","link":"","permalink":"https://github.13sai.com/2016/10/19/78/","excerpt":"","text":"jsæ­£åˆ™å‡½æ•°testã€searchã€matchã€execã€replaceã€splitä½¿ç”¨ä»‹ç»:1.testtest() æ–¹æ³•ç”¨äºæ£€æµ‹ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…æŸä¸ªæ¨¡å¼.è¿”å›å€¼å¦‚æœå­—ç¬¦ä¸² string ä¸­å«æœ‰ä¸ RegExpObject åŒ¹é…çš„æ–‡æœ¬ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ä¾‹ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;000&quot;;var&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;; var&nbsp;pattern&nbsp;=&nbsp;/([a-z])(\\d)[a-z]/g; console.log(pattern.test(str1)); console.log(pattern.test(str2));2.searchsearch() æ–¹æ³•ç”¨äºæ£€ç´¢å­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­å­—ç¬¦ä¸²ï¼Œæˆ–æ£€ç´¢ä¸æ­£åˆ™è¡¨è¾¾å¼ç›¸åŒ¹é…çš„å­å­—ç¬¦ä¸²ã€‚è¿”å›å€¼stringObject ä¸­ç¬¬ä¸€ä¸ªä¸ regexp ç›¸åŒ¹é…çš„å­ä¸²çš„èµ·å§‹ä½ç½®ã€‚æ³¨é‡Šï¼šå¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•åŒ¹é…çš„å­ä¸²ï¼Œåˆ™è¿”å› -1ã€‚è¯´æ˜search() æ–¹æ³•ä¸æ‰§è¡Œå…¨å±€åŒ¹é…ï¼Œå®ƒå°†å¿½ç•¥æ ‡å¿— gã€‚å®ƒåŒæ—¶å¿½ç•¥ regexp çš„ lastIndex å±æ€§ï¼Œå¹¶ä¸”æ€»æ˜¯ä»å­—ç¬¦ä¸²çš„å¼€å§‹è¿›è¡Œæ£€ç´¢ï¼Œè¿™æ„å‘³ç€å®ƒæ€»æ˜¯è¿”å› stringObject çš„ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä½ç½®ã€‚ä¾‹ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;000&quot;; var&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;; var&nbsp;pattern&nbsp;=&nbsp;/([a-z])(\\d)[a-z]/g; console.log(str1.search(pattern)); console.log(str2.search(pattern));3.matchmatch() æ–¹æ³•å¯åœ¨å­—ç¬¦ä¸²å†…æ£€ç´¢æŒ‡å®šçš„å€¼ï¼Œæˆ–æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…ã€‚è¿”å›å€¼å­˜æ”¾åŒ¹é…ç»“æœçš„æ•°ç»„ã€‚è¯¥æ•°ç»„çš„å†…å®¹ä¾èµ–äº regexp æ˜¯å¦å…·æœ‰å…¨å±€æ ‡å¿— gã€‚è¯´æ˜match() æ–¹æ³•å°†æ£€ç´¢å­—ç¬¦ä¸² stringObjectï¼Œä»¥æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªä¸ regexp åŒ¹é…çš„æ–‡æœ¬ã€‚è¿™ä¸ªæ–¹æ³•çš„è¡Œä¸ºåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæœ‰èµ–äº regexp æ˜¯å¦å…·æœ‰æ ‡å¿— gã€‚å¦‚æœ regexp æ²¡æœ‰æ ‡å¿— gï¼Œé‚£ä¹ˆ match() æ–¹æ³•å°±åªèƒ½åœ¨ stringObject ä¸­æ‰§è¡Œä¸€æ¬¡åŒ¹é…ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•åŒ¹é…çš„æ–‡æœ¬ï¼Œ match() å°†è¿”å› nullã€‚å¦åˆ™ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­å­˜æ”¾äº†ä¸å®ƒæ‰¾åˆ°çš„åŒ¹é…æ–‡æœ¬æœ‰å…³çš„ä¿¡æ¯ã€‚è¯¥æ•°ç»„çš„ç¬¬ 0 ä¸ªå…ƒç´ å­˜æ”¾çš„æ˜¯åŒ¹é…æ–‡æœ¬ï¼Œè€Œå…¶ä½™çš„å…ƒç´ å­˜æ”¾çš„æ˜¯ä¸æ­£åˆ™è¡¨è¾¾å¼çš„å­è¡¨è¾¾å¼åŒ¹é…çš„æ–‡æœ¬ã€‚é™¤äº†è¿™äº›å¸¸è§„çš„æ•°ç»„å…ƒç´ ä¹‹å¤–ï¼Œè¿”å›çš„æ•°ç»„è¿˜å«æœ‰ä¸¤ä¸ªå¯¹è±¡å±æ€§ã€‚ index å±æ€§å£°æ˜çš„æ˜¯åŒ¹é…æ–‡æœ¬çš„èµ·å§‹å­—ç¬¦åœ¨ stringObject ä¸­çš„ä½ç½®ï¼Œinput å±æ€§å£°æ˜çš„æ˜¯å¯¹ stringObject çš„å¼•ç”¨ã€‚å¦‚æœ regexp å…·æœ‰æ ‡å¿— gï¼Œåˆ™ match() æ–¹æ³•å°†æ‰§è¡Œå…¨å±€æ£€ç´¢ï¼Œæ‰¾åˆ° stringObject ä¸­çš„æ‰€æœ‰åŒ¹é…å­å­—ç¬¦ä¸²ã€‚è‹¥æ²¡æœ‰æ‰¾åˆ°ä»»ä½•åŒ¹é…çš„å­ä¸²ï¼Œåˆ™è¿”å› nullã€‚å¦‚æœæ‰¾åˆ°äº†ä¸€ä¸ªæˆ–å¤šä¸ªåŒ¹é…å­ä¸²ï¼Œåˆ™è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚ä¸è¿‡å…¨å±€åŒ¹é…è¿”å›çš„æ•°ç»„çš„å†…å®¹ä¸å‰è€…å¤§ä¸ç›¸åŒï¼Œå®ƒçš„æ•°ç»„å…ƒç´ ä¸­å­˜æ”¾çš„æ˜¯ stringObject ä¸­æ‰€æœ‰çš„åŒ¹é…å­ä¸²ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰ index å±æ€§æˆ– input å±æ€§ã€‚ä¾‹ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;000&quot;; var&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;; var&nbsp;pattern&nbsp;=&nbsp;/([a-z])(\\d)[a-z]/g; console.log(str1.match(pattern));console.log(str2.match(pattern));æ³¨æ„ï¼šåœ¨å…¨å±€æ£€ç´¢æ¨¡å¼ä¸‹ï¼Œmatch() å³ä¸æä¾›ä¸å­è¡¨è¾¾å¼åŒ¹é…çš„æ–‡æœ¬çš„ä¿¡æ¯ï¼Œä¹Ÿä¸å£°æ˜æ¯ä¸ªåŒ¹é…å­ä¸²çš„ä½ç½®ã€‚å¦‚æœæ‚¨éœ€è¦è¿™äº›å…¨å±€æ£€ç´¢çš„ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢ä»‹ç»çš„exec()ã€‚4.execexec() æ–¹æ³•ç”¨äºæ£€ç´¢å­—ç¬¦ä¸²ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…ã€‚è¿”å›å€¼è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­å­˜æ”¾åŒ¹é…çš„ç»“æœã€‚å¦‚æœæœªæ‰¾åˆ°åŒ¹é…ï¼Œåˆ™è¿”å›å€¼ä¸º nullã€‚è¯´æ˜exec() æ–¹æ³•çš„åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå®ƒæ˜¯ä¸€ä¸ªé€šç”¨çš„æ–¹æ³•ï¼Œè€Œä¸”ä½¿ç”¨èµ·æ¥ä¹Ÿæ¯” test() æ–¹æ³•ä»¥åŠæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼çš„ String å¯¹è±¡çš„æ–¹æ³•æ›´ä¸ºå¤æ‚ã€‚å¦‚æœ exec() æ‰¾åˆ°äº†åŒ¹é…çš„æ–‡æœ¬ï¼Œåˆ™è¿”å›ä¸€ä¸ªç»“æœæ•°ç»„ã€‚å¦åˆ™ï¼Œè¿”å› nullã€‚æ­¤æ•°ç»„çš„ç¬¬ 0 ä¸ªå…ƒç´ æ˜¯ä¸æ­£åˆ™è¡¨è¾¾å¼ç›¸åŒ¹é…çš„æ–‡æœ¬ï¼Œç¬¬ 1 ä¸ªå…ƒç´ æ˜¯ä¸ RegExpObject çš„ç¬¬ 1 ä¸ªå­è¡¨è¾¾å¼ç›¸åŒ¹é…çš„æ–‡æœ¬ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œç¬¬ 2 ä¸ªå…ƒç´ æ˜¯ä¸ RegExpObject çš„ç¬¬ 2 ä¸ªå­è¡¨è¾¾å¼ç›¸åŒ¹é…çš„æ–‡æœ¬ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œä»¥æ­¤ç±»æ¨ã€‚é™¤äº†æ•°ç»„å…ƒç´ å’Œ length å±æ€§ä¹‹å¤–ï¼Œexec() æ–¹æ³•è¿˜è¿”å›ä¸¤ä¸ªå±æ€§ã€‚index å±æ€§å£°æ˜çš„æ˜¯åŒ¹é…æ–‡æœ¬çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®ã€‚input å±æ€§åˆ™å­˜æ”¾çš„æ˜¯è¢«æ£€ç´¢çš„å­—ç¬¦ä¸² stringã€‚æˆ‘ä»¬å¯ä»¥çœ‹å¾—å‡ºï¼Œåœ¨è°ƒç”¨éå…¨å±€çš„ RegExp å¯¹è±¡çš„ exec() æ–¹æ³•æ—¶ï¼Œè¿”å›çš„æ•°ç»„ä¸è°ƒç”¨æ–¹æ³• String.match() è¿”å›çš„æ•°ç»„æ˜¯ç›¸åŒçš„ã€‚ä½†æ˜¯ï¼Œå½“ RegExpObject æ˜¯ä¸€ä¸ªå…¨å±€æ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œexec() çš„è¡Œä¸ºå°±ç¨å¾®å¤æ‚ä¸€äº›ã€‚å®ƒä¼šåœ¨ RegExpObject çš„ lastIndex å±æ€§æŒ‡å®šçš„å­—ç¬¦å¤„å¼€å§‹æ£€ç´¢å­—ç¬¦ä¸² stringã€‚å½“ exec() æ‰¾åˆ°äº†ä¸è¡¨è¾¾å¼ç›¸åŒ¹é…çš„æ–‡æœ¬æ—¶ï¼Œåœ¨åŒ¹é…åï¼Œå®ƒå°†æŠŠ RegExpObject çš„ lastIndex å±æ€§è®¾ç½®ä¸ºåŒ¹é…æ–‡æœ¬çš„æœ€åä¸€ä¸ªå­—ç¬¦çš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚è¿™å°±æ˜¯è¯´ï¼Œæ‚¨å¯ä»¥é€šè¿‡åå¤è°ƒç”¨ exec() æ–¹æ³•æ¥éå†å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰åŒ¹é…æ–‡æœ¬ã€‚å½“ exec() å†ä¹Ÿæ‰¾ä¸åˆ°åŒ¹é…çš„æ–‡æœ¬æ—¶ï¼Œå®ƒå°†è¿”å› nullï¼Œå¹¶æŠŠ lastIndex å±æ€§é‡ç½®ä¸º 0ã€‚æç¤ºå’Œæ³¨é‡Šé‡è¦äº‹é¡¹ï¼šå¦‚æœåœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­å®Œæˆäº†ä¸€æ¬¡æ¨¡å¼åŒ¹é…ä¹‹åè¦å¼€å§‹æ£€ç´¢æ–°çš„å­—ç¬¦ä¸²ï¼Œå°±å¿…é¡»æ‰‹åŠ¨åœ°æŠŠ lastIndex å±æ€§é‡ç½®ä¸º 0ã€‚æœ‰æ²¡æœ‰çœ‹æ™•ï¼Œå“ˆå“ˆï¼Œè¿˜æ˜¯çœ‹ä¾‹å­å§ï¼ä¾‹1ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;000&quot;;var&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;;var&nbsp;pattern&nbsp;=&nbsp;/([a-z])(\\d)[a-z]/g; console.log(pattern.exec(str2));console.log(pattern.exec(str2));ä¾‹2ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;000&quot;;var&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;;var&nbsp;pattern&nbsp;=&nbsp;/([a-z])(\\d)[a-z]/g; while&nbsp;((result2&nbsp;=&nbsp;pattern.exec(str2))&nbsp;!=&nbsp;null)&nbsp;&nbsp;{console.log(result2);console.log(result2.index);console.log(pattern.lastIndex);}5.replacereplace() æ–¹æ³•ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­ç”¨ä¸€äº›å­—ç¬¦æ›¿æ¢å¦ä¸€äº›å­—ç¬¦ï¼Œæˆ–æ›¿æ¢ä¸€ä¸ªä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­ä¸²ã€‚è¿”å›å€¼ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œæ˜¯ç”¨ replacement æ›¿æ¢äº† regexp çš„ç¬¬ä¸€æ¬¡åŒ¹é…æˆ–æ‰€æœ‰åŒ¹é…ä¹‹åå¾—åˆ°çš„ã€‚è¯´æ˜å­—ç¬¦ä¸² stringObject çš„ replace() æ–¹æ³•æ‰§è¡Œçš„æ˜¯æŸ¥æ‰¾å¹¶æ›¿æ¢çš„æ“ä½œã€‚å®ƒå°†åœ¨ stringObject ä¸­æŸ¥æ‰¾ä¸ regexp ç›¸åŒ¹é…çš„å­å­—ç¬¦ä¸²ï¼Œç„¶åç”¨ replacement æ¥æ›¿æ¢è¿™äº›å­ä¸²ã€‚å¦‚æœ regexp å…·æœ‰å…¨å±€æ ‡å¿— gï¼Œé‚£ä¹ˆ replace() æ–¹æ³•å°†æ›¿æ¢æ‰€æœ‰åŒ¹é…çš„å­ä¸²ã€‚å¦åˆ™ï¼Œå®ƒåªæ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…å­ä¸²ã€‚replacement å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡½æ•°ã€‚å¦‚æœå®ƒæ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæ¯ä¸ªåŒ¹é…éƒ½å°†ç”±å­—ç¬¦ä¸²æ›¿æ¢ã€‚ä½†æ˜¯ replacement ä¸­çš„ $ å­—ç¬¦å…·æœ‰ç‰¹å®šçš„å«ä¹‰ã€‚å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œå®ƒè¯´æ˜ä»æ¨¡å¼åŒ¹é…å¾—åˆ°çš„å­—ç¬¦ä¸²å°†ç”¨äºæ›¿æ¢ã€‚ä¾‹1ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;000&quot;;var&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;;var&nbsp;pattern&nbsp;=&nbsp;/([a-z])(\\d)[a-z]/g; console.log(str2);console.log(str2.replace(pattern,&#39;s&#39;));console.log(str2.replace(pattern,&#39;$1&#39;));ä¾‹2ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;000&quot;;var&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;;var&nbsp;pattern&nbsp;=&nbsp;/([a-z])(\\d)[a-z]/g; console.log(str2);console.log(str2.replace(pattern,function(match,$1,index,origin){ console.log(index) console.log(match) return&nbsp;$1;}));[object&nbsp;Object]ä¾‹3ï¼švar&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;;var&nbsp;pattern&nbsp;=&nbsp;/([a-z])(\\d)[a-z]/g; console.log(str2);console.log(str2.replace(pattern,function(match,group1,group2,index,origin){ console.log(index) console.log(match) num&nbsp;=&nbsp;parseInt(group2);&nbsp;+&nbsp;1; return&nbsp;group1&nbsp;+&nbsp;num;}));6.splitsplit() æ–¹æ³•ç”¨äºæŠŠä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„ã€‚è¿”å›å€¼ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚è¯¥æ•°ç»„æ˜¯é€šè¿‡åœ¨ separator æŒ‡å®šçš„è¾¹ç•Œå¤„å°†å­—ç¬¦ä¸² stringObject åˆ†å‰²æˆå­ä¸²åˆ›å»ºçš„ã€‚è¿”å›çš„æ•°ç»„ä¸­çš„å­—ä¸²ä¸åŒ…æ‹¬ separator è‡ªèº«ã€‚ä½†æ˜¯ï¼Œå¦‚æœ separator æ˜¯åŒ…å«å­è¡¨è¾¾å¼çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆè¿”å›çš„æ•°ç»„ä¸­åŒ…æ‹¬ä¸è¿™äº›å­è¡¨è¾¾å¼åŒ¹é…çš„å­—ä¸²ï¼ˆä½†ä¸åŒ…æ‹¬ä¸æ•´ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ–‡æœ¬ï¼‰ã€‚ä¾‹1ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;000&quot;;var&nbsp;str2&nbsp;=&nbsp;&quot;a,b,c,d&quot;; console.log(str2);console.log(str2.split(&#39;,&#39;));ä¾‹2ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;000&quot;;var&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;;var&nbsp;pattern&nbsp;=&nbsp;/[a-z]\\d[a-z]/g; console.log(str2);console.log(str2.split(pattern));æœ€åæ¥çœ‹ä¸ªæœ‰è¶£çš„ï¼Œä¾‹3ï¼švar&nbsp;str1&nbsp;=&nbsp;&quot;a,b,c,d&quot;;var&nbsp;str2&nbsp;=&nbsp;&quot;0a2b3c4d5e&quot;;var&nbsp;pattern5&nbsp;=&nbsp;/\\d/g;var&nbsp;pattern&nbsp;=&nbsp;/[a-z]\\d[a-z]/g;var&nbsp;pattern1&nbsp;=&nbsp;/([a-z])\\d[a-z]/g;var&nbsp;pattern2&nbsp;=&nbsp;/[a-z]\\d([a-z])/g;var&nbsp;pattern3&nbsp;=&nbsp;/([a-z])(\\d)[a-z]/g;var&nbsp;pattern4&nbsp;=&nbsp;/([a-z])(\\d)([a-z])/g;var&nbsp;pattern5&nbsp;=&nbsp;/([a-z]\\d[a-z])/g; console.log(str2);console.log(str1.split(&#39;,&#39;,2));console.log(str2.split(pattern));console.log(str2.split(pattern1));console.log(str2.split(pattern2));console.log(str2.split(pattern3));console.log(str2.split(pattern4));console.log(str2.split(pattern5));splitç¬¬äºŒä¸ªå‚æ•°æ˜¯é™åˆ¶æ•°ç»„é•¿åº¦ï¼Œè€Œæ­£åˆ™å¦‚æœä½¿ç”¨äº†groupï¼ˆä¹Ÿå°±æ˜¯å°æ‹¬å·ï¼‰ï¼Œè¿”å›æ•°ç»„ä¹Ÿä¼šæŠŠgroupé‡Œçš„å­—ç¬¦åŒ…å«è¿›å»ã€‚å¥½äº†ï¼Œæ˜¯ä¸æ˜¯å¯¹è¿™äº›å‡½æ•°æœ‰æ›´æ·±çš„ç†è§£ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"clickäº‹ä»¶è§¦å‘äº†ä¸¤æ¬¡äº‹ä»¶","slug":"clickäº‹ä»¶è§¦å‘äº†ä¸¤æ¬¡äº‹ä»¶","date":"2016-10-12T06:12:42.000Z","updated":"2022-03-19T14:35:21.663Z","comments":true,"path":"2016/10/12/77/","link":"","permalink":"https://github.13sai.com/2016/10/12/77/","excerpt":"","text":"ä¹‹å‰é‡åˆ°è¿‡clickäº‹ä»¶è§¦å‘äº†ä¸¤æ¬¡alertï¼Œä¸æ˜åŸå› ï¼Œè¿‘å‡ å¤©åˆæƒ³èµ·è¿™äº‹ï¼Œè¾¹æŸ¥æŸ¥ï¼Œå¼€æ”¾æ€§é—®é¢˜ï¼Œå…¶å®æˆ‘è¿˜ä¸æ˜¯å¾ˆæ˜ç™½ã€‚ç›´æ¥ä¸Šç½‘å‹çš„ä¾‹å­ã€‚&lt;!doctype&nbsp;html&gt; &lt;html&gt; &lt;head&gt; &lt;meta&nbsp;charset=&quot;utf-8&quot;&gt; &lt;title&gt;test&lt;/title&gt; &lt;script&nbsp;src=&quot;http://cdn.bootcss.com/jquery/2.1.4/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;style&gt; .toggle&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;margin:4px; &nbsp;&nbsp;&nbsp;&nbsp;background-color:#EFEFEF; &nbsp;&nbsp;&nbsp;&nbsp;border-radius:4px; &nbsp;&nbsp;&nbsp;&nbsp;border:1px&nbsp;solid&nbsp;#D0D0D0; &nbsp;&nbsp;&nbsp;&nbsp;overflow:auto; &nbsp;&nbsp;&nbsp;&nbsp;float:left; } .toggle&nbsp;label&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;/*float:left;*/ &nbsp;&nbsp;&nbsp;&nbsp;width:4.0em; &nbsp;&nbsp;&nbsp;&nbsp;position:&nbsp;relative; } .toggle&nbsp;label&nbsp;span&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;text-align:center;&nbsp;&nbsp;&nbsp;&nbsp;padding:3px;&nbsp;&nbsp;&nbsp;&nbsp;display:block;&nbsp;&nbsp;&nbsp;&nbsp;cursor:&nbsp;pointer;} .toggle&nbsp;label&nbsp;input&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;position:absolute;&nbsp;&nbsp;&nbsp;&nbsp;top:-20px;} .toggle&nbsp;.input-checked&nbsp;/,&nbsp;.bounds&nbsp;input:checked&nbsp;+&nbsp;span&nbsp;works&nbsp;for&nbsp;firefox&nbsp;and&nbsp;ie9&nbsp;but&nbsp;breaks&nbsp;js&nbsp;for&nbsp;ie8(ONLY)&nbsp;/&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;background-color:#404040;&nbsp;&nbsp;&nbsp;&nbsp;color:#F7F7F7;} .toggle&nbsp;input:checked&nbsp;+&nbsp;span&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;background-color:#404040;&nbsp;&nbsp;&nbsp;&nbsp;color:#F7F7F7;} &lt;/style&gt;&lt;/head&gt; &lt;body&gt; &lt;div&nbsp;class=&quot;toggle&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;&lt;input&nbsp;type=&quot;radio&quot;&nbsp;name=&quot;toggle&quot;&nbsp;value=&quot;1&quot;&gt;&lt;span&gt;radio1&lt;/span&gt;&lt;/label&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;div&nbsp;class=&quot;toggle&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;&lt;input&nbsp;type=&quot;radio&quot;&nbsp;name=&quot;toggle&quot;&nbsp;value=&quot;2&quot;&gt;&lt;span&gt;radio2&lt;/span&gt;&lt;/label&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;toggle&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;&lt;input&nbsp;type=&quot;radio&quot;&nbsp;name=&quot;toggle&quot;&nbsp;value=&quot;3&quot;&gt;&lt;span&gt;radio3&lt;/span&gt;&lt;/label&gt;&lt;/div&gt; &lt;/body&gt;&lt;/html&gt;&lt;script&gt;$(&#39;label&#39;).click(function(){&nbsp;&nbsp;&nbsp;&nbsp;$(this).children(&#39;span&#39;).addClass(&#39;input-checked&#39;);&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;value&nbsp;=&nbsp;$(this).children(&#39;input&#39;).val();&nbsp;&nbsp;&nbsp;&nbsp;$(this).parent(&#39;.toggle&#39;).siblings(&#39;.toggle&#39;).children(&#39;label&#39;).children(&#39;span&#39;).removeClass(&#39;input-checked&#39;);&nbsp;&nbsp;&nbsp;&nbsp;console.log(value);});&lt;/script&gt;æœ‰ç½‘å‹æ”¹äº†ä¸‹js$(&#39;label&#39;).click(function(event){&nbsp;&nbsp;&nbsp;&nbsp;$(this).children(&#39;span&#39;).addClass(&#39;input-checked&#39;);&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;value&nbsp;=&nbsp;$(this).children(&#39;input&#39;).val();&nbsp;&nbsp;&nbsp;&nbsp;$(this).parent(&#39;.toggle&#39;).siblings(&#39;.toggle&#39;).children(&#39;label&#39;).children(&#39;span&#39;).removeClass(&#39;input-checked&#39;);&nbsp;&nbsp;&nbsp;&nbsp;console.log(value);&nbsp;&nbsp;&nbsp;&nbsp;//return&nbsp;false});event.target.typeä¸»è¦æ˜¯è¿™ä¸ªä¼šè§¦å‘ä¸¤ä¸ªä¸€ä¸ªæ˜¯undefinedä¸€ä¸ªæ˜¯radioã€‚å› ä¸ºlabelå…³è”çš„radioä¹Ÿè¢«æœ‰ä¸€ä¸ªå…³è”æ“ä½œã€‚å½“labelè¢«ç‚¹å‡»æ—¶ï¼Œé»˜è®¤radioä¹Ÿè¢«ç‚¹å‡»äº†ä¸€æ¬¡ã€‚è§£å†³æ–¹æ³•ä½ å¯ä»¥$(&#39;span&#39;).click(function&nbsp;()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;i&nbsp;=&nbsp;$(&#39;span&#39;).index($(this));&nbsp;&nbsp;&nbsp;&nbsp;$(this).addClass(&#39;input-checked&#39;);&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;value&nbsp;=&nbsp;$(&#39;input&#39;).eq(i).val();&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;span&#39;).not($(this)).removeClass(&#39;input-checked&#39;);&nbsp;&nbsp;&nbsp;&nbsp;console.log(value);})å¦ä¸€å‹äººï¼šä¿®æ”¹css.toggle&nbsp;label&nbsp;input&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;position:absolute;&nbsp;&nbsp;&nbsp;&nbsp;top:0px;&nbsp;&nbsp;&nbsp;&nbsp;left:&nbsp;0px;&nbsp;&nbsp;&nbsp;&nbsp;width:50px;&nbsp;&nbsp;&nbsp;&nbsp;height:&nbsp;20px;&nbsp;&nbsp;&nbsp;&nbsp;z-index:&nbsp;9999;&nbsp;&nbsp;&nbsp;&nbsp;opacity:&nbsp;0;}è§£å†³é—®é¢˜ï¼Œä½†æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä½ èƒ½å‘Šè¯‰æˆ‘ä¹ˆï¼Ÿè¿˜æœ‰åœ¨jsååŠ ä¸Šreturn falseå¤ªé˜³è§£å†³é—®é¢˜ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"background-imageçš„urlå±æ€§ä¸ºç©º","slug":"background-imageçš„urlå±æ€§ä¸ºç©º","date":"2016-10-11T01:16:34.000Z","updated":"2022-03-19T14:35:21.659Z","comments":true,"path":"2016/10/11/76/","link":"","permalink":"https://github.13sai.com/2016/10/11/76/","excerpt":"","text":"å‰å¤©åŒäº‹å¼€å‘æ—¶ï¼Œé‡åˆ°ä¸€ä¸ªè¯¡å¼‚çš„é—®é¢˜ï¼Œæ¯æ¬¡åˆ·æ–°é¡µé¢ï¼Œæµè§ˆé‡ä¼šåŠ 2ï¼Œè€Œä¸æ˜¯æƒ³è¦çš„åŠ 1ã€‚ æ£€æŸ¥äº†ä»£ç æ§åˆ¶å™¨ï¼Œæ²¡æœ‰ä¸æ¯«é—®é¢˜ï¼Œä¸Šæ¬¡å‡ºç°æµè§ˆé‡ä¼šåŠ 2çš„æƒ…å†µæ˜¯å› ä¸ºå¤šå†™äº†ä¸€æ¬¡displayï¼Œåªèƒ½å»å¤´å»å°¾ï¼Œä¸€éƒ¨åˆ†ä¸€éƒ¨åˆ†æ’æŸ¥ï¼Œæœ€åå‘ç°æ˜¯å¤´éƒ¨ç”¨äº†ä¸ªbackgroundï¼Œé‡Œé¢çš„urlæ˜¯ç©ºå€¼ï¼Œå»æ‰ï¼Œæ­£å¸¸ã€‚ åˆšæŸ¥äº†ä¸‹ç½‘ä¸Šç¡®å®æœ‰å‡ºç°background-imageçš„urlå±æ€§ä¸ºç©ºå¯¼è‡´äºŒæ¬¡æäº¤çš„æƒ…å†µï¼ŒåŒäº‹å‡ºç°æµè§ˆé‡åŠ 2ä¹Ÿæ˜¯å› æ­¤å¯¼è‡´ã€‚ è¯´æ˜ï¼š æ”¹å˜ä»£ç ä¹ æƒ¯ã€‚ä¸¥ç¦ä»£ç ä¸­ï¼Œurl/href/src å€¼ä¸ºç©ºæˆ– # . è¿™åº”è¯¥æ˜¯ç›®å‰æœ€å¥½çš„ä¸€ç§æ–¹å¼ã€‚ é¿å…ç©ºé“¾æ¥å±æ€§ç©ºçš„é“¾æ¥å±æ€§æ˜¯æŒ‡imgã€linkã€scriptã€ifrrameå…ƒç´ çš„srcæˆ–hrefå±æ€§è¢«è®¾ç½®äº†ï¼Œä½†æ˜¯å±æ€§å´ä¸ºç©ºã€‚æ—©äº›ç‰ˆæœ¬çš„Webkitå†…æ ¸æµè§ˆå™¨ ä¸Firefox ä¼šæŠŠç©ºåœ°å€è§£æä¸ºå½“å‰é¡µé¢çš„åœ°å€ã€‚å¦‚æœé¡µé¢å†…æœ‰å¤šä¸ªç©ºé“¾æ¥å±æ€§å…ƒç´ ï¼Œå½“å‰é¡µé¢çš„æœåŠ¡å™¨åˆ™ä¼šè¢«è¯·æ±‚å¤šæ¬¡ï¼Œå¢åŠ æœåŠ¡å™¨çš„è´Ÿè½½ã€‚ç›¸è¾ƒæ¡Œé¢æµè§ˆå™¨å¯¹å†…æ ¸çš„æ›´æ–°å‡çº§è¾ƒç§¯æï¼Œè¿™ä¸ªé—®é¢˜åœ¨ç§»åŠ¨æµè§ˆå™¨ä¸Šé—®é¢˜å¯èƒ½è¾ƒä¸¥é‡ã€‚ å¹¸è¿çš„æ˜¯æ‰€æœ‰ä¸»æµæµè§ˆå™¨é¢å¯¹iframeçš„srcå±æ€§ä¸ºç©ºæ—¶ï¼Œä¼šæŠŠç©ºåœ°å€è§£æä¸ºabout:blankåœ°å€ï¼Œè€Œä¸ä¼šå‘æœåŠ¡å™¨å‘å‡ºé¢å¤–çš„è¯·æ±‚ã€‚å› æ­¤é“¾æ¥é¿å…ä¸äº†å‡ºç°ç©ºçš„æƒ…å†µï¼Œå¯ä»¥ç”¨aboutï¼šblankæ¥ä»£æ›¿ç©ºçš„æƒ…å†µã€‚ è´´ä¸Šæ–‡ç« : ç©ºè·¯å¾„å¯¹é¡µé¢æ€§èƒ½çš„å½±å“","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"html","slug":"html","permalink":"https://github.13sai.com/tags/html/"}]},{"title":"åˆè§BOM","slug":"åˆè§BOM","date":"2016-09-27T05:35:53.000Z","updated":"2022-03-19T14:35:21.896Z","comments":true,"path":"2016/09/27/75/","link":"","permalink":"https://github.13sai.com/2016/09/27/75/","excerpt":"","text":"ä¹‹å‰å†™è¿‡BOMçš„é—®é¢˜ï¼Œä»Šå¤©åˆä¸€æ¬¡é‡è§ã€‚è¿›å…¥åå°ï¼ŒéªŒè¯ç ä¸æ˜¾ç¤ºï¼Œå„ç§æŸ¥æ‰¾ï¼Œæ‰¾ä¸åˆ°åŸå› ï¼Œçº³é—·ï¼Œç„¶ååŒäº‹ä¿®æ”¹äº†å…¥å£æ–‡ä»¶ç¼–ç æ ¼å¼ä¸ºä¸åŠ BOMï¼Œè§£å†³é—®é¢˜ã€‚BOM â€”â€” Byte Order Markï¼Œä¸­æ–‡åè¯‘ä½œâ€œå­—èŠ‚é¡ºåºæ ‡è®°â€ã€‚åœ¨è¿™é‡Œæ‰¾åˆ°ä¸€æ®µå…³äº BOM çš„è¯´æ˜ï¼šåœ¨UCS ç¼–ç ä¸­æœ‰ä¸€ä¸ªå«åš &quot;Zero Width No-Break Space&quot; ï¼Œä¸­æ–‡è¯‘åä½œâ€œé›¶å®½æ— é—´æ–­é—´éš”â€çš„å­—ç¬¦ï¼Œå®ƒçš„ç¼–ç æ˜¯ FEFFã€‚è€Œ FFFE åœ¨ UCS ä¸­æ˜¯ä¸å­˜åœ¨çš„å­—ç¬¦ï¼Œæ‰€ä»¥ä¸åº”è¯¥å‡ºç°åœ¨å®é™…ä¼ è¾“ä¸­ã€‚UCS è§„èŒƒå»ºè®®æˆ‘ä»¬åœ¨ä¼ è¾“å­—èŠ‚æµå‰ï¼Œå…ˆä¼ è¾“å­—ç¬¦ &quot;Zero Width No-Break Space&quot;ã€‚è¿™æ ·å¦‚æœæ¥æ”¶è€…æ”¶åˆ° FEFFï¼Œå°±è¡¨æ˜è¿™ä¸ªå­—èŠ‚æµæ˜¯ Big-Endian çš„ï¼›å¦‚æœæ”¶åˆ°FFFEï¼Œå°±è¡¨æ˜è¿™ä¸ªå­—èŠ‚æµæ˜¯ Little- Endian çš„ã€‚å› æ­¤å­—ç¬¦ &quot;Zero Width No-Break Space&quot; ï¼ˆé›¶å®½æ— é—´æ–­é—´éš”ï¼‰åˆè¢«ç§°ä½œ BOMã€‚UTF-8 ä¸éœ€è¦ BOM æ¥è¡¨æ˜å­—èŠ‚é¡ºåºï¼Œä½†å¯ä»¥ç”¨ BOM æ¥è¡¨æ˜ç¼–ç æ–¹å¼ã€‚å­—ç¬¦ &quot;Zero Width No-Break Space&quot; çš„ UTF-8 ç¼–ç æ˜¯ EF BB BFã€‚æ‰€ä»¥å¦‚æœæ¥æ”¶è€…æ”¶åˆ°ä»¥ EF BB BF å¼€å¤´çš„å­—èŠ‚æµï¼Œå°±çŸ¥é“è¿™æ˜¯ UTF-8ç¼–ç äº†ã€‚Windows å°±æ˜¯ä½¿ç”¨ BOM æ¥æ ‡è®°æ–‡æœ¬æ–‡ä»¶çš„ç¼–ç æ–¹å¼çš„ã€‚å­—ç¬¦U+FEFFå¦‚æœå‡ºç°åœ¨å­—èŠ‚æµçš„å¼€å¤´ï¼Œåˆ™ç”¨æ¥æ ‡è¯†è¯¥å­—èŠ‚æµçš„å­—èŠ‚åºï¼Œæ˜¯é«˜ä½åœ¨å‰è¿˜æ˜¯ä½ä½åœ¨å‰ã€‚å¦‚æœå®ƒå‡ºç°åœ¨å­—èŠ‚æµçš„ä¸­é—´ï¼Œåˆ™è¡¨è¾¾é›¶å®½åº¦éæ¢è¡Œç©ºæ ¼çš„æ„ä¹‰ï¼Œç”¨æˆ·çœ‹èµ·æ¥å°±æ˜¯ä¸€ä¸ªç©ºæ ¼ã€‚ä»Unicode3.2å¼€å§‹ï¼ŒU+FEFFåªèƒ½å‡ºç°åœ¨å­—èŠ‚æµçš„å¼€å¤´ï¼Œåªèƒ½ç”¨äºæ ‡è¯†å­—èŠ‚åºï¼Œå°±å¦‚å®ƒçš„åç§°â€”â€”å­—èŠ‚åºæ ‡è®°â€”â€”æ‰€è¡¨ç¤ºçš„ä¸€æ ·ï¼›é™¤æ­¤ä»¥å¤–çš„ç”¨æ³•å·²è¢«èˆå¼ƒã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œä½¿ç”¨U+2060æ¥è¡¨è¾¾é›¶å®½åº¦æ— æ–­ç©ºç™½ã€‚ç±»ä¼¼WINDOWSè‡ªå¸¦çš„è®°äº‹æœ¬ç­‰è½¯ä»¶ï¼Œåœ¨ä¿å­˜ä¸€ä¸ªä»¥UTF-8ç¼–ç çš„æ–‡ä»¶æ—¶ï¼Œä¼šåœ¨æ–‡ä»¶å¼€å§‹çš„åœ°æ–¹æ’å…¥ä¸‰ä¸ªä¸å¯è§çš„å­—ç¬¦ï¼ˆ0xEF 0xBB 0xBFï¼Œå³BOMï¼‰ã€‚å®ƒæ˜¯ä¸€ä¸²éšè—çš„å­—ç¬¦ï¼Œç”¨äºè®©è®°äº‹æœ¬ç­‰ç¼–è¾‘å™¨è¯†åˆ«è¿™ä¸ªæ–‡ä»¶æ˜¯å¦ä»¥UTF-8ç¼–ç ã€‚å¯¹äºä¸€èˆ¬çš„æ–‡ä»¶ï¼Œè¿™æ ·å¹¶ä¸ä¼šäº§ç”Ÿä»€ä¹ˆéº»çƒ¦ã€‚ä½†å¯¹äº PHPæ¥è¯´ï¼ŒBOMæ˜¯ä¸ªå¤§éº»çƒ¦ã€‚PHPå¹¶ä¸ä¼šå¿½ç•¥BOMï¼Œæ‰€ä»¥åœ¨è¯»å–ã€åŒ…å«æˆ–è€…å¼•ç”¨è¿™äº›æ–‡ä»¶æ—¶ï¼Œä¼šæŠŠBOMä½œä¸ºè¯¥æ–‡ä»¶å¼€å¤´æ­£æ–‡çš„ä¸€éƒ¨åˆ†ã€‚æ ¹æ®åµŒå…¥å¼è¯­è¨€çš„ç‰¹ç‚¹ï¼Œè¿™ä¸²å­—ç¬¦å°†è¢«ç›´æ¥æ‰§è¡Œï¼ˆæ˜¾ç¤ºï¼‰å‡º æ¥ã€‚ç”±æ­¤é€ æˆå³ä½¿é¡µé¢çš„ top padding è®¾ç½®ä¸º0ï¼Œä¹Ÿæ— æ³•è®©æ•´ä¸ªç½‘é¡µç´§è´´æµè§ˆå™¨é¡¶éƒ¨ï¼Œå› ä¸ºåœ¨htmlä¸€å¼€å¤´æœ‰è¿™3ä¸ªå­—ç¬¦å‘¢ï¼å¦‚æœå¤„ç†PHPæ–‡ä»¶å‡ºç°ä»¥ä¸‹é—®é¢˜ï¼Œå¤šåŠæ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼š 1. éªŒè¯ç å›¾ç‰‡ä¸æ˜¾ç¤ºï¼›2.é¡µé¢æ˜¾ç¤ºä¸€ä¸ªâ€œé”˜â€å­—ï¼Œå…¶ä»–ä¸€ç‰‡ç©ºç™½ï¼›3.ä¸èƒ½ç™»å½•æˆ–é€€å‡ºï¼›4.é¡µé¡¶å‡ºç°ä¸€è¡Œç©ºç™½ï¼›5.é¡µé¡¶å‡ºç°é”™è¯¯è­¦å‘Šã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/tags/web/"}]},{"title":"Thinkphpå®ç°ajaxåˆ†é¡µ","slug":"ThinkPHPå®ç°ajaxåˆ†é¡µ","date":"2016-09-24T03:28:28.000Z","updated":"2022-03-19T14:35:21.649Z","comments":true,"path":"2016/09/24/73/","link":"","permalink":"https://github.13sai.com/2016/09/24/73/","excerpt":"","text":"å‰ä¸¤å¤©é”€å”®é‚£è¾¹è¯´èƒ½ä¸èƒ½åšæ— åˆ·æ–°åˆ†é¡µï¼Œæˆ‘è¯´å¯ä»¥ï¼Œæ¯”æ­£å¸¸åˆ†é¡µéº»çƒ¦ä¸€ç‚¹ï¼Œä¹‹å‰æœ‰è§è¿‡ã€‚ ç„¶åæƒ³æƒ³ï¼Œè¯•è¯•çœ‹ï¼Œæœäº†ä»£ç ï¼Œæµ‹è¯•ä¿®æ”¹ï¼ŒæˆåŠŸäº†ã€‚ ajaxPage.class.php&lt;?php class AjaxPage &#123; // åˆ†é¡µæ æ¯é¡µæ˜¾ç¤ºçš„é¡µæ•° public $rollPage = 5; // é¡µæ•°è·³è½¬æ—¶è¦å¸¦çš„å‚æ•° public $parameter ; // é»˜è®¤åˆ—è¡¨æ¯é¡µæ˜¾ç¤ºè¡Œæ•° public $listRows = 20; // èµ·å§‹è¡Œæ•° public $firstRow ; public $ajax_func ; // åˆ†é¡µæ€»é¡µé¢æ•° protected $totalPages ; // æ€»è¡Œæ•° protected $totalRows ; // å½“å‰é¡µæ•° protected $nowPage ; // åˆ†é¡µçš„æ çš„æ€»é¡µæ•° protected $coolPages ; // åˆ†é¡µæ˜¾ç¤ºå®šåˆ¶ protected $config = array(&#x27;header&#x27;=&gt;&#x27;æ¡è®°å½•&#x27;,&#x27;prev&#x27;=&gt;&#x27;ä¸Šä¸€é¡µ&#x27;,&#x27;next&#x27;=&gt;&#x27;ä¸‹ä¸€é¡µ&#x27;,&#x27;first&#x27;=&gt;&#x27;ç¬¬ä¸€é¡µ&#x27;,&#x27;last&#x27;=&gt;&#x27;æœ€åä¸€é¡µ&#x27;,&#x27;theme&#x27;=&gt;&#x27;&lt;ul class=&quot;pagination&quot;&gt;&lt;li class=&quot;prev &quot;&gt;&lt;a&gt; %totalRow% %header% %nowPage%/%totalPage% é¡µ &lt;/a&gt;&lt;/li&gt; %first% %prePage% %upPage% %linkPage% %downPage% %nextPage% %end% &lt;/ul&gt;&#x27;); // é»˜è®¤åˆ†é¡µå˜é‡å protected $varPage; public function __construct($totalRows,$listRows=&#x27;&#x27;,$ajax_func,$parameter=&#x27;&#x27;) &#123; $this-&gt;totalRows = $totalRows; $this-&gt;ajax_func = $ajax_func; $this-&gt;parameter = $parameter; $this-&gt;varPage = C(&#x27;VAR_PAGE&#x27;) ? C(&#x27;VAR_PAGE&#x27;) : &#x27;p&#x27; ; if(!empty($listRows)) &#123; $this-&gt;listRows = intval($listRows); &#125; $this-&gt;totalPages = ceil($this-&gt;totalRows/$this-&gt;listRows); //æ€»é¡µæ•° $this-&gt;coolPages = ceil($this-&gt;totalPages/$this-&gt;rollPage); $this-&gt;nowPage = !empty($_GET[$this-&gt;varPage])?intval($_GET[$this-&gt;varPage]):1; if(!empty($this-&gt;totalPages) &amp;&amp; $this-&gt;nowPage&gt;$this-&gt;totalPages) &#123; $this-&gt;nowPage = $this-&gt;totalPages; &#125; $this-&gt;firstRow = $this-&gt;listRows*($this-&gt;nowPage-1); &#125; public function setConfig($name,$value) &#123; if(isset($this-&gt;config[$name])) &#123; $this-&gt;config[$name] = $value; &#125; &#125; public function show() &#123; if(0 == $this-&gt;totalRows) return &#x27;&#x27;; $p = $this-&gt;varPage; $nowCoolPage = ceil($this-&gt;nowPage/$this-&gt;rollPage); $url = $_SERVER[&#x27;REQUEST_URI&#x27;].(strpos($_SERVER[&#x27;REQUEST_URI&#x27;],&#x27;?&#x27;)?&#x27;&#x27;:&quot;?&quot;).$this-&gt;parameter; $parse = parse_url($url); if(isset($parse[&#x27;query&#x27;])) &#123; parse_str($parse[&#x27;query&#x27;],$params); unset($params[$p]); $url = $parse[&#x27;path&#x27;].&#x27;?&#x27;.http_build_query($params); &#125; //ä¸Šä¸‹ç¿»é¡µå­—ç¬¦ä¸² $upRow = $this-&gt;nowPage-1; $downRow = $this-&gt;nowPage+1; if ($upRow&gt;0)&#123; $upPage = &quot;&lt;li class=&#x27;prev&#x27;&gt;&lt;a href=&#x27;javascript:&quot;.$this-&gt;ajax_func.&quot;(&quot;.$upRow.&quot;)&#x27;&gt;&quot;.$this-&gt;config[&#x27;prev&#x27;].&quot;&lt;/a&gt;&lt;/li&gt;&quot;; &#125;else&#123; $upPage = &quot;&quot;; &#125; if ($downRow &lt;= $this-&gt;totalPages)&#123; $downPage = &quot;&lt;li class=&#x27;next&#x27;&gt;&lt;a href=&#x27;javascript:&quot;.$this-&gt;ajax_func.&quot;(&quot;.$downRow.&quot;)&#x27;&gt;&quot;.$this-&gt;config[&#x27;next&#x27;].&quot;&lt;/a&gt;&lt;/li&gt;&quot;; &#125;else&#123; $downPage = &quot;&quot;; &#125; // &lt;&lt; &lt; &gt; &gt;&gt; if($nowCoolPage == 1)&#123; $theFirst = &quot;&quot;; $prePage = &quot;&quot;; &#125;else&#123; $preRow = $this-&gt;nowPage-$this-&gt;rollPage; $prePage = &quot;&lt;li&gt;&lt;a href=&#x27;javascript:&quot;.$this-&gt;ajax_func.&quot;(&quot;.$preRow.&quot;)&#x27;&gt;ä¸Š&quot;.$this-&gt;rollPage.&quot;é¡µ&lt;/a&gt;&lt;/li&gt;&quot;; $theFirst = &quot;&lt;li&gt;&lt;a href=&#x27;javascript:&quot;.$this-&gt;ajax_func.&quot;(1)&#x27; &gt;&quot;.$this-&gt;config[&#x27;first&#x27;].&quot;&lt;/a&gt;&lt;/li&gt;&quot;; &#125; if($nowCoolPage == $this-&gt;coolPages)&#123; $nextPage = &quot;&quot;; $theEnd=&quot;&quot;; &#125;else&#123; $nextRow = $this-&gt;nowPage+$this-&gt;rollPage; $theEndRow = $this-&gt;totalPages; $nextPage = &quot;&lt;li&gt;&lt;a href=&#x27;javascript:&quot;.$this-&gt;ajax_func.&quot;(&quot;.$nextRow.&quot;)&#x27; &gt;ä¸‹&quot;.$this-&gt;rollPage.&quot;é¡µ&lt;/a&gt;&lt;/li&gt;&quot;; $theEnd = &quot;&lt;li&gt;&lt;a href=&#x27;javascript:&quot;.$this-&gt;ajax_func.&quot;(&quot;.$theEndRow.&quot;)&#x27; &gt;&quot;.$this-&gt;config[&#x27;last&#x27;].&quot;&lt;/a&gt;&lt;/li&gt;&quot;; &#125; // 1 2 3 4 5 $linkPage = &quot;&quot;; for($i=1;$i&lt;=$this-&gt;rollPage;$i++)&#123; $page=($nowCoolPage-1)*$this-&gt;rollPage+$i; if($page!=$this-&gt;nowPage)&#123; if($page&lt;=$this-&gt;totalPages)&#123; $linkPage .= &quot;&lt;li&gt;&lt;a href=&#x27;javascript:&quot;.$this-&gt;ajax_func.&quot;(&quot;.$page.&quot;)&#x27;&gt;&amp;nbsp;&quot;.$page.&quot;&amp;nbsp;&lt;/a&gt;&lt;/li&gt;&quot;; &#125;else&#123; break; &#125; &#125;else&#123; if($this-&gt;totalPages != 1)&#123; $linkPage .= &quot;&lt;li&gt;&lt;span class=&#x27;current&#x27;&gt;&quot;.$page.&quot;&lt;/span&gt;&lt;/li&gt;&quot;; &#125; &#125; &#125; $pageStr = str_replace( array(&#x27;%header%&#x27;,&#x27;%nowPage%&#x27;,&#x27;%totalRow%&#x27;,&#x27;%totalPage%&#x27;,&#x27;%upPage%&#x27;,&#x27;%downPage%&#x27;,&#x27;%first%&#x27;,&#x27;%prePage%&#x27;,&#x27;%linkPage%&#x27;,&#x27;%nextPage%&#x27;,&#x27;%end%&#x27;), array($this-&gt;config[&#x27;header&#x27;],$this-&gt;nowPage,$this-&gt;totalRows,$this-&gt;totalPages,$upPage,$downPage,$theFirst,$prePage,$linkPage,$nextPage,$theEnd),$this-&gt;config[&#x27;theme&#x27;]); return $pageStr; &#125; &#125; IndexActionpublic function new()&#123; import(&quot;ORG.Util.ajaxPage&quot;);// å¯¼å…¥åˆ†é¡µç±» æ³¨æ„å¯¼å…¥çš„æ˜¯è‡ªå·±å†™çš„AjaxPageç±» $m = M(&#x27;vw_article&#x27;); $count = $m-&gt;count(); //è®¡ç®—è®°å½•æ•° $limitRows = 5; // è®¾ç½®æ¯é¡µè®°å½•æ•° //ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä½ éœ€è¦è°ƒç”¨æ¢é¡µçš„ajaxå‡½æ•°å $p = new AjaxPage($count, $limitRows,&quot;ajaxpage&quot;); $limit = $p-&gt;firstRow . &quot;,&quot; . $p-&gt;listRows; $p-&gt;setConfig(&#x27;theme&#x27;,&#x27;&lt;ul class=&quot;pagination&quot;&gt; %first% %prePage% %upPage% %linkPage% %downPage% %nextPage% %end% &lt;/ul&gt;&#x27;); $data = $m-&gt;limit($limit)-&gt;select(); // æŸ¥è¯¢æ•°æ® $page = $p-&gt;show(); // äº§ç”Ÿåˆ†é¡µä¿¡æ¯ï¼ŒAJAXçš„è¿æ¥åœ¨æ­¤å¤„ç”Ÿæˆ $this-&gt;assign(&#x27;list&#x27;,$data); $this-&gt;assign(&#x27;page&#x27;,$page); $this-&gt;display(); &#125; public function newslist()&#123; $p = I(&#x27;p&#x27;); import(&quot;ORG.Util.ajaxPage&quot;); $m = M(&#x27;vw_article&#x27;); $count = $m-&gt;count(); //è®¡ç®—è®°å½•æ•° $limitRows = 5; // è®¾ç½®æ¯é¡µè®°å½•æ•° $p = new AjaxPage($count, $limitRows,&quot;ajaxpage&quot;); //ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä½ éœ€è¦è°ƒç”¨æ¢é¡µçš„ajaxå‡½æ•°å $limit = $p-&gt;firstRow . &quot;,&quot; . $p-&gt;listRows; $p-&gt;setConfig(&#x27;theme&#x27;,&#x27;&lt;ul class=&quot;pagination&quot;&gt; %first% %prePage% %upPage% %linkPage% %downPage% %nextPage% %end% &lt;/ul&gt;&#x27;); $data = $m-&gt;limit($limit)-&gt;select(); // æŸ¥è¯¢æ•°æ® $page = $p-&gt;show(); // äº§ç”Ÿåˆ†é¡µä¿¡æ¯ï¼ŒAJAXçš„è¿æ¥åœ¨æ­¤å¤„ç”Ÿæˆ $this-&gt;assign(&#x27;list&#x27;,$data); $this-&gt;assign(&#x27;page&#x27;,$page); $this-&gt;display(); &#125; tpl&lt;div class=&quot;page row&quot;&gt; &lt;include file=&quot;./sidebar&quot; /&gt; &lt;div class=&quot;page-right&quot; id=&quot;ajaxPage&quot;&gt; &lt;div class=&quot;page-position&quot;&gt; &lt;a href=&quot;&#123;:U(&#x27;Home/Index/index&#x27;)&#125;&quot;&gt;é¦–é¡µ&lt;/a&gt;&gt;&gt;&#123;$navname&#125; &lt;/div&gt; &lt;div class=&quot;page-list&quot;&gt; &lt;ul&gt; &lt;volist name=&quot;list&quot; id=&quot;vo&quot;&gt; &lt;li&gt; &lt;div class=&quot;desc&quot; &gt; &lt;h3&gt;&lt;a href=&quot;&#123;:U(&#x27;Home/Index/news&#x27;,array(&#x27;art_id&#x27;=&gt;$vo[&#x27;art_id&#x27;],&#x27;art_column&#x27;=&gt;$vo[&#x27;art_column&#x27;]))&#125;&quot;&gt;&lt;span class=&quot;wd-fr&quot;&gt;&#123;$vo[&#x27;art_post_time&#x27;]&#125;&lt;/span&gt;&#123;:mb_substr($vo[&#x27;art_name&#x27;],0,40,&#x27;utf-8&#x27;)&#125;&lt;/a&gt;&lt;/h3&gt; &lt;/div&gt; &lt;/li&gt; &lt;/volist&gt; &lt;/ul&gt; &lt;/div&gt; &lt;div class=&quot;wdphp-page&quot;&gt; &#123;$page&#125; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;script type=&quot;text/javascript&quot;&gt; function ajaxpage(id)&#123; var id = id; //postå¯ä¸è¡Œ $.ajax(&#123; url: &quot;&#123;:U(&#x27;Home/Index/userlist&#x27;)&#125;&quot;, data: &#123;&#x27;p&#x27;:id&#125;, success: function (html) &#123; $(&quot;#ajaxPage&quot;).html(html); &#125; &#125;); &#125; &lt;/script&gt; å¥½äº†ï¼Œæ˜¯ä¸æ˜¯è¿˜è›®é¡ºæ‰‹ã€‚ ä½†æ˜¯å¦‚æœæ—¶å€™é‚£ç§ä¸‹æ»‘æ— åˆ·æ–°çš„å‘¢ï¼Œæ€ä¹ˆåšï¼ŸåŠ js?","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"å¾®ä¿¡æ‰«ç ç™»å½•","slug":"å¾®ä¿¡æ‰«ç ç™»å½•","date":"2016-09-21T05:49:16.000Z","updated":"2022-03-19T14:35:21.917Z","comments":true,"path":"2016/09/21/72/","link":"","permalink":"https://github.13sai.com/2016/09/21/72/","excerpt":"","text":"å‡†å¤‡ï¼šç”³è¯·å¾®ä¿¡å¼€å‘è€…ï¼Œç”³è¯·è®¤è¯ï¼Œè·å–appidä¸appserectã€‚&lt;?php class&nbsp;WechatAction&nbsp;extends&nbsp;AppbaseAction&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$appid&nbsp;=&nbsp;&quot;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$secret&nbsp;=&nbsp;&quot;&quot;;&nbsp;&nbsp;&nbsp;&nbsp;//private&nbsp;$scope&nbsp;=&nbsp;&quot;snsapi_base&quot;;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$scope&nbsp;=&nbsp;&quot;snsapi_login&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ç»§æ‰¿çˆ¶ç±»/&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;_initialize()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent::_initialize();&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;//å¾®ä¿¡ç™»å½•ï¼ŒåŒæ„æˆæƒï¼Œè·å–code&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;oauthLogin(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$appid&nbsp;=&nbsp;$this-&gt;appid;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$scope&nbsp;=&nbsp;$this-&gt;scope;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//å›è°ƒåŸŸ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$redirect_uri&nbsp;=&nbsp;urlencode(&#39;http://www.13sai.com&#39;.U(&#39;Member/Wechat/oauthCallback&#39;));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url&nbsp;=&nbsp;&quot;https://open.weixin.qq.com/connect/qrconnect?appid=$appid&amp;redirect_uri=$redirect_uri&amp;response_type=code&amp;scope=$scope&amp;state=1#wechat_redirect&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$url;die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header(&quot;Location:&quot;.$url);&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;//OAthu2.0&nbsp;å›è°ƒå‡½æ•°&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;oauthCallback(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$appid&nbsp;=&nbsp;$this-&gt;appid;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$secret&nbsp;=&nbsp;$this-&gt;secret;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$code&nbsp;=&nbsp;$GET[&quot;code&quot;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//å–å¾—openid&nbsp;,access_token&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oauth2Url&nbsp;=&nbsp;&quot;https://api.weixin.qq.com/sns/oauth2/access_token?appid=$appid&amp;secret=$secret&amp;code=$code&amp;grant_type=authorization_code&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oauth2&nbsp;=&nbsp;z_get_json($oauth2Url);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//æ ¹æ®å…¨å±€access_tokenå’ŒopenidæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$access_token&nbsp;=&nbsp;$oauth2[&quot;access_token&quot;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$openid&nbsp;=&nbsp;$oauth2[&#39;openid&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$openid;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$get_user_info_url&nbsp;=&nbsp;&quot;https://api.weixin.qq.com/sns/userinfo?access_token=$access_token&amp;openid=$openid&amp;lang=zh_CN&quot;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$userinfo&nbsp;=&nbsp;z_get_json($get_user_info_url);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//dump($userinfo);die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//åˆ¤æ–­æ³¨å†Œè¿˜æ˜¯ç™»å½•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($userinfo[&#39;openid&#39;]!=&#39;&#39;){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$row&nbsp;=&nbsp;M(&quot;member&quot;)-&gt;where(&quot;m_weixin_unionid=&#39;%s&#39;&quot;,$userinfo[&quot;unionid&quot;])-&gt;find();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($row){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session(&#39;m_id&#39;,$row[&#39;m_id&#39;]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session(&#39;m_nick_name&#39;,$row[&#39;m_nick_name&#39;]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session(&#39;m_login_name&#39;,$row[&#39;m_login_name&#39;]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//U(&#39;Home/Home/index&#39;,null,true,true);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;/&quot;;&lt;/script&gt;&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;åˆ›å»ºæ–°ç”¨æˆ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count&nbsp;=&nbsp;M(&quot;member&quot;)-&gt;max(&#39;m_id&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rand&nbsp;=&nbsp;mt_rand(1000,9999);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_sex&#39;]&nbsp;&nbsp;=&nbsp;$userinfo[&#39;sex&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_avatar&#39;]&nbsp;&nbsp;=&nbsp;$userinfo[&#39;headimgurl&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_nick_name&#39;]&nbsp;&nbsp;=&nbsp;mb_substr($userinfo[&#39;nickname&#39;],0,6,&quot;utf-8&quot;)&nbsp;.&nbsp;$count;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_login_name&#39;]&nbsp;=&nbsp;&#39;wx&#39;.$rand.&#39;&#39;.$count;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_password&#39;]&nbsp;=&nbsp;md5(md5(time()));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_weixin_unionid&#39;]&nbsp;&nbsp;=&nbsp;$userinfo[&quot;unionid&quot;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;from&#39;]&nbsp;=&nbsp;&#39;weixin&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;&#39;.U(&#39;Member/Index/oauthBind&#39;).&#39;&quot;;&lt;/script&gt;&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$str;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;}}å…¶ä¸­çš„z_get_jsonæ–¹æ³•å¦‚ä¸‹ï¼šfunction&nbsp;z_get_json($url){&nbsp;&nbsp;&nbsp;&nbsp;$ch&nbsp;=&nbsp;curl_init();&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_URL,&nbsp;$url);&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_SSL_VERIFYPEER,&nbsp;FALSE);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_SSL_VERIFYHOST,&nbsp;FALSE);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_RETURNTRANSFER,&nbsp;1);&nbsp;&nbsp;&nbsp;&nbsp;$output&nbsp;=&nbsp;curl_exec($ch);&nbsp;&nbsp;&nbsp;&nbsp;curl_close($ch);&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;json_decode($output,&nbsp;true);}å‰å°ï¼š&lt;a&nbsp;href=&quot;{:U(&#39;Member/Wechat/oauthLogin&#39;)}&quot;&gt;&lt;img&nbsp;src=&quot;/webui/home/images/weixin.png&quot;&gt;&lt;/a&gt;&lt;/p&gt;æ•ˆæœï¼š","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"phpå­—ç¬¦ä¸²ä¸­åŒå¼•å·åŠåæ–œæ æ›¿æ¢é—®é¢˜","slug":"phpå­—ç¬¦ä¸²ä¸­åŒå¼•å·åŠåæ–œæ æ›¿æ¢é—®é¢˜","date":"2016-09-06T07:20:09.000Z","updated":"2022-03-19T14:35:21.785Z","comments":true,"path":"2016/09/06/71/","link":"","permalink":"https://github.13sai.com/2016/09/06/71/","excerpt":"","text":"éœ€è¦è½¬ä¹‰ä¸‹ phpå­—ç¬¦ä¸²ä¸­åŒå¼•å·æ›¿æ¢: $tmp_data = str_replace(&quot;&quot;&quot;,&quot;&quot;,$tmp_data);åŒå¼•å·æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸² $tmp_data = str_replace(&quot;&quot;&quot;,&quot;&#x27;&quot;,$tmp_data);åŒå¼•å·æ›¿æ¢ä¸ºå•å¼•å· phpå­—ç¬¦ä¸²ä¸­æ›¿æ¢åæ–œæ  $tmp_data = str_replace(&quot;\\&quot;,&quot;&quot;,$tmp_data); åæ–œæ æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸²","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"å¾®ä¿¡ç™»å½•","slug":"å¾®ä¿¡ç™»å½•","date":"2016-09-04T07:50:11.000Z","updated":"2022-03-19T14:35:21.920Z","comments":true,"path":"2016/09/04/70/","link":"","permalink":"https://github.13sai.com/2016/09/04/70/","excerpt":"","text":"å¾®ä¿¡ç™»å½•ç›¸æ¯”qqç™»å½•è¦ç®€å•ï¼Œç›´æ¥ä¸Šä»£ç ã€‚åŒæ ·éœ€è¦ç”³è¯·appidä¸secretWechatAction&lt;?php class&nbsp;WechatAction&nbsp;extends&nbsp;AppbaseAction&nbsp;{//ç”³è¯·çš„appid&nbsp;secret&nbsp;private&nbsp;$appid&nbsp;=&nbsp;&quot;&quot;;private&nbsp;$secret&nbsp;=&nbsp;&quot;&quot;;private&nbsp;$scope&nbsp;=&nbsp;&quot;snsapi_userinfo&quot;; /ç»§æ‰¿çˆ¶ç±»/&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;function&nbsp;_initialize()&nbsp;{parent::_initialize();&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){&nbsp;&nbsp;&nbsp;echo&nbsp;111;&nbsp;&nbsp;&nbsp;//echo&nbsp;$this-&gt;appid;&nbsp;&nbsp;&nbsp;&nbsp;} //å¾®ä¿¡ç™»å½•ï¼ŒåŒæ„æˆæƒï¼Œè·å–code&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;oauthLogin(){$appid&nbsp;=&nbsp;$this-&gt;appid;$scope&nbsp;=&nbsp;$this-&gt;scope;$redirect_uri&nbsp;=&nbsp;urlencode(&#39;http://www.13sai.com&#39;.U(&#39;Wap/Wechat/oauthCallback&#39;));$url&nbsp;=&nbsp;&quot;https://open.weixin.qq.com/connect/oauth2/authorize?appid=$appid&amp;redirect_uri=$redirect_uri&amp;response_type=code&amp;scope=$scope&amp;state=1#wechat_redirect&quot;;//echo&nbsp;$url;die();header(&quot;Location:&quot;.$url);&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;//OAthu2.0&nbsp;å›è°ƒå‡½æ•°&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;oauthCallback(){$appid&nbsp;=&nbsp;$this-&gt;appid;$secret&nbsp;=&nbsp;$this-&gt;secret;$code&nbsp;=&nbsp;$_GET[&quot;code&quot;];//echo&nbsp;$code.&#39;&lt;br&gt;&#39;;&nbsp;//ç¬¬ä¸€æ­¥:å–å…¨å±€access_token$url&nbsp;=&nbsp;&quot;https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=$appid&amp;secret=$secret&quot;;$token&nbsp;=&nbsp;z_get_json($url);//dump($token).&#39;&lt;br&gt;&#39;; //ç¬¬äºŒæ­¥:å–å¾—openid$oauth2Url&nbsp;=&nbsp;&quot;https://api.weixin.qq.com/sns/oauth2/access_token?appid=$appid&amp;secret=$secret&amp;code=$code&amp;grant_type=authorization_code&quot;;$oauth2&nbsp;=&nbsp;z_get_json($oauth2Url);//dump($oauth2).&#39;&lt;br&gt;&#39;;&nbsp;//ç¬¬ä¸‰æ­¥:æ ¹æ®å…¨å±€access_tokenå’ŒopenidæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯&nbsp;&nbsp;$access_token&nbsp;=&nbsp;$token[&quot;access_token&quot;];&nbsp;&nbsp;$openid&nbsp;=&nbsp;$oauth2[&#39;openid&#39;];&nbsp;&nbsp;$get_user_info_url&nbsp;=&nbsp;&quot;https://api.weixin.qq.com/cgi-bin/user/info?access_token=$access_token&amp;openid=$openid&amp;lang=zh_CN&quot;;//echo&nbsp;$get_user_info_url;$userinfo&nbsp;=&nbsp;z_get_json($get_user_info_url);//dump($userinfo);//die(); //if($userinfo[&#39;openid&#39;]!=&#39;&#39;){//&nbsp;echo&nbsp;&#39;&lt;br&gt;&lt;br&gt;&#39;.$userinfo[&#39;openid&#39;];//}//dump($userinfo);//die();//åˆ¤æ–­æ³¨å†Œè¿˜æ˜¯ç™»å½•if($userinfo[&#39;openid&#39;]!=&#39;&#39;){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$row&nbsp;=&nbsp;M(&quot;member&quot;)-&gt;where(&quot;m_weixin_openid=&#39;%s&#39;&quot;,$userinfo[&quot;openid&quot;])-&gt;find();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($row){&nbsp;&nbsp;&nbsp;session(&#39;m_id&#39;,$row[&#39;m_id&#39;]);&nbsp;&nbsp;&nbsp;session(&#39;m_nick_name&#39;,$row[&#39;m_nick_name&#39;]);&nbsp;&nbsp;&nbsp;session(&#39;m_login_name&#39;,$row[&#39;m_login_name&#39;]);&nbsp;&nbsp;&nbsp;session(&#39;is_org&#39;,-1);&nbsp;&nbsp;&nbsp;//U(&#39;Home/Home/index&#39;,null,true,true);&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Wap/Home/index&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;åˆ›å»ºæ–°ç”¨æˆ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count&nbsp;=&nbsp;M(&quot;member&quot;)-&gt;max(&#39;m_id&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rand&nbsp;=&nbsp;mt_rand(1000,9999);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$data[&#39;gender&#39;]&nbsp;&nbsp;=&nbsp;$gender;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_avatar&#39;]&nbsp;&nbsp;=&nbsp;$userinfo[&#39;headimgurl&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_nick_name&#39;]&nbsp;&nbsp;=&nbsp;mb_substr($userinfo[&#39;nickname&#39;],0,6,&quot;utf-8&quot;)&nbsp;.&nbsp;$count;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_login_name&#39;]&nbsp;=&nbsp;&#39;wx_&#39;.$rand.&#39;&#39;.$count;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_password&#39;]&nbsp;=&nbsp;md5(md5(time()));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_weixin_openid&#39;]&nbsp;&nbsp;=&nbsp;$userinfo[&quot;openid&quot;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_jingyan&#39;]&nbsp;=&nbsp;50; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session(&#39;kj_object&#39;,$data); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Wap/Guide/binding&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}}else{&nbsp;&nbsp;&nbsp;&nbsp;U(&#39;Wap/Index/login&#39;,&#39;&#39;,&#39;&#39;,true);}}}å‰å°æ¨¡æ¿ç±»ä¼¼qq &nbsp;å¾®åšä¸€é”®ç™»å½•ï¼Œå°±ä¸èµ˜è¿°äº†ã€‚æ³¨æ„ï¼šè¿™æ˜¯å¾®ä¿¡é‡Œçš„ä¸€é”®ç™»å½•ï¼Œéœ€è¦ç”³è¯·æœåŠ¡å·ï¼Œæ‰èƒ½è·å–æˆæƒã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"ä¸€é”®ç™»å½•ï¼ˆqq,weiboï¼‰","slug":"ä¸€é”®ç™»å½•ï¼ˆqq,weiboï¼‰","date":"2016-09-04T07:44:48.000Z","updated":"2022-03-19T14:35:21.839Z","comments":true,"path":"2016/09/04/69/","link":"","permalink":"https://github.13sai.com/2016/09/04/69/","excerpt":"","text":"é¦–å…ˆéœ€è¦å»qqï¼Œweiboç”³è¯·å¯†é’¥ï¼Œç„¶åä¼šå¾—åˆ°APPIDå’ŒAPPKEYï¼Œç„¶åä¸€æ­¥æ­¥æ“ä½œï¼Œéƒ½æœ‰æç¤ºã€‚æˆåŠŸåæŠŠé…ç½®å†™åœ¨commonå‡½æ•°ä»¥ä¾¿åæœŸè°ƒç”¨ã€‚&lt;?php //qqä¸€é”®ç™»å½• function&nbsp;qqlogin_config(){&nbsp;&nbsp;&nbsp;&nbsp;define(&quot;QQDEBUG&quot;,&nbsp;false);&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(defined(&quot;QQDEBUG&quot;)&nbsp;&amp;&amp;&nbsp;QQDEBUG)&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ini_set(&quot;error_reporting&quot;,&nbsp;E_ALL);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ini_set(&quot;display_errors&quot;,&nbsp;TRUE);&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp; error_reporting(E_ALL^E_NOTICE);&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;session_start(); &nbsp;&nbsp;&nbsp;&nbsp;//ç”³è¯·åˆ°çš„appid&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION[&quot;appid&quot;]&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#39;&#39;;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;//ç”³è¯·åˆ°çš„appkey&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION[&quot;appkey&quot;]&nbsp;&nbsp;&nbsp;=&nbsp;&quot;&quot;;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;//QQç™»å½•æˆåŠŸåè·³è½¬çš„åœ°å€,è¯·ç¡®ä¿åœ°å€çœŸå®å¯ç”¨ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç™»å½•å¤±è´¥ã€‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//ä¸€å®šè¦æ³¨æ„å›è°ƒåœ°å€&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION[&quot;callback&quot;]&nbsp;=&nbsp;&quot;http://&quot;&nbsp;.&nbsp;$_SERVER[&#39;SERVER_NAME&#39;]&nbsp;.&nbsp;&quot;/index.php/Home/OAuth/qqCallback&quot;;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;//QQæˆæƒapiæ¥å£.æŒ‰éœ€è°ƒç”¨&nbsp;&nbsp;&nbsp;&nbsp;//$_SESSION[&quot;scope&quot;]&nbsp;=&nbsp;&quot;get_user_info,add_share,list_album,add_album,upload_pic,add_topic,add_one_blog,add_weibo&quot;;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION[&quot;scope&quot;]&nbsp;=&nbsp;&quot;get_user_info&quot;;} function&nbsp;qqlogin_do_post($url,&nbsp;$data){&nbsp;&nbsp;&nbsp;&nbsp;$ch&nbsp;=&nbsp;curl_init();&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_RETURNTRANSFER,&nbsp;TRUE);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_POST,&nbsp;TRUE);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_POSTFIELDS,&nbsp;$data);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_URL,&nbsp;$url);&nbsp;&nbsp;&nbsp;&nbsp;$ret&nbsp;=&nbsp;curl_exec($ch); &nbsp;&nbsp;&nbsp;&nbsp;curl_close($ch);&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$ret;}&nbsp;&nbsp;&nbsp;&nbsp;/â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-&nbsp;&nbsp;&nbsp;&nbsp;å¾®åšä¸€é”®ç™»å½•&nbsp;&nbsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-/&nbsp;/**&nbsp;&nbsp;å¾®åšä¸€é”®ç™»å½•&nbsp;-&nbsp;é…ç½®&nbsp;/function&nbsp;weibo_config(){&nbsp;&nbsp;&nbsp;&nbsp;define(&nbsp;&quot;WB_AKEY&quot;&nbsp;,&nbsp;&#39;4002186908&#39;&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;define(&nbsp;&quot;WB_SKEY&quot;&nbsp;,&nbsp;&#39;dd81902ee3460eba972f46487aac41e2&#39;&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;define(&nbsp;&quot;WB_CALLBACK_URL&quot;&nbsp;,&nbsp;&#39;http://www.ayanglao.org.cn&#39;&nbsp;&nbsp;.&nbsp;U(&#39;Home/OAuth/weiboCallback&#39;));}ç„¶åå°±æ˜¯OAuthAction&lt;?php class&nbsp;OAuthAction&nbsp;extends&nbsp;AppbaseAction&nbsp;{ public&amp;nbsp;function&amp;nbsp;qqLogin()&#123; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//â€¦.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qqlogin_config(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION[&#39;state&#39;]&nbsp;=&nbsp;md5(uniqid(rand(),&nbsp;TRUE));&nbsp;//CSRF&nbsp;protection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$login_url&nbsp;=&nbsp;&quot;https://graph.qq.com/oauth2.0/authorize?response_type=code&amp;client_id=&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;$_SESSION[&quot;appid&quot;]&nbsp;.&nbsp;&quot;&amp;redirect_uri=&quot;&nbsp;.&nbsp;urlencode($_SESSION[&quot;callback&quot;])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&quot;&amp;state=&quot;&nbsp;.&nbsp;$_SESSION[&#39;state&#39;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&quot;&amp;scope=&quot;.$_SESSION[&quot;scope&quot;];&nbsp;&nbsp;&nbsp;&nbsp; //echo&nbsp;$login_url;&nbsp;&nbsp;&nbsp;&nbsp; //print_r($_SESSION);&nbsp;&nbsp;&nbsp;&nbsp; //die();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header(&quot;Location:$login_url&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;qqCallback(){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qqlogin_config(); //var_dump($_SESSION); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;è·å–token&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_REQUEST[&#39;state&#39;]&nbsp;==&nbsp;$_SESSION[&#39;state&#39;])&nbsp;//csrf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$token_url&nbsp;=&nbsp;&quot;https://graph.qq.com/oauth2.0/token?grant_type=authorization_code&amp;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&quot;client_id=&quot;&nbsp;.&nbsp;$_SESSION[&quot;appid&quot;].&nbsp;&quot;&amp;redirect_uri=&quot;&nbsp;.&nbsp;urlencode($_SESSION[&quot;callback&quot;])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&quot;&amp;client_secret=&quot;&nbsp;.&nbsp;$_SESSION[&quot;appkey&quot;].&nbsp;&quot;&amp;code=&quot;&nbsp;.&nbsp;$_REQUEST[&quot;code&quot;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$response&nbsp;=&nbsp;file_get_contents($token_url);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strpos($response,&nbsp;&quot;callback&quot;)&nbsp;!==&nbsp;false)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$lpos&nbsp;=&nbsp;strpos($response,&nbsp;&quot;(&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rpos&nbsp;=&nbsp;strrpos($response,&nbsp;&quot;)&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$response&nbsp;&nbsp;=&nbsp;substr($response,&nbsp;$lpos&nbsp;+&nbsp;1,&nbsp;$rpos&nbsp;-&nbsp;$lpos&nbsp;-1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$msg&nbsp;=&nbsp;json_decode($response);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset($msg-&gt;error))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;h3&gt;error-token:&lt;/h3&gt;&quot;&nbsp;.&nbsp;$msg-&gt;error;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;h3&gt;msg&nbsp;&nbsp;:&lt;/h3&gt;&quot;&nbsp;.&nbsp;$msg-&gt;error_description;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params&nbsp;=&nbsp;array();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parse_str($response,&nbsp;$params); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//debug&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//print_r($params);die(); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//set&nbsp;access&nbsp;token&nbsp;to&nbsp;session&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION[&quot;access_token&quot;]&nbsp;=&nbsp;$params[&quot;access_token&quot;]; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo(&quot;The&nbsp;state&nbsp;does&nbsp;not&nbsp;match.&nbsp;You&nbsp;may&nbsp;be&nbsp;a&nbsp;victim&nbsp;of&nbsp;CSRF.&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;è·å–open_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$graph_url&nbsp;=&nbsp;&quot;https://graph.qq.com/oauth2.0/me?access_token=&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;$_SESSION[&#39;access_token&#39;]; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$str&nbsp;&nbsp;=&nbsp;file_get_contents($graph_url);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(strpos($str,&nbsp;&quot;callback&quot;)&nbsp;!==&nbsp;false)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$lpos&nbsp;=&nbsp;strpos($str,&nbsp;&quot;(&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rpos&nbsp;=&nbsp;strrpos($str,&nbsp;&quot;)&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$str&nbsp;&nbsp;=&nbsp;substr($str,&nbsp;$lpos&nbsp;+&nbsp;1,&nbsp;$rpos&nbsp;-&nbsp;$lpos&nbsp;-1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user&nbsp;=&nbsp;json_decode($str);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset($user-&gt;error))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;h3&gt;error-openid:&lt;/h3&gt;&quot;&nbsp;.&nbsp;$user-&gt;error;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;h3&gt;msg&nbsp;&nbsp;:&lt;/h3&gt;&quot;&nbsp;.&nbsp;$user-&gt;error_description;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//debug&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo(&quot;Hello&nbsp;&quot;&nbsp;.&nbsp;$user-&gt;openid); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//set&nbsp;openid&nbsp;to&nbsp;session&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION[&quot;openid&quot;]&nbsp;=&nbsp;$user-&gt;openid;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;todo:&nbsp;è¿›è¡Œç™»å½•ä¸æ³¨å†Œçš„åˆ¤æ–­ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;è·å–ç”¨æˆ·ä¿¡æ¯&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$graph_url&nbsp;=&nbsp;&quot;https://graph.qq.com/user/get_user_info&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .&nbsp;&#39;?access_token=&#39;&nbsp;.&nbsp;$_SESSION[&#39;access_token&#39;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .&nbsp;&#39;&amp;oauth_consumer_key=&#39;&nbsp;.&nbsp;$_SESSION[&#39;appid&#39;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;&#39;&amp;openid=&#39;&nbsp;.&nbsp;$_SESSION[&quot;openid&quot;]; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$str&nbsp;&nbsp;=&nbsp;file_get_contents($graph_url); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$json_result&nbsp;=&nbsp;json_decode($str);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($json_result-&gt;ret&nbsp;==&nbsp;&#39;0&#39;){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$nickname&nbsp;=&nbsp;$json_result-&gt;nickname;&nbsp;//æ˜µç§°&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$avatar&nbsp;=&nbsp;$json_result-&gt;figureurl_qq_2;&nbsp;//40*40çš„qqå¤´åƒ&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$gender&nbsp;=&nbsp;$json_result-&gt;gender;&nbsp;//æ€§åˆ«&nbsp;&nbsp;&nbsp;&nbsp; //echo&nbsp;&#39;&lt;meta&nbsp;charset=&quot;utf-8&quot;&nbsp;/&gt;&#39;;&nbsp;&nbsp;&nbsp;&nbsp; //echo&nbsp;&quot;æ˜µç§°ï¼š$nickname&lt;br&gt;æ€§åˆ«ï¼š$gender&lt;br&gt;QQå¤´åƒï¼š&lt;img&nbsp;src=$figureurl_qq_1&nbsp;/&gt;&quot;;die(); &nbsp;&nbsp;&nbsp;&nbsp; $row&nbsp;=&nbsp;M(&quot;member&quot;)-&gt;where(&quot;m_qq_openid=&#39;%s&#39;&quot;,$SESSION[&quot;openid&quot;])-&gt;find();&nbsp;&nbsp;&nbsp;&nbsp; if($row){ &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;m_id&#39;,$row[&#39;m_id&#39;]); &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;m_nick_name&#39;,$row[&#39;m_nick_name&#39;]); &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;m_login_name&#39;,$row[&#39;m_login_name&#39;]); &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;is_org&#39;,-1); &nbsp;&nbsp;&nbsp;&nbsp;//U(&#39;Home/Home/index&#39;,null,true,true); &nbsp;&nbsp;&nbsp;&nbsp;if(session(&#39;shebei&#39;)&nbsp;==&nbsp;1){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Wap/Home/index&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Wap/Home/index&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;; &nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&quot;;&lt;/script&gt;&amp;#39;; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }else{&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;åˆ›å»ºæ–°ç”¨æˆ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count&nbsp;=&nbsp;M(&quot;member&quot;)-&gt;max(&#39;m_id&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rand&nbsp;=&nbsp;mt_rand(1000,9999);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; //$data[&#39;gender&#39;]&nbsp;&nbsp;=&nbsp;$gender;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $data[&#39;m_avatar&#39;]&nbsp;&nbsp;=&nbsp;$avatar;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $data[&#39;m_nick_name&#39;]&nbsp;&nbsp;=&nbsp;mb_substr($nickname,0,6,&quot;utf-8&quot;)&nbsp;.&nbsp;$count;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_login_name&#39;]&nbsp;=&nbsp;&#39;qq&#39;.$rand.&#39;&#39;.$count;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_password&#39;]&nbsp;=&nbsp;md5(md5(time()));&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $data[&#39;m_qq_openid&#39;]&nbsp;&nbsp;=&nbsp;$_SESSION[&quot;openid&quot;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;from&#39;]&nbsp;=&nbsp;&#39;qq&#39;; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;kj_object&#39;,$data); &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; if(session(&#39;shebei&#39;)&nbsp;==&nbsp;1){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Wap/Guide/binding&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Wap/Guide/binding&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;; &nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Home/Guide/binding&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; //echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&quot;;&lt;/script&gt;&amp;#39;;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;111&#39;.$str;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//å¾®åšä¸€é”®ç™»å½•ï¼ˆç™»å½•ï¼‰&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;weiboLogin(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session_start();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weibo_config();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vendor(&#39;Weibo.saetv2ex&#39;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$o&nbsp;=&nbsp;new&nbsp;SaeTOAuthV2(&nbsp;WB_AKEY&nbsp;,&nbsp;WB_SKEY&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$code_url&nbsp;=&nbsp;$o-&gt;getAuthorizeURL(&nbsp;WB_CALLBACK_URL&nbsp;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header(&quot;Location:&nbsp;&quot;&nbsp;.&nbsp;$code_url);&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;//å¾®åšä¸€é”®ç™»å½•ï¼ˆå›è°ƒï¼‰&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;weiboCallback(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;session_start();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_reporting(E_ERROR);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weibo_config();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vendor(&#39;Weibo.saetv2ex&#39;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$o&nbsp;=&nbsp;new&nbsp;SaeTOAuthV2(&nbsp;WB_AKEY&nbsp;,&nbsp;WB_SKEY&nbsp;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(isset($_REQUEST[&#39;code&#39;]))&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $keys&nbsp;=&nbsp;array();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $keys[&#39;code&#39;]&nbsp;=&nbsp;$_REQUEST[&#39;code&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $keys[&#39;redirect_uri&#39;]&nbsp;=&nbsp;WB_CALLBACK_URL;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $token&nbsp;=&nbsp;$o-&gt;getAccessToken(&nbsp;&#39;code&#39;,&nbsp;$keys&nbsp;)&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;catch&nbsp;(OAuthException&nbsp;$e)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($token)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $SESSION[&#39;token&#39;]&nbsp;=&nbsp;$token;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setcookie(&nbsp;&#39;weibojs&#39;.$o-&gt;client_id,&nbsp;http_build_query($token)&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $c&nbsp;=&nbsp;new&nbsp;SaeTClientV2(&nbsp;WB_AKEY&nbsp;,&nbsp;WB_SKEY&nbsp;,&nbsp;$_SESSION[&#39;token&#39;][&#39;access_token&#39;]&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $ms&nbsp;&nbsp;=&nbsp;$c-&gt;home_timeline();&nbsp;//&nbsp;done&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $uid_get&nbsp;=&nbsp;$c-&gt;get_uid();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $uid&nbsp;=&nbsp;$uid_get[&#39;uid&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $user_message&nbsp;=&nbsp;$c-&gt;show_user_by_id(&nbsp;$uid);//æ ¹æ®IDè·å–ç”¨æˆ·ç­‰åŸºæœ¬ä¿¡æ¯&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //ä¿å­˜å‡ ä¸ªåŸºæœ¬ä¿¡æ¯&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $openid&nbsp;=&nbsp;$user_message[&#39;id&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $nickname&nbsp;=&nbsp;$user_message[&#39;screen_name&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $avatar&nbsp;=&nbsp;$user_message[&#39;profile_image_url&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $gender&nbsp;=&nbsp;$user_message[&#39;gender&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $gender&nbsp;=&nbsp;($gender==&#39;m&#39;)?&#39;ç”·&#39;:&#39;å¥³&#39;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /ä»¥ä¸‹ä¸ºå†™æœ¬åœ°æ•°æ®åº“/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //é€šè¿‡&nbsp;$openid&nbsp;æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //if(å­˜åœ¨){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;åˆ›å»ºæ–°ç”¨æˆ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;è®¾ç½®ç™»å½•çŠ¶æ€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //dump($user_message); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $row&nbsp;=&nbsp;M(&quot;member&quot;)-&gt;where(&quot;m_weibo_openid=&#39;%s&#39;&quot;,$openid)-&gt;find();&nbsp;&nbsp;&nbsp;&nbsp; if($row){ &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;m_id&#39;,$row[&#39;m_id&#39;]); &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;m_nick_name&#39;,$row[&#39;m_nick_name&#39;]); &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;m_login_name&#39;,$row[&#39;m_login_name&#39;]); &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;is_org&#39;,-1); &nbsp;&nbsp;&nbsp;&nbsp;//U(&#39;Home/Home/index&#39;,null,true,true); &nbsp;&nbsp;&nbsp;&nbsp;if(session(&#39;shebei&#39;)&nbsp;==&nbsp;1){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Wap/Home/index&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;; &nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&quot;;&lt;/script&gt;&amp;#39;; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&quot;;&lt;/script&gt;&amp;#39;;&nbsp;&nbsp;&nbsp;&nbsp; }else{&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;åˆ›å»ºæ–°ç”¨æˆ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count&nbsp;=&nbsp;M(&quot;member&quot;)-&gt;max(&#39;m_id&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$count++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rand&nbsp;=&nbsp;mt_rand(1000,9999);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; //$data[&#39;gender&#39;]&nbsp;&nbsp;=&nbsp;$gender;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $data[&#39;m_avatar&#39;]&nbsp;&nbsp;=&nbsp;$avatar;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $data[&#39;m_nick_name&#39;]&nbsp;&nbsp;=&nbsp;mb_substr($nickname,0,6,&quot;utf-8&quot;)&nbsp;.&nbsp;$count;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_login_name&#39;]&nbsp;=&nbsp;&#39;wb_&#39;.$rand.&#39;&#39;.$count;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;m_password&#39;]&nbsp;=&nbsp;md5(md5(time()));&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; $data[&#39;m_weibo_openid&#39;]&nbsp;&nbsp;=&nbsp;$openid;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;$data[&#39;from&#39;]&nbsp;=&nbsp;&#39;weibo&#39;; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;session(&#39;kj_object&#39;,$data); &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; if(session(&#39;shebei&#39;)&nbsp;==&nbsp;1){&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Wap/Guide/binding&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;; &nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;script&gt;window.close();window.opener.location.href=&quot;http://www.13sai.com&#39;.U(&#39;Home/Guide/binding&#39;).&#39;&quot;;&lt;/script&gt;&amp;#39;; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //è·³è½¬åˆ°ä¼šå‘˜ä¸­å¿ƒ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo&nbsp;&#39;æˆæƒå¤±è´¥&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;} }å‰å°è°ƒç”¨æ¯”è¾ƒç®€å•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;yijian&nbsp;wd-center&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;class=&quot;wd-left&quot;&gt;ä½¿ç”¨å…¶ä»–è´¦å·ç™»å½•&lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;onclick=&quot;toQzoneLogin()&quot;&nbsp;class=&quot;other_login&nbsp;other_login_qq&quot;&gt;&lt;img&nbsp;src=&quot;/webui/home/images/Q.png&quot;&gt;&lt;/a&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;onclick=&quot;toWeiboLogin()&quot;&gt;&lt;img&nbsp;src=&quot;/webui/home/images/weibo.png&quot;&gt;&lt;/a&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;/div&amp;gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;script&gt;function&nbsp;toQzoneLogin(){ var&nbsp;A=window.open(&quot;http://www.ayanglao.org.cn{:U(&#39;Home/OAuth/qqLogin&#39;,&#39;&#39;,false)}/&quot;+Math.random(),&quot;TencentLogin&quot;,&quot;width=600,height=480,menubar=0,scrollbars=1,&nbsp;resizable=1,status=1,titlebar=0,toolbar=0,location=1&quot;);} function&nbsp;toWeiboLogin(){ var&nbsp;A=window.open(&quot;http://www.ayanglao.org.cn{:U(&#39;Home/OAuth/weiboLogin&#39;,&#39;&#39;,false)}/&quot;+Math.random(),&quot;WeiboLogin&quot;,&quot;width=450,height=320,menubar=0,scrollbars=1,&nbsp;resizable=1,status=1,titlebar=0,toolbar=0,location=1&quot;);}&lt;/script&gt;è¿™æ ·å°±okäº†ã€‚ä¸‹æ¬¡è¯´è¯´å¾®ä¿¡ç™»å½•ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"},{"name":"api","slug":"PHP/api","permalink":"https://github.13sai.com/categories/PHP/api/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"è§£å†³ThinkPHPå¤šæ–‡ä»¶ä¸Šä¼ é‡åçš„é—®é¢˜","slug":"è§£å†³ThinkPHPå¤šæ–‡ä»¶ä¸Šä¼ é‡åçš„é—®é¢˜","date":"2016-09-04T07:29:32.000Z","updated":"2022-03-19T14:35:21.941Z","comments":true,"path":"2016/09/04/68/","link":"","permalink":"https://github.13sai.com/2016/09/04/68/","excerpt":"","text":"å‰å‡ å¤©å¼€å‘æ—¶ï¼Œéœ€è¦åŒæ—¶ä¸Šä¼ ä¸¤å¼ å›¾ï¼Œä½†æ€»å‡ºç°é—®é¢˜ï¼Œæ‰“å¼€æç¤ºï¼Œæ˜¾ç¤ºçš„äº‹æ–‡ä»¶åå·²å­˜åœ¨ã€‚ å„ç§æœç´¢ï¼Œæ²¡æ‰¾åˆ°è§£å†³æ–¹æ³•ï¼Œç„¶åå°±æ”¹æˆäº†uploadifyä¸Šä¼ ï¼Œä½†æ²»æ ‡ä¸æ²»æœ¬ï¼ŒåŒäº‹è¯´å¯ä»¥ä¿®æ”¹uploadFileçš„ç±»ï¼Œè·å–savenameæ—¶å¢åŠ éšæœºæ•°ã€‚ ä¿®æ”¹savename private function getSaveName($filename) &#123; $rand = mt_rand(1000,9999); //ç”Ÿæˆäº”ä½éšæœºæ•° $rule = $this-&gt;saveRule; if(empty($rule)) &#123;//æ²¡æœ‰å®šä¹‰å‘½åè§„åˆ™ï¼Œåˆ™ä¿æŒæ–‡ä»¶åä¸å˜ $saveName = $filename[&#x27;name&#x27;]; &#125;else &#123; if(function_exists($rule)) &#123; //ä½¿ç”¨å‡½æ•°ç”Ÿæˆä¸€ä¸ªå”¯ä¸€æ–‡ä»¶æ ‡è¯†å· åŠ å…¥éšæœºæ•° $saveName = $rule().$rand.&quot;.&quot;.$filename[&#x27;extension&#x27;]; &#125;else &#123; //ä½¿ç”¨ç»™å®šçš„æ–‡ä»¶åä½œä¸ºæ ‡è¯†å· $saveName = $rule.$rand.&quot;.&quot;.$filename[&#x27;extension&#x27;]; &#125; &#125; if($this-&gt;autoSub) &#123; // ä½¿ç”¨å­ç›®å½•ä¿å­˜æ–‡ä»¶ $filename[&#x27;savename&#x27;] = $saveName; $saveName = $this-&gt;getSubName($filename).$saveName; &#125; return $saveName; &#125; è¿™æ ·å°±å‡ ä¹ä¸ä¼šå‡ºç°åŒåçš„æƒ…å†µäº†ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"uploadifyçš„ä½¿ç”¨","slug":"uploadifyçš„ä½¿ç”¨","date":"2016-09-02T12:22:17.000Z","updated":"2022-03-19T14:35:21.815Z","comments":true,"path":"2016/09/02/67/","link":"","permalink":"https://github.13sai.com/2016/09/02/67/","excerpt":"","text":"Uploadifyæ˜¯JQueryçš„ä¸€ä¸ªä¸Šä¼ æ’ä»¶ï¼Œå®ç°çš„æ•ˆæœéå¸¸ä¸é”™ï¼Œå¸¦è¿›åº¦æ˜¾ç¤ºã€‚æˆ‘ç”¨çš„ç‰ˆæœ¬æ˜¯2.2.&lt;!DOCTYPE&nbsp;html&gt; &lt;html&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;include&nbsp;file=&quot;./Tpl/head&quot;&nbsp;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--å¼•ç”¨css--&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;link&nbsp;href=&quot;/Skin/public/uploadify/uploadify.css&quot;&nbsp;type=&quot;text/css&quot;&nbsp;rel=&quot;stylesheet&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;include&nbsp;file=&quot;./Tpl/top&quot;&nbsp;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;main-container&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;id=&quot;menu-toggler&quot;&nbsp;href=&quot;#&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;include&nbsp;file=&quot;./Tpl/left&quot;&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;breadcrumbs&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&nbsp;type=&quot;text/javascript&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try{ace.settings.check(&#39;breadcrumbs&#39;&nbsp;,&nbsp;&#39;fixed&#39;)}catch(e){}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/script&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;i&nbsp;class=&quot;icon-home&nbsp;home-icon&quot;&gt;&lt;/i&gt;&lt;a&nbsp;href=&quot;{:U(&#39;/Admin/Index/index&#39;)}&quot;&gt;ç®¡ç†åå°&lt;/a&gt;&lt;/li&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;{$column_name}ç®¡ç†&lt;/li&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;ä¿®æ”¹&lt;/li&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;&lt;!â€“&nbsp;.breadcrumb&nbsp;â€“&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;widget-header&nbsp;widget-header-small&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h5&gt;ä¿®æ”¹å†…å®¹&lt;/h5&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;id=&quot;updateForm&quot;&nbsp;action=&quot;{:U(&#39;Admin/Home/caseUpdate&#39;)}&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method=&quot;POST&quot;&nbsp;enctype=&quot;multipart/form-data&quot;&nbsp;onsubmit=&quot;return&nbsp;jQuery(this).validationEngine(&#39;validate&#39;);&quot;&nbsp;role=&quot;form&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;name=&quot;c_id&quot;&nbsp;value=&quot;{$data.c_id}&quot;&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;name=&quot;httpref&quot;&nbsp;value=&quot;{$httpref}&quot;&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;col-sm-1&nbsp;control-label&nbsp;no-padding-right&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for=&quot;form-field-1&quot;&gt;&nbsp;æ ‡é¢˜&nbsp;&lt;/label&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;text&quot;&nbsp;name=&quot;c_name&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value=&quot;{$data[&#39;c_name&#39;]}&quot;&nbsp;placeholder=&quot;å¦‚ææ½‡æ½‡&quot;&nbsp;class=&quot;col-xs-10&nbsp;col-sm-5&nbsp;validate[required,maxSize[40]]&quot;&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;col-sm-1&nbsp;control-label&nbsp;no-padding-right&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for=&quot;form-field-1&quot;&gt;&nbsp;å¤´åƒ&nbsp;&lt;/label&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;file&quot;&nbsp;name=&quot;file_upload&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id=&quot;file_upload&quot;/&gt;&amp;nbsp;&amp;nbsp;å¤§å°223px431px;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;name=&quot;c_avatar&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id=&quot;c_avatar&quot;&nbsp;value=&quot;{$data[&#39;c_avatar&#39;]}&quot;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;img&nbsp;src=&quot;{$data[&#39;c_avatar&#39;]}&quot;&nbsp;style=&quot;width:&nbsp;80px;&nbsp;height:&nbsp;100px;&quot;&nbsp;id=&quot;newsimg&quot;&nbsp;class=&quot;newsimgpre&nbsp;uploadimg&quot;&gt;&lt;/p&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;clearfix&nbsp;form-actions&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;col-md-offset-1&nbsp;col-md-11&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;class=&quot;btn&nbsp;btn-info&quot;&nbsp;onclick=&quot;$(&#39;#updateForm&#39;).submit();&quot;&nbsp;type=&quot;button&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class=&quot;icon-ok&nbsp;bigger-110&quot;&gt;&lt;/i&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æäº¤&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/button&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;id=&quot;backid&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class=&quot;icon-undo&nbsp;bigger-110&quot;&gt;&lt;/i&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;è¿”å›åˆ—è¡¨&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;include&nbsp;file=&quot;./Tpl/bottom&quot;&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;href=&quot;#&quot;&nbsp;id=&quot;btn-scroll-up&quot;&nbsp;class=&quot;btn-scroll-up&nbsp;btn&nbsp;btn-sm&nbsp;btn-inverse&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;i&nbsp;class=&quot;icon-double-angle-up&nbsp;icon-only&nbsp;bigger-110&quot;&gt;&lt;/i&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/a&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;!â€“&nbsp;/.main-container&nbsp;â€“&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;include&nbsp;file=&quot;./Tpl/foot&quot;&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!â€“å¼•ç”¨jsâ€“&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;src=&quot;/Skin/public/uploadify/jquery.uploadify.min.js&quot;&gt;&lt;/script&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&gt;&nbsp;&nbsp;&nbsp;&nbsp;$(function(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#file_upload&#39;).uploadify({&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//æ³¨æ„è¿™é‡Œ&nbsp;&nbsp;uploadifyæ— æ³•ä¼ é€’session&nbsp;&nbsp;åªèƒ½é€šè¿‡formData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;formData&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;session_name();?&gt;&#39;&nbsp;:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;session_id();?&gt;&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;timestamp&#39;&nbsp;:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;$timestamp;?&gt;&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;token&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;md5(&#39;unique_salt&#39;&nbsp;.&nbsp;$timestamp);?&gt;&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;swf&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&#39;/Skin/public/uploadify/uploadify.swf&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;uploader&#39;&nbsp;:&nbsp;&quot;{:U(&#39;Admin/Home/uploadify&#39;)}&quot;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;buttonText&#39;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&#39;é€‰æ‹©å›¾ç‰‡&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;buttonClass&#39;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;&#39;upload_button&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;fileTypeDesc&#39;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&#39;å›¾ç‰‡æ–‡ä»¶&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;width&#39;:&#39;100px&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;height&#39;:&#39;50px&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&#39;fileTypeExts&#39;&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&#39;.gif;.jpg;.png;*.jpeg&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&#39;fileSizeLimit&#39;&nbsp;:&nbsp;&#39;50000&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;progressData&#39;:&nbsp;&#39;percentage&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;onUploadSuccess&#39;&nbsp;:&nbsp;function(file,&nbsp;data,&nbsp;response)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//var&nbsp;path=data;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//alert(data)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;data&nbsp;=&nbsp;JSON.parse(data);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(data.status&nbsp;==&nbsp;0){alert(&#39;ä¸Šä¼ å¤±è´¥&#39;);return&nbsp;false;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#newsimg&#39;).attr(&quot;src&quot;,data.data);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#c_avatar&#39;).val(data.data);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Your&nbsp;options&nbsp;here&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;actionpublic&nbsp;function&nbsp;uploadify()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;import(&#39;ORG.Net.UploadFile&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload&nbsp;=&nbsp;new&nbsp;UploadFile();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload-&gt;maxSize&nbsp;&nbsp;=&nbsp;20480000&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload-&gt;allowExts&nbsp;&nbsp;=&nbsp;array(&#39;jpg&#39;,&nbsp;&#39;jpeg&#39;,&nbsp;&#39;png&#39;,&nbsp;&#39;gif&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload-&gt;savePath&nbsp;=&nbsp;&nbsp;&#39;./Upload/case/&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload-&gt;saveRule&nbsp;=&nbsp;&#39;uniqid&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return&nbsp;&nbsp;=&nbsp;array(&#39;status&#39;&nbsp;=&gt;&nbsp;1,&nbsp;&#39;info&#39;&nbsp;=&gt;&nbsp;&#39;ä¸Šä¼ æˆåŠŸ&#39;,&nbsp;&#39;data&#39;&nbsp;=&gt;&nbsp;&#39;&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$upload-&gt;saveRule&nbsp;=&nbsp;&#39;getrand&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!$upload-&gt;upload()){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return[&#39;status&#39;]&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return[&#39;info&#39;]&nbsp;&nbsp;&nbsp;=&nbsp;$upload-&gt;getErrorMsg();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return[&#39;status&#39;]&nbsp;=&nbsp;1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info&nbsp;=&nbsp;&nbsp;$upload-&gt;getUploadFileInfo();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$return[&#39;data&#39;]&nbsp;&nbsp;&nbsp;=&nbsp;&#39;/Upload/case/&#39;.$info[0][savename];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;json_encode($return);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}å› ä¸ºè¿™æ˜¯åå°ä¸Šä¼ å›¾ç‰‡çš„åœ°æ–¹ï¼Œéœ€è¦é™åˆ¶æƒé™/å¤„ç†æƒé™/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$session_name&nbsp;=&nbsp;session_name();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//dump($session_name);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;$_POST[$session_name];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!isset($_POST[$session_name])){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_SESSION[&#39;u_name&#39;]&nbsp;==&nbsp;&#39;&#39;){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;error(&#39;ç™»å½•å·²è¶…æ—¶&#39;,&nbsp;U(&quot;Admin/Index/login&quot;),&nbsp;3);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}æ¥çœ‹çœ‹æ•ˆæœï¼Œè¿˜ä¸é”™å“Ÿï¼","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"phpçš„break","slug":"phpçš„break","date":"2016-08-23T12:51:30.000Z","updated":"2022-03-19T14:35:21.790Z","comments":true,"path":"2016/08/23/65/","link":"","permalink":"https://github.13sai.com/2016/08/23/65/","excerpt":"","text":"PHPä¸­çš„breakéå¸¸å¸¸è§ï¼Œç›¸ä¿¡å¤§å®¶éƒ½ç”¨è¿‡ã€‚ ä½†breakåé¢å¸¦å‚æ•°ä½ è§è¿‡å—ï¼Ÿ å‰ä¸¤å¤©é‡åˆ°ä¸ª3å±‚å¾ªç¯çš„é—®é¢˜ï¼Œå› ä¸ºéœ€è¦é™åˆ¶æ•°é‡ï¼Œä½¿ç”¨breakï¼Œä½†breakå‡ºæ¥ï¼Œå‘ç°é¡µé¢ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œç„¶åæœ‰è®°å¾—æœ‰è·³å‡ºå¤šå±‚å¾ªç¯çš„å‡½æ•°ï¼Œæœ€åå‘ç°åªéœ€è¦åœ¨breakåé¢åŠ ä¸Š2å°±å¯ä»¥è·³å‡ºä¸¤å±‚å¾ªç¯äº†ã€‚ &lt;ul class=&quot;friendlink-ul&quot;&gt; &lt;li class=&quot;friendlink-li&quot;&gt;å‹æƒ…é“¾æ¥&lt;/li&gt; &lt;volist name=&quot;cateList&quot; id=&quot;vo&quot;&gt; &lt;li class=&quot;friendlink-li&quot;&gt; &lt;ul&gt; &lt;?php $k = 0; ?&gt; &lt;volist name=&quot;friendlylinkList&quot; id=&quot;vof&quot;&gt; &lt;if condition=&quot;$vof[&#x27;link_cate_id&#x27;] eq $vo[&#x27;cate_id&#x27;]&quot;&gt; &lt;?php $k++; if($k&gt;5) break 2; ?&gt; &lt;li&gt;&lt;a href=&quot;&#123;$vof[&#x27;linkUrl&#x27;]&#125;&quot; target=&quot;_blank&quot; title=&quot;&#123;$vof[&#x27;linkName&#x27;]&#125;&quot;&gt;&#123;:msubstr($vof[&#x27;linkName&#x27;], 0, 20, &#x27;utf-8&#x27;, false)&#125;&lt;/a&gt;&lt;/li&gt; &lt;/if&gt; &lt;/volist&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/volist&gt; &lt;/ul&gt; æ˜¯ä¸æ˜¯å¾ˆå¥½ç”¨ï¼Ÿ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"MySQLæ•°æ®ç±»å‹å’Œå¸¸ç”¨å­—æ®µå±æ€§","slug":"MySQLæ•°æ®ç±»å‹å’Œå¸¸ç”¨å­—æ®µå±æ€§","date":"2016-08-10T08:14:07.000Z","updated":"2022-06-02T02:51:32.167Z","comments":true,"path":"2016/08/10/64/","link":"","permalink":"https://github.13sai.com/2016/08/10/64/","excerpt":"","text":"ä¸€ç›´ä»¥ä¸ºint(11)å°±å¯ä»¥å­˜å‚¨11ä½çš„æ•°å­—ï¼ŒåŸæ¥è¿™æ˜¯ä¸æ­£ç¡®çš„ã€‚ç½‘ä¸Šæœæœï¼Œæ€»ç»“å¦‚ä¸‹ï¼šMySQLä¸­çš„æ•°æ®ç±»å‹å¤§çš„æ–¹é¢æ¥åˆ†ï¼Œå¯ä»¥åˆ†ä¸ºï¼šæ—¥æœŸå’Œæ—¶é—´ã€æ•°å€¼ï¼Œä»¥åŠå­—ç¬¦ä¸²ã€‚æ—¥æœŸå’Œæ—¶é—´æ•°æ®ç±»å‹MySQLæ•°æ®ç±»å‹å«ä¹‰date3å­—èŠ‚ï¼Œæ—¥æœŸï¼Œæ ¼å¼ï¼š2014-09-18time3å­—èŠ‚ï¼Œæ—¶é—´ï¼Œæ ¼å¼ï¼š08:42:30datetime8å­—èŠ‚ï¼Œæ—¥æœŸæ—¶é—´ï¼Œæ ¼å¼ï¼š2014-09-18 08:42:30timestamp4å­—èŠ‚ï¼Œæ—¶é—´æˆ³ï¼Œæ ¼å¼ï¼š2014-09-18 08:42:30year1å­—èŠ‚ï¼Œå¹´ä»½æ•°å€¼æ•°æ®ç±»å‹æ•´å‹MySQLæ•°æ®ç±»å‹å«ä¹‰ï¼ˆæœ‰ç¬¦å·ï¼‰tinyint1å­—èŠ‚ï¼ŒèŒƒå›´ï¼ˆ-128~127ï¼‰ä¸€ç›´è¯¯ä¼šäº†smallint2å­—èŠ‚ï¼ŒèŒƒå›´ï¼ˆ-32768~32767ï¼‰mediumint3å­—èŠ‚ï¼ŒèŒƒå›´ï¼ˆ-8388608~8388607ï¼‰int4å­—èŠ‚ï¼ŒèŒƒå›´ï¼ˆ-2147483648~2147483647ï¼‰bigint8å­—èŠ‚ï¼ŒèŒƒå›´ï¼ˆ+-9.22*10çš„18æ¬¡æ–¹ï¼‰ä¸Šé¢å®šä¹‰çš„éƒ½æ˜¯æœ‰ç¬¦å·çš„ï¼Œå½“ç„¶äº†ï¼Œä¹Ÿå¯ä»¥åŠ ä¸Šunsignedå…³é”®å­—ï¼Œå®šä¹‰æˆæ— ç¬¦å·çš„ç±»å‹ï¼Œé‚£ä¹ˆå¯¹åº”çš„å–å€¼èŒƒå›´å°±è¦ç¿»ç¿»äº†ï¼Œæ¯”å¦‚ï¼štinyint unsignedçš„å–å€¼èŒƒå›´ä¸º0~255ã€‚æµ®ç‚¹å‹MySQLæ•°æ®ç±»å‹å«ä¹‰float(m, d)4å­—èŠ‚ï¼Œå•ç²¾åº¦æµ®ç‚¹å‹ï¼Œmæ€»ä¸ªæ•°ï¼Œdå°æ•°ä½double(m, d)8å­—èŠ‚ï¼ŒåŒç²¾åº¦æµ®ç‚¹å‹ï¼Œmæ€»ä¸ªæ•°ï¼Œdå°æ•°ä½decimal(m, d)decimalæ˜¯å­˜å‚¨ä¸ºå­—ç¬¦ä¸²çš„æµ®ç‚¹æ•°æˆ‘åœ¨MySQLä¸­å»ºç«‹äº†ä¸€ä¸ªè¡¨ï¼Œæœ‰ä¸€åˆ—ä¸ºfloat(5, 3)ï¼›åšäº†ä»¥ä¸‹è¯•éªŒï¼š1.æ’å…¥123.45678ï¼Œæœ€åæŸ¥è¯¢å¾—åˆ°çš„ç»“æœä¸º99.999ï¼›2.æ’å…¥123.456ï¼Œæœ€åæŸ¥è¯¢ç»“æœä¸º99.999ï¼›3.æ’å…¥12.34567ï¼Œæœ€åæŸ¥è¯¢ç»“æœä¸º12.346ï¼›æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨æµ®ç‚¹å‹çš„æ—¶å€™ï¼Œè¿˜æ˜¯è¦æ³¨æ„é™·é˜±çš„ï¼Œè¦ä»¥æ’å…¥æ•°æ®åº“ä¸­çš„å®é™…ç»“æœä¸ºå‡†ã€‚å­—ç¬¦ä¸²æ•°æ®ç±»å‹MySQLæ•°æ®ç±»å‹å«ä¹‰char(n)å›ºå®šé•¿åº¦ï¼Œæœ€å¤š255ä¸ªå­—ç¬¦varchar(n)å¯å˜é•¿åº¦ï¼Œæœ€å¤š65535ä¸ªå­—ç¬¦tinytextå¯å˜é•¿åº¦ï¼Œæœ€å¤š255ä¸ªå­—ç¬¦textå¯å˜é•¿åº¦ï¼Œæœ€å¤š65535ä¸ªå­—ç¬¦mediumtextå¯å˜é•¿åº¦ï¼Œæœ€å¤š2çš„24æ¬¡æ–¹-1ä¸ªå­—ç¬¦longtextå¯å˜é•¿åº¦ï¼Œæœ€å¤š2çš„32æ¬¡æ–¹-1ä¸ªå­—ç¬¦1.charï¼ˆnï¼‰å’Œvarcharï¼ˆnï¼‰ä¸­æ‹¬å·ä¸­nä»£è¡¨å­—ç¬¦çš„ä¸ªæ•°ï¼Œå¹¶ä¸ä»£è¡¨å­—èŠ‚ä¸ªæ•°ï¼Œæ‰€ä»¥å½“ä½¿ç”¨äº†ä¸­æ–‡çš„æ—¶å€™(UTF8)æ„å‘³ç€å¯ä»¥æ’å…¥mä¸ªä¸­æ–‡ï¼Œä½†æ˜¯å®é™…ä¼šå ç”¨m*3ä¸ªå­—èŠ‚ã€‚2.åŒæ—¶charå’Œvarcharæœ€å¤§çš„åŒºåˆ«å°±åœ¨äºcharä¸ç®¡å®é™…valueéƒ½ä¼šå ç”¨nä¸ªå­—ç¬¦çš„ç©ºé—´ï¼Œè€Œvarcharåªä¼šå ç”¨å®é™…å­—ç¬¦åº”è¯¥å ç”¨çš„ç©ºé—´+1ï¼Œå¹¶ä¸”å®é™…ç©ºé—´+1&lt;=nã€‚3.è¶…è¿‡charå’Œvarcharçš„nè®¾ç½®åï¼Œå­—ç¬¦ä¸²ä¼šè¢«æˆªæ–­ã€‚4.charçš„ä¸Šé™ä¸º255å­—èŠ‚ï¼Œvarcharçš„ä¸Šé™65535å­—èŠ‚ï¼Œtextçš„ä¸Šé™ä¸º65535ã€‚5.charåœ¨å­˜å‚¨çš„æ—¶å€™ä¼šæˆªæ–­å°¾éƒ¨çš„ç©ºæ ¼ï¼Œvarcharå’Œtextä¸ä¼šã€‚6.varcharä¼šä½¿ç”¨1-3ä¸ªå­—èŠ‚æ¥å­˜å‚¨é•¿åº¦ï¼Œtextä¸ä¼šã€‚é€‰æ‹©åŸåˆ™ï¼š1ã€é€šå¸¸æœ€å°çš„æ˜¯æœ€å¥½çš„&nbsp; &nbsp; &nbsp;å› ä¸ºè¿™æ ·å¯ä»¥ç”¨æ›´å°‘çš„ç£ç›˜ã€å†…å®¹ã€CPUç¼“å­˜ï¼Œå¤§å¤§å‡å°‘IOå¼€é”€ï¼Œå½“ç„¶å‰ææ˜¯æ»¡è¶³ä¸šåŠ¡éœ€è¦ã€‚2ã€ç®€å•å°±å¥½&nbsp; &nbsp; &nbsp;ç®€å•çš„æ•°æ®ç±»å‹æ“ä½œé€šå¸¸éœ€è¦æ›´å°‘çš„CPUå‘¨æœŸã€‚ä¾‹å¦‚ï¼Œæ•´å‹æ¯”å­—ç¬¦æ“ä½œä»£ä»·æ›´å°ï¼Œå› ä¸ºå­—ç¬¦é›†å’Œæ ¡å¯¹è§„åˆ™ï¼ˆæ’åºè§„åˆ™ï¼‰ä½¿å®ƒæ¯”æ•´å‹æ›´å¤æ‚ã€‚æ¯”å¦‚åº”è¯¥ä½¿ç”¨MySQLå†…å»ºçš„ç±»å‹è€Œä¸æ˜¯ä½¿ç”¨å­—ç¬¦å‹æ¥å­˜å‚¨æ—¥æœŸå’Œæ—¶é—´ã€‚3ã€å°½é‡é¿å…ä½¿ç”¨NULL&nbsp; &nbsp; &nbsp;NULLæ˜¯åˆ—é»˜è®¤çš„å±æ€§ï¼Œé€šå¸¸æˆ‘ä»¬è¦æŒ‡å®šä¸ºNOT NULLã€‚æœ‰NULLçš„åˆ—å€¼ä¼šä½¿å¾—ç´¢å¼•ã€ç´¢å¼•ç»Ÿè®¡å’Œå€¼æ¯”è¾ƒæ›´åŠ å¤æ‚ã€‚å¯ä¸ºNULLçš„åˆ—ä¼šä½¿ç”¨æ›´å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œåœ¨MySQLä¸­ä¹Ÿéœ€è¦å¯¹å®ƒè¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œå½“å¯ ä¸ºNULLåˆ—åšç´¢å¼•æ—¶ï¼Œæ¯ä¸ªç´¢å¼•éœ€è¦ä¸€ä¸ªé¢å¤–çš„å­—èŠ‚ï¼Œåœ¨MyISAMæ›´æœ‰å¯èƒ½å¯¼è‡´å›ºå®šå¤§å°çš„ç´¢å¼•å˜æˆå¯å˜å¤§å°ç´¢å¼•ï¼Œåœ¨InnoDBä¸­ä½¿ç”¨å•ç‹¬çš„ä½ (bit)å­˜å‚¨NULLå€¼ã€‚å°±è¿™äº›äº†ï¼Œå¤§éƒ¨åˆ†ç½‘ä¸Šè´´è¿‡æ¥çš„ã€‚","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"sql","slug":"sql","permalink":"https://github.13sai.com/tags/sql/"}]},{"title":"jsè·å–selectçš„å€¼","slug":"jsè·å–selectçš„å€¼","date":"2016-08-09T12:14:18.000Z","updated":"2022-03-19T14:35:21.751Z","comments":true,"path":"2016/08/09/63/","link":"","permalink":"https://github.13sai.com/2016/08/09/63/","excerpt":"","text":"æœ€è¿‘åšä¸€ä¸ªæ‰‹æœºé¡¹ç›®æ—¶ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ã€‚é€‰åˆ†ç±»æ—¶éœ€è¦æ ¹æ®ä¸åŒç±»å‹ï¼Œæ”¹å˜å­—æ®µã€‚ä¹‹å‰åŠ çš„æ˜¯ç‚¹å‡»äº‹ä»¶æ§åˆ¶æ˜¾éšï¼Œç«ç‹ååº”æ­£å¸¸ï¼Œä½†æ‰‹æœºä¸Šæ²¡æœ‰æ•ˆæœã€‚ä¸å¾—ä¸æŠ›å¼ƒè¿™ç§å†™æ³•ï¼Œæ”¹ä¸ºè·å–selecté€‰ä¸­optionå€¼åˆ¤æ–­ï¼Œæ¥æ§åˆ¶å­—æ®µæ˜¾éšã€‚ç‚¹å‡»æ§åˆ¶çš„ä»£ç å°±ä¸å†™äº†ï¼Œæ¯”è¾ƒç®€å•ï¼Œè´´ä¸Šè·å–selectæ–¹æ³•ä»£ç ï¼š&lt;!--&nbsp;ä¸»ä½“&nbsp;--&gt; &lt;div&nbsp;class=&quot;am-container&nbsp;am-margin-top&nbsp;reg&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-tabs-bd&nbsp;sai-noborder&nbsp;am-margin-top&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-tab-panel&nbsp;sai-nopadding&nbsp;am-active&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;form&nbsp;method=&quot;post&quot;&nbsp;action=&quot;{:U(&#39;Wap/Index/reg2&#39;)}&quot;&nbsp;enctype=&quot;multipart/form-data&quot;&nbsp;&nbsp;id=&quot;form2&quot;&nbsp;class=&quot;am-form&nbsp;am-form-horizontal&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-form-group&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;reg-tab-li&nbsp;am-g&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;am-u-md-3&quot;&gt;å›¢ä½“åç§°ï¼š&lt;/label&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-u-md-9&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;text&quot;&nbsp;name=&quot;o_name&quot;&nbsp;class=&quot;login-text&nbsp;yan-tt&nbsp;nick&quot;&nbsp;placeholder=&quot;è¯·è¾“å…¥å›¢ä½“åç§°&quot;&gt;&lt;span&gt;&lt;/span&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;reg-tab-li&nbsp;am-g&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;am-u-md-3&quot;&gt;ç±»å‹ï¼š&lt;/label&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-u-md-9&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select&nbsp;name=&quot;o_type&quot;&nbsp;id=&quot;select&quot;&nbsp;onchange=&quot;getValue()&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;volist&nbsp;name=&quot;list_jigou&quot;&nbsp;id=&quot;vo&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value=&quot;{$vo[&#39;d_value&#39;]}&quot;&nbsp;&lt;if&nbsp;condition=&quot;$i&nbsp;neq&nbsp;4&quot;&gt;class=&quot;dd&quot;&nbsp;&lt;else/&gt;&nbsp;class=&quot;dd2&quot;&lt;/if&gt;&gt;{$vo[&#39;d_title&#39;]}&lt;/option&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/volist&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;daima2&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;reg-tab-li&nbsp;am-g&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;am-u-md-3&quot;&gt;è¯ä»¶å·ç ï¼š&lt;/label&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-u-md-9&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;text&quot;&nbsp;name=&quot;o_yingyezhizhao_no&quot;&nbsp;class=&quot;login-text&nbsp;yan-zhzh&quot;&nbsp;placeholder=&quot;è¯·è¾“å…¥ç­‰çº§è¯ä¹¦/è¥ä¸šæ‰§ç…§ç­‰ç›¸å…³è¯ä»¶å·ç &quot;&gt;&lt;span&gt;&lt;/span&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;reg-tab-li&nbsp;am-g&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;am-u-md-3&quot;&gt;ä¸Šä¼ æ‰«æä»¶ï¼š&lt;/label&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-u-md-9&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;file&quot;&nbsp;name=&quot;o_yingyezhizhao_img&nbsp;yan-required&quot;&nbsp;value=&quot;&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;daima&nbsp;sai-hide&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;reg-tab-li&nbsp;am-g&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;am-u-md-3&quot;&gt;å›¢ä½“ç®€ä»‹ï¼š&lt;/label&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-u-md-9&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;textarea&nbsp;name=&quot;o_desc&quot;&nbsp;rows=&quot;5&quot;&nbsp;class=&quot;yan-desc&quot;&nbsp;placeholder=&quot;è¯·ç®€å•ä»‹ç»ä¸‹æ‚¨æ‰€åœ¨çš„å›¢ä½“ï¼Œä¸è¶…è¿‡200å­—ï¼&quot;&gt;&lt;/textarea&gt;&lt;span&gt;&lt;/span&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;reg-tab-li&nbsp;am-g&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;am-u-md-3&quot;&gt;åˆ›å»ºå¯†ç ï¼š&lt;/label&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-u-md-9&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;password&quot;&nbsp;name=&quot;o_password&quot;&nbsp;class=&quot;login-text&nbsp;yan-pw&quot;&nbsp;placeholder=&quot;è¯·è¾“å…¥å¯†ç &quot;&gt;&lt;span&gt;&lt;/span&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;reg-tab-li&nbsp;am-g&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;am-u-md-3&quot;&gt;ç¡®è®¤å¯†ç ï¼š&lt;/label&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-u-md-9&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;password&quot;&nbsp;name=&quot;o_password2&quot;&nbsp;class=&quot;login-text&nbsp;yan-pw2&quot;&nbsp;placeholder=&quot;è¯·å†æ¬¡è¾“å…¥å¯†ç &quot;&gt;&lt;span&gt;&lt;/span&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;wd-h15&nbsp;wd-clear&quot;&gt;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;reg-tab-li&nbsp;am-g&nbsp;reg-tab-li&nbsp;am-g2&nbsp;am-margin-top&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;type=&quot;button&quot;&nbsp;class=&quot;l-btn&nbsp;btn2&nbsp;am-btn&nbsp;am-btn-block&nbsp;sai-bred&quot;&nbsp;onclick=&quot;sub2();&quot;&gt;æ³¨å†Œ&lt;/button&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;reg-tab-li&nbsp;am-g&nbsp;reg-tab-li&nbsp;am-g2&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;wd-fs12&nbsp;xieyi&quot;&nbsp;target=&quot;_blank&quot;&nbsp;href=&quot;{:U(&#39;Wap/Index/page&#39;,array(&#39;column_id&#39;=&gt;8))}&quot;&gt;æ³¨å†Œä»£è¡¨ä½ åŒæ„&lt;em&gt;ã€Šçˆ±å¾·å›½é™…ä»è°·æ³¨å†Œåè®®ã€‹&lt;/em&gt;&lt;/a&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &lt;/div&gt; &lt;script&gt;&nbsp;&nbsp;&nbsp;&nbsp;;function&nbsp;getValue(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ç¬¬ä¸€ç§æ–¹æ³•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;val=&nbsp;$(&quot;#select&nbsp;option:selected&quot;).val();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;val=&nbsp;$(&#39;#select&#39;).find(&quot;option:selected&quot;).val();/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ç¬¬äºŒç§æ–¹æ³•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;obj=&nbsp;document.getElementById(&#39;select&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;val&nbsp;=&nbsp;obj.selectedIndex;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;obj=&nbsp;document.getElementById(&#39;select&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;val&nbsp;=&nbsp;obj.options[obj.options.selectedIndex].value;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(val&nbsp;==&nbsp;3){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;.daima2&#39;).hide();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;.daima&#39;).show();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;.daima&#39;).hide();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;.daima2&#39;).show();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}};&lt;/script&gt;å½“ç„¶æ³¨é‡Šçš„ä¸¤ç§æ–¹æ³•ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œç²—ç²—æµ‹è¯•ä¸‹ï¼Œç«ç‹ä¹Ÿå…¼å®¹ã€‚æ˜¯ä¸æ˜¯å¾ˆå¥½ç”¨ï¼Ÿ","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"åˆ¤æ–­æ˜¯å¦ä¸ºå¾®ä¿¡å†…ç½®æµè§ˆå™¨","slug":"åˆ¤æ–­æ˜¯å¦ä¸ºå¾®ä¿¡å†…ç½®æµè§ˆå™¨","date":"2016-08-05T08:07:20.000Z","updated":"2022-03-19T14:35:21.879Z","comments":true,"path":"2016/08/05/62/","link":"","permalink":"https://github.13sai.com/2016/08/05/62/","excerpt":"","text":"åŸç†ï¼šè·å–å¾®ä¿¡å†…ç½®æµè§ˆå™¨çš„User Agentï¼Œå¹¶åŠ ä»¥åˆ¤æ–­ã€‚ç›´æ¥ä¸Šä»£ç ï¼šjsï¼šfunction&nbsp;isWeiXin(){ &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ua&nbsp;=&nbsp;window.navigator.userAgent.toLowerCase(); &nbsp;&nbsp;&nbsp;&nbsp;//var&nbsp;ua&nbsp;=&nbsp;navigator.userAgent.toLowerCase();&nbsp;äºŒé€‰ä¸€ &nbsp;&nbsp;&nbsp;&nbsp;if(ua.match(/MicroMessenger/i)&nbsp;==&nbsp;&#39;micromessenger&#39;){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(1); &nbsp;&nbsp;&nbsp;&nbsp;}else{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(0); }phpfunction&nbsp;isWeixin(){&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;strpos($_SERVER[&#39;HTTP_USER_AGENT&#39;],&nbsp;&#39;MicroMessenger&#39;)&nbsp;!==&nbsp;false&nbsp;)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true; &nbsp;&nbsp;&nbsp;&nbsp;}else{ return&nbsp;false; &nbsp;&nbsp;&nbsp;&nbsp;} }","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"jQueryåˆ¤æ–­checkboxæ˜¯å¦é€‰ä¸­çš„æ–¹æ³•","slug":"jQueryåˆ¤æ–­checkboxæ˜¯å¦é€‰ä¸­çš„æ–¹æ³•","date":"2016-08-03T06:59:35.000Z","updated":"2022-03-19T14:35:21.718Z","comments":true,"path":"2016/08/03/61/","link":"","permalink":"https://github.13sai.com/2016/08/03/61/","excerpt":"","text":"éœ€è¦åšä¸€ä¸ªå¿…é¡»å‹¾é€‰åè®®æ‰èƒ½è´­ä¹°çš„è¡¨å•ï¼Œå¾€å¾€è¦åˆ¤æ–­æ˜¯å¦å‹¾é€‰checkboxï¼Œä¹‹å‰é‡åˆ°è¿‡ï¼Œä½†æ²¡æœ‰å¥½å¥½è§£å†³ï¼Œè¿™æ¬¡åˆé‡åˆ°ï¼Œè¾¹å½»åº•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å…¶å®è¿™ä¸ªé—®é¢˜çš„æ ¸å¿ƒæ˜¯è·å–checkedå±æ€§çš„é—®é¢˜å¹¶åŠ ä»¥åˆ¤æ–­ï¼Œç½‘ä¸Šæ–‡ç« å¾ˆå¤šï¼Œå¤§è‡´æ–¹æ³•æœ‰ä¸‰ï¼š&lt;form&nbsp;role=&quot;form&quot;&nbsp;action=&quot;&quot;&nbsp;method=&quot;post&quot;&nbsp;onsubmit=&quot;return&nbsp;jQuery(this).validationEngine(&#39;validate&#39;);&quot;&nbsp;id=&quot;form&quot;&gt; &nbsp;&nbsp;&lt;div&nbsp;class=&quot;box-body&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;form-group&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;for=&quot;m_login_name&quot;&gt;è´­ä¹°æ•°é‡&lt;/label&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;text&quot;&nbsp;name=&quot;d_number&quot;&nbsp;class=&quot;validate[required,maxSize[10],custom[number]]&nbsp;form-control&quot;&nbsp;placeholder=&quot;è¯·å¡«å†™æ•°å­—,å•ä½ï¼šä¸ª&quot;&nbsp;data-prompt-position=&quot;topLeft&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;form-group&quot;&nbsp;style=&quot;height:&nbsp;100px;&nbsp;overflow-x:&nbsp;hidden;&nbsp;overflow-y:&nbsp;scroll;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;#d2d6de;;&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åè®®å†…å®¹ &nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;form-group&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;checkbox&quot;&nbsp;id=&quot;check&quot;&nbsp;checked/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;for=&quot;m_login_name&quot;&gt;æˆ‘åŒæ„ã€Šåè®®ã€‹&lt;/label&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;box-footer&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;type=&quot;button&quot;&nbsp;class=&quot;btn&nbsp;btn-primary&quot;&nbsp;id=&quot;buy&quot;&gt;ç«‹å³è´­ä¹°&lt;/button&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&lt;/div&gt; &lt;/form&gt;ç¬¬ä¸€ç§is(&#39;:checked&#39;) &lt;script&nbsp;type=&quot;text/javascript&quot;&gt; ;$(function(){ &nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#buy&#39;).on(&#39;click&#39;,function(){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;isCheck&nbsp;=&nbsp;$(&#39;#check&#39;).is(&#39;:checked&#39;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alertï¼ˆisCheck&nbsp;ï¼‰ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}); }) &lt;/script&gt;ç¬¬äºŒç§attr(&#39;checked&#39;) &lt;script&nbsp;type=&quot;text/javascript&quot;&gt; ;$(function(){ &nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#buy&#39;).on(&#39;click&#39;,function(){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;isCheck&nbsp;=&nbsp;$(&#39;#check&#39;).attr(&#39;checked&#39;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alertï¼ˆisCheck&nbsp;ï¼‰ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}); }) &lt;/script&gt;ç¬¬ä¸‰ç§checked &lt;script&nbsp;type=&quot;text/javascript&quot;&gt; ;$(function(){ &nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#buy&#39;).on(&#39;click&#39;,function(){ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;isCheck&nbsp;=&nbsp;$(&#39;#check&#39;).checked; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alertï¼ˆisCheck&nbsp;ï¼‰ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}); }) &lt;/script&gt;äº²æµ‹ï¼ˆfirefoxï¼Œchromeï¼‰ï¼Œä»…æœ‰is(&#39;:checked&#39;)æˆåŠŸè·å–ï¼Œé€‰ä¸­åˆ™trueï¼Œæœªé€‰ä¸­åˆ™ä¸ºfalseã€‚atträ¼šæ ¹æ®åˆå§‹å€¼ï¼Œè‹¥åˆå§‹å€¼é€‰ä¸­å°±æ˜¯checkedï¼Œå¦åˆ™undefinedï¼Œç‚¹å‡»é€‰æ‹©æ—¶ä¸ä¼šå˜åŒ–å€¼ã€‚checkedåˆ™ä¸€ç›´éƒ½æ˜¯undefinedã€‚ç„¶åæƒ³åˆ°ä¸Šæ¬¡ç”¨åˆ°çš„propï¼Œæ›¿æ¢æ‰attrï¼ŒæˆåŠŸè·å–ï¼Œé€‰ä¸­åˆ™trueï¼Œæœªé€‰ä¸­åˆ™ä¸ºfalseã€‚ç»“è¯­ï¼šè·å–checkboxè¯·ä½¿ç”¨prop(&#39;checked&#39;)æˆ–is(&#39;:checked&#39;)ï¼Œé‚£ä»€ä¹ˆéƒ½æ˜¯éª—äººçš„ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"è¡¨å•ä¸­submitæäº¤å¤±è´¥çš„é—®é¢˜","slug":"è¡¨å•ä¸­submitæäº¤å¤±è´¥çš„é—®é¢˜","date":"2016-08-02T12:05:41.000Z","updated":"2022-03-19T14:35:21.940Z","comments":true,"path":"2016/08/02/60/","link":"","permalink":"https://github.13sai.com/2016/08/02/60/","excerpt":"","text":"æ˜¨å¤©å¼€å‘æ—¶é‡åˆ°ä¸ªè¡¨å•ä¸èƒ½æäº¤çš„é—®é¢˜ï¼Œåå¤æ£€æŸ¥ä»£ç ä¼¼ä¹éƒ½æ¯«æ— é—®é¢˜ï¼Œä¸å¾—ä¸å¯»æ‰¾ç­”æ¡ˆï¼Œå‘ç°äº†jqueryçš„è¿™ä¸ªé—®é¢˜ã€‚ ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š &lt;form role=&quot;form&quot; action=&quot;&quot; method=&quot;post&quot; onsubmit=&quot;return jQuery(this).validationEngine(&#x27;validate&#x27;);&quot; id=&quot;form&quot;&gt; &lt;div class=&quot;box-body&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;m_login_name&quot;&gt;è´­ä¹°å¤‡æ³¨&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;q_remark&quot; class=&quot;validate[required,maxSize[200]] form-control&quot; placeholder=&quot;è¯·å¡«å†™è´­ä¹°å¤‡æ³¨&quot; data-prompt-position=&quot;topLeft&quot;&gt; &lt;/div&gt; &lt;div class=&quot;box-footer&quot;&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; id=&quot;submit&quot; &gt;ç«‹å³è´­ä¹°&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;/form&gt; &lt;script src=&quot;/webui/adminlte/plugins/jQuery/jQuery-2.2.0.min.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;/Skin/public/layer/layer.min.js&quot;&gt;&lt;/script&gt; &lt;script&gt; $(function()&#123; $(&quot;#submit&quot;).on(&#x27;click&#x27;,function()&#123; var obj = $(this); var conload = layer.confirm(&#x27;ç¡®å®šè´­ä¹°å—ï¼Ÿ&#x27;, function()&#123; layer.close(conload); $(&#x27;#form&#x27;).submit(); &#125;); &#125;) &#125;) &lt;/script&gt; ç„¶åæœåˆ°åŒæ ·çš„é—®é¢˜ï¼Œè´´ä¸Šjquery apiä¸Šçš„è¯´æ˜ï¼š Additional Notes:Forms and their child elements should not use input names or ids that conflict with properties of a form, such as submit, length, or method. Name conflicts can cause confusing failures. For a complete list of rules and to check your markup for these problems, see DOMLint. è¡¨å•åŠå…¶å­å…ƒç´ ä¸åº”ä½¿ç”¨ä¸è¡¨å•ä½œä¸ºnameæˆ–idçš„åç§°ï¼Œå¦‚submit, length, or method,åç§°å†²çªå¯èƒ½ä¼šå¯¼è‡´ä»¤äººå›°æƒ‘çš„å¤±è´¥ã€‚å¯¹äºä¸€ä¸ªå®Œæ•´çš„è§„åˆ™åˆ—è¡¨ï¼Œæ£€æŸ¥ä½ çš„æ ‡ç­¾å¯¹äºè¿™äº›é—®é¢˜ï¼ŒæŸ¥çœ‹DOMLintã€‚ å› è€Œå§buttonçš„idæ”¹æˆtijiaoï¼Œ &lt;form role=&quot;form&quot; action=&quot;&quot; method=&quot;post&quot; onsubmit=&quot;return jQuery(this).validationEngine(&#x27;validate&#x27;);&quot; id=&quot;form&quot;&gt; &lt;div class=&quot;box-body&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;m_login_name&quot;&gt;è´­ä¹°å¤‡æ³¨&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;q_remark&quot; class=&quot;validate[required,maxSize[200]] form-control&quot; placeholder=&quot;è¯·å¡«å†™è´­ä¹°å¤‡æ³¨&quot; data-prompt-position=&quot;topLeft&quot;&gt; &lt;/div&gt; &lt;div class=&quot;box-footer&quot;&gt; &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; id=&quot;tijiao&quot; &gt;ç«‹å³è´­ä¹°&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;/form&gt; &lt;script src=&quot;/webui/adminlte/plugins/jQuery/jQuery-2.2.0.min.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;/Skin/public/layer/layer.min.js&quot;&gt;&lt;/script&gt; &lt;script&gt; $(function()&#123; $(&quot;#tijiao&quot;).on(&#x27;click&#x27;,function()&#123; var obj = $(this); var conload = layer.confirm(&#x27;ç¡®å®šè´­ä¹°å—ï¼Ÿ&#x27;, function()&#123; layer.close(conload); $(&#x27;#form&#x27;).submit(); &#125;); &#125;) &#125;) &lt;/script&gt; æˆåŠŸæäº¤è¡¨å•ï¼Œso amazingï¼ ä»¥ååŠ¡å¿…è¦æ³¨æ„classå’Œidçš„å‘½åä¸è¦å’Œä¿ç•™åå†²çªå•¦ï¼","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"html","slug":"html","permalink":"https://github.13sai.com/tags/html/"}]},{"title":"ThinkPHPåˆ†é¡µæ ·å¼","slug":"ThinkPHPåˆ†é¡µæ ·å¼","date":"2016-08-01T02:55:10.000Z","updated":"2022-03-19T14:35:21.647Z","comments":true,"path":"2016/08/01/59/","link":"","permalink":"https://github.13sai.com/2016/08/01/59/","excerpt":"","text":"åˆ†é¡µæ¨¡å—ä»£ç ä½ç½®ï¼š/ThinkPHP/Extend/Library/ORG/Util/page.class.phpã€‚ å¦‚æœ‰éœ€è¦ï¼Œå¯è‡ªè¡Œä¿®æ”¹ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸ç”¨ä¿®æ”¹ï¼Œå¯ä»¥åœ¨Actionä¸­è®¾ç½®æ ·å¼ã€‚setConfigå¯ä»¥ä¿®æ”¹ä¸»é¢˜æ ·å¼ï¼ŒrollPageå¯ä»¥é™åˆ¶é¡µç æ˜¾ç¤ºæ•°é‡ã€‚ ä¸Šå®ä¾‹ï¼šï¼ˆä¼šå‘˜åˆ—è¡¨åˆ†é¡µï¼‰ public function memberList()&#123; $m = M(&quot;member&quot;); import(&#x27;ORG.Util.Page&#x27;); $count = $m-&gt;where(&#x27;status = 1&#x27;)-&gt;count(); //æŸ¥è¯¢å‡ºæ€»æ¡æ•° $page=new Page($count,10); $show = $Page-&gt;show(); $Page-&gt;rollPage = 4; //é¡µç æ˜¾ç¤ºæ•°é‡ $page-&gt;setConfig(&#x27;header&#x27;,&#x27;ä¸ªä¼šå‘˜&#x27;); $page-&gt;setConfig(&#x27;prev&#x27;,&#x27;ä¸Šä¸€é¡µ&#x27;); $page-&gt;setConfig(&#x27;next&#x27;,&#x27;ä¸‹ä¸€é¡µ&#x27;); $page-&gt;setConfig(&#x27;first&#x27;,&#x27;é¦–é¡µ&#x27;); $page-&gt;setConfig(&#x27;last&#x27;,&#x27;å°¾é¡µ&#x27;); $page-&gt;setConfig(&#x27;theme&#x27;,&quot;&lt;span&gt;å…±%totalRow%%header% %nowPage%/%totalPage% é¡µ %first% %prePage% %upPage% %linkPage% %downPage% %nextPage% %end%&lt;/span&gt;&quot;); //ä¸»é¢˜æ ·å¼ $list = $m-&gt;where(&#x27;status = 1&#x27;) -&gt;order(&#x27;insert_time DESC&#x27;) -&gt;limit($Page-&gt;firstRow.&#x27;,&#x27;.$Page-&gt;listRows)-&gt;select(); $this-&gt;assign(&#x27;list&#x27;,$list); $this-&gt;assign(&#x27;page&#x27;,$show); $this-&gt;display(); &#125; æ ·å¼å•¥çš„å°±ä¸è¯´äº†ï¼Œéƒ½æ˜¯CSSä¿®æ”¹ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"WebUploaderçš„ä½¿ç”¨ï¼ˆç»“åˆThinkPHPï¼‰","slug":"WebUploaderçš„ä½¿ç”¨ï¼ˆç»“åˆThinkPHPï¼‰","date":"2016-07-18T03:07:54.000Z","updated":"2022-03-19T14:35:21.657Z","comments":true,"path":"2016/07/18/58/","link":"","permalink":"https://github.13sai.com/2016/07/18/58/","excerpt":"","text":"åšä¸€ä¸ªç±»ä¼¼ç¤¾äº¤ç½‘ç«™çš„é¡¹ç›®ï¼Œç”¨åˆ°å¤šå›¾ä¸Šä¼ ï¼Œç„¶åäº†è§£äº†WebUploaderï¼Œä½†ç¬¬ä¸€æ¬¡ä½¿ç”¨æ²¡æœ‰æˆåŠŸï¼Œå¼ƒä¹‹ç”¨äº†swfuploadï¼Œç„¶ååšæ‰‹æœºç«™æ—¶ï¼Œå‘ç°å¦‚æœæ‰‹æœºæ²¡è£…flashï¼Œè¿™æ’ä»¶ç”¨ä¸äº†ï¼Œä¸å¾—ä¸å›å¤´ï¼Œç ”ç©¶ç”¨å…¶ä»–çš„html5+jsç»„ä»¶ä¸Šä¼ ï¼Œå¯æ•ˆæœéƒ½ä¸å¦‚æ„ï¼Œè‡ªå·±èƒ½åŠ›æœ‰é™ï¼Œé€ è½®å­å¤±è´¥ï¼Œå›å¤´åˆæ‹¾èµ·ç™¾åº¦çš„WebUploaderã€‚è¯´å®è¯ï¼Œè›®å–œæ¬¢ç™¾åº¦çš„å›¢é˜Ÿï¼Œä¹‹å‰ç”¨è¿‡ueditorï¼Œbaidumapï¼Œechartsç­‰ï¼Œæ•ˆæœéƒ½ä¸é”™ï¼ŒåŠŸèƒ½ä¹Ÿç»°ç»°æœ‰ä½™ï¼Œä½†WebUploaderç€å®èŠ±äº†æˆ‘ä¸å°‘æ—¶é—´ï¼Œä½†ç»ˆç©¶è¿˜æ˜¯æˆåŠŸè¿ç”¨äº†ï¼Œæ‰å‘ç°è‡ªå·±çŸ¥è¯†æœ‰é™ï¼Œèµ°äº†ä¸€åœˆå¼¯è·¯ã€‚æˆ‘ç”¨çš„æ˜¯ThinkPHPæ¡†æ¶ï¼Œå…ˆå»githubä¸‹è½½æœ€æ–°çš„WebUploaderï¼Œä¸»è¦ç”¨åˆ°çš„æ˜¯distä¸examplesã€‚apiæ–‡æ¡£ä»€ä¹ˆçš„ï¼Œç›´æ¥ç‚¹å‡»webuploaderï¼Œè®²çš„è¿˜è›®è¯¦ç»†ã€‚å‰å°ä»£ç ï¼š&lt;div&nbsp;id=&quot;wrapper&quot;&nbsp;style=&quot;display:&nbsp;none;&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;name=&quot;s&quot;&nbsp;id=&quot;photos&quot;/&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;container&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--å¤´éƒ¨ï¼Œç›¸å†Œé€‰æ‹©å’Œæ ¼å¼é€‰æ‹©--&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;uploader&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;queueList&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;dndArea&quot;&nbsp;class=&quot;placeholder&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;filePicker&quot;&gt;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;æˆ–å°†ç…§ç‰‡æ‹–åˆ°è¿™é‡Œï¼Œå•æ¬¡æœ€å¤šå¯é€‰9å¼ &lt;/p&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;statusBar&quot;&nbsp;style=&quot;display:none;&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;progress&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;text&quot;&gt;0%&lt;/span&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;percentage&quot;&gt;&lt;/span&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&lt;div&nbsp;class=&quot;info&quot;&gt;&lt;/div&gt;--&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;btns&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;filePicker2&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;uploadBtn&quot;&gt;å¼€å§‹ä¸Šä¼ &lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt; &lt;/div&gt; &lt;script&nbsp;src=&quot;http://libs.baidu.com/jquery/1.9.0/jquery.js&quot;&gt;&lt;/script&gt; &lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp; src=&quot;/Skin/public/webuploader/dist/webuploader.js&quot;&gt;&lt;/script&gt; //webuploaderæ•´ä¸ªæ”¾åœ¨/Skin/public/ç›®å½• &lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp; src=&quot;/Skin/public/webuploader/examples/image-upload/uploader.js&quot;&gt;&lt;/script&gt;uploader.jsæ”¹åŠ¨ï¼š//åå°å¤„ç†åœ°å€ server:&nbsp;&#39;{:U(&#39;Wap/Weibo/addImages&#39;)}&#39;, //é™åˆ¶å›¾ç‰‡æœ€å¤šä¸Šä¼ 9å¼  fileNumLimit:&nbsp;9, //å°†å›¾ç‰‡åœ°å€è¿”å›å‰å°ï¼Œä»¥ä¾¿åæœŸå†™å…¥æ•°æ®åº“uploader.on(&nbsp;&#39;uploadSuccess&#39;,&nbsp;function(&nbsp;file&nbsp;,response&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&nbsp;&#39;#&#39;+file.id&nbsp;).addClass(&#39;upload-state-done&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//response&nbsp;=&nbsp;JSON.parse(response)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initVal&nbsp;=&nbsp;$(&#39;#photos&#39;).val();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(initVal&nbsp;==&nbsp;&#39;&#39;){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#photos&#39;).val(response.info);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#photos&#39;).val(initVal+&#39;|&#39;+response.info);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});åå°public&nbsp;function&nbsp;addImages(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;import(&quot;ORG.Net.UploadFile&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//å¯¼å…¥ä¸Šä¼ ç±»&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload&nbsp;=&nbsp;new&nbsp;UploadFile();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload-&gt;maxSize&nbsp;&nbsp;=&nbsp;51200000;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload-&gt;allowExts&nbsp;&nbsp;=&nbsp;array(&#39;jpg&#39;,&nbsp;&#39;jpeg&#39;,&nbsp;&#39;png&#39;,&nbsp;&#39;gif&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload-&gt;savePath&nbsp;=&nbsp;&nbsp;&#39;./Upload/weibo/&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$upload-&gt;saveRule&nbsp;=&nbsp;&nbsp;&#39;uniqid&#39;;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!$upload-&gt;upload())&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//æ•è·ä¸Šä¼ å¼‚å¸¸&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;error($upload-&gt;getErrorMsg(),&#39;&#39;,3);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//å–å¾—æˆåŠŸä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ¯&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uploadList&nbsp;=&nbsp;$upload-&gt;getUploadFileInfo();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s&nbsp;=&nbsp;&#39;&#39;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for($i=0;$i&lt;count($uploadList);$i++){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//é™åˆ¶å›¾ç‰‡æ•°é‡&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($i&nbsp;&gt;&nbsp;8){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s&nbsp;.=&nbsp;&#39;/Upload/weibo/&#39;.$uploadList[$i][&#39;savename&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arr[&#39;info&#39;]&nbsp;=&nbsp;$s;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//ä¹Ÿå¯ç”¨ajaxReturnï¼Œæˆ‘ä¸ªäººä¹ æƒ¯è¿™æ ·å†™echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;json_encode($arr);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;}ç„¶åå°±okäº†ï¼Œæ ·å¼æˆ‘å°±ä¸è¯´äº†ï¼Œè‡ªå·±è°ƒæˆéœ€è¦çš„æ ·å­ã€‚æ˜¯ä¸æ˜¯å¾ˆå¥½ç”¨å‘¢ï¼Ÿ","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"EChartsä½¿ç”¨","slug":"EChartsä½¿ç”¨","date":"2016-07-08T12:22:57.000Z","updated":"2022-03-19T14:35:21.577Z","comments":true,"path":"2016/07/08/56/","link":"","permalink":"https://github.13sai.com/2016/07/08/56/","excerpt":"","text":"æœ€è¿‘åšé¡¹ç›®æ—¶ï¼Œè¦åŠ¨æ€è¯»å–æ•°æ®åšæˆå›¾è¡¨ï¼Œç„¶åå¬åŒäº‹æåˆ°ç™¾åº¦çš„EChartsï¼Œå¾ˆå¥½ç”¨ã€‚EChartsï¼Œä¸€ä¸ªçº¯ Javascript çš„å›¾è¡¨åº“ï¼Œå¯ä»¥æµç•…çš„è¿è¡Œåœ¨ PC å’Œç§»åŠ¨è®¾å¤‡ä¸Šï¼Œå…¼å®¹å½“å‰ç»å¤§éƒ¨åˆ†æµè§ˆå™¨ï¼ˆIE8/9/10/11ï¼ŒChromeï¼ŒFirefoxï¼ŒSafariç­‰ï¼‰ï¼Œåº•å±‚ä¾èµ–è½»é‡çº§çš„ Canvas ç±»åº“ ZRenderï¼Œæä¾›ç›´è§‚ï¼Œç”ŸåŠ¨ï¼Œå¯äº¤äº’ï¼Œå¯é«˜åº¦ä¸ªæ€§åŒ–å®šåˆ¶çš„æ•°æ®å¯è§†åŒ–å›¾è¡¨ã€‚ECharts æä¾›äº†å¸¸è§„çš„æŠ˜çº¿å›¾ï¼ŒæŸ±çŠ¶å›¾ï¼Œæ•£ç‚¹å›¾ï¼Œé¥¼å›¾ï¼ŒKçº¿å›¾ï¼Œç”¨äºç»Ÿè®¡çš„ç›’å½¢å›¾ï¼Œç”¨äºåœ°ç†æ•°æ®å¯è§†åŒ–çš„åœ°å›¾ï¼Œçƒ­åŠ›å›¾ï¼Œçº¿å›¾ï¼Œç”¨äºå…³ç³»æ•°æ®å¯è§†åŒ–çš„å…³ç³»å›¾ï¼Œtreemapï¼Œå¤šç»´æ•°æ®å¯è§†åŒ–çš„å¹³è¡Œåæ ‡ï¼Œè¿˜æœ‰ç”¨äº BI çš„æ¼æ–—å›¾ï¼Œä»ªè¡¨ç›˜ï¼Œå¹¶ä¸”æ”¯æŒå›¾ä¸å›¾ä¹‹é—´çš„æ··æ­ã€‚æ¥çœ‹çœ‹ä½¿ç”¨ï¼Œç›´æ¥ä¸Šä¾‹å­ï¼š&lt;!DOCTYPE&nbsp;html&gt; &lt;html&gt; &lt;head&gt; &lt;meta&nbsp;charset=&quot;utf-8&quot;&nbsp;/&gt; &lt;meta&nbsp;http-equiv=&quot;X-UA-Compatible&quot;&nbsp;content=&quot;IE=EmulateIE7&quot;&nbsp;/&gt; &lt;title&gt;ECharts&lt;/title&gt; &lt;/style&gt; &lt;script&nbsp;src=&quot;echarts.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div&nbsp;id=&quot;main&quot;&nbsp;style=&quot;width:&nbsp;600px;height:400px;&quot;&gt;&lt;/div&gt; &lt;script&nbsp;type=&quot;text/javascript&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartså®ä¾‹ &nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;myChart&nbsp;=&nbsp;echarts.init(document.getElementById(&#39;main&#39;)); &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;æŒ‡å®šå›¾è¡¨çš„é…ç½®é¡¹å’Œæ•°æ®&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;option&nbsp;=&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tooltip:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trigger:&nbsp;&#39;axis&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toolbox:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;feature:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataView:&nbsp;{show:&nbsp;true,&nbsp;readOnly:&nbsp;false},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magicType:&nbsp;{show:&nbsp;true,&nbsp;type:&nbsp;[&#39;line&#39;,&nbsp;&#39;bar&#39;]},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;restore:&nbsp;{show:&nbsp;true},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saveAsImage:&nbsp;{show:&nbsp;true}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:[&#39;è’¸å‘é‡&#39;,&#39;é™æ°´é‡&#39;,&#39;å¹³å‡æ¸©åº¦&#39;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xAxis:&nbsp;[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;&#39;category&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;[&#39;1æœˆ&#39;,&#39;2æœˆ&#39;,&#39;3æœˆ&#39;,&#39;4æœˆ&#39;,&#39;5æœˆ&#39;,&#39;6æœˆ&#39;,&#39;7æœˆ&#39;,&#39;8æœˆ&#39;,&#39;9æœˆ&#39;,&#39;10æœˆ&#39;,&#39;11æœˆ&#39;,&#39;12æœˆ&#39;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yAxis:&nbsp;[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;&#39;value&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;&#39;æ°´é‡&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min:&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max:&nbsp;250,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interval:&nbsp;50,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axisLabel:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatter:&nbsp;&#39;{value}&nbsp;ml&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;&#39;value&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;&#39;æ¸©åº¦&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min:&nbsp;0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max:&nbsp;25,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interval:&nbsp;5,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axisLabel:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatter:&nbsp;&#39;{value}&nbsp;Â°C&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;series:&nbsp;[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&#39;è’¸å‘é‡&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&#39;bar&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:[2.0,&nbsp;4.9,&nbsp;7.0,&nbsp;23.2,&nbsp;25.6,&nbsp;76.7,&nbsp;135.6,&nbsp;162.2,&nbsp;32.6,&nbsp;20.0,&nbsp;6.4,&nbsp;3.3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&#39;é™æ°´é‡&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&#39;bar&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:[2.6,&nbsp;5.9,&nbsp;9.0,&nbsp;26.4,&nbsp;28.7,&nbsp;70.7,&nbsp;175.6,&nbsp;182.2,&nbsp;48.7,&nbsp;18.8,&nbsp;6.0,&nbsp;2.3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&#39;å¹³å‡æ¸©åº¦&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&#39;line&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yAxisIndex:&nbsp;1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:[2.0,&nbsp;2.2,&nbsp;3.3,&nbsp;4.5,&nbsp;6.3,&nbsp;10.2,&nbsp;20.3,&nbsp;23.4,&nbsp;23.0,&nbsp;16.5,&nbsp;12.0,&nbsp;6.2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;}; &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ä½¿ç”¨åˆšæŒ‡å®šçš„é…ç½®é¡¹å’Œæ•°æ®æ˜¾ç¤ºå›¾è¡¨ã€‚&nbsp;&nbsp;&nbsp;&nbsp;myChart.setOption(option);&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;1.å¼•å…¥echarts.js2.åŠ æ•°æ®3.è°ƒç”¨ç®€å•å§ï¼ä¸‹é¢çœ‹çœ‹åŠ¨æ€æ·»åŠ æ•°æ®(php):å…ˆçœ‹æ•ˆæœï¼šä¸‰ç§æ•°æ®ï¼Œå¹´ä»½ï¼Œå®¶æ•°ï¼Œæ–¹é‡ã€‚è¾“å‡ºæ•°æ®ï¼ˆtpï¼‰ï¼špublic&nbsp;function&nbsp;szsn(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$where[&#39;c_type&#39;]&nbsp;=&nbsp;4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$c&nbsp;=&nbsp;M(&quot;charts&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//å–æœ€è¿‘7æ¡æ•°æ®&nbsp;&nbsp;æŒ‰å‡åºæ’åˆ—&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data111&nbsp;=&nbsp;array_reverse($c-&gt;where($where)-&gt;order(&#39;c_year&nbsp;desc&#39;)-&gt;limit(7)-&gt;getField(&#39;c_year&#39;,true));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data222&nbsp;=&nbsp;array_reverse($c-&gt;where($where)-&gt;order(&#39;c_year&nbsp;desc&#39;)-&gt;limit(7)-&gt;getField(&#39;c_quota1&#39;,true));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;data333&nbsp;=&nbsp;array_reverse($c-&gt;where($where)-&gt;order(&#39;c_year&nbsp;desc&#39;)-&gt;limit(7)-&gt;getField(&#39;c_quota2&#39;,true));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;display();&nbsp;&nbsp;&nbsp;&nbsp;}å‰å°tplï¼š&lt;div&nbsp;id=&quot;chart3&quot;&nbsp;data-111=&quot;{:implode(&#39;,&#39;,$data111)}&quot;&nbsp;data-222=&quot;{:implode(&#39;,&#39;,$data222)}&quot;&nbsp;data-333=&quot;{:implode(&#39;,&#39;,$data333)}&quot;&nbsp;//åˆå¹¶æ•°ç»„ä¸ºå­—ç¬¦ä¸²style=&quot;width:&nbsp;530px;height:290px;&quot;&nbsp;class=&quot;wd-fl&quot;&gt;&lt;/div&gt;&lt;script&nbsp;src=&quot;/Skin/public/echarts/echarts.min.js&quot;&gt;&lt;/script&gt;&lt;script&nbsp;src=&quot;/Skin/public/echarts/macarons.js&quot;&gt;&lt;/script&gt;&nbsp;&nbsp;//å¼•ç”¨ä¸»é¢˜&nbsp;&nbsp;å®˜ç½‘æœ‰å¤šç§ä¸»é¢˜&lt;script&nbsp;type=&quot;text/javascript&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;Chart3&nbsp;=&nbsp;echarts.init(document.getElementById(&#39;chart3&#39;),&#39;macarons&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;data111&nbsp;=&nbsp;$(&#39;#chart3&#39;).attr(&#39;data-111&#39;),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data222&nbsp;=&nbsp;$(&#39;#chart3&#39;).attr(&#39;data-222&#39;),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data333&nbsp;=&nbsp;$(&#39;#chart3&#39;).attr(&#39;data-333&#39;),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr_data111&nbsp;=&nbsp;data111.split(&quot;,&quot;);//æ‹†åˆ†å­—ç¬¦ä¸²ä¸ºæ•°ç»„&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr_data222&nbsp;=&nbsp;data222.split(&quot;,&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr_data333&nbsp;=&nbsp;data333.split(&quot;,&quot;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;option3&nbsp;=&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tooltip:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trigger:&nbsp;&#39;axis&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;legend:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:[&#39;æ–¹é‡&#39;,&#39;å®¶æ•°&#39;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xAxis:&nbsp;[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;&#39;category&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;arr_data111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yAxis:&nbsp;[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;&#39;value&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;&#39;ä¸‡æ–¹&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min:&nbsp;1000,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max:&nbsp;3000,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interval:&nbsp;400,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axisLabel:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatter:&nbsp;&#39;{value}&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;&#39;value&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;&#39;&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min:&nbsp;40,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max:&nbsp;80,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interval:&nbsp;5,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;axisLabel:&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatter:&nbsp;&#39;{value}å®¶&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;series:&nbsp;[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&#39;æ–¹é‡&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&#39;bar&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:arr_data222&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&#39;å®¶æ•°&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&#39;line&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yAxisIndex:&nbsp;1,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:arr_data333&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ä½¿ç”¨åˆšæŒ‡å®šçš„é…ç½®é¡¹å’Œæ•°æ®æ˜¾ç¤ºå›¾è¡¨ã€‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Chart3.setOption(option3);&nbsp;&nbsp;&nbsp;&nbsp;&lt;/script&gt;çœ‹æ‡‚äº†å—ï¼Ÿæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œä½ æ˜¯ä¸æ˜¯æœ‰æ›´å¥½çš„ideaï¼æ›´å¤šè¯¦æƒ…ï¼Œè¯·çœ‹echarts","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"csså®ç°æ–‡å­—ç«–æ’","slug":"csså®ç°æ–‡å­—ç«–æ’","date":"2016-06-21T09:15:50.000Z","updated":"2022-03-19T14:35:21.675Z","comments":true,"path":"2016/06/21/52/","link":"","permalink":"https://github.13sai.com/2016/06/21/52/","excerpt":"","text":"æ–‡å­—ç«–æ’ä¼šç”¨åˆ°writing-modeå±æ€§ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¾‹å­ã€‚.shupai{ writing-mode:&nbsp;tb-rl; writing-mode:&nbsp;vertical-rl; -webkit-writing-mode:&nbsp;vertical-rl; color:&nbsp;#3B3533; font-size:&nbsp;20px; } &lt;div&nbsp;class=&quot;shupai&quot;&gt;&lt;p&gt;å¥³ç‹ç”¨å†°å†·çš„å¤–è¡¨ä¿æŠ¤è‡ªå·±ï¼Œ&lt;/p&gt;&lt;p&gt;&nbsp;&nbsp;&nbsp;&nbsp;å…¶å®å†…å¿ƒå¦‚æ°´ï¼Œ&lt;/p&gt;&lt;p&gt;&nbsp;&nbsp;&nbsp;&nbsp;å†…åœ¨å¥½ä¼¼ç»µå¯†çš„å¥¶æ²¹ï¼Œ&lt;/p&gt;&lt;p&gt;&nbsp;&nbsp;&nbsp;&nbsp;ææ˜“è¢«çƒ­æƒ…èåŒ–â€¦â€¦&lt;/p&gt;&lt;/div&gt;æ•ˆæœå¦‚å›¾ï¼šè¯­æ³•ï¼šwriting-modeï¼šhorizontal-tb | vertical-rl | vertical-lr |lr-tb|tb-rlé»˜è®¤å€¼ï¼šhorizontal-tbé€‚ç”¨äºï¼šé™¤&nbsp; display&nbsp; å±æ€§å®šä¹‰ä¸ºtable-row-group | table-column-group | table-row | table-columnä¹‹å¤–çš„æ‰€æœ‰å…ƒç´ å–å€¼ï¼šhorizontal-tbï¼šæ°´å¹³æ–¹å‘è‡ªä¸Šè€Œä¸‹çš„ä¹¦å†™æ–¹å¼ã€‚å³ left-right-top-bottomï¼ˆç±»ä¼¼IEç§æœ‰å€¼lr-tbï¼‰vertical-rlï¼šå‚ç›´æ–¹å‘è‡ªå³è€Œå·¦çš„ä¹¦å†™æ–¹å¼ã€‚å³ top-bottom-right-leftï¼ˆç±»ä¼¼IEç§æœ‰å€¼tb-rlï¼‰vertical-lrï¼šå‚ç›´æ–¹å‘è‡ªå·¦è€Œå³çš„ä¹¦å†™æ–¹å¼ã€‚å³ top-bottom-left-rightlr-tbï¼šå·¦-å³ï¼Œä¸Š-ä¸‹ã€‚å¯¹è±¡ä¸­çš„å†…å®¹åœ¨æ°´å¹³æ–¹å‘ä¸Šä»å·¦å‘å³æµå…¥ï¼Œåä¸€è¡Œåœ¨å‰ä¸€è¡Œçš„ä¸‹é¢ã€‚ æ‰€æœ‰çš„å­—å½¢éƒ½æ˜¯ç«–ç›´å‘ä¸Šçš„ã€‚è¿™ç§å¸ƒå±€æ˜¯ç½—é©¬è¯­ç³»ä½¿ç”¨çš„ï¼ˆIEï¼‰tb-rlï¼šä¸Š-ä¸‹ï¼Œå³-å·¦ã€‚å¯¹è±¡ä¸­çš„å†…å®¹åœ¨å‚ç›´æ–¹å‘ä¸Šä»ä¸Šå‘ä¸‹æµå…¥ï¼Œè‡ªå³å‘å·¦ã€‚åä¸€ç«–è¡Œåœ¨å‰ä¸€ç«–è¡Œçš„å·¦é¢ã€‚å…¨è§’å­—ç¬¦æ˜¯ç«–ç›´å‘ä¸Šçš„ï¼ŒåŠè§’å­—ç¬¦å¦‚æ‹‰ä¸å­—æ¯æˆ–ç‰‡å‡åé¡ºæ—¶é’ˆæ—‹è½¬90åº¦ã€‚è¿™ç§å¸ƒå±€æ˜¯ä¸œäºšè¯­ç³»é€šå¸¸ä½¿ç”¨çš„ï¼ˆIEï¼‰ç”¨æ³•ç®€å•ï¼Œå…¼å®¹æ€§ä¸é”™ã€‚åªæ˜¯ä»Šå¤©ï¼Œç”¨writing-modeé‡åˆ°äº†å¥‡æ€ªçš„é—®é¢˜ï¼Œæ··å‡åä¸‰ä¸ªå­—ï¼Œå‡å­—è¢«åœŸå­—è¦†ç›–äº†ï¼ŒæŸ¥äº†ä¸€ä¼šæ²¡æŸ¥å‡ºåŸå› ï¼ŒæŠŠæ··å‡åœŸä¸­å‡æ¢æˆå…¶ä»–å­—åˆä¼šæ­£å¸¸ï¼Œå¥‡æ€ªï¼Œä½ çŸ¥é“å—ï¼Ÿ","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"CSSå¤–è¾¹è·åˆå¹¶","slug":"CSSå¤–è¾¹è·åˆå¹¶","date":"2016-06-14T05:28:45.000Z","updated":"2022-03-19T14:35:21.570Z","comments":true,"path":"2016/06/14/51/","link":"","permalink":"https://github.13sai.com/2016/06/14/51/","excerpt":"","text":"å¤–è¾¹è·åˆå¹¶ä»¥å‰ç¡®å®é‡åˆ°è¿‡ï¼Œä½†ä»æ²¡æœ‰æ·±ç©¶è¿‡ï¼Œæ²¡æœ‰åœ¨æ„ï¼Œå‰å‡ å¤©åŒäº‹è¯´åˆ°è¿™ä¸ªé—®é¢˜ï¼Œä¾¿æŸ¥äº†æŸ¥ã€‚å¤–è¾¹è·åˆå¹¶ï¼ˆå åŠ ï¼‰æ˜¯ä¸€ä¸ªç›¸å½“ç®€å•çš„æ¦‚å¿µã€‚ä½†æ˜¯ï¼Œåœ¨å®è·µä¸­å¯¹ç½‘é¡µè¿›è¡Œå¸ƒå±€æ—¶ï¼Œå®ƒä¼šé€ æˆè®¸å¤šæ··æ·†ã€‚ç®€å•åœ°è¯´ï¼Œå¤–è¾¹è·åˆå¹¶æŒ‡çš„æ˜¯ï¼Œå½“ä¸¤ä¸ªå‚ç›´å¤–è¾¹è·ç›¸é‡æ—¶ï¼Œå®ƒä»¬å°†å½¢æˆä¸€ä¸ªå¤–è¾¹è·ã€‚åˆå¹¶åçš„å¤–è¾¹è·çš„é«˜åº¦ç­‰äºä¸¤ä¸ªå‘ç”Ÿåˆå¹¶çš„å¤–è¾¹è·çš„é«˜åº¦ä¸­çš„è¾ƒå¤§è€…ã€‚å½“ä¸€ä¸ªå…ƒç´ å‡ºç°åœ¨å¦ä¸€ä¸ªå…ƒç´ ä¸Šé¢æ—¶ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ çš„ä¸‹å¤–è¾¹è·ä¸ç¬¬äºŒä¸ªå…ƒç´ çš„ä¸Šå¤–è¾¹è·ä¼šå‘ç”Ÿåˆå¹¶ã€‚è¯·çœ‹ä¸‹å›¾ï¼šå½“ä¸€ä¸ªå…ƒç´ åŒ…å«åœ¨å¦ä¸€ä¸ªå…ƒç´ ä¸­æ—¶ï¼ˆå‡è®¾æ²¡æœ‰å†…è¾¹è·æˆ–è¾¹æ¡†æŠŠå¤–è¾¹è·åˆ†éš”å¼€ï¼‰ï¼Œå®ƒä»¬çš„ä¸Šå’Œ/æˆ–ä¸‹å¤–è¾¹è·ä¹Ÿä¼šå‘ç”Ÿåˆå¹¶ã€‚è¯·çœ‹ä¸‹å›¾ï¼šå°½ç®¡çœ‹ä¸Šå»æœ‰äº›å¥‡æ€ªï¼Œä½†æ˜¯å¤–è¾¹è·ç”šè‡³å¯ä»¥ä¸è‡ªèº«å‘ç”Ÿåˆå¹¶ã€‚å‡è®¾æœ‰ä¸€ä¸ªç©ºå…ƒç´ ï¼Œå®ƒæœ‰å¤–è¾¹è·ï¼Œä½†æ˜¯æ²¡æœ‰è¾¹æ¡†æˆ–å¡«å……ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸Šå¤–è¾¹è·ä¸ä¸‹å¤–è¾¹è·å°±ç¢°åˆ°äº†ä¸€èµ·ï¼Œå®ƒä»¬ä¼šå‘ç”Ÿåˆå¹¶ï¼šå¦‚æœè¿™ä¸ªå¤–è¾¹è·é‡åˆ°å¦ä¸€ä¸ªå…ƒç´ çš„å¤–è¾¹è·ï¼Œå®ƒè¿˜ä¼šå‘ç”Ÿåˆå¹¶ï¼šè¿™å°±æ˜¯ä¸€ç³»åˆ—çš„æ®µè½å…ƒç´ å ç”¨ç©ºé—´éå¸¸å°çš„åŸå› ï¼Œå› ä¸ºå®ƒä»¬çš„æ‰€æœ‰å¤–è¾¹è·éƒ½åˆå¹¶åˆ°ä¸€èµ·ï¼Œå½¢æˆäº†ä¸€ä¸ªå°çš„å¤–è¾¹è·ã€‚å¤–è¾¹è·åˆå¹¶åˆçœ‹ä¸Šå»å¯èƒ½æœ‰ç‚¹å¥‡æ€ªï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œå®ƒæ˜¯æœ‰æ„ä¹‰çš„ã€‚ä»¥ç”±å‡ ä¸ªæ®µè½ç»„æˆçš„å…¸å‹æ–‡æœ¬é¡µé¢ä¸ºä¾‹ã€‚ç¬¬ä¸€ä¸ªæ®µè½ä¸Šé¢çš„ç©ºé—´ç­‰äºæ®µè½çš„ä¸Šå¤–è¾¹è·ã€‚å¦‚æœ æ²¡æœ‰å¤–è¾¹è·åˆå¹¶ï¼Œåç»­æ‰€æœ‰æ®µè½ä¹‹é—´çš„å¤–è¾¹è·éƒ½å°†æ˜¯ç›¸é‚»ä¸Šå¤–è¾¹è·å’Œä¸‹å¤–è¾¹è·çš„å’Œã€‚è¿™æ„å‘³ç€æ®µè½ä¹‹é—´çš„ç©ºé—´æ˜¯é¡µé¢é¡¶éƒ¨çš„ä¸¤å€ã€‚å¦‚æœå‘ç”Ÿå¤–è¾¹è·åˆå¹¶ï¼Œæ®µè½ä¹‹é—´çš„ ä¸Šå¤–è¾¹è·å’Œä¸‹å¤–è¾¹è·å°±åˆå¹¶åœ¨ä¸€èµ·ï¼Œè¿™æ ·å„å¤„çš„è·ç¦»å°±ä¸€è‡´äº†ã€‚æ³¨æ„ï¼šåªæœ‰æ™®é€šæ–‡æ¡£æµä¸­å—çŠ¶å…ƒç´ çš„å‚ç›´å¤–è¾¹è·æ‰ä¼šå‘ç”Ÿå¤–è¾¹è·åˆå¹¶ã€‚è¡Œå†…å…ƒç´ ã€æµ®åŠ¨å…ƒç´ æˆ–ç»å¯¹å®šä½å…ƒç´ ä¹‹é—´çš„å¤–è¾¹è·ä¸ä¼šåˆå¹¶ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"jsåˆ¤æ–­æ‰‹æœºè®¿é—®å¹¶è·³è½¬åˆ°ç›¸åº”é¡µé¢","slug":"jsåˆ¤æ–­æ‰‹æœºè®¿é—®å¹¶è·³è½¬åˆ°ç›¸åº”é¡µé¢","date":"2016-06-13T05:56:35.000Z","updated":"2022-03-19T14:35:21.731Z","comments":true,"path":"2016/06/13/50/","link":"","permalink":"https://github.13sai.com/2016/06/13/50/","excerpt":"","text":"æ–¹æ³•æœ‰å¾ˆå¤šï¼Œåˆ—å‡ºè‡ªå·±é‡åˆ°å¹¶èƒ½æˆåŠŸå®ç°çš„ä¸‰ç§æ–¹æ³•ã€‚ 1ã€åˆ©ç”¨æ­£åˆ™åˆ¤æ–­å®¢æˆ·ç«¯ function browserRedirect() &#123; var sUserAgent= navigator.userAgent.toLowerCase(); var bIsIpad= sUserAgent.match(/ipad/i) == &quot;ipad&quot;; var bIsIphoneOs= sUserAgent.match(/iphone os/i) == &quot;iphone os&quot;; var bIsMidp= sUserAgent.match(/midp/i) == &quot;midp&quot;; var bIsUc7= sUserAgent.match(/rv:1.2.3.4/i) == &quot;rv:1.2.3.4&quot;; var bIsUc= sUserAgent.match(/ucweb/i) == &quot;ucweb&quot;; var bIsAndroid= sUserAgent.match(/android/i) == &quot;android&quot;; var bIsCE= sUserAgent.match(/windows ce/i) == &quot;windows ce&quot;; var bIsWM= sUserAgent.match(/windows mobile/i) == &quot;windows mobile&quot;; if (bIsIpad || bIsIphoneOs || bIsMidp || bIsUc7 || bIsUc || bIsAndroid || bIsCE || bIsWM) &#123; window.location.href= &#x27;http://www.dou520.wang&#x27;; &#125; &#125; browserRedirect();Copy 2ã€å¼•ç”¨ç™¾åº¦siteapp &lt;script src=&quot;http://siteapp.baidu.com/static/webappservice/uaredirect.js&quot; type=&quot;text/javascript&quot;&gt; &lt;/script&gt; &lt;script type=&quot;text/javascript&quot;&gt;uaredirect(&quot;http://www.dou520.wang&quot;);&lt;/script&gt;Copy 3.åˆ¤æ–­ï¼Œæœ¬è´¨åŒä¸€ (function () &#123;var sUserAgent = navigator.userAgent; if (sUserAgent.indexOf(&#x27;Android&#x27;) &gt; -1 || sUserAgent.indexOf(&#x27;iPhone&#x27;) &gt; -1 || sUserAgent.indexOf(&#x27;iPad&#x27;) &gt; -1 || sUserAgent.indexOf(&#x27;iPod&#x27;) &gt; -1 || sUserAgent.indexOf(&#x27;Symbian&#x27;) &gt; -1) &#123; location.href = &#x27;http://www.dou520.wang&#x27;; //æ‰‹æœºç«¯åœ°å€ &#125; else &#123;&#125; &#125;)();Copy æ–¹æ³•å…¶å®å¾ˆå¤šï¼Œå¤§éƒ¨åˆ†åŸç†éƒ½æ˜¯é€šè¿‡åˆ¤æ–­å®¢æˆ·ç«¯æ˜¯å¦ä¸ºç§»åŠ¨ç«¯æµè§ˆå™¨ï¼Œç„¶åè·³è½¬ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"HTMLçš„å¿«é€Ÿå†™æ³•ï¼šEmmet","slug":"HTMLçš„å¿«é€Ÿå†™æ³•ï¼šEmmet","date":"2016-06-07T11:34:32.000Z","updated":"2022-03-19T14:35:21.591Z","comments":true,"path":"2016/06/07/49/","link":"","permalink":"https://github.13sai.com/2016/06/07/49/","excerpt":"","text":"ä»Šå¤©åŒäº‹è·Ÿæˆ‘è®²äº†ä¸€ä¸ªå†™htmlæ ‡ç­¾çš„å¿«æ·æ–¹æ³•ï¼ŒçœŸçš„å¾ˆå¥½ç”¨ã€‚å…¶å®å°±æ˜¯æ˜¯ä¸€æ¬¾å¾ˆå¤šç¼–è¾‘å™¨éƒ½æ”¯æŒçš„æ’ä»¶Emmetã€‚Emmet (å‰èº«ä¸º Zen Coding) æ˜¯ä¸€ä¸ªèƒ½å¤§å¹…åº¦æé«˜å‰ç«¯å¼€å‘æ•ˆç‡çš„ä¸€ä¸ªå·¥å…·:åŸºæœ¬ä¸Šï¼Œå¤§å¤šæ•°çš„æ–‡æœ¬ç¼–è¾‘å™¨éƒ½ä¼šå…è®¸ä½ å­˜å‚¨å’Œé‡ç”¨ä¸€äº›ä»£ç å—ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œç‰‡æ®µâ€ã€‚è™½ç„¶ç‰‡æ®µèƒ½å¾ˆå¥½åœ°æ¨åŠ¨ä½ å¾—ç”Ÿäº§åŠ›ï¼Œä½†å¤§å¤šæ•°çš„å®ç°éƒ½æœ‰è¿™æ ·ä¸€ä¸ªç¼ºç‚¹ï¼šä½ å¿…é¡»å…ˆå®šä¹‰ä½ å¾—ä»£ç ç‰‡æ®µï¼Œå¹¶ä¸”ä¸èƒ½å†è¿è¡Œæ—¶è¿›è¡Œæ‹“å±•ã€‚EmmetæŠŠç‰‡æ®µè¿™ä¸ªæ¦‚å¿µæé«˜åˆ°äº†ä¸€ä¸ªæ–°çš„å±‚æ¬¡ï¼šä½ å¯ä»¥è®¾ç½®CSSå½¢å¼çš„èƒ½å¤ŸåŠ¨æ€è¢«è§£æçš„è¡¨è¾¾å¼ï¼Œç„¶åæ ¹æ®ä½ æ‰€è¾“å…¥çš„ç¼©å†™æ¥å¾—åˆ°ç›¸åº”çš„å†…å®¹ã€‚Emmetè¯­æ³•å¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼š&nbsp;E&nbsp;ä»£è¡¨HTMLæ ‡ç­¾ã€‚ &nbsp;E#id&nbsp;ä»£è¡¨idå±æ€§ã€‚ &nbsp;E.class&nbsp;ä»£è¡¨classå±æ€§ã€‚ &nbsp;E[attr=foo]&nbsp;ä»£è¡¨æŸä¸€ä¸ªç‰¹å®šå±æ€§ã€‚&nbsp;E{foo}&nbsp;ä»£è¡¨æ ‡ç­¾åŒ…å«çš„å†…å®¹æ˜¯fooã€‚ &nbsp;E&gt;N&nbsp;ä»£è¡¨Næ˜¯Eçš„å­å…ƒç´ ã€‚ &nbsp;E+N&nbsp;ä»£è¡¨Næ˜¯Eçš„åŒçº§å…ƒç´ ã€‚ &nbsp;E^N&nbsp;ä»£è¡¨Næ˜¯Eçš„ä¸Šçº§å…ƒç´ ã€‚å‚è€ƒç½‘å€ï¼Œè¿™é‡Œå¾ˆè¯¦ç»†ï¼šhttp://www.w3cplus.com/tools/emmet-cheat-sheet.html","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/tags/web/"}]},{"title":"jQueryæ’ä»¶å¼€å‘","slug":"jQueryæ’ä»¶å¼€å‘","date":"2016-06-04T13:33:01.000Z","updated":"2022-07-05T08:51:45.397Z","comments":true,"path":"2016/06/04/48/","link":"","permalink":"https://github.13sai.com/2016/06/04/48/","excerpt":"","text":"jQueryè‡ªå®šä¹‰äº†jQuery.extend()å’ŒjQuery.fn.extend()æ–¹æ³•.å…¶ä¸­jQuery.extend()æ–¹æ³•èƒ½å¤Ÿåˆ›å»ºå…¨å±€å‡½æ•°æˆ–è€…é€‰æ‹©å™¨,è€ŒjQuery.fn.extend()æ–¹æ³•èƒ½å¤Ÿåˆ›å»ºjQueryå¯¹è±¡æ–¹æ³•.jQueryæ’ä»¶å¼€å‘å°±åˆ†ä¸ºè¿™ä¸¤ç§ï¼š ä¸€ã€ç±»çº§åˆ« ç±»çº§åˆ«ä½ å¯ä»¥ç†è§£ä¸ºæ‰©å±•jqueryç±»ï¼Œæœ€æ˜æ˜¾çš„ä¾‹å­æ˜¯$.ajax(...),ç›¸å½“äºé™æ€æ–¹æ³•ã€‚ å¼€å‘æ‰©å±•å…¶æ–¹æ³•æ—¶ä½¿ç”¨$.extendæ–¹æ³•ï¼Œå³jQuery.extend(object);&nbsp;$.extend({ &nbsp;&nbsp;&nbsp;al:function(msg){alert(msg);} });è°ƒç”¨å¾ˆç®€å•ï¼Œ$.al(11);æ•ˆæœå¦‚ä¸‹ï¼šäºŒã€å¯¹è±¡çº§åˆ« å¯¹è±¡çº§åˆ«åˆ™å¯ä»¥ç†è§£ä¸ºåŸºäºå¯¹è±¡çš„æ‹“å±•ï¼Œå¦‚$(&quot;#scroll&quot;).slide(...); è¿™é‡Œè¿™ä¸ªslideå‘¢ï¼Œå°±æ˜¯åŸºäºå¯¹è±¡çš„æ‰©å±•äº†ã€‚ å¼€å‘æ‰©å±•å…¶æ–¹æ³•æ—¶ä½¿ç”¨$.fn.extendæ–¹æ³•ï¼Œå³jQuery.fn.extend(object);&nbsp;$.fn.extend({&nbsp; shtml:&nbsp;function&nbsp;(showhtml)&nbsp;{&nbsp; jQuery(this).html(showhtml);&nbsp; }&nbsp; })è°ƒç”¨ä¹Ÿå¾ˆç®€å•ï¼Œ&lt;div&nbsp;class=&quot;msg&quot;&gt;&lt;/div&gt; &lt;script&gt; &nbsp;&nbsp;&nbsp;&nbsp;$(&#39;.msg&#39;).shtml(&#39;111&#39;); &lt;/script&gt;æ•ˆæœå¦‚ä¸‹ï¼šè¿™é‡Œåªæ˜¯æœ€ç®€å•çš„ç¤ºä¾‹ï¼Œä½ å¯ä»¥å°è¯•å¼€å‘ä¸€äº›å¤æ‚ç¾è§‚çš„æ’ä»¶ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"ThinkPHPçš„ç»„åˆæŸ¥è¯¢","slug":"ThinkPHPçš„ç»„åˆæŸ¥è¯¢","date":"2016-06-02T04:12:16.000Z","updated":"2022-03-19T14:35:21.652Z","comments":true,"path":"2016/06/02/47/","link":"","permalink":"https://github.13sai.com/2016/06/02/47/","excerpt":"","text":"å¦‚æœä½ éœ€è¦åœ¨æŸ¥è¯¢çš„æ—¶å€™åŒæ—¶å¶å°”ä½¿ç”¨å­—ç¬¦ä¸²å´åˆä¸å¸Œæœ›ä¸¢å¤±æ•°ç»„æ–¹å¼çš„çµæ´»çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç»„åˆæŸ¥è¯¢ã€‚ç»„åˆæŸ¥è¯¢çš„ä¸»ä½“è¿˜æ˜¯é‡‡ç”¨æ•°ç»„æ–¹å¼æŸ¥è¯¢ï¼Œåªæ˜¯åŠ å…¥äº†ä¸€äº›ç‰¹æ®Šçš„æŸ¥è¯¢æ”¯æŒï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²æ¨¡å¼æŸ¥è¯¢ï¼ˆ_stringï¼‰ã€å¤åˆæŸ¥è¯¢ï¼ˆ_complexï¼‰ã€è¯·æ±‚å­—ç¬¦ä¸² æŸ¥è¯¢ï¼ˆ_queryï¼‰ï¼Œæ··åˆæŸ¥è¯¢ä¸­çš„ç‰¹æ®ŠæŸ¥è¯¢æ¯æ¬¡æŸ¥è¯¢åªèƒ½å®šä¹‰ä¸€ä¸ªï¼Œç”±äºé‡‡ç”¨æ•°ç»„çš„ç´¢å¼•æ–¹å¼ï¼Œç´¢å¼•ç›¸åŒçš„ç‰¹æ®ŠæŸ¥è¯¢ä¼šè¢«è¦†ç›–ã€‚ ä¸€. å­—ç¬¦ä¸²æ¨¡å¼æŸ¥è¯¢ï¼ˆé‡‡ç”¨_string ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼‰æ•°ç»„æ¡ä»¶è¿˜å¯ä»¥å’Œå­—ç¬¦ä¸²æ¡ä»¶æ··åˆä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š $User = M(&quot;member&quot;); $map[&#x27;id&#x27;] = array(&#x27;neq&#x27;,5); $map[&#x27;name&#x27;] = &#x27;wzt&#x27;; $map[&#x27;_string&#x27;] = &#x27;status=1 AND score&gt;10&#x27;; $User-&gt;where($map)-&gt;select(); æœ€åå¾—åˆ°çš„æŸ¥è¯¢æ¡ä»¶ï¼š ( `id` != 5 ) AND ( `name` = &#x27;wzt&#x27; ) AND ( status=1 AND score&gt;10 ) äºŒ. è¯·æ±‚å­—ç¬¦ä¸²æŸ¥è¯¢æ–¹å¼è¯·æ±‚å­—ç¬¦ä¸²æŸ¥è¯¢æ˜¯ä¸€ç§ç±»ä¼¼äºURLä¼ å‚çš„æ–¹å¼ï¼Œå¯ä»¥æ”¯æŒç®€å•çš„æ¡ä»¶åˆ¤æ–­ $map[&#x27;m_id&#x27;] = array(&#x27;gt&#x27;,&#x27;10&#x27;); $map[&#x27;_query&#x27;] = &#x27;status=1&amp;score&gt;60&amp;_logic=or&#x27;; å¾—åˆ°çš„æŸ¥è¯¢æ¡ä»¶æ˜¯ï¼š `m_id`&gt;10 AND (`status` = &#x27;1&#x27; OR `score` &gt; &#x27;60&#x27;) ä¸‰. å¤åˆæŸ¥è¯¢å¤åˆæŸ¥è¯¢ç›¸å½“äºå°è£…äº†ä¸€ä¸ªæ–°çš„æŸ¥è¯¢æ¡ä»¶ï¼Œç„¶åå¹¶å…¥åŸæ¥çš„æŸ¥è¯¢æ¡ä»¶ä¹‹ä¸­ï¼Œæ‰€ä»¥å¯ä»¥å®Œæˆæ¯”è¾ƒå¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ç»„è£…ã€‚ ä¾‹å¦‚:``$where[â€˜nameâ€™] = array(â€˜likeâ€™, â€˜%kw%â€™);$where[â€˜titleâ€™] = array(â€˜likeâ€™,â€™%kw%â€™);$where[â€˜_logicâ€™] = â€˜orâ€™;$con[â€˜_complexâ€™] = $where;$con[â€˜idâ€™] = array(â€˜gtâ€™,5); æŸ¥è¯¢æ¡ä»¶æ˜¯ ( id &gt; 5) AND ( ( name like â€˜%kw%â€™) OR ( title like â€˜%kw%â€™) ) å¤åˆæŸ¥è¯¢ä½¿ç”¨äº†_complexä½œä¸ºå­æŸ¥è¯¢æ¡ä»¶æ¥å®šä¹‰ï¼Œé…åˆä¹‹å‰çš„æŸ¥è¯¢æ–¹å¼ï¼Œå¯ä»¥éå¸¸çµæ´»çš„åˆ¶å®šæ›´åŠ å¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ã€‚ å¾ˆå¤šæŸ¥è¯¢æ–¹å¼å¯ä»¥ç›¸äº’è½¬æ¢ï¼Œä¾‹å¦‚ä¸Šé¢çš„å¯ä»¥æ”¹æˆ $where[â€˜idâ€™] = array(â€˜gtâ€™,5);$where[â€˜_stringâ€™] = â€˜ (name like â€œ%kw%â€) OR ( title like â€œ%kw%â€) â€˜; æœ€åç”Ÿæˆçš„SQLè¯­å¥æ˜¯ä¸€è‡´çš„ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"ThinkPHPçš„å¤åˆæŸ¥è¯¢","slug":"ThinkPHPçš„å¤åˆæŸ¥è¯¢","date":"2016-06-01T07:13:39.000Z","updated":"2022-03-19T14:35:21.650Z","comments":true,"path":"2016/06/01/46/","link":"","permalink":"https://github.13sai.com/2016/06/01/46/","excerpt":"","text":"å¤åˆæŸ¥è¯¢ç›¸å½“äºå°è£…äº†ä¸€ä¸ªæ–°çš„æŸ¥è¯¢æ¡ä»¶ï¼Œç„¶åå¹¶å…¥åŸæ¥çš„æŸ¥è¯¢æ¡ä»¶ä¹‹ä¸­ï¼Œæ‰€ä»¥å¯ä»¥å®Œæˆæ¯”è¾ƒå¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ç»„è£…ã€‚ ä¾‹å¦‚æŸ¥è¯¢nameå’Œtitleä¸­æœ‰kwä¸”idå¤§äº10çš„æ•°æ®ï¼š $where[&#x27;name&#x27;] = array(&#x27;like&#x27;, &#x27;%kw%&#x27;); $where[&#x27;title&#x27;] = array(&#x27;like&#x27;,&#x27;%kw%&#x27;); $where[&#x27;_logic&#x27;] = &#x27;or&#x27;; $map[&#x27;_complex&#x27;] = $where; $map[&#x27;id&#x27;] = array(&#x27;gt&#x27;,10); ç›¸å½“äºsqlè¯­å¥ ( id &gt; 10) AND ( ( name like &#x27;%kw%&#x27;) OR ( title like &#x27;%kw%&#x27;) ) å…¶å®ï¼Œå¾ˆå¤šæŸ¥è¯¢æ–¹å¼å¯ä»¥ç›¸äº’è½¬æ¢ï¼Œä¾‹å¦‚ä¸Šé¢çš„æŸ¥è¯¢æ¡ä»¶å¯ä»¥æ”¹æˆï¼š $where[&#x27;id&#x27;] = array(&#x27;gt&#x27;,10); $where[&#x27;_string&#x27;] = &#x27; (name like &quot;%kw%&quot;) OR ( title like &quot;%kw&quot;) &#x27;; å¤åˆæŸ¥è¯¢ç›¸å½“äºå°è£…äº†ä¸€ä¸ªæ–°çš„æŸ¥è¯¢æ¡ä»¶ï¼Œç„¶åå¹¶å…¥åŸæ¥çš„æŸ¥è¯¢æ¡ä»¶ä¹‹ä¸­ï¼Œæ‰€ä»¥å¯ä»¥å®Œæˆæ¯”è¾ƒå¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ç»„è£…ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"jsè·å–å½“å‰åœ°ç†ä½ç½®ä¸ip","slug":"jsè·å–å½“å‰åœ°ç†ä½ç½®ä¸ip","date":"2016-05-27T09:12:02.000Z","updated":"2022-03-19T14:35:21.754Z","comments":true,"path":"2016/05/27/45/","link":"","permalink":"https://github.13sai.com/2016/05/27/45/","excerpt":"","text":"pcè·å–å½“å‰åœ°ç†ä½ç½®&lt;script&nbsp;type=&quot;text/javascript&quot;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.getScript(&#39;http://int.dpool.sina.com.cn/iplookup/iplookup.php?format=js&#39;,&nbsp;function(_result)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(remote_ip_info.ret&nbsp;==&nbsp;&#39;1&#39;)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;alerté‡Œé¢æ¢è¡Œç”¨ &nbsp;&nbsp;è€Œé&lt;br&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(&#39; å›½å®¶ï¼š&#39;&nbsp;+&nbsp;remote_ip_info.country&nbsp;+&nbsp;&#39; çœï¼š&#39;&nbsp;+&nbsp;remote_ip_info.province&nbsp;+&nbsp;&#39; å¸‚ï¼š&#39;&nbsp;+&nbsp;remote_ip_info.city&nbsp;+&nbsp;&#39;åŒºï¼š&#39;&nbsp;+&nbsp;remote_ip_info.district&nbsp;+&nbsp;&#39; ISPï¼š&#39;&nbsp;+&nbsp;remote_ip_info.isp&nbsp;+&nbsp;&#39;ç±»å‹ï¼š&#39;&nbsp;+&nbsp;remote_ip_info.type&nbsp;+&nbsp;&#39;å…¶ä»–ï¼š&#39;&nbsp;+&nbsp;remote_ip_info.desc);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(&#39;æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„IPåœ°å€ä¿¡æ¯ï¼&#39;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&lt;/script&gt;è·å–å½“å‰ip&lt;script&gt;var&nbsp;url&nbsp;=&nbsp;&#39;http://chaxun.1616.net/s.php?type=ip&amp;output=json&amp;callback=?&amp;_=&#39;&nbsp;+&nbsp;Math.random();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.getJSON(url,&nbsp;function(data)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(data.Ip);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&lt;/script&gt;","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"å»é™¤aé“¾æ¥çš„è™šçº¿æ¡†","slug":"å»é™¤aé“¾æ¥çš„è™šçº¿æ¡†","date":"2016-05-18T04:00:27.000Z","updated":"2022-03-19T14:35:21.894Z","comments":true,"path":"2016/05/18/43/","link":"","permalink":"https://github.13sai.com/2016/05/18/43/","excerpt":"","text":"aé“¾æ¥ä¸Šçš„è™šçº¿æ¡†éå¸¸å¸¸è§ï¼Œè€Œä¸”çœŸçš„éå¸¸éš¾çœ‹ã€‚å¦‚å›¾ï¼Œå¦‚ä½•å»é™¤å‘¢ï¼Ÿåªéœ€è¦åŠ ä¸€è¡Œä»£ç ï¼Œå®Œç¾è§£å†³ã€‚a{ blr:expression(this.onFocus=this.blur());&nbsp;/*for&nbsp;IE&nbsp;*/&nbsp; outline:none;&nbsp;/*for&nbsp;FF&nbsp;*/&nbsp; }è°·æ­Œç³»è¿˜æœ‰ä¸€ä¸ªè¾“å…¥æ¡†é«˜äº®æ˜¾ç¤ºçš„æ™ºèƒ½æ¨¡å¼ï¼Œå…¶å®ä¹Ÿä¸æ€ä¹ˆå¥½çœ‹ï¼Œå»é™¤åŠ å…¥ï¼šinput,textarea{outline:&nbsp;none;}","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"é²œä¸ºäººçŸ¥çš„z-index","slug":"é²œä¸ºäººçŸ¥çš„z-index","date":"2016-05-07T06:33:41.000Z","updated":"2022-03-19T14:35:21.960Z","comments":true,"path":"2016/05/07/42/","link":"","permalink":"https://github.13sai.com/2016/05/07/42/","excerpt":"","text":"z-indexä¸€èˆ¬ç†è§£å°±æ˜¯è®¾ç½®æ ‡ç­¾åœ¨zè½´å…ˆåé¡ºåºï¼Œz-indexå€¼å¤§çš„æ˜¾ç¤ºåœ¨æœ€å‰é¢ï¼Œå°çš„åˆ™ä¼šè¢«é®æŒ¡ï¼ŒçœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿæˆ‘ä»¬æ¥ä¸€æ¢ç©¶ç«Ÿï¼z-indexå¯ä»¥è®¾ç½®æˆä¸‰ä¸ªå€¼ï¼šé»˜è®¤å€¼autoã€‚æ•°å€¼ã€‚æŒ‡ç¤ºå±‚å çº§æ•°ï¼Œå¯ä»¥æ˜¯è´Ÿå€¼ã€‚inheritã€‚ç»§æ‰¿çˆ¶å…ƒç´ ã€‚å±‚å é¡ºåº&nbsp;stacking orderHTMLæ–‡æ¡£ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½èƒ½åœ¨æ–‡æ¡£ä¸­å…¶å®ƒå…ƒç´ çš„ä¹‹å‰æˆ–è€…ä¹‹åã€‚è¿™å°±æ˜¯æ‰€è°“çš„å±‚å é¡ºåºã€‚å±‚å é¡ºåºä¸æ˜¯z-indexç‹¬æœ‰çš„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰å±‚å é¡ºåºï¼Œå…ƒç´ æ¸²æŸ“çš„å…ˆåé¡ºåºè·Ÿå®ƒæœ‰å¾ˆå¤§å…³ç³»ã€‚å½“å…ƒç´ å‘ç”Ÿå±‚å æ—¶ï¼Œå…ƒç´ çš„å±‚çº§é«˜çš„ä¼šä¼˜å…ˆæ˜¾ç¤ºåœ¨ä¸Šé¢ï¼Œå±‚çº§ä¸€æ ·çš„åˆ™ä¼šæ ¹æ®domçš„å…ˆåé¡ºåºè¿›è¡Œæ¸²æŸ“ï¼Œåé¢çš„ä¼šè¦†ç›–å‰é¢çš„ã€‚è¯•è¯•çœ‹ä¸ç”¨z-indexæ¥æ”¹å˜å…ƒç´ å±‚å é¡ºåºï¼Œ&lt;style&gt; &nbsp;&nbsp;&nbsp;&nbsp;#box1{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;background:&nbsp;red; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;200px; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height:&nbsp;200px; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display:inline-block; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;#box2{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;background:&nbsp;yellow; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;200px; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height:&nbsp;300px; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-top:-200px; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/style&gt; &lt;div&nbsp;id=&quot;box1&quot;&gt;&lt;/div&gt; &lt;div&nbsp;id=&quot;box2&quot;&gt;&lt;/div&gt;è¿™é‡Œåªåšäº†ç»†å¾®çš„ä¿®æ”¹ï¼Œå°±æ˜¯ç»™box1åŠ äº†ä¸€ä¸ªdisplay:inline-block;çš„æ ·å¼ï¼Œä»ä¸ƒé˜¶å›¾ä¸­çœ‹å‡ºï¼Œdisplayï¼šblockçš„å…ƒç´ çš„å±‚å æ°´å¹³ä½äºdisplayï¼šinline-blockçš„å…ƒç´ ï¼Œæ‰€ä»¥æµè§ˆå™¨å°±å°†box2æ¸²æŸ“åˆ°box1ä¸Šé¢ã€‚å±‚å ä¸Šä¸‹æ–‡&nbsp;stacking contextä¸€ç»„æ‹¥æœ‰å…¬å…±çˆ¶çº§çš„å…ƒç´ åœ¨å±‚å é¡ºåºä¸­ä¸€èµ·ä¸Šç§»æˆ–è€…ä¸‹ç§»è¢«ç§°ä¸ºå±‚å ä¸Šä¸‹æ–‡ã€‚é€å½»çš„ç†è§£å±‚å ä¸Šä¸‹æ–‡æ˜¯çœŸæ­£æŒæ¡z-indexå’Œå±‚å é¡ºåºå¦‚ä½•å·¥ä½œçš„å…³é”®æ‰€åœ¨ã€‚æ¯ä¸ªå±‚å ä¸Šä¸‹æ–‡æœ‰ä¸€ä¸ªå•ç‹¬çš„HTMLå…ƒç´ ä½œä¸ºå®ƒçš„æ ¹å…ƒ ç´ ã€‚å½“ä¸€ä¸ªæ–°çš„å±‚å ä¸Šä¸‹æ–‡åœ¨ä¸€ä¸ªå…ƒç´ ä¸Šå½¢æˆçš„æ—¶å€™ï¼Œå±‚å ä¸Šä¸‹æ–‡å°†å…¶æ‰€æœ‰çš„å­å…ƒç´ éƒ½é™åˆ¶åœ¨å±‚å é¡ºåºçš„ä¸€ä¸ªç‰¹å®šä½ç½®ã€‚è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªå…ƒç´ è¢«å±‚å  é¡ºåºåº•éƒ¨çš„ä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡æ‰€åŒ…å«ï¼Œå°†æ²¡æœ‰åŠæ³•å°†å…¶ç½®äºå¦ä¸€ä¸ªä¸åŒçš„å…·æœ‰æ›´é«˜å±‚å é¡ºåºçš„å±‚å ä¸Šä¸‹æ–‡ä¸­åŒ…å«çš„å…ƒç´ ä¹‹å‰ï¼Œå³ä¾¿è¿™ä¸ªå…ƒç´ æœ‰æ— é™å¤§çš„z-indexå€¼ã€‚åœ¨ä¸€ä¸ªå…ƒç´ ä¸Šå½¢æˆå±‚å ä¸Šä¸‹æ–‡æœ‰å¦‚ä¸‹æ–¹å¼ï¼šå½“ä¸€ä¸ªå…ƒç´ æ˜¯æ–‡æ¡£çš„æ ¹å…ƒç´ ï¼ˆ&lt;html&gt;å…ƒ ç´ ï¼‰å½“ä¸€ä¸ªå…ƒç´ æœ‰é™¤staticä¹‹å¤–çš„positionå±æ€§å€¼ä¸”z-indexå€¼ä¸ä¸ºautoå½“ä¸€ä¸ªå…ƒç´ æœ‰å°äº1çš„opacityå€¼å½“ä¸€ä¸ªå…ƒç´ çš„transformä¸ç­‰äºnoneå‰ä¸¤ç§å½¢æˆå±‚å ä¸Šä¸‹æ–‡çš„æ–¹å¼å¾ˆæœ‰æ„ä¹‰ï¼Œä¸”ä¸€èˆ¬Webå¼€å‘è€…éƒ½èƒ½å¤Ÿç†è§£ï¼ˆå³ä½¿ä»–ä»¬ä¸çŸ¥é“å®ƒä»¬çš„å«æ³•ï¼‰ã€‚ç»“åˆä¸ƒé˜¶å›¾ï¼Œæœ€ä¸‹å±‚backgroundä¾¿æ˜¯å»ºç«‹åœ¨å±‚å ä¸Šä¸‹æ–‡çš„åŸºç¡€ä¸Šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½ä¼šæ¸²æŸ“åœ¨è¯¥å…ƒç´ çš„å±‚å ä¸Šä¸‹æ–‡èƒŒæ™¯å’Œè¾¹æ¡†ä¸Šé¢ï¼›å› è€Œåœ¨blockã€floatå…ƒç´ ç­‰ä¸å­˜åœ¨å±‚çº§ä¸Šä¸‹æ–‡çš„å…ƒç´ ä¸­ï¼Œå½“å­å…ƒç´ è®¾ç½®z-indexä¸ºè´Ÿæ—¶ï¼Œå­å…ƒç´ ä¼šè¢«çˆ¶å…ƒç´ é®æŒ¡ã€‚&lt;style&gt; &nbsp;&nbsp;&nbsp;&nbsp;#box1{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position:&nbsp;relative; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;200px; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height:&nbsp;200px; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;background:&nbsp;red; &nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;&nbsp;&nbsp;#box2{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;position:&nbsp;relative; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z-index:-1; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;100px; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height:&nbsp;300px; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;background:&nbsp;yellow; &nbsp;&nbsp;&nbsp;&nbsp;} &lt;/style&gt; &nbsp; &lt;div&nbsp;id=&quot;box1&quot;&gt; &nbsp;&nbsp;&nbsp;&lt;div&nbsp;id=&quot;box2&quot;&gt;&lt;/div&gt; &lt;/div&gt;è¿™é‡Œï¼Œboxå¹¶æ²¡æœ‰åˆ›å»ºå±‚å ä¸Šä¸‹æ–‡ï¼Œå½“å­å…ƒç´ box2è®¾ç½®z-index:-1æ—¶ï¼Œbox2æ‰€åœ¨çš„å±‚å ä¸Šä¸‹æ–‡æ˜¯æ ¹å…ƒç´ ï¼Œå³htmlæ ¹æ ‡ç­¾ï¼Œæ ¹æ®ä¸ƒé˜¶å›¾å¯ä»¥çœ‹å‡ºï¼Œbox2ä¼šæ¸²æŸ“åœ¨htmlæ ‡ç­¾ä¸Šé¢ï¼Œbox1(z-index:auto)ä¸‹é¢ï¼Œæ‰€ä»¥box2è¢«é®æŒ¡äº†ã€‚é‚£ä¹ˆæ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿç®€å•å§ï¼Œä¸ºbox1å»ºç«‹ä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ï¼ˆæ¯”å¦‚è®¾ç½®z-index:1;ï¼‰å³å¯ï¼Œbox1ä¸­çš„å…ƒç´ æ— è®ºz-indexæ˜¯è´Ÿçš„å¤šå°‘ï¼Œéƒ½ä¼šæ˜¾ç¤ºåœ¨box1çš„èƒŒæ™¯ä¹‹ä¸Šï¼Œå¦‚å›¾ï¼šè¿™é‡Œæˆ‘ç”¨äº†å‰é¢è¯´çš„çš„ç¬¬ä¸€ç§æ–¹å¼å»åˆ›å»ºå±‚å ä¸Šä¸‹æ–‡ï¼Œå³å®šä½å…ƒç´ ä¸­z-indexä¸ä¸ºautoçš„å…ƒç´ ä¼šå»ºç«‹å±‚å ä¸Šä¸‹æ–‡ã€‚ä¸ºä»€ä¹ˆbox1çš„z-indexå°äºbox2çš„z-indexï¼Œbox2å´æ˜¾ç¤ºåœ¨box1ä¸Šé¢å‘¢ï¼Ÿå±‚å æ°´å¹³ä»…åœ¨åŒä¸€çˆ¶çº§å±‚å ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œæ¯”è¾ƒï¼Œå³å±‚å ä¸Šä¸‹æ–‡box1ä¸­çš„å­å…ƒç´ çš„å±‚å æ°´å¹³ä¸ä¼šå’Œå¦ä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ä¸­çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œå½“ç„¶ä¹Ÿä¸ä¼šå’Œbox1è‡ªå·±æ¯”è¾ƒã€‚æ‰€ä»¥æ–‡ç« å¼€å¤´çš„é—®é¢˜ï¼Œç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚æ€»ç»“ï¼šç†è§£ä¸ƒé˜¶å›¾z-indexä»…åœ¨è®¾ç½®positionä¸ç­‰äºstaticçš„å…ƒç´ ä¸­æœ‰æ•ˆz-indexå±‚å æ°´å¹³çš„æ¯”è¾ƒä»…é™äºåŒä¸€çº§åˆ«çš„å±‚å ä¸Šä¸‹æ–‡ä¸­","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"jsä¸PHPè·³å‡ºå¾ªç¯","slug":"jsä¸PHPè·³å‡ºå¾ªç¯","date":"2016-04-25T07:02:38.000Z","updated":"2022-03-19T14:35:21.725Z","comments":true,"path":"2016/04/25/41/","link":"","permalink":"https://github.13sai.com/2016/04/25/41/","excerpt":"","text":"javascript å…ˆçœ‹breakï¼š for(var i=0;i&lt;=10;i++)&#123; document.write(i); if(i==5)&#123;break;&#125; &#125; è¾“å‡ºçš„ç»“æœä¸ºï¼š12345ï¼Œå½“içš„å€¼ç­‰äº5çš„æ—¶å€™ç›´æ¥é€šè¿‡breakè·³å‡ºäº†å¾ªç¯ï¼Œä¸å†ç»§ç»­å¾€ä¸‹è¿è¡Œã€‚ å†æ¥çœ‹continue: for(var i=0;i&lt;=10;i++)&#123; if(i==5)&#123;continue;&#125; document.write(i); &#125; è¾“å‡ºçš„ç»“æœä¸ºï¼š1234678910ï¼Œå½“içš„å€¼ç­‰äº5çš„æ—¶å€™è·³äº†è¿‡å»ç»§ç»­å‘ä¸‹æ‰§è¡Œå¾ªç¯ã€‚ æœ€åæ¥çœ‹returnï¼Œreturnåªèƒ½å‡ºç°åœ¨å‡½æ•°é‡Œé¢ï¼Œå¦‚æœå‡ºç°åœ¨ä¸Šé¢çš„å®ä¾‹é‡Œçš„forå¾ªç¯é‡Œä¼šæŠ¥é”™ï¼Œè€Œreturnå‡ºç°åœ¨å‡½æ•°é‡Œçš„ä½œç”¨å°±æ˜¯å³ä½¿å‡½æ•°ä¸‹é¢è¿˜æœ‰å†…å®¹ä¹Ÿä¸ä¼šå†æ‰§è¡Œäº†ã€‚ if (username==&quot;&quot;)&#123; alert(&quot;è¯·è¾“å…¥ç”¨æˆ·å&quot;); return false; &#125; if(qq==&quot;&quot;)&#123; alert(&quot;è¯·è¾“å…¥QQ&quot;); return false; &#125; å½“usernameä¸ºç©ºæ—¶ï¼Œå°±ä¸ä¼šå†å‘ä¸‹æ‰§è¡Œã€‚ æ­¤å¤–ï¼Œbreak è¯­å¥å’Œ continue è¯­å¥éƒ½å¯ä»¥ä¸æœ‰æ ‡ç­¾çš„è¯­å¥è”åˆä½¿ç”¨ï¼Œè¿”å›ä»£ç ä¸­çš„ç‰¹å®šä½ç½®ã€‚ é€šå¸¸ï¼Œå½“å¾ªç¯å†…éƒ¨è¿˜æœ‰å¾ªç¯æ—¶ï¼Œä¼šè¿™æ ·åšï¼Œä¾‹å¦‚ï¼š var iNum = 0; outermost: for (var i=0; i&lt;10; i++) &#123; for (var j=0; j&lt;10; j++) &#123; if (i == 5 &amp;&amp; j == 5) &#123; break outermost; &#125; iNum++; &#125; &#125; alert(iNum); //è¾“å‡º &quot;55&quot;Copy åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ ‡ç­¾ outermost è¡¨ç¤ºçš„æ˜¯ç¬¬ä¸€ä¸ª for è¯­å¥ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ¯ä¸ª for è¯­å¥æ‰§è¡Œ 10 æ¬¡ä»£ç å—ï¼Œè¿™æ„å‘³ç€iNum++ æ­£å¸¸æƒ…å†µä¸‹å°†è¢«æ‰§è¡Œ 100 æ¬¡ï¼Œåœ¨æ‰§è¡Œå®Œæˆæ—¶ï¼ŒiNum åº”è¯¥ç­‰äº 100ã€‚è¿™é‡Œçš„ breakè¯­å¥æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå³åœæ­¢å¾ªç¯åè¦è·³è½¬åˆ°çš„è¯­å¥çš„æ ‡ç­¾ã€‚è¿™æ · break è¯­å¥ä¸æ­¢èƒ½è·³å‡ºå†…éƒ¨ for è¯­å¥ï¼ˆå³ä½¿ç”¨å˜é‡ j çš„è¯­å¥ï¼‰ï¼Œè¿˜èƒ½è·³å‡ºå¤–éƒ¨for è¯­å¥ï¼ˆå³ä½¿ç”¨å˜é‡ i çš„è¯­å¥ï¼‰ã€‚å› æ­¤ï¼ŒiNum æœ€åçš„å€¼æ˜¯ 55ï¼Œå› ä¸ºå½“ i å’Œ j çš„å€¼éƒ½ç­‰äº 5 æ—¶ï¼Œå¾ªç¯å°†ç»ˆæ­¢ã€‚ PHP **continue**continueæ˜¯ç”¨æ¥ç”¨åœ¨å¾ªç¯ç»“æ„ä¸­ï¼Œæ§åˆ¶ç¨‹åºæ”¾å¼ƒæœ¬æ¬¡å¾ªç¯continueè¯­å¥ä¹‹åçš„ä»£ç å¹¶è½¬è€Œè¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ã€‚å¦‚æœåœ¨éå¾ªç¯ç»“æ„ä¸­(ä¾‹å¦‚ifè¯­å¥ä¸­ï¼Œswitchè¯­å¥ä¸­)ä½¿ç”¨continueï¼Œç¨‹åºå°†ä¼šå‡ºé”™ã€‚**ä¾‹å¦‚åœ¨ä¸‹é¢çš„è¿™æ®µPHPä»£ç ç‰‡æ®µä¸­ï¼š** for($i = 1;$i &lt;= 100; $i++ )&#123; if($i % 3 == 0 || $i % 7 == 0)&#123; continue; &#125; else&#123; echoâ€$i&lt;br/&gt;â€; &#125; &#125; è¾“å‡º100ä»¥å†…ï¼Œæ—¢ä¸èƒ½è¢«7æ•´é™¤åˆä¸èƒ½è¢«3æ•´é™¤çš„é‚£äº›è‡ªç„¶æ•°ï¼Œå¾ªç¯ä¸­å…ˆç”¨ifæ¡ä»¶è¯­å¥åˆ¤æ–­é‚£äº›èƒ½è¢«æ•´é™¤çš„æ•°ï¼Œç„¶åæ‰§è¡Œ continueï¼Œå°±ç›´æ¥è¿›å…¥äº†ä¸‹ä¸ªå¾ªç¯ã€‚ä¸ä¼šæ‰§è¡Œä¸‹é¢çš„è¾“å‡ºè¯­å¥äº†ã€‚**break**breakæ˜¯è¢«ç”¨åœ¨ä¸Šé¢æ‰€æçš„å„ç§å¾ªç¯å’Œswitchè¯­å¥ä¸­çš„ã€‚ä½œç”¨æ˜¯è·³å‡ºå½“å‰çš„è¯­æ³•ç»“æ„ï¼Œæ‰§è¡Œä¸‹é¢çš„è¯­å¥ã€‚breakè¯­å¥å¯ä»¥å¸¦ä¸€ä¸ªå‚æ•°nï¼Œè¡¨ç¤ºè·³å‡ºå¾ªç¯çš„å±‚æ•°ï¼Œå¦‚æœè¦è·³å‡ºå¤šé‡å¾ªç¯çš„è¯ï¼Œå¯ä»¥ç”¨næ¥è¡¨ç¤ºè·³å‡ºçš„å±‚æ•°ï¼Œå¦‚æœä¸å¸¦å‚æ•°é»˜è®¤æ˜¯è·³å‡ºæœ¬é‡å¾ªç¯ã€‚çœ‹ä¸‹é¢è¿™ä¸ªå¤šé‡å¾ªç¯åµŒå¥—çš„ä¾‹å­ï¼š for($i = 1;$i &lt;= 10; $i++ )&#123; for($j = 1;$j &lt;= 10;$j++)&#123; $m = $i $i + $j $j; echoâ€$m &lt;br/&gt;â€; if($m &lt; 90 || $m &gt; 190) &#123; break 2; &#125; &#125; &#125; è¿™é‡Œä½¿ç”¨äº†break 2è·³å‡ºäº†ä¸¤é‡å¾ªç¯ï¼Œå°†2å»æ‰ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ã€‚ å¦‚æœä¸ä½¿ç”¨å‚æ•°ï¼Œè·³å‡ºçš„åªæ˜¯æœ¬æ¬¡å¾ªç¯ï¼Œç¬¬ä¸€å±‚å¾ªç¯ä¼šç»§ç»­æ‰§è¡Œä¸‹å»ã€‚ **exit**exitæ˜¯ç”¨æ¥ç»“æŸç¨‹åºæ‰§è¡Œçš„ã€‚å¯ä»¥ç”¨åœ¨ä»»ä½•åœ°æ–¹ï¼Œæœ¬èº«æ²¡æœ‰è·³å‡ºå¾ªç¯çš„å«ä¹‰ã€‚exitå¯ä»¥å¸¦ä¸€ä¸ªå‚æ•°ï¼Œå¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼ŒPHPå°†ä¼šç›´æ¥æŠŠå­—ç¬¦ä¸²è¾“å‡ºï¼Œå¦‚æœå‚æ•°æ˜¯integeræ•´å½¢ï¼ˆèŒƒå›´æ˜¯0-254ï¼‰ï¼Œé‚£ä¸ªå‚æ•°å°†ä¼šè¢«ä½œä¸ºç»“æŸçŠ¶æ€ä½¿ç”¨ã€‚ for($i = 1000;$i &gt;= 1 ; $iâ€“ )&#123; if( sqrt($i) &gt;= 29)&#123; echoâ€$i &lt;br/&gt;â€; &#125;else&#123; exit; &#125; &#125; echoâ€æœ¬è¡Œå°†ä¸ä¼šè¢«è¾“å‡ºâ€; ä¾‹å­ä¸­ç›´æ¥åœ¨ä»å¾ªç¯é‡Œç»“æŸäº†ä»£ç çš„è¿è¡Œï¼Œè¿™æ ·ä¼šå¯¼è‡´åé¢çš„ä»£ç éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼Œå¦‚æœæ˜¯åœ¨ä¸€ä¸ªphp web é¡µé¢é‡Œé¢ï¼Œç”šè‡³è¿exitåé¢çš„htmlä»£ç éƒ½ä¸ä¼šè¢«è¾“å‡ºã€‚ **return**return è¯­å¥æ˜¯ç”¨æ¥ç»“æŸä¸€æ®µä»£ç ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‚æ•°çš„ã€‚å¯ä»¥ä»ä¸€ä¸ªå‡½æ•°é‡Œè°ƒç”¨ï¼Œä¹Ÿå¯ä»¥ä»ä¸€ä¸ªinclude()æˆ–è€…require()è¯­å¥åŒ…å«çš„æ–‡ä»¶é‡Œæ¥è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨ä¸»ç¨‹åºé‡Œè°ƒç”¨ï¼Œå¦‚æœæ˜¯åœ¨å‡½æ•°é‡Œè°ƒç”¨ç¨‹åºå°†ä¼šé©¬ä¸Šç»“æŸè¿è¡Œå¹¶è¿”å›å‚æ•°ï¼Œå¦‚æœæ˜¯include()æˆ–è€…require()è¯­å¥åŒ…å«çš„æ–‡ä»¶ä¸­è¢«è°ƒç”¨ï¼Œç¨‹åºæ‰§è¡Œå°†ä¼šé©¬ä¸Šè¿”å›åˆ°è°ƒç”¨è¯¥æ–‡ä»¶çš„ç¨‹åºï¼Œè€Œè¿”å›å€¼å°†ä½œä¸ºinclude()æˆ–è€…require()çš„è¿”å›å€¼ã€‚è€Œå¦‚æœæ˜¯åœ¨ä¸»ç¨‹åºä¸­è°ƒç”¨ï¼Œé‚£ä¹ˆä¸»ç¨‹åºå°†ä¼šé©¬ä¸Šåœæ­¢æ‰§è¡Œ for($i = 1000;$i &gt;= 1 ; $iâ€“ )&#123; if( sqrt($i) &gt;= 29)&#123; echoâ€$i &lt;br/&gt;â€; &#125;else&#123; return; &#125; &#125; echoâ€æœ¬è¡Œå°†ä¸ä¼šè¢«è¾“å‡ºâ€; å’Œä¸Šé¢ä½¿ç”¨exitçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚ åœ¨å¾ªç¯ç»“æŸæ¡ä»¶ï¼Œè‡ªç„¶è·³å‡ºã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"wampè®¾ç½®æœ¬åœ°è™šæœºåŠåŸŸåé‡å®šå‘","slug":"wampè®¾ç½®æœ¬åœ°è™šæœºåŠåŸŸåé‡å®šå‘","date":"2016-04-15T01:17:12.000Z","updated":"2022-03-19T14:35:21.824Z","comments":true,"path":"2016/04/15/40/","link":"","permalink":"https://github.13sai.com/2016/04/15/40/","excerpt":"","text":"1.æ‰“å¼€ wampé‡Œæ‰“å¼€httpd.confæ–‡ä»¶ï¼ˆwamp/bin/apache/apache2.4.9/confï¼‰æœç´¢&nbsp;â€œInclude conf/extra/httpd-vhosts.confâ€ï¼Œç¡®ä¿å‰é¢æ²¡æœ‰ # æ³¨é‡Šç¬¦ï¼Œä¹Ÿå°±æ˜¯ç¡®ä¿å¼•å…¥äº† vhosts è™šæ‹Ÿä¸»æœºé…ç½®æ–‡ä»¶,è®¿é—®æ­¤IPçš„åŸŸåå°†å…¨éƒ¨æŒ‡å‘ vhosts.conf ä¸­çš„ç¬¬ä¸€ä¸ªè™šæ‹Ÿä¸»æœºã€‚è¿™ä¸€æ­¥åƒä¸‡ä¸èƒ½ä¸¢ã€‚ 2.æ‰“å¼€C:/WINDOWS/system32/drivers/etcç›®å½•ä¸‹çš„ hosts ï¼ŒåŠ å…¥ 127.0.0.1 www.a.comï¼ˆæˆ–è€…www.b.com,s1,ä½ æƒ³è®¾æˆä»€ä¹ˆå°±è®¾æˆä»€ä¹ˆï¼‰ hostsæ–‡ä»¶æ˜¯ç”¨æ¥è§£æçš„ï¼Œä½ åœ¨æµè§ˆå™¨é‡Œè¾“å…¥ä¸€ä¸ªåŸŸåwww.a.comï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯æ‰¾hostsæ–‡ä»¶é‡Œæœ‰æ²¡æœ‰www.a.comå¯¹åº”çš„è§£æè®°å½•ï¼Œæ‰¾ä¸åˆ°å†æ‰¾DNSã€‚ 3.åœ¨è™šæ‹Ÿä¸»æœºè®¾ç½®æ–‡ä»¶D:/wamp/wamp/bin/apache/apache2.4.9/conf/extraçš„httpd-vhosts.confé‡Œè®¾ç½®ï¼š åˆ é™¤ NameVirtualHost *:80 å‰é¢çš„ ##ï¼Œè¿™æ ·å°±å¯ç”¨äº† vhosts.conf ï¼Œé»˜è®¤çš„httpd.confé»˜è®¤é…ç½®å¤±æ•ˆã€‚ï¼ˆå…¶å®è¿™éƒ¨åˆ†å¯å¿½ç•¥ï¼Œç°åœ¨çš„ç‰ˆæœ¬éƒ½æœ‰wamp3äº†ï¼Œè¿™äº›æ–°ç‰ˆæœ¬ä¸­ï¼Œä¸‹é¢çš„æ“ä½œå°±é»˜è®¤æ‰“å¼€äº†NameVirtualHost ã€‚ï¼‰è™šæ‹Ÿä¸»æœºé…ç½®å°†åªè®¾ç½®åœ¨ httpd-vhosts.conf é‡Œã€‚ &lt;VirtualHost *:80&gt;ï¼ˆå¦‚æœä½ ç”¨çš„æ˜¯å…¶ä»–ç«¯å£ä¿®æ”¹80å³å¯ï¼Œæˆ‘ç”¨çš„æ˜¯8080ç«¯å£ï¼‰ &nbsp; &nbsp; DocumentRoot &quot;D:/wamp/wamp/wwwroot&quot; ï¼ˆä¸å¯æ¥å—ä¸­æ–‡æ–‡ä»¶å¤¹ï¼‰ &nbsp; &nbsp; ServerName www.a.comï¼ˆä¸ç¬¬äºŒæ­¥ä¸­åŸŸåä¿æŒä¸€è‡´ï¼‰ &nbsp;&nbsp;&nbsp; &nbsp;&lt;Directory /&gt;ï¼ˆè®¾ç½®DocumentRootå¯ä»¥æ¥å—å…¶ä»–ç›˜æ–‡ä»¶å¤¹ï¼‰&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; Options Indexes FollowSymLinks&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Order allow,deny&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Allow from all&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Require all granted&nbsp; &lt;/Directory&gt; &lt;/VirtualHost&gt; è¿™æ ·å°±å®Œæˆäº†ï¼Œæµè§ˆå™¨è¾“å…¥www.a.com,å¦‚æœä½ ç”¨çš„æ˜¯8080ï¼Œé‚£å°±è¾“å…¥www.a.com:8080ã€‚å½“ç„¶ä¹Ÿå¯ä»¥è®¾ç½®å¾ˆå¤šï¼Œé‡å¤ç¬¬äºŒæ­¥ç¬¬ä¸‰æ­¥å³å¯ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"wamp","slug":"wamp","permalink":"https://github.13sai.com/tags/wamp/"}]},{"title":"è¯„è®ºå®æ—¶åˆ·æ–°æ•ˆæœ","slug":"è¯„è®ºå®æ—¶åˆ·æ–°æ•ˆæœ","date":"2016-04-12T13:21:17.000Z","updated":"2022-03-19T14:35:21.944Z","comments":true,"path":"2016/04/12/39/","link":"","permalink":"https://github.13sai.com/2016/04/12/39/","excerpt":"","text":"è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šç¤ºä¾‹ã€‚å‡†å¤‡ï¼šå‰å°jquery1.8 &nbsp;åå°thinkphp3.1 æ•°æ®åº“mysql è¡¨commentï¼ˆå­—æ®µc_id, m_nick_name, weibo_id, w_content, insert_time, member_idç­‰ï¼‰html:&lt;ul&nbsp;class=&quot;weibo-menu&quot;&gt; &nbsp;&nbsp;&lt;li&gt;è½¬å‘&lt;/li&gt; &nbsp;&nbsp;&lt;li&gt;&lt;a&nbsp;class=&quot;pinglun&quot;&nbsp;data-rel=&quot;24&quot;&nbsp;onclick=&quot;getComment(24)&quot;&gt;è¯„è®º&lt;/a&gt;&lt;/li&gt; &nbsp;&nbsp;&lt;li&gt;èµ&amp;nbsp;/li&gt; &lt;/ul&gt; &lt;div&nbsp;class=&quot;comment-module-24&quot;&nbsp;style=&quot;display:none;&quot;&gt; &nbsp;&nbsp;&lt;input&nbsp;type=&quot;text&quot;&nbsp;class=&quot;comment-24&quot;&nbsp;placeholder=&quot;æƒ³è¯´ç‚¹ä»€ä¹ˆ&quot;/&gt; &nbsp;&nbsp;&lt;div&gt; &nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;class=&quot;am-btn&quot;&nbsp;type=&quot;button&quot;&nbsp;onclick=&quot;getComment(24)&quot;&gt;è¯„è®º&lt;/button&gt; &nbsp;&nbsp;&lt;/div&gt; &nbsp;&nbsp;&lt;div&nbsp;class=&quot;am-padding&nbsp;comment-list-24&quot;&gt;&lt;/div&gt; &lt;/div&gt;js:$(function()&nbsp;{ &nbsp;&nbsp;$(&#39;.pinglun&#39;).on(&#39;click&#39;,&nbsp;function()&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//è¯„è®ºåˆ—è¡¨çš„æ˜¾ç¤ºéšè— &nbsp;&nbsp;id2&nbsp;=&nbsp;$(this).attr(&#39;data-rel&#39;); &nbsp;&nbsp;$(&#39;.comment-module-&#39;+id2).toggle(); &nbsp;&nbsp;}); &nbsp;&nbsp; }); function&nbsp;getComment(id){&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;è·å–å¯¹åº”id&nbsp;&nbsp;&nbsp;&nbsp;comment&nbsp;=&nbsp;$(&#39;.comment-&#39;&nbsp;+&nbsp;id).val();&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ajaxåˆ·æ–°&nbsp;&nbsp;&nbsp;&nbsp;$.post(&quot;{:U(&#39;getComment&#39;)}&quot;,&nbsp;{&nbsp;w_id:&nbsp;id&nbsp;,&nbsp;w_comment:&nbsp;comment},&nbsp;function(data){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//jsonæ ¼å¼ &nbsp;&nbsp;data&nbsp;=&nbsp;JSON.parse(data); &nbsp;&nbsp;//åˆå§‹åŒ–å˜é‡ &nbsp;&nbsp;html&nbsp;=&nbsp;&#39;&#39;;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;//å¾ªç¯è¾“å‡ºè¯„è®ºåˆ—è¡¨å¹¶å­˜å…¥htmlå˜é‡ &nbsp;&nbsp;$.each(data,&nbsp;function(i,&nbsp;item)&nbsp;{ &nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;+=&nbsp;&#39;&lt;div&gt;&nbsp;&#39;+&nbsp;item.m_nick_name&nbsp;+&nbsp;&#39;ï¼š&#39;+item.w_content&nbsp;+&nbsp;&#39;&lt;br/&gt;&#39;&nbsp;+&nbsp;item.insert_time&nbsp;+&nbsp;&#39;&lt;/div&gt;&lt;hr/&gt;&#39;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;.comment-list-&quot;+id).html(html);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;.comment-&#39;&nbsp;+&nbsp;id).val(&#39;&#39;);&nbsp;&nbsp;&nbsp;&nbsp;});};åå°ï¼špublic&nbsp;function&nbsp;getComment(){ $c&nbsp;=&nbsp;M(&quot;comment&quot;); $weibo_id&nbsp;=&nbsp;I(&#39;w_id&#39;); $w_content&nbsp;=&nbsp;I(&#39;w_comment&#39;);&nbsp;&nbsp;&nbsp;&nbsp;//åˆ¤æ–­æ˜¯å¦æœ‰è¯„è®ºä¼ å…¥ if($w_content&nbsp;==&nbsp;&#39;&#39;){ $list&nbsp;=&nbsp;$c-&gt;where(&quot;weibo_id=%d&quot;,$weibo_id)-&gt;order(&#39;c_id&nbsp;desc&#39;)-&gt;limit(5)-&gt;select(); echo&nbsp;json_encode($list); }else{ $data[&#39;weibo_id&#39;]&nbsp;=&nbsp;$weibo_id; $data[&#39;w_content&#39;]&nbsp;=&nbsp;$w_content; $data[&#39;member_id&#39;]&nbsp;=&nbsp;session(&#39;m_id&#39;); $r&nbsp;=&nbsp;$c-&gt;add($data); $list&nbsp;=&nbsp;$c-&gt;where(&quot;weibo_id=%d&quot;,$weibo_id)-&gt;order(&#39;c_id&nbsp;desc&#39;)-&gt;limit(6)-&gt;select(); echo&nbsp;json_encode($list); } &nbsp;&nbsp;&nbsp;&nbsp;}PS:å®šä¹‰å’Œç”¨æ³•post() æ–¹æ³•é€šè¿‡ HTTP POST è¯·æ±‚ä»æœåŠ¡å™¨è½½å…¥æ•°æ®ã€‚è¯­æ³•jQuery.post(url,data,success(data,&nbsp;textStatus,&nbsp;jqXHR),dataType)å‚æ•°æè¿°urlå¿…éœ€ã€‚è§„å®šæŠŠè¯·æ±‚å‘é€åˆ°å“ªä¸ª URLã€‚dataå¯é€‰ã€‚æ˜ å°„æˆ–å­—ç¬¦ä¸²å€¼ã€‚è§„å®šè¿åŒè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ã€‚success(data, textStatus, jqXHR)å¯é€‰ã€‚è¯·æ±‚æˆåŠŸæ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚dataTypeå¯é€‰ã€‚è§„å®šé¢„æœŸçš„æœåŠ¡å™¨å“åº”çš„æ•°æ®ç±»å‹ã€‚é»˜è®¤æ‰§è¡Œæ™ºèƒ½åˆ¤æ–­ï¼ˆxmlã€jsonã€script æˆ– htmlï¼‰ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"å¤šç§font-family","slug":"å¤šç§font-family","date":"2016-04-06T11:39:04.000Z","updated":"2022-03-19T14:35:21.903Z","comments":true,"path":"2016/04/06/38/","link":"","permalink":"https://github.13sai.com/2016/04/06/38/","excerpt":"","text":"ä¿®æ”¹ä¸€ä¸ªä¸­è‹±æ–‡æ··åˆcsséœ€æ±‚æ—¶ï¼Œçœ‹åˆ°äº†ä»¥ä¸‹æ ·å¼ã€‚ font: 12px/25px &quot;Microsoft Yahei&quot;, &quot;å¾®è½¯é›…é»‘&quot;, &quot;å®‹ä½“&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; å±…ç„¶è®¾ç½®äº†è¿™ä¹ˆå¤šå­—ä½“ã€‚ç„¶åå°±æŸ¥äº†æŸ¥ï¼Œè´´ä¸Šæ¥ã€‚ font-familyçš„è°ƒç”¨æ–¹æ³•: ä»£ç å¦‚ä¸‹: div &#123; font-family:Arial,&#x27;Times New Roman&#x27;,&#x27;Microsoft YaHei&#x27;,SimHei; font:bold 12px/0.75em Arial,&#x27;Times New Roman&#x27;,&#x27;Microsoft YaHei&#x27;,SimHei; &#125; font-family å¯ä»¥æŠŠå¤šä¸ªå­—ä½“åç§°ä½œä¸ºä¸€ä¸ªâ€œå›é€€â€ç³»ç»Ÿæ¥ä¿å­˜ã€‚å¦‚æœæµè§ˆå™¨ä¸æ”¯æŒç¬¬ä¸€ä¸ªå­—ä½“ï¼Œåˆ™ä¼šå°è¯•ä¸‹ä¸€ä¸ªã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œfont-family å±æ€§çš„å€¼æ˜¯ç”¨äºæŸä¸ªå…ƒç´ çš„å­—ä½“æ—åç§°æˆ–/åŠç±»æ—åç§°çš„ä¸€ä¸ªä¼˜å…ˆè¡¨ã€‚æµè§ˆå™¨ä¼šä½¿ç”¨å®ƒå¯è¯†åˆ«çš„ç¬¬ä¸€ä¸ªå€¼ã€‚ æ ¹æ®font-familyçš„å­—ä½“è°ƒç”¨åŸåˆ™æˆ‘ä»¬å¯ä»¥ä¸ºè‹±æ–‡,ä¸­æ–‡,ç­‰ä¸¤ç§å­—ä½“è°ƒç”¨ä¸åŒçš„å­—ä½“æ¥æ¸²æŸ“ã€‚ å¦‚:Arial,â€™Times New Romanâ€™è¿™ä¸¤ç§å­—ä½“ä¸è®¤è¯†ä¸­æ–‡,åªè®¤è¯†è‹±æ–‡,æ‰€ä»¥,è¿™ä¸¤ç§å­—ä½“åªèƒ½æ¸²æŸ“è‹±æ–‡æ•°å­—å’Œä¸€äº›ç‰¹æ®Šç¬¦å·,è€Œé¡µé¢ä¸­çš„ä¸­æ–‡å°±ä¼šè‡ªåŠ¨è°ƒç”¨ç¬¬ä¸‰ç§å­—ä½“Microsoft YaHei(PS:å‡å¦‚å­˜åœ¨è¿™ç§å­—ä½“çš„è¯)ã€‚ æ‰€ä»¥,åœ¨å®šä¹‰å­—ä½“çš„æ—¶å€™æŠŠè‹±æ–‡çš„å­—ä½“å†™åœ¨å‰é¢æŠŠä¸­æ–‡çš„å†™åœ¨åé¢ã€‚è¿™æ ·ï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨æŒ‰é¡ºåºä¾æ¬¡ç»™å­—ç”¨å­—ä½“ï¼Œå¦‚æœå½“å‰å­—ä½“ä¸æ”¯æŒæ–‡æœ¬ï¼Œè‡ªåŠ¨æ¢ç”¨åˆ—è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªå­—ä½“ã€‚ ç»è¿‡æµ‹è¯•ï¼ŒIE9ã€IE9å…¼å®¹æ¨¡å¼ï¼ˆå…¼å®¹IE8ï¼‰ã€Chromeæµè§ˆå™¨æœ€æ–°ç‰ˆæœ¬ï¼ˆ34.0ï¼‰ã€ Firefoxæµè§ˆå™¨æœ€æ–°ç‰ˆæœ¬ï¼ˆ29.0ï¼‰æ”¯æŒè¯¥font-familyå±æ€§ï¼›ä½†æ˜¯æŸäº›ç‰ˆæœ¬çš„IEæµè§ˆå™¨ï¼ˆIE7ã€IE8ï¼‰æ— æ³•å®ç°è¯¥font-familyå±æ€§çš„è¦æ±‚ï¼Œè¿˜ä¼šæš´éœ²å‡ºä¸€äº›å¥‡æ€ªçš„ bugã€‚å¦‚åœ¨è¿™äº›ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸‹ä½¿ç”¨ä¸­æ–‡å­—ä½“ï¼ˆæ¯”å¦‚å¾®è½¯é›…é»‘ï¼‰ï¼Œéœ€è¦æŠŠè¯¥ä¸­æ–‡å­—ä½“æ”¾åˆ°font-familyå±æ€§çš„é¦–ä½ï¼Œä½†æ˜¯ä¼šå¯¼è‡´è‹±æ–‡å­—ä½“ä¹Ÿä¼šä½¿ç”¨è¯¥ä¸­ æ–‡å­—ä½“æ¸²æŸ“ã€‚å³åœ¨è¿™äº›æµè§ˆå™¨ï¼ˆIE7ã€IE8ï¼‰ä¸‹ä¸æ”¯æŒåœ¨font-familyå±æ€§ä¸­ä¸ºè‹±æ–‡å’Œä¸­æ–‡å­—ä½“åˆ†åˆ«ä½¿ç”¨ä¸åŒçš„å­—ä½“ã€‚ æˆ‘æ”¹æˆè¿™æ ·ï¼Œ font: 12px/25px &quot;Times New Roman&quot;, &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; ç”¨360å…¼å®¹æ¨¡å¼æµ‹äº†ä¸‹ï¼ŒIE7ï¼Œ8éƒ½æ²¡å‘ç°æ–‡ç« ä¸­è¯´çš„é—®é¢˜ã€‚","categories":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/categories/css/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"utf-8çš„BOMå¤´","slug":"utf-8çš„BOMå¤´","date":"2016-03-29T00:57:43.000Z","updated":"2022-03-19T14:35:21.816Z","comments":true,"path":"2016/03/29/34/","link":"","permalink":"https://github.13sai.com/2016/03/29/34/","excerpt":"","text":"æ˜¨å¤©å»å®¢æˆ·é‚£é‡Œï¼Œè¿™è¾¹æœ‰éœ€æ±‚ä¾¿éƒ½äº¤ç”±åŒæ—¶å¤„ç†ï¼Œå¯æœ‰ä¸ªéœ€æ±‚ä»–ä»…ä»…å¸®æˆ‘æ”¹äº†å‡ ä¸ªæ±‰å­—ï¼Œä¾¿å‡ºç°äº†å±‚ä¸Šå¤šäº†æ®µç©ºç™½ï¼Œä¸¤ä¸ªäººè°ƒè¯•äº†ä¸‹éƒ½æ²¡å‘ç°é—®é¢˜ï¼Œæœ€åç”¨è°·æ­Œå¼€å‘è€…å·¥å…·å‘ç°è¿™ä¸ªdivä¸Šé¢å¤šäº†&amp;#65279ï¼Œåˆ é™¤å®ƒå³æ­£å¸¸ã€‚ç™¾åº¦ä¸‹ï¼Œå‘ç°è¿˜çœŸæœ‰äººé‡åˆ°ï¼Œæ˜¯BOMçš„åŸå› ã€‚ç¡®å®ï¼Œè¿™ä¸ªå±‚å¤šå¤„æ¶‰åŠï¼Œæˆ‘å°±æŠŠå®ƒä½œä¸ºä¸€ä¸ªå•ç‹¬æ–‡ä»¶å¼•å…¥çš„ï¼ŒåŒäº‹ç›´æ¥åœ¨è®°äº‹æœ¬é‡Œä¿®æ”¹ï¼Œä»¥è‡´ä¿å­˜æ—¶è‡ªåŠ¨ä¿å­˜ä¸ºæœ‰BOMçš„utf-8æ ¼å¼ã€‚UTF-8ç­¾åï¼ˆUTF-8 signatureï¼‰ä¹Ÿå«åšBOMï¼ˆByte Order Markï¼‰ï¼Œæ˜¯UTFç¼–ç æ–¹æ¡ˆé‡Œç”¨äºæ ‡è¯†ç¼–ç çš„æ ‡å‡†æ ‡è®°ã€‚BOMï¼Œæ˜¯UTFç¼–ç æ–¹æ¡ˆé‡Œç”¨äºæ ‡è¯†ç¼–ç çš„æ ‡å‡†æ ‡è®°ï¼Œåœ¨UTF-16é‡Œæœ¬æ¥æ˜¯FF FEï¼Œå˜æˆUTF-8å°±æˆäº†EF BB BFã€‚è¿™ä¸ªæ ‡è®°æ˜¯å¯é€‰çš„ï¼Œå› ä¸ºUTF8å­—èŠ‚æ²¡æœ‰é¡ºåºï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«ç”¨æ¥æ£€æµ‹ä¸€ä¸ªå­—èŠ‚æµæ˜¯å¦æ˜¯UTF-8ç¼–ç çš„ã€‚å¾®è½¯åšè¿™ç§æ£€æµ‹ï¼Œä½†æœ‰äº›è½¯ä»¶ä¸åšè¿™ç§æ£€æµ‹ï¼Œ è€ŒæŠŠå®ƒå½“ä½œæ­£å¸¸å­—ç¬¦å¤„ç†ã€‚å¾®è½¯åœ¨è‡ªå·±çš„UTF-8æ ¼å¼çš„æ–‡æœ¬æ–‡ä»¶ä¹‹å‰åŠ ä¸Šäº†EF BB BFä¸‰ä¸ªå­—èŠ‚, windowsä¸Šé¢çš„notepadç­‰ç¨‹åºå°±æ˜¯æ ¹æ®è¿™ä¸‰ä¸ªå­—èŠ‚æ¥ç¡®å®šä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶æ˜¯ASCIIçš„è¿˜æ˜¯UTF-8çš„, ç„¶è€Œè¿™ä¸ªåªæ˜¯å¾®è½¯æš—è‡ªä½œçš„æ ‡è®°, å…¶å®ƒå¹³å°ä¸Šå¹¶æ²¡æœ‰å¯¹UTF-8æ–‡æœ¬æ–‡ä»¶åšä¸ªè¿™æ ·çš„æ ‡è®°ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªUTF-8æ–‡ä»¶å¯èƒ½æœ‰BOMï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰BOMã€‚ä¿®æ”¹æ¨¡ç‰ˆçš„æ—¶å€™ï¼Œç”±äºè¾“å‡ºé¡µé¢ä½¿ç”¨UTF-8ç¼–ç ï¼Œé‚£ä¹ˆä¿®æ”¹æ¨¡ç‰ˆçš„æ—¶å€™å¦‚æœæœ‰åŠ å…¥ä¸­æ–‡å­—ç¬¦çš„è¯ï¼Œå¿…é¡»æŠŠæ–‡ä»¶è½¬æˆUTF-8ç¼–ç æ‰èƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæ‰€ä½¿ç”¨çš„ç¼–è¾‘å™¨è‡ªåŠ¨åŠ ä¸Šäº†BOMçš„è¯ï¼Œå°†ä¼šé€ æˆåœ¨é¡µé¢ä¸Šè¾“å‡ºè¿™ä¸‰ä¸ªå­—ç¬¦ï¼Œæ˜¾ç¤ºæ•ˆæœå°±è¦çœ‹æµè§ˆå™¨äº†ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªç©ºè¡Œæˆ–æ˜¯ä¸€ä¸ªä¹±ç ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/tags/web/"}]},{"title":"CSSç¼–å†™äºŒä¸‰äº‹","slug":"CSSç¼–å†™äºŒä¸‰äº‹","date":"2016-03-26T11:44:31.000Z","updated":"2022-03-19T14:35:21.571Z","comments":true,"path":"2016/03/26/33/","link":"","permalink":"https://github.13sai.com/2016/03/26/33/","excerpt":"","text":"å¤§çº¦å·¥ä½œä¸¤ä¸ªæœˆåï¼Œæ„Ÿè§‰ç¼–å†™CSSæ ·å¼æœ‰ç‚¹æ··ä¹±ï¼Œä¾¿æœé›†äº†æ–‡ç« ï¼Œç»“åˆè‡ªå·±çš„ç»éªŒï¼Œæ•´ç†å¦‚ä¸‹ã€‚ ä¸€ã€CSSä¹¦å†™é¡ºåºï¼ˆæ¨èï¼‰ ä½ç½®å±æ€§(position, top, right, z-index, display, floatç­‰) å¤§å°(width, height, padding, margin) æ–‡å­—ç³»åˆ—(font, line-height, letter-spacing, color- text-alignç­‰) èƒŒæ™¯(background, borderç­‰) å…¶ä»–(animation, transitionç­‰) å…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå…ˆå®šä½ï¼Œæ¥ç€æ§åˆ¶å¤§å°ï¼Œç„¶åç¼–å†™ï¼Œå†æ˜¯ç¾åŒ–èƒŒæ™¯ï¼Œæœ€åå…¶ä»–å±æ€§ã€‚ ä¸ªäººä¹ æƒ¯æŠŠèƒŒæ™¯å†™åœ¨æ–‡å­—å‰ã€‚ äºŒã€CSSä¹¦å†™è§„èŒƒ ç¼©å†™å±æ€§ CSSä¸­éƒ¨åˆ†å±æ€§æ˜¯å¯ä»¥ç¼©å†™çš„ï¼Œæ¯”å¦‚padding,border,fontç­‰ï¼Œç¼©å†™ç²¾ç®€ä»£ç åŒæ—¶åˆèƒ½æé«˜ç”¨æˆ·çš„é˜…è¯»ä½“éªŒã€‚ ç®€å†™å‘½å ç®€å†™ç±»åï¼Œå‰ææ˜¯è¦è®©äººçœ‹æ‡‚ä½ çš„å‘½åã€‚ å¦å¤–é¢œè‰²ä»£ç æ˜¯å¯ä»¥ç¼©å†™çš„ï¼Œæˆ‘ä»¬å°±å°½é‡ç¼©å†™å§ï¼Œæé«˜ç”¨æˆ·ä½“éªŒä¸ºä¸»ã€‚ è¿å­—ç¬¦CSSé€‰æ‹©å™¨å‘½åè§„èŒƒ é•¿åç§°æˆ–è¯ç»„å¯ä»¥ä½¿ç”¨ä¸­æ¨ªçº¿æ¥ä¸ºé€‰æ‹©å™¨å‘½åã€‚ ä¸å»ºè®®ä½¿ç”¨â€œ_â€ä¸‹åˆ’çº¿æ¥å‘½åCSSé€‰æ‹©å™¨ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ è¾“å…¥çš„æ—¶å€™å°‘æŒ‰ä¸€ä¸ªshifté”®ï¼› æµè§ˆå™¨å…¼å®¹é—®é¢˜ ï¼ˆæ¯”å¦‚ä½¿ç”¨_tipsçš„é€‰æ‹©å™¨å‘½åï¼Œåœ¨IE6æ˜¯æ— æ•ˆçš„ï¼‰ èƒ½è‰¯å¥½åŒºåˆ†JavaScriptå˜é‡å‘½åï¼ˆJSå˜é‡å‘½åæ˜¯ç”¨â€œ_â€ï¼‰ ä¸è¦æ»¥ç”¨id idä¸€èˆ¬åœ¨ä¸€ä¸ªé¡µé¢æ˜¯å”¯ä¸€çš„ï¼Œä¸èƒ½å¤šæ¬¡ä½¿ç”¨ï¼Œè€Œclasså¯ä»¥é‡å¤ä½¿ç”¨ï¼Œå¦å¤–idçš„ä¼˜å…ˆçº§ä¼˜å…ˆäºclassï¼Œæ‰€ä»¥idåº”è¯¥æŒ‰éœ€ä½¿ç”¨ï¼Œä¸èƒ½æ»¥ç”¨ã€‚ ä¸ºé€‰æ‹©å™¨æ·»åŠ çŠ¶æ€å‰ç¼€ æœ‰æ—¶å€™å¯ä»¥ç»™é€‰æ‹©å™¨æ·»åŠ ä¸€ä¸ªè¡¨ç¤ºçŠ¶æ€çš„å‰ç¼€ï¼Œè®©è¯­ä¹‰æ›´æ˜äº†ï¼Œæ¯”å¦‚æ·»åŠ äº†â€œ.is-â€å‰ç¼€ã€‚ ä¸‰ã€CSSå‘½åè§„èŒƒï¼ˆå¸¸è§ï¼‰```å¤´ï¼šheaderå†…å®¹ï¼šcontent/containerå°¾ï¼šfooterå¯¼èˆªï¼šnavä¾§æ ï¼šsidebarç™»å½•æ¡ï¼šloginbaræ ‡å¿—ï¼šlogoå¹¿å‘Šï¼šbanneré¡µé¢ä¸»ä½“ï¼šmainçƒ­ç‚¹ï¼šhotä¸‹è½½ï¼šdownloadå­å¯¼èˆªï¼šsubnavèœå•ï¼šmenuå­èœå•ï¼šsubmenuæœç´¢ï¼šsearchå‹æƒ…é“¾æ¥ï¼šfriendlinké¡µè„šï¼šfooterç‰ˆæƒï¼šcopyrightæ»šåŠ¨ï¼šscrollå†…å®¹ï¼šcontentæ ‡ç­¾ï¼štagsæ–‡ç« åˆ—è¡¨ï¼šlistæç¤ºä¿¡æ¯ï¼šmsgå°æŠ€å·§ï¼štipsæ ç›®æ ‡é¢˜ï¼štitleåŠ å…¥ï¼šjoinusæŒ‡å—ï¼šguideæœåŠ¡ï¼šserviceæ³¨å†Œï¼šregsiterçŠ¶æ€ï¼šstatusæŠ•ç¥¨ï¼švoteåˆä½œä¼™ä¼´ï¼špartner æ³¨é‡Šçš„å†™æ³•:/* Header /å†…å®¹/ End Header */ å››ã€æ³¨æ„äº‹é¡¹: å®šä¹‰CSSå­—ç¬¦ç¼–ç @charset â€œutf-8â€ ä¸€å¾‹å°å†™ ä¸åŠ ä¸‹åˆ’çº¿ å‘½åå°½é‡ç”¨è‹±æ–‡ï¼Œå°½é‡ä¸ç¼©å†™ï¼Œé™¤éä¸€çœ‹å°±æ˜ç™½çš„å•è¯ æ·»åŠ å¿…è¦çš„æ³¨é‡Š","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"jså®ç°å€’è®¡æ—¶","slug":"jså®ç°å€’è®¡æ—¶","date":"2016-03-21T15:10:52.000Z","updated":"2022-03-19T14:35:21.734Z","comments":true,"path":"2016/03/21/31/","link":"","permalink":"https://github.13sai.com/2016/03/21/31/","excerpt":"","text":"setTimeoutï¼ŒsetIntervalçš„åŒºåˆ«åœ¨äºsetTimeoutä¼šåœ¨è®¾å®šçš„æ—¶é—´åæ‰§è¡Œä¸€æ¬¡äº‹ä»¶ï¼Œè€ŒsetIntervalæ¯éš”ä¸€æ®µè®¾å®šçš„æ—¶é—´æ‰§è¡Œä¸€æ¬¡äº‹ä»¶ã€‚ åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯æ¯ç§’æ‰§è¡Œä¸€æ¬¡äº‹ä»¶ï¼Œå¹¶åœ¨divä¸­æ˜¾ç¤ºã€‚ é¦–å…ˆæ¥çœ‹çœ‹setIntervalï¼Œ &lt;div id=&quot;daojishi&quot; data-rel=&quot;80&quot;&gt;&lt;/div&gt; &lt;script src=&quot;http://libs.baidu.com/jquery/1.9.0/jquery.js&quot;&gt;&lt;/script&gt; &lt;script&gt; function daojishi(limit, id)&#123; document.getElementById(id).innerText = getTimerString(limit); &#125; //æŠŠæ—¶é—´æ¢ç®—ä¸ºæ—¶åˆ†ç§’å¹¶è¿”å› function getTimerString(time) &#123; h = Math.floor(time / 3600), m = Math.floor((time % 3600) / 60), s = Math.floor((time % 3600) % 60); if (time&gt;0) return h + &quot;:&quot; + m + &quot;:&quot; + s; else return &quot;æ—¶é—´åˆ°&quot;; &#125; $(function()&#123; var hour = 60 * $(&#x27;#daojishi&#x27;).attr(&#x27;data-rel&#x27;);//æ—¶é—´æ¢ç®—ä¸ºç§’ setInterval(function()&#123; hourâ€“;//æ¯æ¬¡æ—¶é—´å‡ä¸€ç§’ daojishi(hour, &#x27;daojishi&#x27;); &#125;, 1000); &#125;); &lt;/script&gt;Copy æ¥ä¸‹æ¥æ˜¯setTimeoutï¼Œå…³é”®çš„ä¸€æ­¥ï¼Œé€šè¿‡è‡ªèº«è°ƒç”¨ï¼Œå®ç°äº‹ä»¶çš„ä¸æ–­æ‰§è¡Œã€‚ &lt;div id=&quot;daojishi&quot; data-rel=&quot;120&quot;&gt;&lt;/div&gt; &lt;script src=&quot;http://libs.baidu.com/jquery/1.9.0/jquery.js&quot;&gt;&lt;/script&gt; &lt;script&gt; function daojishi(limit, id)&#123; document.getElementById(id).innerText = getTimerString(limit); limit--; //æ¯æ¬¡å‡å»ä¸€ç§’ setTimeout(function()&#123;daojishi(limit, id);&#125;, 1000);//è¿™æ˜¯å…³é”®çš„ä¸€æ­¥ï¼Œé€šè¿‡è‡ªèº«å†æ¬¡è°ƒç”¨ï¼Œå®ç°äº‹ä»¶çš„å¤šæ¬¡å‘ç”Ÿ &#125; function getTimerString(time) &#123; h = Math.floor(time / 3600), m = Math.floor((time % 3600) / 60), s = Math.floor((time % 3600) % 60); if (time&gt;0) return h + &quot;:&quot; + m + &quot;:&quot; + s; else return &quot;æ—¶é—´åˆ°&quot;; &#125; &lt;/script&gt; &lt;script&gt; var hour = 60 * $(&#x27;#daojishi&#x27;).attr(&#x27;data-rel&#x27;); daojishi( hour, &#x27;daojishi&#x27;); &lt;/script&gt;Copy éœ€è¦æ³¨æ„çš„æ˜¯æ—¶é—´çš„æ¢ç®—ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"}]},{"title":"phpä¸Šä¼ å›¾ç‰‡å¹¶æ˜¾ç¤º","slug":"phpä¸Šä¼ å›¾ç‰‡å¹¶æ˜¾ç¤º","date":"2016-03-21T13:57:33.000Z","updated":"2022-03-19T14:35:21.777Z","comments":true,"path":"2016/03/21/30/","link":"","permalink":"https://github.13sai.com/2016/03/21/30/","excerpt":"","text":"è¡¨å•ä»£ç &lt;html&gt; &lt;body&gt; &lt;form&nbsp;action=&quot;&quot;&nbsp;method=&quot;post&quot;&nbsp;enctype=&quot;multipart/form-data&quot;&gt; &lt;label&nbsp;for=&quot;file&quot;&gt;Filename:&lt;/label&gt; &lt;input&nbsp;type=&quot;file&quot;&nbsp;name=&quot;file&quot;&nbsp;id=&quot;file&quot;&nbsp;/&gt; &lt;br&nbsp;/&gt; &lt;input&nbsp;type=&quot;submit&quot;&nbsp;name=&quot;submit&quot;&nbsp;value=&quot;æäº¤&quot;&nbsp;/&gt; &lt;/form&gt; &lt;img&nbsp;src=&quot;&lt;?php&nbsp;echo&nbsp;&quot;upload/&quot;&nbsp;.&nbsp;$_FILES[&quot;file&quot;][&quot;name&quot;];?&gt;&quot;&gt; &lt;/body&gt; &lt;/html&gt;æ³¨æ„æ­¤å¤„enctype=&quot;multipart/form-data&quot;å¿…ä¸å¯å°‘ã€‚æœ¬é¡µä¸Šä¼ ä»£ç &lt;?php //é™åˆ¶æ ¼å¼ã€å¤§å° if&nbsp;((($_FILES[&quot;file&quot;][&quot;type&quot;]&nbsp;==&nbsp;&quot;image/gif&quot;)&nbsp;||&nbsp;($_FILES[&quot;file&quot;][&quot;type&quot;]&nbsp;==&nbsp;&quot;image/jpeg&quot;)&nbsp;||&nbsp;($_FILES[&quot;file&quot;][&quot;type&quot;]&nbsp;==&nbsp;&quot;image/pjpeg&quot;))&nbsp;&amp;&amp;&nbsp;($_FILES[&quot;file&quot;][&quot;size&quot;]&nbsp;&lt;&nbsp;20000)){ if&nbsp;($_FILES[&quot;file&quot;][&quot;error&quot;]&nbsp;&gt;&nbsp;0){ echo&nbsp;&quot;Return&nbsp;Code:&nbsp;&quot;&nbsp;.&nbsp;$_FILES[&quot;file&quot;][&quot;error&quot;]&nbsp;.&nbsp;&quot;&lt;br&nbsp;/&gt;&quot;; }else{ echo&nbsp;&quot;å›¾ç‰‡åç§°:&nbsp;&quot;&nbsp;.&nbsp;$_FILES[&quot;file&quot;][&quot;name&quot;]&nbsp;.&nbsp;&quot;&lt;br&nbsp;/&gt;&quot;; echo&nbsp;&quot;ç±»å‹:&nbsp;&quot;&nbsp;.&nbsp;$_FILES[&quot;file&quot;][&quot;type&quot;]&nbsp;.&nbsp;&quot;&lt;br&nbsp;/&gt;&quot;; echo&nbsp;&quot;å¤§å°:&nbsp;&quot;&nbsp;.&nbsp;($_FILES[&quot;file&quot;][&quot;size&quot;]&nbsp;/&nbsp;1024)&nbsp;.&nbsp;&quot;&nbsp;Kb&lt;br&nbsp;/&gt;&quot;; echo&nbsp;&quot;ä¸´æ—¶æ–‡ä»¶å:&nbsp;&quot;&nbsp;.&nbsp;$_FILES[&quot;file&quot;][&quot;tmp_name&quot;]&nbsp;.&nbsp;&quot;&lt;br&nbsp;/&gt;&quot;; if&nbsp;(file_exists(&quot;upload/&quot;&nbsp;.&nbsp;$_FILES[&quot;file&quot;][&quot;name&quot;])){&nbsp;//åˆ¤æ–­æ˜¯å¦é‡å echo&nbsp;$_FILES[&quot;file&quot;][&quot;name&quot;]&nbsp;.&nbsp;&quot;&nbsp;å·²ç»å­˜åœ¨.&nbsp;&quot;; }else{ move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload/&quot;&nbsp;.&nbsp;$_FILES[&quot;file&quot;][&quot;name&quot;]); echo&nbsp;å­˜å‚¨ä½ç½®:&nbsp;&quot;&nbsp;.&nbsp;&quot;upload/&quot;&nbsp;.&nbsp;$_FILES[&quot;file&quot;][&quot;name&quot;]; } } }else{ echo&nbsp;&quot;æ–‡ä»¶æ ¼å¼ä¸å¯¹æˆ–è¶…è¿‡é™åˆ¶å¤§å°&quot;; } ?&gt;è¿™æ ·ï¼Œæˆ‘ä»¬ä¾¿èƒ½å®ç°ç®€å•çš„å›¾ç‰‡ä¸Šä¼ äº†ã€‚å½“ç„¶ï¼Œæ–‡ä»¶ç±»æ¯”ï¼Œä¿®æ”¹å³å¯ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"cssé™åˆ¶å­—æ•°ï¼ˆå•è¡Œï¼‰","slug":"cssé™åˆ¶å­—æ•°ï¼ˆå•è¡Œï¼‰","date":"2016-03-17T15:25:58.000Z","updated":"2022-03-19T14:35:21.677Z","comments":true,"path":"2016/03/17/29/","link":"","permalink":"https://github.13sai.com/2016/03/17/29/","excerpt":"","text":"ç»å¸¸ä¼šé‡åˆ°å­—æ•°è¶…å‡ºå¯¼è‡´å¸ƒå±€è¢«ç ´åçš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬å°±è¦é™åˆ¶å­—æ•°äº†ã€‚è€Œé€šè¿‡åŠ¨æ€è¯­è¨€è¾“å‡ºé™åˆ¶ç•¥æ˜¾éº»çƒ¦ï¼Œå€’ä¸å¦‚ç”¨csså±æ€§é™åˆ¶ï¼Œè¿™ä¸ªå±æ€§å«åštext-overflowï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œå…¼å®¹æ€§ä¸é”™ï¼ˆIE7+ï¼‰ã€‚&lt;style&nbsp;type=&quot;&quot;text/css&quot;&quot;&gt; .div1{ border:&nbsp;solid&nbsp;1px&nbsp;#000; width:180px; /*ä»¥ä¸‹éœ€è¦åŒæ—¶ä½¿ç”¨ï¼Œå¦åˆ™æ— æ•ˆ*/ overflow:&nbsp;hidden; text-overflow:&nbsp;ellipsis; white-space:&nbsp;nowrap; } &lt;/style&gt; &lt;div&gt;ä¿¡ç”¨CSSæ§åˆ¶æ–‡ç« æ ‡é¢˜å­—æ•°ç”¨CSSæ§åˆ¶æ–‡ç« æ ‡é¢˜å­—æ•°&lt;div&gt;&lt;div&nbsp;class=&quot;div1&quot;&gt;ç”¨CSSæ§åˆ¶æ–‡ç« æ ‡é¢˜å­—æ•°ç”¨CSSæ§åˆ¶æ–‡ç« æ ‡é¢˜å­—æ•°ç”¨CSSæ§åˆ¶æ–‡ç« æ ‡é¢˜å­—æ•°ç”¨CSSæ§åˆ¶æ–‡ç« æ ‡é¢˜å­—æ•°&lt;/div&gt;text-overflow:clipä¿®å‰ªæ–‡æœ¬ã€‚ellipsisæ˜¾ç¤ºçœç•¥ç¬¦å·æ¥ä»£è¡¨è¢«ä¿®å‰ªçš„æ–‡æœ¬ã€‚stringä½¿ç”¨ç»™å®šçš„å­—ç¬¦ä¸²æ¥ä»£è¡¨è¢«ä¿®å‰ªçš„æ–‡æœ¬ã€‚white-space:normalé»˜è®¤ã€‚ç©ºç™½ä¼šè¢«æµè§ˆå™¨å¿½ç•¥ã€‚preç©ºç™½ä¼šè¢«æµè§ˆå™¨ä¿ç•™ã€‚å…¶è¡Œä¸ºæ–¹å¼ç±»ä¼¼ HTML ä¸­çš„ &lt;pre&gt; æ ‡ç­¾ã€‚nowrapæ–‡æœ¬ä¸ä¼šæ¢è¡Œï¼Œæ–‡æœ¬ä¼šåœ¨åœ¨åŒä¸€è¡Œä¸Šç»§ç»­ï¼Œç›´åˆ°é‡åˆ° &lt;br&gt; æ ‡ç­¾ä¸ºæ­¢ã€‚pre-wrapä¿ç•™ç©ºç™½ç¬¦åºåˆ—ï¼Œä½†æ˜¯æ­£å¸¸åœ°è¿›è¡Œæ¢è¡Œã€‚pre-lineåˆå¹¶ç©ºç™½ç¬¦åºåˆ—ï¼Œä½†æ˜¯ä¿ç•™æ¢è¡Œç¬¦ã€‚inheritè§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ white-space å±æ€§çš„å€¼ã€‚æ³¨æ„ï¼Œtext-overflowåªé€‚ç”¨äºå•è¡Œä¸”å®½åº¦å›ºå®šæ—¶çš„å­—æ•°é™åˆ¶ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"å¸¸è§çš„HTTPçŠ¶æ€ç æŠ¥é”™åŠè§£å†³æ–¹æ³•","slug":"å¸¸è§çš„HTTPçŠ¶æ€ç æŠ¥é”™åŠè§£å†³æ–¹æ³•","date":"2016-03-14T15:16:06.000Z","updated":"2022-06-02T04:55:43.897Z","comments":true,"path":"2016/03/14/27/","link":"","permalink":"https://github.13sai.com/2016/03/14/27/","excerpt":"","text":"æ˜¨å¤©ï¼Œä¿®æ”¹äº†ç½‘ç«™ç¨‹åºï¼Œå¯¼è‡´ç½‘ç«™æ— æ³•åŠ è½½ï¼Œæç¤ºé”™è¯¯500ï¼Œä½†å…¶å­ç›®å½•å¯ä»¥æ‰“å¼€ï¼Œä»¥å‰ä»æœªé‡åˆ°è¿™ç§æƒ…å†µï¼Œæäº¤å·¥å•ç»™é˜¿é‡Œäº‘ï¼Œå›å¤ä¸»æœºæ— å¼‚å¸¸ã€‚æ™šä¸Šå›æ¥æŸ¥çœ‹ï¼Œæœç„¶æ˜¯æœ‰ç¨‹åºé—®é¢˜ï¼Œä¿®æ”¹åä¾¿èƒ½æ­£å¸¸æ‰“å¼€äº†ã€‚ æƒ³åˆ°å¹³å¸¸å¯èƒ½ä¼šé‡åˆ°HTTPæŠ¥é”™ï¼Œä¾¿æ¥æ•´ç†æ•´ç†å¸¸è§æŠ¥é”™ä¿¡æ¯ã€‚ 1ã€400é”™è¯¯è§£é‡Šï¼š è¯­ä¹‰æœ‰è¯¯ï¼Œå½“å‰è¯·æ±‚æ— æ³•è¢«æœåŠ¡å™¨ç†è§£ã€‚é™¤éè¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¸åº”è¯¥é‡å¤æäº¤è¿™ä¸ªè¯·æ±‚ã€‚ æˆ–è€…è¯·æ±‚å‚æ•°æœ‰è¯¯ã€‚ é—®é¢˜åŸå› ï¼šæ‚¨æ‰€è¦æ‰“å¼€çš„ç½‘é¡µä¸å­˜åœ¨æˆ–ä½ å¡«å†™çš„èº«ä»½éªŒè¯ä¿¡æ¯ä¸æ­£ç¡®ã€‚ è§£å†³æ–¹æ³•ï¼šé‡æ–°å°è¯•ï¼Œä¾ç„¶é”™è¯¯åæäº¤å·¥å•ã€‚ 2ã€401é”™è¯¯æœ€å¸¸è§çš„å‡ºé”™æç¤ºï¼š401 UNAUTHORIZEDé—®é¢˜åŸå› ï¼šæ‚¨è¯•å›¾è®¿é—®å—é™é¡µé¢ä½†æœªç»æˆæƒæ—¶ï¼Œç½‘ç«™è¿”å›HTTP 401é”™è¯¯ã€‚é”™è¯¯ç™»å½•å°è¯•æ˜¯å¯¼è‡´è¿™ä¸€é”™è¯¯çš„ä¸»å› ã€‚è§£å†³æ–¹æ³•ï¼šè”ç³»ç½‘ç«™ç®¡ç†å‘˜è·å¾—æ­£ç¡®çš„è´¦æˆ·ã€‚æäº¤å·¥å•è”ç³»æŠ€æœ¯äººå‘˜å¤„ç†ã€‚ 3ã€403é”™è¯¯æœ€å¸¸è§çš„å‡ºé”™æç¤ºï¼š403 FORBIDDEN è§£é‡Šï¼šæœåŠ¡å™¨å·²ç»ç†è§£è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œå®ƒã€‚ é—®é¢˜åŸå› ï¼šä¸€èˆ¬æ˜¯ç½‘ç«™æ²¡æœ‰ç»‘å®šé»˜è®¤é¦–é¡µæˆ–è€…ç»‘å®šé»˜è®¤é¦–é¡µé”™è¯¯ã€‚è§£å†³æ–¹æ³•ï¼šæ£€æŸ¥è‡ªå·±ç¨‹åºçš„é»˜è®¤é¦–é¡µã€‚ 4ã€404é”™è¯¯æœ€å¸¸è§çš„å‡ºé”™æç¤ºï¼š404 NOT FOUND è§£é‡Šï¼šè¯·æ±‚å¤±è´¥ï¼Œè¯·æ±‚æ‰€å¸Œæœ›å¾—åˆ°çš„èµ„æºæœªè¢«åœ¨æœåŠ¡å™¨ä¸Šå‘ç°ã€‚ é—®é¢˜åŸå› ï¼šæ‰“å¼€ç½‘ç«™æ—¶æ‰¾ä¸åˆ°ä½ æ‰€è¦æ±‚çš„æ–‡ä»¶(å³ç½‘é¡µ)ï¼Œè¯¥æ–‡ä»¶ä¸å­˜åœ¨ã€‚è§£å†³æ–¹æ¡ˆï¼š1ï¼‰è¯·æ‚¨ç™»é™†ftpæ£€æŸ¥æ–‡ä»¶æˆ–ç½‘é¡µæ˜¯å¦ä¸å­˜åœ¨ï¼ŒæŠŠç¼ºå°‘çš„ç½‘é¡µæ–‡ä»¶æ¢å¤ã€‚2ï¼‰æäº¤å·¥å•æ¢å¤æ•°æ®ã€‚ 5ã€500é”™è¯¯æœ€å¸¸è§çš„å‡ºé”™æç¤ºï¼š500 SERVER ERROR è§£é‡Šï¼šæœåŠ¡å™¨é‡åˆ°äº†ä¸€ä¸ªæœªæ›¾é¢„æ–™çš„çŠ¶å†µï¼Œå¯¼è‡´äº†å®ƒæ— æ³•å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚ é—®é¢˜åŸå› ï¼šæœåŠ¡å™¨ç«¯çš„ç½‘ç«™ç¨‹åºè®¾è®¡æœ‰é—®é¢˜å¹¶ä¸”æœåŠ¡å™¨æ²¡æœ‰æ‰“å¼€è¯¦ç»†é”™è¯¯æç¤ºã€‚è§£å†³æ–¹æ³•ï¼š1ï¼‰ä¸‹è½½ç¨‹åºåˆ°æœ¬åœ°ï¼Œç„¶åæ£€æŸ¥ç¨‹åºï¼Œä¸Šä¼ æ­£ç¡®ç½‘ç«™ç¨‹åºã€‚2ï¼‰æäº¤å·¥å•è”ç³»æŠ€æœ¯äººå‘˜å¤„ç†ã€‚ 6ã€503é”™è¯¯è§£é‡Šï¼š ç”±äºä¸´æ—¶çš„æœåŠ¡å™¨ç»´æŠ¤æˆ–è€…è¿‡è½½ï¼ŒæœåŠ¡å™¨å½“å‰æ— æ³•å¤„ç†è¯·æ±‚ã€‚è¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼Œå¹¶ä¸”å°†åœ¨ä¸€æ®µæ—¶é—´ä»¥åæ¢å¤ã€‚å¦‚æœèƒ½å¤Ÿé¢„è®¡å»¶è¿Ÿæ—¶é—´ï¼Œé‚£ä¹ˆå“åº”ä¸­å¯ä»¥åŒ…å«ä¸€ä¸ª Retry-After å¤´ç”¨ä»¥æ ‡æ˜è¿™ä¸ªå»¶è¿Ÿæ—¶é—´ã€‚å¦‚æœæ²¡æœ‰ç»™å‡ºè¿™ä¸ª Retry-After ä¿¡æ¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯åº”å½“ä»¥å¤„ç†500å“åº”çš„æ–¹å¼å¤„ç†å®ƒã€‚ æ³¨æ„ï¼š503çŠ¶æ€ç çš„å­˜åœ¨å¹¶ä¸æ„å‘³ç€æœåŠ¡å™¨åœ¨è¿‡è½½çš„æ—¶å€™å¿…é¡»ä½¿ç”¨å®ƒã€‚æŸäº›æœåŠ¡å™¨åªä¸è¿‡æ˜¯å¸Œæœ›æ‹’ç»å®¢æˆ·ç«¯çš„è¿æ¥ã€‚ é—®é¢˜åŸå› ï¼šç”±äºç¨‹åºç½‘ç«™ç¨‹åºé…ç½®ä¸å…¼å®¹ç­‰åŸå› é€ æˆåº”ç”¨ç¨‹åºæ± å…³é—­æˆ–è€…æ˜¯æµé‡ç”¨å®Œäº†ã€‚ è§£å†³æ–¹æ³•ï¼š1ï¼‰Linuxè™šæ‹Ÿä¸»æœºé€šè¿‡åå°é‡å¯ç«™ç‚¹å³å¯æ¢å¤æ­£å¸¸ã€‚å¦‚æœä¸è¡Œè¯·æäº¤å·¥å•ã€‚2ï¼‰widowsè™šæ‹Ÿä¸»æœºè¯·æäº¤å·¥å•è”ç³»æŠ€æœ¯äººå‘˜å¤„ç†ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/tags/web/"}]},{"title":"è¯´è¯´htmlç¼–è¾‘å™¨ä¸è°ƒè¯•å·¥å…·","slug":"è¯´è¯´htmlç¼–è¾‘å™¨ä¸è°ƒè¯•å·¥å…·","date":"2016-03-04T09:22:41.000Z","updated":"2022-03-19T14:35:21.947Z","comments":true,"path":"2016/03/04/26/","link":"","permalink":"https://github.13sai.com/2016/03/04/26/","excerpt":"","text":"ç¼–è¾‘å™¨å’Œè°ƒè¯•å·¥å…·æ˜¯å»ºç«™çš„ä¸¤å¤§åˆ©å™¨ï¼Œå¿…ç„¶ä¼šç”¨åˆ°ï¼Œä»Šå¤©æ¥ä»‹ç»ä¸‹è‡ªå·±ç”¨è¿‡çš„ã€å¸¸è§çš„ç¼–è¾‘å™¨ã€‚ä¸€ã€ç¼–è¾‘å™¨&nbsp;Dreamweaver ç¼–è¾‘Adobe Dreamweaverï¼Œç®€ç§°â€œDWâ€ï¼Œä¸­æ–‡åç§° &quot;æ¢¦æƒ³ç¼–ç»‡è€…&quot;ï¼Œæ˜¯ç¾å›½MACROMEDIAå…¬å¸å¼€å‘çš„é›†ç½‘é¡µåˆ¶ä½œå’Œç®¡ç†ç½‘ç«™äºä¸€èº«çš„æ‰€è§å³æ‰€å¾—ç½‘é¡µç¼–è¾‘å™¨ï¼ŒDWæ˜¯ç¬¬ä¸€å¥—é’ˆå¯¹ä¸“ä¸šç½‘é¡µè®¾è®¡å¸ˆç‰¹åˆ«å‘å±•çš„è§†è§‰åŒ–ç½‘é¡µå¼€å‘å·¥å…·ï¼Œåˆ©ç”¨å®ƒå¯ä»¥è½»è€Œæ˜“ä¸¾åœ°åˆ¶ä½œå‡ºè·¨è¶Šå¹³å°é™åˆ¶å’Œè·¨è¶Šæµè§ˆå™¨é™åˆ¶çš„å……æ»¡åŠ¨æ„Ÿçš„ç½‘é¡µã€‚è¿™æ˜¯è‡ªå·±ç”¨çš„ç¬¬ä¸€ç§ç¼–è¾‘å™¨ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œç¼–è¾‘ã€é¢„è§ˆã€è¾¹ç¼–è¾‘è¾¹é¢„è§ˆï¼Œè‡ªç”±å¼ºå¤§ï¼Œç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œè¿‡äºè£èª‰ï¼Œç•Œé¢ä¹Ÿlowã€‚notepad++Notepad++æ˜¯ä¸€æ¬¾å…è´¹ä½†ä¼˜ç§€çš„ä»£ç ç¼–è¾‘å™¨ï¼Œè¿è¡Œåœ¨Windowsç¯å¢ƒä¸‹ï¼Œå¯ä»¥æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ã€‚å®ƒåœ¨50å¤šç§ç¨‹åºã€è„šæœ¬å’Œæ ‡è®°è¯­è¨€ä¸Šéƒ½æœ‰ç€è¯­æ³•é«˜äº®ã€ä»£ç æŠ˜å ç­‰åŠŸèƒ½ã€‚ç•Œé¢æ¸…æ–°ç®€çº¦ï¼Œå¾ˆä¸é”™ï¼ŒåŠŸèƒ½å¯¹äºæ—¥å¸¸å¼€å‘ç»°ç»°æœ‰ä½™ã€‚ä¸è¿‡ä¸çŸ¥é“ä¸ºä½•è€æ˜¯ä¸­æ–‡ä¹±ç ï¼Œç„¶åä½“éªŒä¹Ÿå°±ä¸€èˆ¬èˆ¬ï¼Œå°±ç”¨å›äº†DWã€‚notepad++ä¸‹è½½evereditEverEditæ˜¯ä¸€ä¸ªå¿«é€Ÿã€è½»é‡çº§å’Œæ˜“äºæ‰©å±•çš„é›†æ–‡æœ¬ã€æºä»£ç ç¼–è¾‘äºä¸€èº«çš„é«˜æ€§èƒ½çº¯æ–‡æœ¬ç¼–è¾‘å™¨ã€‚å®ƒå¯ä»¥è¿è¡ŒäºWindows XPã€Windows Vistaã€Windows 7ã€Windows Server 2003+ç­‰ç»å¤§å¤šæ•°Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œå°å·§ç²¾è‡´çš„EverEditæ˜¯Windowsä¸Šé»˜è®¤çš„Notepadå¾ˆå¥½çš„æ›¿ä»£å“ã€‚è¿™æ˜¯è‡ªå·±å·¥ä½œåæ‰é‡åˆ°çš„ï¼Œä½†ç¡®å®å¾ˆå¥½ç”¨ï¼Œä½“ç§¯ä¹Ÿå¾ˆå°ï¼Œä¸ç”¨å®‰è£…å°±èƒ½ç”¨ã€‚evereditä¸‹è½½sublime textSublime Text æ˜¯ä¸€ä¸ªä»£ç ç¼–è¾‘å™¨ï¼ˆSublime Text 2æ˜¯æ”¶è´¹è½¯ä»¶ï¼Œä½†å¯ä»¥æ— é™æœŸè¯•ç”¨ï¼‰ï¼Œä¹Ÿæ˜¯HTMLå’Œæ•£æ–‡å…ˆè¿›çš„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚Sublime Textå…·æœ‰æ¼‚äº®çš„ç”¨æˆ·ç•Œé¢å’Œå¼ºå¤§çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ä»£ç ç¼©ç•¥å›¾ï¼ŒPythonçš„æ’ä»¶ï¼Œä»£ç æ®µç­‰ã€‚è¿˜å¯è‡ªå®šä¹‰é”®ç»‘å®šï¼Œèœå•å’Œå·¥å…·æ ã€‚Sublime Text çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼šæ‹¼å†™æ£€æŸ¥ï¼Œä¹¦ç­¾ï¼Œå®Œæ•´çš„ Python API ï¼Œ Goto åŠŸèƒ½ï¼Œå³æ—¶é¡¹ç›®åˆ‡æ¢ï¼Œå¤šé€‰æ‹©ï¼Œå¤šçª—å£ç­‰ç­‰ã€‚Sublime Text æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ç¼–è¾‘å™¨ï¼ŒåŒæ—¶æ”¯æŒWindowsã€Linuxã€Mac OS Xç­‰æ“ä½œç³»ç»Ÿã€‚è¿™ä¸ªæ²¡ç”¨è¿‡ï¼Œä½†çœ‹ç•Œé¢è¿˜è›®å¥½çœ‹çš„ï¼Œæ‹¥è¶¸ä¹Ÿä¸å°‘ï¼Œåº”è¯¥è¿˜ä¸é”™ã€‚äºŒã€è°ƒè¯•å·¥å…·1.firebugç«ç‹ç»å…¸çš„è°ƒè¯•å·¥å…·ï¼Œæ— éœ€å¤šè¨€ã€‚2.firefoxå¼€å‘è€…å·¥å…·ctrl+shift+Iæ‰“å¼€ï¼Œç°åœ¨ç”¨çš„æœ€å¤šçš„ï¼Œå¾ˆå¥½ç”¨ï¼ŒåŠŸèƒ½ä¹Ÿå¾ˆå¼ºå¤§ã€‚3.chromeå¼€å‘è€…å·¥å…·ctrl+shift+Iæ‰“å¼€ï¼Œä¹Ÿå¾ˆå¥½ç”¨ï¼Œè·Ÿç«ç‹å¼€å‘è€…å·¥å…·å¤§åŒå°å¼‚ï¼Œå›½å†…ä¼—å¤šæµè§ˆå™¨å¸¦çš„å°±æ˜¯chromeå¼€å‘è€…å·¥å…·ã€‚ç»“è¯­ï¼šç¼–è¾‘å™¨å¾ˆå¤šï¼Œè°ƒè¯•å·¥å…·ä¹Ÿå¾ˆå¤šï¼Œä¸éœ€è¦èŠ±å¤ªå¤šæ—¶é—´å»é€‰æ‹©ï¼Œç”¨ä¹ æƒ¯å°±è¡Œï¼Œç”¨ç€ç”¨ç€å°±å¾ˆé¡ºæ‰‹äº†ï¼Œä¹Ÿä¼šå‘ç°è¶Šæ¥è¶Šå¤šçš„æŠ€å·§ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"html","slug":"html","permalink":"https://github.13sai.com/tags/html/"}]},{"title":"phpç”Ÿæˆæ¡å½¢ç ","slug":"phpç”Ÿæˆæ¡å½¢ç ","date":"2016-03-02T12:12:38.000Z","updated":"2022-03-19T14:35:21.789Z","comments":true,"path":"2016/03/02/24/","link":"","permalink":"https://github.13sai.com/2016/03/02/24/","excerpt":"","text":"ä»Šå¤©åŒäº‹åšç½‘ç«™è¦ç”¨åˆ°ç”Ÿæˆæ¡å½¢ç ï¼Œè¿™æ˜¯æˆ‘ä¿©ä»¥å‰éƒ½æ²¡é‡åˆ°è¿‡çš„ï¼Œä¾¿ç™¾åº¦äº†ä¸‹ï¼Œå°è¯•äº†ä¸‹ã€‚ ç™¾åº¦ç™¾ç§‘å®šä¹‰ï¼šæ¡å½¢ç (barcode)æ˜¯å°†å®½åº¦ä¸ç­‰çš„å¤šä¸ªé»‘æ¡å’Œç©ºç™½ï¼ŒæŒ‰ç…§ä¸€å®šçš„ç¼–ç è§„åˆ™æ’åˆ—ï¼Œç”¨ä»¥è¡¨è¾¾ä¸€ç»„ä¿¡æ¯çš„å›¾å½¢æ ‡è¯†ç¬¦ã€‚å¸¸è§çš„æ¡å½¢ç æ˜¯ç”±åå°„ç‡ç›¸å·®å¾ˆå¤§çš„é»‘æ¡ï¼ˆç®€ç§°æ¡ï¼‰å’Œç™½æ¡ï¼ˆç®€ç§°ç©ºï¼‰æ’æˆå¹³è¡Œçº¿çš„å›¾æ¡ˆã€‚åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæ¡å½¢ç å¯ä»¥æ ‡å‡ºç‰©å“çš„ç”Ÿäº§å›½ã€åˆ¶é€ å‚å®¶ã€å•†å“åç§°ã€ç”Ÿäº§æ—¥æœŸã€å›¾ä¹¦åˆ†ç±»å·ã€é‚®ä»¶åœ°ç‚¹èµ·æ­¢ã€ç±»åˆ«ã€æ—¥æœŸç­‰è®¸å¤šä¿¡æ¯ã€‚ é¦–å…ˆå»barcodebakeryå®˜ç½‘ä¸‹è½½ï¼Œæ³¨æ„ç‰ˆæœ¬ï¼Œæ˜¯å¦ä¸ä½ ç”¨phpç‰ˆæœ¬çš„åŒ¹é…ã€‚ æ¥ä¸‹æ¥å°±ç®€å•äº†ï¼Œè§£å‹æ”¾åˆ°ä½ çš„ç›®å½•ï¼Œè¾“å…¥åœ°å€å°±èƒ½çœ‹åˆ°å±•ç¤ºé¡µã€‚ è¿™é¡µå¾ˆä¸“ä¸šæœ‰æœ¨æœ‰ï¼Œè€Œä¸”ä¹Ÿå¤ªç¹æ‚äº†ï¼Œsoï¼Œå¦‚æœåªæ˜¯ç”Ÿæˆæ¡å½¢ç å›¾ç‰‡å±•ç¤ºå‡ºæ¥ï¼Œé€‰æ‹©test.phpå§ã€‚ test.phpæ˜¯å¦ä¸€ä¸ªç®€å•ç¤ºä¾‹ï¼Œæ³¨æ„ä¸¤å¤„ï¼ŒBCGcode39æŒ‡çš„æ˜¯æ¡å½¢ç ç±»å‹ï¼Œæ˜¯å¯æ¢çš„ï¼Œæ¯”å¦‚æ¢æˆBCGcode128ï¼Œç»“åˆä½ çš„éœ€è¦ä¿®æ”¹å³å¯ã€‚ $code-&gt;parse(â€˜HELLOâ€™); è¿™å°±è¡¨æ˜æ˜¯ç”ŸæˆHELLOçš„æ¡å½¢ç ï¼ŒHELLOå¯æ¢ï¼Œå¸¸é‡ã€å˜é‡éƒ½å¯ä»¥ã€‚ å°±è¿™äº›äº†ï¼Œå…¶å®å¾ˆç®€å•ï¼Œå…¶å®å¹¶ä¸éš¾ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"}]},{"title":"ThinkPHPä¹‹whereæ–¹æ³•","slug":"ThinkPHPä¹‹whereæ–¹æ³•","date":"2016-03-02T05:25:58.000Z","updated":"2022-03-19T14:35:21.646Z","comments":true,"path":"2016/03/02/25/","link":"","permalink":"https://github.13sai.com/2016/03/02/25/","excerpt":"","text":"ThinkPHP where()æ–¹æ³•æ˜¯ Model ç±»å†…ç½®æ–¹æ³•ï¼Œç”¨äºè®¾ç½®æ•°æ®åº“æŸ¥è¯¢æˆ–è€…æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œæ¡ä»¶ï¼Œæ˜¯ThinkPHPç²¾é«“éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯å¿…é¡»æŒæ¡çš„ç‚¹ã€‚ä¸‹é¢ä»¥æŸ¥è¯¢ä¸ºä¾‹ï¼Œäº†è§£ä¸‹å¼ºå¤§çš„whereæ–¹æ³•ã€‚ ThinkPHPæ”¯æŒç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼Œä½†å®‰å…¨æ€§ä¸é«˜ï¼Œä¹Ÿå¯ä»¥ç”¨å¯¹è±¡æ¥ä½œä¸ºæ¡ä»¶æŸ¥è¯¢ï¼Œæ•ˆç‡ä¸é«˜ï¼Œæ‰€ä»¥å¤§å¤šæ•°æƒ…å†µæ¨èä½¿ç”¨æ•°ç»„æ¥ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼Œå› ä¸ºä¼šæ›´åŠ å®‰å…¨ï¼Œæ›´é«˜æ•ˆã€‚ä¸€ã€ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ä¾‹å¦‚ï¼š$User&nbsp;=&nbsp;M(&quot;User&quot;);&nbsp;//&nbsp;å®ä¾‹åŒ–Userå¯¹è±¡,userä¸ºè¡¨å$User-&gt;where(&#39;id&lt;10&nbsp;AND&nbsp;status=1&#39;)-&gt;select();æœ€åç”Ÿæˆçš„SQLè¯­å¥æ˜¯ï¼ˆè¡¨å‰ç¼€ä¸ºthink_ï¼‰SELECT&nbsp;*&nbsp;FROM&nbsp;think_user&nbsp;WHERE&nbsp;id&lt;1&nbsp;AND&nbsp;status=1äºŒã€ä½¿ç”¨æ•°ç»„ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼ˆæ¨èï¼‰è¿™ç§æ–¹å¼æ˜¯æœ€å¸¸ç”¨çš„æŸ¥è¯¢æ–¹å¼ï¼Œä¾‹å¦‚ï¼š$User&nbsp;=&nbsp;M(&quot;User&quot;);&nbsp;//&nbsp;å®ä¾‹åŒ–Userå¯¹è±¡$condition[&#39;id&#39;]&nbsp;=&nbsp;array(&#39;lt&#39;,1);//ltå¯æ¢æˆé™„è¡¨ä¸­å…¶ä»–TPè¿ç®—ç¬¦$condition[&#39;status&#39;]&nbsp;=&nbsp;1;//&nbsp;æŠŠæŸ¥è¯¢æ¡ä»¶ä¼ å…¥æŸ¥è¯¢æ–¹æ³•$User-&gt;where($condition)-&gt;select();æœ€åç”Ÿæˆçš„SQLè¯­å¥åŒä¸Šã€‚å¦‚æœè¿›è¡Œå¤šå­—æ®µæŸ¥è¯¢ï¼Œé‚£ä¹ˆå­—æ®µä¹‹é—´çš„é»˜è®¤é€»è¾‘å…³ç³»æ˜¯ANDï¼Œå¦‚æœé€»è¾‘å…³ç³»æ˜¯ORï¼Œé€šè¿‡ä½¿ç”¨ _logic å®šä¹‰æŸ¥è¯¢é€»è¾‘ï¼š$User&nbsp;=&nbsp;M(&quot;User&quot;);&nbsp;$condition[&#39;id&#39;]&nbsp;=&nbsp;array(&#39;lt&#39;,1);$condition[&#39;status&#39;]&nbsp;=&nbsp;1;$condition[&#39;_logic&#39;]&nbsp;=&nbsp;&#39;OR&#39;;//&nbsp;æŠŠæŸ¥è¯¢æ¡ä»¶ä¼ å…¥æŸ¥è¯¢æ–¹æ³•$User-&gt;where($condition)-&gt;select();æœ€åç”Ÿæˆçš„SQLè¯­å¥æ˜¯SELECT&nbsp;*&nbsp;FROM&nbsp;think_user&nbsp;WHERE&nbsp;`id&lt;1&nbsp;OR&nbsp;`status`=1ä¸‰ã€ä½¿ç”¨å¯¹è±¡æ–¹å¼æ¥æŸ¥è¯¢ï¼ˆä¸æ¨èï¼‰è¿™é‡Œä»¥stdClasså†…ç½®å¯¹è±¡ä¸ºä¾‹ï¼š$User&nbsp;=&nbsp;M(&quot;User&quot;);&nbsp;//&nbsp;å®šä¹‰æŸ¥è¯¢æ¡ä»¶$condition&nbsp;=&nbsp;new&nbsp;stdClass();&nbsp;$condition-&gt;id=&nbsp;array(&#39;lt&#39;,1);&nbsp;$condition-&gt;status=&nbsp;1;&nbsp;$User-&gt;where($condition)-&gt;select();æœ€åç”Ÿæˆçš„SQLè¯­å¥å’Œä¸Šé¢ä¸€æ ·ã€‚é™„ï¼šThinkPHPè¿ç®—ç¬¦ ä¸ SQLè¿ç®—ç¬¦ å¯¹ç…§è¡¨TPè¿ç®—ç¬¦SQLè¿ç®—ç¬¦ä¾‹å­å®é™…æŸ¥è¯¢æ¡ä»¶eq=$map[&#39;id&#39;] = array(&#39;eq&#39;,100);$map[&#39;id&#39;] = 100;neq!=$map[&#39;id&#39;] = array(&#39;neq&#39;,100);id != 100gt&gt;$map[&#39;id&#39;] = array(&#39;gt&#39;,100);id &gt; 100elt&lt;=$map[&#39;id&#39;] = array(&#39;elt&#39;,100);id &lt;= 100likelike$map[&#39;username&#39;] = array(&#39;like&#39;,&#39;Admin%&#39;);username like &#39;Admin%&#39;betweenbetween and$map[&#39;id&#39;] = array(&#39;between&#39;,&#39;1,8&#39;);id BETWEEN 1 AND 8not innot in$map[&#39;id&#39;] = array(&#39;not in&#39;,&#39;1,5,8&#39;);id not in(1,5,8)andï¼ˆé»˜è®¤ï¼‰and$map[&#39;id&#39;] = array(array(&#39;gt&#39;,1),array(&#39;lt&#39;,10));(id &gt; 1) AND (id &lt; 10)oror$map[&#39;id&#39;] = array(array(&#39;gt&#39;,3),array(&#39;lt&#39;,10), &#39;or&#39;);(id &gt; 3) OR (id &lt; 10)xorï¼ˆå¼‚æˆ–ï¼‰xorä¸¤ä¸ªè¾“å…¥ä¸­åªæœ‰ä¸€ä¸ªæ˜¯trueæ—¶ï¼Œç»“æœä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseï¼Œä¾‹å­ç•¥ã€‚1 xor 1 = 0expç»¼åˆè¡¨è¾¾å¼$map[&#39;id&#39;] = array(&#39;exp&#39;,&#39;in(1,3,8)&#39;);$map[&#39;id&#39;] = array(&#39;in&#39;,&#39;1,3,8&#39;);","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"è®©ie7å…¼å®¹cssåœ†è§’ã€é˜´å½±","slug":"è®©ie7å…¼å®¹cssåœ†è§’ã€é˜´å½±","date":"2016-02-16T11:44:31.000Z","updated":"2022-03-19T14:35:21.943Z","comments":true,"path":"2016/02/16/19/","link":"","permalink":"https://github.13sai.com/2016/02/16/19/","excerpt":"","text":"é¦–å…ˆä¸‹è½½ie-css3.htcè„šæœ¬ï¼Œç„¶ååœ¨cssä¸­åŠ å…¥ä»£ç : ä¾‹å¦‚ .div { border-radius: 15px; box-shadow: 10px 10px 20px #000; behavior: url(ie-css3.htc); } æ³¨æ„ï¼šbehavior: url(ie-css3.htc) ä¸­çš„ie-css3.htcåœ°å€å¿…é¡»ç”¨ç»å¯¹è·¯å¾„æˆ–è€…ç›´æ¥ä¼ åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹é¢ã€‚ IE-CSS3.HTCä¸‹è½½åœ°å€ï¼š å‰å¾€å®˜ç½‘ é™„ï¼š â€¢å½“ä½ ä½¿ç”¨äº†è¿™ä¸ªhtcæ–‡ä»¶åï¼Œä½ çš„CSSé‡Œé¢ï¼Œåªè¦å†™æœ‰box-shadow, -moz-box-shadowæˆ–-webkit-box-shadowçš„ä»»ä½•ä¸€ç§ï¼ŒIEå°±ä¼šæ¸²æŸ“ã€‚ â€¢å½“ä½¿ç”¨äº†è¿™ä¸ªhtcæ–‡ä»¶åï¼Œä½ ä¸èƒ½è¿™æ ·å†™box-shadow: 0 0 10px red; è€Œåº”è¯¥æ˜¯box-shadow: 0px 0px 10px red; å¦åˆ™IEä¸­ä¼šå¤±æ•ˆã€‚ â€¢ä¸æ”¯æŒRGBAå€¼ä¸­çš„alphaé€æ˜åº¦ï¼Œä¸æ”¯æŒinsetå†…é˜´å½±ã€‚ â€¢é˜´å½±åœ¨IEä¸­åªä¼šæ˜¾ç¤ºä¸ºé»‘è‰²ï¼Œä¸ç®¡ä½ è®¾ç½®æˆå…¶å®ƒä»€ä¹ˆé¢œè‰²ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"thinkphpå®‰è£…é…ç½®","slug":"thinkphpå®‰è£…é…ç½®","date":"2016-02-02T12:26:01.000Z","updated":"2022-03-19T14:35:21.809Z","comments":true,"path":"2016/02/02/18/","link":"","permalink":"https://github.13sai.com/2016/02/02/18/","excerpt":"","text":"ThinkPHPæ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€å•çš„åŸºäºMVCå’Œé¢å‘å¯¹è±¡çš„è½»é‡çº§PHPå¼€å‘æ¡†æ¶ï¼Œéµå¾ªApache2å¼€æºåè®®å‘å¸ƒï¼Œä»è¯ç”Ÿä»¥æ¥ä¸€ç›´ç§‰æ‰¿ç®€æ´å®ç”¨çš„è®¾è®¡åŸåˆ™ï¼Œåœ¨ä¿æŒå‡ºè‰²çš„æ€§èƒ½å’Œè‡³ç®€çš„ä»£ç çš„åŒæ—¶ï¼Œå°¤å…¶æ³¨é‡å¼€å‘ä½“éªŒå’Œæ˜“ç”¨æ€§ï¼Œå¹¶ä¸”æ‹¥æœ‰ä¼—å¤šçš„åŸåˆ›åŠŸèƒ½å’Œç‰¹æ€§ï¼Œä¸ºWEBåº”ç”¨å¼€å‘æä¾›äº†å¼ºæœ‰åŠ›çš„æ”¯æŒã€‚ ä¸‹è½½å®‰è£…ï¼š ThinkPHPæœ€æ–°ç‰ˆæœ¬å¯ä»¥åœ¨å®˜æ–¹ç½‘ç«™æˆ–è€…Githubä¸‹è½½ã€‚ ç„¶åæŠŠä¸‹è½½çš„å‹ç¼©åŒ…è§£å‹åˆ°webç›®å½•ä¸‹ï¼Œè¿è¡Œæµè§ˆå™¨è¾“å…¥å¯¹åº”ç½‘å€ï¼Œçœ‹åˆ°tpçš„ç¬‘è„¸å°±è¡¨ç¤ºå®‰è£…æˆåŠŸäº†ã€‚ å®‰è£…åŸºæœ¬æ— å‹åŠ›ã€‚ é…ç½®ï¼šï¼ˆæˆ‘ç”¨çš„æ˜¯3.2ç‰ˆæœ¬ï¼‰ ä¿®æ”¹æ ¹ç›®å½•ä¸‹å…¥å£æ–‡ä»¶index.phpï¼Œå®šä¹‰åº”ç”¨ç›®å½•ï¼Œéƒ½æœ‰æ³¨é‡Šï¼Œç®€å•æ˜äº†ï¼Œç„¶åæµè§ˆå™¨åˆ·æ–°ï¼Œå°±è‡ªåŠ¨ç”Ÿæˆäº†ä½ çš„appç›®å½•ã€‚ å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸æ”¹ï¼Œç›´æ¥ç”¨è‡ªåŠ¨ç”Ÿæˆçš„Applicationå¼€å‘ã€‚ ç„¶åå¼€å§‹é…ç½®ï¼Œå»appç›®å½•ä¸‹Application\\Common\\Conf","categories":[{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"}],"tags":[{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"}]},{"title":"æ•°æ®åº“è®¾è®¡èŒƒå¼","slug":"æ•°æ®åº“è®¾è®¡èŒƒå¼","date":"2016-02-01T14:16:06.000Z","updated":"2022-03-19T14:35:21.924Z","comments":true,"path":"2016/02/01/17/","link":"","permalink":"https://github.13sai.com/2016/02/01/17/","excerpt":"","text":"ä¸ºäº†å»ºç«‹å†—ä½™è¾ƒå°ã€ç»“æ„åˆç†çš„æ•°æ®åº“ï¼Œè®¾è®¡æ•°æ®åº“æ—¶å¸¸å¸¸éµå¾ªä¸€å®šçš„è§„åˆ™ã€‚åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­è¿™ç§è§„åˆ™å°±ç§°ä¸ºèŒƒå¼ã€‚èŒƒå¼æ˜¯ç¬¦åˆæŸä¸€ç§è®¾è®¡è¦æ±‚çš„æ€»ç»“ã€‚è¦æƒ³è®¾è®¡ä¸€ä¸ªç»“æ„åˆç†çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå¸¸å¸¸éœ€è¦æ»¡è¶³ä¸€å®šçš„èŒƒå¼ã€‚ åœ¨å®é™…å¼€å‘ä¸­æœ€ä¸ºå¸¸è§çš„è®¾è®¡èŒƒå¼æœ‰ä¸‰ä¸ªï¼š 1ï¼ç¬¬ä¸€èŒƒå¼(ç¡®ä¿æ¯åˆ—ä¿æŒåŸå­æ€§) ç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœæ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼ã€‚ ç¬¬ä¸€èŒƒå¼çš„åˆç†éµå¾ªéœ€è¦æ ¹æ®ç³»ç»Ÿçš„å®é™…éœ€æ±‚æ¥å®šã€‚æ¯”å¦‚æŸäº›æ•°æ®åº“ç³»ç»Ÿä¸­éœ€è¦ç”¨åˆ°â€œåœ°å€â€è¿™ä¸ªå±æ€§ï¼Œæœ¬æ¥ç›´æ¥å°†â€œåœ°å€â€å±æ€§è®¾è®¡æˆä¸€ä¸ªæ•°æ®åº“è¡¨çš„å­—æ®µå°±è¡Œã€‚ä½†æ˜¯å¦‚æœç³»ç»Ÿç»å¸¸ä¼šè®¿é—®â€œåœ°å€â€å±æ€§ä¸­çš„â€œåŸå¸‚â€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±éè¦å°†â€œåœ°å€â€è¿™ä¸ªå±æ€§é‡æ–°æ‹†åˆ†ä¸ºçœä»½ã€åŸå¸‚ã€è¯¦ç»†åœ°å€ç­‰å¤šä¸ªéƒ¨åˆ†è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ ·åœ¨å¯¹åœ°å€ä¸­æŸä¸€éƒ¨åˆ†æ“ä½œçš„æ—¶å€™å°†éå¸¸æ–¹ä¾¿ï¼ŒåŒæ—¶ä¹Ÿæé«˜äº†æ•°æ®åº“çš„æ€§èƒ½ã€‚ 2ï¼ç¬¬äºŒèŒƒå¼(ç¡®ä¿è¡¨ä¸­çš„æ¯åˆ—éƒ½å’Œä¸»é”®ç›¸å…³) ç¬¬äºŒèŒƒå¼åœ¨ç¬¬ä¸€èŒƒå¼çš„åŸºç¡€ä¹‹ä¸Šæ›´è¿›ä¸€å±‚ã€‚ç¬¬äºŒèŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å’Œä¸»é”®ç›¸å…³ï¼Œè€Œä¸èƒ½åªä¸ä¸»é”®çš„æŸä¸€éƒ¨åˆ†ç›¸å…³ï¼ˆä¸»è¦é’ˆå¯¹è”åˆä¸»é”®è€Œè¨€ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚ æ¯”å¦‚è¦è®¾è®¡ä¸€ä¸ªè®¢å•ä¿¡æ¯è¡¨ï¼Œå› ä¸ºè®¢å•ä¸­å¯èƒ½ä¼šæœ‰å¤šç§å•†å“ï¼Œæ‰€ä»¥è¦å°†è®¢å•ç¼–å·å’Œå•†å“ç¼–å·ä½œä¸ºæ•°æ®åº“è¡¨çš„è”åˆä¸»é”®ã€‚ è¿™æ ·å°±äº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼šè¡¨ä¸­æ˜¯ä»¥è®¢å•ç¼–å·å’Œå•†å“ç¼–å·ä½œä¸ºè”åˆä¸»é”®ã€‚è¿™æ ·åœ¨è¯¥è¡¨ä¸­å•†å“åç§°ã€å•ä½ã€å•†å“ä»·æ ¼ç­‰ä¿¡æ¯ä¸ä¸è¯¥è¡¨çš„ä¸»é”®ç›¸å…³ï¼Œè€Œä»…ä»…æ˜¯ä¸å•†å“ç¼–å·ç›¸å…³ã€‚æ‰€ä»¥åœ¨è¿™é‡Œè¿åäº†ç¬¬äºŒèŒƒå¼çš„è®¾è®¡åŸåˆ™ã€‚ è€Œå¦‚æœæŠŠè¿™ä¸ªè®¢å•ä¿¡æ¯è¡¨è¿›è¡Œæ‹†åˆ†ï¼ŒæŠŠå•†å“ä¿¡æ¯åˆ†ç¦»åˆ°å¦ä¸€ä¸ªè¡¨ä¸­ï¼ŒæŠŠè®¢å•é¡¹ç›®è¡¨ä¹Ÿåˆ†ç¦»åˆ°å¦ä¸€ä¸ªè¡¨ä¸­ï¼Œå°±éå¸¸å®Œç¾äº†ã€‚ è¿™æ ·è®¾è®¡ï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°äº†æ•°æ®åº“çš„å†—ä½™ã€‚å¦‚æœè¦è·å–è®¢å•çš„å•†å“ä¿¡æ¯ï¼Œä½¿ç”¨å•†å“ç¼–å·åˆ°å•†å“ä¿¡æ¯è¡¨ä¸­æŸ¥è¯¢å³å¯ã€‚ 3ï¼ç¬¬ä¸‰èŒƒå¼(ç¡®ä¿æ¯åˆ—éƒ½å’Œä¸»é”®åˆ—ç›´æ¥ç›¸å…³,è€Œä¸æ˜¯é—´æ¥ç›¸å…³) ç¬¬ä¸‰èŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®è¡¨ä¸­çš„æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³ã€‚ æ¯”å¦‚åœ¨è®¾è®¡ä¸€ä¸ªè®¢å•æ•°æ®è¡¨çš„æ—¶å€™ï¼Œå¯ä»¥å°†å®¢æˆ·ç¼–å·ä½œä¸ºä¸€ä¸ªå¤–é”®å’Œè®¢å•è¡¨å»ºç«‹ç›¸åº”çš„å…³ç³»ã€‚è€Œä¸å¯ä»¥åœ¨è®¢å•è¡¨ä¸­æ·»åŠ å…³äºå®¢æˆ·å…¶å®ƒä¿¡æ¯ï¼ˆæ¯”å¦‚å§“åã€æ‰€å±å…¬å¸ç­‰ï¼‰çš„å­—æ®µã€‚å¦‚ä¸‹é¢è¿™ä¸¤ä¸ªè¡¨æ‰€ç¤ºçš„è®¾è®¡å°±æ˜¯ä¸€ä¸ªæ»¡è¶³ç¬¬ä¸‰èŒƒå¼çš„æ•°æ®åº“è¡¨ã€‚ è¿™æ ·åœ¨æŸ¥è¯¢è®¢å•ä¿¡æ¯çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨å®¢æˆ·ç¼–å·æ¥å¼•ç”¨å®¢æˆ·ä¿¡æ¯è¡¨ä¸­çš„è®°å½•ï¼Œä¹Ÿä¸å¿…åœ¨è®¢å•ä¿¡æ¯è¡¨ä¸­å¤šæ¬¡è¾“å…¥å®¢æˆ·ä¿¡æ¯çš„å†…å®¹ï¼Œå‡å°äº†æ•°æ®å†—ä½™ã€‚ å½“ç„¶ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸å¿…è‹›åˆ»åœ°å»æ»¡è¶³è¿™äº›èŒƒå¼ï¼Œå…·ä½“æƒ…å†µå…·ä½“å¯¹å¾…ï¼Œæœªå¿…å°±å¼ºè¿«æ•°æ®éµå¾ªèŒƒå¼ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒèŒƒå¼ï¼Œç»“åˆéœ€æ±‚æ¥è®¾è®¡æ•°æ®åº“ï¼Œå­¦ä¼šâ€œæ¨é™ˆå‡ºæ–°â€ï¼","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"sql","slug":"sql","permalink":"https://github.13sai.com/tags/sql/"}]},{"title":"è¯´è¯´csshack","slug":"è¯´è¯´csshack","date":"2016-01-20T14:31:22.000Z","updated":"2022-03-19T14:35:21.946Z","comments":true,"path":"2016/01/20/16/","link":"","permalink":"https://github.13sai.com/2016/01/20/16/","excerpt":"","text":"ä¸€ã€ä»€ä¹ˆæ˜¯CSS Hack ä¸åŒçš„æµè§ˆå™¨å¯¹CSSçš„è§£æç»“æœæ˜¯ä¸åŒçš„ï¼Œå› æ­¤ä¼šå¯¼è‡´ç›¸åŒçš„CSSè¾“å‡ºçš„é¡µé¢æ•ˆæœä¸åŒï¼Œè¿™å°±éœ€è¦CSS Hackæ¥è§£å†³æµè§ˆå™¨å±€éƒ¨çš„å…¼å®¹æ€§é—®é¢˜ã€‚è€Œè¿™ä¸ªé’ˆå¯¹ä¸åŒçš„æµè§ˆå™¨å†™ä¸åŒçš„CSS ä»£ç çš„è¿‡ç¨‹ï¼Œå°±å«CSS Hackã€‚ CSS Hackå¸¸è§çš„æœ‰ä¸‰ç§å½¢å¼ï¼šCSSå±æ€§Hackã€CSSé€‰æ‹©ç¬¦Hackä»¥åŠIEæ¡ä»¶æ³¨é‡ŠHackï¼Œ Hackä¸»è¦é’ˆå¯¹IEæµè§ˆå™¨ã€‚ 1ã€å±æ€§çº§Hackï¼šæ¯”å¦‚IE6èƒ½è¯†åˆ«ä¸‹åˆ’çº¿â€_â€å’Œæ˜Ÿå·â€ * â€œï¼ŒIE7èƒ½è¯†åˆ«æ˜Ÿå·â€ * â€œï¼Œä½†ä¸èƒ½è¯†åˆ«ä¸‹åˆ’çº¿â€_â€ï¼Œè€Œfirefoxä¸¤ä¸ªéƒ½ä¸èƒ½è®¤è¯†ã€‚ 2ã€é€‰æ‹©ç¬¦çº§Hackï¼šæ¯”å¦‚IE6èƒ½è¯†åˆ«*html .class{}ï¼ŒIE7èƒ½è¯†åˆ«*+html .class{}æˆ–è€…*:first-child+html .class{}ã€‚ 3ã€IEæ¡ä»¶æ³¨é‡ŠHackï¼šIEæ¡ä»¶æ³¨é‡Šæ˜¯å¾®è½¯ä»IE5å¼€å§‹å°±æä¾›çš„ä¸€ç§éæ ‡å‡†é€»è¾‘è¯­å¥ã€‚æ¯”å¦‚é’ˆå¯¹æ‰€æœ‰IEï¼š&lt;!â€“[if IE]&gt;&lt;!â€“æ‚¨çš„ä»£ç â€“&gt;&lt;![endif]â€“&gt;ï¼Œé’ˆå¯¹IE6åŠä»¥ä¸‹ç‰ˆæœ¬ï¼š&lt;!â€“[if lt IE 7]&gt;&lt;!â€“æ‚¨çš„ä»£ç â€“&gt;&lt;![endif]â€“&gt;ï¼Œè¿™ç±»Hackä¸ä»…å¯¹CSSç”Ÿæ•ˆï¼Œå¯¹å†™åœ¨åˆ¤æ–­è¯­å¥é‡Œé¢çš„æ‰€æœ‰ä»£ç éƒ½ ä¼šç”Ÿæ•ˆã€‚ PSï¼šæ¡ä»¶æ³¨é‡Šåªæœ‰åœ¨IEæµè§ˆå™¨ä¸‹æ‰èƒ½æ‰§è¡Œï¼Œè¿™ä¸ªä»£ç åœ¨éIEæµè§ˆä¸‹è¢«å½“åšæ³¨é‡Šè§†è€Œä¸è§ã€‚å¯ä»¥é€šè¿‡IEæ¡ä»¶æ³¨é‡Šè½½å…¥ä¸åŒçš„CSSã€JSã€HTMLå’ŒæœåŠ¡å™¨ä»£ç ç­‰ã€‚ äºŒã€å¸¸ç”¨çš„CSS Hack ä»£ç å¦‚ä¸‹: /* CSSå±æ€§çº§Hack */ color:red; /* æ‰€æœ‰æµè§ˆå™¨å¯è¯†åˆ«*/ _color:red; /* ä»…IE6 è¯†åˆ« */ *color:red; +color:red;&nbsp;*+color:red;[color:red;&nbsp;&nbsp;/* IE6ã€IE7 è¯†åˆ« */ color:red9; /* IE6ã€IE7ã€IE8ã€IE9 è¯†åˆ« */ color:red9; /* ä»…IE9è¯†åˆ« */ color:red!important; /* IE6 ä¸è¯†åˆ«!important*/ ------------------------------------------------------------- /* CSSé€‰æ‹©ç¬¦çº§Hack */ *html #demo { color:red;} /* ä»…IE6 è¯†åˆ« */ *+html #demo { color:red;} /* ä»…IE7 è¯†åˆ« */ body:nth-of-type(1) #demo { color:red;} /* IE9+ã€FF3.5+ã€Chromeã€Safariã€Opera å¯ä»¥è¯†åˆ« */ head:first-child+body #demo { color:red; } /* IE7+ã€FFã€Chromeã€Safariã€Opera å¯ä»¥è¯†åˆ« */ :root #demo { color:red9; } : /* ä»…IE9è¯†åˆ« */ -------------------------------------------------------------- /* IEæ¡ä»¶æ³¨é‡ŠHack */ &lt;!--[if IE]&gt;æ­¤å¤„å†…å®¹åªæœ‰IEå¯è§&lt;![endif]--&gt;&nbsp; &lt;!--[if IE 6]&gt;æ­¤å¤„å†…å®¹åªæœ‰IE6.0å¯è§&lt;![endif]--&gt;&nbsp; &lt;!--[if IE 7]&gt;æ­¤å¤„å†…å®¹åªæœ‰IE7.0å¯è§&lt;![endif]--&gt;&nbsp; &lt;!--[if !IE 7]&gt;æ­¤å¤„å†…å®¹åªæœ‰IE7ä¸èƒ½è¯†åˆ«ï¼Œå…¶ä»–ç‰ˆæœ¬éƒ½èƒ½è¯†åˆ«ï¼Œå½“ç„¶è¦åœ¨IE5ä»¥ä¸Šã€‚&lt;![endif]--&gt; &lt;!--[if gt IE 6]&gt; IE6ä»¥ä¸Šç‰ˆæœ¬å¯è¯†åˆ«,IE6æ— æ³•è¯†åˆ« &lt;![endif]--&gt; &lt;!--[if gte IE 7]&gt; IE7ä»¥åŠIE7ä»¥ä¸Šç‰ˆæœ¬å¯è¯†åˆ« &lt;![endif]--&gt; &lt;!--[if lt IE 7]&gt; ä½äºIE7çš„ç‰ˆæœ¬æ‰èƒ½è¯†åˆ«ï¼ŒIE7æ— æ³•è¯†åˆ«ã€‚ &lt;![endif]--&gt; &lt;!--[if lte IE 7]&gt; IE7ä»¥åŠIE7ä»¥ä¸‹ç‰ˆæœ¬å¯è¯†åˆ«&lt;![endif]--&gt; &lt;!--[if !IE]&gt;æ­¤å¤„å†…å®¹åªæœ‰éIEå¯è§&lt;![endif]--&gt; CSS hackåˆ©å¼Š ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°½é‡é¿å…ä½¿ç”¨CSS hackï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µä¸ºäº†é¡¾åŠç”¨æˆ·ä½“éªŒå®ç°å‘ä¸‹å…¼å®¹ï¼Œä¸å¾—å·²æ‰ä½¿ç”¨hackã€‚æ¯”å¦‚ç”±äºIE8åŠä»¥ä¸‹ç‰ˆæœ¬ä¸æ”¯æŒCSS3,è€Œæˆ‘ä»¬çš„é¡¹ç›®é¡µé¢ä½¿ç”¨äº†å¤§é‡CSS3æ–°å±æ€§åœ¨IE9/Firefox/Chromeä¸‹æ­£å¸¸æ¸²æŸ“ï¼Œè¿™ç§æƒ…å†µä¸‹å¦‚æœä¸ä½¿ç”¨css3pieæˆ–htcæˆ–æ¡ä»¶æ³¨é‡Šç­‰æ–¹æ³•æ—¶,å¯èƒ½å°±å¾—è®©IE8-çš„ä¸“å±hackå‡ºé©¬äº†ã€‚ä½¿ç”¨hackè™½ç„¶å¯¹é¡µé¢è¡¨ç°çš„ä¸€è‡´æ€§æœ‰å¥½å¤„ï¼Œä½†è¿‡å¤šçš„æ»¥ç”¨ä¼šé€ æˆhtmlæ–‡æ¡£æ··ä¹±ä¸å ªï¼Œå¢åŠ ç®¡ç†å’Œç»´æŠ¤çš„è´Ÿæ‹…ã€‚ PS: è¯´åˆ°hackå°±æƒ³åˆ°ä¸¤ä¸ªè¯ï¼Œæ¸è¿›å¢å¼ºä¸ä¼˜é›…é™çº§ã€‚ æ¸è¿›å¢å¼º progressive enhancementï¼šé’ˆå¯¹ä½ç‰ˆæœ¬æµè§ˆå™¨è¿›è¡Œæ„å»ºé¡µé¢ï¼Œä¿è¯æœ€åŸºæœ¬çš„åŠŸèƒ½ï¼Œæ›´å…³æ³¨äºå†…å®¹ï¼Œç„¶åå†é’ˆå¯¹é«˜çº§æµè§ˆå™¨è¿›è¡Œæ•ˆæœã€äº¤äº’ç­‰æ”¹è¿›å’Œè¿½åŠ åŠŸèƒ½è¾¾åˆ°æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ ä¼˜é›…é™çº§ graceful degradationï¼šä¸€å¼€å§‹å°±æ„å»ºå®Œæ•´çš„åŠŸèƒ½ï¼Œç„¶åå†é’ˆå¯¹ä½ç‰ˆæœ¬æµè§ˆå™¨è¿›è¡Œå…¼å®¹ã€‚ åŒºåˆ«ï¼šä¼˜é›…é™çº§æ˜¯ä»å¤æ‚çš„ç°çŠ¶å¼€å§‹ï¼Œå¹¶è¯•å›¾å‡å°‘ç”¨æˆ·ä½“éªŒçš„ä¾›ç»™ï¼Œè€Œæ¸è¿›å¢å¼ºåˆ™æ˜¯ä»ä¸€ä¸ªéå¸¸åŸºç¡€çš„ï¼Œèƒ½å¤Ÿèµ·ä½œç”¨çš„ç‰ˆæœ¬å¼€å§‹ï¼Œå¹¶ä¸æ–­æ‰©å……ï¼Œä»¥é€‚åº”æœªæ¥ç¯å¢ƒçš„éœ€è¦ã€‚é™çº§ï¼ˆåŠŸèƒ½è¡°å‡ï¼‰æ„å‘³ç€å¾€å›çœ‹ï¼›è€Œæ¸è¿›å¢å¼ºåˆ™æ„å‘³ç€æœå‰çœ‹ï¼ŒåŒæ—¶ä¿è¯å…¶æ ¹åŸºå¤„äºå®‰å…¨åœ°å¸¦ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"ä¸»æµæµè§ˆå™¨å†…æ ¸ä»‹ç»","slug":"ä¸»æµæµè§ˆå™¨å†…æ ¸ä»‹ç»","date":"2016-01-17T06:09:22.000Z","updated":"2022-03-19T14:35:21.845Z","comments":true,"path":"2016/01/17/15/","link":"","permalink":"https://github.13sai.com/2016/01/17/15/","excerpt":"","text":"ä½œä¸ºä¸€åå‰ç«¯å¼€å‘äººå‘˜ï¼Œæˆ‘è§‰å¾—å¾ˆæœ‰å¿…è¦äº†è§£ä¸»æµæµè§ˆå™¨çš„å†…æ ¸ã€‚å¦‚ä¸‹æ˜¯ä»æ¥è‡ªä¼¯ä¹åœ¨çº¿çš„ä»‹ç»ï¼Œæœ‰åˆ å‡ã€‚ æµè§ˆå™¨å†…æ ¸åˆå¯ä»¥åˆ†æˆä¸¤éƒ¨åˆ†ï¼šæ¸²æŸ“å¼•æ“(layout engineer æˆ–è€… Rendering Engine)å’Œ JS å¼•æ“ã€‚æœ€å¼€å§‹æ¸²æŸ“å¼•æ“å’Œ JS å¼•æ“å¹¶æ²¡æœ‰åŒºåˆ†çš„å¾ˆæ˜ç¡®ï¼Œåæ¥ JS å¼•æ“è¶Šæ¥è¶Šç‹¬ç«‹ï¼Œå†…æ ¸å°±å€¾å‘äºåªæŒ‡æ¸²æŸ“å¼•æ“ã€‚å†…æ ¸çš„ç§ç±»å¾ˆå¤šï¼Œä½†æ˜¯å¸¸è§çš„æµè§ˆå™¨å†…æ ¸å¯ä»¥åˆ†è¿™å››ç§ï¼šTridentã€Geckoã€Webkitã€Blinkã€‚æµè§ˆå™¨çš„å†…æ ¸çš„ä¸åŒå¯¹äºç½‘é¡µçš„è¯­æ³•è§£é‡Šä¼šæœ‰ä¸åŒï¼Œæ‰€ä»¥æ¸²æŸ“çš„æ•ˆæœä¹Ÿä¸ç›¸åŒã€‚ Trident Trident(IEå†…æ ¸)ï¼šè¯¥å†…æ ¸ç¨‹åºåœ¨ 1997 å¹´çš„ IE4 ä¸­é¦–æ¬¡è¢«é‡‡ç”¨ï¼Œæ˜¯å¾®è½¯åœ¨ Mosaicï¼ˆâ€é©¬èµ›å…‹â€ï¼Œè¿™æ˜¯äººç±»å†å²ä¸Šç¬¬ä¸€ä¸ªæµè§ˆå™¨ï¼Œä»æ­¤ç½‘é¡µå¯ä»¥åœ¨å›¾å½¢ç•Œé¢çš„çª—å£æµè§ˆï¼‰ ä»£ç çš„åŸºç¡€ä¹‹ä¸Šä¿®æ”¹è€Œæ¥çš„ï¼Œå¹¶æ²¿ç”¨åˆ° IE11ï¼Œä¹Ÿè¢«æ™®éç§°ä½œ â€œIEå†…æ ¸â€ã€‚ Tridentå®é™…ä¸Šæ˜¯ä¸€æ¬¾å¼€æ”¾çš„å†…æ ¸ï¼Œå…¶æ¥å£å†…æ ¸è®¾è®¡çš„ç›¸å½“æˆç†Ÿï¼Œå› æ­¤æ‰æœ‰è®¸å¤šé‡‡ç”¨ IE å†…æ ¸è€Œé IE çš„æµè§ˆå™¨(å£³æµè§ˆå™¨)æ¶Œç°ã€‚ç”±äº IE æœ¬èº«çš„ â€œå„æ–­æ€§è€Œä½¿å¾— Trident å†…æ ¸çš„é•¿æœŸä¸€å®¶ç‹¬å¤§ï¼Œå¾®è½¯å¾ˆé•¿æ—¶é—´éƒ½å¹¶æ²¡æœ‰æ›´æ–° Trident å†…æ ¸ï¼Œè¿™å¯¼è‡´äº†ä¸¤ä¸ªåæœâ€”â€”ä¸€æ˜¯ Trident å†…æ ¸æ›¾ç»å‡ ä¹ä¸ W3C æ ‡å‡†è„±èŠ‚ï¼ˆ2005å¹´ï¼‰ï¼ŒäºŒæ˜¯ Trident å†…æ ¸çš„å¤§é‡ Bug ç­‰å®‰å…¨æ€§é—®é¢˜æ²¡æœ‰å¾—åˆ°åŠæ—¶è§£å†³ï¼Œç„¶ååŠ ä¸Šä¸€äº›è‡´åŠ›äºå¼€æºçš„å¼€å‘è€…å’Œä¸€äº›å­¦è€…ä»¬å…¬å¼€è‡ªå·±è®¤ä¸º IE æµè§ˆå™¨ä¸å®‰å…¨çš„è§‚ç‚¹ï¼Œä¹Ÿæœ‰å¾ˆå¤šç”¨æˆ·è½¬å‘äº†å…¶ä»–æµè§ˆå™¨ï¼ŒFirefox å’Œ Opera å°±æ˜¯è¿™ä¸ªæ—¶å€™å…´èµ·çš„ã€‚é Trident å†…æ ¸æµè§ˆå™¨çš„å¸‚åœºå æœ‰ç‡å¤§å¹…æé«˜ä¹Ÿè‡´ä½¿è®¸å¤šç½‘é¡µå¼€å‘äººå‘˜å¼€å§‹æ³¨æ„ç½‘é¡µæ ‡å‡†å’Œé IEæµè§ˆå™¨çš„æµè§ˆæ•ˆæœé—®é¢˜ã€‚ è¡¥å……ï¼šIE ä»ç‰ˆæœ¬ 11 å¼€å§‹ï¼Œåˆæ­¥æ”¯æŒ WebGL æŠ€æœ¯ã€‚IE8 çš„ JavaScript å¼•æ“æ˜¯ Jscriptï¼ŒIE9 å¼€å§‹ç”¨ Chakraï¼Œè¿™ä¸¤ä¸ªç‰ˆæœ¬åŒºåˆ«å¾ˆå¤§ï¼ŒChakra æ— è®ºæ˜¯é€Ÿåº¦å’Œæ ‡å‡†åŒ–æ–¹é¢éƒ½å¾ˆå‡ºè‰²ã€‚è€ŒWindow10 å‘å¸ƒåï¼ŒIE å°†å…¶å†…ç½®æµè§ˆå™¨å‘½åä¸º Edgeï¼ŒEdge æœ€æ˜¾è‘—çš„ç‰¹ç‚¹å°±æ˜¯æ–°å†…æ ¸ EdgeHTMLã€‚ Gecko Gecko(Firefox å†…æ ¸)ï¼šNetscape6 å¼€å§‹é‡‡ç”¨çš„å†…æ ¸ï¼Œåæ¥çš„ Mozilla FireFox(ç«ç‹æµè§ˆå™¨) ä¹Ÿé‡‡ç”¨äº†è¯¥å†…æ ¸ï¼ŒGecko çš„ç‰¹ç‚¹æ˜¯ä»£ç å®Œå…¨å…¬å¼€ï¼Œå› æ­¤ï¼Œå…¶å¯å¼€å‘ç¨‹åº¦å¾ˆé«˜ï¼Œå…¨ä¸–ç•Œçš„ç¨‹åºå‘˜éƒ½å¯ä»¥ä¸ºå…¶ç¼–å†™ä»£ç ï¼Œå¢åŠ åŠŸèƒ½ã€‚å› ä¸ºè¿™æ˜¯ä¸ªå¼€æºå†…æ ¸ï¼Œå› æ­¤å—åˆ°è®¸å¤šäººçš„é’çï¼ŒGecko å†…æ ¸çš„æµè§ˆå™¨ä¹Ÿå¾ˆå¤šï¼Œè¿™ä¹Ÿæ˜¯ Gecko å†…æ ¸è™½ç„¶å¹´è½»ä½†å¸‚åœºå æœ‰ç‡èƒ½å¤Ÿè¿…é€Ÿæé«˜çš„é‡è¦åŸå› ã€‚ Webkit ä¸€æåˆ° webkitï¼Œé¦–å…ˆæƒ³åˆ°çš„ä¾¿æ˜¯ chromeï¼Œå¯ä»¥è¯´ï¼Œchrome å°† Webkitå†…æ ¸ æ·±å…¥äººå¿ƒï¼Œæ®Šä¸çŸ¥ï¼ŒWebkit çš„é¼»ç¥–å…¶å®æ˜¯ Safariã€‚ Safari æ˜¯è‹¹æœå…¬å¸å¼€å‘çš„æµè§ˆå™¨ï¼Œä½¿ç”¨äº†KDEï¼ˆLinuxæ¡Œé¢ç³»ç»Ÿï¼‰çš„ KHTML ä½œä¸ºæµè§ˆå™¨çš„å†…æ ¸ï¼ŒSafari æ‰€ç”¨æµè§ˆå™¨å†…æ ¸çš„åç§°æ˜¯å¤§åé¼é¼çš„ WebKitã€‚ Safari åœ¨ 2003 å¹´ 1 æœˆ 7 æ—¥é¦–åº¦å‘è¡Œæµ‹è¯•ç‰ˆï¼Œå¹¶æˆä¸º Mac OS X v10.3 ä¸ä¹‹åç‰ˆæœ¬çš„é»˜è®¤æµè§ˆå™¨ï¼Œä¹Ÿæˆä¸ºè‹¹æœå…¶å®ƒç³»åˆ—äº§å“çš„æŒ‡å®šæµè§ˆå™¨ã€‚ å¦‚ä¸Šè¿°å¯çŸ¥ï¼ŒWebKit å‰èº«æ˜¯ KDE å°ç»„çš„ KHTML å¼•æ“ï¼Œå¯ä»¥è¯´ WebKit æ˜¯ KHTML çš„ä¸€ä¸ªå¼€æºçš„åˆ†æ”¯ã€‚å½“å¹´è‹¹æœåœ¨æ¯”è¾ƒäº† Gecko å’Œ KHTML åï¼Œé€‰æ‹©äº†åè€…æ¥åšå¼•æ“å¼€å‘ï¼Œæ˜¯å› ä¸º KHTML æ‹¥æœ‰æ¸…æ™°çš„æºç ç»“æ„å’Œæå¿«çš„æ¸²æŸ“é€Ÿåº¦ã€‚ Chromium/Bink 2008 å¹´ï¼Œè°·æ­Œå…¬å¸å‘å¸ƒäº† chrome æµè§ˆå™¨ï¼Œæµè§ˆå™¨ä½¿ç”¨çš„å†…æ ¸è¢«å‘½åä¸º chromiumã€‚ chromium fork è‡ªå¼€æºå¼•æ“ webkitï¼Œå´æŠŠ WebKit çš„ä»£ç æ¢³ç†å¾—å¯è¯»æ€§æé«˜å¾ˆå¤šï¼Œæ‰€ä»¥ä»¥å‰å¯èƒ½éœ€è¦ä¸€å¤©è¿›è¡Œç¼–è¯‘çš„ä»£ç ï¼Œç°åœ¨åªè¦ä¸¤ä¸ªå°æ—¶å°±èƒ½æå®šã€‚å› æ­¤ Chromium å¼•æ“å’Œå…¶å®ƒåŸºäº WebKit çš„å¼•æ“æ‰€æ¸²æŸ“é¡µé¢çš„æ•ˆæœä¹Ÿæ˜¯æœ‰å‡ºå…¥çš„ã€‚è°·æ­Œå…¬å¸è¿˜ç ”å‘äº†è‡ªå·±çš„ Javascript å¼•æ“V8ï¼Œæå¤§åœ°æé«˜äº† Javascript çš„è¿ç®—é€Ÿåº¦ã€‚ chromium é—®ä¸–åï¼Œå¸¦åŠ¨äº†å›½äº§æµè§ˆå™¨è¡Œä¸šçš„å‘å±•ã€‚ä¸€äº›åŸºäº chromium çš„å•æ ¸ï¼ŒåŒæ ¸æµè§ˆå™¨å¦‚é›¨åæ˜¥ç¬‹èˆ¬æ‹”åœ°è€Œèµ·ï¼Œä¾‹å¦‚ æœç‹—ã€360ã€QQæµè§ˆå™¨ç­‰ç­‰ï¼Œæ— ä¸€ä¸æ˜¯å¥—ç€ä¸åŒçš„å¤–å£³ç”¨ç€ç›¸åŒçš„å†…æ ¸ã€‚ ç„¶è€Œ 2013 å¹´ 4 æœˆ 3 æ—¥ï¼Œè°·æ­Œç§°å°†ä¸ Webkit åˆ†é“æ‰¬é•³ï¼Œåœ¨ Chromium é¡¹ç›®ä¸­ç ”å‘ Blink æ¸²æŸ“å¼•æ“ï¼ˆå³æµè§ˆå™¨æ ¸å¿ƒï¼‰ï¼Œå†…ç½®äº Chrome æµè§ˆå™¨ä¹‹ä¸­ã€‚ webkit ç”¨çš„å¥½å¥½çš„ï¼Œä¸ºä½•è¦æŠ•å…¥åˆ°ä¸€ä¸ªæ–°çš„å†…æ ¸ä¸­å»å‘¢ï¼Ÿ Blink å…¶å®æ˜¯ WebKit çš„åˆ†æ”¯ï¼Œå¦‚åŒ WebKit æ˜¯ KHTML çš„åˆ†æ”¯ã€‚Google çš„ Chromium é¡¹ç›®æ­¤å‰ä¸€ç›´ä½¿ç”¨ WebKit(WebCore) ä½œä¸ºæ¸²æŸ“å¼•æ“ï¼Œä½†å‡ºäºæŸç§åŸå› ï¼Œå¹¶æ²¡æœ‰å°†å…¶å¤šè¿›ç¨‹æ¶æ„ç§»æ¤å…¥Webkitã€‚ åæ¥ï¼Œç”±äºè‹¹æœæ¨å‡ºçš„ WebKit2 ä¸ Chromium çš„æ²™ç®±è®¾è®¡å­˜åœ¨å†²çªï¼Œæ‰€ä»¥ Chromium ä¸€ç›´åœç•™åœ¨ WebKitï¼Œå¹¶ä½¿ç”¨ç§»æ¤çš„æ–¹å¼æ¥å®ç°å’Œä¸»çº¿ WebKit2 çš„å¯¹æ¥ã€‚è¿™å¢åŠ äº† Chromium çš„å¤æ‚æ€§ï¼Œä¸”åœ¨ä¸€å®šç¨‹åº¦ä¸Šå½±å“äº† Chromium çš„æ¶æ„ç§»æ¤å·¥ä½œã€‚ åŸºäºä»¥ä¸ŠåŸå› ï¼ŒGoogle å†³å®šä» WebKit è¡ç”Ÿå‡ºè‡ªå·±çš„ Blink å¼•æ“ï¼Œå°†åœ¨ WebKit ä»£ç çš„åŸºç¡€ä¸Šç ”å‘æ›´åŠ å¿«é€Ÿå’Œç®€çº¦çš„æ¸²æŸ“å¼•æ“ï¼Œå¹¶é€æ­¥è„±ç¦» WebKit çš„å½±å“ï¼Œåˆ›é€ ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ Blink å¼•æ“ã€‚ Presto Presto æ˜¯æŒªå¨äº§æµè§ˆå™¨ opera çš„ â€œå‰ä»»â€ å†…æ ¸ï¼Œä¸ºä½•è¯´æ˜¯ â€œå‰ä»»â€ï¼Œå› ä¸ºæœ€æ–°çš„ opera æµè§ˆå™¨æ—©å·²å°†ä¹‹æŠ›å¼ƒä»è€ŒæŠ•å…¥åˆ°äº†è°·æ­Œå¤§æœ¬è¥ã€‚ Opera çš„ä¸€ä¸ªé‡Œç¨‹ç¢‘ä½œå“æ˜¯ Opera7.0ï¼Œå› ä¸ºå®ƒä½¿ç”¨äº† Opera Software&nbsp;è‡ªä¸»å¼€å‘çš„ Presto æ¸²æŸ“å¼•æ“ï¼Œå–ä»£äº†æ—§ç‰ˆ Opera 4 è‡³ 6 ç‰ˆæœ¬ä½¿ç”¨çš„ Elektra æ’ç‰ˆå¼•æ“ã€‚è¯¥æ¬¾å¼•æ“çš„ç‰¹ç‚¹å°±æ˜¯æ¸²æŸ“é€Ÿåº¦çš„ä¼˜åŒ–è¾¾åˆ°äº†æè‡´ï¼Œç„¶è€Œä»£ä»·æ˜¯ç‰ºç‰²äº†ç½‘é¡µçš„å…¼å®¹æ€§ã€‚ Presto åŠ å…¥äº†åŠ¨æ€åŠŸèƒ½ï¼Œä¾‹å¦‚ç½‘é¡µæˆ–å…¶éƒ¨åˆ†å¯éšç€ DOM åŠ Script è¯­æ³•çš„äº‹ä»¶è€Œé‡æ–°æ’ç‰ˆã€‚Presto åœ¨æ¨å‡ºåä¸æ–­æœ‰æ›´æ–°ç‰ˆæœ¬æ¨å‡ºï¼Œä½¿ä¸å°‘é”™è¯¯å¾—ä»¥ä¿®æ­£ï¼Œä»¥åŠé˜…è¯» Javascript æ•ˆèƒ½å¾—ä»¥æœ€ä½³åŒ–ï¼Œå¹¶æˆä¸ºå½“æ—¶é€Ÿåº¦æœ€å¿«çš„å¼•æ“ã€‚ ç„¶è€Œä¸ºäº†å‡å°‘ç ”å‘æˆæœ¬ï¼ŒOpera åœ¨ 2013 å¹´ 2 æœˆå®£å¸ƒæ”¾å¼ƒ Prestoï¼Œè½¬è€Œè·Ÿéš Chrome ä½¿ç”¨ WebKit åˆ†æ”¯çš„ Chromium å¼•æ“ä½œä¸ºè‡ªå®¶æµè§ˆå™¨æ ¸å¿ƒå¼•æ“ï¼ŒPresto å†…æ ¸çš„ Opera æµè§ˆå™¨ç‰ˆæœ¬æ°¸è¿œçš„åœç•™åœ¨äº† 12.17ã€‚ ç§»åŠ¨ç«¯ ç§»åŠ¨ç«¯çš„æµè§ˆå™¨å†…æ ¸ä¸»è¦è¯´çš„æ˜¯ç³»ç»Ÿå†…ç½®æµè§ˆå™¨çš„å†…æ ¸ã€‚ ç›®å‰ç§»åŠ¨è®¾å¤‡æµè§ˆå™¨ä¸Šå¸¸ç”¨çš„å†…æ ¸æœ‰ Webkitï¼ŒBlinkï¼ŒTridentï¼ŒGecko ç­‰ï¼Œå…¶ä¸­ iPhone å’Œ iPad ç­‰è‹¹æœ iOS å¹³å°ä¸»è¦æ˜¯ WebKitï¼ŒAndroid 4.4 ä¹‹å‰çš„ Android ç³»ç»Ÿæµè§ˆå™¨å†…æ ¸æ˜¯ WebKitï¼ŒAndroid4.4 ç³»ç»Ÿæµè§ˆå™¨åˆ‡æ¢åˆ°äº†Chromiumï¼Œå†…æ ¸æ˜¯ Webkit çš„åˆ†æ”¯ Blinkï¼ŒWindows Phone 8 ç³»ç»Ÿæµè§ˆå™¨å†…æ ¸æ˜¯ Tridentã€‚ æ€»ç»“ æµè§ˆå™¨å†…æ ¸ä¸»è¦æŒ‡çš„æ˜¯æµè§ˆå™¨çš„æ¸²æŸ“å¼•æ“ï¼Œ2013 å¹´ä»¥å‰ï¼Œä»£è¡¨æœ‰ Tridentï¼ˆIEï¼‰ï¼ŒGeckoï¼ˆfirefoxï¼‰ï¼ŒWebkitï¼ˆSafari chrome ç­‰ï¼‰ä»¥åŠ Prestoï¼ˆopera)ã€‚2013 å¹´ï¼Œè°·æ­Œå¼€å§‹ç ”å‘ blink å¼•æ“ï¼Œchrome 28 ä»¥åå¼€å§‹ä½¿ç”¨ï¼Œè€Œ opera åˆ™æ”¾å¼ƒäº†è‡ªä¸»ç ”å‘çš„ Presto å¼•æ“ï¼ŒæŠ•å…¥è°·æ­Œæ€€æŠ±ï¼Œå’Œè°·æ­Œä¸€èµ·ç ”å‘ blink å¼•æ“ï¼Œå›½å†…å„ç§ chromeç³»çš„æµè§ˆå™¨ï¼ˆ360ã€UCã€QQã€2345 ç­‰ç­‰ï¼‰ä¹Ÿçº·çº·æ”¾å¼ƒ webkitï¼ŒæŠ•å…¥ blink çš„æ€€æŠ±ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/tags/web/"}]},{"title":"åˆ«å¿˜äº†DOCTYPEå£°æ˜","slug":"åˆ«å¿˜äº†DOCTYPEå£°æ˜","date":"2016-01-12T08:40:40.000Z","updated":"2022-05-06T08:55:21.773Z","comments":true,"path":"2016/01/12/13/","link":"","permalink":"https://github.13sai.com/2016/01/12/13/","excerpt":"","text":"&lt;!DOCTYPE&gt; å£°æ˜æ˜¯å¾ˆå®¹æ˜“è¢«å¿½ç•¥çš„é—®é¢˜ï¼Œæœ‰å‡ æ¬¡é‡åˆ°bugï¼ŒèŠ±äº†å¾ˆå¤šæ—¶é—´å»ç ”ç©¶ï¼Œå´æ²¡æœ‰æˆåŠŸè§£å†³ï¼Œæœ€åçš„æœ€åï¼Œå‘ç°æ˜¯&lt;!DOCTYPE&gt;å£°æ˜æœ‰è¯¯ã€‚æ‰€ä»¥åˆ‡è®°ï¼Œé‡åˆ°æµè§ˆå™¨è¯¡å¼‚bugæ—¶è¯·å…ˆæ£€æŸ¥&lt;!DOCTYPE&gt;` å£°æ˜ã€‚ ä¸‹é¢å…·ä½“çœ‹çœ‹w3schoolä¸Šçš„è¯´æ˜ï¼š&lt;!DOCTYPE&gt;å£°æ˜å¿…é¡»æ˜¯ HTML æ–‡æ¡£çš„ç¬¬ä¸€è¡Œï¼Œä½äº html æ ‡ç­¾ä¹‹å‰ã€‚ &lt;!DOCTYPE&gt;å£°æ˜ä¸æ˜¯ HTML æ ‡ç­¾ï¼›å®ƒæ˜¯æŒ‡ç¤º web æµè§ˆå™¨å…³äºé¡µé¢ä½¿ç”¨å“ªä¸ª HTML ç‰ˆæœ¬è¿›è¡Œç¼–å†™çš„æŒ‡ä»¤ã€‚ åœ¨ HTML 4.01 ä¸­ï¼Œ&lt;!DOCTYPE&gt;` å£°æ˜å¼•ç”¨ DTDï¼Œå› ä¸º HTML 4.01 åŸºäº SGMLã€‚DTD è§„å®šäº†æ ‡è®°è¯­è¨€çš„è§„åˆ™ï¼Œè¿™æ ·æµè§ˆå™¨æ‰èƒ½æ­£ç¡®åœ°å‘ˆç°å†…å®¹ã€‚ HTML5 ä¸åŸºäº SGMLï¼Œæ‰€ä»¥ä¸éœ€è¦å¼•ç”¨ DTDã€‚ æ³¨é‡Šï¼šå‘ HTML æ–‡æ¡£æ·»åŠ  &lt;!DOCTYPE&gt; å£°æ˜ï¼Œè¿™æ ·æµè§ˆå™¨æ‰èƒ½è·çŸ¥æ–‡æ¡£ç±»å‹ã€‚&lt;!DOCTYPE&gt; å£°æ˜æ²¡æœ‰ç»“æŸæ ‡ç­¾,&lt;!DOCTYPE&gt; å£°æ˜å¯¹å¤§å°å†™ä¸æ•æ„Ÿã€‚ å¸¸ç”¨çš„ DOCTYPE å£°æ˜HTML 5&lt;!DOCTYPE html&gt; HTML 4.01 Strictè¯¥ DTD åŒ…å«æ‰€æœ‰ HTML å…ƒç´ å’Œå±æ€§ï¼Œä½†ä¸åŒ…æ‹¬å±•ç¤ºæ€§çš„å’Œå¼ƒç”¨çš„å…ƒç´ ï¼ˆæ¯”å¦‚ fontï¼‰ã€‚ä¸å…è®¸æ¡†æ¶é›†ï¼ˆFramesetsï¼‰ã€‚ &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt; HTML 4.01 Transitionalè¯¥ DTD åŒ…å«æ‰€æœ‰ HTML å…ƒç´ å’Œå±æ€§ï¼ŒåŒ…æ‹¬å±•ç¤ºæ€§çš„å’Œå¼ƒç”¨çš„å…ƒç´ ï¼ˆæ¯”å¦‚ fontï¼‰ã€‚ä¸å…è®¸æ¡†æ¶é›†ï¼ˆFramesetsï¼‰ã€‚ &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt; HTML 4.01 Framesetè¯¥ DTD ç­‰åŒäº HTML 4.01 Transitionalï¼Œä½†å…è®¸æ¡†æ¶é›†å†…å®¹ã€‚ &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Frameset//EN&quot; &quot;http://www.w3.org/TR/html4/frameset.dtd&quot;&gt; XHTML 1.0 Strictè¯¥ DTD åŒ…å«æ‰€æœ‰ HTML å…ƒç´ å’Œå±æ€§ï¼Œä½†ä¸åŒ…æ‹¬å±•ç¤ºæ€§çš„å’Œå¼ƒç”¨çš„å…ƒç´ ï¼ˆæ¯”å¦‚ fontï¼‰ã€‚ä¸å…è®¸æ¡†æ¶é›†ï¼ˆFramesetsï¼‰ã€‚å¿…é¡»ä»¥æ ¼å¼æ­£ç¡®çš„ XML æ¥ç¼–å†™æ ‡è®°ã€‚ &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt; XHTML 1.0 Transitionalè¯¥ DTD åŒ…å«æ‰€æœ‰ HTML å…ƒç´ å’Œå±æ€§ï¼ŒåŒ…æ‹¬å±•ç¤ºæ€§çš„å’Œå¼ƒç”¨çš„å…ƒç´ ï¼ˆæ¯”å¦‚ fontï¼‰ã€‚ä¸å…è®¸æ¡†æ¶é›†ï¼ˆFramesetsï¼‰ã€‚å¿…é¡»ä»¥æ ¼å¼æ­£ç¡®çš„ XML æ¥ç¼–å†™æ ‡è®°ã€‚ &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt; XHTML 1.0 Framesetè¯¥ DTD ç­‰åŒäº XHTML 1.0 Transitionalï¼Œä½†å…è®¸æ¡†æ¶é›†å†…å®¹ã€‚ &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Frameset//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd&quot;&gt; XHTML 1.1è¯¥ DTD ç­‰åŒäº XHTML 1.0 Strictï¼Œä½†å…è®¸æ·»åŠ æ¨¡å‹ï¼ˆä¾‹å¦‚æä¾›å¯¹ä¸œäºšè¯­ç³»çš„ ruby æ”¯æŒï¼‰ã€‚ &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot; &quot;http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd&quot;&gt; å¥½äº†ï¼Œæ³¨æ„ DOCTYPE å£°æ˜å“Ÿï¼","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/tags/web/"}]},{"title":"å»æ‰å—çŠ¶å…ƒç´ ä¸imgä¹‹é—´é—´éš™","slug":"å»æ‰å—çŠ¶å…ƒç´ ä¸imgä¹‹é—´é—´éš™","date":"2015-12-22T09:25:58.000Z","updated":"2022-03-19T14:35:21.891Z","comments":true,"path":"2015/12/22/7/","link":"","permalink":"https://github.13sai.com/2015/12/22/7/","excerpt":"","text":"é€ æˆå›¾ç‰‡ä¸å®¹å™¨ä¸‹è¾¹ç•Œæœ‰ç©ºéš™çš„åŸå› åœ¨ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œ&nbsp;å›¾ç‰‡æ–‡å­—ç­‰inlineå…ƒç´ é»˜è®¤æ˜¯å’Œçˆ¶çº§å…ƒç´ çš„baselineå¯¹é½çš„ï¼Œè€Œbaselineåˆå’Œçˆ¶çº§åº•è¾¹æœ‰ä¸€å®šè·ç¦»ï¼ˆè¿™ä¸ªè·ç¦»å’Œ&nbsp;font-sizeï¼Œfont-family&nbsp;ç›¸å…³ï¼Œä¸ä¸€å®šæ˜¯ 3pxï¼‰ï¼Œæ‰€ä»¥è®¾ç½®&nbsp;vertical-align:top/bottom/text-top/text-bottom&nbsp;éƒ½å¯ä»¥é¿å…è¿™ç§æƒ…å†µå‡ºç°ã€‚è€Œä¸”ä¸å…‰liï¼Œå…¶ä»–çš„blockå…ƒç´ ä¸­åŒ…å«imgä¹Ÿä¼šæœ‰è¿™ä¸ªç°è±¡ã€‚&nbsp;åªè¦vertical-alignä¸å–baselineï¼Œè¿™ä¸ªç©ºéš™å°±æ¶ˆå¤±äº†ã€‚è¯·çœ‹å¦‚ä¸‹å®ä¾‹(æ³¨æ„::æµ‹è¯•å·¥å…·ï¼šffï¼Œchromeï¼Œ360--æ”¯æŒIE7+)&lt;style&gt;#l1&nbsp;{float:left;background:#000;}#l1&nbsp;ul&nbsp;li&nbsp;{list-style:none;padding:0;margin:0}img&nbsp;{height:100px;}&lt;/style&gt;&lt;div&nbsp;id=&quot;l1&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;ul&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;img&nbsp;src=&quot;30-023131_451.jpg&quot;&nbsp;/&gt;&lt;/li&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;img&nbsp;src=&quot;30-023131_451.jpg&quot;&nbsp;/&gt;&lt;/li&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;img&nbsp;src=&quot;30-023131_451.jpg&quot;&nbsp;/&gt;&lt;/li&gt;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;&lt;/div&gt;æˆ‘ä»¬ä¼šå‘ç°liåº•éƒ¨ä¸imgåº•éƒ¨æœ‰é—´éš™ï¼Œso badï¼ç¬¬ä¸€ï¼Œç»™å›¾ç‰‡imgæ ‡ç­¾display:blockã€‚å…¼å®¹æ€§IE8+ï¼Œfirefoxï¼Œchromeç¬¬äºŒï¼Œå®šä¹‰å®¹å™¨é‡Œçš„å­—ä½“å¤§å°ä¸º0ã€‚font-size:0&nbsp;å…¼å®¹æ€§IE8+ï¼Œfirefoxï¼Œchromeç¬¬ä¸‰ï¼Œå®šä¹‰å›¾ç‰‡imgæ ‡ç­¾vertical-align:bottomï¼Œvertical-align:middleï¼Œvertical-align:topimg{vertical-align:bottom}å…¼å®¹æ€§IE7+ï¼Œfirefoxï¼Œchrome&nbsp;ç¬¬å››ï¼Œç»™liåŠ é«˜åº¦å…¼å®¹æ€§IE7+ï¼Œfirefoxï¼Œchromeæµ‹è¯•å‘ç°ï¼Œç»™imgåŠ vertical-alignæ•ˆæœæœ€ä½³","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"liè®¾ç½®floatæ—¶å¦‚ä½•æ§åˆ¶ulçš„é«˜åº¦","slug":"liè®¾ç½®floatæ—¶å¦‚ä½•æ§åˆ¶ulçš„é«˜åº¦","date":"2015-12-08T12:22:58.000Z","updated":"2022-03-19T14:35:21.763Z","comments":true,"path":"2015/12/08/5/","link":"","permalink":"https://github.13sai.com/2015/12/08/5/","excerpt":"","text":"åœ¨ç½‘é¡µè®¾è®¡ä¸­ï¼Œå¸¸å¸¸éœ€è¦å¯¹liæ ‡ç­¾åšæµ®åŠ¨æ•ˆæœï¼Œä½†æ˜¯åœ¨ä¸åŒæµè§ˆå™¨ä¸­ä¼šé‡åˆ°å…¼å®¹æ€§é—®é¢˜ï¼Œæ¯”å¦‚IEä¸­ä¼šå‡ºç°ulé«˜åº¦ä¸º0çš„æƒ…å†µï¼Œæ˜¯æ•ˆæœä¸èƒ½è¾¾åˆ°é¢„æœŸæ•ˆæœã€‚é‚£ä¹ˆè¿™é‡Œæˆ‘å°±æ¥è®²è§£ä¸€ä¸‹è§£å†³è¿™ä¸ªé—®é¢˜çš„å‡ ç§æ–¹æ³•ã€‚ 1.ç»™ulå…ƒç´ è®¾ç½®é«˜åº¦heightæœ€ç›´æ¥çš„åŠæ³•æ˜¯ç»™ulå…ƒç´ è®¾ç½®ä¸€ä¸ªé«˜åº¦ï¼Œå³ulæ ‡ç­¾æ·»åŠ heightå±æ€§ï¼Œä»£ç å¦‚ä¸‹: ul { list-style-type: none; height: 30px; /æ·»åŠ é«˜åº¦å±æ€§/} æ¬¡æ–¹æ³•æœ‰ä¸ªç¼ºç‚¹ï¼šå°±æ˜¯å…ƒç´ çš„é«˜åº¦ä¸èƒ½è‡ªé€‚åº”å†…å®¹ã€‚ 2.æ·»åŠ ä¸€ä¸ªç©ºçš„divæ·»åŠ ä¸€ä¸ªç©ºçš„divï¼Œè¿™ä¸ªdivå’Œæµ®åŠ¨å…ƒç´ åŒä¸€çº§åˆ«ï¼Œä¸”ä½äºæµ®åŠ¨å…ƒç´ çš„æœ€åã€‚è¿™ä¸ªæ–¹æ³•å¿…é¡»è¦ä¸ºè¿™ä¸ªdivæ·»åŠ ä¸€ä¸ªclear:bothå±æ€§ï¼Œä»£ç å¦‚ä¸‹ï¼š æ ‡ç­¾1 æ ‡ç­¾2 æ ‡ç­¾3 3.æ·»åŠ zoomå±æ€§ï¼Œé€‚ç”¨äºIE IEæ”¯æŒä¸€ä¸ªCSSå±æ€§zoomï¼Œå½“å®šä¹‰äº†è¿™ä¸ªå±æ€§ä¹‹ååœ¨ IE æµè§ˆå™¨é‡Œé¢å°±ä¼šè‡ªåŠ¨é€‚åº”é«˜åº¦äº†ã€‚è®¾ç½®ä¸ºzoom:1ï¼Œä»£ç å¦‚ä¸‹ï¼š ul { list-style:none; zoom:1; /* é€‚ç”¨äºIE */}","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"è¯¦è§£CSSé€‰æ‹©å™¨ã€ä¼˜å…ˆçº§ä¸åŒ¹é…åŸç†","slug":"è¯¦è§£CSSé€‰æ‹©å™¨ã€ä¼˜å…ˆçº§ä¸åŒ¹é…åŸç†","date":"2015-12-01T11:25:58.000Z","updated":"2022-03-19T14:35:21.945Z","comments":true,"path":"2015/12/01/4/","link":"","permalink":"https://github.13sai.com/2015/12/01/4/","excerpt":"","text":"é€‰æ‹©å™¨ç§ç±»ä¸¥æ ¼æ¥è®²ï¼Œé€‰æ‹©å™¨çš„ç§ç±»å¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼šæ ‡ç­¾åé€‰æ‹©å™¨ã€ç±»é€‰æ‹©å™¨å’ŒIDé€‰æ‹©å™¨ã€‚è€Œæ‰€è°“çš„åä»£é€‰æ‹©å™¨å’Œç¾¤ç»„é€‰æ‹©å™¨åªä¸è¿‡æ˜¯å¯¹å‰ä¸‰ç§é€‰æ‹©å™¨çš„æ‰©å±•åº”ç”¨ã€‚è€Œ åœ¨æ ‡ç­¾å†…å†™å…¥style=&quot;&quot;çš„æ–¹å¼ï¼Œåº”è¯¥æ˜¯CSSçš„ä¸€ç§å¼•å…¥æ–¹å¼ï¼Œè€Œä¸æ˜¯é€‰æ‹©å™¨ï¼Œå› ä¸ºæ ¹æœ¬å°±æ²¡æœ‰ç”¨åˆ°é€‰æ‹©å™¨ã€‚è€Œä¸€èˆ¬äººä»¬å°†ä¸Šé¢è¿™å‡ ç§æ–¹å¼ç»“åˆåœ¨ä¸€èµ·ï¼Œæ‰€ ä»¥å°±æœ‰äº†5ç§æˆ–6ç§é€‰æ‹©å™¨äº†ã€‚ä¸‰ç§åŸºæœ¬çš„é€‰æ‹©å™¨ç±»å‹è¯­æ³•å¦‚ä¸‹ï¼šâ—†æ ‡ç­¾åé€‰æ‹©å™¨ï¼Œå¦‚ï¼šp{}ï¼Œå³ç›´æ¥ä½¿ç”¨HTMLæ ‡ç­¾ä½œä¸ºé€‰æ‹©å™¨ã€‚â—†ç±»é€‰æ‹©å™¨ï¼Œå¦‚.polaris{}ã€‚â—†IDé€‰æ‹©å™¨ï¼Œå¦‚#polaris{}ã€‚æ³¨æ„ï¼ŒIDé€‰æ‹©å™¨è·Ÿç±»é€‰æ‹©å™¨æœ‰å¾ˆå¤§çš„ä¸åŒï¼šä¸€ä¸ªé¡µé¢å†…ä¸èƒ½å‡ºç°ç›¸åŒçš„IDï¼›å†å°±æ˜¯IDä¹Ÿæ˜¯åå°å¼€å‘äººå‘˜ä¼šç»å¸¸ç”¨çš„ï¼Œæ‰€ä»¥å‰ç«¯å¼€å‘äººå‘˜åº”è¯¥å°½é‡å°‘çš„ä½¿ç”¨ã€‚å½“ç„¶è·Ÿåå°äººå‘˜çš„å·¥ä½œé…åˆååˆ†å¨´ç†Ÿä¹‹åï¼Œè¿™äº›éƒ½ä¸ä¼šæˆä¸ºé™åˆ¶ã€‚æ‰©å±•é€‰æ‹©å™¨â—†åä»£é€‰æ‹©å™¨ï¼Œå¦‚.polaris span img{}ï¼Œåä»£é€‰è´¼å™¨å®é™…ä¸Šæ˜¯ä½¿ç”¨å¤šä¸ªé€‰æ‹©å™¨åŠ ä¸Šä¸­é—´çš„ç©ºæ ¼æ¥æ‰¾åˆ°å…·ä½“çš„è¦æ§åˆ¶æ ‡ç­¾ã€‚â—†ç¾¤ç»„é€‰æ‹©å™¨ï¼Œå¦‚div,span,img{}ï¼Œç¾¤ç»„é€‰æ‹©å™¨å®é™…ä¸Šæ˜¯å¯¹CSSçš„ä¸€ç§ç®€åŒ–å†™æ³•ï¼Œåªä¸è¿‡æŠŠæœ‰ç›¸åŒå®šä¹‰çš„ä¸åŒé€‰æ‹©å™¨æ”¾åœ¨ä¸€èµ·ï¼Œçœäº†å¾ˆå¤šä»£ç ã€‚é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§åˆ«äº†è§£äº†å„ç§é€‰æ‹©å™¨åï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„çŸ¥è¯†ç‚¹å°±æ˜¯CSSé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆpolarisä¼šé‡åˆ°æ–‡ç« å¼€å¤´çš„é—®é¢˜ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š&lt;div&nbsp;class=&quot;polaris&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;beijixing&quot;&gt;&nbsp;beijixing &nbsp;&lt;/span&gt;&nbsp;&lt;span&gt;&nbsp;polaris &nbsp;&lt;/span&gt;&nbsp;&lt;/div&gt;&nbsp;å¦‚æœå·²ç»æŠŠ.polarisä¸‹é¢spanå†…çš„å­—ä½“è®¾ç½®æˆçº¢è‰²ï¼š.polaris&nbsp;span&nbsp;{color:red;}&nbsp;è¿™æ—¶ï¼Œå¦‚æœè¦æ”¹å˜.beijixingçš„é¢œè‰²ä¸ºè“è‰²ï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤æ˜¯ä¸èƒ½å®ç°çš„ï¼š.beijixing&nbsp;{color:blue;}&nbsp;å‡ºç°è¿™ç§æƒ…å†µå°±æ˜¯å› ä¸ºåä¸€ä¸ªå‘½ä»¤çš„ä¼˜å…ˆçº§ä¸å¤Ÿï¼Œä¸¤æ¡ç›¸äº’å†²çªçš„æ ·å¼è®¾ç½®ï¼Œæµè§ˆå™¨åªä¼šæ‰§è¡Œä¼˜å…ˆçº§è¾ƒé«˜çš„é‚£ä¸ªã€‚é‚£ä¹ˆé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€ä¹ˆè§„å®šçš„å‘¢ï¼Ÿä¸€èˆ¬è€Œè¨€ï¼Œé€‰æ‹©å™¨è¶Šç‰¹æ®Šï¼Œå®ƒçš„ä¼˜å…ˆçº§è¶Šé«˜ã€‚ä¹Ÿå°±æ˜¯é€‰æ‹©å™¨æŒ‡å‘çš„è¶Šå‡†ç¡®ï¼Œå®ƒçš„ä¼˜å…ˆçº§å°±è¶Šé«˜ã€‚é€šå¸¸æˆ‘ä»¬ç”¨1è¡¨ç¤ºæ ‡ç­¾åé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§ï¼Œç”¨10è¡¨ç¤ºç±»é€‰æ‹© å™¨çš„ä¼˜å…ˆçº§ï¼Œç”¨100æ ‡ç¤ºIDé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§ã€‚æ¯”å¦‚ä¸Šä¾‹å½“ä¸­ .polaris span {color:red;}çš„é€‰æ‹©å™¨ä¼˜å…ˆçº§æ˜¯ 10 + 1 ä¹Ÿå°±æ˜¯11ï¼›è€Œ .polaris çš„ä¼˜å…ˆçº§æ˜¯10ï¼›æµè§ˆå™¨è‡ªç„¶ä¼šæ˜¾ç¤ºçº¢è‰²çš„å­—ã€‚ç†è§£äº†è¿™ä¸ªé“ç†ä¹‹åä¸‹é¢çš„ä¼˜å…ˆçº§è®¡ç®—è‡ªæ˜¯æ˜“å¦‚åæŒï¼šdiv.test1&nbsp;.span&nbsp;var&nbsp;ä¼˜å…ˆçº§&nbsp;1+10&nbsp;+10&nbsp;+1 &nbsp;span#xxx&nbsp;.songs&nbsp;li&nbsp;ä¼˜å…ˆçº§1+100&nbsp;+&nbsp;10&nbsp;+&nbsp;1 &nbsp;#xxx&nbsp;li&nbsp;ä¼˜å…ˆçº§&nbsp;100&nbsp;+1&nbsp;å¯¹äºä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ä»€ä¹ˆé€‰æ‹©å™¨ï¼Œç”¨ä¸åŒé€‰æ‹©å™¨çš„åŸåˆ™æ˜¯ï¼šç¬¬ä¸€ï¼šå‡†ç¡®çš„é€‰åˆ°è¦æ§åˆ¶çš„æ ‡ç­¾ï¼›ç¬¬äºŒï¼šä½¿ç”¨æœ€åˆç†ä¼˜å…ˆçº§çš„é€‰æ‹©å™¨ï¼›ç¬¬ä¸‰ï¼šHTMLå’ŒCSSä»£ç å°½é‡ç®€æ´ç¾è§‚ã€‚é€šå¸¸ï¼š1ã€æœ€å¸¸ç”¨çš„é€‰æ‹©å™¨æ˜¯ç±»é€‰æ‹©å™¨ã€‚2ã€liã€tdã€ddç­‰ç»å¸¸å¤§é‡è¿ç»­å‡ºç°ï¼Œå¹¶ä¸”æ ·å¼ç›¸åŒæˆ–è€…ç›¸ç±»ä¼¼çš„æ ‡ç­¾ï¼Œæˆ‘ä»¬é‡‡ç”¨ç±»é€‰æ‹©å™¨è·Ÿæ ‡ç­¾åé€‰æ‹©å™¨ç»“åˆçš„åä»£é€‰æ‹©å™¨ .xx li/td/dd {} çš„æ–¹å¼é€‰æ‹©ã€‚3ã€æå°‘çš„æƒ…å†µä¸‹ä¼šç”¨IDé€‰æ‹©å™¨ï¼Œå½“ç„¶å¾ˆå¤šå‰ç«¯å¼€å‘äººå‘˜å–œæ¬¢headerï¼Œfooterï¼Œbannerï¼Œconntentè®¾ç½®æˆIDé€‰æ‹©å™¨çš„ï¼Œå› ä¸ºç›¸åŒçš„æ ·å¼åœ¨ä¸€ä¸ªé¡µé¢é‡Œä¸å¯èƒ½æœ‰ç¬¬äºŒæ¬¡ã€‚åœ¨è¿™é‡Œä¸å¾—ä¸æä½¿ç”¨åœ¨æ ‡ç­¾å†…å¼•å…¥CSSçš„æ–¹å¼æ¥å†™CSSï¼Œå³ï¼š&lt;div&nbsp;style=&quot;color:red&quot;&gt;polaris&lt;/div&gt;&nbsp;è¿™æ—¶å€™çš„ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ã€‚æˆ‘ä»¬ç»™å®ƒçš„ä¼˜å…ˆçº§æ˜¯1000ï¼Œè¿™ç§å†™æ³•ä¸æ¨èä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯å¯¹æ–°æ‰‹æ¥è¯´ã€‚è¿™ä¹Ÿå®Œå…¨è¿èƒŒäº†å†…å®¹å’Œæ˜¾ç¤ºåˆ†ç¦»çš„æ€æƒ³ã€‚DIV+CSSçš„ä¼˜ç‚¹ä¹Ÿä¸èƒ½å†æœ‰ä»»ä½•ä½“ç°ã€‚åä»£é€‰æ‹©å™¨çš„å®šä½åŸåˆ™åœ¨è¿™é‡Œä»‹ç»ä¸€ä¸‹å¯¹äºåä»£é€‰æ‹©å™¨ï¼Œæµè§ˆå™¨æ˜¯å¦‚ä½•æŸ¥æ‰¾å…ƒç´ çš„å‘¢ï¼Ÿæµè§ˆå™¨CSSåŒ¹é…ä¸æ˜¯ä»å·¦åˆ°å³è¿›è¡ŒæŸ¥æ‰¾ï¼Œè€Œæ˜¯ä»å³åˆ°å·¦è¿›è¡ŒæŸ¥æ‰¾ã€‚æ¯”å¦‚DIV#divBox p span.red{color:red;}ï¼Œæµè§ˆå™¨çš„æŸ¥æ‰¾é¡ºåºå¦‚ä¸‹ï¼šå…ˆæŸ¥æ‰¾htmlä¸­æ‰€æœ‰class=&#39;red&#39;çš„spanå…ƒç´ ï¼Œæ‰¾åˆ°åï¼Œå†æŸ¥æ‰¾å…¶çˆ¶è¾ˆå…ƒ ç´ ä¸­æ˜¯å¦æœ‰på…ƒç´ ï¼Œå†åˆ¤æ–­pçš„çˆ¶å…ƒç´ ä¸­æ˜¯å¦æœ‰idä¸ºdivBoxçš„divå…ƒç´ ï¼Œå¦‚æœéƒ½å­˜åœ¨åˆ™åŒ¹é…ä¸Šã€‚æµè§ˆå™¨ä»å³åˆ°å·¦è¿›è¡ŒæŸ¥æ‰¾çš„å¥½å¤„æ˜¯ä¸ºäº†å°½æ—©è¿‡æ»¤æ‰ä¸€äº›æ— å…³çš„æ ·å¼è§„åˆ™å’Œå…ƒç´ ã€‚æ¯”å¦‚å¦‚ä¸‹htmlå’Œcss:&lt;style&gt;&nbsp;DIV#divBox&nbsp;p&nbsp;span.red{color:red;} &nbsp;&gt;&lt;style&gt;&nbsp;&lt;body&gt;&nbsp;&lt;div&nbsp;id=&quot;divBox&quot;&gt;&nbsp;&lt;p&gt;&lt;span&gt;s1&lt;/span&gt;&lt;/p&gt;&nbsp;&lt;p&gt;&lt;span&gt;s2&lt;/span&gt;&lt;/p&gt;&nbsp;&lt;p&gt;&lt;span&gt;s3&lt;/span&gt;&lt;/p&gt;&nbsp;&lt;p&gt;&lt;span&nbsp;class=&#39;red&#39;&gt;s4&lt;/span&gt;&lt;/p&gt;&nbsp;&lt;/div&gt;&nbsp;&lt;/body&gt;&nbsp;å¦‚æœæŒ‰ä»å·¦åˆ°å³æŸ¥æ‰¾ï¼Œå“ªä¼šå…ˆæŸ¥æ‰¾åˆ°å¾ˆå¤šä¸ç›¸å…³çš„på’Œspanå…ƒç´ ã€‚è€Œå¦‚æœæŒ‰ä»å·¦åˆ°å³çš„æ–¹å¼è¿›è¡ŒæŸ¥æ‰¾ï¼Œåˆ™é¦–å…ˆå°±æŸ¥æ‰¾åˆ°&lt;span class=&#39;red&#39;&gt;çš„å…ƒç´ ã€‚firefoxç§°è¿™ç§æŸ¥æ‰¾æ–¹å¼ä¸ºkey selector(å…³é”®å­—æŸ¥è¯¢)ï¼Œæ‰€è°“çš„å…³é”®å­—å°±æ˜¯æ ·å¼è§„åˆ™ä¸­æœ€å(æœ€å³è¾¹)çš„è§„åˆ™ï¼Œä¸Šé¢çš„keyå°±æ˜¯span.redã€‚ç®€æ´ã€é«˜æ•ˆçš„CSSæ‰€è°“é«˜æ•ˆçš„CSSå°±æ˜¯è®©æµè§ˆå™¨åœ¨æŸ¥æ‰¾styleåŒ¹é…çš„å…ƒç´ çš„æ—¶å€™å°½é‡è¿›è¡Œå°‘çš„æŸ¥æ‰¾ï¼Œä¸‹é¢åˆ—å‡ºä¸€äº›æˆ‘ä»¬å¸¸è§çš„å†™CSSçŠ¯ä¸€äº›ä½æ•ˆé”™è¯¯ï¼šâ—†ä¸è¦åœ¨IDé€‰æ‹©å™¨å‰ä½¿ç”¨æ ‡ç­¾åä¸€èˆ¬å†™æ³•ï¼šDIV#divBoxæ›´å¥½å†™æ³•ï¼š#divBoxè§£é‡Šï¼š å› ä¸ºIDé€‰æ‹©å™¨æ˜¯å”¯ä¸€çš„ï¼ŒåŠ ä¸Šdivåè€Œå¢åŠ ä¸å¿…è¦çš„åŒ¹é…ã€‚â—†ä¸è¦å†classé€‰æ‹©å™¨å‰ä½¿ç”¨æ ‡ç­¾åä¸€èˆ¬å†™æ³•ï¼šspan.redæ›´å¥½å†™æ³•ï¼š.redè§£é‡Šï¼šåŒç¬¬ä¸€æ¡ï¼Œä½†å¦‚æœä½ å®šä¹‰äº†å¤šä¸ª.redï¼Œè€Œä¸”åœ¨ä¸åŒçš„å…ƒç´ ä¸‹æ˜¯æ ·å¼ä¸ä¸€æ ·ï¼Œåˆ™ä¸èƒ½å»æ‰ï¼Œæ¯”å¦‚ä½ cssæ–‡ä»¶ä¸­å®šä¹‰å¦‚ä¸‹ï¼šp.red{color:red;} &nbsp;span.red{color:#ff00ff}&nbsp;å¦‚æœæ˜¯è¿™æ ·å®šä¹‰çš„å°±ä¸è¦å»æ‰ï¼Œå»æ‰åå°±ä¼šæ··æ·†ï¼Œä¸è¿‡å»ºè®®æœ€å¥½ä¸è¦è¿™æ ·å†™â—†å°½é‡å°‘ä½¿ç”¨å±‚çº§å…³ç³»ä¸€èˆ¬å†™æ³•ï¼š#divBox p .red{color:red;}æ›´å¥½å†™æ³•ï¼š.red{..}â—†ä½¿ç”¨classä»£æ›¿å±‚çº§å…³ç³»ä¸€èˆ¬å†™æ³•ï¼š#divBox ul li a{display:block;}æ›´å¥½å†™æ³•ï¼š.block{display:block;}","categories":[{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"}],"tags":[{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]},{"title":"å…³äºmysqlæ•°æ®åº“å¯æŸ¥è¯¢ä¸å¯å†™å…¥çš„é—®é¢˜","slug":"å…³äºmysqlæ•°æ®åº“å¯æŸ¥è¯¢ä¸å¯å†™å…¥çš„é—®é¢˜","date":"2015-12-01T05:25:58.000Z","updated":"2022-03-19T14:35:21.860Z","comments":true,"path":"2015/12/01/3/","link":"","permalink":"https://github.13sai.com/2015/12/01/3/","excerpt":"","text":"ä¹‹å‰ä¸çŸ¥é“æ”¹äº†æ•°æ®åº“é‡Œçš„è¡¨å•ï¼Œç„¶åå°±ä¸èƒ½å†™å…¥æ•°æ®åˆ°æ•°æ®åº“äº†ï¼Œè‡ªå·±ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå®åœ¨æ˜¯å¼„ä¸æ¸…ä¸ºä½•ã€‚ åªå¾—æ‰¾baiduäº†ï¼Œè¯´æ˜¯æœ¨æœ‰æƒé™ï¼Œæˆ–è€…è¯´æ˜¯å­—ç¬¦ç±»å‹ä»€ä¹ˆçš„ä¸å¯¹ã€‚ï¼ˆåæ§½ä¸€å¥ï¼Œæœ‰æ—¶å€™ç™¾åº¦å‡ºæ¥çš„ç»“æœå¾ˆå¤šï¼Œä½†å¤§åŒå°å¼‚ï¼Œéƒ½è§£å†³ä¸äº†è‡ªå·±å¼„å‡ºæ¥çš„é—®é¢˜ï¼‰ï¼Œæƒé™æ˜¯æœ‰çš„ï¼Œå› ä¸ºä¹‹å‰å¯ä»¥ã€‚ é‚£å°±æ”¹äº†å­—ç¬¦ç±»å‹ï¼Œä»ç„¶ä¸èƒ½æ’å…¥æ•°æ®ã€‚ åªèƒ½è‡ªå·±æ£é¼“ï¼Œæ°å·§éœ€è¦æ–°å»ºè¡¨ï¼Œæ’å…¥ä¸€æ¡æ•°æ®ï¼ŒæˆåŠŸï¼Œå†æ’å…¥ï¼Œå¤±è´¥ï¼Œå‘ç°idç›¸åŒï¼Œæ¢idï¼ŒæˆåŠŸã€‚ ç„¶åå°±æƒ³æ˜¯ä¸æ˜¯idçš„é—®é¢˜ã€‚ æ”¹idä¸ºè‡ªå¢ï¼Œæç¤ºè®¾ä¸ºä¸»é”®ï¼Œæ”¹ä¸»é”®ä¸ºidï¼Œæ”¹è‡ªå¢ï¼Œæç¤ºid45é”™è¯¯ï¼Œåˆ é™¤45æ•°æ®ï¼Œé‡æ–°æ’å…¥ï¼ŒæˆåŠŸã€‚","categories":[{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"}]}],"categories":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/categories/k8s/"},{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/categories/CI/"},{"name":"go","slug":"go","permalink":"https://github.13sai.com/categories/go/"},{"name":"db","slug":"db","permalink":"https://github.13sai.com/categories/db/"},{"name":"sql","slug":"sql","permalink":"https://github.13sai.com/categories/sql/"},{"name":"linux","slug":"linux","permalink":"https://github.13sai.com/categories/linux/"},{"name":"supervisord","slug":"supervisord","permalink":"https://github.13sai.com/categories/supervisord/"},{"name":"Kubernetes","slug":"Kubernetes","permalink":"https://github.13sai.com/categories/Kubernetes/"},{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://github.13sai.com/categories/ElasticSearch/"},{"name":"mac","slug":"mac","permalink":"https://github.13sai.com/categories/mac/"},{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/categories/Linux/"},{"name":"github","slug":"github","permalink":"https://github.13sai.com/categories/github/"},{"name":"MQ","slug":"MQ","permalink":"https://github.13sai.com/categories/MQ/"},{"name":"debug","slug":"debug","permalink":"https://github.13sai.com/categories/debug/"},{"name":"kubernetes","slug":"kubernetes","permalink":"https://github.13sai.com/categories/kubernetes/"},{"name":"design","slug":"design","permalink":"https://github.13sai.com/categories/design/"},{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/categories/PHP/"},{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/categories/Redis/"},{"name":"devops","slug":"devops","permalink":"https://github.13sai.com/categories/devops/"},{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://github.13sai.com/categories/%E7%BD%91%E7%BB%9C/"},{"name":"reading","slug":"reading","permalink":"https://github.13sai.com/categories/reading/"},{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/categories/gosourcecode/"},{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/categories/goexample/"},{"name":"Docker","slug":"Docker","permalink":"https://github.13sai.com/categories/Docker/"},{"name":"js","slug":"js","permalink":"https://github.13sai.com/categories/js/"},{"name":"web","slug":"web","permalink":"https://github.13sai.com/categories/web/"},{"name":"MySQL","slug":"MySQL","permalink":"https://github.13sai.com/categories/MySQL/"},{"name":"vue","slug":"vue","permalink":"https://github.13sai.com/categories/vue/"},{"name":"shell","slug":"shell","permalink":"https://github.13sai.com/categories/shell/"},{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/categories/redis/"},{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/categories/phpframe/"},{"name":"algorithm","slug":"algorithm","permalink":"https://github.13sai.com/categories/algorithm/"},{"name":"api","slug":"web/api","permalink":"https://github.13sai.com/categories/web/api/"},{"name":"test","slug":"test","permalink":"https://github.13sai.com/categories/test/"},{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/categories/Nginx/"},{"name":"life","slug":"life","permalink":"https://github.13sai.com/categories/life/"},{"name":"bug","slug":"bug","permalink":"https://github.13sai.com/categories/bug/"},{"name":"cache","slug":"cache","permalink":"https://github.13sai.com/categories/cache/"},{"name":"python","slug":"python","permalink":"https://github.13sai.com/categories/python/"},{"name":"windows","slug":"windows","permalink":"https://github.13sai.com/categories/windows/"},{"name":"asp","slug":"asp","permalink":"https://github.13sai.com/categories/asp/"},{"name":"api","slug":"PHP/api","permalink":"https://github.13sai.com/categories/PHP/api/"},{"name":"css","slug":"css","permalink":"https://github.13sai.com/categories/css/"}],"tags":[{"name":"k8s","slug":"k8s","permalink":"https://github.13sai.com/tags/k8s/"},{"name":"git","slug":"git","permalink":"https://github.13sai.com/tags/git/"},{"name":"gorm","slug":"gorm","permalink":"https://github.13sai.com/tags/gorm/"},{"name":"sql","slug":"sql","permalink":"https://github.13sai.com/tags/sql/"},{"name":"Protobuf","slug":"Protobuf","permalink":"https://github.13sai.com/tags/Protobuf/"},{"name":"influxdb","slug":"influxdb","permalink":"https://github.13sai.com/tags/influxdb/"},{"name":"vim","slug":"vim","permalink":"https://github.13sai.com/tags/vim/"},{"name":"go","slug":"go","permalink":"https://github.13sai.com/tags/go/"},{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://github.13sai.com/tags/ElasticSearch/"},{"name":"mac","slug":"mac","permalink":"https://github.13sai.com/tags/mac/"},{"name":"curl","slug":"curl","permalink":"https://github.13sai.com/tags/curl/"},{"name":"Docker","slug":"Docker","permalink":"https://github.13sai.com/tags/Docker/"},{"name":"github","slug":"github","permalink":"https://github.13sai.com/tags/github/"},{"name":"boltdb","slug":"boltdb","permalink":"https://github.13sai.com/tags/boltdb/"},{"name":"nsq","slug":"nsq","permalink":"https://github.13sai.com/tags/nsq/"},{"name":"kubernetes","slug":"kubernetes","permalink":"https://github.13sai.com/tags/kubernetes/"},{"name":"DDD","slug":"DDD","permalink":"https://github.13sai.com/tags/DDD/"},{"name":"PHP","slug":"PHP","permalink":"https://github.13sai.com/tags/PHP/"},{"name":"Redis","slug":"Redis","permalink":"https://github.13sai.com/tags/Redis/"},{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"https://github.13sai.com/tags/%E7%BD%91%E7%BB%9C/"},{"name":"reading","slug":"reading","permalink":"https://github.13sai.com/tags/reading/"},{"name":"gosourcecode","slug":"gosourcecode","permalink":"https://github.13sai.com/tags/gosourcecode/"},{"name":"goexample","slug":"goexample","permalink":"https://github.13sai.com/tags/goexample/"},{"name":"vue","slug":"vue","permalink":"https://github.13sai.com/tags/vue/"},{"name":"web","slug":"web","permalink":"https://github.13sai.com/tags/web/"},{"name":"MongoDB","slug":"MongoDB","permalink":"https://github.13sai.com/tags/MongoDB/"},{"name":"mysql","slug":"mysql","permalink":"https://github.13sai.com/tags/mysql/"},{"name":"js","slug":"js","permalink":"https://github.13sai.com/tags/js/"},{"name":"Laravel","slug":"Laravel","permalink":"https://github.13sai.com/tags/Laravel/"},{"name":"gin","slug":"gin","permalink":"https://github.13sai.com/tags/gin/"},{"name":"ElementUI","slug":"ElementUI","permalink":"https://github.13sai.com/tags/ElementUI/"},{"name":"shell","slug":"shell","permalink":"https://github.13sai.com/tags/shell/"},{"name":"redis","slug":"redis","permalink":"https://github.13sai.com/tags/redis/"},{"name":"phpframe","slug":"phpframe","permalink":"https://github.13sai.com/tags/phpframe/"},{"name":"algorithm","slug":"algorithm","permalink":"https://github.13sai.com/tags/algorithm/"},{"name":"jwt","slug":"jwt","permalink":"https://github.13sai.com/tags/jwt/"},{"name":"wrk","slug":"wrk","permalink":"https://github.13sai.com/tags/wrk/"},{"name":"Nginx","slug":"Nginx","permalink":"https://github.13sai.com/tags/Nginx/"},{"name":"gRPC","slug":"gRPC","permalink":"https://github.13sai.com/tags/gRPC/"},{"name":"CI","slug":"CI","permalink":"https://github.13sai.com/tags/CI/"},{"name":"gogs","slug":"gogs","permalink":"https://github.13sai.com/tags/gogs/"},{"name":"consul","slug":"consul","permalink":"https://github.13sai.com/tags/consul/"},{"name":"SLB","slug":"SLB","permalink":"https://github.13sai.com/tags/SLB/"},{"name":"jenkins","slug":"jenkins","permalink":"https://github.13sai.com/tags/jenkins/"},{"name":"Linux","slug":"Linux","permalink":"https://github.13sai.com/tags/Linux/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://github.13sai.com/tags/%E9%9D%A2%E8%AF%95/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://github.13sai.com/tags/RabbitMQ/"},{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://github.13sai.com/tags/ThinkPHP/"},{"name":"swoole","slug":"swoole","permalink":"https://github.13sai.com/tags/swoole/"},{"name":"LNMP","slug":"LNMP","permalink":"https://github.13sai.com/tags/LNMP/"},{"name":"windows","slug":"windows","permalink":"https://github.13sai.com/tags/windows/"},{"name":"gulp","slug":"gulp","permalink":"https://github.13sai.com/tags/gulp/"},{"name":"svn","slug":"svn","permalink":"https://github.13sai.com/tags/svn/"},{"name":"SVN","slug":"SVN","permalink":"https://github.13sai.com/tags/SVN/"},{"name":"cache","slug":"cache","permalink":"https://github.13sai.com/tags/cache/"},{"name":"ueditor","slug":"ueditor","permalink":"https://github.13sai.com/tags/ueditor/"},{"name":"CSV","slug":"CSV","permalink":"https://github.13sai.com/tags/CSV/"},{"name":"html","slug":"html","permalink":"https://github.13sai.com/tags/html/"},{"name":"wamp","slug":"wamp","permalink":"https://github.13sai.com/tags/wamp/"},{"name":"python","slug":"python","permalink":"https://github.13sai.com/tags/python/"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"https://github.13sai.com/tags/%E7%88%AC%E8%99%AB/"},{"name":"asp","slug":"asp","permalink":"https://github.13sai.com/tags/asp/"},{"name":"makedown","slug":"makedown","permalink":"https://github.13sai.com/tags/makedown/"},{"name":"css","slug":"css","permalink":"https://github.13sai.com/tags/css/"}]}